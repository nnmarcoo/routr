var PA=Object.defineProperty;var EA=(e,t,i)=>t in e?PA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var sd=(e,t,i)=>EA(e,typeof t!="symbol"?t+"":t,i);function HT(e,t){for(var i=0;i<t.length;i++){const a=t[i];if(typeof a!="string"&&!Array.isArray(a)){for(const h in a)if(h!=="default"&&!(h in e)){const p=Object.getOwnPropertyDescriptor(a,h);p&&Object.defineProperty(e,h,p.get?p:{enumerable:!0,get:()=>a[h]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))a(h);new MutationObserver(h=>{for(const p of h)if(p.type==="childList")for(const f of p.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&a(f)}).observe(document,{childList:!0,subtree:!0});function i(h){const p={};return h.integrity&&(p.integrity=h.integrity),h.referrerPolicy&&(p.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?p.credentials="include":h.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function a(h){if(h.ep)return;h.ep=!0;const p=i(h);fetch(h.href,p)}})();var IA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function XT(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var KT={exports:{}},ug={},YT={exports:{}},jt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mf=Symbol.for("react.element"),MA=Symbol.for("react.portal"),AA=Symbol.for("react.fragment"),zA=Symbol.for("react.strict_mode"),DA=Symbol.for("react.profiler"),RA=Symbol.for("react.provider"),LA=Symbol.for("react.context"),FA=Symbol.for("react.forward_ref"),BA=Symbol.for("react.suspense"),OA=Symbol.for("react.memo"),VA=Symbol.for("react.lazy"),Ew=Symbol.iterator;function NA(e){return e===null||typeof e!="object"?null:(e=Ew&&e[Ew]||e["@@iterator"],typeof e=="function"?e:null)}var JT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},QT=Object.assign,eC={};function jc(e,t,i){this.props=e,this.context=t,this.refs=eC,this.updater=i||JT}jc.prototype.isReactComponent={};jc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};jc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function tC(){}tC.prototype=jc.prototype;function H0(e,t,i){this.props=e,this.context=t,this.refs=eC,this.updater=i||JT}var X0=H0.prototype=new tC;X0.constructor=H0;QT(X0,jc.prototype);X0.isPureReactComponent=!0;var Iw=Array.isArray,nC=Object.prototype.hasOwnProperty,K0={current:null},rC={key:!0,ref:!0,__self:!0,__source:!0};function iC(e,t,i){var a,h={},p=null,f=null;if(t!=null)for(a in t.ref!==void 0&&(f=t.ref),t.key!==void 0&&(p=""+t.key),t)nC.call(t,a)&&!rC.hasOwnProperty(a)&&(h[a]=t[a]);var u=arguments.length-2;if(u===1)h.children=i;else if(1<u){for(var T=Array(u),E=0;E<u;E++)T[E]=arguments[E+2];h.children=T}if(e&&e.defaultProps)for(a in u=e.defaultProps,u)h[a]===void 0&&(h[a]=u[a]);return{$$typeof:mf,type:e,key:p,ref:f,props:h,_owner:K0.current}}function jA(e,t){return{$$typeof:mf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Y0(e){return typeof e=="object"&&e!==null&&e.$$typeof===mf}function $A(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(i){return t[i]})}var Mw=/\/+/g;function P_(e,t){return typeof e=="object"&&e!==null&&e.key!=null?$A(""+e.key):t.toString(36)}function rm(e,t,i,a,h){var p=typeof e;(p==="undefined"||p==="boolean")&&(e=null);var f=!1;if(e===null)f=!0;else switch(p){case"string":case"number":f=!0;break;case"object":switch(e.$$typeof){case mf:case MA:f=!0}}if(f)return f=e,h=h(f),e=a===""?"."+P_(f,0):a,Iw(h)?(i="",e!=null&&(i=e.replace(Mw,"$&/")+"/"),rm(h,t,i,"",function(E){return E})):h!=null&&(Y0(h)&&(h=jA(h,i+(!h.key||f&&f.key===h.key?"":(""+h.key).replace(Mw,"$&/")+"/")+e)),t.push(h)),1;if(f=0,a=a===""?".":a+":",Iw(e))for(var u=0;u<e.length;u++){p=e[u];var T=a+P_(p,u);f+=rm(p,t,i,T,h)}else if(T=NA(e),typeof T=="function")for(e=T.call(e),u=0;!(p=e.next()).done;)p=p.value,T=a+P_(p,u++),f+=rm(p,t,i,T,h);else if(p==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return f}function Dp(e,t,i){if(e==null)return e;var a=[],h=0;return rm(e,a,"","",function(p){return t.call(i,p,h++)}),a}function UA(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(i){(e._status===0||e._status===-1)&&(e._status=1,e._result=i)},function(i){(e._status===0||e._status===-1)&&(e._status=2,e._result=i)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ii={current:null},im={transition:null},qA={ReactCurrentDispatcher:ii,ReactCurrentBatchConfig:im,ReactCurrentOwner:K0};function sC(){throw Error("act(...) is not supported in production builds of React.")}jt.Children={map:Dp,forEach:function(e,t,i){Dp(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return Dp(e,function(){t++}),t},toArray:function(e){return Dp(e,function(t){return t})||[]},only:function(e){if(!Y0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};jt.Component=jc;jt.Fragment=AA;jt.Profiler=DA;jt.PureComponent=H0;jt.StrictMode=zA;jt.Suspense=BA;jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qA;jt.act=sC;jt.cloneElement=function(e,t,i){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=QT({},e.props),h=e.key,p=e.ref,f=e._owner;if(t!=null){if(t.ref!==void 0&&(p=t.ref,f=K0.current),t.key!==void 0&&(h=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(T in t)nC.call(t,T)&&!rC.hasOwnProperty(T)&&(a[T]=t[T]===void 0&&u!==void 0?u[T]:t[T])}var T=arguments.length-2;if(T===1)a.children=i;else if(1<T){u=Array(T);for(var E=0;E<T;E++)u[E]=arguments[E+2];a.children=u}return{$$typeof:mf,type:e.type,key:h,ref:p,props:a,_owner:f}};jt.createContext=function(e){return e={$$typeof:LA,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:RA,_context:e},e.Consumer=e};jt.createElement=iC;jt.createFactory=function(e){var t=iC.bind(null,e);return t.type=e,t};jt.createRef=function(){return{current:null}};jt.forwardRef=function(e){return{$$typeof:FA,render:e}};jt.isValidElement=Y0;jt.lazy=function(e){return{$$typeof:VA,_payload:{_status:-1,_result:e},_init:UA}};jt.memo=function(e,t){return{$$typeof:OA,type:e,compare:t===void 0?null:t}};jt.startTransition=function(e){var t=im.transition;im.transition={};try{e()}finally{im.transition=t}};jt.unstable_act=sC;jt.useCallback=function(e,t){return ii.current.useCallback(e,t)};jt.useContext=function(e){return ii.current.useContext(e)};jt.useDebugValue=function(){};jt.useDeferredValue=function(e){return ii.current.useDeferredValue(e)};jt.useEffect=function(e,t){return ii.current.useEffect(e,t)};jt.useId=function(){return ii.current.useId()};jt.useImperativeHandle=function(e,t,i){return ii.current.useImperativeHandle(e,t,i)};jt.useInsertionEffect=function(e,t){return ii.current.useInsertionEffect(e,t)};jt.useLayoutEffect=function(e,t){return ii.current.useLayoutEffect(e,t)};jt.useMemo=function(e,t){return ii.current.useMemo(e,t)};jt.useReducer=function(e,t,i){return ii.current.useReducer(e,t,i)};jt.useRef=function(e){return ii.current.useRef(e)};jt.useState=function(e){return ii.current.useState(e)};jt.useSyncExternalStore=function(e,t,i){return ii.current.useSyncExternalStore(e,t,i)};jt.useTransition=function(){return ii.current.useTransition()};jt.version="18.3.1";YT.exports=jt;var le=YT.exports;const nc=XT(le),Cm=HT({__proto__:null,default:nc},[le]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GA=le,WA=Symbol.for("react.element"),ZA=Symbol.for("react.fragment"),HA=Object.prototype.hasOwnProperty,XA=GA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,KA={key:!0,ref:!0,__self:!0,__source:!0};function oC(e,t,i){var a,h={},p=null,f=null;i!==void 0&&(p=""+i),t.key!==void 0&&(p=""+t.key),t.ref!==void 0&&(f=t.ref);for(a in t)HA.call(t,a)&&!KA.hasOwnProperty(a)&&(h[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)h[a]===void 0&&(h[a]=t[a]);return{$$typeof:WA,type:e,key:p,ref:f,props:h,_owner:XA.current}}ug.Fragment=ZA;ug.jsx=oC;ug.jsxs=oC;KT.exports=ug;var Ae=KT.exports,aC={exports:{}},Wi={},lC={exports:{}},uC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Oe,et){var pt=Oe.length;Oe.push(et);e:for(;0<pt;){var Pt=pt-1>>>1,Bt=Oe[Pt];if(0<h(Bt,et))Oe[Pt]=et,Oe[pt]=Bt,pt=Pt;else break e}}function i(Oe){return Oe.length===0?null:Oe[0]}function a(Oe){if(Oe.length===0)return null;var et=Oe[0],pt=Oe.pop();if(pt!==et){Oe[0]=pt;e:for(var Pt=0,Bt=Oe.length,Gr=Bt>>>1;Pt<Gr;){var Gn=2*(Pt+1)-1,sr=Oe[Gn],or=Gn+1,Dn=Oe[or];if(0>h(sr,pt))or<Bt&&0>h(Dn,sr)?(Oe[Pt]=Dn,Oe[or]=pt,Pt=or):(Oe[Pt]=sr,Oe[Gn]=pt,Pt=Gn);else if(or<Bt&&0>h(Dn,pt))Oe[Pt]=Dn,Oe[or]=pt,Pt=or;else break e}}return et}function h(Oe,et){var pt=Oe.sortIndex-et.sortIndex;return pt!==0?pt:Oe.id-et.id}if(typeof performance=="object"&&typeof performance.now=="function"){var p=performance;e.unstable_now=function(){return p.now()}}else{var f=Date,u=f.now();e.unstable_now=function(){return f.now()-u}}var T=[],E=[],D=1,z=null,I=3,G=!1,K=!1,Q=!1,ce=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function X(Oe){for(var et=i(E);et!==null;){if(et.callback===null)a(E);else if(et.startTime<=Oe)a(E),et.sortIndex=et.expirationTime,t(T,et);else break;et=i(E)}}function ne(Oe){if(Q=!1,X(Oe),!K)if(i(T)!==null)K=!0,xt(ge);else{var et=i(E);et!==null&&_t(ne,et.startTime-Oe)}}function ge(Oe,et){K=!1,Q&&(Q=!1,j(Ie),Ie=-1),G=!0;var pt=I;try{for(X(et),z=i(T);z!==null&&(!(z.expirationTime>et)||Oe&&!Ve());){var Pt=z.callback;if(typeof Pt=="function"){z.callback=null,I=z.priorityLevel;var Bt=Pt(z.expirationTime<=et);et=e.unstable_now(),typeof Bt=="function"?z.callback=Bt:z===i(T)&&a(T),X(et)}else a(T);z=i(T)}if(z!==null)var Gr=!0;else{var Gn=i(E);Gn!==null&&_t(ne,Gn.startTime-et),Gr=!1}return Gr}finally{z=null,I=pt,G=!1}}var fe=!1,we=null,Ie=-1,Ne=5,$e=-1;function Ve(){return!(e.unstable_now()-$e<Ne)}function J(){if(we!==null){var Oe=e.unstable_now();$e=Oe;var et=!0;try{et=we(!0,Oe)}finally{et?ze():(fe=!1,we=null)}}else fe=!1}var ze;if(typeof U=="function")ze=function(){U(J)};else if(typeof MessageChannel<"u"){var Le=new MessageChannel,ot=Le.port2;Le.port1.onmessage=J,ze=function(){ot.postMessage(null)}}else ze=function(){ce(J,0)};function xt(Oe){we=Oe,fe||(fe=!0,ze())}function _t(Oe,et){Ie=ce(function(){Oe(e.unstable_now())},et)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Oe){Oe.callback=null},e.unstable_continueExecution=function(){K||G||(K=!0,xt(ge))},e.unstable_forceFrameRate=function(Oe){0>Oe||125<Oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ne=0<Oe?Math.floor(1e3/Oe):5},e.unstable_getCurrentPriorityLevel=function(){return I},e.unstable_getFirstCallbackNode=function(){return i(T)},e.unstable_next=function(Oe){switch(I){case 1:case 2:case 3:var et=3;break;default:et=I}var pt=I;I=et;try{return Oe()}finally{I=pt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Oe,et){switch(Oe){case 1:case 2:case 3:case 4:case 5:break;default:Oe=3}var pt=I;I=Oe;try{return et()}finally{I=pt}},e.unstable_scheduleCallback=function(Oe,et,pt){var Pt=e.unstable_now();switch(typeof pt=="object"&&pt!==null?(pt=pt.delay,pt=typeof pt=="number"&&0<pt?Pt+pt:Pt):pt=Pt,Oe){case 1:var Bt=-1;break;case 2:Bt=250;break;case 5:Bt=1073741823;break;case 4:Bt=1e4;break;default:Bt=5e3}return Bt=pt+Bt,Oe={id:D++,callback:et,priorityLevel:Oe,startTime:pt,expirationTime:Bt,sortIndex:-1},pt>Pt?(Oe.sortIndex=pt,t(E,Oe),i(T)===null&&Oe===i(E)&&(Q?(j(Ie),Ie=-1):Q=!0,_t(ne,pt-Pt))):(Oe.sortIndex=Bt,t(T,Oe),K||G||(K=!0,xt(ge))),Oe},e.unstable_shouldYield=Ve,e.unstable_wrapCallback=function(Oe){var et=I;return function(){var pt=I;I=et;try{return Oe.apply(this,arguments)}finally{I=pt}}}})(uC);lC.exports=uC;var YA=lC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JA=le,Gi=YA;function qe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cC=new Set,Nd={};function Jl(e,t){Ic(e,t),Ic(e+"Capture",t)}function Ic(e,t){for(Nd[e]=t,e=0;e<t.length;e++)cC.add(t[e])}var Lo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wv=Object.prototype.hasOwnProperty,QA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Aw={},zw={};function ez(e){return wv.call(zw,e)?!0:wv.call(Aw,e)?!1:QA.test(e)?zw[e]=!0:(Aw[e]=!0,!1)}function tz(e,t,i,a){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return a?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function nz(e,t,i,a){if(t===null||typeof t>"u"||tz(e,t,i,a))return!0;if(a)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function si(e,t,i,a,h,p,f){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=a,this.attributeNamespace=h,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=p,this.removeEmptyString=f}var Er={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Er[e]=new si(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Er[t]=new si(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Er[e]=new si(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Er[e]=new si(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Er[e]=new si(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Er[e]=new si(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Er[e]=new si(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Er[e]=new si(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Er[e]=new si(e,5,!1,e.toLowerCase(),null,!1,!1)});var J0=/[\-:]([a-z])/g;function Q0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(J0,Q0);Er[t]=new si(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(J0,Q0);Er[t]=new si(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(J0,Q0);Er[t]=new si(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Er[e]=new si(e,1,!1,e.toLowerCase(),null,!1,!1)});Er.xlinkHref=new si("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Er[e]=new si(e,1,!1,e.toLowerCase(),null,!0,!0)});function ex(e,t,i,a){var h=Er.hasOwnProperty(t)?Er[t]:null;(h!==null?h.type!==0:a||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(nz(t,i,h,a)&&(i=null),a||h===null?ez(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):h.mustUseProperty?e[h.propertyName]=i===null?h.type===3?!1:"":i:(t=h.attributeName,a=h.attributeNamespace,i===null?e.removeAttribute(t):(h=h.type,i=h===3||h===4&&i===!0?"":""+i,a?e.setAttributeNS(a,t,i):e.setAttribute(t,i))))}var $o=JA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rp=Symbol.for("react.element"),rc=Symbol.for("react.portal"),ic=Symbol.for("react.fragment"),tx=Symbol.for("react.strict_mode"),Sv=Symbol.for("react.profiler"),hC=Symbol.for("react.provider"),dC=Symbol.for("react.context"),nx=Symbol.for("react.forward_ref"),Tv=Symbol.for("react.suspense"),Cv=Symbol.for("react.suspense_list"),rx=Symbol.for("react.memo"),Pa=Symbol.for("react.lazy"),fC=Symbol.for("react.offscreen"),Dw=Symbol.iterator;function od(e){return e===null||typeof e!="object"?null:(e=Dw&&e[Dw]||e["@@iterator"],typeof e=="function"?e:null)}var zn=Object.assign,E_;function _d(e){if(E_===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);E_=t&&t[1]||""}return`
`+E_+e}var I_=!1;function M_(e,t){if(!e||I_)return"";I_=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(E){var a=E}Reflect.construct(e,[],t)}else{try{t.call()}catch(E){a=E}e.call(t.prototype)}else{try{throw Error()}catch(E){a=E}e()}}catch(E){if(E&&a&&typeof E.stack=="string"){for(var h=E.stack.split(`
`),p=a.stack.split(`
`),f=h.length-1,u=p.length-1;1<=f&&0<=u&&h[f]!==p[u];)u--;for(;1<=f&&0<=u;f--,u--)if(h[f]!==p[u]){if(f!==1||u!==1)do if(f--,u--,0>u||h[f]!==p[u]){var T=`
`+h[f].replace(" at new "," at ");return e.displayName&&T.includes("<anonymous>")&&(T=T.replace("<anonymous>",e.displayName)),T}while(1<=f&&0<=u);break}}}finally{I_=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?_d(e):""}function rz(e){switch(e.tag){case 5:return _d(e.type);case 16:return _d("Lazy");case 13:return _d("Suspense");case 19:return _d("SuspenseList");case 0:case 2:case 15:return e=M_(e.type,!1),e;case 11:return e=M_(e.type.render,!1),e;case 1:return e=M_(e.type,!0),e;default:return""}}function kv(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ic:return"Fragment";case rc:return"Portal";case Sv:return"Profiler";case tx:return"StrictMode";case Tv:return"Suspense";case Cv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case dC:return(e.displayName||"Context")+".Consumer";case hC:return(e._context.displayName||"Context")+".Provider";case nx:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case rx:return t=e.displayName||null,t!==null?t:kv(e.type)||"Memo";case Pa:t=e._payload,e=e._init;try{return kv(e(t))}catch{}}return null}function iz(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kv(t);case 8:return t===tx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function $a(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function pC(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function sz(e){var t=pC(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var h=i.get,p=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return h.call(this)},set:function(f){a=""+f,p.call(this,f)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return a},setValue:function(f){a=""+f},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Lp(e){e._valueTracker||(e._valueTracker=sz(e))}function mC(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),a="";return e&&(a=pC(e)?e.checked?"true":"false":e.value),e=a,e!==i?(t.setValue(e),!0):!1}function km(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Pv(e,t){var i=t.checked;return zn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function Rw(e,t){var i=t.defaultValue==null?"":t.defaultValue,a=t.checked!=null?t.checked:t.defaultChecked;i=$a(t.value!=null?t.value:i),e._wrapperState={initialChecked:a,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function gC(e,t){t=t.checked,t!=null&&ex(e,"checked",t,!1)}function Ev(e,t){gC(e,t);var i=$a(t.value),a=t.type;if(i!=null)a==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Iv(e,t.type,i):t.hasOwnProperty("defaultValue")&&Iv(e,t.type,$a(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Lw(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!(a!=="submit"&&a!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function Iv(e,t,i){(t!=="number"||km(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var vd=Array.isArray;function xc(e,t,i,a){if(e=e.options,t){t={};for(var h=0;h<i.length;h++)t["$"+i[h]]=!0;for(i=0;i<e.length;i++)h=t.hasOwnProperty("$"+e[i].value),e[i].selected!==h&&(e[i].selected=h),h&&a&&(e[i].defaultSelected=!0)}else{for(i=""+$a(i),t=null,h=0;h<e.length;h++){if(e[h].value===i){e[h].selected=!0,a&&(e[h].defaultSelected=!0);return}t!==null||e[h].disabled||(t=e[h])}t!==null&&(t.selected=!0)}}function Mv(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(qe(91));return zn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Fw(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(qe(92));if(vd(i)){if(1<i.length)throw Error(qe(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:$a(i)}}function yC(e,t){var i=$a(t.value),a=$a(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),a!=null&&(e.defaultValue=""+a)}function Bw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function _C(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Av(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?_C(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Fp,vC=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,a,h){MSApp.execUnsafeLocalFunction(function(){return e(t,i,a,h)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Fp=Fp||document.createElement("div"),Fp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Fp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function jd(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var Cd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oz=["Webkit","ms","Moz","O"];Object.keys(Cd).forEach(function(e){oz.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Cd[t]=Cd[e]})});function xC(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||Cd.hasOwnProperty(e)&&Cd[e]?(""+t).trim():t+"px"}function bC(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var a=i.indexOf("--")===0,h=xC(i,t[i],a);i==="float"&&(i="cssFloat"),a?e.setProperty(i,h):e[i]=h}}var az=zn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zv(e,t){if(t){if(az[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(qe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(qe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(qe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(qe(62))}}function Dv(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rv=null;function ix(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Lv=null,bc=null,wc=null;function Ow(e){if(e=_f(e)){if(typeof Lv!="function")throw Error(qe(280));var t=e.stateNode;t&&(t=pg(t),Lv(e.stateNode,e.type,t))}}function wC(e){bc?wc?wc.push(e):wc=[e]:bc=e}function SC(){if(bc){var e=bc,t=wc;if(wc=bc=null,Ow(e),t)for(e=0;e<t.length;e++)Ow(t[e])}}function TC(e,t){return e(t)}function CC(){}var A_=!1;function kC(e,t,i){if(A_)return e(t,i);A_=!0;try{return TC(e,t,i)}finally{A_=!1,(bc!==null||wc!==null)&&(CC(),SC())}}function $d(e,t){var i=e.stateNode;if(i===null)return null;var a=pg(i);if(a===null)return null;i=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(qe(231,t,typeof i));return i}var Fv=!1;if(Lo)try{var ad={};Object.defineProperty(ad,"passive",{get:function(){Fv=!0}}),window.addEventListener("test",ad,ad),window.removeEventListener("test",ad,ad)}catch{Fv=!1}function lz(e,t,i,a,h,p,f,u,T){var E=Array.prototype.slice.call(arguments,3);try{t.apply(i,E)}catch(D){this.onError(D)}}var kd=!1,Pm=null,Em=!1,Bv=null,uz={onError:function(e){kd=!0,Pm=e}};function cz(e,t,i,a,h,p,f,u,T){kd=!1,Pm=null,lz.apply(uz,arguments)}function hz(e,t,i,a,h,p,f,u,T){if(cz.apply(this,arguments),kd){if(kd){var E=Pm;kd=!1,Pm=null}else throw Error(qe(198));Em||(Em=!0,Bv=E)}}function Ql(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function PC(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Vw(e){if(Ql(e)!==e)throw Error(qe(188))}function dz(e){var t=e.alternate;if(!t){if(t=Ql(e),t===null)throw Error(qe(188));return t!==e?null:e}for(var i=e,a=t;;){var h=i.return;if(h===null)break;var p=h.alternate;if(p===null){if(a=h.return,a!==null){i=a;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===i)return Vw(h),e;if(p===a)return Vw(h),t;p=p.sibling}throw Error(qe(188))}if(i.return!==a.return)i=h,a=p;else{for(var f=!1,u=h.child;u;){if(u===i){f=!0,i=h,a=p;break}if(u===a){f=!0,a=h,i=p;break}u=u.sibling}if(!f){for(u=p.child;u;){if(u===i){f=!0,i=p,a=h;break}if(u===a){f=!0,a=p,i=h;break}u=u.sibling}if(!f)throw Error(qe(189))}}if(i.alternate!==a)throw Error(qe(190))}if(i.tag!==3)throw Error(qe(188));return i.stateNode.current===i?e:t}function EC(e){return e=dz(e),e!==null?IC(e):null}function IC(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=IC(e);if(t!==null)return t;e=e.sibling}return null}var MC=Gi.unstable_scheduleCallback,Nw=Gi.unstable_cancelCallback,fz=Gi.unstable_shouldYield,pz=Gi.unstable_requestPaint,Un=Gi.unstable_now,mz=Gi.unstable_getCurrentPriorityLevel,sx=Gi.unstable_ImmediatePriority,AC=Gi.unstable_UserBlockingPriority,Im=Gi.unstable_NormalPriority,gz=Gi.unstable_LowPriority,zC=Gi.unstable_IdlePriority,cg=null,eo=null;function yz(e){if(eo&&typeof eo.onCommitFiberRoot=="function")try{eo.onCommitFiberRoot(cg,e,void 0,(e.current.flags&128)===128)}catch{}}var Ds=Math.clz32?Math.clz32:xz,_z=Math.log,vz=Math.LN2;function xz(e){return e>>>=0,e===0?32:31-(_z(e)/vz|0)|0}var Bp=64,Op=4194304;function xd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Mm(e,t){var i=e.pendingLanes;if(i===0)return 0;var a=0,h=e.suspendedLanes,p=e.pingedLanes,f=i&268435455;if(f!==0){var u=f&~h;u!==0?a=xd(u):(p&=f,p!==0&&(a=xd(p)))}else f=i&~h,f!==0?a=xd(f):p!==0&&(a=xd(p));if(a===0)return 0;if(t!==0&&t!==a&&!(t&h)&&(h=a&-a,p=t&-t,h>=p||h===16&&(p&4194240)!==0))return t;if(a&4&&(a|=i&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=a;0<t;)i=31-Ds(t),h=1<<i,a|=e[i],t&=~h;return a}function bz(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wz(e,t){for(var i=e.suspendedLanes,a=e.pingedLanes,h=e.expirationTimes,p=e.pendingLanes;0<p;){var f=31-Ds(p),u=1<<f,T=h[f];T===-1?(!(u&i)||u&a)&&(h[f]=bz(u,t)):T<=t&&(e.expiredLanes|=u),p&=~u}}function Ov(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function DC(){var e=Bp;return Bp<<=1,!(Bp&4194240)&&(Bp=64),e}function z_(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function gf(e,t,i){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ds(t),e[t]=i}function Sz(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<i;){var h=31-Ds(i),p=1<<h;t[h]=0,a[h]=-1,e[h]=-1,i&=~p}}function ox(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var a=31-Ds(i),h=1<<a;h&t|e[a]&t&&(e[a]|=t),i&=~h}}var on=0;function RC(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var LC,ax,FC,BC,OC,Vv=!1,Vp=[],Da=null,Ra=null,La=null,Ud=new Map,qd=new Map,Ia=[],Tz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jw(e,t){switch(e){case"focusin":case"focusout":Da=null;break;case"dragenter":case"dragleave":Ra=null;break;case"mouseover":case"mouseout":La=null;break;case"pointerover":case"pointerout":Ud.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":qd.delete(t.pointerId)}}function ld(e,t,i,a,h,p){return e===null||e.nativeEvent!==p?(e={blockedOn:t,domEventName:i,eventSystemFlags:a,nativeEvent:p,targetContainers:[h]},t!==null&&(t=_f(t),t!==null&&ax(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,h!==null&&t.indexOf(h)===-1&&t.push(h),e)}function Cz(e,t,i,a,h){switch(t){case"focusin":return Da=ld(Da,e,t,i,a,h),!0;case"dragenter":return Ra=ld(Ra,e,t,i,a,h),!0;case"mouseover":return La=ld(La,e,t,i,a,h),!0;case"pointerover":var p=h.pointerId;return Ud.set(p,ld(Ud.get(p)||null,e,t,i,a,h)),!0;case"gotpointercapture":return p=h.pointerId,qd.set(p,ld(qd.get(p)||null,e,t,i,a,h)),!0}return!1}function VC(e){var t=Dl(e.target);if(t!==null){var i=Ql(t);if(i!==null){if(t=i.tag,t===13){if(t=PC(i),t!==null){e.blockedOn=t,OC(e.priority,function(){FC(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function sm(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=Nv(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var a=new i.constructor(i.type,i);Rv=a,i.target.dispatchEvent(a),Rv=null}else return t=_f(i),t!==null&&ax(t),e.blockedOn=i,!1;t.shift()}return!0}function $w(e,t,i){sm(e)&&i.delete(t)}function kz(){Vv=!1,Da!==null&&sm(Da)&&(Da=null),Ra!==null&&sm(Ra)&&(Ra=null),La!==null&&sm(La)&&(La=null),Ud.forEach($w),qd.forEach($w)}function ud(e,t){e.blockedOn===t&&(e.blockedOn=null,Vv||(Vv=!0,Gi.unstable_scheduleCallback(Gi.unstable_NormalPriority,kz)))}function Gd(e){function t(h){return ud(h,e)}if(0<Vp.length){ud(Vp[0],e);for(var i=1;i<Vp.length;i++){var a=Vp[i];a.blockedOn===e&&(a.blockedOn=null)}}for(Da!==null&&ud(Da,e),Ra!==null&&ud(Ra,e),La!==null&&ud(La,e),Ud.forEach(t),qd.forEach(t),i=0;i<Ia.length;i++)a=Ia[i],a.blockedOn===e&&(a.blockedOn=null);for(;0<Ia.length&&(i=Ia[0],i.blockedOn===null);)VC(i),i.blockedOn===null&&Ia.shift()}var Sc=$o.ReactCurrentBatchConfig,Am=!0;function Pz(e,t,i,a){var h=on,p=Sc.transition;Sc.transition=null;try{on=1,lx(e,t,i,a)}finally{on=h,Sc.transition=p}}function Ez(e,t,i,a){var h=on,p=Sc.transition;Sc.transition=null;try{on=4,lx(e,t,i,a)}finally{on=h,Sc.transition=p}}function lx(e,t,i,a){if(Am){var h=Nv(e,t,i,a);if(h===null)$_(e,t,a,zm,i),jw(e,a);else if(Cz(h,e,t,i,a))a.stopPropagation();else if(jw(e,a),t&4&&-1<Tz.indexOf(e)){for(;h!==null;){var p=_f(h);if(p!==null&&LC(p),p=Nv(e,t,i,a),p===null&&$_(e,t,a,zm,i),p===h)break;h=p}h!==null&&a.stopPropagation()}else $_(e,t,a,null,i)}}var zm=null;function Nv(e,t,i,a){if(zm=null,e=ix(a),e=Dl(e),e!==null)if(t=Ql(e),t===null)e=null;else if(i=t.tag,i===13){if(e=PC(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return zm=e,null}function NC(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mz()){case sx:return 1;case AC:return 4;case Im:case gz:return 16;case zC:return 536870912;default:return 16}default:return 16}}var Aa=null,ux=null,om=null;function jC(){if(om)return om;var e,t=ux,i=t.length,a,h="value"in Aa?Aa.value:Aa.textContent,p=h.length;for(e=0;e<i&&t[e]===h[e];e++);var f=i-e;for(a=1;a<=f&&t[i-a]===h[p-a];a++);return om=h.slice(e,1<a?1-a:void 0)}function am(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Np(){return!0}function Uw(){return!1}function Zi(e){function t(i,a,h,p,f){this._reactName=i,this._targetInst=h,this.type=a,this.nativeEvent=p,this.target=f,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(i=e[u],this[u]=i?i(p):p[u]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Np:Uw,this.isPropagationStopped=Uw,this}return zn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Np)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Np)},persist:function(){},isPersistent:Np}),t}var $c={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cx=Zi($c),yf=zn({},$c,{view:0,detail:0}),Iz=Zi(yf),D_,R_,cd,hg=zn({},yf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cd&&(cd&&e.type==="mousemove"?(D_=e.screenX-cd.screenX,R_=e.screenY-cd.screenY):R_=D_=0,cd=e),D_)},movementY:function(e){return"movementY"in e?e.movementY:R_}}),qw=Zi(hg),Mz=zn({},hg,{dataTransfer:0}),Az=Zi(Mz),zz=zn({},yf,{relatedTarget:0}),L_=Zi(zz),Dz=zn({},$c,{animationName:0,elapsedTime:0,pseudoElement:0}),Rz=Zi(Dz),Lz=zn({},$c,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Fz=Zi(Lz),Bz=zn({},$c,{data:0}),Gw=Zi(Bz),Oz={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vz={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nz={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jz(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Nz[e])?!!t[e]:!1}function hx(){return jz}var $z=zn({},yf,{key:function(e){if(e.key){var t=Oz[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=am(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Vz[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hx,charCode:function(e){return e.type==="keypress"?am(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?am(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Uz=Zi($z),qz=zn({},hg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ww=Zi(qz),Gz=zn({},yf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hx}),Wz=Zi(Gz),Zz=zn({},$c,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hz=Zi(Zz),Xz=zn({},hg,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Kz=Zi(Xz),Yz=[9,13,27,32],dx=Lo&&"CompositionEvent"in window,Pd=null;Lo&&"documentMode"in document&&(Pd=document.documentMode);var Jz=Lo&&"TextEvent"in window&&!Pd,$C=Lo&&(!dx||Pd&&8<Pd&&11>=Pd),Zw=" ",Hw=!1;function UC(e,t){switch(e){case"keyup":return Yz.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qC(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var sc=!1;function Qz(e,t){switch(e){case"compositionend":return qC(t);case"keypress":return t.which!==32?null:(Hw=!0,Zw);case"textInput":return e=t.data,e===Zw&&Hw?null:e;default:return null}}function eD(e,t){if(sc)return e==="compositionend"||!dx&&UC(e,t)?(e=jC(),om=ux=Aa=null,sc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return $C&&t.locale!=="ko"?null:t.data;default:return null}}var tD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!tD[e.type]:t==="textarea"}function GC(e,t,i,a){wC(a),t=Dm(t,"onChange"),0<t.length&&(i=new cx("onChange","change",null,i,a),e.push({event:i,listeners:t}))}var Ed=null,Wd=null;function nD(e){nk(e,0)}function dg(e){var t=lc(e);if(mC(t))return e}function rD(e,t){if(e==="change")return t}var WC=!1;if(Lo){var F_;if(Lo){var B_="oninput"in document;if(!B_){var Kw=document.createElement("div");Kw.setAttribute("oninput","return;"),B_=typeof Kw.oninput=="function"}F_=B_}else F_=!1;WC=F_&&(!document.documentMode||9<document.documentMode)}function Yw(){Ed&&(Ed.detachEvent("onpropertychange",ZC),Wd=Ed=null)}function ZC(e){if(e.propertyName==="value"&&dg(Wd)){var t=[];GC(t,Wd,e,ix(e)),kC(nD,t)}}function iD(e,t,i){e==="focusin"?(Yw(),Ed=t,Wd=i,Ed.attachEvent("onpropertychange",ZC)):e==="focusout"&&Yw()}function sD(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return dg(Wd)}function oD(e,t){if(e==="click")return dg(t)}function aD(e,t){if(e==="input"||e==="change")return dg(t)}function lD(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ls=typeof Object.is=="function"?Object.is:lD;function Zd(e,t){if(Ls(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(a=0;a<i.length;a++){var h=i[a];if(!wv.call(t,h)||!Ls(e[h],t[h]))return!1}return!0}function Jw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Qw(e,t){var i=Jw(e);e=0;for(var a;i;){if(i.nodeType===3){if(a=e+i.textContent.length,e<=t&&a>=t)return{node:i,offset:t-e};e=a}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Jw(i)}}function HC(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?HC(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function XC(){for(var e=window,t=km();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=km(e.document)}return t}function fx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function uD(e){var t=XC(),i=e.focusedElem,a=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&HC(i.ownerDocument.documentElement,i)){if(a!==null&&fx(i)){if(t=a.start,e=a.end,e===void 0&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if(e=(t=i.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var h=i.textContent.length,p=Math.min(a.start,h);a=a.end===void 0?p:Math.min(a.end,h),!e.extend&&p>a&&(h=a,a=p,p=h),h=Qw(i,p);var f=Qw(i,a);h&&f&&(e.rangeCount!==1||e.anchorNode!==h.node||e.anchorOffset!==h.offset||e.focusNode!==f.node||e.focusOffset!==f.offset)&&(t=t.createRange(),t.setStart(h.node,h.offset),e.removeAllRanges(),p>a?(e.addRange(t),e.extend(f.node,f.offset)):(t.setEnd(f.node,f.offset),e.addRange(t)))}}for(t=[],e=i;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<t.length;i++)e=t[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var cD=Lo&&"documentMode"in document&&11>=document.documentMode,oc=null,jv=null,Id=null,$v=!1;function e2(e,t,i){var a=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;$v||oc==null||oc!==km(a)||(a=oc,"selectionStart"in a&&fx(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Id&&Zd(Id,a)||(Id=a,a=Dm(jv,"onSelect"),0<a.length&&(t=new cx("onSelect","select",null,t,i),e.push({event:t,listeners:a}),t.target=oc)))}function jp(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var ac={animationend:jp("Animation","AnimationEnd"),animationiteration:jp("Animation","AnimationIteration"),animationstart:jp("Animation","AnimationStart"),transitionend:jp("Transition","TransitionEnd")},O_={},KC={};Lo&&(KC=document.createElement("div").style,"AnimationEvent"in window||(delete ac.animationend.animation,delete ac.animationiteration.animation,delete ac.animationstart.animation),"TransitionEvent"in window||delete ac.transitionend.transition);function fg(e){if(O_[e])return O_[e];if(!ac[e])return e;var t=ac[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in KC)return O_[e]=t[i];return e}var YC=fg("animationend"),JC=fg("animationiteration"),QC=fg("animationstart"),ek=fg("transitionend"),tk=new Map,t2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Za(e,t){tk.set(e,t),Jl(t,[e])}for(var V_=0;V_<t2.length;V_++){var N_=t2[V_],hD=N_.toLowerCase(),dD=N_[0].toUpperCase()+N_.slice(1);Za(hD,"on"+dD)}Za(YC,"onAnimationEnd");Za(JC,"onAnimationIteration");Za(QC,"onAnimationStart");Za("dblclick","onDoubleClick");Za("focusin","onFocus");Za("focusout","onBlur");Za(ek,"onTransitionEnd");Ic("onMouseEnter",["mouseout","mouseover"]);Ic("onMouseLeave",["mouseout","mouseover"]);Ic("onPointerEnter",["pointerout","pointerover"]);Ic("onPointerLeave",["pointerout","pointerover"]);Jl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Jl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Jl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Jl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Jl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Jl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fD=new Set("cancel close invalid load scroll toggle".split(" ").concat(bd));function n2(e,t,i){var a=e.type||"unknown-event";e.currentTarget=i,hz(a,t,void 0,e),e.currentTarget=null}function nk(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var a=e[i],h=a.event;a=a.listeners;e:{var p=void 0;if(t)for(var f=a.length-1;0<=f;f--){var u=a[f],T=u.instance,E=u.currentTarget;if(u=u.listener,T!==p&&h.isPropagationStopped())break e;n2(h,u,E),p=T}else for(f=0;f<a.length;f++){if(u=a[f],T=u.instance,E=u.currentTarget,u=u.listener,T!==p&&h.isPropagationStopped())break e;n2(h,u,E),p=T}}}if(Em)throw e=Bv,Em=!1,Bv=null,e}function vn(e,t){var i=t[Zv];i===void 0&&(i=t[Zv]=new Set);var a=e+"__bubble";i.has(a)||(rk(t,e,2,!1),i.add(a))}function j_(e,t,i){var a=0;t&&(a|=4),rk(i,e,a,t)}var $p="_reactListening"+Math.random().toString(36).slice(2);function Hd(e){if(!e[$p]){e[$p]=!0,cC.forEach(function(i){i!=="selectionchange"&&(fD.has(i)||j_(i,!1,e),j_(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[$p]||(t[$p]=!0,j_("selectionchange",!1,t))}}function rk(e,t,i,a){switch(NC(t)){case 1:var h=Pz;break;case 4:h=Ez;break;default:h=lx}i=h.bind(null,t,i,e),h=void 0,!Fv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(h=!0),a?h!==void 0?e.addEventListener(t,i,{capture:!0,passive:h}):e.addEventListener(t,i,!0):h!==void 0?e.addEventListener(t,i,{passive:h}):e.addEventListener(t,i,!1)}function $_(e,t,i,a,h){var p=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var f=a.tag;if(f===3||f===4){var u=a.stateNode.containerInfo;if(u===h||u.nodeType===8&&u.parentNode===h)break;if(f===4)for(f=a.return;f!==null;){var T=f.tag;if((T===3||T===4)&&(T=f.stateNode.containerInfo,T===h||T.nodeType===8&&T.parentNode===h))return;f=f.return}for(;u!==null;){if(f=Dl(u),f===null)return;if(T=f.tag,T===5||T===6){a=p=f;continue e}u=u.parentNode}}a=a.return}kC(function(){var E=p,D=ix(i),z=[];e:{var I=tk.get(e);if(I!==void 0){var G=cx,K=e;switch(e){case"keypress":if(am(i)===0)break e;case"keydown":case"keyup":G=Uz;break;case"focusin":K="focus",G=L_;break;case"focusout":K="blur",G=L_;break;case"beforeblur":case"afterblur":G=L_;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":G=qw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":G=Az;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":G=Wz;break;case YC:case JC:case QC:G=Rz;break;case ek:G=Hz;break;case"scroll":G=Iz;break;case"wheel":G=Kz;break;case"copy":case"cut":case"paste":G=Fz;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":G=Ww}var Q=(t&4)!==0,ce=!Q&&e==="scroll",j=Q?I!==null?I+"Capture":null:I;Q=[];for(var U=E,X;U!==null;){X=U;var ne=X.stateNode;if(X.tag===5&&ne!==null&&(X=ne,j!==null&&(ne=$d(U,j),ne!=null&&Q.push(Xd(U,ne,X)))),ce)break;U=U.return}0<Q.length&&(I=new G(I,K,null,i,D),z.push({event:I,listeners:Q}))}}if(!(t&7)){e:{if(I=e==="mouseover"||e==="pointerover",G=e==="mouseout"||e==="pointerout",I&&i!==Rv&&(K=i.relatedTarget||i.fromElement)&&(Dl(K)||K[Fo]))break e;if((G||I)&&(I=D.window===D?D:(I=D.ownerDocument)?I.defaultView||I.parentWindow:window,G?(K=i.relatedTarget||i.toElement,G=E,K=K?Dl(K):null,K!==null&&(ce=Ql(K),K!==ce||K.tag!==5&&K.tag!==6)&&(K=null)):(G=null,K=E),G!==K)){if(Q=qw,ne="onMouseLeave",j="onMouseEnter",U="mouse",(e==="pointerout"||e==="pointerover")&&(Q=Ww,ne="onPointerLeave",j="onPointerEnter",U="pointer"),ce=G==null?I:lc(G),X=K==null?I:lc(K),I=new Q(ne,U+"leave",G,i,D),I.target=ce,I.relatedTarget=X,ne=null,Dl(D)===E&&(Q=new Q(j,U+"enter",K,i,D),Q.target=X,Q.relatedTarget=ce,ne=Q),ce=ne,G&&K)t:{for(Q=G,j=K,U=0,X=Q;X;X=Xu(X))U++;for(X=0,ne=j;ne;ne=Xu(ne))X++;for(;0<U-X;)Q=Xu(Q),U--;for(;0<X-U;)j=Xu(j),X--;for(;U--;){if(Q===j||j!==null&&Q===j.alternate)break t;Q=Xu(Q),j=Xu(j)}Q=null}else Q=null;G!==null&&r2(z,I,G,Q,!1),K!==null&&ce!==null&&r2(z,ce,K,Q,!0)}}e:{if(I=E?lc(E):window,G=I.nodeName&&I.nodeName.toLowerCase(),G==="select"||G==="input"&&I.type==="file")var ge=rD;else if(Xw(I))if(WC)ge=aD;else{ge=sD;var fe=iD}else(G=I.nodeName)&&G.toLowerCase()==="input"&&(I.type==="checkbox"||I.type==="radio")&&(ge=oD);if(ge&&(ge=ge(e,E))){GC(z,ge,i,D);break e}fe&&fe(e,I,E),e==="focusout"&&(fe=I._wrapperState)&&fe.controlled&&I.type==="number"&&Iv(I,"number",I.value)}switch(fe=E?lc(E):window,e){case"focusin":(Xw(fe)||fe.contentEditable==="true")&&(oc=fe,jv=E,Id=null);break;case"focusout":Id=jv=oc=null;break;case"mousedown":$v=!0;break;case"contextmenu":case"mouseup":case"dragend":$v=!1,e2(z,i,D);break;case"selectionchange":if(cD)break;case"keydown":case"keyup":e2(z,i,D)}var we;if(dx)e:{switch(e){case"compositionstart":var Ie="onCompositionStart";break e;case"compositionend":Ie="onCompositionEnd";break e;case"compositionupdate":Ie="onCompositionUpdate";break e}Ie=void 0}else sc?UC(e,i)&&(Ie="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(Ie="onCompositionStart");Ie&&($C&&i.locale!=="ko"&&(sc||Ie!=="onCompositionStart"?Ie==="onCompositionEnd"&&sc&&(we=jC()):(Aa=D,ux="value"in Aa?Aa.value:Aa.textContent,sc=!0)),fe=Dm(E,Ie),0<fe.length&&(Ie=new Gw(Ie,e,null,i,D),z.push({event:Ie,listeners:fe}),we?Ie.data=we:(we=qC(i),we!==null&&(Ie.data=we)))),(we=Jz?Qz(e,i):eD(e,i))&&(E=Dm(E,"onBeforeInput"),0<E.length&&(D=new Gw("onBeforeInput","beforeinput",null,i,D),z.push({event:D,listeners:E}),D.data=we))}nk(z,t)})}function Xd(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Dm(e,t){for(var i=t+"Capture",a=[];e!==null;){var h=e,p=h.stateNode;h.tag===5&&p!==null&&(h=p,p=$d(e,i),p!=null&&a.unshift(Xd(e,p,h)),p=$d(e,t),p!=null&&a.push(Xd(e,p,h))),e=e.return}return a}function Xu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function r2(e,t,i,a,h){for(var p=t._reactName,f=[];i!==null&&i!==a;){var u=i,T=u.alternate,E=u.stateNode;if(T!==null&&T===a)break;u.tag===5&&E!==null&&(u=E,h?(T=$d(i,p),T!=null&&f.unshift(Xd(i,T,u))):h||(T=$d(i,p),T!=null&&f.push(Xd(i,T,u)))),i=i.return}f.length!==0&&e.push({event:t,listeners:f})}var pD=/\r\n?/g,mD=/\u0000|\uFFFD/g;function i2(e){return(typeof e=="string"?e:""+e).replace(pD,`
`).replace(mD,"")}function Up(e,t,i){if(t=i2(t),i2(e)!==t&&i)throw Error(qe(425))}function Rm(){}var Uv=null,qv=null;function Gv(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Wv=typeof setTimeout=="function"?setTimeout:void 0,gD=typeof clearTimeout=="function"?clearTimeout:void 0,s2=typeof Promise=="function"?Promise:void 0,yD=typeof queueMicrotask=="function"?queueMicrotask:typeof s2<"u"?function(e){return s2.resolve(null).then(e).catch(_D)}:Wv;function _D(e){setTimeout(function(){throw e})}function U_(e,t){var i=t,a=0;do{var h=i.nextSibling;if(e.removeChild(i),h&&h.nodeType===8)if(i=h.data,i==="/$"){if(a===0){e.removeChild(h),Gd(t);return}a--}else i!=="$"&&i!=="$?"&&i!=="$!"||a++;i=h}while(i);Gd(t)}function Fa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function o2(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var Uc=Math.random().toString(36).slice(2),Qs="__reactFiber$"+Uc,Kd="__reactProps$"+Uc,Fo="__reactContainer$"+Uc,Zv="__reactEvents$"+Uc,vD="__reactListeners$"+Uc,xD="__reactHandles$"+Uc;function Dl(e){var t=e[Qs];if(t)return t;for(var i=e.parentNode;i;){if(t=i[Fo]||i[Qs]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=o2(e);e!==null;){if(i=e[Qs])return i;e=o2(e)}return t}e=i,i=e.parentNode}return null}function _f(e){return e=e[Qs]||e[Fo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function lc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(qe(33))}function pg(e){return e[Kd]||null}var Hv=[],uc=-1;function Ha(e){return{current:e}}function xn(e){0>uc||(e.current=Hv[uc],Hv[uc]=null,uc--)}function gn(e,t){uc++,Hv[uc]=e.current,e.current=t}var Ua={},qr=Ha(Ua),xi=Ha(!1),Wl=Ua;function Mc(e,t){var i=e.type.contextTypes;if(!i)return Ua;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var h={},p;for(p in i)h[p]=t[p];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=h),h}function bi(e){return e=e.childContextTypes,e!=null}function Lm(){xn(xi),xn(qr)}function a2(e,t,i){if(qr.current!==Ua)throw Error(qe(168));gn(qr,t),gn(xi,i)}function ik(e,t,i){var a=e.stateNode;if(t=t.childContextTypes,typeof a.getChildContext!="function")return i;a=a.getChildContext();for(var h in a)if(!(h in t))throw Error(qe(108,iz(e)||"Unknown",h));return zn({},i,a)}function Fm(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ua,Wl=qr.current,gn(qr,e),gn(xi,xi.current),!0}function l2(e,t,i){var a=e.stateNode;if(!a)throw Error(qe(169));i?(e=ik(e,t,Wl),a.__reactInternalMemoizedMergedChildContext=e,xn(xi),xn(qr),gn(qr,e)):xn(xi),gn(xi,i)}var Mo=null,mg=!1,q_=!1;function sk(e){Mo===null?Mo=[e]:Mo.push(e)}function bD(e){mg=!0,sk(e)}function Xa(){if(!q_&&Mo!==null){q_=!0;var e=0,t=on;try{var i=Mo;for(on=1;e<i.length;e++){var a=i[e];do a=a(!0);while(a!==null)}Mo=null,mg=!1}catch(h){throw Mo!==null&&(Mo=Mo.slice(e+1)),MC(sx,Xa),h}finally{on=t,q_=!1}}return null}var cc=[],hc=0,Bm=null,Om=0,us=[],cs=0,Zl=null,zo=1,Do="";function Ml(e,t){cc[hc++]=Om,cc[hc++]=Bm,Bm=e,Om=t}function ok(e,t,i){us[cs++]=zo,us[cs++]=Do,us[cs++]=Zl,Zl=e;var a=zo;e=Do;var h=32-Ds(a)-1;a&=~(1<<h),i+=1;var p=32-Ds(t)+h;if(30<p){var f=h-h%5;p=(a&(1<<f)-1).toString(32),a>>=f,h-=f,zo=1<<32-Ds(t)+h|i<<h|a,Do=p+e}else zo=1<<p|i<<h|a,Do=e}function px(e){e.return!==null&&(Ml(e,1),ok(e,1,0))}function mx(e){for(;e===Bm;)Bm=cc[--hc],cc[hc]=null,Om=cc[--hc],cc[hc]=null;for(;e===Zl;)Zl=us[--cs],us[cs]=null,Do=us[--cs],us[cs]=null,zo=us[--cs],us[cs]=null}var $i=null,ji=null,Cn=!1,zs=null;function ak(e,t){var i=ds(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)}function u2(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,$i=e,ji=Fa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,$i=e,ji=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(i=Zl!==null?{id:zo,overflow:Do}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},i=ds(18,null,null,0),i.stateNode=t,i.return=e,e.child=i,$i=e,ji=null,!0):!1;default:return!1}}function Xv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Kv(e){if(Cn){var t=ji;if(t){var i=t;if(!u2(e,t)){if(Xv(e))throw Error(qe(418));t=Fa(i.nextSibling);var a=$i;t&&u2(e,t)?ak(a,i):(e.flags=e.flags&-4097|2,Cn=!1,$i=e)}}else{if(Xv(e))throw Error(qe(418));e.flags=e.flags&-4097|2,Cn=!1,$i=e}}}function c2(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;$i=e}function qp(e){if(e!==$i)return!1;if(!Cn)return c2(e),Cn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Gv(e.type,e.memoizedProps)),t&&(t=ji)){if(Xv(e))throw lk(),Error(qe(418));for(;t;)ak(e,t),t=Fa(t.nextSibling)}if(c2(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(qe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){ji=Fa(e.nextSibling);break e}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}ji=null}}else ji=$i?Fa(e.stateNode.nextSibling):null;return!0}function lk(){for(var e=ji;e;)e=Fa(e.nextSibling)}function Ac(){ji=$i=null,Cn=!1}function gx(e){zs===null?zs=[e]:zs.push(e)}var wD=$o.ReactCurrentBatchConfig;function hd(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(qe(309));var a=i.stateNode}if(!a)throw Error(qe(147,e));var h=a,p=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===p?t.ref:(t=function(f){var u=h.refs;f===null?delete u[p]:u[p]=f},t._stringRef=p,t)}if(typeof e!="string")throw Error(qe(284));if(!i._owner)throw Error(qe(290,e))}return e}function Gp(e,t){throw e=Object.prototype.toString.call(t),Error(qe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function h2(e){var t=e._init;return t(e._payload)}function uk(e){function t(j,U){if(e){var X=j.deletions;X===null?(j.deletions=[U],j.flags|=16):X.push(U)}}function i(j,U){if(!e)return null;for(;U!==null;)t(j,U),U=U.sibling;return null}function a(j,U){for(j=new Map;U!==null;)U.key!==null?j.set(U.key,U):j.set(U.index,U),U=U.sibling;return j}function h(j,U){return j=Na(j,U),j.index=0,j.sibling=null,j}function p(j,U,X){return j.index=X,e?(X=j.alternate,X!==null?(X=X.index,X<U?(j.flags|=2,U):X):(j.flags|=2,U)):(j.flags|=1048576,U)}function f(j){return e&&j.alternate===null&&(j.flags|=2),j}function u(j,U,X,ne){return U===null||U.tag!==6?(U=Y_(X,j.mode,ne),U.return=j,U):(U=h(U,X),U.return=j,U)}function T(j,U,X,ne){var ge=X.type;return ge===ic?D(j,U,X.props.children,ne,X.key):U!==null&&(U.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===Pa&&h2(ge)===U.type)?(ne=h(U,X.props),ne.ref=hd(j,U,X),ne.return=j,ne):(ne=pm(X.type,X.key,X.props,null,j.mode,ne),ne.ref=hd(j,U,X),ne.return=j,ne)}function E(j,U,X,ne){return U===null||U.tag!==4||U.stateNode.containerInfo!==X.containerInfo||U.stateNode.implementation!==X.implementation?(U=J_(X,j.mode,ne),U.return=j,U):(U=h(U,X.children||[]),U.return=j,U)}function D(j,U,X,ne,ge){return U===null||U.tag!==7?(U=$l(X,j.mode,ne,ge),U.return=j,U):(U=h(U,X),U.return=j,U)}function z(j,U,X){if(typeof U=="string"&&U!==""||typeof U=="number")return U=Y_(""+U,j.mode,X),U.return=j,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case Rp:return X=pm(U.type,U.key,U.props,null,j.mode,X),X.ref=hd(j,null,U),X.return=j,X;case rc:return U=J_(U,j.mode,X),U.return=j,U;case Pa:var ne=U._init;return z(j,ne(U._payload),X)}if(vd(U)||od(U))return U=$l(U,j.mode,X,null),U.return=j,U;Gp(j,U)}return null}function I(j,U,X,ne){var ge=U!==null?U.key:null;if(typeof X=="string"&&X!==""||typeof X=="number")return ge!==null?null:u(j,U,""+X,ne);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case Rp:return X.key===ge?T(j,U,X,ne):null;case rc:return X.key===ge?E(j,U,X,ne):null;case Pa:return ge=X._init,I(j,U,ge(X._payload),ne)}if(vd(X)||od(X))return ge!==null?null:D(j,U,X,ne,null);Gp(j,X)}return null}function G(j,U,X,ne,ge){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return j=j.get(X)||null,u(U,j,""+ne,ge);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case Rp:return j=j.get(ne.key===null?X:ne.key)||null,T(U,j,ne,ge);case rc:return j=j.get(ne.key===null?X:ne.key)||null,E(U,j,ne,ge);case Pa:var fe=ne._init;return G(j,U,X,fe(ne._payload),ge)}if(vd(ne)||od(ne))return j=j.get(X)||null,D(U,j,ne,ge,null);Gp(U,ne)}return null}function K(j,U,X,ne){for(var ge=null,fe=null,we=U,Ie=U=0,Ne=null;we!==null&&Ie<X.length;Ie++){we.index>Ie?(Ne=we,we=null):Ne=we.sibling;var $e=I(j,we,X[Ie],ne);if($e===null){we===null&&(we=Ne);break}e&&we&&$e.alternate===null&&t(j,we),U=p($e,U,Ie),fe===null?ge=$e:fe.sibling=$e,fe=$e,we=Ne}if(Ie===X.length)return i(j,we),Cn&&Ml(j,Ie),ge;if(we===null){for(;Ie<X.length;Ie++)we=z(j,X[Ie],ne),we!==null&&(U=p(we,U,Ie),fe===null?ge=we:fe.sibling=we,fe=we);return Cn&&Ml(j,Ie),ge}for(we=a(j,we);Ie<X.length;Ie++)Ne=G(we,j,Ie,X[Ie],ne),Ne!==null&&(e&&Ne.alternate!==null&&we.delete(Ne.key===null?Ie:Ne.key),U=p(Ne,U,Ie),fe===null?ge=Ne:fe.sibling=Ne,fe=Ne);return e&&we.forEach(function(Ve){return t(j,Ve)}),Cn&&Ml(j,Ie),ge}function Q(j,U,X,ne){var ge=od(X);if(typeof ge!="function")throw Error(qe(150));if(X=ge.call(X),X==null)throw Error(qe(151));for(var fe=ge=null,we=U,Ie=U=0,Ne=null,$e=X.next();we!==null&&!$e.done;Ie++,$e=X.next()){we.index>Ie?(Ne=we,we=null):Ne=we.sibling;var Ve=I(j,we,$e.value,ne);if(Ve===null){we===null&&(we=Ne);break}e&&we&&Ve.alternate===null&&t(j,we),U=p(Ve,U,Ie),fe===null?ge=Ve:fe.sibling=Ve,fe=Ve,we=Ne}if($e.done)return i(j,we),Cn&&Ml(j,Ie),ge;if(we===null){for(;!$e.done;Ie++,$e=X.next())$e=z(j,$e.value,ne),$e!==null&&(U=p($e,U,Ie),fe===null?ge=$e:fe.sibling=$e,fe=$e);return Cn&&Ml(j,Ie),ge}for(we=a(j,we);!$e.done;Ie++,$e=X.next())$e=G(we,j,Ie,$e.value,ne),$e!==null&&(e&&$e.alternate!==null&&we.delete($e.key===null?Ie:$e.key),U=p($e,U,Ie),fe===null?ge=$e:fe.sibling=$e,fe=$e);return e&&we.forEach(function(J){return t(j,J)}),Cn&&Ml(j,Ie),ge}function ce(j,U,X,ne){if(typeof X=="object"&&X!==null&&X.type===ic&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case Rp:e:{for(var ge=X.key,fe=U;fe!==null;){if(fe.key===ge){if(ge=X.type,ge===ic){if(fe.tag===7){i(j,fe.sibling),U=h(fe,X.props.children),U.return=j,j=U;break e}}else if(fe.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===Pa&&h2(ge)===fe.type){i(j,fe.sibling),U=h(fe,X.props),U.ref=hd(j,fe,X),U.return=j,j=U;break e}i(j,fe);break}else t(j,fe);fe=fe.sibling}X.type===ic?(U=$l(X.props.children,j.mode,ne,X.key),U.return=j,j=U):(ne=pm(X.type,X.key,X.props,null,j.mode,ne),ne.ref=hd(j,U,X),ne.return=j,j=ne)}return f(j);case rc:e:{for(fe=X.key;U!==null;){if(U.key===fe)if(U.tag===4&&U.stateNode.containerInfo===X.containerInfo&&U.stateNode.implementation===X.implementation){i(j,U.sibling),U=h(U,X.children||[]),U.return=j,j=U;break e}else{i(j,U);break}else t(j,U);U=U.sibling}U=J_(X,j.mode,ne),U.return=j,j=U}return f(j);case Pa:return fe=X._init,ce(j,U,fe(X._payload),ne)}if(vd(X))return K(j,U,X,ne);if(od(X))return Q(j,U,X,ne);Gp(j,X)}return typeof X=="string"&&X!==""||typeof X=="number"?(X=""+X,U!==null&&U.tag===6?(i(j,U.sibling),U=h(U,X),U.return=j,j=U):(i(j,U),U=Y_(X,j.mode,ne),U.return=j,j=U),f(j)):i(j,U)}return ce}var zc=uk(!0),ck=uk(!1),Vm=Ha(null),Nm=null,dc=null,yx=null;function _x(){yx=dc=Nm=null}function vx(e){var t=Vm.current;xn(Vm),e._currentValue=t}function Yv(e,t,i){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===i)break;e=e.return}}function Tc(e,t){Nm=e,yx=dc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(_i=!0),e.firstContext=null)}function ms(e){var t=e._currentValue;if(yx!==e)if(e={context:e,memoizedValue:t,next:null},dc===null){if(Nm===null)throw Error(qe(308));dc=e,Nm.dependencies={lanes:0,firstContext:e}}else dc=dc.next=e;return t}var Rl=null;function xx(e){Rl===null?Rl=[e]:Rl.push(e)}function hk(e,t,i,a){var h=t.interleaved;return h===null?(i.next=i,xx(t)):(i.next=h.next,h.next=i),t.interleaved=i,Bo(e,a)}function Bo(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}var Ea=!1;function bx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dk(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ro(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ba(e,t,i){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,Wt&2){var h=a.pending;return h===null?t.next=t:(t.next=h.next,h.next=t),a.pending=t,Bo(e,i)}return h=a.interleaved,h===null?(t.next=t,xx(a)):(t.next=h.next,h.next=t),a.interleaved=t,Bo(e,i)}function lm(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194240)!==0)){var a=t.lanes;a&=e.pendingLanes,i|=a,t.lanes=i,ox(e,i)}}function d2(e,t){var i=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,i===a)){var h=null,p=null;if(i=i.firstBaseUpdate,i!==null){do{var f={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};p===null?h=p=f:p=p.next=f,i=i.next}while(i!==null);p===null?h=p=t:p=p.next=t}else h=p=t;i={baseState:a.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:a.shared,effects:a.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function jm(e,t,i,a){var h=e.updateQueue;Ea=!1;var p=h.firstBaseUpdate,f=h.lastBaseUpdate,u=h.shared.pending;if(u!==null){h.shared.pending=null;var T=u,E=T.next;T.next=null,f===null?p=E:f.next=E,f=T;var D=e.alternate;D!==null&&(D=D.updateQueue,u=D.lastBaseUpdate,u!==f&&(u===null?D.firstBaseUpdate=E:u.next=E,D.lastBaseUpdate=T))}if(p!==null){var z=h.baseState;f=0,D=E=T=null,u=p;do{var I=u.lane,G=u.eventTime;if((a&I)===I){D!==null&&(D=D.next={eventTime:G,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var K=e,Q=u;switch(I=t,G=i,Q.tag){case 1:if(K=Q.payload,typeof K=="function"){z=K.call(G,z,I);break e}z=K;break e;case 3:K.flags=K.flags&-65537|128;case 0:if(K=Q.payload,I=typeof K=="function"?K.call(G,z,I):K,I==null)break e;z=zn({},z,I);break e;case 2:Ea=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,I=h.effects,I===null?h.effects=[u]:I.push(u))}else G={eventTime:G,lane:I,tag:u.tag,payload:u.payload,callback:u.callback,next:null},D===null?(E=D=G,T=z):D=D.next=G,f|=I;if(u=u.next,u===null){if(u=h.shared.pending,u===null)break;I=u,u=I.next,I.next=null,h.lastBaseUpdate=I,h.shared.pending=null}}while(!0);if(D===null&&(T=z),h.baseState=T,h.firstBaseUpdate=E,h.lastBaseUpdate=D,t=h.shared.interleaved,t!==null){h=t;do f|=h.lane,h=h.next;while(h!==t)}else p===null&&(h.shared.lanes=0);Xl|=f,e.lanes=f,e.memoizedState=z}}function f2(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var a=e[t],h=a.callback;if(h!==null){if(a.callback=null,a=i,typeof h!="function")throw Error(qe(191,h));h.call(a)}}}var vf={},to=Ha(vf),Yd=Ha(vf),Jd=Ha(vf);function Ll(e){if(e===vf)throw Error(qe(174));return e}function wx(e,t){switch(gn(Jd,t),gn(Yd,e),gn(to,vf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Av(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Av(t,e)}xn(to),gn(to,t)}function Dc(){xn(to),xn(Yd),xn(Jd)}function fk(e){Ll(Jd.current);var t=Ll(to.current),i=Av(t,e.type);t!==i&&(gn(Yd,e),gn(to,i))}function Sx(e){Yd.current===e&&(xn(to),xn(Yd))}var In=Ha(0);function $m(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var G_=[];function Tx(){for(var e=0;e<G_.length;e++)G_[e]._workInProgressVersionPrimary=null;G_.length=0}var um=$o.ReactCurrentDispatcher,W_=$o.ReactCurrentBatchConfig,Hl=0,An=null,nr=null,mr=null,Um=!1,Md=!1,Qd=0,SD=0;function Or(){throw Error(qe(321))}function Cx(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!Ls(e[i],t[i]))return!1;return!0}function kx(e,t,i,a,h,p){if(Hl=p,An=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,um.current=e===null||e.memoizedState===null?PD:ED,e=i(a,h),Md){p=0;do{if(Md=!1,Qd=0,25<=p)throw Error(qe(301));p+=1,mr=nr=null,t.updateQueue=null,um.current=ID,e=i(a,h)}while(Md)}if(um.current=qm,t=nr!==null&&nr.next!==null,Hl=0,mr=nr=An=null,Um=!1,t)throw Error(qe(300));return e}function Px(){var e=Qd!==0;return Qd=0,e}function Xs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mr===null?An.memoizedState=mr=e:mr=mr.next=e,mr}function gs(){if(nr===null){var e=An.alternate;e=e!==null?e.memoizedState:null}else e=nr.next;var t=mr===null?An.memoizedState:mr.next;if(t!==null)mr=t,nr=e;else{if(e===null)throw Error(qe(310));nr=e,e={memoizedState:nr.memoizedState,baseState:nr.baseState,baseQueue:nr.baseQueue,queue:nr.queue,next:null},mr===null?An.memoizedState=mr=e:mr=mr.next=e}return mr}function ef(e,t){return typeof t=="function"?t(e):t}function Z_(e){var t=gs(),i=t.queue;if(i===null)throw Error(qe(311));i.lastRenderedReducer=e;var a=nr,h=a.baseQueue,p=i.pending;if(p!==null){if(h!==null){var f=h.next;h.next=p.next,p.next=f}a.baseQueue=h=p,i.pending=null}if(h!==null){p=h.next,a=a.baseState;var u=f=null,T=null,E=p;do{var D=E.lane;if((Hl&D)===D)T!==null&&(T=T.next={lane:0,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null}),a=E.hasEagerState?E.eagerState:e(a,E.action);else{var z={lane:D,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null};T===null?(u=T=z,f=a):T=T.next=z,An.lanes|=D,Xl|=D}E=E.next}while(E!==null&&E!==p);T===null?f=a:T.next=u,Ls(a,t.memoizedState)||(_i=!0),t.memoizedState=a,t.baseState=f,t.baseQueue=T,i.lastRenderedState=a}if(e=i.interleaved,e!==null){h=e;do p=h.lane,An.lanes|=p,Xl|=p,h=h.next;while(h!==e)}else h===null&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function H_(e){var t=gs(),i=t.queue;if(i===null)throw Error(qe(311));i.lastRenderedReducer=e;var a=i.dispatch,h=i.pending,p=t.memoizedState;if(h!==null){i.pending=null;var f=h=h.next;do p=e(p,f.action),f=f.next;while(f!==h);Ls(p,t.memoizedState)||(_i=!0),t.memoizedState=p,t.baseQueue===null&&(t.baseState=p),i.lastRenderedState=p}return[p,a]}function pk(){}function mk(e,t){var i=An,a=gs(),h=t(),p=!Ls(a.memoizedState,h);if(p&&(a.memoizedState=h,_i=!0),a=a.queue,Ex(_k.bind(null,i,a,e),[e]),a.getSnapshot!==t||p||mr!==null&&mr.memoizedState.tag&1){if(i.flags|=2048,tf(9,yk.bind(null,i,a,h,t),void 0,null),gr===null)throw Error(qe(349));Hl&30||gk(i,t,h)}return h}function gk(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=An.updateQueue,t===null?(t={lastEffect:null,stores:null},An.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function yk(e,t,i,a){t.value=i,t.getSnapshot=a,vk(t)&&xk(e)}function _k(e,t,i){return i(function(){vk(t)&&xk(e)})}function vk(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!Ls(e,i)}catch{return!0}}function xk(e){var t=Bo(e,1);t!==null&&Rs(t,e,1,-1)}function p2(e){var t=Xs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ef,lastRenderedState:e},t.queue=e,e=e.dispatch=kD.bind(null,An,e),[t.memoizedState,e]}function tf(e,t,i,a){return e={tag:e,create:t,destroy:i,deps:a,next:null},t=An.updateQueue,t===null?(t={lastEffect:null,stores:null},An.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(a=i.next,i.next=e,e.next=a,t.lastEffect=e)),e}function bk(){return gs().memoizedState}function cm(e,t,i,a){var h=Xs();An.flags|=e,h.memoizedState=tf(1|t,i,void 0,a===void 0?null:a)}function gg(e,t,i,a){var h=gs();a=a===void 0?null:a;var p=void 0;if(nr!==null){var f=nr.memoizedState;if(p=f.destroy,a!==null&&Cx(a,f.deps)){h.memoizedState=tf(t,i,p,a);return}}An.flags|=e,h.memoizedState=tf(1|t,i,p,a)}function m2(e,t){return cm(8390656,8,e,t)}function Ex(e,t){return gg(2048,8,e,t)}function wk(e,t){return gg(4,2,e,t)}function Sk(e,t){return gg(4,4,e,t)}function Tk(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Ck(e,t,i){return i=i!=null?i.concat([e]):null,gg(4,4,Tk.bind(null,t,e),i)}function Ix(){}function kk(e,t){var i=gs();t=t===void 0?null:t;var a=i.memoizedState;return a!==null&&t!==null&&Cx(t,a[1])?a[0]:(i.memoizedState=[e,t],e)}function Pk(e,t){var i=gs();t=t===void 0?null:t;var a=i.memoizedState;return a!==null&&t!==null&&Cx(t,a[1])?a[0]:(e=e(),i.memoizedState=[e,t],e)}function Ek(e,t,i){return Hl&21?(Ls(i,t)||(i=DC(),An.lanes|=i,Xl|=i,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,_i=!0),e.memoizedState=i)}function TD(e,t){var i=on;on=i!==0&&4>i?i:4,e(!0);var a=W_.transition;W_.transition={};try{e(!1),t()}finally{on=i,W_.transition=a}}function Ik(){return gs().memoizedState}function CD(e,t,i){var a=Va(e);if(i={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null},Mk(e))Ak(t,i);else if(i=hk(e,t,i,a),i!==null){var h=ri();Rs(i,e,a,h),zk(i,t,a)}}function kD(e,t,i){var a=Va(e),h={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null};if(Mk(e))Ak(t,h);else{var p=e.alternate;if(e.lanes===0&&(p===null||p.lanes===0)&&(p=t.lastRenderedReducer,p!==null))try{var f=t.lastRenderedState,u=p(f,i);if(h.hasEagerState=!0,h.eagerState=u,Ls(u,f)){var T=t.interleaved;T===null?(h.next=h,xx(t)):(h.next=T.next,T.next=h),t.interleaved=h;return}}catch{}finally{}i=hk(e,t,h,a),i!==null&&(h=ri(),Rs(i,e,a,h),zk(i,t,a))}}function Mk(e){var t=e.alternate;return e===An||t!==null&&t===An}function Ak(e,t){Md=Um=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function zk(e,t,i){if(i&4194240){var a=t.lanes;a&=e.pendingLanes,i|=a,t.lanes=i,ox(e,i)}}var qm={readContext:ms,useCallback:Or,useContext:Or,useEffect:Or,useImperativeHandle:Or,useInsertionEffect:Or,useLayoutEffect:Or,useMemo:Or,useReducer:Or,useRef:Or,useState:Or,useDebugValue:Or,useDeferredValue:Or,useTransition:Or,useMutableSource:Or,useSyncExternalStore:Or,useId:Or,unstable_isNewReconciler:!1},PD={readContext:ms,useCallback:function(e,t){return Xs().memoizedState=[e,t===void 0?null:t],e},useContext:ms,useEffect:m2,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,cm(4194308,4,Tk.bind(null,t,e),i)},useLayoutEffect:function(e,t){return cm(4194308,4,e,t)},useInsertionEffect:function(e,t){return cm(4,2,e,t)},useMemo:function(e,t){var i=Xs();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var a=Xs();return t=i!==void 0?i(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=CD.bind(null,An,e),[a.memoizedState,e]},useRef:function(e){var t=Xs();return e={current:e},t.memoizedState=e},useState:p2,useDebugValue:Ix,useDeferredValue:function(e){return Xs().memoizedState=e},useTransition:function(){var e=p2(!1),t=e[0];return e=TD.bind(null,e[1]),Xs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var a=An,h=Xs();if(Cn){if(i===void 0)throw Error(qe(407));i=i()}else{if(i=t(),gr===null)throw Error(qe(349));Hl&30||gk(a,t,i)}h.memoizedState=i;var p={value:i,getSnapshot:t};return h.queue=p,m2(_k.bind(null,a,p,e),[e]),a.flags|=2048,tf(9,yk.bind(null,a,p,i,t),void 0,null),i},useId:function(){var e=Xs(),t=gr.identifierPrefix;if(Cn){var i=Do,a=zo;i=(a&~(1<<32-Ds(a)-1)).toString(32)+i,t=":"+t+"R"+i,i=Qd++,0<i&&(t+="H"+i.toString(32)),t+=":"}else i=SD++,t=":"+t+"r"+i.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ED={readContext:ms,useCallback:kk,useContext:ms,useEffect:Ex,useImperativeHandle:Ck,useInsertionEffect:wk,useLayoutEffect:Sk,useMemo:Pk,useReducer:Z_,useRef:bk,useState:function(){return Z_(ef)},useDebugValue:Ix,useDeferredValue:function(e){var t=gs();return Ek(t,nr.memoizedState,e)},useTransition:function(){var e=Z_(ef)[0],t=gs().memoizedState;return[e,t]},useMutableSource:pk,useSyncExternalStore:mk,useId:Ik,unstable_isNewReconciler:!1},ID={readContext:ms,useCallback:kk,useContext:ms,useEffect:Ex,useImperativeHandle:Ck,useInsertionEffect:wk,useLayoutEffect:Sk,useMemo:Pk,useReducer:H_,useRef:bk,useState:function(){return H_(ef)},useDebugValue:Ix,useDeferredValue:function(e){var t=gs();return nr===null?t.memoizedState=e:Ek(t,nr.memoizedState,e)},useTransition:function(){var e=H_(ef)[0],t=gs().memoizedState;return[e,t]},useMutableSource:pk,useSyncExternalStore:mk,useId:Ik,unstable_isNewReconciler:!1};function Ms(e,t){if(e&&e.defaultProps){t=zn({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}function Jv(e,t,i,a){t=e.memoizedState,i=i(a,t),i=i==null?t:zn({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var yg={isMounted:function(e){return(e=e._reactInternals)?Ql(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var a=ri(),h=Va(e),p=Ro(a,h);p.payload=t,i!=null&&(p.callback=i),t=Ba(e,p,h),t!==null&&(Rs(t,e,h,a),lm(t,e,h))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var a=ri(),h=Va(e),p=Ro(a,h);p.tag=1,p.payload=t,i!=null&&(p.callback=i),t=Ba(e,p,h),t!==null&&(Rs(t,e,h,a),lm(t,e,h))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=ri(),a=Va(e),h=Ro(i,a);h.tag=2,t!=null&&(h.callback=t),t=Ba(e,h,a),t!==null&&(Rs(t,e,a,i),lm(t,e,a))}};function g2(e,t,i,a,h,p,f){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,p,f):t.prototype&&t.prototype.isPureReactComponent?!Zd(i,a)||!Zd(h,p):!0}function Dk(e,t,i){var a=!1,h=Ua,p=t.contextType;return typeof p=="object"&&p!==null?p=ms(p):(h=bi(t)?Wl:qr.current,a=t.contextTypes,p=(a=a!=null)?Mc(e,h):Ua),t=new t(i,p),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=yg,e.stateNode=t,t._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=h,e.__reactInternalMemoizedMaskedChildContext=p),t}function y2(e,t,i,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,a),t.state!==e&&yg.enqueueReplaceState(t,t.state,null)}function Qv(e,t,i,a){var h=e.stateNode;h.props=i,h.state=e.memoizedState,h.refs={},bx(e);var p=t.contextType;typeof p=="object"&&p!==null?h.context=ms(p):(p=bi(t)?Wl:qr.current,h.context=Mc(e,p)),h.state=e.memoizedState,p=t.getDerivedStateFromProps,typeof p=="function"&&(Jv(e,t,p,i),h.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(t=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),t!==h.state&&yg.enqueueReplaceState(h,h.state,null),jm(e,i,h,a),h.state=e.memoizedState),typeof h.componentDidMount=="function"&&(e.flags|=4194308)}function Rc(e,t){try{var i="",a=t;do i+=rz(a),a=a.return;while(a);var h=i}catch(p){h=`
Error generating stack: `+p.message+`
`+p.stack}return{value:e,source:t,stack:h,digest:null}}function X_(e,t,i){return{value:e,source:null,stack:i??null,digest:t??null}}function e0(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var MD=typeof WeakMap=="function"?WeakMap:Map;function Rk(e,t,i){i=Ro(-1,i),i.tag=3,i.payload={element:null};var a=t.value;return i.callback=function(){Wm||(Wm=!0,c0=a),e0(e,t)},i}function Lk(e,t,i){i=Ro(-1,i),i.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var h=t.value;i.payload=function(){return a(h)},i.callback=function(){e0(e,t)}}var p=e.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(i.callback=function(){e0(e,t),typeof a!="function"&&(Oa===null?Oa=new Set([this]):Oa.add(this));var f=t.stack;this.componentDidCatch(t.value,{componentStack:f!==null?f:""})}),i}function _2(e,t,i){var a=e.pingCache;if(a===null){a=e.pingCache=new MD;var h=new Set;a.set(t,h)}else h=a.get(t),h===void 0&&(h=new Set,a.set(t,h));h.has(i)||(h.add(i),e=qD.bind(null,e,t,i),t.then(e,e))}function v2(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function x2(e,t,i,a,h){return e.mode&1?(e.flags|=65536,e.lanes=h,e):(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(t=Ro(-1,1),t.tag=2,Ba(i,t,1))),i.lanes|=1),e)}var AD=$o.ReactCurrentOwner,_i=!1;function ti(e,t,i,a){t.child=e===null?ck(t,null,i,a):zc(t,e.child,i,a)}function b2(e,t,i,a,h){i=i.render;var p=t.ref;return Tc(t,h),a=kx(e,t,i,a,p,h),i=Px(),e!==null&&!_i?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~h,Oo(e,t,h)):(Cn&&i&&px(t),t.flags|=1,ti(e,t,a,h),t.child)}function w2(e,t,i,a,h){if(e===null){var p=i.type;return typeof p=="function"&&!Bx(p)&&p.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=p,Fk(e,t,p,a,h)):(e=pm(i.type,null,a,t,t.mode,h),e.ref=t.ref,e.return=t,t.child=e)}if(p=e.child,!(e.lanes&h)){var f=p.memoizedProps;if(i=i.compare,i=i!==null?i:Zd,i(f,a)&&e.ref===t.ref)return Oo(e,t,h)}return t.flags|=1,e=Na(p,a),e.ref=t.ref,e.return=t,t.child=e}function Fk(e,t,i,a,h){if(e!==null){var p=e.memoizedProps;if(Zd(p,a)&&e.ref===t.ref)if(_i=!1,t.pendingProps=a=p,(e.lanes&h)!==0)e.flags&131072&&(_i=!0);else return t.lanes=e.lanes,Oo(e,t,h)}return t0(e,t,i,a,h)}function Bk(e,t,i){var a=t.pendingProps,h=a.children,p=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},gn(pc,Vi),Vi|=i;else{if(!(i&1073741824))return e=p!==null?p.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,gn(pc,Vi),Vi|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=p!==null?p.baseLanes:i,gn(pc,Vi),Vi|=a}else p!==null?(a=p.baseLanes|i,t.memoizedState=null):a=i,gn(pc,Vi),Vi|=a;return ti(e,t,h,i),t.child}function Ok(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function t0(e,t,i,a,h){var p=bi(i)?Wl:qr.current;return p=Mc(t,p),Tc(t,h),i=kx(e,t,i,a,p,h),a=Px(),e!==null&&!_i?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~h,Oo(e,t,h)):(Cn&&a&&px(t),t.flags|=1,ti(e,t,i,h),t.child)}function S2(e,t,i,a,h){if(bi(i)){var p=!0;Fm(t)}else p=!1;if(Tc(t,h),t.stateNode===null)hm(e,t),Dk(t,i,a),Qv(t,i,a,h),a=!0;else if(e===null){var f=t.stateNode,u=t.memoizedProps;f.props=u;var T=f.context,E=i.contextType;typeof E=="object"&&E!==null?E=ms(E):(E=bi(i)?Wl:qr.current,E=Mc(t,E));var D=i.getDerivedStateFromProps,z=typeof D=="function"||typeof f.getSnapshotBeforeUpdate=="function";z||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(u!==a||T!==E)&&y2(t,f,a,E),Ea=!1;var I=t.memoizedState;f.state=I,jm(t,a,f,h),T=t.memoizedState,u!==a||I!==T||xi.current||Ea?(typeof D=="function"&&(Jv(t,i,D,a),T=t.memoizedState),(u=Ea||g2(t,i,u,a,I,T,E))?(z||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=T),f.props=a,f.state=T,f.context=E,a=u):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{f=t.stateNode,dk(e,t),u=t.memoizedProps,E=t.type===t.elementType?u:Ms(t.type,u),f.props=E,z=t.pendingProps,I=f.context,T=i.contextType,typeof T=="object"&&T!==null?T=ms(T):(T=bi(i)?Wl:qr.current,T=Mc(t,T));var G=i.getDerivedStateFromProps;(D=typeof G=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(u!==z||I!==T)&&y2(t,f,a,T),Ea=!1,I=t.memoizedState,f.state=I,jm(t,a,f,h);var K=t.memoizedState;u!==z||I!==K||xi.current||Ea?(typeof G=="function"&&(Jv(t,i,G,a),K=t.memoizedState),(E=Ea||g2(t,i,E,a,I,K,T)||!1)?(D||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(a,K,T),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(a,K,T)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||u===e.memoizedProps&&I===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&I===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=K),f.props=a,f.state=K,f.context=T,a=E):(typeof f.componentDidUpdate!="function"||u===e.memoizedProps&&I===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&I===e.memoizedState||(t.flags|=1024),a=!1)}return n0(e,t,i,a,p,h)}function n0(e,t,i,a,h,p){Ok(e,t);var f=(t.flags&128)!==0;if(!a&&!f)return h&&l2(t,i,!1),Oo(e,t,p);a=t.stateNode,AD.current=t;var u=f&&typeof i.getDerivedStateFromError!="function"?null:a.render();return t.flags|=1,e!==null&&f?(t.child=zc(t,e.child,null,p),t.child=zc(t,null,u,p)):ti(e,t,u,p),t.memoizedState=a.state,h&&l2(t,i,!0),t.child}function Vk(e){var t=e.stateNode;t.pendingContext?a2(e,t.pendingContext,t.pendingContext!==t.context):t.context&&a2(e,t.context,!1),wx(e,t.containerInfo)}function T2(e,t,i,a,h){return Ac(),gx(h),t.flags|=256,ti(e,t,i,a),t.child}var r0={dehydrated:null,treeContext:null,retryLane:0};function i0(e){return{baseLanes:e,cachePool:null,transitions:null}}function Nk(e,t,i){var a=t.pendingProps,h=In.current,p=!1,f=(t.flags&128)!==0,u;if((u=f)||(u=e!==null&&e.memoizedState===null?!1:(h&2)!==0),u?(p=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(h|=1),gn(In,h&1),e===null)return Kv(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(f=a.children,e=a.fallback,p?(a=t.mode,p=t.child,f={mode:"hidden",children:f},!(a&1)&&p!==null?(p.childLanes=0,p.pendingProps=f):p=xg(f,a,0,null),e=$l(e,a,i,null),p.return=t,e.return=t,p.sibling=e,t.child=p,t.child.memoizedState=i0(i),t.memoizedState=r0,e):Mx(t,f));if(h=e.memoizedState,h!==null&&(u=h.dehydrated,u!==null))return zD(e,t,f,a,u,h,i);if(p){p=a.fallback,f=t.mode,h=e.child,u=h.sibling;var T={mode:"hidden",children:a.children};return!(f&1)&&t.child!==h?(a=t.child,a.childLanes=0,a.pendingProps=T,t.deletions=null):(a=Na(h,T),a.subtreeFlags=h.subtreeFlags&14680064),u!==null?p=Na(u,p):(p=$l(p,f,i,null),p.flags|=2),p.return=t,a.return=t,a.sibling=p,t.child=a,a=p,p=t.child,f=e.child.memoizedState,f=f===null?i0(i):{baseLanes:f.baseLanes|i,cachePool:null,transitions:f.transitions},p.memoizedState=f,p.childLanes=e.childLanes&~i,t.memoizedState=r0,a}return p=e.child,e=p.sibling,a=Na(p,{mode:"visible",children:a.children}),!(t.mode&1)&&(a.lanes=i),a.return=t,a.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=a,t.memoizedState=null,a}function Mx(e,t){return t=xg({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Wp(e,t,i,a){return a!==null&&gx(a),zc(t,e.child,null,i),e=Mx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function zD(e,t,i,a,h,p,f){if(i)return t.flags&256?(t.flags&=-257,a=X_(Error(qe(422))),Wp(e,t,f,a)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(p=a.fallback,h=t.mode,a=xg({mode:"visible",children:a.children},h,0,null),p=$l(p,h,f,null),p.flags|=2,a.return=t,p.return=t,a.sibling=p,t.child=a,t.mode&1&&zc(t,e.child,null,f),t.child.memoizedState=i0(f),t.memoizedState=r0,p);if(!(t.mode&1))return Wp(e,t,f,null);if(h.data==="$!"){if(a=h.nextSibling&&h.nextSibling.dataset,a)var u=a.dgst;return a=u,p=Error(qe(419)),a=X_(p,a,void 0),Wp(e,t,f,a)}if(u=(f&e.childLanes)!==0,_i||u){if(a=gr,a!==null){switch(f&-f){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=h&(a.suspendedLanes|f)?0:h,h!==0&&h!==p.retryLane&&(p.retryLane=h,Bo(e,h),Rs(a,e,h,-1))}return Fx(),a=X_(Error(qe(421))),Wp(e,t,f,a)}return h.data==="$?"?(t.flags|=128,t.child=e.child,t=GD.bind(null,e),h._reactRetry=t,null):(e=p.treeContext,ji=Fa(h.nextSibling),$i=t,Cn=!0,zs=null,e!==null&&(us[cs++]=zo,us[cs++]=Do,us[cs++]=Zl,zo=e.id,Do=e.overflow,Zl=t),t=Mx(t,a.children),t.flags|=4096,t)}function C2(e,t,i){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),Yv(e.return,t,i)}function K_(e,t,i,a,h){var p=e.memoizedState;p===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:i,tailMode:h}:(p.isBackwards=t,p.rendering=null,p.renderingStartTime=0,p.last=a,p.tail=i,p.tailMode=h)}function jk(e,t,i){var a=t.pendingProps,h=a.revealOrder,p=a.tail;if(ti(e,t,a.children,i),a=In.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&C2(e,i,t);else if(e.tag===19)C2(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(gn(In,a),!(t.mode&1))t.memoizedState=null;else switch(h){case"forwards":for(i=t.child,h=null;i!==null;)e=i.alternate,e!==null&&$m(e)===null&&(h=i),i=i.sibling;i=h,i===null?(h=t.child,t.child=null):(h=i.sibling,i.sibling=null),K_(t,!1,h,i,p);break;case"backwards":for(i=null,h=t.child,t.child=null;h!==null;){if(e=h.alternate,e!==null&&$m(e)===null){t.child=h;break}e=h.sibling,h.sibling=i,i=h,h=e}K_(t,!0,i,null,p);break;case"together":K_(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function hm(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Oo(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),Xl|=t.lanes,!(i&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(qe(153));if(t.child!==null){for(e=t.child,i=Na(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=Na(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function DD(e,t,i){switch(t.tag){case 3:Vk(t),Ac();break;case 5:fk(t);break;case 1:bi(t.type)&&Fm(t);break;case 4:wx(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,h=t.memoizedProps.value;gn(Vm,a._currentValue),a._currentValue=h;break;case 13:if(a=t.memoizedState,a!==null)return a.dehydrated!==null?(gn(In,In.current&1),t.flags|=128,null):i&t.child.childLanes?Nk(e,t,i):(gn(In,In.current&1),e=Oo(e,t,i),e!==null?e.sibling:null);gn(In,In.current&1);break;case 19:if(a=(i&t.childLanes)!==0,e.flags&128){if(a)return jk(e,t,i);t.flags|=128}if(h=t.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),gn(In,In.current),a)break;return null;case 22:case 23:return t.lanes=0,Bk(e,t,i)}return Oo(e,t,i)}var $k,s0,Uk,qk;$k=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};s0=function(){};Uk=function(e,t,i,a){var h=e.memoizedProps;if(h!==a){e=t.stateNode,Ll(to.current);var p=null;switch(i){case"input":h=Pv(e,h),a=Pv(e,a),p=[];break;case"select":h=zn({},h,{value:void 0}),a=zn({},a,{value:void 0}),p=[];break;case"textarea":h=Mv(e,h),a=Mv(e,a),p=[];break;default:typeof h.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=Rm)}zv(i,a);var f;i=null;for(E in h)if(!a.hasOwnProperty(E)&&h.hasOwnProperty(E)&&h[E]!=null)if(E==="style"){var u=h[E];for(f in u)u.hasOwnProperty(f)&&(i||(i={}),i[f]="")}else E!=="dangerouslySetInnerHTML"&&E!=="children"&&E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(Nd.hasOwnProperty(E)?p||(p=[]):(p=p||[]).push(E,null));for(E in a){var T=a[E];if(u=h!=null?h[E]:void 0,a.hasOwnProperty(E)&&T!==u&&(T!=null||u!=null))if(E==="style")if(u){for(f in u)!u.hasOwnProperty(f)||T&&T.hasOwnProperty(f)||(i||(i={}),i[f]="");for(f in T)T.hasOwnProperty(f)&&u[f]!==T[f]&&(i||(i={}),i[f]=T[f])}else i||(p||(p=[]),p.push(E,i)),i=T;else E==="dangerouslySetInnerHTML"?(T=T?T.__html:void 0,u=u?u.__html:void 0,T!=null&&u!==T&&(p=p||[]).push(E,T)):E==="children"?typeof T!="string"&&typeof T!="number"||(p=p||[]).push(E,""+T):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&(Nd.hasOwnProperty(E)?(T!=null&&E==="onScroll"&&vn("scroll",e),p||u===T||(p=[])):(p=p||[]).push(E,T))}i&&(p=p||[]).push("style",i);var E=p;(t.updateQueue=E)&&(t.flags|=4)}};qk=function(e,t,i,a){i!==a&&(t.flags|=4)};function dd(e,t){if(!Cn)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Vr(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,a=0;if(t)for(var h=e.child;h!==null;)i|=h.lanes|h.childLanes,a|=h.subtreeFlags&14680064,a|=h.flags&14680064,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)i|=h.lanes|h.childLanes,a|=h.subtreeFlags,a|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=a,e.childLanes=i,t}function RD(e,t,i){var a=t.pendingProps;switch(mx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vr(t),null;case 1:return bi(t.type)&&Lm(),Vr(t),null;case 3:return a=t.stateNode,Dc(),xn(xi),xn(qr),Tx(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(qp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,zs!==null&&(f0(zs),zs=null))),s0(e,t),Vr(t),null;case 5:Sx(t);var h=Ll(Jd.current);if(i=t.type,e!==null&&t.stateNode!=null)Uk(e,t,i,a,h),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(t.stateNode===null)throw Error(qe(166));return Vr(t),null}if(e=Ll(to.current),qp(t)){a=t.stateNode,i=t.type;var p=t.memoizedProps;switch(a[Qs]=t,a[Kd]=p,e=(t.mode&1)!==0,i){case"dialog":vn("cancel",a),vn("close",a);break;case"iframe":case"object":case"embed":vn("load",a);break;case"video":case"audio":for(h=0;h<bd.length;h++)vn(bd[h],a);break;case"source":vn("error",a);break;case"img":case"image":case"link":vn("error",a),vn("load",a);break;case"details":vn("toggle",a);break;case"input":Rw(a,p),vn("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!p.multiple},vn("invalid",a);break;case"textarea":Fw(a,p),vn("invalid",a)}zv(i,p),h=null;for(var f in p)if(p.hasOwnProperty(f)){var u=p[f];f==="children"?typeof u=="string"?a.textContent!==u&&(p.suppressHydrationWarning!==!0&&Up(a.textContent,u,e),h=["children",u]):typeof u=="number"&&a.textContent!==""+u&&(p.suppressHydrationWarning!==!0&&Up(a.textContent,u,e),h=["children",""+u]):Nd.hasOwnProperty(f)&&u!=null&&f==="onScroll"&&vn("scroll",a)}switch(i){case"input":Lp(a),Lw(a,p,!0);break;case"textarea":Lp(a),Bw(a);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(a.onclick=Rm)}a=h,t.updateQueue=a,a!==null&&(t.flags|=4)}else{f=h.nodeType===9?h:h.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=_C(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=f.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=f.createElement(i,{is:a.is}):(e=f.createElement(i),i==="select"&&(f=e,a.multiple?f.multiple=!0:a.size&&(f.size=a.size))):e=f.createElementNS(e,i),e[Qs]=t,e[Kd]=a,$k(e,t,!1,!1),t.stateNode=e;e:{switch(f=Dv(i,a),i){case"dialog":vn("cancel",e),vn("close",e),h=a;break;case"iframe":case"object":case"embed":vn("load",e),h=a;break;case"video":case"audio":for(h=0;h<bd.length;h++)vn(bd[h],e);h=a;break;case"source":vn("error",e),h=a;break;case"img":case"image":case"link":vn("error",e),vn("load",e),h=a;break;case"details":vn("toggle",e),h=a;break;case"input":Rw(e,a),h=Pv(e,a),vn("invalid",e);break;case"option":h=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},h=zn({},a,{value:void 0}),vn("invalid",e);break;case"textarea":Fw(e,a),h=Mv(e,a),vn("invalid",e);break;default:h=a}zv(i,h),u=h;for(p in u)if(u.hasOwnProperty(p)){var T=u[p];p==="style"?bC(e,T):p==="dangerouslySetInnerHTML"?(T=T?T.__html:void 0,T!=null&&vC(e,T)):p==="children"?typeof T=="string"?(i!=="textarea"||T!=="")&&jd(e,T):typeof T=="number"&&jd(e,""+T):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(Nd.hasOwnProperty(p)?T!=null&&p==="onScroll"&&vn("scroll",e):T!=null&&ex(e,p,T,f))}switch(i){case"input":Lp(e),Lw(e,a,!1);break;case"textarea":Lp(e),Bw(e);break;case"option":a.value!=null&&e.setAttribute("value",""+$a(a.value));break;case"select":e.multiple=!!a.multiple,p=a.value,p!=null?xc(e,!!a.multiple,p,!1):a.defaultValue!=null&&xc(e,!!a.multiple,a.defaultValue,!0);break;default:typeof h.onClick=="function"&&(e.onclick=Rm)}switch(i){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Vr(t),null;case 6:if(e&&t.stateNode!=null)qk(e,t,e.memoizedProps,a);else{if(typeof a!="string"&&t.stateNode===null)throw Error(qe(166));if(i=Ll(Jd.current),Ll(to.current),qp(t)){if(a=t.stateNode,i=t.memoizedProps,a[Qs]=t,(p=a.nodeValue!==i)&&(e=$i,e!==null))switch(e.tag){case 3:Up(a.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Up(a.nodeValue,i,(e.mode&1)!==0)}p&&(t.flags|=4)}else a=(i.nodeType===9?i:i.ownerDocument).createTextNode(a),a[Qs]=t,t.stateNode=a}return Vr(t),null;case 13:if(xn(In),a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Cn&&ji!==null&&t.mode&1&&!(t.flags&128))lk(),Ac(),t.flags|=98560,p=!1;else if(p=qp(t),a!==null&&a.dehydrated!==null){if(e===null){if(!p)throw Error(qe(318));if(p=t.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(qe(317));p[Qs]=t}else Ac(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Vr(t),p=!1}else zs!==null&&(f0(zs),zs=null),p=!0;if(!p)return t.flags&65536?t:null}return t.flags&128?(t.lanes=i,t):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(t.child.flags|=8192,t.mode&1&&(e===null||In.current&1?rr===0&&(rr=3):Fx())),t.updateQueue!==null&&(t.flags|=4),Vr(t),null);case 4:return Dc(),s0(e,t),e===null&&Hd(t.stateNode.containerInfo),Vr(t),null;case 10:return vx(t.type._context),Vr(t),null;case 17:return bi(t.type)&&Lm(),Vr(t),null;case 19:if(xn(In),p=t.memoizedState,p===null)return Vr(t),null;if(a=(t.flags&128)!==0,f=p.rendering,f===null)if(a)dd(p,!1);else{if(rr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(f=$m(e),f!==null){for(t.flags|=128,dd(p,!1),a=f.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=i,i=t.child;i!==null;)p=i,e=a,p.flags&=14680066,f=p.alternate,f===null?(p.childLanes=0,p.lanes=e,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=f.childLanes,p.lanes=f.lanes,p.child=f.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=f.memoizedProps,p.memoizedState=f.memoizedState,p.updateQueue=f.updateQueue,p.type=f.type,e=f.dependencies,p.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return gn(In,In.current&1|2),t.child}e=e.sibling}p.tail!==null&&Un()>Lc&&(t.flags|=128,a=!0,dd(p,!1),t.lanes=4194304)}else{if(!a)if(e=$m(f),e!==null){if(t.flags|=128,a=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),dd(p,!0),p.tail===null&&p.tailMode==="hidden"&&!f.alternate&&!Cn)return Vr(t),null}else 2*Un()-p.renderingStartTime>Lc&&i!==1073741824&&(t.flags|=128,a=!0,dd(p,!1),t.lanes=4194304);p.isBackwards?(f.sibling=t.child,t.child=f):(i=p.last,i!==null?i.sibling=f:t.child=f,p.last=f)}return p.tail!==null?(t=p.tail,p.rendering=t,p.tail=t.sibling,p.renderingStartTime=Un(),t.sibling=null,i=In.current,gn(In,a?i&1|2:i&1),t):(Vr(t),null);case 22:case 23:return Lx(),a=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(t.flags|=8192),a&&t.mode&1?Vi&1073741824&&(Vr(t),t.subtreeFlags&6&&(t.flags|=8192)):Vr(t),null;case 24:return null;case 25:return null}throw Error(qe(156,t.tag))}function LD(e,t){switch(mx(t),t.tag){case 1:return bi(t.type)&&Lm(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Dc(),xn(xi),xn(qr),Tx(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Sx(t),null;case 13:if(xn(In),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(qe(340));Ac()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return xn(In),null;case 4:return Dc(),null;case 10:return vx(t.type._context),null;case 22:case 23:return Lx(),null;case 24:return null;default:return null}}var Zp=!1,$r=!1,FD=typeof WeakSet=="function"?WeakSet:Set,ft=null;function fc(e,t){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(a){Nn(e,t,a)}else i.current=null}function o0(e,t,i){try{i()}catch(a){Nn(e,t,a)}}var k2=!1;function BD(e,t){if(Uv=Am,e=XC(),fx(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var a=i.getSelection&&i.getSelection();if(a&&a.rangeCount!==0){i=a.anchorNode;var h=a.anchorOffset,p=a.focusNode;a=a.focusOffset;try{i.nodeType,p.nodeType}catch{i=null;break e}var f=0,u=-1,T=-1,E=0,D=0,z=e,I=null;t:for(;;){for(var G;z!==i||h!==0&&z.nodeType!==3||(u=f+h),z!==p||a!==0&&z.nodeType!==3||(T=f+a),z.nodeType===3&&(f+=z.nodeValue.length),(G=z.firstChild)!==null;)I=z,z=G;for(;;){if(z===e)break t;if(I===i&&++E===h&&(u=f),I===p&&++D===a&&(T=f),(G=z.nextSibling)!==null)break;z=I,I=z.parentNode}z=G}i=u===-1||T===-1?null:{start:u,end:T}}else i=null}i=i||{start:0,end:0}}else i=null;for(qv={focusedElem:e,selectionRange:i},Am=!1,ft=t;ft!==null;)if(t=ft,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ft=e;else for(;ft!==null;){t=ft;try{var K=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(K!==null){var Q=K.memoizedProps,ce=K.memoizedState,j=t.stateNode,U=j.getSnapshotBeforeUpdate(t.elementType===t.type?Q:Ms(t.type,Q),ce);j.__reactInternalSnapshotBeforeUpdate=U}break;case 3:var X=t.stateNode.containerInfo;X.nodeType===1?X.textContent="":X.nodeType===9&&X.documentElement&&X.removeChild(X.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(qe(163))}}catch(ne){Nn(t,t.return,ne)}if(e=t.sibling,e!==null){e.return=t.return,ft=e;break}ft=t.return}return K=k2,k2=!1,K}function Ad(e,t,i){var a=t.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&e)===e){var p=h.destroy;h.destroy=void 0,p!==void 0&&o0(t,i,p)}h=h.next}while(h!==a)}}function _g(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var i=t=t.next;do{if((i.tag&e)===e){var a=i.create;i.destroy=a()}i=i.next}while(i!==t)}}function a0(e){var t=e.ref;if(t!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof t=="function"?t(e):t.current=e}}function Gk(e){var t=e.alternate;t!==null&&(e.alternate=null,Gk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Qs],delete t[Kd],delete t[Zv],delete t[vD],delete t[xD])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Wk(e){return e.tag===5||e.tag===3||e.tag===4}function P2(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Wk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function l0(e,t,i){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=Rm));else if(a!==4&&(e=e.child,e!==null))for(l0(e,t,i),e=e.sibling;e!==null;)l0(e,t,i),e=e.sibling}function u0(e,t,i){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(u0(e,t,i),e=e.sibling;e!==null;)u0(e,t,i),e=e.sibling}var Tr=null,As=!1;function Ta(e,t,i){for(i=i.child;i!==null;)Zk(e,t,i),i=i.sibling}function Zk(e,t,i){if(eo&&typeof eo.onCommitFiberUnmount=="function")try{eo.onCommitFiberUnmount(cg,i)}catch{}switch(i.tag){case 5:$r||fc(i,t);case 6:var a=Tr,h=As;Tr=null,Ta(e,t,i),Tr=a,As=h,Tr!==null&&(As?(e=Tr,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):Tr.removeChild(i.stateNode));break;case 18:Tr!==null&&(As?(e=Tr,i=i.stateNode,e.nodeType===8?U_(e.parentNode,i):e.nodeType===1&&U_(e,i),Gd(e)):U_(Tr,i.stateNode));break;case 4:a=Tr,h=As,Tr=i.stateNode.containerInfo,As=!0,Ta(e,t,i),Tr=a,As=h;break;case 0:case 11:case 14:case 15:if(!$r&&(a=i.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){h=a=a.next;do{var p=h,f=p.destroy;p=p.tag,f!==void 0&&(p&2||p&4)&&o0(i,t,f),h=h.next}while(h!==a)}Ta(e,t,i);break;case 1:if(!$r&&(fc(i,t),a=i.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=i.memoizedProps,a.state=i.memoizedState,a.componentWillUnmount()}catch(u){Nn(i,t,u)}Ta(e,t,i);break;case 21:Ta(e,t,i);break;case 22:i.mode&1?($r=(a=$r)||i.memoizedState!==null,Ta(e,t,i),$r=a):Ta(e,t,i);break;default:Ta(e,t,i)}}function E2(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new FD),t.forEach(function(a){var h=WD.bind(null,e,a);i.has(a)||(i.add(a),a.then(h,h))})}}function Es(e,t){var i=t.deletions;if(i!==null)for(var a=0;a<i.length;a++){var h=i[a];try{var p=e,f=t,u=f;e:for(;u!==null;){switch(u.tag){case 5:Tr=u.stateNode,As=!1;break e;case 3:Tr=u.stateNode.containerInfo,As=!0;break e;case 4:Tr=u.stateNode.containerInfo,As=!0;break e}u=u.return}if(Tr===null)throw Error(qe(160));Zk(p,f,h),Tr=null,As=!1;var T=h.alternate;T!==null&&(T.return=null),h.return=null}catch(E){Nn(h,t,E)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Hk(t,e),t=t.sibling}function Hk(e,t){var i=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Es(t,e),Zs(e),a&4){try{Ad(3,e,e.return),_g(3,e)}catch(Q){Nn(e,e.return,Q)}try{Ad(5,e,e.return)}catch(Q){Nn(e,e.return,Q)}}break;case 1:Es(t,e),Zs(e),a&512&&i!==null&&fc(i,i.return);break;case 5:if(Es(t,e),Zs(e),a&512&&i!==null&&fc(i,i.return),e.flags&32){var h=e.stateNode;try{jd(h,"")}catch(Q){Nn(e,e.return,Q)}}if(a&4&&(h=e.stateNode,h!=null)){var p=e.memoizedProps,f=i!==null?i.memoizedProps:p,u=e.type,T=e.updateQueue;if(e.updateQueue=null,T!==null)try{u==="input"&&p.type==="radio"&&p.name!=null&&gC(h,p),Dv(u,f);var E=Dv(u,p);for(f=0;f<T.length;f+=2){var D=T[f],z=T[f+1];D==="style"?bC(h,z):D==="dangerouslySetInnerHTML"?vC(h,z):D==="children"?jd(h,z):ex(h,D,z,E)}switch(u){case"input":Ev(h,p);break;case"textarea":yC(h,p);break;case"select":var I=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!p.multiple;var G=p.value;G!=null?xc(h,!!p.multiple,G,!1):I!==!!p.multiple&&(p.defaultValue!=null?xc(h,!!p.multiple,p.defaultValue,!0):xc(h,!!p.multiple,p.multiple?[]:"",!1))}h[Kd]=p}catch(Q){Nn(e,e.return,Q)}}break;case 6:if(Es(t,e),Zs(e),a&4){if(e.stateNode===null)throw Error(qe(162));h=e.stateNode,p=e.memoizedProps;try{h.nodeValue=p}catch(Q){Nn(e,e.return,Q)}}break;case 3:if(Es(t,e),Zs(e),a&4&&i!==null&&i.memoizedState.isDehydrated)try{Gd(t.containerInfo)}catch(Q){Nn(e,e.return,Q)}break;case 4:Es(t,e),Zs(e);break;case 13:Es(t,e),Zs(e),h=e.child,h.flags&8192&&(p=h.memoizedState!==null,h.stateNode.isHidden=p,!p||h.alternate!==null&&h.alternate.memoizedState!==null||(Dx=Un())),a&4&&E2(e);break;case 22:if(D=i!==null&&i.memoizedState!==null,e.mode&1?($r=(E=$r)||D,Es(t,e),$r=E):Es(t,e),Zs(e),a&8192){if(E=e.memoizedState!==null,(e.stateNode.isHidden=E)&&!D&&e.mode&1)for(ft=e,D=e.child;D!==null;){for(z=ft=D;ft!==null;){switch(I=ft,G=I.child,I.tag){case 0:case 11:case 14:case 15:Ad(4,I,I.return);break;case 1:fc(I,I.return);var K=I.stateNode;if(typeof K.componentWillUnmount=="function"){a=I,i=I.return;try{t=a,K.props=t.memoizedProps,K.state=t.memoizedState,K.componentWillUnmount()}catch(Q){Nn(a,i,Q)}}break;case 5:fc(I,I.return);break;case 22:if(I.memoizedState!==null){M2(z);continue}}G!==null?(G.return=I,ft=G):M2(z)}D=D.sibling}e:for(D=null,z=e;;){if(z.tag===5){if(D===null){D=z;try{h=z.stateNode,E?(p=h.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(u=z.stateNode,T=z.memoizedProps.style,f=T!=null&&T.hasOwnProperty("display")?T.display:null,u.style.display=xC("display",f))}catch(Q){Nn(e,e.return,Q)}}}else if(z.tag===6){if(D===null)try{z.stateNode.nodeValue=E?"":z.memoizedProps}catch(Q){Nn(e,e.return,Q)}}else if((z.tag!==22&&z.tag!==23||z.memoizedState===null||z===e)&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===e)break e;for(;z.sibling===null;){if(z.return===null||z.return===e)break e;D===z&&(D=null),z=z.return}D===z&&(D=null),z.sibling.return=z.return,z=z.sibling}}break;case 19:Es(t,e),Zs(e),a&4&&E2(e);break;case 21:break;default:Es(t,e),Zs(e)}}function Zs(e){var t=e.flags;if(t&2){try{e:{for(var i=e.return;i!==null;){if(Wk(i)){var a=i;break e}i=i.return}throw Error(qe(160))}switch(a.tag){case 5:var h=a.stateNode;a.flags&32&&(jd(h,""),a.flags&=-33);var p=P2(e);u0(e,p,h);break;case 3:case 4:var f=a.stateNode.containerInfo,u=P2(e);l0(e,u,f);break;default:throw Error(qe(161))}}catch(T){Nn(e,e.return,T)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function OD(e,t,i){ft=e,Xk(e)}function Xk(e,t,i){for(var a=(e.mode&1)!==0;ft!==null;){var h=ft,p=h.child;if(h.tag===22&&a){var f=h.memoizedState!==null||Zp;if(!f){var u=h.alternate,T=u!==null&&u.memoizedState!==null||$r;u=Zp;var E=$r;if(Zp=f,($r=T)&&!E)for(ft=h;ft!==null;)f=ft,T=f.child,f.tag===22&&f.memoizedState!==null?A2(h):T!==null?(T.return=f,ft=T):A2(h);for(;p!==null;)ft=p,Xk(p),p=p.sibling;ft=h,Zp=u,$r=E}I2(e)}else h.subtreeFlags&8772&&p!==null?(p.return=h,ft=p):I2(e)}}function I2(e){for(;ft!==null;){var t=ft;if(t.flags&8772){var i=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:$r||_g(5,t);break;case 1:var a=t.stateNode;if(t.flags&4&&!$r)if(i===null)a.componentDidMount();else{var h=t.elementType===t.type?i.memoizedProps:Ms(t.type,i.memoizedProps);a.componentDidUpdate(h,i.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var p=t.updateQueue;p!==null&&f2(t,p,a);break;case 3:var f=t.updateQueue;if(f!==null){if(i=null,t.child!==null)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}f2(t,f,i)}break;case 5:var u=t.stateNode;if(i===null&&t.flags&4){i=u;var T=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":T.autoFocus&&i.focus();break;case"img":T.src&&(i.src=T.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var E=t.alternate;if(E!==null){var D=E.memoizedState;if(D!==null){var z=D.dehydrated;z!==null&&Gd(z)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(qe(163))}$r||t.flags&512&&a0(t)}catch(I){Nn(t,t.return,I)}}if(t===e){ft=null;break}if(i=t.sibling,i!==null){i.return=t.return,ft=i;break}ft=t.return}}function M2(e){for(;ft!==null;){var t=ft;if(t===e){ft=null;break}var i=t.sibling;if(i!==null){i.return=t.return,ft=i;break}ft=t.return}}function A2(e){for(;ft!==null;){var t=ft;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{_g(4,t)}catch(T){Nn(t,i,T)}break;case 1:var a=t.stateNode;if(typeof a.componentDidMount=="function"){var h=t.return;try{a.componentDidMount()}catch(T){Nn(t,h,T)}}var p=t.return;try{a0(t)}catch(T){Nn(t,p,T)}break;case 5:var f=t.return;try{a0(t)}catch(T){Nn(t,f,T)}}}catch(T){Nn(t,t.return,T)}if(t===e){ft=null;break}var u=t.sibling;if(u!==null){u.return=t.return,ft=u;break}ft=t.return}}var VD=Math.ceil,Gm=$o.ReactCurrentDispatcher,Ax=$o.ReactCurrentOwner,fs=$o.ReactCurrentBatchConfig,Wt=0,gr=null,Jn=null,Pr=0,Vi=0,pc=Ha(0),rr=0,nf=null,Xl=0,vg=0,zx=0,zd=null,yi=null,Dx=0,Lc=1/0,Io=null,Wm=!1,c0=null,Oa=null,Hp=!1,za=null,Zm=0,Dd=0,h0=null,dm=-1,fm=0;function ri(){return Wt&6?Un():dm!==-1?dm:dm=Un()}function Va(e){return e.mode&1?Wt&2&&Pr!==0?Pr&-Pr:wD.transition!==null?(fm===0&&(fm=DC()),fm):(e=on,e!==0||(e=window.event,e=e===void 0?16:NC(e.type)),e):1}function Rs(e,t,i,a){if(50<Dd)throw Dd=0,h0=null,Error(qe(185));gf(e,i,a),(!(Wt&2)||e!==gr)&&(e===gr&&(!(Wt&2)&&(vg|=i),rr===4&&Ma(e,Pr)),wi(e,a),i===1&&Wt===0&&!(t.mode&1)&&(Lc=Un()+500,mg&&Xa()))}function wi(e,t){var i=e.callbackNode;wz(e,t);var a=Mm(e,e===gr?Pr:0);if(a===0)i!==null&&Nw(i),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(i!=null&&Nw(i),t===1)e.tag===0?bD(z2.bind(null,e)):sk(z2.bind(null,e)),yD(function(){!(Wt&6)&&Xa()}),i=null;else{switch(RC(a)){case 1:i=sx;break;case 4:i=AC;break;case 16:i=Im;break;case 536870912:i=zC;break;default:i=Im}i=rP(i,Kk.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function Kk(e,t){if(dm=-1,fm=0,Wt&6)throw Error(qe(327));var i=e.callbackNode;if(Cc()&&e.callbackNode!==i)return null;var a=Mm(e,e===gr?Pr:0);if(a===0)return null;if(a&30||a&e.expiredLanes||t)t=Hm(e,a);else{t=a;var h=Wt;Wt|=2;var p=Jk();(gr!==e||Pr!==t)&&(Io=null,Lc=Un()+500,jl(e,t));do try{$D();break}catch(u){Yk(e,u)}while(!0);_x(),Gm.current=p,Wt=h,Jn!==null?t=0:(gr=null,Pr=0,t=rr)}if(t!==0){if(t===2&&(h=Ov(e),h!==0&&(a=h,t=d0(e,h))),t===1)throw i=nf,jl(e,0),Ma(e,a),wi(e,Un()),i;if(t===6)Ma(e,a);else{if(h=e.current.alternate,!(a&30)&&!ND(h)&&(t=Hm(e,a),t===2&&(p=Ov(e),p!==0&&(a=p,t=d0(e,p))),t===1))throw i=nf,jl(e,0),Ma(e,a),wi(e,Un()),i;switch(e.finishedWork=h,e.finishedLanes=a,t){case 0:case 1:throw Error(qe(345));case 2:Al(e,yi,Io);break;case 3:if(Ma(e,a),(a&130023424)===a&&(t=Dx+500-Un(),10<t)){if(Mm(e,0)!==0)break;if(h=e.suspendedLanes,(h&a)!==a){ri(),e.pingedLanes|=e.suspendedLanes&h;break}e.timeoutHandle=Wv(Al.bind(null,e,yi,Io),t);break}Al(e,yi,Io);break;case 4:if(Ma(e,a),(a&4194240)===a)break;for(t=e.eventTimes,h=-1;0<a;){var f=31-Ds(a);p=1<<f,f=t[f],f>h&&(h=f),a&=~p}if(a=h,a=Un()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*VD(a/1960))-a,10<a){e.timeoutHandle=Wv(Al.bind(null,e,yi,Io),a);break}Al(e,yi,Io);break;case 5:Al(e,yi,Io);break;default:throw Error(qe(329))}}}return wi(e,Un()),e.callbackNode===i?Kk.bind(null,e):null}function d0(e,t){var i=zd;return e.current.memoizedState.isDehydrated&&(jl(e,t).flags|=256),e=Hm(e,t),e!==2&&(t=yi,yi=i,t!==null&&f0(t)),e}function f0(e){yi===null?yi=e:yi.push.apply(yi,e)}function ND(e){for(var t=e;;){if(t.flags&16384){var i=t.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var a=0;a<i.length;a++){var h=i[a],p=h.getSnapshot;h=h.value;try{if(!Ls(p(),h))return!1}catch{return!1}}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ma(e,t){for(t&=~zx,t&=~vg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-Ds(t),a=1<<i;e[i]=-1,t&=~a}}function z2(e){if(Wt&6)throw Error(qe(327));Cc();var t=Mm(e,0);if(!(t&1))return wi(e,Un()),null;var i=Hm(e,t);if(e.tag!==0&&i===2){var a=Ov(e);a!==0&&(t=a,i=d0(e,a))}if(i===1)throw i=nf,jl(e,0),Ma(e,t),wi(e,Un()),i;if(i===6)throw Error(qe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Al(e,yi,Io),wi(e,Un()),null}function Rx(e,t){var i=Wt;Wt|=1;try{return e(t)}finally{Wt=i,Wt===0&&(Lc=Un()+500,mg&&Xa())}}function Kl(e){za!==null&&za.tag===0&&!(Wt&6)&&Cc();var t=Wt;Wt|=1;var i=fs.transition,a=on;try{if(fs.transition=null,on=1,e)return e()}finally{on=a,fs.transition=i,Wt=t,!(Wt&6)&&Xa()}}function Lx(){Vi=pc.current,xn(pc)}function jl(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,gD(i)),Jn!==null)for(i=Jn.return;i!==null;){var a=i;switch(mx(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&Lm();break;case 3:Dc(),xn(xi),xn(qr),Tx();break;case 5:Sx(a);break;case 4:Dc();break;case 13:xn(In);break;case 19:xn(In);break;case 10:vx(a.type._context);break;case 22:case 23:Lx()}i=i.return}if(gr=e,Jn=e=Na(e.current,null),Pr=Vi=t,rr=0,nf=null,zx=vg=Xl=0,yi=zd=null,Rl!==null){for(t=0;t<Rl.length;t++)if(i=Rl[t],a=i.interleaved,a!==null){i.interleaved=null;var h=a.next,p=i.pending;if(p!==null){var f=p.next;p.next=h,a.next=f}i.pending=a}Rl=null}return e}function Yk(e,t){do{var i=Jn;try{if(_x(),um.current=qm,Um){for(var a=An.memoizedState;a!==null;){var h=a.queue;h!==null&&(h.pending=null),a=a.next}Um=!1}if(Hl=0,mr=nr=An=null,Md=!1,Qd=0,Ax.current=null,i===null||i.return===null){rr=1,nf=t,Jn=null;break}e:{var p=e,f=i.return,u=i,T=t;if(t=Pr,u.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){var E=T,D=u,z=D.tag;if(!(D.mode&1)&&(z===0||z===11||z===15)){var I=D.alternate;I?(D.updateQueue=I.updateQueue,D.memoizedState=I.memoizedState,D.lanes=I.lanes):(D.updateQueue=null,D.memoizedState=null)}var G=v2(f);if(G!==null){G.flags&=-257,x2(G,f,u,p,t),G.mode&1&&_2(p,E,t),t=G,T=E;var K=t.updateQueue;if(K===null){var Q=new Set;Q.add(T),t.updateQueue=Q}else K.add(T);break e}else{if(!(t&1)){_2(p,E,t),Fx();break e}T=Error(qe(426))}}else if(Cn&&u.mode&1){var ce=v2(f);if(ce!==null){!(ce.flags&65536)&&(ce.flags|=256),x2(ce,f,u,p,t),gx(Rc(T,u));break e}}p=T=Rc(T,u),rr!==4&&(rr=2),zd===null?zd=[p]:zd.push(p),p=f;do{switch(p.tag){case 3:p.flags|=65536,t&=-t,p.lanes|=t;var j=Rk(p,T,t);d2(p,j);break e;case 1:u=T;var U=p.type,X=p.stateNode;if(!(p.flags&128)&&(typeof U.getDerivedStateFromError=="function"||X!==null&&typeof X.componentDidCatch=="function"&&(Oa===null||!Oa.has(X)))){p.flags|=65536,t&=-t,p.lanes|=t;var ne=Lk(p,u,t);d2(p,ne);break e}}p=p.return}while(p!==null)}eP(i)}catch(ge){t=ge,Jn===i&&i!==null&&(Jn=i=i.return);continue}break}while(!0)}function Jk(){var e=Gm.current;return Gm.current=qm,e===null?qm:e}function Fx(){(rr===0||rr===3||rr===2)&&(rr=4),gr===null||!(Xl&268435455)&&!(vg&268435455)||Ma(gr,Pr)}function Hm(e,t){var i=Wt;Wt|=2;var a=Jk();(gr!==e||Pr!==t)&&(Io=null,jl(e,t));do try{jD();break}catch(h){Yk(e,h)}while(!0);if(_x(),Wt=i,Gm.current=a,Jn!==null)throw Error(qe(261));return gr=null,Pr=0,rr}function jD(){for(;Jn!==null;)Qk(Jn)}function $D(){for(;Jn!==null&&!fz();)Qk(Jn)}function Qk(e){var t=nP(e.alternate,e,Vi);e.memoizedProps=e.pendingProps,t===null?eP(e):Jn=t,Ax.current=null}function eP(e){var t=e;do{var i=t.alternate;if(e=t.return,t.flags&32768){if(i=LD(i,t),i!==null){i.flags&=32767,Jn=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{rr=6,Jn=null;return}}else if(i=RD(i,t,Vi),i!==null){Jn=i;return}if(t=t.sibling,t!==null){Jn=t;return}Jn=t=e}while(t!==null);rr===0&&(rr=5)}function Al(e,t,i){var a=on,h=fs.transition;try{fs.transition=null,on=1,UD(e,t,i,a)}finally{fs.transition=h,on=a}return null}function UD(e,t,i,a){do Cc();while(za!==null);if(Wt&6)throw Error(qe(327));i=e.finishedWork;var h=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(qe(177));e.callbackNode=null,e.callbackPriority=0;var p=i.lanes|i.childLanes;if(Sz(e,p),e===gr&&(Jn=gr=null,Pr=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||Hp||(Hp=!0,rP(Im,function(){return Cc(),null})),p=(i.flags&15990)!==0,i.subtreeFlags&15990||p){p=fs.transition,fs.transition=null;var f=on;on=1;var u=Wt;Wt|=4,Ax.current=null,BD(e,i),Hk(i,e),uD(qv),Am=!!Uv,qv=Uv=null,e.current=i,OD(i),pz(),Wt=u,on=f,fs.transition=p}else e.current=i;if(Hp&&(Hp=!1,za=e,Zm=h),p=e.pendingLanes,p===0&&(Oa=null),yz(i.stateNode),wi(e,Un()),t!==null)for(a=e.onRecoverableError,i=0;i<t.length;i++)h=t[i],a(h.value,{componentStack:h.stack,digest:h.digest});if(Wm)throw Wm=!1,e=c0,c0=null,e;return Zm&1&&e.tag!==0&&Cc(),p=e.pendingLanes,p&1?e===h0?Dd++:(Dd=0,h0=e):Dd=0,Xa(),null}function Cc(){if(za!==null){var e=RC(Zm),t=fs.transition,i=on;try{if(fs.transition=null,on=16>e?16:e,za===null)var a=!1;else{if(e=za,za=null,Zm=0,Wt&6)throw Error(qe(331));var h=Wt;for(Wt|=4,ft=e.current;ft!==null;){var p=ft,f=p.child;if(ft.flags&16){var u=p.deletions;if(u!==null){for(var T=0;T<u.length;T++){var E=u[T];for(ft=E;ft!==null;){var D=ft;switch(D.tag){case 0:case 11:case 15:Ad(8,D,p)}var z=D.child;if(z!==null)z.return=D,ft=z;else for(;ft!==null;){D=ft;var I=D.sibling,G=D.return;if(Gk(D),D===E){ft=null;break}if(I!==null){I.return=G,ft=I;break}ft=G}}}var K=p.alternate;if(K!==null){var Q=K.child;if(Q!==null){K.child=null;do{var ce=Q.sibling;Q.sibling=null,Q=ce}while(Q!==null)}}ft=p}}if(p.subtreeFlags&2064&&f!==null)f.return=p,ft=f;else e:for(;ft!==null;){if(p=ft,p.flags&2048)switch(p.tag){case 0:case 11:case 15:Ad(9,p,p.return)}var j=p.sibling;if(j!==null){j.return=p.return,ft=j;break e}ft=p.return}}var U=e.current;for(ft=U;ft!==null;){f=ft;var X=f.child;if(f.subtreeFlags&2064&&X!==null)X.return=f,ft=X;else e:for(f=U;ft!==null;){if(u=ft,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:_g(9,u)}}catch(ge){Nn(u,u.return,ge)}if(u===f){ft=null;break e}var ne=u.sibling;if(ne!==null){ne.return=u.return,ft=ne;break e}ft=u.return}}if(Wt=h,Xa(),eo&&typeof eo.onPostCommitFiberRoot=="function")try{eo.onPostCommitFiberRoot(cg,e)}catch{}a=!0}return a}finally{on=i,fs.transition=t}}return!1}function D2(e,t,i){t=Rc(i,t),t=Rk(e,t,1),e=Ba(e,t,1),t=ri(),e!==null&&(gf(e,1,t),wi(e,t))}function Nn(e,t,i){if(e.tag===3)D2(e,e,i);else for(;t!==null;){if(t.tag===3){D2(t,e,i);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Oa===null||!Oa.has(a))){e=Rc(i,e),e=Lk(t,e,1),t=Ba(t,e,1),e=ri(),t!==null&&(gf(t,1,e),wi(t,e));break}}t=t.return}}function qD(e,t,i){var a=e.pingCache;a!==null&&a.delete(t),t=ri(),e.pingedLanes|=e.suspendedLanes&i,gr===e&&(Pr&i)===i&&(rr===4||rr===3&&(Pr&130023424)===Pr&&500>Un()-Dx?jl(e,0):zx|=i),wi(e,t)}function tP(e,t){t===0&&(e.mode&1?(t=Op,Op<<=1,!(Op&130023424)&&(Op=4194304)):t=1);var i=ri();e=Bo(e,t),e!==null&&(gf(e,t,i),wi(e,i))}function GD(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),tP(e,i)}function WD(e,t){var i=0;switch(e.tag){case 13:var a=e.stateNode,h=e.memoizedState;h!==null&&(i=h.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(qe(314))}a!==null&&a.delete(t),tP(e,i)}var nP;nP=function(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps||xi.current)_i=!0;else{if(!(e.lanes&i)&&!(t.flags&128))return _i=!1,DD(e,t,i);_i=!!(e.flags&131072)}else _i=!1,Cn&&t.flags&1048576&&ok(t,Om,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;hm(e,t),e=t.pendingProps;var h=Mc(t,qr.current);Tc(t,i),h=kx(null,t,a,e,h,i);var p=Px();return t.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,bi(a)?(p=!0,Fm(t)):p=!1,t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,bx(t),h.updater=yg,t.stateNode=h,h._reactInternals=t,Qv(t,a,e,i),t=n0(null,t,a,!0,p,i)):(t.tag=0,Cn&&p&&px(t),ti(null,t,h,i),t=t.child),t;case 16:a=t.elementType;e:{switch(hm(e,t),e=t.pendingProps,h=a._init,a=h(a._payload),t.type=a,h=t.tag=HD(a),e=Ms(a,e),h){case 0:t=t0(null,t,a,e,i);break e;case 1:t=S2(null,t,a,e,i);break e;case 11:t=b2(null,t,a,e,i);break e;case 14:t=w2(null,t,a,Ms(a.type,e),i);break e}throw Error(qe(306,a,""))}return t;case 0:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),t0(e,t,a,h,i);case 1:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),S2(e,t,a,h,i);case 3:e:{if(Vk(t),e===null)throw Error(qe(387));a=t.pendingProps,p=t.memoizedState,h=p.element,dk(e,t),jm(t,a,null,i);var f=t.memoizedState;if(a=f.element,p.isDehydrated)if(p={element:a,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},t.updateQueue.baseState=p,t.memoizedState=p,t.flags&256){h=Rc(Error(qe(423)),t),t=T2(e,t,a,i,h);break e}else if(a!==h){h=Rc(Error(qe(424)),t),t=T2(e,t,a,i,h);break e}else for(ji=Fa(t.stateNode.containerInfo.firstChild),$i=t,Cn=!0,zs=null,i=ck(t,null,a,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Ac(),a===h){t=Oo(e,t,i);break e}ti(e,t,a,i)}t=t.child}return t;case 5:return fk(t),e===null&&Kv(t),a=t.type,h=t.pendingProps,p=e!==null?e.memoizedProps:null,f=h.children,Gv(a,h)?f=null:p!==null&&Gv(a,p)&&(t.flags|=32),Ok(e,t),ti(e,t,f,i),t.child;case 6:return e===null&&Kv(t),null;case 13:return Nk(e,t,i);case 4:return wx(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=zc(t,null,a,i):ti(e,t,a,i),t.child;case 11:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),b2(e,t,a,h,i);case 7:return ti(e,t,t.pendingProps,i),t.child;case 8:return ti(e,t,t.pendingProps.children,i),t.child;case 12:return ti(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(a=t.type._context,h=t.pendingProps,p=t.memoizedProps,f=h.value,gn(Vm,a._currentValue),a._currentValue=f,p!==null)if(Ls(p.value,f)){if(p.children===h.children&&!xi.current){t=Oo(e,t,i);break e}}else for(p=t.child,p!==null&&(p.return=t);p!==null;){var u=p.dependencies;if(u!==null){f=p.child;for(var T=u.firstContext;T!==null;){if(T.context===a){if(p.tag===1){T=Ro(-1,i&-i),T.tag=2;var E=p.updateQueue;if(E!==null){E=E.shared;var D=E.pending;D===null?T.next=T:(T.next=D.next,D.next=T),E.pending=T}}p.lanes|=i,T=p.alternate,T!==null&&(T.lanes|=i),Yv(p.return,i,t),u.lanes|=i;break}T=T.next}}else if(p.tag===10)f=p.type===t.type?null:p.child;else if(p.tag===18){if(f=p.return,f===null)throw Error(qe(341));f.lanes|=i,u=f.alternate,u!==null&&(u.lanes|=i),Yv(f,i,t),f=p.sibling}else f=p.child;if(f!==null)f.return=p;else for(f=p;f!==null;){if(f===t){f=null;break}if(p=f.sibling,p!==null){p.return=f.return,f=p;break}f=f.return}p=f}ti(e,t,h.children,i),t=t.child}return t;case 9:return h=t.type,a=t.pendingProps.children,Tc(t,i),h=ms(h),a=a(h),t.flags|=1,ti(e,t,a,i),t.child;case 14:return a=t.type,h=Ms(a,t.pendingProps),h=Ms(a.type,h),w2(e,t,a,h,i);case 15:return Fk(e,t,t.type,t.pendingProps,i);case 17:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),hm(e,t),t.tag=1,bi(a)?(e=!0,Fm(t)):e=!1,Tc(t,i),Dk(t,a,h),Qv(t,a,h,i),n0(null,t,a,!0,e,i);case 19:return jk(e,t,i);case 22:return Bk(e,t,i)}throw Error(qe(156,t.tag))};function rP(e,t){return MC(e,t)}function ZD(e,t,i,a){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ds(e,t,i,a){return new ZD(e,t,i,a)}function Bx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function HD(e){if(typeof e=="function")return Bx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===nx)return 11;if(e===rx)return 14}return 2}function Na(e,t){var i=e.alternate;return i===null?(i=ds(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function pm(e,t,i,a,h,p){var f=2;if(a=e,typeof e=="function")Bx(e)&&(f=1);else if(typeof e=="string")f=5;else e:switch(e){case ic:return $l(i.children,h,p,t);case tx:f=8,h|=8;break;case Sv:return e=ds(12,i,t,h|2),e.elementType=Sv,e.lanes=p,e;case Tv:return e=ds(13,i,t,h),e.elementType=Tv,e.lanes=p,e;case Cv:return e=ds(19,i,t,h),e.elementType=Cv,e.lanes=p,e;case fC:return xg(i,h,p,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case hC:f=10;break e;case dC:f=9;break e;case nx:f=11;break e;case rx:f=14;break e;case Pa:f=16,a=null;break e}throw Error(qe(130,e==null?e:typeof e,""))}return t=ds(f,i,t,h),t.elementType=e,t.type=a,t.lanes=p,t}function $l(e,t,i,a){return e=ds(7,e,a,t),e.lanes=i,e}function xg(e,t,i,a){return e=ds(22,e,a,t),e.elementType=fC,e.lanes=i,e.stateNode={isHidden:!1},e}function Y_(e,t,i){return e=ds(6,e,null,t),e.lanes=i,e}function J_(e,t,i){return t=ds(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function XD(e,t,i,a,h){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=z_(0),this.expirationTimes=z_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=z_(0),this.identifierPrefix=a,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function Ox(e,t,i,a,h,p,f,u,T){return e=new XD(e,t,i,u,T),t===1?(t=1,p===!0&&(t|=8)):t=0,p=ds(3,null,null,t),e.current=p,p.stateNode=e,p.memoizedState={element:a,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},bx(p),e}function KD(e,t,i){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:rc,key:a==null?null:""+a,children:e,containerInfo:t,implementation:i}}function iP(e){if(!e)return Ua;e=e._reactInternals;e:{if(Ql(e)!==e||e.tag!==1)throw Error(qe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(bi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(qe(171))}if(e.tag===1){var i=e.type;if(bi(i))return ik(e,i,t)}return t}function sP(e,t,i,a,h,p,f,u,T){return e=Ox(i,a,!0,e,h,p,f,u,T),e.context=iP(null),i=e.current,a=ri(),h=Va(i),p=Ro(a,h),p.callback=t??null,Ba(i,p,h),e.current.lanes=h,gf(e,h,a),wi(e,a),e}function bg(e,t,i,a){var h=t.current,p=ri(),f=Va(h);return i=iP(i),t.context===null?t.context=i:t.pendingContext=i,t=Ro(p,f),t.payload={element:e},a=a===void 0?null:a,a!==null&&(t.callback=a),e=Ba(h,t,f),e!==null&&(Rs(e,h,f,p),lm(e,h,f)),f}function Xm(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function R2(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function Vx(e,t){R2(e,t),(e=e.alternate)&&R2(e,t)}function YD(){return null}var oP=typeof reportError=="function"?reportError:function(e){console.error(e)};function Nx(e){this._internalRoot=e}wg.prototype.render=Nx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(qe(409));bg(e,t,null,null)};wg.prototype.unmount=Nx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Kl(function(){bg(null,e,null,null)}),t[Fo]=null}};function wg(e){this._internalRoot=e}wg.prototype.unstable_scheduleHydration=function(e){if(e){var t=BC();e={blockedOn:null,target:e,priority:t};for(var i=0;i<Ia.length&&t!==0&&t<Ia[i].priority;i++);Ia.splice(i,0,e),i===0&&VC(e)}};function jx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Sg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function L2(){}function JD(e,t,i,a,h){if(h){if(typeof a=="function"){var p=a;a=function(){var E=Xm(f);p.call(E)}}var f=sP(t,a,e,0,null,!1,!1,"",L2);return e._reactRootContainer=f,e[Fo]=f.current,Hd(e.nodeType===8?e.parentNode:e),Kl(),f}for(;h=e.lastChild;)e.removeChild(h);if(typeof a=="function"){var u=a;a=function(){var E=Xm(T);u.call(E)}}var T=Ox(e,0,!1,null,null,!1,!1,"",L2);return e._reactRootContainer=T,e[Fo]=T.current,Hd(e.nodeType===8?e.parentNode:e),Kl(function(){bg(t,T,i,a)}),T}function Tg(e,t,i,a,h){var p=i._reactRootContainer;if(p){var f=p;if(typeof h=="function"){var u=h;h=function(){var T=Xm(f);u.call(T)}}bg(t,f,e,h)}else f=JD(i,t,e,h,a);return Xm(f)}LC=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=xd(t.pendingLanes);i!==0&&(ox(t,i|1),wi(t,Un()),!(Wt&6)&&(Lc=Un()+500,Xa()))}break;case 13:Kl(function(){var a=Bo(e,1);if(a!==null){var h=ri();Rs(a,e,1,h)}}),Vx(e,1)}};ax=function(e){if(e.tag===13){var t=Bo(e,134217728);if(t!==null){var i=ri();Rs(t,e,134217728,i)}Vx(e,134217728)}};FC=function(e){if(e.tag===13){var t=Va(e),i=Bo(e,t);if(i!==null){var a=ri();Rs(i,e,t,a)}Vx(e,t)}};BC=function(){return on};OC=function(e,t){var i=on;try{return on=e,t()}finally{on=i}};Lv=function(e,t,i){switch(t){case"input":if(Ev(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var a=i[t];if(a!==e&&a.form===e.form){var h=pg(a);if(!h)throw Error(qe(90));mC(a),Ev(a,h)}}}break;case"textarea":yC(e,i);break;case"select":t=i.value,t!=null&&xc(e,!!i.multiple,t,!1)}};TC=Rx;CC=Kl;var QD={usingClientEntryPoint:!1,Events:[_f,lc,pg,wC,SC,Rx]},fd={findFiberByHostInstance:Dl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eR={bundleType:fd.bundleType,version:fd.version,rendererPackageName:fd.rendererPackageName,rendererConfig:fd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$o.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=EC(e),e===null?null:e.stateNode},findFiberByHostInstance:fd.findFiberByHostInstance||YD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xp.isDisabled&&Xp.supportsFiber)try{cg=Xp.inject(eR),eo=Xp}catch{}}Wi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QD;Wi.createPortal=function(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jx(t))throw Error(qe(200));return KD(e,t,null,i)};Wi.createRoot=function(e,t){if(!jx(e))throw Error(qe(299));var i=!1,a="",h=oP;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(h=t.onRecoverableError)),t=Ox(e,1,!1,null,null,i,!1,a,h),e[Fo]=t.current,Hd(e.nodeType===8?e.parentNode:e),new Nx(t)};Wi.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(qe(188)):(e=Object.keys(e).join(","),Error(qe(268,e)));return e=EC(t),e=e===null?null:e.stateNode,e};Wi.flushSync=function(e){return Kl(e)};Wi.hydrate=function(e,t,i){if(!Sg(t))throw Error(qe(200));return Tg(null,e,t,!0,i)};Wi.hydrateRoot=function(e,t,i){if(!jx(e))throw Error(qe(405));var a=i!=null&&i.hydratedSources||null,h=!1,p="",f=oP;if(i!=null&&(i.unstable_strictMode===!0&&(h=!0),i.identifierPrefix!==void 0&&(p=i.identifierPrefix),i.onRecoverableError!==void 0&&(f=i.onRecoverableError)),t=sP(t,null,e,1,i??null,h,!1,p,f),e[Fo]=t.current,Hd(e),a)for(e=0;e<a.length;e++)i=a[e],h=i._getVersion,h=h(i._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[i,h]:t.mutableSourceEagerHydrationData.push(i,h);return new wg(t)};Wi.render=function(e,t,i){if(!Sg(t))throw Error(qe(200));return Tg(null,e,t,!1,i)};Wi.unmountComponentAtNode=function(e){if(!Sg(e))throw Error(qe(40));return e._reactRootContainer?(Kl(function(){Tg(null,null,e,!1,function(){e._reactRootContainer=null,e[Fo]=null})}),!0):!1};Wi.unstable_batchedUpdates=Rx;Wi.unstable_renderSubtreeIntoContainer=function(e,t,i,a){if(!Sg(i))throw Error(qe(200));if(e==null||e._reactInternals===void 0)throw Error(qe(38));return Tg(e,t,i,!1,a)};Wi.version="18.3.1-next-f1338f8080-20240426";function aP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(aP)}catch(e){console.error(e)}}aP(),aC.exports=Wi;var Cg=aC.exports,lP,F2=Cg;lP=F2.createRoot,F2.hydrateRoot;const tR="modulepreload",nR=function(e){return"/routr/"+e},B2={},rR=function(t,i,a){let h=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),u=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));h=Promise.allSettled(i.map(T=>{if(T=nR(T),T in B2)return;B2[T]=!0;const E=T.endsWith(".css"),D=E?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${T}"]${D}`))return;const z=document.createElement("link");if(z.rel=E?"stylesheet":tR,E||(z.as="script"),z.crossOrigin="",z.href=T,u&&z.setAttribute("nonce",u),document.head.appendChild(z),E)return new Promise((I,G)=>{z.addEventListener("load",I),z.addEventListener("error",()=>G(new Error(`Unable to preload CSS for ${T}`)))})}))}function p(f){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=f,window.dispatchEvent(u),!u.defaultPrevented)throw f}return h.then(f=>{for(const u of f||[])u.status==="rejected"&&p(u.reason);return t().catch(p)})},uP=le.createContext(null);function xf(){var a;const e=(a=le.useContext(uP))==null?void 0:a.maps,t=le.useContext(bf);return le.useMemo(()=>({...e,current:t==null?void 0:t.map}),[e,t])}function iR(e,t){const i=Array.isArray(e)?e[0]:e?e.x:0,a=Array.isArray(e)?e[1]:e?e.y:0,h=Array.isArray(t)?t[0]:t?t.x:0,p=Array.isArray(t)?t[1]:t?t.y:0;return i===h&&a===p}function Ks(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Ks(e[i],t[i]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(const h of i)if(!t.hasOwnProperty(h)||!Ks(e[h],t[h]))return!1;return!0}return!1}function O2(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function V2(e,t){const i=t.viewState||t,a={};if("longitude"in i&&"latitude"in i&&(i.longitude!==e.center.lng||i.latitude!==e.center.lat)){const h=e.center.constructor;a.center=new h(i.longitude,i.latitude)}return"zoom"in i&&i.zoom!==e.zoom&&(a.zoom=i.zoom),"bearing"in i&&i.bearing!==e.bearing&&(a.bearing=i.bearing),"pitch"in i&&i.pitch!==e.pitch&&(a.pitch=i.pitch),i.padding&&e.padding&&!Ks(i.padding,e.padding)&&(a.padding=i.padding),a}const sR=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function N2(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const a of e.layers)t[a.id]=a;const i=e.layers.map(a=>{let h=null;"interactive"in a&&(h=Object.assign({},a),delete h.interactive);const p=t[a.ref];if(p){h=h||Object.assign({},a),delete h.ref;for(const f of sR)f in p&&(h[f]=p[f])}return h||a});return{...e,layers:i}}const j2={version:8,sources:{},layers:[]},$2={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},U2={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},q2={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},oR=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],aR=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Fc{constructor(t,i,a){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=h=>{const p=this.props[q2[h.type]];p?p(h):h.type==="error"&&console.error(h.error)},this._onCameraEvent=h=>{if(this._internalUpdate)return;h.viewState=this._propsedCameraUpdate||O2(this._map.transform);const p=this.props[U2[h.type]];p&&p(h)},this._onCameraUpdate=h=>this._internalUpdate?h:(this._propsedCameraUpdate=O2(h),V2(h,this.props)),this._onPointerEvent=h=>{(h.type==="mousemove"||h.type==="mouseout")&&this._updateHover(h);const p=this.props[$2[h.type]];p&&(this.props.interactiveLayerIds&&h.type!=="mouseover"&&h.type!=="mouseout"&&(h.features=this._hoveredFeatures||this._queryRenderedFeatures(h.point)),p(h),delete h.features)},this._MapClass=t,this.props=i,this._initialize(a)}get map(){return this._map}setProps(t){const i=this.props;this.props=t;const a=this._updateSettings(t,i),h=this._updateSize(t),p=this._updateViewState(t);this._updateStyle(t,i),this._updateStyleComponents(t),this._updateHandlers(t,i),(a||h||p&&!this._map.isMoving())&&this.redraw()}static reuse(t,i){const a=Fc.savedMaps.pop();if(!a)return null;const h=a.map,p=h.getContainer();for(i.className=p.className;p.childNodes.length>0;)i.appendChild(p.childNodes[0]);h._container=i;const f=h._resizeObserver;f&&(f.disconnect(),f.observe(i)),a.setProps({...t,styleDiffing:!1}),h.resize();const{initialViewState:u}=t;return u&&(u.bounds?h.fitBounds(u.bounds,{...u.fitBoundsOptions,duration:0}):a._updateViewState(u)),h.isStyleLoaded()?h.fire("load"):h.once("style.load",()=>h.fire("load")),h._update(),a}_initialize(t){const{props:i}=this,{mapStyle:a=j2}=i,h={...i,...i.initialViewState,container:t,style:N2(a)},p=h.initialViewState||h.viewState||h;if(Object.assign(h,{center:[p.longitude||0,p.latitude||0],zoom:p.zoom||0,pitch:p.pitch||0,bearing:p.bearing||0}),i.gl){const u=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=u,i.gl)}const f=new this._MapClass(h);p.padding&&f.setPadding(p.padding),i.cursor&&(f.getCanvas().style.cursor=i.cursor),f.transformCameraUpdate=this._onCameraUpdate,f.on("style.load",()=>{var u;this._styleComponents={light:f.getLight(),sky:f.getSky(),projection:(u=f.getProjection)==null?void 0:u.call(f),terrain:f.getTerrain()},this._updateStyleComponents(this.props)}),f.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const u in $2)f.on(u,this._onPointerEvent);for(const u in U2)f.on(u,this._onCameraEvent);for(const u in q2)f.on(u,this._onEvent);this._map=f}recycle(){const i=this.map.getContainer().querySelector("[mapboxgl-children]");i==null||i.remove(),Fc.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_updateSize(t){const{viewState:i}=t;if(i){const a=this._map;if(i.width!==a.transform.width||i.height!==a.transform.height)return a.resize(),!0}return!1}_updateViewState(t){const i=this._map,a=i.transform;if(!i.isMoving()){const p=V2(a,t);if(Object.keys(p).length>0)return this._internalUpdate=!0,i.jumpTo(p),this._internalUpdate=!1,!0}return!1}_updateSettings(t,i){const a=this._map;let h=!1;for(const p of oR)if(p in t&&!Ks(t[p],i[p])){h=!0;const f=a[`set${p[0].toUpperCase()}${p.slice(1)}`];f==null||f.call(a,t[p])}return h}_updateStyle(t,i){if(t.cursor!==i.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==i.mapStyle){const{mapStyle:a=j2,styleDiffing:h=!0}=t,p={diff:h};"localIdeographFontFamily"in t&&(p.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(N2(a),p)}}_updateStyleComponents({light:t,projection:i,sky:a,terrain:h}){var u,T;const p=this._map,f=this._styleComponents;p.style._loaded&&(t&&!Ks(t,f.light)&&(f.light=t,p.setLight(t)),i&&!Ks(i,f.projection)&&i!==((u=f.projection)==null?void 0:u.type)&&(f.projection=i,(T=p.setProjection)==null||T.call(p,typeof i=="string"?{type:i}:i)),a&&!Ks(a,f.sky)&&(f.sky=a,p.setSky(a)),h!==void 0&&!Ks(h,f.terrain)&&(!h||p.getSource(h.source))&&(f.terrain=h,p.setTerrain(h)))}_updateHandlers(t,i){const a=this._map;for(const h of aR){const p=t[h]??!0,f=i[h]??!0;Ks(p,f)||(p?a[h].enable(p):a[h].disable())}}_queryRenderedFeatures(t){const i=this._map,{interactiveLayerIds:a=[]}=this.props;try{return i.queryRenderedFeatures(t,{layers:a.filter(i.getLayer.bind(i))})}catch{return[]}}_updateHover(t){var h;const{props:i}=this;if(i.interactiveLayerIds&&(i.onMouseMove||i.onMouseEnter||i.onMouseLeave)){const p=t.type,f=((h=this._hoveredFeatures)==null?void 0:h.length)>0,u=this._queryRenderedFeatures(t.point),T=u.length>0;!T&&f&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=u,T&&!f&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=p}else this._hoveredFeatures=null}}Fc.savedMaps=[];const lR=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function uR(e){if(!e)return null;const t=e.map,i={getMap:()=>t};for(const a of cR(t))!(a in i)&&!lR.includes(a)&&(i[a]=t[a].bind(t));return i}function cR(e){const t=new Set;let i=e;for(;i;){for(const a of Object.getOwnPropertyNames(i))a[0]!=="_"&&typeof e[a]=="function"&&a!=="fire"&&a!=="setEventedParent"&&t.add(a);i=Object.getPrototypeOf(i)}return Array.from(t)}const hR=typeof document<"u"?le.useLayoutEffect:le.useEffect;function dR(e,t){const{RTLTextPlugin:i="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js",maxParallelImageRequests:a,workerCount:h,workerUrl:p}=t;i&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"&&e.setRTLTextPlugin(i,f=>{f&&console.error(f)},!0),a!==void 0&&e.setMaxParallelImageRequests(a),h!==void 0&&e.setWorkerCount(h),p!==void 0&&e.setWorkerUrl(p)}const bf=le.createContext(null);function fR(e,t){const i=le.useContext(uP),[a,h]=le.useState(null),p=le.useRef(),{current:f}=le.useRef({mapLib:null,map:null});le.useEffect(()=>{const E=e.mapLib;let D=!0,z;return Promise.resolve(E||rR(()=>Promise.resolve().then(()=>LF),void 0)).then(I=>{if(!D)return;if(!I)throw new Error("Invalid mapLib");const G="Map"in I?I:I.default;if(!G.Map)throw new Error("Invalid mapLib");if(dR(G,e),!G.supported||G.supported(e))e.reuseMaps&&(z=Fc.reuse(e,p.current)),z||(z=new Fc(G.Map,e,p.current)),f.map=uR(z),f.mapLib=G,h(z),i==null||i.onMapMount(f.map,e.id);else throw new Error("Map is not supported by this browser")}).catch(I=>{const{onError:G}=e;G?G({type:"error",target:null,originalEvent:null,error:I}):console.error(I)}),()=>{D=!1,z&&(i==null||i.onMapUnmount(e.id),e.reuseMaps?z.recycle():z.destroy())}},[]),hR(()=>{a&&a.setProps(e)}),le.useImperativeHandle(t,()=>f.map,[a]);const u=le.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),T={height:"100%"};return le.createElement("div",{id:e.id,ref:p,style:u},a&&le.createElement(bf.Provider,{value:f},le.createElement("div",{"mapboxgl-children":"",style:T},e.children)))}const pR=le.forwardRef(fR),mR=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Uo(e,t){if(!e||!t)return;const i=e.style;for(const a in t){const h=t[a];Number.isFinite(h)&&!mR.test(a)?i[a]=`${h}px`:i[a]=h}}le.memo(le.forwardRef((e,t)=>{const{map:i,mapLib:a}=le.useContext(bf),h=le.useRef({props:e});h.current.props=e;const p=le.useMemo(()=>{let Q=!1;le.Children.forEach(e.children,U=>{U&&(Q=!0)});const ce={...e,element:Q?document.createElement("div"):null},j=new a.Marker(ce);return j.setLngLat([e.longitude,e.latitude]),j.getElement().addEventListener("click",U=>{var X,ne;(ne=(X=h.current.props).onClick)==null||ne.call(X,{type:"click",target:j,originalEvent:U})}),j.on("dragstart",U=>{var ne,ge;const X=U;X.lngLat=p.getLngLat(),(ge=(ne=h.current.props).onDragStart)==null||ge.call(ne,X)}),j.on("drag",U=>{var ne,ge;const X=U;X.lngLat=p.getLngLat(),(ge=(ne=h.current.props).onDrag)==null||ge.call(ne,X)}),j.on("dragend",U=>{var ne,ge;const X=U;X.lngLat=p.getLngLat(),(ge=(ne=h.current.props).onDragEnd)==null||ge.call(ne,X)}),j},[]);le.useEffect(()=>(p.addTo(i.getMap()),()=>{p.remove()}),[]);const{longitude:f,latitude:u,offset:T,style:E,draggable:D=!1,popup:z=null,rotation:I=0,rotationAlignment:G="auto",pitchAlignment:K="auto"}=e;return le.useEffect(()=>{Uo(p.getElement(),E)},[E]),le.useImperativeHandle(t,()=>p,[]),(p.getLngLat().lng!==f||p.getLngLat().lat!==u)&&p.setLngLat([f,u]),T&&!iR(p.getOffset(),T)&&p.setOffset(T),p.isDraggable()!==D&&p.setDraggable(D),p.getRotation()!==I&&p.setRotation(I),p.getRotationAlignment()!==G&&p.setRotationAlignment(G),p.getPitchAlignment()!==K&&p.setPitchAlignment(K),p.getPopup()!==z&&p.setPopup(z),Cg.createPortal(e.children,p.getElement())}));function G2(e){return new Set(e?e.trim().split(/\s+/):[])}le.memo(le.forwardRef((e,t)=>{const{map:i,mapLib:a}=le.useContext(bf),h=le.useMemo(()=>document.createElement("div"),[]),p=le.useRef({props:e});p.current.props=e;const f=le.useMemo(()=>{const u={...e},T=new a.Popup(u);return T.setLngLat([e.longitude,e.latitude]),T.once("open",E=>{var D,z;(z=(D=p.current.props).onOpen)==null||z.call(D,E)}),T},[]);if(le.useEffect(()=>{const u=T=>{var E,D;(D=(E=p.current.props).onClose)==null||D.call(E,T)};return f.on("close",u),f.setDOMContent(h).addTo(i.getMap()),()=>{f.off("close",u),f.isOpen()&&f.remove()}},[]),le.useEffect(()=>{Uo(f.getElement(),e.style)},[e.style]),le.useImperativeHandle(t,()=>f,[]),f.isOpen()&&((f.getLngLat().lng!==e.longitude||f.getLngLat().lat!==e.latitude)&&f.setLngLat([e.longitude,e.latitude]),e.offset&&!Ks(f.options.offset,e.offset)&&f.setOffset(e.offset),(f.options.anchor!==e.anchor||f.options.maxWidth!==e.maxWidth)&&(f.options.anchor=e.anchor,f.setMaxWidth(e.maxWidth)),f.options.className!==e.className)){const u=G2(f.options.className),T=G2(e.className);for(const E of u)T.has(E)||f.removeClassName(E);for(const E of T)u.has(E)||f.addClassName(E);f.options.className=e.className}return Cg.createPortal(e.children,h)}));function eu(e,t,i,a){const h=le.useContext(bf),p=le.useMemo(()=>e(h),[]);return le.useEffect(()=>{const f=t,u=null,T=typeof t=="function"?t:null,{map:E}=h;return E.hasControl(p)||(E.addControl(p,f==null?void 0:f.position),u&&u(h)),()=>{T&&T(h),E.hasControl(p)&&E.removeControl(p)}},[]),p}function gR(e){const t=eu(({mapLib:i})=>new i.AttributionControl(e),{position:e.position});return le.useEffect(()=>{Uo(t._container,e.style)},[e.style]),null}le.memo(gR);function yR(e){const t=eu(({mapLib:i})=>new i.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return le.useEffect(()=>{Uo(t._controlContainer,e.style)},[e.style]),null}le.memo(yR);function _R(e,t){const i=le.useRef({props:e}),a=eu(({mapLib:h})=>{const p=new h.GeolocateControl(e),f=p._setupUI;return p._setupUI=()=>{p._container.hasChildNodes()||f()},p.on("geolocate",u=>{var T,E;(E=(T=i.current.props).onGeolocate)==null||E.call(T,u)}),p.on("error",u=>{var T,E;(E=(T=i.current.props).onError)==null||E.call(T,u)}),p.on("outofmaxbounds",u=>{var T,E;(E=(T=i.current.props).onOutOfMaxBounds)==null||E.call(T,u)}),p.on("trackuserlocationstart",u=>{var T,E;(E=(T=i.current.props).onTrackUserLocationStart)==null||E.call(T,u)}),p.on("trackuserlocationend",u=>{var T,E;(E=(T=i.current.props).onTrackUserLocationEnd)==null||E.call(T,u)}),p},{position:e.position});return i.current.props=e,le.useImperativeHandle(t,()=>a,[]),le.useEffect(()=>{Uo(a._container,e.style)},[e.style]),null}le.memo(le.forwardRef(_R));function vR(e){const t=eu(({mapLib:i})=>new i.NavigationControl(e),{position:e.position});return le.useEffect(()=>{Uo(t._container,e.style)},[e.style]),null}le.memo(vR);function xR(e){const t=eu(({mapLib:p})=>new p.ScaleControl(e),{position:e.position}),i=le.useRef(e),a=i.current;i.current=e;const{style:h}=e;return e.maxWidth!==void 0&&e.maxWidth!==a.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==a.unit&&t.setUnit(e.unit),le.useEffect(()=>{Uo(t._container,h)},[h]),null}le.memo(xR);function bR(e){const t=eu(({mapLib:i})=>new i.TerrainControl(e),{position:e.position});return le.useEffect(()=>{Uo(t._container,e.style)},[e.style]),null}le.memo(bR);function wR(e){const t=eu(({mapLib:i})=>new i.LogoControl(e),{position:e.position});return le.useEffect(()=>{Uo(t._container,e.style)},[e.style]),null}le.memo(wR);const Km=[-100,40],SR=.5,TR=26.2;function CR(e){const t=e.properties,i=[];return t.housenumber&&i.push(t.housenumber),t.street&&i.push(t.street),!t.street&&t.locality&&i.push(t.locality),!t.street&&!t.locality&&t.district&&i.push(t.district),t.city&&i.push(t.city),t.county&&!t.city&&i.push(t.county),t.state&&i.push(t.state),t.country&&i.push(t.country),i.join(", ")||t.name||"Unknown location"}function $x(e,t){const[i,a]=e;let h=!1;for(let p=0,f=t.length-1;p<t.length;f=p++){const[u,T]=t[p],[E,D]=t[f];T>a!=D>a&&i<(E-u)*(a-T)/(D-T)+u&&(h=!h)}return h}async function kR(){try{const t=await(await fetch("https://ipwho.is/")).json();if(typeof t.latitude=="number"&&typeof t.longitude=="number")return[t.longitude,t.latitude]}catch{}return Km}function rf(e,t,i,a){const p=(i-e)*Math.PI/180,f=(a-t)*Math.PI/180,u=Math.sin(p/2)**2+Math.cos(e*Math.PI/180)*Math.cos(i*Math.PI/180)*Math.sin(f/2)**2;return 6371e3*2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))}function PR(e,t=6){const i=Math.pow(10,t),a=[];let h=0,p=0,f=0;for(;h<e.length;){let u=0,T=0,E;do E=e.charCodeAt(h++)-63,u|=(E&31)<<T,T+=5;while(E>=32);p+=u&1?~(u>>1):u>>1,u=0,T=0;do E=e.charCodeAt(h++)-63,u|=(E&31)<<T,T+=5;while(E>=32);f+=u&1?~(u>>1):u>>1,a.push([f/i,p/i])}return a}function Ym(e){const t=e==null?void 0:e.trip;if(!(t!=null&&t.legs))return null;const i=t.legs,a=t.summary,h=[];for(const f of i)h.push(...PR(f.shape,6));const p=a.length*(570/60);return{coordinates:h,distanceMiles:a.length,durationMinutes:p}}function ER(e,t,i,a,h,p,f,u){const T=i-e,E=a-t,D=f-h,z=u-p,I=T*z-E*D;if(Math.abs(I)<1e-12)return!1;const G=((h-e)*z-(p-t)*D)/I,K=((h-e)*E-(p-t)*T)/I;return G>0&&G<1&&K>0&&K<1}function IR(e,t,i){const[a,h]=e,[p,f]=t;for(const u of i)for(let T=0;T<u.length-1;T++){const[E,D]=u[T],[z,I]=u[T+1];if(ER(a,h,p,f,E,D,z,I))return!0}return!1}async function MR(e,t,i){try{const h=`[out:json][timeout:8];(way["highway"~"^(motorway|trunk|motorway_link|trunk_link|primary|primary_link)$"](around:${Math.round(i)},${e},${t}););out geom;`,p=await fetch("https://overpass.kumi.systems/api/interpreter",{method:"POST",body:h});return p.ok?((await p.json()).elements??[]).filter(T=>{var E;return((E=T.geometry)==null?void 0:E.length)>=2}).map(T=>T.geometry.map(({lat:E,lon:D})=>[D,E])):[]}catch{return[]}}function AR(e){return Math.max(800,Math.min(25e3,Math.round(e/(2*Math.PI)*1.8)))}async function zR(e,t,i){try{const h=`[out:json][timeout:30];(way["highway"~"^(footway|path|pedestrian|residential|living_street|cycleway|track|service|unclassified|tertiary|secondary)$"]["access"!="private"](around:${Math.round(i)},${e},${t}););out geom;`,p=await fetch("https://overpass.kumi.systems/api/interpreter",{method:"POST",body:h});if(!p.ok)return new Map;const u=(await p.json()).elements??[],T=(j,U)=>`${j.toFixed(7)},${U.toFixed(7)}`,E=new Map,D=new Set;for(const j of u){if(j.type!=="way"||!j.geometry||j.geometry.length<2)continue;const U=j.geometry;D.add(T(U[0].lat,U[0].lon)),D.add(T(U[U.length-1].lat,U[U.length-1].lon));for(const{lat:X,lon:ne}of U){const ge=T(X,ne);E.set(ge,(E.get(ge)??0)+1)}}let z=1;const I=new Map,G=new Map,K=(j,U)=>{const X=T(j,U);let ne=I.get(X);return ne===void 0&&(ne=z++,I.set(X,ne),G.set(ne,{lat:j,lon:U,neighbors:[]})),ne},Q=(j,U)=>{const X=T(j,U);return(E.get(X)??0)>1||D.has(X)},ce=(j,U,X)=>{const ne=G.get(j),ge=G.get(U);ne.neighbors.some(fe=>fe.nodeId===U)||ne.neighbors.push({nodeId:U,distMeters:X}),ge.neighbors.some(fe=>fe.nodeId===j)||ge.neighbors.push({nodeId:j,distMeters:X})};for(const j of u){if(j.type!=="way"||!j.geometry||j.geometry.length<2)continue;const U=j.geometry;let X=K(U[0].lat,U[0].lon),ne=0,ge=U[0].lat,fe=U[0].lon;for(let we=1;we<U.length;we++){const{lat:Ie,lon:Ne}=U[we];if(ne+=rf(ge,fe,Ie,Ne),ge=Ie,fe=Ne,Q(Ie,Ne)){const $e=K(Ie,Ne);ne>0&&ce(X,$e,ne),X=$e,ne=0}}}return G}catch{return new Map}}function DR(e,t,i){let a=null,h=1/0;for(const[p,f]of e){const u=rf(i,t,f.lat,f.lon);u<h&&(h=u,a=p)}return a}function W2(e,t){return`${Math.round(e/.0015)},${Math.round(t/.0015)}`}function cP(e,t){return e<t?`${e}|${t}`:`${t}|${e}`}function RR(e,t,i,a,h,p,f,u,T,E){const D=Math.min(300,Math.ceil(a/80*1.5)),z=5,I=T/E*2*Math.PI,G=[t],K=new Set,Q=new Map;Q.set(W2(i.lon,i.lat),1);const ce=[];function j(U,X,ne,ge){if(ce.length>=z||ge>D)return;const fe=e.get(U);if(ge>4&&ne>=h&&ne<=p&&rf(fe.lat,fe.lon,i.lat,i.lon)<Math.min(200,a*.05)){ce.push({nodeIds:[...G,t],totalDist:ne,uniqueCells:Q.size});return}if(ne>p)return;const we=ne/p,Ie=fe.neighbors.map(({nodeId:Ne,distMeters:$e})=>{if(Ne===X)return null;const Ve=cP(U,Ne);if(K.has(Ve))return null;const J=e.get(Ne);if(!J||f&&f.length>=3&&!$x([J.lon,J.lat],f))return null;const ze=ne+$e,Le=rf(J.lat,J.lon,i.lat,i.lon);if(ze+Le>p*1.15)return null;const ot=W2(J.lon,J.lat);if((Q.get(ot)??0)>=2)return null;const xt=Math.atan2(J.lat-fe.lat,J.lon-fe.lon),_t=we<.5?I:Math.atan2(i.lat-fe.lat,i.lon-fe.lon),Oe=Math.abs((xt-_t+3*Math.PI)%(2*Math.PI)-Math.PI),et=u.has(Ve)?1.5:0,pt=Oe+et;return{nid:Ne,distMeters:$e,ek:Ve,ck:ot,score:pt}}).filter(Ne=>Ne!==null).sort((Ne,$e)=>Ne.score-$e.score);for(const{nid:Ne,distMeters:$e,ek:Ve,ck:J}of Ie){if(ce.length>=z)return;G.push(Ne),K.add(Ve),Q.set(J,(Q.get(J)??0)+1),j(Ne,U,ne+$e,ge+1),G.pop(),K.delete(Ve);const ze=Q.get(J)-1;ze===0?Q.delete(J):Q.set(J,ze)}}return j(t,-1,0,0),ce}async function LR(e,t,i,a,h){const p=i*.75,f=i*1.35,u=e.get(t);if(!u)return[];const T=[],E=new Set;for(let D=0;D<h;D++){const z=RR(e,t,u,i,p,f,a,E,D,h);for(const I of z){T.push(I);for(let G=0;G<I.nodeIds.length-1;G++)E.add(cP(I.nodeIds[G],I.nodeIds[G+1]))}}return T}const Ux={pedestrian:{walkway_factor:.3,sidewalk_factor:.6,alley_factor:8,driveway_factor:20,use_living_streets:.5,use_tracks:.4,use_hills:.5,use_ferry:0,step_penalty:60,service_penalty:30,shortest:!1}},FR=(e,t,i,a,h)=>Array.from({length:7},(p,f)=>{const u=h+f*2*Math.PI/7;return[e+i*Math.cos(u),t+a*Math.sin(u)]}),BR=(e,t,i,a,h)=>{const p=[];for(let f=0;f<8;f++){const u=f/8*2*Math.PI,T=.55+.45*Math.cos(u/2),E=h+u;p.push([e+i*T*Math.cos(E),t+a*T*Math.sin(E)])}return p},OR=(e,t,i,a,h)=>{const p=[];for(let f=0;f<7;f++){const u=h+f*2*Math.PI/7,T=e+i*.35*Math.cos(h+Math.PI/2),E=t+a*.35*Math.sin(h+Math.PI/2);p.push([T+i*.75*Math.cos(u),E+a*.75*Math.sin(u)])}return p},VR=(e,t,i,a,h)=>{const p=[];for(let f=0;f<6;f++){const u=h+f*2*Math.PI/6;p.push([e+i*.55*Math.cos(u),t+a*.55*Math.sin(u)+a*.45])}for(let f=0;f<4;f++){const u=h-f*2*Math.PI/4;p.push([e+i*.45*Math.cos(u),t+a*.45*Math.sin(u)-a*.45])}return p},NR=[FR,BR,OR,VR];function Z2(e,t,i,a){const h=!a||a.length<3||$x(e,a),p=i.length===0||!IR(t,e,i);return h&&p}function jR(e,t,i,a,h,p){const[f,u]=e,T=t/111320,E=t/(111320*Math.cos(u*(Math.PI/180)));return i(f,u,E,T,a).map(z=>{if(Z2(z,e,h,p))return z;const[I,G]=z,K=I-f,Q=G-u,ce=Math.atan2(Q/T,K/E);for(let j=1;j<=24;j++){const U=ce+j*Math.PI/12,X=[f+E*Math.cos(U),u+T*Math.sin(U)];if(Z2(X,e,h,p))return X}return z})}function hP(e,t){return e.length===0?1:e.filter(i=>$x(i,t)).length/e.length}function dP(e){if(e.length<10)return 0;const t=Math.max(1,Math.floor(e.length/60)),i=e.filter((f,u)=>u%t===0),a=7e-4,h=new Set;let p=0;for(const[f,u]of i){const T=`${Math.round(f/a)},${Math.round(u/a)}`;h.has(T)&&p++,h.add(T)}return p/i.length}async function $R(e,t,i,a,h,p){try{const f=jR(e,t,i,a,h,p),u={locations:[{lon:e[0],lat:e[1],type:"break"},...f.map(([D,z])=>({lon:D,lat:z,type:"through"})),{lon:e[0],lat:e[1],type:"break"}],costing:"pedestrian",costing_options:Ux,directions_options:{units:"miles"}},T=await fetch("https://valhalla1.openstreetmap.de/route",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!T.ok)return null;const E=Ym(await T.json());return!E||p&&p.length>=3&&hP(E.coordinates,p)<.8?null:(E._backtrack=dP(E.coordinates),E)}catch{return null}}function UR(e){const t=new Set,i=.0015;for(const[a,h]of e)t.add(`${Math.round(a/i)},${Math.round(h/i)}`);return t}function qR(e,t){let i=0;for(const a of e)t.has(a)&&i++;return i/(e.size+t.size-i)}function GR(e){const t=[],i=[];for(const a of e){const h=UR(a.coordinates);i.some(f=>qR(h,f)>.45)||(t.push(a),i.push(h))}return t}function WR(e,t,i=10){const a=p=>{const f=t.get(p);return f?[f.lon,f.lat]:null};if(e.length<=i)return e.map(a).filter(p=>p!==null);const h=[];for(let p=0;p<i;p++){const f=Math.round(p*(e.length-1)/(i-1)),u=a(e[Math.min(f,e.length-1)]);u&&h.push(u)}return h}async function ZR(e,t,i,a){try{const h=WR(t.nodeIds,i,10),p={locations:[{lon:e[0],lat:e[1],type:"break"},...h.map(([T,E])=>({lon:T,lat:E,type:"through"})),{lon:e[0],lat:e[1],type:"break"}],costing:"pedestrian",costing_options:Ux,directions_options:{units:"miles"}},f=await fetch("https://valhalla1.openstreetmap.de/route",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!f.ok)return null;const u=Ym(await f.json());return!u||a&&a.length>=3&&hP(u.coordinates,a)<.8?null:(u._backtrack=dP(u.coordinates),u._uniqueCells=t.uniqueCells,u)}catch{return null}}async function H2(e,t,i,a){const h=t/(2*Math.PI*1.8),p=Array.from({length:4},(T,E)=>E*Math.PI*2/4),f=[];for(const T of NR)for(const E of p)f.push($R(e,h,T,E,i,a));return(await Promise.all(f)).filter(T=>T!==null)}async function HR(e,t,i,a,h){const p=[];return await Promise.all(e.map(async f=>{const u=await ZR(t,f,i,a);u&&(p.push(u),h==null||h(u))})),p}async function XR(e,t,i,a){const h=t*1609.34,p=AR(h),[f,u]=e;let T=u,E=f,D=p;if(i&&i.length>=3){const Q=i.map(([fe])=>fe),ce=i.map(([,fe])=>fe),j=Math.min(...Q),U=Math.max(...Q),X=Math.min(...ce),ne=Math.max(...ce);E=(j+U)/2,T=(X+ne)/2;const ge=rf(T,E,ne,U);D=Math.max(p,ge*1.2)}const[z,I]=await Promise.all([MR(u,f,p*1.2),zR(T,E,D)]);let G=[];const K=DR(I,f,u);if(K!==null&&I.size>50){const Q=await LR(I,K,h,i,12);Q.length>0&&(G=await HR(Q,e,I,i,a))}if(G.length<4){const Q=await H2(e,h,z,i);G=[...G,...Q],G.length===0&&i&&i.length>=3&&(G=await H2(e,h,z))}return G.sort((Q,ce)=>{const j=Math.abs(Q.distanceMiles-t)-Math.abs(ce.distanceMiles-t);if(Math.abs(j)>.3)return j;const U=Q._uniqueCells??0,X=ce._uniqueCells??0;if(U!==X)return X-U;const ne=Q._backtrack??0,ge=ce._backtrack??0;return ne-ge}),GR(G).slice(0,8)}async function KR(e,t){return YR(e,t)}async function YR(e,t){try{const i={locations:[{lon:e[0],lat:e[1]},{lon:t[0],lat:t[1]}],costing:"pedestrian",costing_options:Ux,directions_options:{units:"miles"},alternates:2},a=await fetch("https://valhalla1.openstreetmap.de/route",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!a.ok)return[];const h=await a.json(),p=[],f=Ym(h);f&&p.push(f);const u=h.alternates??[];for(const T of u){const E=Ym(T);E&&p.push(E)}return p}catch{return[]}}async function JR(e){try{const i=await(await fetch(`https://photon.komoot.io/api/?q=${encodeURIComponent(e)}&limit=3`)).json();if(!i.features)return[];const a=i.features.map(h=>({id:h.properties.osm_id,coordinates:h.geometry.coordinates,name:CR(h)}));return Array.from(new Map(a.map(h=>[h.id,h])).values())}catch{return[]}}function QR(){const{current:e}=xf();return le.useEffect(()=>{e&&(async()=>{const t=await kR();t!==Km&&e.flyTo({center:t,zoom:8})})()},[e]),e?Ae.jsx(Ae.Fragment,{}):null}const qx=le.createContext({});function Gx(e){const t=le.useRef(null);return t.current===null&&(t.current=e()),t.current}const Wx=typeof window<"u",fP=Wx?le.useLayoutEffect:le.useEffect,kg=le.createContext(null);function Zx(e,t){e.indexOf(t)===-1&&e.push(t)}function Hx(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}const Vo=(e,t,i)=>i>t?t:i<e?e:i;let Xx=()=>{};const No={},pP=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function mP(e){return typeof e=="object"&&e!==null}const gP=e=>/^0[^.\s]+$/u.test(e);function Kx(e){let t;return()=>(t===void 0&&(t=e()),t)}const ps=e=>e,eL=(e,t)=>i=>t(e(i)),wf=(...e)=>e.reduce(eL),sf=(e,t,i)=>{const a=t-e;return a===0?1:(i-e)/a};class Yx{constructor(){this.subscriptions=[]}add(t){return Zx(this.subscriptions,t),()=>Hx(this.subscriptions,t)}notify(t,i,a){const h=this.subscriptions.length;if(h)if(h===1)this.subscriptions[0](t,i,a);else for(let p=0;p<h;p++){const f=this.subscriptions[p];f&&f(t,i,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const no=e=>e*1e3,ro=e=>e/1e3;function yP(e,t){return t?e*(1e3/t):0}const _P=(e,t,i)=>(((1-3*i+3*t)*e+(3*i-6*t))*e+3*t)*e,tL=1e-7,nL=12;function rL(e,t,i,a,h){let p,f,u=0;do f=t+(i-t)/2,p=_P(f,a,h)-e,p>0?i=f:t=f;while(Math.abs(p)>tL&&++u<nL);return f}function Sf(e,t,i,a){if(e===t&&i===a)return ps;const h=p=>rL(p,0,1,e,i);return p=>p===0||p===1?p:_P(h(p),t,a)}const vP=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,xP=e=>t=>1-e(1-t),bP=Sf(.33,1.53,.69,.99),Jx=xP(bP),wP=vP(Jx),SP=e=>(e*=2)<1?.5*Jx(e):.5*(2-Math.pow(2,-10*(e-1))),Qx=e=>1-Math.sin(Math.acos(e)),TP=xP(Qx),CP=vP(Qx),iL=Sf(.42,0,1,1),sL=Sf(0,0,.58,1),kP=Sf(.42,0,.58,1),oL=e=>Array.isArray(e)&&typeof e[0]!="number",PP=e=>Array.isArray(e)&&typeof e[0]=="number",aL={linear:ps,easeIn:iL,easeInOut:kP,easeOut:sL,circIn:Qx,circInOut:CP,circOut:TP,backIn:Jx,backInOut:wP,backOut:bP,anticipate:SP},lL=e=>typeof e=="string",X2=e=>{if(PP(e)){Xx(e.length===4);const[t,i,a,h]=e;return Sf(t,i,a,h)}else if(lL(e))return aL[e];return e},Kp=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function uL(e,t){let i=new Set,a=new Set,h=!1,p=!1;const f=new WeakSet;let u={delta:0,timestamp:0,isProcessing:!1};function T(D){f.has(D)&&(E.schedule(D),e()),D(u)}const E={schedule:(D,z=!1,I=!1)=>{const K=I&&h?i:a;return z&&f.add(D),K.has(D)||K.add(D),D},cancel:D=>{a.delete(D),f.delete(D)},process:D=>{if(u=D,h){p=!0;return}h=!0,[i,a]=[a,i],i.forEach(T),i.clear(),h=!1,p&&(p=!1,E.process(D))}};return E}const cL=40;function EP(e,t){let i=!1,a=!0;const h={delta:0,timestamp:0,isProcessing:!1},p=()=>i=!0,f=Kp.reduce((X,ne)=>(X[ne]=uL(p),X),{}),{setup:u,read:T,resolveKeyframes:E,preUpdate:D,update:z,preRender:I,render:G,postRender:K}=f,Q=()=>{const X=No.useManualTiming?h.timestamp:performance.now();i=!1,No.useManualTiming||(h.delta=a?1e3/60:Math.max(Math.min(X-h.timestamp,cL),1)),h.timestamp=X,h.isProcessing=!0,u.process(h),T.process(h),E.process(h),D.process(h),z.process(h),I.process(h),G.process(h),K.process(h),h.isProcessing=!1,i&&t&&(a=!1,e(Q))},ce=()=>{i=!0,a=!0,h.isProcessing||e(Q)};return{schedule:Kp.reduce((X,ne)=>{const ge=f[ne];return X[ne]=(fe,we=!1,Ie=!1)=>(i||ce(),ge.schedule(fe,we,Ie)),X},{}),cancel:X=>{for(let ne=0;ne<Kp.length;ne++)f[Kp[ne]].cancel(X)},state:h,steps:f}}const{schedule:kn,cancel:qa,state:Cr,steps:Q_}=EP(typeof requestAnimationFrame<"u"?requestAnimationFrame:ps,!0);let mm;function hL(){mm=void 0}const vi={now:()=>(mm===void 0&&vi.set(Cr.isProcessing||No.useManualTiming?Cr.timestamp:performance.now()),mm),set:e=>{mm=e,queueMicrotask(hL)}},IP=e=>t=>typeof t=="string"&&t.startsWith(e),e1=IP("--"),dL=IP("var(--"),t1=e=>dL(e)?fL.test(e.split("/*")[0].trim()):!1,fL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,qc={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},of={...qc,transform:e=>Vo(0,1,e)},Yp={...qc,default:1},Rd=e=>Math.round(e*1e5)/1e5,n1=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function pL(e){return e==null}const mL=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,r1=(e,t)=>i=>!!(typeof i=="string"&&mL.test(i)&&i.startsWith(e)||t&&!pL(i)&&Object.prototype.hasOwnProperty.call(i,t)),MP=(e,t,i)=>a=>{if(typeof a!="string")return a;const[h,p,f,u]=a.match(n1);return{[e]:parseFloat(h),[t]:parseFloat(p),[i]:parseFloat(f),alpha:u!==void 0?parseFloat(u):1}},gL=e=>Vo(0,255,e),ev={...qc,transform:e=>Math.round(gL(e))},Fl={test:r1("rgb","red"),parse:MP("red","green","blue"),transform:({red:e,green:t,blue:i,alpha:a=1})=>"rgba("+ev.transform(e)+", "+ev.transform(t)+", "+ev.transform(i)+", "+Rd(of.transform(a))+")"};function yL(e){let t="",i="",a="",h="";return e.length>5?(t=e.substring(1,3),i=e.substring(3,5),a=e.substring(5,7),h=e.substring(7,9)):(t=e.substring(1,2),i=e.substring(2,3),a=e.substring(3,4),h=e.substring(4,5),t+=t,i+=i,a+=a,h+=h),{red:parseInt(t,16),green:parseInt(i,16),blue:parseInt(a,16),alpha:h?parseInt(h,16)/255:1}}const p0={test:r1("#"),parse:yL,transform:Fl.transform},Tf=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),ka=Tf("deg"),io=Tf("%"),Et=Tf("px"),_L=Tf("vh"),vL=Tf("vw"),K2={...io,parse:e=>io.parse(e)/100,transform:e=>io.transform(e*100)},mc={test:r1("hsl","hue"),parse:MP("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:i,alpha:a=1})=>"hsla("+Math.round(e)+", "+io.transform(Rd(t))+", "+io.transform(Rd(i))+", "+Rd(of.transform(a))+")"},Kn={test:e=>Fl.test(e)||p0.test(e)||mc.test(e),parse:e=>Fl.test(e)?Fl.parse(e):mc.test(e)?mc.parse(e):p0.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Fl.transform(e):mc.transform(e),getAnimatableNone:e=>{const t=Kn.parse(e);return t.alpha=0,Kn.transform(t)}},xL=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function bL(e){var t,i;return isNaN(e)&&typeof e=="string"&&(((t=e.match(n1))==null?void 0:t.length)||0)+(((i=e.match(xL))==null?void 0:i.length)||0)>0}const AP="number",zP="color",wL="var",SL="var(",Y2="${}",TL=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function af(e){const t=e.toString(),i=[],a={color:[],number:[],var:[]},h=[];let p=0;const u=t.replace(TL,T=>(Kn.test(T)?(a.color.push(p),h.push(zP),i.push(Kn.parse(T))):T.startsWith(SL)?(a.var.push(p),h.push(wL),i.push(T)):(a.number.push(p),h.push(AP),i.push(parseFloat(T))),++p,Y2)).split(Y2);return{values:i,split:u,indexes:a,types:h}}function DP(e){return af(e).values}function RP(e){const{split:t,types:i}=af(e),a=t.length;return h=>{let p="";for(let f=0;f<a;f++)if(p+=t[f],h[f]!==void 0){const u=i[f];u===AP?p+=Rd(h[f]):u===zP?p+=Kn.transform(h[f]):p+=h[f]}return p}}const CL=e=>typeof e=="number"?0:Kn.test(e)?Kn.getAnimatableNone(e):e;function kL(e){const t=DP(e);return RP(e)(t.map(CL))}const Ga={test:bL,parse:DP,createTransformer:RP,getAnimatableNone:kL};function tv(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function PL({hue:e,saturation:t,lightness:i,alpha:a}){e/=360,t/=100,i/=100;let h=0,p=0,f=0;if(!t)h=p=f=i;else{const u=i<.5?i*(1+t):i+t-i*t,T=2*i-u;h=tv(T,u,e+1/3),p=tv(T,u,e),f=tv(T,u,e-1/3)}return{red:Math.round(h*255),green:Math.round(p*255),blue:Math.round(f*255),alpha:a}}function Jm(e,t){return i=>i>0?t:e}const Mn=(e,t,i)=>e+(t-e)*i,nv=(e,t,i)=>{const a=e*e,h=i*(t*t-a)+a;return h<0?0:Math.sqrt(h)},EL=[p0,Fl,mc],IL=e=>EL.find(t=>t.test(e));function J2(e){const t=IL(e);if(!t)return!1;let i=t.parse(e);return t===mc&&(i=PL(i)),i}const Q2=(e,t)=>{const i=J2(e),a=J2(t);if(!i||!a)return Jm(e,t);const h={...i};return p=>(h.red=nv(i.red,a.red,p),h.green=nv(i.green,a.green,p),h.blue=nv(i.blue,a.blue,p),h.alpha=Mn(i.alpha,a.alpha,p),Fl.transform(h))},m0=new Set(["none","hidden"]);function ML(e,t){return m0.has(e)?i=>i<=0?e:t:i=>i>=1?t:e}function AL(e,t){return i=>Mn(e,t,i)}function i1(e){return typeof e=="number"?AL:typeof e=="string"?t1(e)?Jm:Kn.test(e)?Q2:RL:Array.isArray(e)?LP:typeof e=="object"?Kn.test(e)?Q2:zL:Jm}function LP(e,t){const i=[...e],a=i.length,h=e.map((p,f)=>i1(p)(p,t[f]));return p=>{for(let f=0;f<a;f++)i[f]=h[f](p);return i}}function zL(e,t){const i={...e,...t},a={};for(const h in i)e[h]!==void 0&&t[h]!==void 0&&(a[h]=i1(e[h])(e[h],t[h]));return h=>{for(const p in a)i[p]=a[p](h);return i}}function DL(e,t){const i=[],a={color:0,var:0,number:0};for(let h=0;h<t.values.length;h++){const p=t.types[h],f=e.indexes[p][a[p]],u=e.values[f]??0;i[h]=u,a[p]++}return i}const RL=(e,t)=>{const i=Ga.createTransformer(t),a=af(e),h=af(t);return a.indexes.var.length===h.indexes.var.length&&a.indexes.color.length===h.indexes.color.length&&a.indexes.number.length>=h.indexes.number.length?m0.has(e)&&!h.values.length||m0.has(t)&&!a.values.length?ML(e,t):wf(LP(DL(a,h),h.values),i):Jm(e,t)};function FP(e,t,i){return typeof e=="number"&&typeof t=="number"&&typeof i=="number"?Mn(e,t,i):i1(e)(e,t)}const LL=e=>{const t=({timestamp:i})=>e(i);return{start:(i=!0)=>kn.update(t,i),stop:()=>qa(t),now:()=>Cr.isProcessing?Cr.timestamp:vi.now()}},BP=(e,t,i=10)=>{let a="";const h=Math.max(Math.round(t/i),2);for(let p=0;p<h;p++)a+=Math.round(e(p/(h-1))*1e4)/1e4+", ";return`linear(${a.substring(0,a.length-2)})`},Qm=2e4;function s1(e){let t=0;const i=50;let a=e.next(t);for(;!a.done&&t<Qm;)t+=i,a=e.next(t);return t>=Qm?1/0:t}function FL(e,t=100,i){const a=i({...e,keyframes:[0,t]}),h=Math.min(s1(a),Qm);return{type:"keyframes",ease:p=>a.next(h*p).value/t,duration:ro(h)}}const BL=5;function OP(e,t,i){const a=Math.max(t-BL,0);return yP(i-e(a),t-a)}const Vn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},rv=.001;function OL({duration:e=Vn.duration,bounce:t=Vn.bounce,velocity:i=Vn.velocity,mass:a=Vn.mass}){let h,p,f=1-t;f=Vo(Vn.minDamping,Vn.maxDamping,f),e=Vo(Vn.minDuration,Vn.maxDuration,ro(e)),f<1?(h=E=>{const D=E*f,z=D*e,I=D-i,G=g0(E,f),K=Math.exp(-z);return rv-I/G*K},p=E=>{const z=E*f*e,I=z*i+i,G=Math.pow(f,2)*Math.pow(E,2)*e,K=Math.exp(-z),Q=g0(Math.pow(E,2),f);return(-h(E)+rv>0?-1:1)*((I-G)*K)/Q}):(h=E=>{const D=Math.exp(-E*e),z=(E-i)*e+1;return-rv+D*z},p=E=>{const D=Math.exp(-E*e),z=(i-E)*(e*e);return D*z});const u=5/e,T=NL(h,p,u);if(e=no(e),isNaN(T))return{stiffness:Vn.stiffness,damping:Vn.damping,duration:e};{const E=Math.pow(T,2)*a;return{stiffness:E,damping:f*2*Math.sqrt(a*E),duration:e}}}const VL=12;function NL(e,t,i){let a=i;for(let h=1;h<VL;h++)a=a-e(a)/t(a);return a}function g0(e,t){return e*Math.sqrt(1-t*t)}const jL=["duration","bounce"],$L=["stiffness","damping","mass"];function eS(e,t){return t.some(i=>e[i]!==void 0)}function UL(e){let t={velocity:Vn.velocity,stiffness:Vn.stiffness,damping:Vn.damping,mass:Vn.mass,isResolvedFromDuration:!1,...e};if(!eS(e,$L)&&eS(e,jL))if(e.visualDuration){const i=e.visualDuration,a=2*Math.PI/(i*1.2),h=a*a,p=2*Vo(.05,1,1-(e.bounce||0))*Math.sqrt(h);t={...t,mass:Vn.mass,stiffness:h,damping:p}}else{const i=OL(e);t={...t,...i,mass:Vn.mass},t.isResolvedFromDuration=!0}return t}function eg(e=Vn.visualDuration,t=Vn.bounce){const i=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:a,restDelta:h}=i;const p=i.keyframes[0],f=i.keyframes[i.keyframes.length-1],u={done:!1,value:p},{stiffness:T,damping:E,mass:D,duration:z,velocity:I,isResolvedFromDuration:G}=UL({...i,velocity:-ro(i.velocity||0)}),K=I||0,Q=E/(2*Math.sqrt(T*D)),ce=f-p,j=ro(Math.sqrt(T/D)),U=Math.abs(ce)<5;a||(a=U?Vn.restSpeed.granular:Vn.restSpeed.default),h||(h=U?Vn.restDelta.granular:Vn.restDelta.default);let X;if(Q<1){const ge=g0(j,Q);X=fe=>{const we=Math.exp(-Q*j*fe);return f-we*((K+Q*j*ce)/ge*Math.sin(ge*fe)+ce*Math.cos(ge*fe))}}else if(Q===1)X=ge=>f-Math.exp(-j*ge)*(ce+(K+j*ce)*ge);else{const ge=j*Math.sqrt(Q*Q-1);X=fe=>{const we=Math.exp(-Q*j*fe),Ie=Math.min(ge*fe,300);return f-we*((K+Q*j*ce)*Math.sinh(Ie)+ge*ce*Math.cosh(Ie))/ge}}const ne={calculatedDuration:G&&z||null,next:ge=>{const fe=X(ge);if(G)u.done=ge>=z;else{let we=ge===0?K:0;Q<1&&(we=ge===0?no(K):OP(X,ge,fe));const Ie=Math.abs(we)<=a,Ne=Math.abs(f-fe)<=h;u.done=Ie&&Ne}return u.value=u.done?f:fe,u},toString:()=>{const ge=Math.min(s1(ne),Qm),fe=BP(we=>ne.next(ge*we).value,ge,30);return ge+"ms "+fe},toTransition:()=>{}};return ne}eg.applyToOptions=e=>{const t=FL(e,100,eg);return e.ease=t.ease,e.duration=no(t.duration),e.type="keyframes",e};function y0({keyframes:e,velocity:t=0,power:i=.8,timeConstant:a=325,bounceDamping:h=10,bounceStiffness:p=500,modifyTarget:f,min:u,max:T,restDelta:E=.5,restSpeed:D}){const z=e[0],I={done:!1,value:z},G=Ie=>u!==void 0&&Ie<u||T!==void 0&&Ie>T,K=Ie=>u===void 0?T:T===void 0||Math.abs(u-Ie)<Math.abs(T-Ie)?u:T;let Q=i*t;const ce=z+Q,j=f===void 0?ce:f(ce);j!==ce&&(Q=j-z);const U=Ie=>-Q*Math.exp(-Ie/a),X=Ie=>j+U(Ie),ne=Ie=>{const Ne=U(Ie),$e=X(Ie);I.done=Math.abs(Ne)<=E,I.value=I.done?j:$e};let ge,fe;const we=Ie=>{G(I.value)&&(ge=Ie,fe=eg({keyframes:[I.value,K(I.value)],velocity:OP(X,Ie,I.value),damping:h,stiffness:p,restDelta:E,restSpeed:D}))};return we(0),{calculatedDuration:null,next:Ie=>{let Ne=!1;return!fe&&ge===void 0&&(Ne=!0,ne(Ie),we(Ie)),ge!==void 0&&Ie>=ge?fe.next(Ie-ge):(!Ne&&ne(Ie),I)}}}function qL(e,t,i){const a=[],h=i||No.mix||FP,p=e.length-1;for(let f=0;f<p;f++){let u=h(e[f],e[f+1]);if(t){const T=Array.isArray(t)?t[f]||ps:t;u=wf(T,u)}a.push(u)}return a}function GL(e,t,{clamp:i=!0,ease:a,mixer:h}={}){const p=e.length;if(Xx(p===t.length),p===1)return()=>t[0];if(p===2&&t[0]===t[1])return()=>t[1];const f=e[0]===e[1];e[0]>e[p-1]&&(e=[...e].reverse(),t=[...t].reverse());const u=qL(t,a,h),T=u.length,E=D=>{if(f&&D<e[0])return t[0];let z=0;if(T>1)for(;z<e.length-2&&!(D<e[z+1]);z++);const I=sf(e[z],e[z+1],D);return u[z](I)};return i?D=>E(Vo(e[0],e[p-1],D)):E}function WL(e,t){const i=e[e.length-1];for(let a=1;a<=t;a++){const h=sf(0,t,a);e.push(Mn(i,1,h))}}function ZL(e){const t=[0];return WL(t,e.length-1),t}function HL(e,t){return e.map(i=>i*t)}function XL(e,t){return e.map(()=>t||kP).splice(0,e.length-1)}function Ld({duration:e=300,keyframes:t,times:i,ease:a="easeInOut"}){const h=oL(a)?a.map(X2):X2(a),p={done:!1,value:t[0]},f=HL(i&&i.length===t.length?i:ZL(t),e),u=GL(f,t,{ease:Array.isArray(h)?h:XL(t,h)});return{calculatedDuration:e,next:T=>(p.value=u(T),p.done=T>=e,p)}}const KL=e=>e!==null;function o1(e,{repeat:t,repeatType:i="loop"},a,h=1){const p=e.filter(KL),u=h<0||t&&i!=="loop"&&t%2===1?0:p.length-1;return!u||a===void 0?p[u]:a}const YL={decay:y0,inertia:y0,tween:Ld,keyframes:Ld,spring:eg};function VP(e){typeof e.type=="string"&&(e.type=YL[e.type])}class a1{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,i){return this.finished.then(t,i)}}const JL=e=>e/100;class l1 extends a1{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var a,h;const{motionValue:i}=this.options;i&&i.updatedAt!==vi.now()&&this.tick(vi.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(h=(a=this.options).onStop)==null||h.call(a))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;VP(t);const{type:i=Ld,repeat:a=0,repeatDelay:h=0,repeatType:p,velocity:f=0}=t;let{keyframes:u}=t;const T=i||Ld;T!==Ld&&typeof u[0]!="number"&&(this.mixKeyframes=wf(JL,FP(u[0],u[1])),u=[0,100]);const E=T({...t,keyframes:u});p==="mirror"&&(this.mirroredGenerator=T({...t,keyframes:[...u].reverse(),velocity:-f})),E.calculatedDuration===null&&(E.calculatedDuration=s1(E));const{calculatedDuration:D}=E;this.calculatedDuration=D,this.resolvedDuration=D+h,this.totalDuration=this.resolvedDuration*(a+1)-h,this.generator=E}updateTime(t){const i=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=i}tick(t,i=!1){const{generator:a,totalDuration:h,mixKeyframes:p,mirroredGenerator:f,resolvedDuration:u,calculatedDuration:T}=this;if(this.startTime===null)return a.next(0);const{delay:E=0,keyframes:D,repeat:z,repeatType:I,repeatDelay:G,type:K,onUpdate:Q,finalKeyframe:ce}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-h/this.speed,this.startTime)),i?this.currentTime=t:this.updateTime(t);const j=this.currentTime-E*(this.playbackSpeed>=0?1:-1),U=this.playbackSpeed>=0?j<0:j>h;this.currentTime=Math.max(j,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let X=this.currentTime,ne=a;if(z){const Ie=Math.min(this.currentTime,h)/u;let Ne=Math.floor(Ie),$e=Ie%1;!$e&&Ie>=1&&($e=1),$e===1&&Ne--,Ne=Math.min(Ne,z+1),!!(Ne%2)&&(I==="reverse"?($e=1-$e,G&&($e-=G/u)):I==="mirror"&&(ne=f)),X=Vo(0,1,$e)*u}const ge=U?{done:!1,value:D[0]}:ne.next(X);p&&(ge.value=p(ge.value));let{done:fe}=ge;!U&&T!==null&&(fe=this.playbackSpeed>=0?this.currentTime>=h:this.currentTime<=0);const we=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&fe);return we&&K!==y0&&(ge.value=o1(D,this.options,ce,this.speed)),Q&&Q(ge.value),we&&this.finish(),ge}then(t,i){return this.finished.then(t,i)}get duration(){return ro(this.calculatedDuration)}get time(){return ro(this.currentTime)}set time(t){var i;t=no(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(i=this.driver)==null||i.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(vi.now());const i=this.playbackSpeed!==t;this.playbackSpeed=t,i&&(this.time=ro(this.currentTime))}play(){var h,p;if(this.isStopped)return;const{driver:t=LL,startTime:i}=this.options;this.driver||(this.driver=t(f=>this.tick(f))),(p=(h=this.options).onPlay)==null||p.call(h);const a=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=a):this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime||(this.startTime=i??a),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(vi.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,i;this.notifyFinished(),this.teardown(),this.state="finished",(i=(t=this.options).onComplete)==null||i.call(t)}cancel(){var t,i;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(i=(t=this.options).onCancel)==null||i.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var i;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(i=this.driver)==null||i.stop(),t.observe(this)}}function QL(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Bl=e=>e*180/Math.PI,_0=e=>{const t=Bl(Math.atan2(e[1],e[0]));return v0(t)},e5={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:_0,rotateZ:_0,skewX:e=>Bl(Math.atan(e[1])),skewY:e=>Bl(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},v0=e=>(e=e%360,e<0&&(e+=360),e),tS=_0,nS=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),rS=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),t5={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:nS,scaleY:rS,scale:e=>(nS(e)+rS(e))/2,rotateX:e=>v0(Bl(Math.atan2(e[6],e[5]))),rotateY:e=>v0(Bl(Math.atan2(-e[2],e[0]))),rotateZ:tS,rotate:tS,skewX:e=>Bl(Math.atan(e[4])),skewY:e=>Bl(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function x0(e){return e.includes("scale")?1:0}function b0(e,t){if(!e||e==="none")return x0(t);const i=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let a,h;if(i)a=t5,h=i;else{const u=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);a=e5,h=u}if(!h)return x0(t);const p=a[t],f=h[1].split(",").map(r5);return typeof p=="function"?p(f):f[p]}const n5=(e,t)=>{const{transform:i="none"}=getComputedStyle(e);return b0(i,t)};function r5(e){return parseFloat(e.trim())}const Gc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Wc=new Set(Gc),iS=e=>e===qc||e===Et,i5=new Set(["x","y","z"]),s5=Gc.filter(e=>!i5.has(e));function o5(e){const t=[];return s5.forEach(i=>{const a=e.getValue(i);a!==void 0&&(t.push([i,a.get()]),a.set(i.startsWith("scale")?1:0))}),t}const Ul={width:({x:e},{paddingLeft:t="0",paddingRight:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),height:({y:e},{paddingTop:t="0",paddingBottom:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>b0(t,"x"),y:(e,{transform:t})=>b0(t,"y")};Ul.translateX=Ul.x;Ul.translateY=Ul.y;const ql=new Set;let w0=!1,S0=!1,T0=!1;function NP(){if(S0){const e=Array.from(ql).filter(a=>a.needsMeasurement),t=new Set(e.map(a=>a.element)),i=new Map;t.forEach(a=>{const h=o5(a);h.length&&(i.set(a,h),a.render())}),e.forEach(a=>a.measureInitialState()),t.forEach(a=>{a.render();const h=i.get(a);h&&h.forEach(([p,f])=>{var u;(u=a.getValue(p))==null||u.set(f)})}),e.forEach(a=>a.measureEndState()),e.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}S0=!1,w0=!1,ql.forEach(e=>e.complete(T0)),ql.clear()}function jP(){ql.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(S0=!0)})}function a5(){T0=!0,jP(),NP(),T0=!1}class u1{constructor(t,i,a,h,p,f=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=i,this.name=a,this.motionValue=h,this.element=p,this.isAsync=f}scheduleResolve(){this.state="scheduled",this.isAsync?(ql.add(this),w0||(w0=!0,kn.read(jP),kn.resolveKeyframes(NP))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:i,element:a,motionValue:h}=this;if(t[0]===null){const p=h==null?void 0:h.get(),f=t[t.length-1];if(p!==void 0)t[0]=p;else if(a&&i){const u=a.readValue(i,f);u!=null&&(t[0]=u)}t[0]===void 0&&(t[0]=f),h&&p===void 0&&h.set(t[0])}QL(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),ql.delete(this)}cancel(){this.state==="scheduled"&&(ql.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const l5=e=>e.startsWith("--");function u5(e,t,i){l5(t)?e.style.setProperty(t,i):e.style[t]=i}const c5=Kx(()=>window.ScrollTimeline!==void 0),h5={};function d5(e,t){const i=Kx(e);return()=>h5[t]??i()}const $P=d5(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),wd=([e,t,i,a])=>`cubic-bezier(${e}, ${t}, ${i}, ${a})`,sS={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:wd([0,.65,.55,1]),circOut:wd([.55,0,1,.45]),backIn:wd([.31,.01,.66,-.59]),backOut:wd([.33,1.53,.69,.99])};function UP(e,t){if(e)return typeof e=="function"?$P()?BP(e,t):"ease-out":PP(e)?wd(e):Array.isArray(e)?e.map(i=>UP(i,t)||sS.easeOut):sS[e]}function f5(e,t,i,{delay:a=0,duration:h=300,repeat:p=0,repeatType:f="loop",ease:u="easeOut",times:T}={},E=void 0){const D={[t]:i};T&&(D.offset=T);const z=UP(u,h);Array.isArray(z)&&(D.easing=z);const I={delay:a,duration:h,easing:Array.isArray(z)?"linear":z,fill:"both",iterations:p+1,direction:f==="reverse"?"alternate":"normal"};return E&&(I.pseudoElement=E),e.animate(D,I)}function qP(e){return typeof e=="function"&&"applyToOptions"in e}function p5({type:e,...t}){return qP(e)&&$P()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class m5 extends a1{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:i,name:a,keyframes:h,pseudoElement:p,allowFlatten:f=!1,finalKeyframe:u,onComplete:T}=t;this.isPseudoElement=!!p,this.allowFlatten=f,this.options=t,Xx(typeof t.type!="string");const E=p5(t);this.animation=f5(i,a,h,E,p),E.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!p){const D=o1(h,this.options,u,this.speed);this.updateMotionValue?this.updateMotionValue(D):u5(i,a,D),this.animation.cancel()}T==null||T(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,i;(i=(t=this.animation).finish)==null||i.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,i;this.isPseudoElement||(i=(t=this.animation).commitStyles)==null||i.call(t)}get duration(){var i,a;const t=((a=(i=this.animation.effect)==null?void 0:i.getComputedTiming)==null?void 0:a.call(i).duration)||0;return ro(Number(t))}get time(){return ro(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=no(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:i}){var a;return this.allowFlatten&&((a=this.animation.effect)==null||a.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&c5()?(this.animation.timeline=t,ps):i(this)}}const GP={anticipate:SP,backInOut:wP,circInOut:CP};function g5(e){return e in GP}function y5(e){typeof e.ease=="string"&&g5(e.ease)&&(e.ease=GP[e.ease])}const oS=10;class _5 extends m5{constructor(t){y5(t),VP(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:i,onUpdate:a,onComplete:h,element:p,...f}=this.options;if(!i)return;if(t!==void 0){i.set(t);return}const u=new l1({...f,autoplay:!1}),T=no(this.finishedTime??this.time);i.setWithVelocity(u.sample(T-oS).value,u.sample(T).value,oS),u.stop()}}const aS=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Ga.test(e)||e==="0")&&!e.startsWith("url("));function v5(e){const t=e[0];if(e.length===1)return!0;for(let i=0;i<e.length;i++)if(e[i]!==t)return!0}function x5(e,t,i,a){const h=e[0];if(h===null)return!1;if(t==="display"||t==="visibility")return!0;const p=e[e.length-1],f=aS(h,t),u=aS(p,t);return!f||!u?!1:v5(e)||(i==="spring"||qP(i))&&a}function C0(e){e.duration=0,e.type}const b5=new Set(["opacity","clipPath","filter","transform"]),w5=Kx(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function S5(e){var D;const{motionValue:t,name:i,repeatDelay:a,repeatType:h,damping:p,type:f}=e;if(!(((D=t==null?void 0:t.owner)==null?void 0:D.current)instanceof HTMLElement))return!1;const{onUpdate:T,transformTemplate:E}=t.owner.getProps();return w5()&&i&&b5.has(i)&&(i!=="transform"||!E)&&!T&&!a&&h!=="mirror"&&p!==0&&f!=="inertia"}const T5=40;class C5 extends a1{constructor({autoplay:t=!0,delay:i=0,type:a="keyframes",repeat:h=0,repeatDelay:p=0,repeatType:f="loop",keyframes:u,name:T,motionValue:E,element:D,...z}){var K;super(),this.stop=()=>{var Q,ce;this._animation&&(this._animation.stop(),(Q=this.stopTimeline)==null||Q.call(this)),(ce=this.keyframeResolver)==null||ce.cancel()},this.createdAt=vi.now();const I={autoplay:t,delay:i,type:a,repeat:h,repeatDelay:p,repeatType:f,name:T,motionValue:E,element:D,...z},G=(D==null?void 0:D.KeyframeResolver)||u1;this.keyframeResolver=new G(u,(Q,ce,j)=>this.onKeyframesResolved(Q,ce,I,!j),T,E,D),(K=this.keyframeResolver)==null||K.scheduleResolve()}onKeyframesResolved(t,i,a,h){this.keyframeResolver=void 0;const{name:p,type:f,velocity:u,delay:T,isHandoff:E,onUpdate:D}=a;this.resolvedAt=vi.now(),x5(t,p,f,u)||((No.instantAnimations||!T)&&(D==null||D(o1(t,a,i))),t[0]=t[t.length-1],C0(a),a.repeat=0);const I={startTime:h?this.resolvedAt?this.resolvedAt-this.createdAt>T5?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:i,...a,keyframes:t},G=!E&&S5(I)?new _5({...I,element:I.motionValue.owner.current}):new l1(I);G.finished.then(()=>this.notifyFinished()).catch(ps),this.pendingTimeline&&(this.stopTimeline=G.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=G}get finished(){return this._animation?this.animation.finished:this._finished}then(t,i){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),a5()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const k5=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function P5(e){const t=k5.exec(e);if(!t)return[,];const[,i,a,h]=t;return[`--${i??a}`,h]}function WP(e,t,i=1){const[a,h]=P5(e);if(!a)return;const p=window.getComputedStyle(t).getPropertyValue(a);if(p){const f=p.trim();return pP(f)?parseFloat(f):f}return t1(h)?WP(h,t,i+1):h}function c1(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const ZP=new Set(["width","height","top","left","right","bottom",...Gc]),E5={test:e=>e==="auto",parse:e=>e},HP=e=>t=>t.test(e),XP=[qc,Et,io,ka,vL,_L,E5],lS=e=>XP.find(HP(e));function I5(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||gP(e):!0}const M5=new Set(["brightness","contrast","saturate","opacity"]);function A5(e){const[t,i]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[a]=i.match(n1)||[];if(!a)return e;const h=i.replace(a,"");let p=M5.has(t)?1:0;return a!==i&&(p*=100),t+"("+p+h+")"}const z5=/\b([a-z-]*)\(.*?\)/gu,k0={...Ga,getAnimatableNone:e=>{const t=e.match(z5);return t?t.map(A5).join(" "):e}},uS={...qc,transform:Math.round},D5={rotate:ka,rotateX:ka,rotateY:ka,rotateZ:ka,scale:Yp,scaleX:Yp,scaleY:Yp,scaleZ:Yp,skew:ka,skewX:ka,skewY:ka,distance:Et,translateX:Et,translateY:Et,translateZ:Et,x:Et,y:Et,z:Et,perspective:Et,transformPerspective:Et,opacity:of,originX:K2,originY:K2,originZ:Et},h1={borderWidth:Et,borderTopWidth:Et,borderRightWidth:Et,borderBottomWidth:Et,borderLeftWidth:Et,borderRadius:Et,radius:Et,borderTopLeftRadius:Et,borderTopRightRadius:Et,borderBottomRightRadius:Et,borderBottomLeftRadius:Et,width:Et,maxWidth:Et,height:Et,maxHeight:Et,top:Et,right:Et,bottom:Et,left:Et,padding:Et,paddingTop:Et,paddingRight:Et,paddingBottom:Et,paddingLeft:Et,margin:Et,marginTop:Et,marginRight:Et,marginBottom:Et,marginLeft:Et,backgroundPositionX:Et,backgroundPositionY:Et,...D5,zIndex:uS,fillOpacity:of,strokeOpacity:of,numOctaves:uS},R5={...h1,color:Kn,backgroundColor:Kn,outlineColor:Kn,fill:Kn,stroke:Kn,borderColor:Kn,borderTopColor:Kn,borderRightColor:Kn,borderBottomColor:Kn,borderLeftColor:Kn,filter:k0,WebkitFilter:k0},KP=e=>R5[e];function YP(e,t){let i=KP(e);return i!==k0&&(i=Ga),i.getAnimatableNone?i.getAnimatableNone(t):void 0}const L5=new Set(["auto","none","0"]);function F5(e,t,i){let a=0,h;for(;a<e.length&&!h;){const p=e[a];typeof p=="string"&&!L5.has(p)&&af(p).values.length&&(h=e[a]),a++}if(h&&i)for(const p of t)e[p]=YP(i,h)}class B5 extends u1{constructor(t,i,a,h,p){super(t,i,a,h,p,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:i,name:a}=this;if(!i||!i.current)return;super.readKeyframes();for(let T=0;T<t.length;T++){let E=t[T];if(typeof E=="string"&&(E=E.trim(),t1(E))){const D=WP(E,i.current);D!==void 0&&(t[T]=D),T===t.length-1&&(this.finalKeyframe=E)}}if(this.resolveNoneKeyframes(),!ZP.has(a)||t.length!==2)return;const[h,p]=t,f=lS(h),u=lS(p);if(f!==u)if(iS(f)&&iS(u))for(let T=0;T<t.length;T++){const E=t[T];typeof E=="string"&&(t[T]=parseFloat(E))}else Ul[a]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:i}=this,a=[];for(let h=0;h<t.length;h++)(t[h]===null||I5(t[h]))&&a.push(h);a.length&&F5(t,a,i)}measureInitialState(){const{element:t,unresolvedKeyframes:i,name:a}=this;if(!t||!t.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ul[a](t.measureViewportBox(),window.getComputedStyle(t.current)),i[0]=this.measuredOrigin;const h=i[i.length-1];h!==void 0&&t.getValue(a,h).jump(h,!1)}measureEndState(){var u;const{element:t,name:i,unresolvedKeyframes:a}=this;if(!t||!t.current)return;const h=t.getValue(i);h&&h.jump(this.measuredOrigin,!1);const p=a.length-1,f=a[p];a[p]=Ul[i](t.measureViewportBox(),window.getComputedStyle(t.current)),f!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=f),(u=this.removedTransforms)!=null&&u.length&&this.removedTransforms.forEach(([T,E])=>{t.getValue(T).set(E)}),this.resolveNoneKeyframes()}}function O5(e,t,i){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let a=document;const h=(i==null?void 0:i[e])??a.querySelectorAll(e);return h?Array.from(h):[]}return Array.from(e)}const JP=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function QP(e){return mP(e)&&"offsetHeight"in e}const cS=30,V5=e=>!isNaN(parseFloat(e));class N5{constructor(t,i={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=a=>{var p;const h=vi.now();if(this.updatedAt!==h&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&((p=this.events.change)==null||p.notify(this.current),this.dependents))for(const f of this.dependents)f.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=i.owner}setCurrent(t){this.current=t,this.updatedAt=vi.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=V5(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,i){this.events[t]||(this.events[t]=new Yx);const a=this.events[t].add(i);return t==="change"?()=>{a(),kn.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,i){this.passiveEffect=t,this.stopPassiveEffect=i}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,i,a){this.set(i),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-a}jump(t,i=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,i&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=vi.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>cS)return 0;const i=Math.min(this.updatedAt-this.prevUpdatedAt,cS);return yP(parseFloat(this.current)-parseFloat(this.prevFrameValue),i)}start(t){return this.stop(),new Promise(i=>{this.hasAnimated=!0,this.animation=t(i),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,i;(t=this.dependents)==null||t.clear(),(i=this.events.destroy)==null||i.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Bc(e,t){return new N5(e,t)}const{schedule:d1}=EP(queueMicrotask,!1),Is={x:!1,y:!1};function eE(){return Is.x||Is.y}function j5(e){return e==="x"||e==="y"?Is[e]?null:(Is[e]=!0,()=>{Is[e]=!1}):Is.x||Is.y?null:(Is.x=Is.y=!0,()=>{Is.x=Is.y=!1})}function tE(e,t){const i=O5(e),a=new AbortController,h={passive:!0,...t,signal:a.signal};return[i,h,()=>a.abort()]}function hS(e){return!(e.pointerType==="touch"||eE())}function $5(e,t,i={}){const[a,h,p]=tE(e,i),f=u=>{if(!hS(u))return;const{target:T}=u,E=t(T,u);if(typeof E!="function"||!T)return;const D=z=>{hS(z)&&(E(z),T.removeEventListener("pointerleave",D))};T.addEventListener("pointerleave",D,h)};return a.forEach(u=>{u.addEventListener("pointerenter",f,h)}),p}const nE=(e,t)=>t?e===t?!0:nE(e,t.parentElement):!1,f1=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,U5=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function q5(e){return U5.has(e.tagName)||e.tabIndex!==-1}const gm=new WeakSet;function dS(e){return t=>{t.key==="Enter"&&e(t)}}function iv(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const G5=(e,t)=>{const i=e.currentTarget;if(!i)return;const a=dS(()=>{if(gm.has(i))return;iv(i,"down");const h=dS(()=>{iv(i,"up")}),p=()=>iv(i,"cancel");i.addEventListener("keyup",h,t),i.addEventListener("blur",p,t)});i.addEventListener("keydown",a,t),i.addEventListener("blur",()=>i.removeEventListener("keydown",a),t)};function fS(e){return f1(e)&&!eE()}function W5(e,t,i={}){const[a,h,p]=tE(e,i),f=u=>{const T=u.currentTarget;if(!fS(u))return;gm.add(T);const E=t(T,u),D=(G,K)=>{window.removeEventListener("pointerup",z),window.removeEventListener("pointercancel",I),gm.has(T)&&gm.delete(T),fS(G)&&typeof E=="function"&&E(G,{success:K})},z=G=>{D(G,T===window||T===document||i.useGlobalTarget||nE(T,G.target))},I=G=>{D(G,!1)};window.addEventListener("pointerup",z,h),window.addEventListener("pointercancel",I,h)};return a.forEach(u=>{(i.useGlobalTarget?window:u).addEventListener("pointerdown",f,h),QP(u)&&(u.addEventListener("focus",E=>G5(E,h)),!q5(u)&&!u.hasAttribute("tabindex")&&(u.tabIndex=0))}),p}function rE(e){return mP(e)&&"ownerSVGElement"in e}function Z5(e){return rE(e)&&e.tagName==="svg"}const Ur=e=>!!(e&&e.getVelocity),H5=[...XP,Kn,Ga],X5=e=>H5.find(HP(e)),p1=le.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class K5 extends le.Component{getSnapshotBeforeUpdate(t){const i=this.props.childRef.current;if(i&&t.isPresent&&!this.props.isPresent){const a=i.offsetParent,h=QP(a)&&a.offsetWidth||0,p=this.props.sizeRef.current;p.height=i.offsetHeight||0,p.width=i.offsetWidth||0,p.top=i.offsetTop,p.left=i.offsetLeft,p.right=h-p.width-p.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Y5({children:e,isPresent:t,anchorX:i,root:a}){const h=le.useId(),p=le.useRef(null),f=le.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=le.useContext(p1);return le.useInsertionEffect(()=>{const{width:T,height:E,top:D,left:z,right:I}=f.current;if(t||!p.current||!T||!E)return;const G=i==="left"?`left: ${z}`:`right: ${I}`;p.current.dataset.motionPopId=h;const K=document.createElement("style");u&&(K.nonce=u);const Q=a??document.head;return Q.appendChild(K),K.sheet&&K.sheet.insertRule(`
          [data-motion-pop-id="${h}"] {
            position: absolute !important;
            width: ${T}px !important;
            height: ${E}px !important;
            ${G}px !important;
            top: ${D}px !important;
          }
        `),()=>{Q.contains(K)&&Q.removeChild(K)}},[t]),Ae.jsx(K5,{isPresent:t,childRef:p,sizeRef:f,children:le.cloneElement(e,{ref:p})})}const J5=({children:e,initial:t,isPresent:i,onExitComplete:a,custom:h,presenceAffectsLayout:p,mode:f,anchorX:u,root:T})=>{const E=Gx(Q5),D=le.useId();let z=!0,I=le.useMemo(()=>(z=!1,{id:D,initial:t,isPresent:i,custom:h,onExitComplete:G=>{E.set(G,!0);for(const K of E.values())if(!K)return;a&&a()},register:G=>(E.set(G,!1),()=>E.delete(G))}),[i,E,a]);return p&&z&&(I={...I}),le.useMemo(()=>{E.forEach((G,K)=>E.set(K,!1))},[i]),le.useEffect(()=>{!i&&!E.size&&a&&a()},[i]),f==="popLayout"&&(e=Ae.jsx(Y5,{isPresent:i,anchorX:u,root:T,children:e})),Ae.jsx(kg.Provider,{value:I,children:e})};function Q5(){return new Map}function iE(e=!0){const t=le.useContext(kg);if(t===null)return[!0,null];const{isPresent:i,onExitComplete:a,register:h}=t,p=le.useId();le.useEffect(()=>{if(e)return h(p)},[e]);const f=le.useCallback(()=>e&&a&&a(p),[p,a,e]);return!i&&a?[!1,f]:[!0]}const Jp=e=>e.key||"";function pS(e){const t=[];return le.Children.forEach(e,i=>{le.isValidElement(i)&&t.push(i)}),t}const P0=({children:e,custom:t,initial:i=!0,onExitComplete:a,presenceAffectsLayout:h=!0,mode:p="sync",propagate:f=!1,anchorX:u="left",root:T})=>{const[E,D]=iE(f),z=le.useMemo(()=>pS(e),[e]),I=f&&!E?[]:z.map(Jp),G=le.useRef(!0),K=le.useRef(z),Q=Gx(()=>new Map),[ce,j]=le.useState(z),[U,X]=le.useState(z);fP(()=>{G.current=!1,K.current=z;for(let fe=0;fe<U.length;fe++){const we=Jp(U[fe]);I.includes(we)?Q.delete(we):Q.get(we)!==!0&&Q.set(we,!1)}},[U,I.length,I.join("-")]);const ne=[];if(z!==ce){let fe=[...z];for(let we=0;we<U.length;we++){const Ie=U[we],Ne=Jp(Ie);I.includes(Ne)||(fe.splice(we,0,Ie),ne.push(Ie))}return p==="wait"&&ne.length&&(fe=ne),X(pS(fe)),j(z),null}const{forceRender:ge}=le.useContext(qx);return Ae.jsx(Ae.Fragment,{children:U.map(fe=>{const we=Jp(fe),Ie=f&&!E?!1:z===U||I.includes(we),Ne=()=>{if(Q.has(we))Q.set(we,!0);else return;let $e=!0;Q.forEach(Ve=>{Ve||($e=!1)}),$e&&(ge==null||ge(),X(K.current),f&&(D==null||D()),a&&a())};return Ae.jsx(J5,{isPresent:Ie,initial:!G.current||i?void 0:!1,custom:t,presenceAffectsLayout:h,mode:p,root:T,onExitComplete:Ie?void 0:Ne,anchorX:u,children:fe},we)})})},sE=le.createContext({strict:!1}),mS={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Oc={};for(const e in mS)Oc[e]={isEnabled:t=>mS[e].some(i=>!!t[i])};function e3(e){for(const t in e)Oc[t]={...Oc[t],...e[t]}}const t3=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function tg(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||t3.has(e)}let oE=e=>!tg(e);function n3(e){typeof e=="function"&&(oE=t=>t.startsWith("on")?!tg(t):e(t))}try{n3(require("@emotion/is-prop-valid").default)}catch{}function r3(e,t,i){const a={};for(const h in e)h==="values"&&typeof e.values=="object"||(oE(h)||i===!0&&tg(h)||!t&&!tg(h)||e.draggable&&h.startsWith("onDrag"))&&(a[h]=e[h]);return a}const Pg=le.createContext({});function Eg(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function lf(e){return typeof e=="string"||Array.isArray(e)}const m1=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],g1=["initial",...m1];function Ig(e){return Eg(e.animate)||g1.some(t=>lf(e[t]))}function aE(e){return!!(Ig(e)||e.variants)}function i3(e,t){if(Ig(e)){const{initial:i,animate:a}=e;return{initial:i===!1||lf(i)?i:void 0,animate:lf(a)?a:void 0}}return e.inherit!==!1?t:{}}function s3(e){const{initial:t,animate:i}=i3(e,le.useContext(Pg));return le.useMemo(()=>({initial:t,animate:i}),[gS(t),gS(i)])}function gS(e){return Array.isArray(e)?e.join(" "):e}const uf={};function o3(e){for(const t in e)uf[t]=e[t],e1(t)&&(uf[t].isCSSVariable=!0)}function lE(e,{layout:t,layoutId:i}){return Wc.has(e)||e.startsWith("origin")||(t||i!==void 0)&&(!!uf[e]||e==="opacity")}const a3={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},l3=Gc.length;function u3(e,t,i){let a="",h=!0;for(let p=0;p<l3;p++){const f=Gc[p],u=e[f];if(u===void 0)continue;let T=!0;if(typeof u=="number"?T=u===(f.startsWith("scale")?1:0):T=parseFloat(u)===0,!T||i){const E=JP(u,h1[f]);if(!T){h=!1;const D=a3[f]||f;a+=`${D}(${E}) `}i&&(t[f]=E)}}return a=a.trim(),i?a=i(t,h?"":a):h&&(a="none"),a}function y1(e,t,i){const{style:a,vars:h,transformOrigin:p}=e;let f=!1,u=!1;for(const T in t){const E=t[T];if(Wc.has(T)){f=!0;continue}else if(e1(T)){h[T]=E;continue}else{const D=JP(E,h1[T]);T.startsWith("origin")?(u=!0,p[T]=D):a[T]=D}}if(t.transform||(f||i?a.transform=u3(t,e.transform,i):a.transform&&(a.transform="none")),u){const{originX:T="50%",originY:E="50%",originZ:D=0}=p;a.transformOrigin=`${T} ${E} ${D}`}}const _1=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function uE(e,t,i){for(const a in t)!Ur(t[a])&&!lE(a,i)&&(e[a]=t[a])}function c3({transformTemplate:e},t){return le.useMemo(()=>{const i=_1();return y1(i,t,e),Object.assign({},i.vars,i.style)},[t])}function h3(e,t){const i=e.style||{},a={};return uE(a,i,e),Object.assign(a,c3(e,t)),a}function d3(e,t){const i={},a=h3(e,t);return e.drag&&e.dragListener!==!1&&(i.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(i.tabIndex=0),i.style=a,i}const f3={offset:"stroke-dashoffset",array:"stroke-dasharray"},p3={offset:"strokeDashoffset",array:"strokeDasharray"};function m3(e,t,i=1,a=0,h=!0){e.pathLength=1;const p=h?f3:p3;e[p.offset]=Et.transform(-a);const f=Et.transform(t),u=Et.transform(i);e[p.array]=`${f} ${u}`}function cE(e,{attrX:t,attrY:i,attrScale:a,pathLength:h,pathSpacing:p=1,pathOffset:f=0,...u},T,E,D){if(y1(e,u,E),T){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:z,style:I}=e;z.transform&&(I.transform=z.transform,delete z.transform),(I.transform||z.transformOrigin)&&(I.transformOrigin=z.transformOrigin??"50% 50%",delete z.transformOrigin),I.transform&&(I.transformBox=(D==null?void 0:D.transformBox)??"fill-box",delete z.transformBox),t!==void 0&&(z.x=t),i!==void 0&&(z.y=i),a!==void 0&&(z.scale=a),h!==void 0&&m3(z,h,p,f,!1)}const hE=()=>({..._1(),attrs:{}}),dE=e=>typeof e=="string"&&e.toLowerCase()==="svg";function g3(e,t,i,a){const h=le.useMemo(()=>{const p=hE();return cE(p,t,dE(a),e.transformTemplate,e.style),{...p.attrs,style:{...p.style}}},[t]);if(e.style){const p={};uE(p,e.style,e),h.style={...p,...h.style}}return h}const y3=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function v1(e){return typeof e!="string"||e.includes("-")?!1:!!(y3.indexOf(e)>-1||/[A-Z]/u.test(e))}function _3(e,t,i,{latestValues:a},h,p=!1){const u=(v1(e)?g3:d3)(t,a,h,e),T=r3(t,typeof e=="string",p),E=e!==le.Fragment?{...T,...u,ref:i}:{},{children:D}=t,z=le.useMemo(()=>Ur(D)?D.get():D,[D]);return le.createElement(e,{...E,children:z})}function yS(e){const t=[{},{}];return e==null||e.values.forEach((i,a)=>{t[0][a]=i.get(),t[1][a]=i.getVelocity()}),t}function x1(e,t,i,a){if(typeof t=="function"){const[h,p]=yS(a);t=t(i!==void 0?i:e.custom,h,p)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[h,p]=yS(a);t=t(i!==void 0?i:e.custom,h,p)}return t}function ym(e){return Ur(e)?e.get():e}function v3({scrapeMotionValuesFromProps:e,createRenderState:t},i,a,h){return{latestValues:x3(i,a,h,e),renderState:t()}}function x3(e,t,i,a){const h={},p=a(e,{});for(const I in p)h[I]=ym(p[I]);let{initial:f,animate:u}=e;const T=Ig(e),E=aE(e);t&&E&&!T&&e.inherit!==!1&&(f===void 0&&(f=t.initial),u===void 0&&(u=t.animate));let D=i?i.initial===!1:!1;D=D||f===!1;const z=D?u:f;if(z&&typeof z!="boolean"&&!Eg(z)){const I=Array.isArray(z)?z:[z];for(let G=0;G<I.length;G++){const K=x1(e,I[G]);if(K){const{transitionEnd:Q,transition:ce,...j}=K;for(const U in j){let X=j[U];if(Array.isArray(X)){const ne=D?X.length-1:0;X=X[ne]}X!==null&&(h[U]=X)}for(const U in Q)h[U]=Q[U]}}}return h}const fE=e=>(t,i)=>{const a=le.useContext(Pg),h=le.useContext(kg),p=()=>v3(e,t,a,h);return i?p():Gx(p)};function b1(e,t,i){var p;const{style:a}=e,h={};for(const f in a)(Ur(a[f])||t.style&&Ur(t.style[f])||lE(f,e)||((p=i==null?void 0:i.getValue(f))==null?void 0:p.liveStyle)!==void 0)&&(h[f]=a[f]);return h}const b3=fE({scrapeMotionValuesFromProps:b1,createRenderState:_1});function pE(e,t,i){const a=b1(e,t,i);for(const h in e)if(Ur(e[h])||Ur(t[h])){const p=Gc.indexOf(h)!==-1?"attr"+h.charAt(0).toUpperCase()+h.substring(1):h;a[p]=e[h]}return a}const w3=fE({scrapeMotionValuesFromProps:pE,createRenderState:hE}),S3=Symbol.for("motionComponentSymbol");function gc(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function T3(e,t,i){return le.useCallback(a=>{a&&e.onMount&&e.onMount(a),t&&(a?t.mount(a):t.unmount()),i&&(typeof i=="function"?i(a):gc(i)&&(i.current=a))},[t])}const w1=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),C3="framerAppearId",mE="data-"+w1(C3),gE=le.createContext({});function k3(e,t,i,a,h){var Q,ce;const{visualElement:p}=le.useContext(Pg),f=le.useContext(sE),u=le.useContext(kg),T=le.useContext(p1).reducedMotion,E=le.useRef(null);a=a||f.renderer,!E.current&&a&&(E.current=a(e,{visualState:t,parent:p,props:i,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:T}));const D=E.current,z=le.useContext(gE);D&&!D.projection&&h&&(D.type==="html"||D.type==="svg")&&P3(E.current,i,h,z);const I=le.useRef(!1);le.useInsertionEffect(()=>{D&&I.current&&D.update(i,u)});const G=i[mE],K=le.useRef(!!G&&!((Q=window.MotionHandoffIsComplete)!=null&&Q.call(window,G))&&((ce=window.MotionHasOptimisedAnimation)==null?void 0:ce.call(window,G)));return fP(()=>{D&&(I.current=!0,window.MotionIsMounted=!0,D.updateFeatures(),D.scheduleRenderMicrotask(),K.current&&D.animationState&&D.animationState.animateChanges())}),le.useEffect(()=>{D&&(!K.current&&D.animationState&&D.animationState.animateChanges(),K.current&&(queueMicrotask(()=>{var j;(j=window.MotionHandoffMarkAsComplete)==null||j.call(window,G)}),K.current=!1),D.enteringChildren=void 0)}),D}function P3(e,t,i,a){const{layoutId:h,layout:p,drag:f,dragConstraints:u,layoutScroll:T,layoutRoot:E,layoutCrossfade:D}=t;e.projection=new i(e.latestValues,t["data-framer-portal-id"]?void 0:yE(e.parent)),e.projection.setOptions({layoutId:h,layout:p,alwaysMeasureLayout:!!f||u&&gc(u),visualElement:e,animationType:typeof p=="string"?p:"both",initialPromotionConfig:a,crossfade:D,layoutScroll:T,layoutRoot:E})}function yE(e){if(e)return e.options.allowProjection!==!1?e.projection:yE(e.parent)}function sv(e,{forwardMotionProps:t=!1}={},i,a){i&&e3(i);const h=v1(e)?w3:b3;function p(u,T){let E;const D={...le.useContext(p1),...u,layoutId:E3(u)},{isStatic:z}=D,I=s3(u),G=h(u,z);if(!z&&Wx){I3();const K=M3(D);E=K.MeasureLayout,I.visualElement=k3(e,G,D,a,K.ProjectionNode)}return Ae.jsxs(Pg.Provider,{value:I,children:[E&&I.visualElement?Ae.jsx(E,{visualElement:I.visualElement,...D}):null,_3(e,u,T3(G,I.visualElement,T),G,z,t)]})}p.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const f=le.forwardRef(p);return f[S3]=e,f}function E3({layoutId:e}){const t=le.useContext(qx).id;return t&&e!==void 0?t+"-"+e:e}function I3(e,t){le.useContext(sE).strict}function M3(e){const{drag:t,layout:i}=Oc;if(!t&&!i)return{};const a={...t,...i};return{MeasureLayout:t!=null&&t.isEnabled(e)||i!=null&&i.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}function A3(e,t){if(typeof Proxy>"u")return sv;const i=new Map,a=(p,f)=>sv(p,f,e,t),h=(p,f)=>a(p,f);return new Proxy(h,{get:(p,f)=>f==="create"?a:(i.has(f)||i.set(f,sv(f,void 0,e,t)),i.get(f))})}function _E({top:e,left:t,right:i,bottom:a}){return{x:{min:t,max:i},y:{min:e,max:a}}}function z3({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function D3(e,t){if(!t)return e;const i=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:i.y,left:i.x,bottom:a.y,right:a.x}}function ov(e){return e===void 0||e===1}function E0({scale:e,scaleX:t,scaleY:i}){return!ov(e)||!ov(t)||!ov(i)}function zl(e){return E0(e)||vE(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function vE(e){return _S(e.x)||_S(e.y)}function _S(e){return e&&e!=="0%"}function ng(e,t,i){const a=e-i,h=t*a;return i+h}function vS(e,t,i,a,h){return h!==void 0&&(e=ng(e,h,a)),ng(e,i,a)+t}function I0(e,t=0,i=1,a,h){e.min=vS(e.min,t,i,a,h),e.max=vS(e.max,t,i,a,h)}function xE(e,{x:t,y:i}){I0(e.x,t.translate,t.scale,t.originPoint),I0(e.y,i.translate,i.scale,i.originPoint)}const xS=.999999999999,bS=1.0000000000001;function R3(e,t,i,a=!1){const h=i.length;if(!h)return;t.x=t.y=1;let p,f;for(let u=0;u<h;u++){p=i[u],f=p.projectionDelta;const{visualElement:T}=p.options;T&&T.props.style&&T.props.style.display==="contents"||(a&&p.options.layoutScroll&&p.scroll&&p!==p.root&&_c(e,{x:-p.scroll.offset.x,y:-p.scroll.offset.y}),f&&(t.x*=f.x.scale,t.y*=f.y.scale,xE(e,f)),a&&zl(p.latestValues)&&_c(e,p.latestValues))}t.x<bS&&t.x>xS&&(t.x=1),t.y<bS&&t.y>xS&&(t.y=1)}function yc(e,t){e.min=e.min+t,e.max=e.max+t}function wS(e,t,i,a,h=.5){const p=Mn(e.min,e.max,h);I0(e,t,i,p,a)}function _c(e,t){wS(e.x,t.x,t.scaleX,t.scale,t.originX),wS(e.y,t.y,t.scaleY,t.scale,t.originY)}function bE(e,t){return _E(D3(e.getBoundingClientRect(),t))}function L3(e,t,i){const a=bE(e,i),{scroll:h}=t;return h&&(yc(a.x,h.offset.x),yc(a.y,h.offset.y)),a}const SS=()=>({translate:0,scale:1,origin:0,originPoint:0}),vc=()=>({x:SS(),y:SS()}),TS=()=>({min:0,max:0}),$n=()=>({x:TS(),y:TS()}),M0={current:null},wE={current:!1};function F3(){if(wE.current=!0,!!Wx)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>M0.current=e.matches;e.addEventListener("change",t),t()}else M0.current=!1}const B3=new WeakMap;function O3(e,t,i){for(const a in t){const h=t[a],p=i[a];if(Ur(h))e.addValue(a,h);else if(Ur(p))e.addValue(a,Bc(h,{owner:e}));else if(p!==h)if(e.hasValue(a)){const f=e.getValue(a);f.liveStyle===!0?f.jump(h):f.hasAnimated||f.set(h)}else{const f=e.getStaticValue(a);e.addValue(a,Bc(f!==void 0?f:h,{owner:e}))}}for(const a in i)t[a]===void 0&&e.removeValue(a);return t}const CS=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class V3{scrapeMotionValuesFromProps(t,i,a){return{}}constructor({parent:t,props:i,presenceContext:a,reducedMotionConfig:h,blockInitialAnimation:p,visualState:f},u={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=u1,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const I=vi.now();this.renderScheduledAt<I&&(this.renderScheduledAt=I,kn.render(this.render,!1,!0))};const{latestValues:T,renderState:E}=f;this.latestValues=T,this.baseTarget={...T},this.initialValues=i.initial?{...T}:{},this.renderState=E,this.parent=t,this.props=i,this.presenceContext=a,this.depth=t?t.depth+1:0,this.reducedMotionConfig=h,this.options=u,this.blockInitialAnimation=!!p,this.isControllingVariants=Ig(i),this.isVariantNode=aE(i),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:D,...z}=this.scrapeMotionValuesFromProps(i,{},this);for(const I in z){const G=z[I];T[I]!==void 0&&Ur(G)&&G.set(T[I])}}mount(t){var i;this.current=t,B3.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,h)=>this.bindToMotionValue(h,a)),wE.current||F3(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:M0.current,(i=this.parent)==null||i.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),qa(this.notifyUpdate),qa(this.render),this.valueSubscriptions.forEach(i=>i()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const i in this.events)this.events[i].clear();for(const i in this.features){const a=this.features[i];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,i){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const a=Wc.has(t);a&&this.onBindTransform&&this.onBindTransform();const h=i.on("change",f=>{this.latestValues[t]=f,this.props.onUpdate&&kn.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let p;window.MotionCheckAppearSync&&(p=window.MotionCheckAppearSync(this,t,i)),this.valueSubscriptions.set(t,()=>{h(),p&&p(),i.owner&&i.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Oc){const i=Oc[t];if(!i)continue;const{isEnabled:a,Feature:h}=i;if(!this.features[t]&&h&&a(this.props)&&(this.features[t]=new h(this)),this.features[t]){const p=this.features[t];p.isMounted?p.update():(p.mount(),p.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):$n()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,i){this.latestValues[t]=i}update(t,i){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=i;for(let a=0;a<CS.length;a++){const h=CS[a];this.propEventSubscriptions[h]&&(this.propEventSubscriptions[h](),delete this.propEventSubscriptions[h]);const p="on"+h,f=t[p];f&&(this.propEventSubscriptions[h]=this.on(h,f))}this.prevMotionValues=O3(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const i=this.getClosestVariantNode();if(i)return i.variantChildren&&i.variantChildren.add(t),()=>i.variantChildren.delete(t)}addValue(t,i){const a=this.values.get(t);i!==a&&(a&&this.removeValue(t),this.bindToMotionValue(t,i),this.values.set(t,i),this.latestValues[t]=i.get())}removeValue(t){this.values.delete(t);const i=this.valueSubscriptions.get(t);i&&(i(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,i){if(this.props.values&&this.props.values[t])return this.props.values[t];let a=this.values.get(t);return a===void 0&&i!==void 0&&(a=Bc(i===null?void 0:i,{owner:this}),this.addValue(t,a)),a}readValue(t,i){let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(pP(a)||gP(a))?a=parseFloat(a):!X5(a)&&Ga.test(i)&&(a=YP(t,i)),this.setBaseTarget(t,Ur(a)?a.get():a)),Ur(a)?a.get():a}setBaseTarget(t,i){this.baseTarget[t]=i}getBaseTarget(t){var p;const{initial:i}=this.props;let a;if(typeof i=="string"||typeof i=="object"){const f=x1(this.props,i,(p=this.presenceContext)==null?void 0:p.custom);f&&(a=f[t])}if(i&&a!==void 0)return a;const h=this.getBaseTargetFromProps(this.props,t);return h!==void 0&&!Ur(h)?h:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,i){return this.events[t]||(this.events[t]=new Yx),this.events[t].add(i)}notify(t,...i){this.events[t]&&this.events[t].notify(...i)}scheduleRenderMicrotask(){d1.render(this.render)}}class SE extends V3{constructor(){super(...arguments),this.KeyframeResolver=B5}sortInstanceNodePosition(t,i){return t.compareDocumentPosition(i)&2?1:-1}getBaseTargetFromProps(t,i){return t.style?t.style[i]:void 0}removeValueFromRenderState(t,{vars:i,style:a}){delete i[t],delete a[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Ur(t)&&(this.childSubscription=t.on("change",i=>{this.current&&(this.current.textContent=`${i}`)}))}}function TE(e,{style:t,vars:i},a,h){const p=e.style;let f;for(f in t)p[f]=t[f];h==null||h.applyProjectionStyles(p,a);for(f in i)p.setProperty(f,i[f])}function N3(e){return window.getComputedStyle(e)}class j3 extends SE{constructor(){super(...arguments),this.type="html",this.renderInstance=TE}readValueFromInstance(t,i){var a;if(Wc.has(i))return(a=this.projection)!=null&&a.isProjecting?x0(i):n5(t,i);{const h=N3(t),p=(e1(i)?h.getPropertyValue(i):h[i])||0;return typeof p=="string"?p.trim():p}}measureInstanceViewportBox(t,{transformPagePoint:i}){return bE(t,i)}build(t,i,a){y1(t,i,a.transformTemplate)}scrapeMotionValuesFromProps(t,i,a){return b1(t,i,a)}}const CE=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function $3(e,t,i,a){TE(e,t,void 0,a);for(const h in t.attrs)e.setAttribute(CE.has(h)?h:w1(h),t.attrs[h])}class U3 extends SE{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=$n}getBaseTargetFromProps(t,i){return t[i]}readValueFromInstance(t,i){if(Wc.has(i)){const a=KP(i);return a&&a.default||0}return i=CE.has(i)?i:w1(i),t.getAttribute(i)}scrapeMotionValuesFromProps(t,i,a){return pE(t,i,a)}build(t,i,a){cE(t,i,this.isSVGTag,a.transformTemplate,a.style)}renderInstance(t,i,a,h){$3(t,i,a,h)}mount(t){this.isSVGTag=dE(t.tagName),super.mount(t)}}const q3=(e,t)=>v1(e)?new U3(t):new j3(t,{allowProjection:e!==le.Fragment});function kc(e,t,i){const a=e.getProps();return x1(a,t,i!==void 0?i:a.custom,e)}const A0=e=>Array.isArray(e);function G3(e,t,i){e.hasValue(t)?e.getValue(t).set(i):e.addValue(t,Bc(i))}function W3(e){return A0(e)?e[e.length-1]||0:e}function Z3(e,t){const i=kc(e,t);let{transitionEnd:a={},transition:h={},...p}=i||{};p={...p,...a};for(const f in p){const u=W3(p[f]);G3(e,f,u)}}function H3(e){return!!(Ur(e)&&e.add)}function z0(e,t){const i=e.getValue("willChange");if(H3(i))return i.add(t);if(!i&&No.WillChange){const a=new No.WillChange("auto");e.addValue("willChange",a),a.add(t)}}function kE(e){return e.props[mE]}const X3=e=>e!==null;function K3(e,{repeat:t,repeatType:i="loop"},a){const h=e.filter(X3),p=t&&i!=="loop"&&t%2===1?0:h.length-1;return h[p]}const Y3={type:"spring",stiffness:500,damping:25,restSpeed:10},J3=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Q3={type:"keyframes",duration:.8},e4={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},t4=(e,{keyframes:t})=>t.length>2?Q3:Wc.has(e)?e.startsWith("scale")?J3(t[1]):Y3:e4;function n4({when:e,delay:t,delayChildren:i,staggerChildren:a,staggerDirection:h,repeat:p,repeatType:f,repeatDelay:u,from:T,elapsed:E,...D}){return!!Object.keys(D).length}const S1=(e,t,i,a={},h,p)=>f=>{const u=c1(a,e)||{},T=u.delay||a.delay||0;let{elapsed:E=0}=a;E=E-no(T);const D={keyframes:Array.isArray(i)?i:[null,i],ease:"easeOut",velocity:t.getVelocity(),...u,delay:-E,onUpdate:I=>{t.set(I),u.onUpdate&&u.onUpdate(I)},onComplete:()=>{f(),u.onComplete&&u.onComplete()},name:e,motionValue:t,element:p?void 0:h};n4(u)||Object.assign(D,t4(e,D)),D.duration&&(D.duration=no(D.duration)),D.repeatDelay&&(D.repeatDelay=no(D.repeatDelay)),D.from!==void 0&&(D.keyframes[0]=D.from);let z=!1;if((D.type===!1||D.duration===0&&!D.repeatDelay)&&(C0(D),D.delay===0&&(z=!0)),(No.instantAnimations||No.skipAnimations)&&(z=!0,C0(D),D.delay=0),D.allowFlatten=!u.type&&!u.ease,z&&!p&&t.get()!==void 0){const I=K3(D.keyframes,u);if(I!==void 0){kn.update(()=>{D.onUpdate(I),D.onComplete()});return}}return u.isSync?new l1(D):new C5(D)};function r4({protectedKeys:e,needsAnimating:t},i){const a=e.hasOwnProperty(i)&&t[i]!==!0;return t[i]=!1,a}function PE(e,t,{delay:i=0,transitionOverride:a,type:h}={}){let{transition:p=e.getDefaultTransition(),transitionEnd:f,...u}=t;a&&(p=a);const T=[],E=h&&e.animationState&&e.animationState.getState()[h];for(const D in u){const z=e.getValue(D,e.latestValues[D]??null),I=u[D];if(I===void 0||E&&r4(E,D))continue;const G={delay:i,...c1(p||{},D)},K=z.get();if(K!==void 0&&!z.isAnimating&&!Array.isArray(I)&&I===K&&!G.velocity)continue;let Q=!1;if(window.MotionHandoffAnimation){const j=kE(e);if(j){const U=window.MotionHandoffAnimation(j,D,kn);U!==null&&(G.startTime=U,Q=!0)}}z0(e,D),z.start(S1(D,z,I,e.shouldReduceMotion&&ZP.has(D)?{type:!1}:G,e,Q));const ce=z.animation;ce&&T.push(ce)}return f&&Promise.all(T).then(()=>{kn.update(()=>{f&&Z3(e,f)})}),T}function EE(e,t,i,a=0,h=1){const p=Array.from(e).sort((E,D)=>E.sortNodePosition(D)).indexOf(t),f=e.size,u=(f-1)*a;return typeof i=="function"?i(p,f):h===1?p*a:u-p*a}function D0(e,t,i={}){var T;const a=kc(e,t,i.type==="exit"?(T=e.presenceContext)==null?void 0:T.custom:void 0);let{transition:h=e.getDefaultTransition()||{}}=a||{};i.transitionOverride&&(h=i.transitionOverride);const p=a?()=>Promise.all(PE(e,a,i)):()=>Promise.resolve(),f=e.variantChildren&&e.variantChildren.size?(E=0)=>{const{delayChildren:D=0,staggerChildren:z,staggerDirection:I}=h;return i4(e,t,E,D,z,I,i)}:()=>Promise.resolve(),{when:u}=h;if(u){const[E,D]=u==="beforeChildren"?[p,f]:[f,p];return E().then(()=>D())}else return Promise.all([p(),f(i.delay)])}function i4(e,t,i=0,a=0,h=0,p=1,f){const u=[];for(const T of e.variantChildren)T.notify("AnimationStart",t),u.push(D0(T,t,{...f,delay:i+(typeof a=="function"?0:a)+EE(e.variantChildren,T,a,h,p)}).then(()=>T.notify("AnimationComplete",t)));return Promise.all(u)}function s4(e,t,i={}){e.notify("AnimationStart",t);let a;if(Array.isArray(t)){const h=t.map(p=>D0(e,p,i));a=Promise.all(h)}else if(typeof t=="string")a=D0(e,t,i);else{const h=typeof t=="function"?kc(e,t,i.custom):t;a=Promise.all(PE(e,h,i))}return a.then(()=>{e.notify("AnimationComplete",t)})}function IE(e,t){if(!Array.isArray(t))return!1;const i=t.length;if(i!==e.length)return!1;for(let a=0;a<i;a++)if(t[a]!==e[a])return!1;return!0}const o4=g1.length;function ME(e){if(!e)return;if(!e.isControllingVariants){const i=e.parent?ME(e.parent)||{}:{};return e.props.initial!==void 0&&(i.initial=e.props.initial),i}const t={};for(let i=0;i<o4;i++){const a=g1[i],h=e.props[a];(lf(h)||h===!1)&&(t[a]=h)}return t}const a4=[...m1].reverse(),l4=m1.length;function u4(e){return t=>Promise.all(t.map(({animation:i,options:a})=>s4(e,i,a)))}function c4(e){let t=u4(e),i=kS(),a=!0;const h=T=>(E,D)=>{var I;const z=kc(e,D,T==="exit"?(I=e.presenceContext)==null?void 0:I.custom:void 0);if(z){const{transition:G,transitionEnd:K,...Q}=z;E={...E,...Q,...K}}return E};function p(T){t=T(e)}function f(T){const{props:E}=e,D=ME(e.parent)||{},z=[],I=new Set;let G={},K=1/0;for(let ce=0;ce<l4;ce++){const j=a4[ce],U=i[j],X=E[j]!==void 0?E[j]:D[j],ne=lf(X),ge=j===T?U.isActive:null;ge===!1&&(K=ce);let fe=X===D[j]&&X!==E[j]&&ne;if(fe&&a&&e.manuallyAnimateOnMount&&(fe=!1),U.protectedKeys={...G},!U.isActive&&ge===null||!X&&!U.prevProp||Eg(X)||typeof X=="boolean")continue;const we=h4(U.prevProp,X);let Ie=we||j===T&&U.isActive&&!fe&&ne||ce>K&&ne,Ne=!1;const $e=Array.isArray(X)?X:[X];let Ve=$e.reduce(h(j),{});ge===!1&&(Ve={});const{prevResolvedValues:J={}}=U,ze={...J,...Ve},Le=_t=>{Ie=!0,I.has(_t)&&(Ne=!0,I.delete(_t)),U.needsAnimating[_t]=!0;const Oe=e.getValue(_t);Oe&&(Oe.liveStyle=!1)};for(const _t in ze){const Oe=Ve[_t],et=J[_t];if(G.hasOwnProperty(_t))continue;let pt=!1;A0(Oe)&&A0(et)?pt=!IE(Oe,et):pt=Oe!==et,pt?Oe!=null?Le(_t):I.add(_t):Oe!==void 0&&I.has(_t)?Le(_t):U.protectedKeys[_t]=!0}U.prevProp=X,U.prevResolvedValues=Ve,U.isActive&&(G={...G,...Ve}),a&&e.blockInitialAnimation&&(Ie=!1);const ot=fe&&we;Ie&&(!ot||Ne)&&z.push(...$e.map(_t=>{const Oe={type:j};if(typeof _t=="string"&&a&&!ot&&e.manuallyAnimateOnMount&&e.parent){const{parent:et}=e,pt=kc(et,_t);if(et.enteringChildren&&pt){const{delayChildren:Pt}=pt.transition||{};Oe.delay=EE(et.enteringChildren,e,Pt)}}return{animation:_t,options:Oe}}))}if(I.size){const ce={};if(typeof E.initial!="boolean"){const j=kc(e,Array.isArray(E.initial)?E.initial[0]:E.initial);j&&j.transition&&(ce.transition=j.transition)}I.forEach(j=>{const U=e.getBaseTarget(j),X=e.getValue(j);X&&(X.liveStyle=!0),ce[j]=U??null}),z.push({animation:ce})}let Q=!!z.length;return a&&(E.initial===!1||E.initial===E.animate)&&!e.manuallyAnimateOnMount&&(Q=!1),a=!1,Q?t(z):Promise.resolve()}function u(T,E){var z;if(i[T].isActive===E)return Promise.resolve();(z=e.variantChildren)==null||z.forEach(I=>{var G;return(G=I.animationState)==null?void 0:G.setActive(T,E)}),i[T].isActive=E;const D=f(T);for(const I in i)i[I].protectedKeys={};return D}return{animateChanges:f,setActive:u,setAnimateFunction:p,getState:()=>i,reset:()=>{i=kS(),a=!0}}}function h4(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!IE(t,e):!1}function kl(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function kS(){return{animate:kl(!0),whileInView:kl(),whileHover:kl(),whileTap:kl(),whileDrag:kl(),whileFocus:kl(),exit:kl()}}class Ka{constructor(t){this.isMounted=!1,this.node=t}update(){}}class d4 extends Ka{constructor(t){super(t),t.animationState||(t.animationState=c4(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Eg(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:i}=this.node.prevProps||{};t!==i&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let f4=0;class p4 extends Ka{constructor(){super(...arguments),this.id=f4++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:i}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const h=this.node.animationState.setActive("exit",!t);i&&!t&&h.then(()=>{i(this.id)})}mount(){const{register:t,onExitComplete:i}=this.node.presenceContext||{};i&&i(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const m4={animation:{Feature:d4},exit:{Feature:p4}};function cf(e,t,i,a={passive:!0}){return e.addEventListener(t,i,a),()=>e.removeEventListener(t,i)}function Cf(e){return{point:{x:e.pageX,y:e.pageY}}}const g4=e=>t=>f1(t)&&e(t,Cf(t));function Fd(e,t,i,a){return cf(e,t,g4(i),a)}const AE=1e-4,y4=1-AE,_4=1+AE,zE=.01,v4=0-zE,x4=0+zE;function ni(e){return e.max-e.min}function b4(e,t,i){return Math.abs(e-t)<=i}function PS(e,t,i,a=.5){e.origin=a,e.originPoint=Mn(t.min,t.max,e.origin),e.scale=ni(i)/ni(t),e.translate=Mn(i.min,i.max,e.origin)-e.originPoint,(e.scale>=y4&&e.scale<=_4||isNaN(e.scale))&&(e.scale=1),(e.translate>=v4&&e.translate<=x4||isNaN(e.translate))&&(e.translate=0)}function Bd(e,t,i,a){PS(e.x,t.x,i.x,a?a.originX:void 0),PS(e.y,t.y,i.y,a?a.originY:void 0)}function ES(e,t,i){e.min=i.min+t.min,e.max=e.min+ni(t)}function w4(e,t,i){ES(e.x,t.x,i.x),ES(e.y,t.y,i.y)}function IS(e,t,i){e.min=t.min-i.min,e.max=e.min+ni(t)}function Od(e,t,i){IS(e.x,t.x,i.x),IS(e.y,t.y,i.y)}function as(e){return[e("x"),e("y")]}const DE=({current:e})=>e?e.ownerDocument.defaultView:null,MS=(e,t)=>Math.abs(e-t);function S4(e,t){const i=MS(e.x,t.x),a=MS(e.y,t.y);return Math.sqrt(i**2+a**2)}class RE{constructor(t,i,{transformPagePoint:a,contextWindow:h=window,dragSnapToOrigin:p=!1,distanceThreshold:f=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const I=lv(this.lastMoveEventInfo,this.history),G=this.startEvent!==null,K=S4(I.offset,{x:0,y:0})>=this.distanceThreshold;if(!G&&!K)return;const{point:Q}=I,{timestamp:ce}=Cr;this.history.push({...Q,timestamp:ce});const{onStart:j,onMove:U}=this.handlers;G||(j&&j(this.lastMoveEvent,I),this.startEvent=this.lastMoveEvent),U&&U(this.lastMoveEvent,I)},this.handlePointerMove=(I,G)=>{this.lastMoveEvent=I,this.lastMoveEventInfo=av(G,this.transformPagePoint),kn.update(this.updatePoint,!0)},this.handlePointerUp=(I,G)=>{this.end();const{onEnd:K,onSessionEnd:Q,resumeAnimation:ce}=this.handlers;if(this.dragSnapToOrigin&&ce&&ce(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const j=lv(I.type==="pointercancel"?this.lastMoveEventInfo:av(G,this.transformPagePoint),this.history);this.startEvent&&K&&K(I,j),Q&&Q(I,j)},!f1(t))return;this.dragSnapToOrigin=p,this.handlers=i,this.transformPagePoint=a,this.distanceThreshold=f,this.contextWindow=h||window;const u=Cf(t),T=av(u,this.transformPagePoint),{point:E}=T,{timestamp:D}=Cr;this.history=[{...E,timestamp:D}];const{onSessionStart:z}=i;z&&z(t,lv(T,this.history)),this.removeListeners=wf(Fd(this.contextWindow,"pointermove",this.handlePointerMove),Fd(this.contextWindow,"pointerup",this.handlePointerUp),Fd(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),qa(this.updatePoint)}}function av(e,t){return t?{point:t(e.point)}:e}function AS(e,t){return{x:e.x-t.x,y:e.y-t.y}}function lv({point:e},t){return{point:e,delta:AS(e,LE(t)),offset:AS(e,T4(t)),velocity:C4(t,.1)}}function T4(e){return e[0]}function LE(e){return e[e.length-1]}function C4(e,t){if(e.length<2)return{x:0,y:0};let i=e.length-1,a=null;const h=LE(e);for(;i>=0&&(a=e[i],!(h.timestamp-a.timestamp>no(t)));)i--;if(!a)return{x:0,y:0};const p=ro(h.timestamp-a.timestamp);if(p===0)return{x:0,y:0};const f={x:(h.x-a.x)/p,y:(h.y-a.y)/p};return f.x===1/0&&(f.x=0),f.y===1/0&&(f.y=0),f}function k4(e,{min:t,max:i},a){return t!==void 0&&e<t?e=a?Mn(t,e,a.min):Math.max(e,t):i!==void 0&&e>i&&(e=a?Mn(i,e,a.max):Math.min(e,i)),e}function zS(e,t,i){return{min:t!==void 0?e.min+t:void 0,max:i!==void 0?e.max+i-(e.max-e.min):void 0}}function P4(e,{top:t,left:i,bottom:a,right:h}){return{x:zS(e.x,i,h),y:zS(e.y,t,a)}}function DS(e,t){let i=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([i,a]=[a,i]),{min:i,max:a}}function E4(e,t){return{x:DS(e.x,t.x),y:DS(e.y,t.y)}}function I4(e,t){let i=.5;const a=ni(e),h=ni(t);return h>a?i=sf(t.min,t.max-a,e.min):a>h&&(i=sf(e.min,e.max-h,t.min)),Vo(0,1,i)}function M4(e,t){const i={};return t.min!==void 0&&(i.min=t.min-e.min),t.max!==void 0&&(i.max=t.max-e.min),i}const R0=.35;function A4(e=R0){return e===!1?e=0:e===!0&&(e=R0),{x:RS(e,"left","right"),y:RS(e,"top","bottom")}}function RS(e,t,i){return{min:LS(e,t),max:LS(e,i)}}function LS(e,t){return typeof e=="number"?e:e[t]||0}const z4=new WeakMap;class D4{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=$n(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:i=!1,distanceThreshold:a}={}){const{presenceContext:h}=this.visualElement;if(h&&h.isPresent===!1)return;const p=z=>{const{dragSnapToOrigin:I}=this.getProps();I?this.pauseAnimation():this.stopAnimation(),i&&this.snapToCursor(Cf(z).point)},f=(z,I)=>{const{drag:G,dragPropagation:K,onDragStart:Q}=this.getProps();if(G&&!K&&(this.openDragLock&&this.openDragLock(),this.openDragLock=j5(G),!this.openDragLock))return;this.latestPointerEvent=z,this.latestPanInfo=I,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),as(j=>{let U=this.getAxisMotionValue(j).get()||0;if(io.test(U)){const{projection:X}=this.visualElement;if(X&&X.layout){const ne=X.layout.layoutBox[j];ne&&(U=ni(ne)*(parseFloat(U)/100))}}this.originPoint[j]=U}),Q&&kn.postRender(()=>Q(z,I)),z0(this.visualElement,"transform");const{animationState:ce}=this.visualElement;ce&&ce.setActive("whileDrag",!0)},u=(z,I)=>{this.latestPointerEvent=z,this.latestPanInfo=I;const{dragPropagation:G,dragDirectionLock:K,onDirectionLock:Q,onDrag:ce}=this.getProps();if(!G&&!this.openDragLock)return;const{offset:j}=I;if(K&&this.currentDirection===null){this.currentDirection=R4(j),this.currentDirection!==null&&Q&&Q(this.currentDirection);return}this.updateAxis("x",I.point,j),this.updateAxis("y",I.point,j),this.visualElement.render(),ce&&ce(z,I)},T=(z,I)=>{this.latestPointerEvent=z,this.latestPanInfo=I,this.stop(z,I),this.latestPointerEvent=null,this.latestPanInfo=null},E=()=>as(z=>{var I;return this.getAnimationState(z)==="paused"&&((I=this.getAxisMotionValue(z).animation)==null?void 0:I.play())}),{dragSnapToOrigin:D}=this.getProps();this.panSession=new RE(t,{onSessionStart:p,onStart:f,onMove:u,onSessionEnd:T,resumeAnimation:E},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:D,distanceThreshold:a,contextWindow:DE(this.visualElement)})}stop(t,i){const a=t||this.latestPointerEvent,h=i||this.latestPanInfo,p=this.isDragging;if(this.cancel(),!p||!h||!a)return;const{velocity:f}=h;this.startAnimation(f);const{onDragEnd:u}=this.getProps();u&&kn.postRender(()=>u(a,h))}cancel(){this.isDragging=!1;const{projection:t,animationState:i}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),i&&i.setActive("whileDrag",!1)}updateAxis(t,i,a){const{drag:h}=this.getProps();if(!a||!Qp(t,h,this.currentDirection))return;const p=this.getAxisMotionValue(t);let f=this.originPoint[t]+a[t];this.constraints&&this.constraints[t]&&(f=k4(f,this.constraints[t],this.elastic[t])),p.set(f)}resolveConstraints(){var p;const{dragConstraints:t,dragElastic:i}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(p=this.visualElement.projection)==null?void 0:p.layout,h=this.constraints;t&&gc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&a?this.constraints=P4(a.layoutBox,t):this.constraints=!1,this.elastic=A4(i),h!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&as(f=>{this.constraints!==!1&&this.getAxisMotionValue(f)&&(this.constraints[f]=M4(a.layoutBox[f],this.constraints[f]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:i}=this.getProps();if(!t||!gc(t))return!1;const a=t.current,{projection:h}=this.visualElement;if(!h||!h.layout)return!1;const p=L3(a,h.root,this.visualElement.getTransformPagePoint());let f=E4(h.layout.layoutBox,p);if(i){const u=i(z3(f));this.hasMutatedConstraints=!!u,u&&(f=_E(u))}return f}startAnimation(t){const{drag:i,dragMomentum:a,dragElastic:h,dragTransition:p,dragSnapToOrigin:f,onDragTransitionEnd:u}=this.getProps(),T=this.constraints||{},E=as(D=>{if(!Qp(D,i,this.currentDirection))return;let z=T&&T[D]||{};f&&(z={min:0,max:0});const I=h?200:1e6,G=h?40:1e7,K={type:"inertia",velocity:a?t[D]:0,bounceStiffness:I,bounceDamping:G,timeConstant:750,restDelta:1,restSpeed:10,...p,...z};return this.startAxisValueAnimation(D,K)});return Promise.all(E).then(u)}startAxisValueAnimation(t,i){const a=this.getAxisMotionValue(t);return z0(this.visualElement,t),a.start(S1(t,a,0,i,this.visualElement,!1))}stopAnimation(){as(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){as(t=>{var i;return(i=this.getAxisMotionValue(t).animation)==null?void 0:i.pause()})}getAnimationState(t){var i;return(i=this.getAxisMotionValue(t).animation)==null?void 0:i.state}getAxisMotionValue(t){const i=`_drag${t.toUpperCase()}`,a=this.visualElement.getProps(),h=a[i];return h||this.visualElement.getValue(t,(a.initial?a.initial[t]:void 0)||0)}snapToCursor(t){as(i=>{const{drag:a}=this.getProps();if(!Qp(i,a,this.currentDirection))return;const{projection:h}=this.visualElement,p=this.getAxisMotionValue(i);if(h&&h.layout){const{min:f,max:u}=h.layout.layoutBox[i];p.set(t[i]-Mn(f,u,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:i}=this.getProps(),{projection:a}=this.visualElement;if(!gc(i)||!a||!this.constraints)return;this.stopAnimation();const h={x:0,y:0};as(f=>{const u=this.getAxisMotionValue(f);if(u&&this.constraints!==!1){const T=u.get();h[f]=I4({min:T,max:T},this.constraints[f])}});const{transformTemplate:p}=this.visualElement.getProps();this.visualElement.current.style.transform=p?p({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),as(f=>{if(!Qp(f,t,null))return;const u=this.getAxisMotionValue(f),{min:T,max:E}=this.constraints[f];u.set(Mn(T,E,h[f]))})}addListeners(){if(!this.visualElement.current)return;z4.set(this.visualElement,this);const t=this.visualElement.current,i=Fd(t,"pointerdown",T=>{const{drag:E,dragListener:D=!0}=this.getProps();E&&D&&this.start(T)}),a=()=>{const{dragConstraints:T}=this.getProps();gc(T)&&T.current&&(this.constraints=this.resolveRefConstraints())},{projection:h}=this.visualElement,p=h.addEventListener("measure",a);h&&!h.layout&&(h.root&&h.root.updateScroll(),h.updateLayout()),kn.read(a);const f=cf(window,"resize",()=>this.scalePositionWithinConstraints()),u=h.addEventListener("didUpdate",({delta:T,hasLayoutChanged:E})=>{this.isDragging&&E&&(as(D=>{const z=this.getAxisMotionValue(D);z&&(this.originPoint[D]+=T[D].translate,z.set(z.get()+T[D].translate))}),this.visualElement.render())});return()=>{f(),i(),p(),u&&u()}}getProps(){const t=this.visualElement.getProps(),{drag:i=!1,dragDirectionLock:a=!1,dragPropagation:h=!1,dragConstraints:p=!1,dragElastic:f=R0,dragMomentum:u=!0}=t;return{...t,drag:i,dragDirectionLock:a,dragPropagation:h,dragConstraints:p,dragElastic:f,dragMomentum:u}}}function Qp(e,t,i){return(t===!0||t===e)&&(i===null||i===e)}function R4(e,t=10){let i=null;return Math.abs(e.y)>t?i="y":Math.abs(e.x)>t&&(i="x"),i}class L4 extends Ka{constructor(t){super(t),this.removeGroupControls=ps,this.removeListeners=ps,this.controls=new D4(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ps}unmount(){this.removeGroupControls(),this.removeListeners()}}const FS=e=>(t,i)=>{e&&kn.postRender(()=>e(t,i))};class F4 extends Ka{constructor(){super(...arguments),this.removePointerDownListener=ps}onPointerDown(t){this.session=new RE(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:DE(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:i,onPan:a,onPanEnd:h}=this.node.getProps();return{onSessionStart:FS(t),onStart:FS(i),onMove:a,onEnd:(p,f)=>{delete this.session,h&&kn.postRender(()=>h(p,f))}}}mount(){this.removePointerDownListener=Fd(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const _m={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function BS(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const pd={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Et.test(e))e=parseFloat(e);else return e;const i=BS(e,t.target.x),a=BS(e,t.target.y);return`${i}% ${a}%`}},B4={correct:(e,{treeScale:t,projectionDelta:i})=>{const a=e,h=Ga.parse(e);if(h.length>5)return a;const p=Ga.createTransformer(e),f=typeof h[0]!="number"?1:0,u=i.x.scale*t.x,T=i.y.scale*t.y;h[0+f]/=u,h[1+f]/=T;const E=Mn(u,T,.5);return typeof h[2+f]=="number"&&(h[2+f]/=E),typeof h[3+f]=="number"&&(h[3+f]/=E),p(h)}};let uv=!1;class O4 extends le.Component{componentDidMount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:a,layoutId:h}=this.props,{projection:p}=t;o3(V4),p&&(i.group&&i.group.add(p),a&&a.register&&h&&a.register(p),uv&&p.root.didUpdate(),p.addEventListener("animationComplete",()=>{this.safeToRemove()}),p.setOptions({...p.options,onExitComplete:()=>this.safeToRemove()})),_m.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:i,visualElement:a,drag:h,isPresent:p}=this.props,{projection:f}=a;return f&&(f.isPresent=p,uv=!0,h||t.layoutDependency!==i||i===void 0||t.isPresent!==p?f.willUpdate():this.safeToRemove(),t.isPresent!==p&&(p?f.promote():f.relegate()||kn.postRender(()=>{const u=f.getStack();(!u||!u.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),d1.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:a}=this.props,{projection:h}=t;uv=!0,h&&(h.scheduleCheckAfterUnmount(),i&&i.group&&i.group.remove(h),a&&a.deregister&&a.deregister(h))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function FE(e){const[t,i]=iE(),a=le.useContext(qx);return Ae.jsx(O4,{...e,layoutGroup:a,switchLayoutGroup:le.useContext(gE),isPresent:t,safeToRemove:i})}const V4={borderRadius:{...pd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:pd,borderTopRightRadius:pd,borderBottomLeftRadius:pd,borderBottomRightRadius:pd,boxShadow:B4};function N4(e,t,i){const a=Ur(e)?e:Bc(e);return a.start(S1("",a,t,i)),a.animation}const j4=(e,t)=>e.depth-t.depth;class $4{constructor(){this.children=[],this.isDirty=!1}add(t){Zx(this.children,t),this.isDirty=!0}remove(t){Hx(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(j4),this.isDirty=!1,this.children.forEach(t)}}function U4(e,t){const i=vi.now(),a=({timestamp:h})=>{const p=h-i;p>=t&&(qa(a),e(p-t))};return kn.setup(a,!0),()=>qa(a)}const BE=["TopLeft","TopRight","BottomLeft","BottomRight"],q4=BE.length,OS=e=>typeof e=="string"?parseFloat(e):e,VS=e=>typeof e=="number"||Et.test(e);function G4(e,t,i,a,h,p){h?(e.opacity=Mn(0,i.opacity??1,W4(a)),e.opacityExit=Mn(t.opacity??1,0,Z4(a))):p&&(e.opacity=Mn(t.opacity??1,i.opacity??1,a));for(let f=0;f<q4;f++){const u=`border${BE[f]}Radius`;let T=NS(t,u),E=NS(i,u);if(T===void 0&&E===void 0)continue;T||(T=0),E||(E=0),T===0||E===0||VS(T)===VS(E)?(e[u]=Math.max(Mn(OS(T),OS(E),a),0),(io.test(E)||io.test(T))&&(e[u]+="%")):e[u]=E}(t.rotate||i.rotate)&&(e.rotate=Mn(t.rotate||0,i.rotate||0,a))}function NS(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const W4=OE(0,.5,TP),Z4=OE(.5,.95,ps);function OE(e,t,i){return a=>a<e?0:a>t?1:i(sf(e,t,a))}function jS(e,t){e.min=t.min,e.max=t.max}function os(e,t){jS(e.x,t.x),jS(e.y,t.y)}function $S(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function US(e,t,i,a,h){return e-=t,e=ng(e,1/i,a),h!==void 0&&(e=ng(e,1/h,a)),e}function H4(e,t=0,i=1,a=.5,h,p=e,f=e){if(io.test(t)&&(t=parseFloat(t),t=Mn(f.min,f.max,t/100)-f.min),typeof t!="number")return;let u=Mn(p.min,p.max,a);e===p&&(u-=t),e.min=US(e.min,t,i,u,h),e.max=US(e.max,t,i,u,h)}function qS(e,t,[i,a,h],p,f){H4(e,t[i],t[a],t[h],t.scale,p,f)}const X4=["x","scaleX","originX"],K4=["y","scaleY","originY"];function GS(e,t,i,a){qS(e.x,t,X4,i?i.x:void 0,a?a.x:void 0),qS(e.y,t,K4,i?i.y:void 0,a?a.y:void 0)}function WS(e){return e.translate===0&&e.scale===1}function VE(e){return WS(e.x)&&WS(e.y)}function ZS(e,t){return e.min===t.min&&e.max===t.max}function Y4(e,t){return ZS(e.x,t.x)&&ZS(e.y,t.y)}function HS(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function NE(e,t){return HS(e.x,t.x)&&HS(e.y,t.y)}function XS(e){return ni(e.x)/ni(e.y)}function KS(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class J4{constructor(){this.members=[]}add(t){Zx(this.members,t),t.scheduleRender()}remove(t){if(Hx(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const i=this.members[this.members.length-1];i&&this.promote(i)}}relegate(t){const i=this.members.findIndex(h=>t===h);if(i===0)return!1;let a;for(let h=i;h>=0;h--){const p=this.members[h];if(p.isPresent!==!1){a=p;break}}return a?(this.promote(a),!0):!1}promote(t,i){const a=this.lead;if(t!==a&&(this.prevLead=a,this.lead=t,t.show(),a)){a.instance&&a.scheduleRender(),t.scheduleRender(),t.resumeFrom=a,i&&(t.resumeFrom.preserveOpacity=!0),a.snapshot&&(t.snapshot=a.snapshot,t.snapshot.latestValues=a.animationValues||a.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:h}=t.options;h===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:i,resumingFrom:a}=t;i.onExitComplete&&i.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Q4(e,t,i){let a="";const h=e.x.translate/t.x,p=e.y.translate/t.y,f=(i==null?void 0:i.z)||0;if((h||p||f)&&(a=`translate3d(${h}px, ${p}px, ${f}px) `),(t.x!==1||t.y!==1)&&(a+=`scale(${1/t.x}, ${1/t.y}) `),i){const{transformPerspective:E,rotate:D,rotateX:z,rotateY:I,skewX:G,skewY:K}=i;E&&(a=`perspective(${E}px) ${a}`),D&&(a+=`rotate(${D}deg) `),z&&(a+=`rotateX(${z}deg) `),I&&(a+=`rotateY(${I}deg) `),G&&(a+=`skewX(${G}deg) `),K&&(a+=`skewY(${K}deg) `)}const u=e.x.scale*t.x,T=e.y.scale*t.y;return(u!==1||T!==1)&&(a+=`scale(${u}, ${T})`),a||"none"}const cv=["","X","Y","Z"],eF=1e3;let tF=0;function hv(e,t,i,a){const{latestValues:h}=t;h[e]&&(i[e]=h[e],t.setStaticValue(e,0),a&&(a[e]=0))}function jE(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const i=kE(t);if(window.MotionHasOptimisedAnimation(i,"transform")){const{layout:h,layoutId:p}=e.options;window.MotionCancelOptimisedAnimation(i,"transform",kn,!(h||p))}const{parent:a}=e;a&&!a.hasCheckedOptimisedAppear&&jE(a)}function $E({attachResizeListener:e,defaultParent:t,measureScroll:i,checkIsScrollRoot:a,resetTransform:h}){return class{constructor(f={},u=t==null?void 0:t()){this.id=tF++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(iF),this.nodes.forEach(lF),this.nodes.forEach(uF),this.nodes.forEach(sF)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=f,this.root=u?u.root||u:this,this.path=u?[...u.path,u]:[],this.parent=u,this.depth=u?u.depth+1:0;for(let T=0;T<this.path.length;T++)this.path[T].shouldResetTransform=!0;this.root===this&&(this.nodes=new $4)}addEventListener(f,u){return this.eventHandlers.has(f)||this.eventHandlers.set(f,new Yx),this.eventHandlers.get(f).add(u)}notifyListeners(f,...u){const T=this.eventHandlers.get(f);T&&T.notify(...u)}hasListeners(f){return this.eventHandlers.has(f)}mount(f){if(this.instance)return;this.isSVG=rE(f)&&!Z5(f),this.instance=f;const{layoutId:u,layout:T,visualElement:E}=this.options;if(E&&!E.current&&E.mount(f),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(T||u)&&(this.isLayoutDirty=!0),e){let D,z=0;const I=()=>this.root.updateBlockedByResize=!1;kn.read(()=>{z=window.innerWidth}),e(f,()=>{const G=window.innerWidth;G!==z&&(z=G,this.root.updateBlockedByResize=!0,D&&D(),D=U4(I,250),_m.hasAnimatedSinceResize&&(_m.hasAnimatedSinceResize=!1,this.nodes.forEach(QS)))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&E&&(u||T)&&this.addEventListener("didUpdate",({delta:D,hasLayoutChanged:z,hasRelativeLayoutChanged:I,layout:G})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const K=this.options.transition||E.getDefaultTransition()||pF,{onLayoutAnimationStart:Q,onLayoutAnimationComplete:ce}=E.getProps(),j=!this.targetLayout||!NE(this.targetLayout,G),U=!z&&I;if(this.options.layoutRoot||this.resumeFrom||U||z&&(j||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const X={...c1(K,"layout"),onPlay:Q,onComplete:ce};(E.shouldReduceMotion||this.options.layoutRoot)&&(X.delay=0,X.type=!1),this.startAnimation(X),this.setAnimationOrigin(D,U)}else z||QS(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=G})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const f=this.getStack();f&&f.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),qa(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(cF),this.animationId++)}getTransformTemplate(){const{visualElement:f}=this.options;return f&&f.getProps().transformTemplate}willUpdate(f=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&jE(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let D=0;D<this.path.length;D++){const z=this.path[D];z.shouldResetTransform=!0,z.updateScroll("snapshot"),z.options.layoutRoot&&z.willUpdate(!1)}const{layoutId:u,layout:T}=this.options;if(u===void 0&&!T)return;const E=this.getTransformTemplate();this.prevTransformTemplateValue=E?E(this.latestValues,""):void 0,this.updateSnapshot(),f&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(YS);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(JS);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(aF),this.nodes.forEach(nF),this.nodes.forEach(rF)):this.nodes.forEach(JS),this.clearAllSnapshots();const u=vi.now();Cr.delta=Vo(0,1e3/60,u-Cr.timestamp),Cr.timestamp=u,Cr.isProcessing=!0,Q_.update.process(Cr),Q_.preRender.process(Cr),Q_.render.process(Cr),Cr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,d1.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(oF),this.sharedNodes.forEach(hF)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,kn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){kn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ni(this.snapshot.measuredBox.x)&&!ni(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let T=0;T<this.path.length;T++)this.path[T].updateScroll();const f=this.layout;this.layout=this.measure(!1),this.layoutCorrected=$n(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:u}=this.options;u&&u.notify("LayoutMeasure",this.layout.layoutBox,f?f.layoutBox:void 0)}updateScroll(f="measure"){let u=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===f&&(u=!1),u&&this.instance){const T=a(this.instance);this.scroll={animationId:this.root.animationId,phase:f,isRoot:T,offset:i(this.instance),wasRoot:this.scroll?this.scroll.isRoot:T}}}resetTransform(){if(!h)return;const f=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,u=this.projectionDelta&&!VE(this.projectionDelta),T=this.getTransformTemplate(),E=T?T(this.latestValues,""):void 0,D=E!==this.prevTransformTemplateValue;f&&this.instance&&(u||zl(this.latestValues)||D)&&(h(this.instance,E),this.shouldResetTransform=!1,this.scheduleRender())}measure(f=!0){const u=this.measurePageBox();let T=this.removeElementScroll(u);return f&&(T=this.removeTransform(T)),mF(T),{animationId:this.root.animationId,measuredBox:u,layoutBox:T,latestValues:{},source:this.id}}measurePageBox(){var E;const{visualElement:f}=this.options;if(!f)return $n();const u=f.measureViewportBox();if(!(((E=this.scroll)==null?void 0:E.wasRoot)||this.path.some(gF))){const{scroll:D}=this.root;D&&(yc(u.x,D.offset.x),yc(u.y,D.offset.y))}return u}removeElementScroll(f){var T;const u=$n();if(os(u,f),(T=this.scroll)!=null&&T.wasRoot)return u;for(let E=0;E<this.path.length;E++){const D=this.path[E],{scroll:z,options:I}=D;D!==this.root&&z&&I.layoutScroll&&(z.wasRoot&&os(u,f),yc(u.x,z.offset.x),yc(u.y,z.offset.y))}return u}applyTransform(f,u=!1){const T=$n();os(T,f);for(let E=0;E<this.path.length;E++){const D=this.path[E];!u&&D.options.layoutScroll&&D.scroll&&D!==D.root&&_c(T,{x:-D.scroll.offset.x,y:-D.scroll.offset.y}),zl(D.latestValues)&&_c(T,D.latestValues)}return zl(this.latestValues)&&_c(T,this.latestValues),T}removeTransform(f){const u=$n();os(u,f);for(let T=0;T<this.path.length;T++){const E=this.path[T];if(!E.instance||!zl(E.latestValues))continue;E0(E.latestValues)&&E.updateSnapshot();const D=$n(),z=E.measurePageBox();os(D,z),GS(u,E.latestValues,E.snapshot?E.snapshot.layoutBox:void 0,D)}return zl(this.latestValues)&&GS(u,this.latestValues),u}setTargetDelta(f){this.targetDelta=f,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(f){this.options={...this.options,...f,crossfade:f.crossfade!==void 0?f.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Cr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(f=!1){var I;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const T=!!this.resumingFrom||this!==u;if(!(f||T&&this.isSharedProjectionDirty||this.isProjectionDirty||(I=this.parent)!=null&&I.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:D,layoutId:z}=this.options;if(!(!this.layout||!(D||z))){if(this.resolvedRelativeTargetAt=Cr.timestamp,!this.targetDelta&&!this.relativeTarget){const G=this.getClosestProjectingParent();G&&G.layout&&this.animationProgress!==1?(this.relativeParent=G,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$n(),this.relativeTargetOrigin=$n(),Od(this.relativeTargetOrigin,this.layout.layoutBox,G.layout.layoutBox),os(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=$n(),this.targetWithTransforms=$n()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),w4(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):os(this.target,this.layout.layoutBox),xE(this.target,this.targetDelta)):os(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const G=this.getClosestProjectingParent();G&&!!G.resumingFrom==!!this.resumingFrom&&!G.options.layoutScroll&&G.target&&this.animationProgress!==1?(this.relativeParent=G,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$n(),this.relativeTargetOrigin=$n(),Od(this.relativeTargetOrigin,this.target,G.target),os(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||E0(this.parent.latestValues)||vE(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var K;const f=this.getLead(),u=!!this.resumingFrom||this!==f;let T=!0;if((this.isProjectionDirty||(K=this.parent)!=null&&K.isProjectionDirty)&&(T=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(T=!1),this.resolvedRelativeTargetAt===Cr.timestamp&&(T=!1),T)return;const{layout:E,layoutId:D}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(E||D))return;os(this.layoutCorrected,this.layout.layoutBox);const z=this.treeScale.x,I=this.treeScale.y;R3(this.layoutCorrected,this.treeScale,this.path,u),f.layout&&!f.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(f.target=f.layout.layoutBox,f.targetWithTransforms=$n());const{target:G}=f;if(!G){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():($S(this.prevProjectionDelta.x,this.projectionDelta.x),$S(this.prevProjectionDelta.y,this.projectionDelta.y)),Bd(this.projectionDelta,this.layoutCorrected,G,this.latestValues),(this.treeScale.x!==z||this.treeScale.y!==I||!KS(this.projectionDelta.x,this.prevProjectionDelta.x)||!KS(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",G))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(f=!0){var u;if((u=this.options.visualElement)==null||u.scheduleRender(),f){const T=this.getStack();T&&T.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=vc(),this.projectionDelta=vc(),this.projectionDeltaWithTransform=vc()}setAnimationOrigin(f,u=!1){const T=this.snapshot,E=T?T.latestValues:{},D={...this.latestValues},z=vc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!u;const I=$n(),G=T?T.source:void 0,K=this.layout?this.layout.source:void 0,Q=G!==K,ce=this.getStack(),j=!ce||ce.members.length<=1,U=!!(Q&&!j&&this.options.crossfade===!0&&!this.path.some(fF));this.animationProgress=0;let X;this.mixTargetDelta=ne=>{const ge=ne/1e3;eT(z.x,f.x,ge),eT(z.y,f.y,ge),this.setTargetDelta(z),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Od(I,this.layout.layoutBox,this.relativeParent.layout.layoutBox),dF(this.relativeTarget,this.relativeTargetOrigin,I,ge),X&&Y4(this.relativeTarget,X)&&(this.isProjectionDirty=!1),X||(X=$n()),os(X,this.relativeTarget)),Q&&(this.animationValues=D,G4(D,E,this.latestValues,ge,U,j)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=ge},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(f){var u,T,E;this.notifyListeners("animationStart"),(u=this.currentAnimation)==null||u.stop(),(E=(T=this.resumingFrom)==null?void 0:T.currentAnimation)==null||E.stop(),this.pendingAnimation&&(qa(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=kn.update(()=>{_m.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Bc(0)),this.currentAnimation=N4(this.motionValue,[0,1e3],{...f,velocity:0,isSync:!0,onUpdate:D=>{this.mixTargetDelta(D),f.onUpdate&&f.onUpdate(D)},onStop:()=>{},onComplete:()=>{f.onComplete&&f.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const f=this.getStack();f&&f.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(eF),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const f=this.getLead();let{targetWithTransforms:u,target:T,layout:E,latestValues:D}=f;if(!(!u||!T||!E)){if(this!==f&&this.layout&&E&&UE(this.options.animationType,this.layout.layoutBox,E.layoutBox)){T=this.target||$n();const z=ni(this.layout.layoutBox.x);T.x.min=f.target.x.min,T.x.max=T.x.min+z;const I=ni(this.layout.layoutBox.y);T.y.min=f.target.y.min,T.y.max=T.y.min+I}os(u,T),_c(u,D),Bd(this.projectionDeltaWithTransform,this.layoutCorrected,u,D)}}registerSharedNode(f,u){this.sharedNodes.has(f)||this.sharedNodes.set(f,new J4),this.sharedNodes.get(f).add(u);const E=u.options.initialPromotionConfig;u.promote({transition:E?E.transition:void 0,preserveFollowOpacity:E&&E.shouldPreserveFollowOpacity?E.shouldPreserveFollowOpacity(u):void 0})}isLead(){const f=this.getStack();return f?f.lead===this:!0}getLead(){var u;const{layoutId:f}=this.options;return f?((u=this.getStack())==null?void 0:u.lead)||this:this}getPrevLead(){var u;const{layoutId:f}=this.options;return f?(u=this.getStack())==null?void 0:u.prevLead:void 0}getStack(){const{layoutId:f}=this.options;if(f)return this.root.sharedNodes.get(f)}promote({needsReset:f,transition:u,preserveFollowOpacity:T}={}){const E=this.getStack();E&&E.promote(this,T),f&&(this.projectionDelta=void 0,this.needsReset=!0),u&&this.setOptions({transition:u})}relegate(){const f=this.getStack();return f?f.relegate(this):!1}resetSkewAndRotation(){const{visualElement:f}=this.options;if(!f)return;let u=!1;const{latestValues:T}=f;if((T.z||T.rotate||T.rotateX||T.rotateY||T.rotateZ||T.skewX||T.skewY)&&(u=!0),!u)return;const E={};T.z&&hv("z",f,E,this.animationValues);for(let D=0;D<cv.length;D++)hv(`rotate${cv[D]}`,f,E,this.animationValues),hv(`skew${cv[D]}`,f,E,this.animationValues);f.render();for(const D in E)f.setStaticValue(D,E[D]),this.animationValues&&(this.animationValues[D]=E[D]);f.scheduleRender()}applyProjectionStyles(f,u){if(!this.instance||this.isSVG)return;if(!this.isVisible){f.visibility="hidden";return}const T=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,f.visibility="",f.opacity="",f.pointerEvents=ym(u==null?void 0:u.pointerEvents)||"",f.transform=T?T(this.latestValues,""):"none";return}const E=this.getLead();if(!this.projectionDelta||!this.layout||!E.target){this.options.layoutId&&(f.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,f.pointerEvents=ym(u==null?void 0:u.pointerEvents)||""),this.hasProjected&&!zl(this.latestValues)&&(f.transform=T?T({},""):"none",this.hasProjected=!1);return}f.visibility="";const D=E.animationValues||E.latestValues;this.applyTransformsToTarget();let z=Q4(this.projectionDeltaWithTransform,this.treeScale,D);T&&(z=T(D,z)),f.transform=z;const{x:I,y:G}=this.projectionDelta;f.transformOrigin=`${I.origin*100}% ${G.origin*100}% 0`,E.animationValues?f.opacity=E===this?D.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:D.opacityExit:f.opacity=E===this?D.opacity!==void 0?D.opacity:"":D.opacityExit!==void 0?D.opacityExit:0;for(const K in uf){if(D[K]===void 0)continue;const{correct:Q,applyTo:ce,isCSSVariable:j}=uf[K],U=z==="none"?D[K]:Q(D[K],E);if(ce){const X=ce.length;for(let ne=0;ne<X;ne++)f[ce[ne]]=U}else j?this.options.visualElement.renderState.vars[K]=U:f[K]=U}this.options.layoutId&&(f.pointerEvents=E===this?ym(u==null?void 0:u.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(f=>{var u;return(u=f.currentAnimation)==null?void 0:u.stop()}),this.root.nodes.forEach(YS),this.root.sharedNodes.clear()}}}function nF(e){e.updateLayout()}function rF(e){var i;const t=((i=e.resumeFrom)==null?void 0:i.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:h}=e.layout,{animationType:p}=e.options,f=t.source!==e.layout.source;p==="size"?as(z=>{const I=f?t.measuredBox[z]:t.layoutBox[z],G=ni(I);I.min=a[z].min,I.max=I.min+G}):UE(p,t.layoutBox,a)&&as(z=>{const I=f?t.measuredBox[z]:t.layoutBox[z],G=ni(a[z]);I.max=I.min+G,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[z].max=e.relativeTarget[z].min+G)});const u=vc();Bd(u,a,t.layoutBox);const T=vc();f?Bd(T,e.applyTransform(h,!0),t.measuredBox):Bd(T,a,t.layoutBox);const E=!VE(u);let D=!1;if(!e.resumeFrom){const z=e.getClosestProjectingParent();if(z&&!z.resumeFrom){const{snapshot:I,layout:G}=z;if(I&&G){const K=$n();Od(K,t.layoutBox,I.layoutBox);const Q=$n();Od(Q,a,G.layoutBox),NE(K,Q)||(D=!0),z.options.layoutRoot&&(e.relativeTarget=Q,e.relativeTargetOrigin=K,e.relativeParent=z)}}}e.notifyListeners("didUpdate",{layout:a,snapshot:t,delta:T,layoutDelta:u,hasLayoutChanged:E,hasRelativeLayoutChanged:D})}else if(e.isLead()){const{onExitComplete:a}=e.options;a&&a()}e.options.transition=void 0}function iF(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function sF(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function oF(e){e.clearSnapshot()}function YS(e){e.clearMeasurements()}function JS(e){e.isLayoutDirty=!1}function aF(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function QS(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function lF(e){e.resolveTargetDelta()}function uF(e){e.calcProjection()}function cF(e){e.resetSkewAndRotation()}function hF(e){e.removeLeadSnapshot()}function eT(e,t,i){e.translate=Mn(t.translate,0,i),e.scale=Mn(t.scale,1,i),e.origin=t.origin,e.originPoint=t.originPoint}function tT(e,t,i,a){e.min=Mn(t.min,i.min,a),e.max=Mn(t.max,i.max,a)}function dF(e,t,i,a){tT(e.x,t.x,i.x,a),tT(e.y,t.y,i.y,a)}function fF(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const pF={duration:.45,ease:[.4,0,.1,1]},nT=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),rT=nT("applewebkit/")&&!nT("chrome/")?Math.round:ps;function iT(e){e.min=rT(e.min),e.max=rT(e.max)}function mF(e){iT(e.x),iT(e.y)}function UE(e,t,i){return e==="position"||e==="preserve-aspect"&&!b4(XS(t),XS(i),.2)}function gF(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const yF=$E({attachResizeListener:(e,t)=>cf(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),dv={current:void 0},qE=$E({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!dv.current){const e=new yF({});e.mount(window),e.setOptions({layoutScroll:!0}),dv.current=e}return dv.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),_F={pan:{Feature:F4},drag:{Feature:L4,ProjectionNode:qE,MeasureLayout:FE}};function sT(e,t,i){const{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",i==="Start");const h="onHover"+i,p=a[h];p&&kn.postRender(()=>p(t,Cf(t)))}class vF extends Ka{mount(){const{current:t}=this.node;t&&(this.unmount=$5(t,(i,a)=>(sT(this.node,a,"Start"),h=>sT(this.node,h,"End"))))}unmount(){}}class xF extends Ka{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=wf(cf(this.node.current,"focus",()=>this.onFocus()),cf(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function oT(e,t,i){const{props:a}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap",i==="Start");const h="onTap"+(i==="End"?"":i),p=a[h];p&&kn.postRender(()=>p(t,Cf(t)))}class bF extends Ka{mount(){const{current:t}=this.node;t&&(this.unmount=W5(t,(i,a)=>(oT(this.node,a,"Start"),(h,{success:p})=>oT(this.node,h,p?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const L0=new WeakMap,fv=new WeakMap,wF=e=>{const t=L0.get(e.target);t&&t(e)},SF=e=>{e.forEach(wF)};function TF({root:e,...t}){const i=e||document;fv.has(i)||fv.set(i,{});const a=fv.get(i),h=JSON.stringify(t);return a[h]||(a[h]=new IntersectionObserver(SF,{root:e,...t})),a[h]}function CF(e,t,i){const a=TF(t);return L0.set(e,i),a.observe(e),()=>{L0.delete(e),a.unobserve(e)}}const kF={some:0,all:1};class PF extends Ka{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:i,margin:a,amount:h="some",once:p}=t,f={root:i?i.current:void 0,rootMargin:a,threshold:typeof h=="number"?h:kF[h]},u=T=>{const{isIntersecting:E}=T;if(this.isInView===E||(this.isInView=E,p&&!E&&this.hasEnteredView))return;E&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",E);const{onViewportEnter:D,onViewportLeave:z}=this.node.getProps(),I=E?D:z;I&&I(T)};return CF(this.node.current,f,u)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:i}=this.node;["amount","margin","root"].some(EF(t,i))&&this.startObserver()}unmount(){}}function EF({viewport:e={}},{viewport:t={}}={}){return i=>e[i]!==t[i]}const IF={inView:{Feature:PF},tap:{Feature:bF},focus:{Feature:xF},hover:{Feature:vF}},MF={layout:{ProjectionNode:qE,MeasureLayout:FE}},AF={...m4,...IF,..._F,...MF},vm=A3(AF,q3),Pl="polygon-region",md="polygon-vertices",Ku="polygon-preview-line",aT="polygon-region-fill",lT="polygon-region-outline",uT="polygon-vertex-circles",cT="polygon-preview";function pv({active:e,disabled:t,title:i,onClick:a,children:h}){return Ae.jsx("button",{title:i,onClick:a,disabled:t,style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,borderRadius:7,border:"none",cursor:t?"default":"pointer",background:e?"#3b82f6":"#f1f5f9",color:t?"#cbd5e1":e?"#fff":"#64748b",fontSize:15,transition:"background 0.15s, color 0.15s"},children:h})}function zF({polygonCoords:e,polygonClosed:t,setPolygonCoords:i,setPolygonClosed:a}){var Q;const h=xf(),p=(Q=h==null?void 0:h.current)==null?void 0:Q.getMap(),[f,u]=le.useState(0),[T,E]=le.useState(null),D=le.useRef(null),z=le.useRef(!1),I=le.useRef(0);if(le.useEffect(()=>{if(!p)return;const ce=()=>{p.getSource(Pl)||(p.addSource(Pl,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[]}}}),p.addLayer({id:aT,type:"fill",source:Pl,paint:{"fill-color":"#3b82f6","fill-opacity":.15}}),p.addLayer({id:lT,type:"line",source:Pl,paint:{"line-color":"#3b82f6","line-width":1.5}})),p.getSource(md)||(p.addSource(md,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),p.addLayer({id:uT,type:"circle",source:md,paint:{"circle-radius":5,"circle-color":"#fff","circle-stroke-color":"#3b82f6","circle-stroke-width":2}})),p.getSource(Ku)||(p.addSource(Ku,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}}),p.addLayer({id:cT,type:"line",source:Ku,paint:{"line-color":"#3b82f6","line-width":1.5,"line-dasharray":[4,3],"line-opacity":.6}}))};return p.isStyleLoaded()?ce():p.once("styledata",ce),()=>{[cT,uT,lT,aT].forEach(j=>{p.getLayer(j)&&p.removeLayer(j)}),[Ku,md,Pl].forEach(j=>{p.getSource(j)&&p.removeSource(j)})}},[p]),le.useEffect(()=>{if(!p||!p.getSource(Pl))return;const ce=t&&e.length>=3?[...e,e[0]]:[];p.getSource(Pl).setData({type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:ce.length?[ce]:[]}}),p.getSource(md).setData({type:"FeatureCollection",features:e.map(([j,U],X)=>({type:"Feature",properties:{index:X},geometry:{type:"Point",coordinates:[j,U]}}))})},[p,e,t]),le.useEffect(()=>{if(!p||!p.getSource(Ku))return;const ce=!t&&e.length>=1&&T!==null;p.getSource(Ku).setData({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:ce?[e[e.length-1],T]:[]}})},[p,T,e,t]),le.useEffect(()=>{if(!p)return;const ce=300,j=X=>{if(f!==1||t)return;const ne=Date.now();if(ne-I.current<ce){I.current=0;return}I.current=ne,i(ge=>[...ge,[X.lngLat.lng,X.lngLat.lat]])},U=X=>{f!==1||t||(X.preventDefault(),e.length>=3&&(a(!0),u(0),E(null),I.current=0))};return p.on("click",j),p.on("dblclick",U),()=>{p.off("click",j),p.off("dblclick",U)}},[p,f,t,e.length,i,a]),le.useEffect(()=>{if(!p)return;const ce=j=>{if(f===1&&!t){E([j.lngLat.lng,j.lngLat.lat]),p.getCanvas().style.cursor="crosshair";return}if(f===0&&t&&e.length>0){const U=p.project(j.lngLat),X=e.some(([ne,ge])=>{const fe=p.project({lng:ne,lat:ge});return(U.x-fe.x)**2+(U.y-fe.y)**2<100});p.getCanvas().style.cursor=X?"grab":""}else p.getCanvas().style.cursor=""};return p.on("mousemove",ce),()=>{p.off("mousemove",ce),z.current||(p.getCanvas().style.cursor="")}},[p,f,t,e]),le.useEffect(()=>{if(!p)return;const ce=X=>{if(f!==0||!t||e.length===0)return;const ne=p.project(X.lngLat);let ge=-1,fe=1/0;e.forEach(([we,Ie],Ne)=>{const $e=p.project({lng:we,lat:Ie}),Ve=(ne.x-$e.x)**2+(ne.y-$e.y)**2;Ve<100&&Ve<fe&&(fe=Ve,ge=Ne)}),ge>=0&&(D.current=ge,z.current=!0,p.dragPan.disable(),p.getCanvas().style.cursor="grabbing",X.preventDefault())},j=X=>{if(!z.current||D.current===null)return;const ne=[X.lngLat.lng,X.lngLat.lat];i(ge=>{const fe=[...ge];return fe[D.current]=ne,fe})},U=()=>{z.current&&(z.current=!1,D.current=null,p.dragPan.enable(),p.getCanvas().style.cursor="grab")};return p.on("mousedown",ce),p.on("mousemove",j),p.on("mouseup",U),()=>{p.off("mousedown",ce),p.off("mousemove",j),p.off("mouseup",U),p.dragPan.enable()}},[p,f,t,e,i]),!p)return null;const G=()=>{i([]),a(!1),E(null),u(0),p&&(p.getCanvas().style.cursor="")},K=t?"Drag vertices to adjust":f===1?e.length===0?"Click to place points":e.length<3?`${e.length} point${e.length>1?"s":""}  need ${3-e.length} more`:"Double-click to close":"Draw a region to constrain routes";return Ae.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[Ae.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[Ae.jsx(pv,{title:"Mouse / Edit",active:f===0,onClick:()=>{u(0),E(null),p&&(p.getCanvas().style.cursor="")},children:Ae.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:Ae.jsx("path",{d:"M4 0l16 12-7 2-4 8z"})})}),Ae.jsx(pv,{title:t?"Reset to redraw":"Draw region",active:f===1,disabled:t,onClick:()=>u(1),children:Ae.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:Ae.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})}),e.length>0&&Ae.jsx(pv,{title:"Clear region",onClick:G,children:Ae.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:Ae.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),Ae.jsx("div",{style:{fontSize:11,color:"#94a3b8"},children:K})]})}function DF({value:e,onChange:t}){const[i,a]=le.useState(String(e)),h=p=>{const f=parseFloat(p);!isNaN(f)&&f>=SR&&f<=TR?(t(f),a(String(f))):a(String(e))};return Ae.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[Ae.jsx("span",{style:{fontSize:12,color:"#64748b"},children:"Distance"}),Ae.jsxs("div",{style:{position:"relative",width:90},children:[Ae.jsx("input",{value:i,onChange:p=>a(p.target.value),onBlur:p=>h(p.target.value),onKeyDown:p=>{p.key==="Enter"&&h(p.target.value)},inputMode:"decimal",style:{width:"100%",boxSizing:"border-box",background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:8,padding:"7px 28px 7px 10px",color:"#0f172a",fontSize:13,outline:"none",appearance:"none",MozAppearance:"textfield"}}),Ae.jsx("span",{style:{position:"absolute",right:9,top:"50%",transform:"translateY(-50%)",fontSize:11,color:"#94a3b8",pointerEvents:"none"},children:"mi"})]})]})}var GE={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */(function(e,t){(function(i,a){e.exports=a()})(IA,function(){var i={},a={};function h(f,u,T){if(a[f]=T,f==="index"){var E="var sharedModule = {}; ("+a.shared+")(sharedModule); ("+a.worker+")(sharedModule);",D={};return a.shared(D),a.index(i,D),typeof window<"u"&&i.setWorkerUrl(window.URL.createObjectURL(new Blob([E],{type:"text/javascript"}))),i}}h("shared",["exports"],function(f){function u(s,r,o,c){return new(o||(o=Promise))(function(g,v){function x(P){try{S(c.next(P))}catch(M){v(M)}}function b(P){try{S(c.throw(P))}catch(M){v(M)}}function S(P){var M;P.done?g(P.value):(M=P.value,M instanceof o?M:new o(function(R){R(M)})).then(x,b)}S((c=c.apply(s,r||[])).next())})}function T(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}typeof SuppressedError=="function"&&SuppressedError;var E=D;function D(s,r){this.x=s,this.y=r}D.prototype={clone:function(){return new D(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,r){return this.clone()._rotateAround(s,r)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var r=s.x-this.x,o=s.y-this.y;return r*r+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,r){return Math.atan2(this.x*r-this.y*s,this.x*s+this.y*r)},_matMult:function(s){var r=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=r,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var r=Math.cos(s),o=Math.sin(s),c=o*this.x+r*this.y;return this.x=r*this.x-o*this.y,this.y=c,this},_rotateAround:function(s,r){var o=Math.cos(s),c=Math.sin(s),g=r.y+c*(this.x-r.x)+o*(this.y-r.y);return this.x=r.x+o*(this.x-r.x)-c*(this.y-r.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},D.convert=function(s){return s instanceof D?s:Array.isArray(s)?new D(s[0],s[1]):s};var z=T(E),I=G;function G(s,r,o,c){this.cx=3*s,this.bx=3*(o-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(c-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=r,this.p2x=o,this.p2y=c}G.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,r){if(r===void 0&&(r=1e-6),s<0)return 0;if(s>1)return 1;for(var o=s,c=0;c<8;c++){var g=this.sampleCurveX(o)-s;if(Math.abs(g)<r)return o;var v=this.sampleCurveDerivativeX(o);if(Math.abs(v)<1e-6)break;o-=g/v}var x=0,b=1;for(o=s,c=0;c<20&&(g=this.sampleCurveX(o),!(Math.abs(g-s)<r));c++)s>g?x=o:b=o,o=.5*(b-x)+x;return o},solve:function(s,r){return this.sampleCurveY(this.solveCurveX(s,r))}};var K=T(I);let Q,ce;function j(){return Q==null&&(Q=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Q}function U(){if(ce==null&&(ce=!1,j())){const r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let c=0;c<5*5;c++){const g=4*c;r.fillStyle=`rgb(${g},${g+1},${g+2})`,r.fillRect(c%5,Math.floor(c/5),1,1)}const o=r.getImageData(0,0,5,5).data;for(let c=0;c<5*5*4;c++)if(c%4!=3&&o[c]!==c){ce=!0;break}}}return ce||!1}function X(s,r,o,c){const g=new K(s,r,o,c);return v=>g.solve(v)}const ne=X(.25,.1,.25,1);function ge(s,r,o){return Math.min(o,Math.max(r,s))}function fe(s,r,o){const c=o-r,g=((s-r)%c+c)%c+r;return g===r?o:g}function we(s,...r){for(const o of r)for(const c in o)s[c]=o[c];return s}let Ie=1;function Ne(s,r,o){const c={};for(const g in s)c[g]=r.call(this,s[g],g,s);return c}function $e(s,r,o){const c={};for(const g in s)r.call(this,s[g],g,s)&&(c[g]=s[g]);return c}function Ve(s){return Array.isArray(s)?s.map(Ve):typeof s=="object"&&s?Ne(s,Ve):s}const J={};function ze(s){J[s]||(typeof console<"u"&&console.warn(s),J[s]=!0)}function Le(s,r,o){return(o.y-s.y)*(r.x-s.x)>(r.y-s.y)*(o.x-s.x)}function ot(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let xt=null;function _t(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const Oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function et(s,r,o,c,g){return u(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const v=new VideoFrame(s,{timestamp:0});try{const x=v==null?void 0:v.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const b=x.startsWith("BGR"),S=new Uint8ClampedArray(c*g*4);if(yield v.copyTo(S,function(P,M,R,B,N){const q=4*Math.max(-M,0),W=(Math.max(0,R)-R)*B*4+q,te=4*B,oe=Math.max(0,M),Se=Math.max(0,R);return{rect:{x:oe,y:Se,width:Math.min(P.width,M+B)-oe,height:Math.min(P.height,R+N)-Se},layout:[{offset:W,stride:te}]}}(s,r,o,c,g)),b)for(let P=0;P<S.length;P+=4){const M=S[P];S[P]=S[P+2],S[P+2]=M}return S}finally{v.close()}})}let pt,Pt;const Bt="AbortError";function Gr(){return new Error(Bt)}const Gn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function sr(s){return Gn.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const or="global-dispatcher";class Dn extends Error{constructor(r,o,c,g){super(`AJAXError: ${o} (${r}): ${c}`),this.status=r,this.statusText=o,this.url=c,this.body=g}}const Wr=()=>ot(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,vs=function(s,r){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const c=sr(s.url);if(c)return c(s,r);if(ot(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:or},r)}if(!(/^file:/.test(o=s.url)||/^file:/.test(Wr())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(c,g){return u(this,void 0,void 0,function*(){const v=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,cache:c.cache,referrer:Wr(),signal:g.signal});c.type!=="json"||v.headers.has("Accept")||v.headers.set("Accept","application/json");const x=yield fetch(v);if(!x.ok){const P=yield x.blob();throw new Dn(x.status,x.statusText,c.url,P)}let b;b=c.type==="arrayBuffer"||c.type==="image"?x.arrayBuffer():c.type==="json"?x.json():x.text();const S=yield b;if(g.signal.aborted)throw Gr();return{data:S,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(s,r);if(ot(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:or},r)}var o;return function(c,g){return new Promise((v,x)=>{var b;const S=new XMLHttpRequest;S.open(c.method||"GET",c.url,!0),c.type!=="arrayBuffer"&&c.type!=="image"||(S.responseType="arraybuffer");for(const P in c.headers)S.setRequestHeader(P,c.headers[P]);c.type==="json"&&(S.responseType="text",!((b=c.headers)===null||b===void 0)&&b.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=c.credentials==="include",S.onerror=()=>{x(new Error(S.statusText))},S.onload=()=>{if(!g.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let P=S.response;if(c.type==="json")try{P=JSON.parse(S.response)}catch(M){return void x(M)}v({data:P,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const P=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});x(new Dn(S.status,S.statusText,c.url,P))}},g.signal.addEventListener("abort",()=>{S.abort(),x(Gr())}),S.send(c.body)})}(s,r)};function xs(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const r=new URL(s),o=window.location;return r.protocol===o.protocol&&r.host===o.host}function ao(s,r,o){o[s]&&o[s].indexOf(r)!==-1||(o[s]=o[s]||[],o[s].push(r))}function Ti(s,r,o){if(o&&o[s]){const c=o[s].indexOf(r);c!==-1&&o[s].splice(c,1)}}class Xi{constructor(r,o={}){we(this,o),this.type=r}}class oi extends Xi{constructor(r,o={}){super("error",we({error:r},o))}}class Fs{on(r,o){return this._listeners=this._listeners||{},ao(r,o,this._listeners),this}off(r,o){return Ti(r,o,this._listeners),Ti(r,o,this._oneTimeListeners),this}once(r,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},ao(r,o,this._oneTimeListeners),this):new Promise(c=>this.once(r,c))}fire(r,o){typeof r=="string"&&(r=new Xi(r,o||{}));const c=r.type;if(this.listens(c)){r.target=this;const g=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const b of g)b.call(this,r);const v=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const b of v)Ti(c,b,this._oneTimeListeners),b.call(this,r);const x=this._eventedParent;x&&(we(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(r))}else r instanceof oi&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,o){return this._eventedParent=r,this._eventedParentData=o,this}}var ke={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ai=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ci(s,r){const o={};for(const c in s)c!=="ref"&&(o[c]=s[c]);return ai.forEach(c=>{c in r&&(o[c]=r[c])}),o}function Ot(s,r){if(Array.isArray(s)){if(!Array.isArray(r)||s.length!==r.length)return!1;for(let o=0;o<s.length;o++)if(!Ot(s[o],r[o]))return!1;return!0}if(typeof s=="object"&&s!==null&&r!==null){if(typeof r!="object"||Object.keys(s).length!==Object.keys(r).length)return!1;for(const o in s)if(!Ot(s[o],r[o]))return!1;return!0}return s===r}function ln(s,r){s.push(r)}function lo(s,r,o){ln(o,{command:"addSource",args:[s,r[s]]})}function Tt(s,r,o){ln(r,{command:"removeSource",args:[s]}),o[s]=!0}function bs(s,r,o,c){Tt(s,o,c),lo(s,r,o)}function qo(s,r,o){let c;for(c in s[o])if(Object.prototype.hasOwnProperty.call(s[o],c)&&c!=="data"&&!Ot(s[o][c],r[o][c]))return!1;for(c in r[o])if(Object.prototype.hasOwnProperty.call(r[o],c)&&c!=="data"&&!Ot(s[o][c],r[o][c]))return!1;return!0}function li(s,r,o,c,g,v){s=s||{},r=r||{};for(const x in s)Object.prototype.hasOwnProperty.call(s,x)&&(Ot(s[x],r[x])||o.push({command:v,args:[c,x,r[x],g]}));for(const x in r)Object.prototype.hasOwnProperty.call(r,x)&&!Object.prototype.hasOwnProperty.call(s,x)&&(Ot(s[x],r[x])||o.push({command:v,args:[c,x,r[x],g]}))}function Ya(s){return s.id}function Ja(s,r){return s[r.id]=r,s}class Ue{constructor(r,o,c,g){this.message=(r?`${r}: `:"")+c,g&&(this.identifier=g),o!=null&&o.__line__&&(this.line=o.__line__)}}function Ki(s,...r){for(const o of r)for(const c in o)s[c]=o[c];return s}class _r extends Error{constructor(r,o){super(o),this.message=o,this.key=r}}class Yi{constructor(r,o=[]){this.parent=r,this.bindings={};for(const[c,g]of o)this.bindings[c]=g}concat(r){return new Yi(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const Bs={kind:"null"},He={kind:"number"},Mt={kind:"string"},vt={kind:"boolean"},Ir={kind:"color"},ki={kind:"object"},Ct={kind:"value"},Ji={kind:"collator"},ws={kind:"formatted"},Os={kind:"padding"},Qi={kind:"resolvedImage"},se={kind:"variableAnchorOffsetCollection"};function V(s,r){return{kind:"array",itemType:s,N:r}}function O(s){if(s.kind==="array"){const r=O(s.itemType);return typeof s.N=="number"?`array<${r}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${r}>`}return s.kind}const Z=[Bs,He,Mt,vt,Ir,ws,ki,V(Ct),Os,Qi,se];function re(s,r){if(r.kind==="error")return null;if(s.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!re(s.itemType,r.itemType))&&(typeof s.N!="number"||s.N===r.N))return null}else{if(s.kind===r.kind)return null;if(s.kind==="value"){for(const o of Z)if(!re(o,r))return null}}return`Expected ${O(s)} but found ${O(r)} instead.`}function me(s,r){return r.some(o=>o.kind===s.kind)}function _e(s,r){return r.some(o=>o==="null"?s===null:o==="array"?Array.isArray(s):o==="object"?s&&!Array.isArray(s)&&typeof s=="object":o===typeof s)}function be(s,r){return s.kind==="array"&&r.kind==="array"?s.itemType.kind===r.itemType.kind&&typeof s.N=="number":s.kind===r.kind}const he=.96422,Ee=.82521,Fe=4/29,Ce=6/29,Ge=3*Ce*Ce,dt=Ce*Ce*Ce,mt=Math.PI/180,Vt=180/Math.PI;function kt(s){return(s%=360)<0&&(s+=360),s}function Nt([s,r,o,c]){let g,v;const x=Rn((.2225045*(s=Dt(s))+.7168786*(r=Dt(r))+.0606169*(o=Dt(o)))/1);s===r&&r===o?g=v=x:(g=Rn((.4360747*s+.3850649*r+.1430804*o)/he),v=Rn((.0139322*s+.0971045*r+.7141733*o)/Ee));const b=116*x-16;return[b<0?0:b,500*(g-x),200*(x-v),c]}function Dt(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Rn(s){return s>dt?Math.pow(s,1/3):s/Ge+Fe}function yn([s,r,o,c]){let g=(s+16)/116,v=isNaN(r)?g:g+r/500,x=isNaN(o)?g:g-o/200;return g=1*Zt(g),v=he*Zt(v),x=Ee*Zt(x),[At(3.1338561*v-1.6168667*g-.4906146*x),At(-.9787684*v+1.9161415*g+.033454*x),At(.0719453*v-.2289914*g+1.4052427*x),c]}function At(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function Zt(s){return s>Ce?s*s*s:Ge*(s-Fe)}function pn(s){return parseInt(s.padEnd(2,s),16)/255}function Wn(s,r){return Qn(r?s/100:s,0,1)}function Qn(s,r,o){return Math.min(Math.max(r,s),o)}function vr(s){return!s.some(Number.isNaN)}const Go={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ht{constructor(r,o,c,g=1,v=!0){this.r=r,this.g=o,this.b=c,this.a=g,v||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[r,o,c,g]))}static parse(r){if(r instanceof Ht)return r;if(typeof r!="string")return;const o=function(c){if((c=c.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=Go[c];if(g){const[x,b,S]=g;return[x/255,b/255,S/255,1]}if(c.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(c)){const x=c.length<6?1:2;let b=1;return[pn(c.slice(b,b+=x)),pn(c.slice(b,b+=x)),pn(c.slice(b,b+=x)),pn(c.slice(b,b+x)||"ff")]}if(c.startsWith("rgb")){const x=c.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[b,S,P,M,R,B,N,q,W,te,oe,Se]=x,pe=[M||" ",N||" ",te].join("");if(pe==="  "||pe==="  /"||pe===",,"||pe===",,,"){const xe=[P,B,W].join(""),Pe=xe==="%%%"?100:xe===""?255:0;if(Pe){const Be=[Qn(+S/Pe,0,1),Qn(+R/Pe,0,1),Qn(+q/Pe,0,1),oe?Wn(+oe,Se):1];if(vr(Be))return Be}}return}}const v=c.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[x,b,S,P,M,R,B,N,q]=v,W=[S||" ",M||" ",B].join("");if(W==="  "||W==="  /"||W===",,"||W===",,,"){const te=[+b,Qn(+P,0,100),Qn(+R,0,100),N?Wn(+N,q):1];if(vr(te))return function([oe,Se,pe,xe]){function Pe(Be){const tt=(Be+oe/30)%12,gt=Se*Math.min(pe,1-pe);return pe-gt*Math.max(-1,Math.min(tt-3,9-tt,1))}return oe=kt(oe),Se/=100,pe/=100,[Pe(0),Pe(8),Pe(4),xe]}(te)}}}(r);return o?new Ht(...o,!1):void 0}get rgb(){const{r,g:o,b:c,a:g}=this,v=g||1/0;return this.overwriteGetter("rgb",[r/v,o/v,c/v,g])}get hcl(){return this.overwriteGetter("hcl",function(r){const[o,c,g,v]=Nt(r),x=Math.sqrt(c*c+g*g);return[Math.round(1e4*x)?kt(Math.atan2(g,c)*Vt):NaN,x,o,v]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Nt(this.rgb))}overwriteGetter(r,o){return Object.defineProperty(this,r,{value:o}),o}toString(){const[r,o,c,g]=this.rgb;return`rgba(${[r,o,c].map(v=>Math.round(255*v)).join(",")},${g})`}}Ht.black=new Ht(0,0,0,1),Ht.white=new Ht(1,1,1,1),Ht.transparent=new Ht(0,0,0,0),Ht.red=new Ht(1,0,0,1);class Yc{constructor(r,o,c){this.sensitivity=r?o?"variant":"case":o?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,o){return this.collator.compare(r,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Jc{constructor(r,o,c,g,v){this.text=r,this.image=o,this.scale=c,this.fontStack=g,this.textColor=v}}class Zr{constructor(r){this.sections=r}static fromString(r){return new Zr([new Jc(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof Zr?r:Zr.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}}class Hr{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Hr)return r;if(typeof r=="number")return new Hr([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const o of r)if(typeof o!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new Hr(r)}}toString(){return JSON.stringify(this.values)}}const dy=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ui{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof ui)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let o=0;o<r.length;o+=2){const c=r[o],g=r[o+1];if(typeof c!="string"||!dy.has(c)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new ui(r)}}toString(){return JSON.stringify(this.values)}}class Xr{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new Xr({name:r,available:!1}):null}}function Wo(s,r,o,c){return typeof s=="number"&&s>=0&&s<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof o=="number"&&o>=0&&o<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[s,r,o,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[s,r,o,c]:[s,r,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function uo(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Ht||s instanceof Yc||s instanceof Zr||s instanceof Hr||s instanceof ui||s instanceof Xr)return!0;if(Array.isArray(s)){for(const r of s)if(!uo(r))return!1;return!0}if(typeof s=="object"){for(const r in s)if(!uo(s[r]))return!1;return!0}return!1}function Ln(s){if(s===null)return Bs;if(typeof s=="string")return Mt;if(typeof s=="boolean")return vt;if(typeof s=="number")return He;if(s instanceof Ht)return Ir;if(s instanceof Yc)return Ji;if(s instanceof Zr)return ws;if(s instanceof Hr)return Os;if(s instanceof ui)return se;if(s instanceof Xr)return Qi;if(Array.isArray(s)){const r=s.length;let o;for(const c of s){const g=Ln(c);if(o){if(o===g)continue;o=Ct;break}o=g}return V(o||Ct,r)}return ki}function Qa(s){const r=typeof s;return s===null?"":r==="string"||r==="number"||r==="boolean"?String(s):s instanceof Ht||s instanceof Zr||s instanceof Hr||s instanceof ui||s instanceof Xr?s.toString():JSON.stringify(s)}class Pi{constructor(r,o){this.type=r,this.value=o}static parse(r,o){if(r.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!uo(r[1]))return o.error("invalid value");const c=r[1];let g=Ln(c);const v=o.expectedType;return g.kind!=="array"||g.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(g=v),new Pi(g,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Pn{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const tu={string:Mt,number:He,boolean:vt,object:ki};class Ei{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");let c,g=1;const v=r[0];if(v==="array"){let b,S;if(r.length>2){const P=r[1];if(typeof P!="string"||!(P in tu)||P==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=tu[P],g++}else b=Ct;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return o.error('The length argument to "array" must be a positive integer literal',2);S=r[2],g++}c=V(b,S)}else{if(!tu[v])throw new Error(`Types doesn't contain name = ${v}`);c=tu[v]}const x=[];for(;g<r.length;g++){const b=o.parse(r[g],g,Ct);if(!b)return null;x.push(b)}return new Ei(c,x)}evaluate(r){for(let o=0;o<this.args.length;o++){const c=this.args[o].evaluate(r);if(!re(this.type,Ln(c)))return c;if(o===this.args.length-1)throw new Pn(`Expected value to be of type ${O(this.type)}, but found ${O(Ln(c))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const Qc={"to-boolean":vt,"to-color":Ir,"to-number":He,"to-string":Mt};class Ii{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");const c=r[0];if(!Qc[c])throw new Error(`Can't parse ${c} as it is not part of the known types`);if((c==="to-boolean"||c==="to-string")&&r.length!==2)return o.error("Expected one argument.");const g=Qc[c],v=[];for(let x=1;x<r.length;x++){const b=o.parse(r[x],x,Ct);if(!b)return null;v.push(b)}return new Ii(g,v)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let o,c;for(const g of this.args){if(o=g.evaluate(r),c=null,o instanceof Ht)return o;if(typeof o=="string"){const v=r.parseColor(o);if(v)return v}else if(Array.isArray(o)&&(c=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Wo(o[0],o[1],o[2],o[3]),!c))return new Ht(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Pn(c||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const c of this.args){o=c.evaluate(r);const g=Hr.parse(o);if(g)return g}throw new Pn(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const c of this.args){o=c.evaluate(r);const g=ui.parse(o);if(g)return g}throw new Pn(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const c of this.args){if(o=c.evaluate(r),o===null)return 0;const g=Number(o);if(!isNaN(g))return g}throw new Pn(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return Zr.fromString(Qa(this.args[0].evaluate(r)));case"resolvedImage":return Xr.fromString(Qa(this.args[0].evaluate(r)));default:return Qa(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const fy=["Unknown","Point","LineString","Polygon"];class nu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?fy[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let o=this._parseColorCache[r];return o||(o=this._parseColorCache[r]=Ht.parse(r)),o}}class co{constructor(r,o,c=[],g,v=new Yi,x=[]){this.registry=r,this.path=c,this.key=c.map(b=>`[${b}]`).join(""),this.scope=v,this.errors=x,this.expectedType=g,this._isConstant=o}parse(r,o,c,g,v={}){return o?this.concat(o,c,g)._parse(r,v):this._parse(r,v)}_parse(r,o){function c(g,v,x){return x==="assert"?new Ei(v,[g]):x==="coerce"?new Ii(v,[g]):g}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=r[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[g];if(v){let x=v.parse(r,this);if(!x)return null;if(this.expectedType){const b=this.expectedType,S=x.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||S.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(b.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(b.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(b,S))return null}else x=c(x,b,o.typeAnnotation||"coerce");else x=c(x,b,o.typeAnnotation||"coerce");else x=c(x,b,o.typeAnnotation||"coerce");else x=c(x,b,o.typeAnnotation||"assert")}if(!(x instanceof Pi)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const b=new nu;try{x=new Pi(x.type,x.evaluate(b))}catch(S){return this.error(S.message),null}}return x}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,o,c){const g=typeof r=="number"?this.path.concat(r):this.path,v=c?this.scope.concat(c):this.scope;return new co(this.registry,this._isConstant,g,o||null,v,this.errors)}error(r,...o){const c=`${this.key}${o.map(g=>`[${g}]`).join("")}`;this.errors.push(new _r(c,r))}checkSubtype(r,o){const c=re(r,o);return c&&this.error(c),c}}class Vs{constructor(r,o){this.type=o.type,this.bindings=[].concat(r),this.result=o}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const o of this.bindings)r(o[1]);r(this.result)}static parse(r,o){if(r.length<4)return o.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const c=[];for(let v=1;v<r.length-1;v+=2){const x=r[v];if(typeof x!="string")return o.error(`Expected string, but found ${typeof x} instead.`,v);if(/[^a-zA-Z0-9_]/.test(x))return o.error("Variable names must contain only alphanumeric characters or '_'.",v);const b=o.parse(r[v+1],v+1);if(!b)return null;c.push([x,b])}const g=o.parse(r[r.length-1],r.length-1,o.expectedType,c);return g?new Vs(c,g):null}outputDefined(){return this.result.outputDefined()}}class qt{constructor(r,o){this.type=o.type,this.name=r,this.boundExpression=o}static parse(r,o){if(r.length!==2||typeof r[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const c=r[1];return o.scope.has(c)?new qt(c,o.scope.get(c)):o.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class eh{constructor(r,o,c){this.type=r,this.index=o,this.input=c}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=o.parse(r[1],1,He),g=o.parse(r[2],2,V(o.expectedType||Ct));return c&&g?new eh(g.type.itemType,c,g):null}evaluate(r){const o=this.index.evaluate(r),c=this.input.evaluate(r);if(o<0)throw new Pn(`Array index out of bounds: ${o} < 0.`);if(o>=c.length)throw new Pn(`Array index out of bounds: ${o} > ${c.length-1}.`);if(o!==Math.floor(o))throw new Pn(`Array index must be an integer, but found ${o} instead.`);return c[o]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class th{constructor(r,o){this.type=vt,this.needle=r,this.haystack=o}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=o.parse(r[1],1,Ct),g=o.parse(r[2],2,Ct);return c&&g?me(c.type,[vt,Mt,He,Bs,Ct])?new th(c,g):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${O(c.type)} instead`):null}evaluate(r){const o=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(!c)return!1;if(!_e(o,["boolean","string","number","null"]))throw new Pn(`Expected first argument to be of type boolean, string, number or null, but found ${O(Ln(o))} instead.`);if(!_e(c,["string","array"]))throw new Pn(`Expected second argument to be of type array or string, but found ${O(Ln(c))} instead.`);return c.indexOf(o)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class Zo{constructor(r,o,c){this.type=He,this.needle=r,this.haystack=o,this.fromIndex=c}static parse(r,o){if(r.length<=2||r.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=o.parse(r[1],1,Ct),g=o.parse(r[2],2,Ct);if(!c||!g)return null;if(!me(c.type,[vt,Mt,He,Bs,Ct]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${O(c.type)} instead`);if(r.length===4){const v=o.parse(r[3],3,He);return v?new Zo(c,g,v):null}return new Zo(c,g)}evaluate(r){const o=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(!_e(o,["boolean","string","number","null"]))throw new Pn(`Expected first argument to be of type boolean, string, number or null, but found ${O(Ln(o))} instead.`);let g;if(this.fromIndex&&(g=this.fromIndex.evaluate(r)),_e(c,["string"])){const v=c.indexOf(o,g);return v===-1?-1:[...c.slice(0,v)].length}if(_e(c,["array"]))return c.indexOf(o,g);throw new Pn(`Expected second argument to be of type array or string, but found ${O(Ln(c))} instead.`)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class nh{constructor(r,o,c,g,v,x){this.inputType=r,this.type=o,this.input=c,this.cases=g,this.outputs=v,this.otherwise=x}static parse(r,o){if(r.length<5)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return o.error("Expected an even number of arguments.");let c,g;o.expectedType&&o.expectedType.kind!=="value"&&(g=o.expectedType);const v={},x=[];for(let P=2;P<r.length-1;P+=2){let M=r[P];const R=r[P+1];Array.isArray(M)||(M=[M]);const B=o.concat(P);if(M.length===0)return B.error("Expected at least one branch label.");for(const q of M){if(typeof q!="number"&&typeof q!="string")return B.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return B.error("Numeric branch labels must be integer values.");if(c){if(B.checkSubtype(c,Ln(q)))return null}else c=Ln(q);if(v[String(q)]!==void 0)return B.error("Branch labels must be unique.");v[String(q)]=x.length}const N=o.parse(R,P,g);if(!N)return null;g=g||N.type,x.push(N)}const b=o.parse(r[1],1,Ct);if(!b)return null;const S=o.parse(r[r.length-1],r.length-1,g);return S?b.type.kind!=="value"&&o.concat(1).checkSubtype(c,b.type)?null:new nh(c,g,b,v,x,S):null}evaluate(r){const o=this.input.evaluate(r);return(Ln(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}}class ru{constructor(r,o,c){this.type=r,this.branches=o,this.otherwise=c}static parse(r,o){if(r.length<4)return o.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return o.error("Expected an odd number of arguments.");let c;o.expectedType&&o.expectedType.kind!=="value"&&(c=o.expectedType);const g=[];for(let x=1;x<r.length-1;x+=2){const b=o.parse(r[x],x,vt);if(!b)return null;const S=o.parse(r[x+1],x+1,c);if(!S)return null;g.push([b,S]),c=c||S.type}const v=o.parse(r[r.length-1],r.length-1,c);if(!v)return null;if(!c)throw new Error("Can't infer output type");return new ru(c,g,v)}evaluate(r){for(const[o,c]of this.branches)if(o.evaluate(r))return c.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[o,c]of this.branches)r(o),r(c);r(this.otherwise)}outputDefined(){return this.branches.every(([r,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class el{constructor(r,o,c,g){this.type=r,this.input=o,this.beginIndex=c,this.endIndex=g}static parse(r,o){if(r.length<=2||r.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=o.parse(r[1],1,Ct),g=o.parse(r[2],2,He);if(!c||!g)return null;if(!me(c.type,[V(Ct),Mt,Ct]))return o.error(`Expected first argument to be of type array or string, but found ${O(c.type)} instead`);if(r.length===4){const v=o.parse(r[3],3,He);return v?new el(c.type,c,g,v):null}return new el(c.type,c,g)}evaluate(r){const o=this.input.evaluate(r),c=this.beginIndex.evaluate(r);let g;if(this.endIndex&&(g=this.endIndex.evaluate(r)),_e(o,["string"]))return[...o].slice(c,g).join("");if(_e(o,["array"]))return o.slice(c,g);throw new Pn(`Expected first argument to be of type array or string, but found ${O(Ln(o))} instead.`)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function iu(s,r){const o=s.length-1;let c,g,v=0,x=o,b=0;for(;v<=x;)if(b=Math.floor((v+x)/2),c=s[b],g=s[b+1],c<=r){if(b===o||r<g)return b;v=b+1}else{if(!(c>r))throw new Pn("Input is not a number.");x=b-1}return 0}class Ho{constructor(r,o,c){this.type=r,this.input=o,this.labels=[],this.outputs=[];for(const[g,v]of c)this.labels.push(g),this.outputs.push(v)}static parse(r,o){if(r.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return o.error("Expected an even number of arguments.");const c=o.parse(r[1],1,He);if(!c)return null;const g=[];let v=null;o.expectedType&&o.expectedType.kind!=="value"&&(v=o.expectedType);for(let x=1;x<r.length;x+=2){const b=x===1?-1/0:r[x],S=r[x+1],P=x,M=x+1;if(typeof b!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(g.length&&g[g.length-1][0]>=b)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const R=o.parse(S,M,v);if(!R)return null;v=v||R.type,g.push([b,R])}return new Ho(v,c,g)}evaluate(r){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(r);const g=this.input.evaluate(r);if(g<=o[0])return c[0].evaluate(r);const v=o.length;return g>=o[v-1]?c[v-1].evaluate(r):c[iu(o,g)].evaluate(r)}eachChild(r){r(this.input);for(const o of this.outputs)r(o)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function Af(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var py=zf;function zf(s,r,o,c){this.cx=3*s,this.bx=3*(o-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(c-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=r,this.p2x=o,this.p2y=c}zf.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,r){if(r===void 0&&(r=1e-6),s<0)return 0;if(s>1)return 1;for(var o=s,c=0;c<8;c++){var g=this.sampleCurveX(o)-s;if(Math.abs(g)<r)return o;var v=this.sampleCurveDerivativeX(o);if(Math.abs(v)<1e-6)break;o-=g/v}var x=0,b=1;for(o=s,c=0;c<20&&(g=this.sampleCurveX(o),!(Math.abs(g-s)<r));c++)s>g?x=o:b=o,o=.5*(b-x)+x;return o},solve:function(s,r){return this.sampleCurveY(this.solveCurveX(s,r))}};var my=Af(py);function ho(s,r,o){return s+o*(r-s)}function tl(s,r,o){return s.map((c,g)=>ho(c,r[g],o))}const Mr={number:ho,color:function(s,r,o,c="rgb"){switch(c){case"rgb":{const[g,v,x,b]=tl(s.rgb,r.rgb,o);return new Ht(g,v,x,b,!1)}case"hcl":{const[g,v,x,b]=s.hcl,[S,P,M,R]=r.hcl;let B,N;if(isNaN(g)||isNaN(S))isNaN(g)?isNaN(S)?B=NaN:(B=S,x!==1&&x!==0||(N=P)):(B=g,M!==1&&M!==0||(N=v));else{let Se=S-g;S>g&&Se>180?Se-=360:S<g&&g-S>180&&(Se+=360),B=g+o*Se}const[q,W,te,oe]=function([Se,pe,xe,Pe]){return Se=isNaN(Se)?0:Se*mt,yn([xe,Math.cos(Se)*pe,Math.sin(Se)*pe,Pe])}([B,N??ho(v,P,o),ho(x,M,o),ho(b,R,o)]);return new Ht(q,W,te,oe,!1)}case"lab":{const[g,v,x,b]=yn(tl(s.lab,r.lab,o));return new Ht(g,v,x,b,!1)}}},array:tl,padding:function(s,r,o){return new Hr(tl(s.values,r.values,o))},variableAnchorOffsetCollection:function(s,r,o){const c=s.values,g=r.values;if(c.length!==g.length)throw new Pn(`Cannot interpolate values of different length. from: ${s.toString()}, to: ${r.toString()}`);const v=[];for(let x=0;x<c.length;x+=2){if(c[x]!==g[x])throw new Pn(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${c[x]}, to[${x}]: ${g[x]}`);v.push(c[x]);const[b,S]=c[x+1],[P,M]=g[x+1];v.push([ho(b,P,o),ho(S,M,o)])}return new ui(v)}};class Ar{constructor(r,o,c,g,v){this.type=r,this.operator=o,this.interpolation=c,this.input=g,this.labels=[],this.outputs=[];for(const[x,b]of v)this.labels.push(x),this.outputs.push(b)}static interpolationFactor(r,o,c,g){let v=0;if(r.name==="exponential")v=su(o,r.base,c,g);else if(r.name==="linear")v=su(o,1,c,g);else if(r.name==="cubic-bezier"){const x=r.controlPoints;v=new my(x[0],x[1],x[2],x[3]).solve(su(o,1,c,g))}return v}static parse(r,o){let[c,g,v,...x]=r;if(!Array.isArray(g)||g.length===0)return o.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const P=g[1];if(typeof P!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:P}}else{if(g[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const P=g.slice(1);if(P.length!==4||P.some(M=>typeof M!="number"||M<0||M>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:P}}}if(r.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(v=o.parse(v,2,He),!v)return null;const b=[];let S=null;c==="interpolate-hcl"||c==="interpolate-lab"?S=Ir:o.expectedType&&o.expectedType.kind!=="value"&&(S=o.expectedType);for(let P=0;P<x.length;P+=2){const M=x[P],R=x[P+1],B=P+3,N=P+4;if(typeof M!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(b.length&&b[b.length-1][0]>=M)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const q=o.parse(R,N,S);if(!q)return null;S=S||q.type,b.push([M,q])}return be(S,He)||be(S,Ir)||be(S,Os)||be(S,se)||be(S,V(He))?new Ar(S,c,g,v,b):o.error(`Type ${O(S)} is not interpolatable.`)}evaluate(r){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(r);const g=this.input.evaluate(r);if(g<=o[0])return c[0].evaluate(r);const v=o.length;if(g>=o[v-1])return c[v-1].evaluate(r);const x=iu(o,g),b=Ar.interpolationFactor(this.interpolation,g,o[x],o[x+1]),S=c[x].evaluate(r),P=c[x+1].evaluate(r);switch(this.operator){case"interpolate":return Mr[this.type.kind](S,P,b);case"interpolate-hcl":return Mr.color(S,P,b,"hcl");case"interpolate-lab":return Mr.color(S,P,b,"lab")}}eachChild(r){r(this.input);for(const o of this.outputs)r(o)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function su(s,r,o,c){const g=c-o,v=s-o;return g===0?0:r===1?v/g:(Math.pow(r,v)-1)/(Math.pow(r,g)-1)}class ou{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expectected at least one argument.");let c=null;const g=o.expectedType;g&&g.kind!=="value"&&(c=g);const v=[];for(const b of r.slice(1)){const S=o.parse(b,1+v.length,c,void 0,{typeAnnotation:"omit"});if(!S)return null;c=c||S.type,v.push(S)}if(!c)throw new Error("No output type");const x=g&&v.some(b=>re(g,b.type));return new ou(x?Ct:c,v)}evaluate(r){let o,c=null,g=0;for(const v of this.args)if(g++,c=v.evaluate(r),c&&c instanceof Xr&&!c.available&&(o||(o=c.name),c=null,g===this.args.length&&(c=o)),c!==null)break;return c}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}function au(s,r){return s==="=="||s==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function Df(s,r,o,c){return c.compare(r,o)===0}function Xo(s,r,o){const c=s!=="=="&&s!=="!=";return class WE{constructor(v,x,b){this.type=vt,this.lhs=v,this.rhs=x,this.collator=b,this.hasUntypedArgument=v.type.kind==="value"||x.type.kind==="value"}static parse(v,x){if(v.length!==3&&v.length!==4)return x.error("Expected two or three arguments.");const b=v[0];let S=x.parse(v[1],1,Ct);if(!S)return null;if(!au(b,S.type))return x.concat(1).error(`"${b}" comparisons are not supported for type '${O(S.type)}'.`);let P=x.parse(v[2],2,Ct);if(!P)return null;if(!au(b,P.type))return x.concat(2).error(`"${b}" comparisons are not supported for type '${O(P.type)}'.`);if(S.type.kind!==P.type.kind&&S.type.kind!=="value"&&P.type.kind!=="value")return x.error(`Cannot compare types '${O(S.type)}' and '${O(P.type)}'.`);c&&(S.type.kind==="value"&&P.type.kind!=="value"?S=new Ei(P.type,[S]):S.type.kind!=="value"&&P.type.kind==="value"&&(P=new Ei(S.type,[P])));let M=null;if(v.length===4){if(S.type.kind!=="string"&&P.type.kind!=="string"&&S.type.kind!=="value"&&P.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(M=x.parse(v[3],3,Ji),!M)return null}return new WE(S,P,M)}evaluate(v){const x=this.lhs.evaluate(v),b=this.rhs.evaluate(v);if(c&&this.hasUntypedArgument){const S=Ln(x),P=Ln(b);if(S.kind!==P.kind||S.kind!=="string"&&S.kind!=="number")throw new Pn(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${S.kind}, ${P.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const S=Ln(x),P=Ln(b);if(S.kind!=="string"||P.kind!=="string")return r(v,x,b)}return this.collator?o(v,x,b,this.collator.evaluate(v)):r(v,x,b)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const gy=Xo("==",function(s,r,o){return r===o},Df),Rf=Xo("!=",function(s,r,o){return r!==o},function(s,r,o,c){return!Df(0,r,o,c)}),Lf=Xo("<",function(s,r,o){return r<o},function(s,r,o,c){return c.compare(r,o)<0}),yy=Xo(">",function(s,r,o){return r>o},function(s,r,o,c){return c.compare(r,o)>0}),_y=Xo("<=",function(s,r,o){return r<=o},function(s,r,o,c){return c.compare(r,o)<=0}),Ff=Xo(">=",function(s,r,o){return r>=o},function(s,r,o,c){return c.compare(r,o)>=0});class nl{constructor(r,o,c){this.type=Ji,this.locale=c,this.caseSensitive=r,this.diacriticSensitive=o}static parse(r,o){if(r.length!==2)return o.error("Expected one argument.");const c=r[1];if(typeof c!="object"||Array.isArray(c))return o.error("Collator options argument must be an object.");const g=o.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,vt);if(!g)return null;const v=o.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,vt);if(!v)return null;let x=null;return c.locale&&(x=o.parse(c.locale,1,Mt),!x)?null:new nl(g,v,x)}evaluate(r){return new Yc(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class rh{constructor(r,o,c,g,v){this.type=Mt,this.number=r,this.locale=o,this.currency=c,this.minFractionDigits=g,this.maxFractionDigits=v}static parse(r,o){if(r.length!==3)return o.error("Expected two arguments.");const c=o.parse(r[1],1,He);if(!c)return null;const g=r[2];if(typeof g!="object"||Array.isArray(g))return o.error("NumberFormat options argument must be an object.");let v=null;if(g.locale&&(v=o.parse(g.locale,1,Mt),!v))return null;let x=null;if(g.currency&&(x=o.parse(g.currency,1,Mt),!x))return null;let b=null;if(g["min-fraction-digits"]&&(b=o.parse(g["min-fraction-digits"],1,He),!b))return null;let S=null;return g["max-fraction-digits"]&&(S=o.parse(g["max-fraction-digits"],1,He),!S)?null:new rh(c,v,x,b,S)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class lu{constructor(r){this.type=ws,this.sections=r}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");const c=r[1];if(!Array.isArray(c)&&typeof c=="object")return o.error("First argument must be an image or text section.");const g=[];let v=!1;for(let x=1;x<=r.length-1;++x){const b=r[x];if(v&&typeof b=="object"&&!Array.isArray(b)){v=!1;let S=null;if(b["font-scale"]&&(S=o.parse(b["font-scale"],1,He),!S))return null;let P=null;if(b["text-font"]&&(P=o.parse(b["text-font"],1,V(Mt)),!P))return null;let M=null;if(b["text-color"]&&(M=o.parse(b["text-color"],1,Ir),!M))return null;const R=g[g.length-1];R.scale=S,R.font=P,R.textColor=M}else{const S=o.parse(r[x],1,Ct);if(!S)return null;const P=S.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,g.push({content:S,scale:null,font:null,textColor:null})}}return new lu(g)}evaluate(r){return new Zr(this.sections.map(o=>{const c=o.content.evaluate(r);return Ln(c)===Qi?new Jc("",c,null,null,null):new Jc(Qa(c),null,o.scale?o.scale.evaluate(r):null,o.font?o.font.evaluate(r).join(","):null,o.textColor?o.textColor.evaluate(r):null)}))}eachChild(r){for(const o of this.sections)r(o.content),o.scale&&r(o.scale),o.font&&r(o.font),o.textColor&&r(o.textColor)}outputDefined(){return!1}}class ih{constructor(r){this.type=Qi,this.input=r}static parse(r,o){if(r.length!==2)return o.error("Expected two arguments.");const c=o.parse(r[1],1,Mt);return c?new ih(c):o.error("No image name provided.")}evaluate(r){const o=this.input.evaluate(r),c=Xr.fromString(o);return c&&r.availableImages&&(c.available=r.availableImages.indexOf(o)>-1),c}eachChild(r){r(this.input)}outputDefined(){return!1}}class sh{constructor(r){this.type=He,this.input=r}static parse(r,o){if(r.length!==2)return o.error(`Expected 1 argument, but found ${r.length-1} instead.`);const c=o.parse(r[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${O(c.type)} instead.`):new sh(c):null}evaluate(r){const o=this.input.evaluate(r);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new Pn(`Expected value to be of type string or array, but found ${O(Ln(o))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const es=8192;function vy(s,r){const o=(180+s[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,g=Math.pow(2,r.z);return[Math.round(o*g*es),Math.round(c*g*es)]}function oh(s,r){const o=Math.pow(2,r.z);return[(g=(s[0]/es+r.x)/o,360*g-180),(c=(s[1]/es+r.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90)];var c,g}function fo(s,r){s[0]=Math.min(s[0],r[0]),s[1]=Math.min(s[1],r[1]),s[2]=Math.max(s[2],r[0]),s[3]=Math.max(s[3],r[1])}function Ns(s,r){return!(s[0]<=r[0]||s[2]>=r[2]||s[1]<=r[1]||s[3]>=r[3])}function Gt(s,r,o){const c=s[0]-r[0],g=s[1]-r[1],v=s[0]-o[0],x=s[1]-o[1];return c*x-v*g==0&&c*v<=0&&g*x<=0}function uu(s,r,o,c){return(g=[c[0]-o[0],c[1]-o[1]])[0]*(v=[r[0]-s[0],r[1]-s[1]])[1]-g[1]*v[0]!=0&&!(!Of(s,r,o,c)||!Of(o,c,s,r));var g,v}function xy(s,r,o){for(const c of o)for(let g=0;g<c.length-1;++g)if(uu(s,r,c[g],c[g+1]))return!0;return!1}function Ko(s,r,o=!1){let c=!1;for(const b of r)for(let S=0;S<b.length-1;S++){if(Gt(s,b[S],b[S+1]))return o;(v=b[S])[1]>(g=s)[1]!=(x=b[S+1])[1]>g[1]&&g[0]<(x[0]-v[0])*(g[1]-v[1])/(x[1]-v[1])+v[0]&&(c=!c)}var g,v,x;return c}function by(s,r){for(const o of r)if(Ko(s,o))return!0;return!1}function Bf(s,r){for(const o of s)if(!Ko(o,r))return!1;for(let o=0;o<s.length-1;++o)if(xy(s[o],s[o+1],r))return!1;return!0}function wy(s,r){for(const o of r)if(Bf(s,o))return!0;return!1}function Of(s,r,o,c){const g=c[0]-o[0],v=c[1]-o[1],x=(s[0]-o[0])*v-g*(s[1]-o[1]),b=(r[0]-o[0])*v-g*(r[1]-o[1]);return x>0&&b<0||x<0&&b>0}function ah(s,r,o){const c=[];for(let g=0;g<s.length;g++){const v=[];for(let x=0;x<s[g].length;x++){const b=vy(s[g][x],o);fo(r,b),v.push(b)}c.push(v)}return c}function Vf(s,r,o){const c=[];for(let g=0;g<s.length;g++){const v=ah(s[g],r,o);c.push(v)}return c}function Nf(s,r,o,c){if(s[0]<o[0]||s[0]>o[2]){const g=.5*c;let v=s[0]-o[0]>g?-c:o[0]-s[0]>g?c:0;v===0&&(v=s[0]-o[2]>g?-c:o[2]-s[0]>g?c:0),s[0]+=v}fo(r,s)}function jf(s,r,o,c){const g=Math.pow(2,c.z)*es,v=[c.x*es,c.y*es],x=[];for(const b of s)for(const S of b){const P=[S.x+v[0],S.y+v[1]];Nf(P,r,o,g),x.push(P)}return x}function $f(s,r,o,c){const g=Math.pow(2,c.z)*es,v=[c.x*es,c.y*es],x=[];for(const S of s){const P=[];for(const M of S){const R=[M.x+v[0],M.y+v[1]];fo(r,R),P.push(R)}x.push(P)}if(r[2]-r[0]<=g/2){(b=r)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const S of x)for(const P of S)Nf(P,r,o,g)}var b;return x}class po{constructor(r,o){this.type=vt,this.geojson=r,this.geometries=o}static parse(r,o){if(r.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(uo(r[1])){const c=r[1];if(c.type==="FeatureCollection"){const g=[];for(const v of c.features){const{type:x,coordinates:b}=v.geometry;x==="Polygon"&&g.push(b),x==="MultiPolygon"&&g.push(...b)}if(g.length)return new po(c,{type:"MultiPolygon",coordinates:g})}else if(c.type==="Feature"){const g=c.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new po(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new po(c,c)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(o,c){const g=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(c.type==="Polygon"){const b=ah(c.coordinates,v,x),S=jf(o.geometry(),g,v,x);if(!Ns(g,v))return!1;for(const P of S)if(!Ko(P,b))return!1}if(c.type==="MultiPolygon"){const b=Vf(c.coordinates,v,x),S=jf(o.geometry(),g,v,x);if(!Ns(g,v))return!1;for(const P of S)if(!by(P,b))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(o,c){const g=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(c.type==="Polygon"){const b=ah(c.coordinates,v,x),S=$f(o.geometry(),g,v,x);if(!Ns(g,v))return!1;for(const P of S)if(!Bf(P,b))return!1}if(c.type==="MultiPolygon"){const b=Vf(c.coordinates,v,x),S=$f(o.geometry(),g,v,x);if(!Ns(g,v))return!1;for(const P of S)if(!wy(P,b))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Uf=class{constructor(s=[],r=(o,c)=>o<c?-1:o>c?1:0){if(this.data=s,this.length=this.data.length,this.compare=r,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:r,compare:o}=this,c=r[s];for(;s>0;){const g=s-1>>1,v=r[g];if(o(c,v)>=0)break;r[s]=v,s=g}r[s]=c}_down(s){const{data:r,compare:o}=this,c=this.length>>1,g=r[s];for(;s<c;){let v=1+(s<<1);const x=v+1;if(x<this.length&&o(r[x],r[v])<0&&(v=x),o(r[v],g)>=0)break;r[s]=r[v],s=v}r[s]=g}};function Sy(s,r,o,c,g){qf(s,r,o,c||s.length-1,g||Ty)}function qf(s,r,o,c,g){for(;c>o;){if(c-o>600){var v=c-o+1,x=r-o+1,b=Math.log(v),S=.5*Math.exp(2*b/3),P=.5*Math.sqrt(b*S*(v-S)/v)*(x-v/2<0?-1:1);qf(s,r,Math.max(o,Math.floor(r-x*S/v+P)),Math.min(c,Math.floor(r+(v-x)*S/v+P)),g)}var M=s[r],R=o,B=c;for(rl(s,o,r),g(s[c],M)>0&&rl(s,o,c);R<B;){for(rl(s,R,B),R++,B--;g(s[R],M)<0;)R++;for(;g(s[B],M)>0;)B--}g(s[o],M)===0?rl(s,o,B):rl(s,++B,c),B<=r&&(o=B+1),r<=B&&(c=B-1)}}function rl(s,r,o){var c=s[r];s[r]=s[o],s[o]=c}function Ty(s,r){return s<r?-1:s>r?1:0}function cu(s,r){if(s.length<=1)return[s];const o=[];let c,g;for(const v of s){const x=ky(v);x!==0&&(v.area=Math.abs(x),g===void 0&&(g=x<0),g===x<0?(c&&o.push(c),c=[v]):c.push(v))}if(c&&o.push(c),r>1)for(let v=0;v<o.length;v++)o[v].length<=r||(Sy(o[v],r,1,o[v].length-1,Cy),o[v]=o[v].slice(0,r));return o}function Cy(s,r){return r.area-s.area}function ky(s){let r=0;for(let o,c,g=0,v=s.length,x=v-1;g<v;x=g++)o=s[g],c=s[x],r+=(c.x-o.x)*(o.y+c.y);return r}const Gf=1/298.257223563,Wf=Gf*(2-Gf),Zf=Math.PI/180;class lh{constructor(r){const o=6378.137*Zf*1e3,c=Math.cos(r*Zf),g=1/(1-Wf*(1-c*c)),v=Math.sqrt(g);this.kx=o*v*c,this.ky=o*v*g*(1-Wf)}distance(r,o){const c=this.wrap(r[0]-o[0])*this.kx,g=(r[1]-o[1])*this.ky;return Math.sqrt(c*c+g*g)}pointOnLine(r,o){let c,g,v,x,b=1/0;for(let S=0;S<r.length-1;S++){let P=r[S][0],M=r[S][1],R=this.wrap(r[S+1][0]-P)*this.kx,B=(r[S+1][1]-M)*this.ky,N=0;R===0&&B===0||(N=(this.wrap(o[0]-P)*this.kx*R+(o[1]-M)*this.ky*B)/(R*R+B*B),N>1?(P=r[S+1][0],M=r[S+1][1]):N>0&&(P+=R/this.kx*N,M+=B/this.ky*N)),R=this.wrap(o[0]-P)*this.kx,B=(o[1]-M)*this.ky;const q=R*R+B*B;q<b&&(b=q,c=P,g=M,v=S,x=N)}return{point:[c,g],index:v,t:Math.max(0,Math.min(1,x))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function Hf(s,r){return r[0]-s[0]}function hu(s){return s[1]-s[0]+1}function Ss(s,r){return s[1]>=s[0]&&s[1]<r}function uh(s,r){if(s[0]>s[1])return[null,null];const o=hu(s);if(r){if(o===2)return[s,null];const g=Math.floor(o/2);return[[s[0],s[0]+g],[s[0]+g,s[1]]]}if(o===1)return[s,null];const c=Math.floor(o/2)-1;return[[s[0],s[0]+c],[s[0]+c+1,s[1]]]}function ch(s,r){if(!Ss(r,s.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let c=r[0];c<=r[1];++c)fo(o,s[c]);return o}function hh(s){const r=[1/0,1/0,-1/0,-1/0];for(const o of s)for(const c of o)fo(r,c);return r}function du(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function dh(s,r,o){if(!du(s)||!du(r))return NaN;let c=0,g=0;return s[2]<r[0]&&(c=r[0]-s[2]),s[0]>r[2]&&(c=s[0]-r[2]),s[1]>r[3]&&(g=s[1]-r[3]),s[3]<r[1]&&(g=r[1]-s[3]),o.distance([0,0],[c,g])}function mo(s,r,o){const c=o.pointOnLine(r,s);return o.distance(s,c.point)}function fh(s,r,o,c,g){const v=Math.min(mo(s,[o,c],g),mo(r,[o,c],g)),x=Math.min(mo(o,[s,r],g),mo(c,[s,r],g));return Math.min(v,x)}function Py(s,r,o,c,g){if(!Ss(r,s.length)||!Ss(c,o.length))return 1/0;let v=1/0;for(let x=r[0];x<r[1];++x){const b=s[x],S=s[x+1];for(let P=c[0];P<c[1];++P){const M=o[P],R=o[P+1];if(uu(b,S,M,R))return 0;v=Math.min(v,fh(b,S,M,R,g))}}return v}function bn(s,r,o,c,g){if(!Ss(r,s.length)||!Ss(c,o.length))return NaN;let v=1/0;for(let x=r[0];x<=r[1];++x)for(let b=c[0];b<=c[1];++b)if(v=Math.min(v,g.distance(s[x],o[b])),v===0)return v;return v}function Ey(s,r,o){if(Ko(s,r,!0))return 0;let c=1/0;for(const g of r){const v=g[0],x=g[g.length-1];if(v!==x&&(c=Math.min(c,mo(s,[x,v],o)),c===0))return c;const b=o.pointOnLine(g,s);if(c=Math.min(c,o.distance(s,b.point)),c===0)return c}return c}function zt(s,r,o,c){if(!Ss(r,s.length))return NaN;for(let v=r[0];v<=r[1];++v)if(Ko(s[v],o,!0))return 0;let g=1/0;for(let v=r[0];v<r[1];++v){const x=s[v],b=s[v+1];for(const S of o)for(let P=0,M=S.length,R=M-1;P<M;R=P++){const B=S[R],N=S[P];if(uu(x,b,B,N))return 0;g=Math.min(g,fh(x,b,B,N,c))}}return g}function fu(s,r){for(const o of s)for(const c of o)if(Ko(c,r,!0))return!0;return!1}function tn(s,r,o,c=1/0){const g=hh(s),v=hh(r);if(c!==1/0&&dh(g,v,o)>=c)return c;if(Ns(g,v)){if(fu(s,r))return 0}else if(fu(r,s))return 0;let x=1/0;for(const b of s)for(let S=0,P=b.length,M=P-1;S<P;M=S++){const R=b[M],B=b[S];for(const N of r)for(let q=0,W=N.length,te=W-1;q<W;te=q++){const oe=N[te],Se=N[q];if(uu(R,B,oe,Se))return 0;x=Math.min(x,fh(R,B,oe,Se,o))}}return x}function Xt(s,r,o,c,g,v){if(!v)return;const x=dh(ch(c,v),g,o);x<r&&s.push([x,v,[0,0]])}function go(s,r,o,c,g,v,x){if(!v||!x)return;const b=dh(ch(c,v),ch(g,x),o);b<r&&s.push([b,v,x])}function il(s,r,o,c,g=1/0){let v=Math.min(c.distance(s[0],o[0][0]),g);if(v===0)return v;const x=new Uf([[0,[0,s.length-1],[0,0]]],Hf),b=hh(o);for(;x.length>0;){const S=x.pop();if(S[0]>=v)continue;const P=S[1],M=r?50:100;if(hu(P)<=M){if(!Ss(P,s.length))return NaN;if(r){const R=zt(s,P,o,c);if(isNaN(R)||R===0)return R;v=Math.min(v,R)}else for(let R=P[0];R<=P[1];++R){const B=Ey(s[R],o,c);if(v=Math.min(v,B),v===0)return 0}}else{const R=uh(P,r);Xt(x,v,c,s,b,R[0]),Xt(x,v,c,s,b,R[1])}}return v}function sl(s,r,o,c,g,v=1/0){let x=Math.min(v,g.distance(s[0],o[0]));if(x===0)return x;const b=new Uf([[0,[0,s.length-1],[0,o.length-1]]],Hf);for(;b.length>0;){const S=b.pop();if(S[0]>=x)continue;const P=S[1],M=S[2],R=r?50:100,B=c?50:100;if(hu(P)<=R&&hu(M)<=B){if(!Ss(P,s.length)&&Ss(M,o.length))return NaN;let N;if(r&&c)N=Py(s,P,o,M,g),x=Math.min(x,N);else if(r&&!c){const q=s.slice(P[0],P[1]+1);for(let W=M[0];W<=M[1];++W)if(N=mo(o[W],q,g),x=Math.min(x,N),x===0)return x}else if(!r&&c){const q=o.slice(M[0],M[1]+1);for(let W=P[0];W<=P[1];++W)if(N=mo(s[W],q,g),x=Math.min(x,N),x===0)return x}else N=bn(s,P,o,M,g),x=Math.min(x,N)}else{const N=uh(P,r),q=uh(M,c);go(b,x,g,s,o,N[0],q[0]),go(b,x,g,s,o,N[0],q[1]),go(b,x,g,s,o,N[1],q[0]),go(b,x,g,s,o,N[1],q[1])}}return x}function ph(s){return s.type==="MultiPolygon"?s.coordinates.map(r=>({type:"Polygon",coordinates:r})):s.type==="MultiLineString"?s.coordinates.map(r=>({type:"LineString",coordinates:r})):s.type==="MultiPoint"?s.coordinates.map(r=>({type:"Point",coordinates:r})):[s]}class yo{constructor(r,o){this.type=He,this.geojson=r,this.geometries=o}static parse(r,o){if(r.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(uo(r[1])){const c=r[1];if(c.type==="FeatureCollection")return new yo(c,c.features.map(g=>ph(g.geometry)).flat());if(c.type==="Feature")return new yo(c,ph(c.geometry));if("type"in c&&"coordinates"in c)return new yo(c,ph(c))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(o,c){const g=o.geometry(),v=g.flat().map(S=>oh([S.x,S.y],o.canonical));if(g.length===0)return NaN;const x=new lh(v[0][1]);let b=1/0;for(const S of c){switch(S.type){case"Point":b=Math.min(b,sl(v,!1,[S.coordinates],!1,x,b));break;case"LineString":b=Math.min(b,sl(v,!1,S.coordinates,!0,x,b));break;case"Polygon":b=Math.min(b,il(v,!1,S.coordinates,x,b))}if(b===0)return b}return b}(r,this.geometries);if(r.geometryType()==="LineString")return function(o,c){const g=o.geometry(),v=g.flat().map(S=>oh([S.x,S.y],o.canonical));if(g.length===0)return NaN;const x=new lh(v[0][1]);let b=1/0;for(const S of c){switch(S.type){case"Point":b=Math.min(b,sl(v,!0,[S.coordinates],!1,x,b));break;case"LineString":b=Math.min(b,sl(v,!0,S.coordinates,!0,x,b));break;case"Polygon":b=Math.min(b,il(v,!0,S.coordinates,x,b))}if(b===0)return b}return b}(r,this.geometries);if(r.geometryType()==="Polygon")return function(o,c){const g=o.geometry();if(g.length===0||g[0].length===0)return NaN;const v=cu(g,0).map(S=>S.map(P=>P.map(M=>oh([M.x,M.y],o.canonical)))),x=new lh(v[0][0][0][1]);let b=1/0;for(const S of c)for(const P of v){switch(S.type){case"Point":b=Math.min(b,il([S.coordinates],!1,P,x,b));break;case"LineString":b=Math.min(b,il(S.coordinates,!0,P,x,b));break;case"Polygon":b=Math.min(b,tn(P,S.coordinates,x,b))}if(b===0)return b}return b}(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Yo={"==":gy,"!=":Rf,">":yy,"<":Lf,">=":Ff,"<=":_y,array:Ei,at:eh,boolean:Ei,case:ru,coalesce:ou,collator:nl,format:lu,image:ih,in:th,"index-of":Zo,interpolate:Ar,"interpolate-hcl":Ar,"interpolate-lab":Ar,length:sh,let:Vs,literal:Pi,match:nh,number:Ei,"number-format":rh,object:Ei,slice:el,step:Ho,string:Ei,"to-boolean":Ii,"to-color":Ii,"to-number":Ii,"to-string":Ii,var:qt,within:po,distance:yo};class ci{constructor(r,o,c,g){this.name=r,this.type=o,this._evaluate=c,this.args=g}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,o){const c=r[0],g=ci.definitions[c];if(!g)return o.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(g)?g[0]:g.type,x=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,b=x.filter(([P])=>!Array.isArray(P)||P.length===r.length-1);let S=null;for(const[P,M]of b){S=new co(o.registry,ol,o.path,null,o.scope);const R=[];let B=!1;for(let N=1;N<r.length;N++){const q=r[N],W=Array.isArray(P)?P[N-1]:P.type,te=S.parse(q,1+R.length,W);if(!te){B=!0;break}R.push(te)}if(!B)if(Array.isArray(P)&&P.length!==R.length)S.error(`Expected ${P.length} arguments, but found ${R.length} instead.`);else{for(let N=0;N<R.length;N++){const q=Array.isArray(P)?P[N]:P.type,W=R[N];S.concat(N+1).checkSubtype(q,W.type)}if(S.errors.length===0)return new ci(c,v,M,R)}}if(b.length===1)o.errors.push(...S.errors);else{const P=(b.length?b:x).map(([R])=>{return B=R,Array.isArray(B)?`(${B.map(O).join(", ")})`:`(${O(B.type)}...)`;var B}).join(" | "),M=[];for(let R=1;R<r.length;R++){const B=o.parse(r[R],1+M.length);if(!B)return null;M.push(O(B.type))}o.error(`Expected arguments of type ${P}, but found (${M.join(", ")}) instead.`)}return null}static register(r,o){ci.definitions=o;for(const c in o)r[c]=ci}}function mh(s,[r,o,c,g]){r=r.evaluate(s),o=o.evaluate(s),c=c.evaluate(s);const v=g?g.evaluate(s):1,x=Wo(r,o,c,v);if(x)throw new Pn(x);return new Ht(r/255,o/255,c/255,v,!1)}function gh(s,r){return s in r}function yh(s,r){const o=r[s];return o===void 0?null:o}function _o(s){return{type:s}}function ol(s){if(s instanceof qt)return ol(s.boundExpression);if(s instanceof ci&&s.name==="error"||s instanceof nl||s instanceof po||s instanceof yo)return!1;const r=s instanceof Ii||s instanceof Ei;let o=!0;return s.eachChild(c=>{o=r?o&&ol(c):o&&c instanceof Pi}),!!o&&al(s)&&ll(s,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function al(s){if(s instanceof ci&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof po||s instanceof yo)return!1;let r=!0;return s.eachChild(o=>{r&&!al(o)&&(r=!1)}),r}function Jo(s){if(s instanceof ci&&s.name==="feature-state")return!1;let r=!0;return s.eachChild(o=>{r&&!Jo(o)&&(r=!1)}),r}function ll(s,r){if(s instanceof ci&&r.indexOf(s.name)>=0)return!1;let o=!0;return s.eachChild(c=>{o&&!ll(c,r)&&(o=!1)}),o}function pu(s){return{result:"success",value:s}}function Qo(s){return{result:"error",value:s}}function ea(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function Xf(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function _h(s){return!!s.expression&&s.expression.interpolated}function $t(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function mu(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function Iy(s){return s}function Kf(s,r){const o=r.type==="color",c=s.stops&&typeof s.stops[0][0]=="object",g=c||!(c||s.property!==void 0),v=s.type||(_h(r)?"exponential":"interval");if(o||r.type==="padding"){const M=o?Ht.parse:Hr.parse;(s=Ki({},s)).stops&&(s.stops=s.stops.map(R=>[R[0],M(R[1])])),s.default=M(s.default?s.default:r.default)}if(s.colorSpace&&(x=s.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var x;let b,S,P;if(v==="exponential")b=Jf;else if(v==="interval")b=gu;else if(v==="categorical"){b=Yf,S=Object.create(null);for(const M of s.stops)S[M[0]]=M[1];P=typeof s.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);b=Qf}if(c){const M={},R=[];for(let q=0;q<s.stops.length;q++){const W=s.stops[q],te=W[0].zoom;M[te]===void 0&&(M[te]={zoom:te,type:s.type,property:s.property,default:s.default,stops:[]},R.push(te)),M[te].stops.push([W[0].value,W[1]])}const B=[];for(const q of R)B.push([M[q].zoom,Kf(M[q],r)]);const N={name:"linear"};return{kind:"composite",interpolationType:N,interpolationFactor:Ar.interpolationFactor.bind(void 0,N),zoomStops:B.map(q=>q[0]),evaluate:({zoom:q},W)=>Jf({stops:B,base:s.base},r,q).evaluate(q,W)}}if(g){const M=v==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Ar.interpolationFactor.bind(void 0,M),zoomStops:s.stops.map(R=>R[0]),evaluate:({zoom:R})=>b(s,r,R,S,P)}}return{kind:"source",evaluate(M,R){const B=R&&R.properties?R.properties[s.property]:void 0;return B===void 0?ta(s.default,r.default):b(s,r,B,S,P)}}}function ta(s,r,o){return s!==void 0?s:r!==void 0?r:o!==void 0?o:void 0}function Yf(s,r,o,c,g){return ta(typeof o===g?c[o]:void 0,s.default,r.default)}function gu(s,r,o){if($t(o)!=="number")return ta(s.default,r.default);const c=s.stops.length;if(c===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[c-1][0])return s.stops[c-1][1];const g=iu(s.stops.map(v=>v[0]),o);return s.stops[g][1]}function Jf(s,r,o){const c=s.base!==void 0?s.base:1;if($t(o)!=="number")return ta(s.default,r.default);const g=s.stops.length;if(g===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[g-1][0])return s.stops[g-1][1];const v=iu(s.stops.map(M=>M[0]),o),x=function(M,R,B,N){const q=N-B,W=M-B;return q===0?0:R===1?W/q:(Math.pow(R,W)-1)/(Math.pow(R,q)-1)}(o,c,s.stops[v][0],s.stops[v+1][0]),b=s.stops[v][1],S=s.stops[v+1][1],P=Mr[r.type]||Iy;return typeof b.evaluate=="function"?{evaluate(...M){const R=b.evaluate.apply(void 0,M),B=S.evaluate.apply(void 0,M);if(R!==void 0&&B!==void 0)return P(R,B,x,s.colorSpace)}}:P(b,S,x,s.colorSpace)}function Qf(s,r,o){switch(r.type){case"color":o=Ht.parse(o);break;case"formatted":o=Zr.fromString(o.toString());break;case"resolvedImage":o=Xr.fromString(o.toString());break;case"padding":o=Hr.parse(o);break;default:$t(o)===r.type||r.type==="enum"&&r.values[o]||(o=void 0)}return ta(o,s.default,r.default)}ci.register(Yo,{error:[{kind:"error"},[Mt],(s,[r])=>{throw new Pn(r.evaluate(s))}],typeof:[Mt,[Ct],(s,[r])=>O(Ln(r.evaluate(s)))],"to-rgba":[V(He,4),[Ir],(s,[r])=>{const[o,c,g,v]=r.evaluate(s).rgb;return[255*o,255*c,255*g,v]}],rgb:[Ir,[He,He,He],mh],rgba:[Ir,[He,He,He,He],mh],has:{type:vt,overloads:[[[Mt],(s,[r])=>gh(r.evaluate(s),s.properties())],[[Mt,ki],(s,[r,o])=>gh(r.evaluate(s),o.evaluate(s))]]},get:{type:Ct,overloads:[[[Mt],(s,[r])=>yh(r.evaluate(s),s.properties())],[[Mt,ki],(s,[r,o])=>yh(r.evaluate(s),o.evaluate(s))]]},"feature-state":[Ct,[Mt],(s,[r])=>yh(r.evaluate(s),s.featureState||{})],properties:[ki,[],s=>s.properties()],"geometry-type":[Mt,[],s=>s.geometryType()],id:[Ct,[],s=>s.id()],zoom:[He,[],s=>s.globals.zoom],"heatmap-density":[He,[],s=>s.globals.heatmapDensity||0],"line-progress":[He,[],s=>s.globals.lineProgress||0],accumulated:[Ct,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[He,_o(He),(s,r)=>{let o=0;for(const c of r)o+=c.evaluate(s);return o}],"*":[He,_o(He),(s,r)=>{let o=1;for(const c of r)o*=c.evaluate(s);return o}],"-":{type:He,overloads:[[[He,He],(s,[r,o])=>r.evaluate(s)-o.evaluate(s)],[[He],(s,[r])=>-r.evaluate(s)]]},"/":[He,[He,He],(s,[r,o])=>r.evaluate(s)/o.evaluate(s)],"%":[He,[He,He],(s,[r,o])=>r.evaluate(s)%o.evaluate(s)],ln2:[He,[],()=>Math.LN2],pi:[He,[],()=>Math.PI],e:[He,[],()=>Math.E],"^":[He,[He,He],(s,[r,o])=>Math.pow(r.evaluate(s),o.evaluate(s))],sqrt:[He,[He],(s,[r])=>Math.sqrt(r.evaluate(s))],log10:[He,[He],(s,[r])=>Math.log(r.evaluate(s))/Math.LN10],ln:[He,[He],(s,[r])=>Math.log(r.evaluate(s))],log2:[He,[He],(s,[r])=>Math.log(r.evaluate(s))/Math.LN2],sin:[He,[He],(s,[r])=>Math.sin(r.evaluate(s))],cos:[He,[He],(s,[r])=>Math.cos(r.evaluate(s))],tan:[He,[He],(s,[r])=>Math.tan(r.evaluate(s))],asin:[He,[He],(s,[r])=>Math.asin(r.evaluate(s))],acos:[He,[He],(s,[r])=>Math.acos(r.evaluate(s))],atan:[He,[He],(s,[r])=>Math.atan(r.evaluate(s))],min:[He,_o(He),(s,r)=>Math.min(...r.map(o=>o.evaluate(s)))],max:[He,_o(He),(s,r)=>Math.max(...r.map(o=>o.evaluate(s)))],abs:[He,[He],(s,[r])=>Math.abs(r.evaluate(s))],round:[He,[He],(s,[r])=>{const o=r.evaluate(s);return o<0?-Math.round(-o):Math.round(o)}],floor:[He,[He],(s,[r])=>Math.floor(r.evaluate(s))],ceil:[He,[He],(s,[r])=>Math.ceil(r.evaluate(s))],"filter-==":[vt,[Mt,Ct],(s,[r,o])=>s.properties()[r.value]===o.value],"filter-id-==":[vt,[Ct],(s,[r])=>s.id()===r.value],"filter-type-==":[vt,[Mt],(s,[r])=>s.geometryType()===r.value],"filter-<":[vt,[Mt,Ct],(s,[r,o])=>{const c=s.properties()[r.value],g=o.value;return typeof c==typeof g&&c<g}],"filter-id-<":[vt,[Ct],(s,[r])=>{const o=s.id(),c=r.value;return typeof o==typeof c&&o<c}],"filter->":[vt,[Mt,Ct],(s,[r,o])=>{const c=s.properties()[r.value],g=o.value;return typeof c==typeof g&&c>g}],"filter-id->":[vt,[Ct],(s,[r])=>{const o=s.id(),c=r.value;return typeof o==typeof c&&o>c}],"filter-<=":[vt,[Mt,Ct],(s,[r,o])=>{const c=s.properties()[r.value],g=o.value;return typeof c==typeof g&&c<=g}],"filter-id-<=":[vt,[Ct],(s,[r])=>{const o=s.id(),c=r.value;return typeof o==typeof c&&o<=c}],"filter->=":[vt,[Mt,Ct],(s,[r,o])=>{const c=s.properties()[r.value],g=o.value;return typeof c==typeof g&&c>=g}],"filter-id->=":[vt,[Ct],(s,[r])=>{const o=s.id(),c=r.value;return typeof o==typeof c&&o>=c}],"filter-has":[vt,[Ct],(s,[r])=>r.value in s.properties()],"filter-has-id":[vt,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[vt,[V(Mt)],(s,[r])=>r.value.indexOf(s.geometryType())>=0],"filter-id-in":[vt,[V(Ct)],(s,[r])=>r.value.indexOf(s.id())>=0],"filter-in-small":[vt,[Mt,V(Ct)],(s,[r,o])=>o.value.indexOf(s.properties()[r.value])>=0],"filter-in-large":[vt,[Mt,V(Ct)],(s,[r,o])=>function(c,g,v,x){for(;v<=x;){const b=v+x>>1;if(g[b]===c)return!0;g[b]>c?x=b-1:v=b+1}return!1}(s.properties()[r.value],o.value,0,o.value.length-1)],all:{type:vt,overloads:[[[vt,vt],(s,[r,o])=>r.evaluate(s)&&o.evaluate(s)],[_o(vt),(s,r)=>{for(const o of r)if(!o.evaluate(s))return!1;return!0}]]},any:{type:vt,overloads:[[[vt,vt],(s,[r,o])=>r.evaluate(s)||o.evaluate(s)],[_o(vt),(s,r)=>{for(const o of r)if(o.evaluate(s))return!0;return!1}]]},"!":[vt,[vt],(s,[r])=>!r.evaluate(s)],"is-supported-script":[vt,[Mt],(s,[r])=>{const o=s.globals&&s.globals.isSupportedScript;return!o||o(r.evaluate(s))}],upcase:[Mt,[Mt],(s,[r])=>r.evaluate(s).toUpperCase()],downcase:[Mt,[Mt],(s,[r])=>r.evaluate(s).toLowerCase()],concat:[Mt,_o(Ct),(s,r)=>r.map(o=>Qa(o.evaluate(s))).join("")],"resolved-locale":[Mt,[Ji],(s,[r])=>r.evaluate(s).resolvedLocale()]});class yu{constructor(r,o){var c;this.expression=r,this._warningHistory={},this._evaluator=new nu,this._defaultValue=o?(c=o).type==="color"&&mu(c.default)?new Ht(0,0,0,0):c.type==="color"?Ht.parse(c.default)||null:c.type==="padding"?Hr.parse(c.default)||null:c.type==="variableAnchorOffsetCollection"?ui.parse(c.default)||null:c.default===void 0?null:c.default:null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(r,o,c,g,v,x){return this._evaluator.globals=r,this._evaluator.feature=o,this._evaluator.featureState=c,this._evaluator.canonical=g,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(r,o,c,g,v,x){this._evaluator.globals=r,this._evaluator.feature=o||null,this._evaluator.featureState=c||null,this._evaluator.canonical=g,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Pn(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function _u(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in Yo}function na(s,r){const o=new co(Yo,ol,[],r?function(g){const v={color:Ir,string:Mt,number:He,enum:Mt,boolean:vt,formatted:ws,padding:Os,resolvedImage:Qi,variableAnchorOffsetCollection:se};return g.type==="array"?V(v[g.value]||Ct,g.length):v[g.type]}(r):void 0),c=o.parse(s,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?pu(new yu(c,r)):Qo(o.errors)}class ra{constructor(r,o){this.kind=r,this._styleExpression=o,this.isStateDependent=r!=="constant"&&!Jo(o.expression)}evaluateWithoutErrorHandling(r,o,c,g,v,x){return this._styleExpression.evaluateWithoutErrorHandling(r,o,c,g,v,x)}evaluate(r,o,c,g,v,x){return this._styleExpression.evaluate(r,o,c,g,v,x)}}class ia{constructor(r,o,c,g){this.kind=r,this.zoomStops=c,this._styleExpression=o,this.isStateDependent=r!=="camera"&&!Jo(o.expression),this.interpolationType=g}evaluateWithoutErrorHandling(r,o,c,g,v,x){return this._styleExpression.evaluateWithoutErrorHandling(r,o,c,g,v,x)}evaluate(r,o,c,g,v,x){return this._styleExpression.evaluate(r,o,c,g,v,x)}interpolationFactor(r,o,c){return this.interpolationType?Ar.interpolationFactor(this.interpolationType,r,o,c):0}}function vh(s,r){const o=na(s,r);if(o.result==="error")return o;const c=o.value.expression,g=al(c);if(!g&&!ea(r))return Qo([new _r("","data expressions not supported")]);const v=ll(c,["zoom"]);if(!v&&!Xf(r))return Qo([new _r("","zoom expressions not supported")]);const x=ul(c);return x||v?x instanceof _r?Qo([x]):x instanceof Ar&&!_h(r)?Qo([new _r("",'"interpolate" expressions cannot be used with this property')]):pu(x?new ia(g?"camera":"composite",o.value,x.labels,x instanceof Ar?x.interpolation:void 0):new ra(g?"constant":"source",o.value)):Qo([new _r("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class sa{constructor(r,o){this._parameters=r,this._specification=o,Ki(this,Kf(this._parameters,this._specification))}static deserialize(r){return new sa(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function ul(s){let r=null;if(s instanceof Vs)r=ul(s.result);else if(s instanceof ou){for(const o of s.args)if(r=ul(o),r)break}else(s instanceof Ho||s instanceof Ar)&&s.input instanceof ci&&s.input.name==="zoom"&&(r=s);return r instanceof _r||s.eachChild(o=>{const c=ul(o);c instanceof _r?r=c:!r&&c?r=new _r("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&c&&r!==c&&(r=new _r("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function vu(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const r of s.slice(1))if(!vu(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const xu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function xh(s){if(s==null)return{filter:()=>!0,needGeometry:!1};vu(s)||(s=bu(s));const r=na(s,xu);if(r.result==="error")throw new Error(r.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,c,g)=>r.value.evaluate(o,c,{},g),needGeometry:ep(s)}}function My(s,r){return s<r?-1:s>r?1:0}function ep(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let r=1;r<s.length;r++)if(ep(s[r]))return!0;return!1}function bu(s){if(!s)return!0;const r=s[0];return s.length<=1?r!=="any":r==="=="?bh(s[1],s[2],"=="):r==="!="?ar(bh(s[1],s[2],"==")):r==="<"||r===">"||r==="<="||r===">="?bh(s[1],s[2],r):r==="any"?(o=s.slice(1),["any"].concat(o.map(bu))):r==="all"?["all"].concat(s.slice(1).map(bu)):r==="none"?["all"].concat(s.slice(1).map(bu).map(ar)):r==="in"?cl(s[1],s.slice(2)):r==="!in"?ar(cl(s[1],s.slice(2))):r==="has"?hl(s[1]):r!=="!has"||ar(hl(s[1]));var o}function bh(s,r,o){switch(s){case"$type":return[`filter-type-${o}`,r];case"$id":return[`filter-id-${o}`,r];default:return[`filter-${o}`,s,r]}}function cl(s,r){if(r.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(o=>typeof o!=typeof r[0])?["filter-in-large",s,["literal",r.sort(My)]]:["filter-in-small",s,["literal",r]]}}function hl(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function ar(s){return["!",s]}function vo(s){const r=typeof s;if(r==="number"||r==="boolean"||r==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let g="[";for(const v of s)g+=`${vo(v)},`;return`${g}]`}const o=Object.keys(s).sort();let c="{";for(let g=0;g<o.length;g++)c+=`${JSON.stringify(o[g])}:${vo(s[o[g]])},`;return`${c}}`}function tp(s){let r="";for(const o of ai)r+=`/${vo(s[o])}`;return r}function np(s){const r=s.value;return r?[new Ue(s.key,r,"constants have been deprecated as of v8")]:[]}function wn(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Mi(s){if(Array.isArray(s))return s.map(Mi);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const r={};for(const o in s)r[o]=Mi(s[o]);return r}return wn(s)}function Kr(s){const r=s.key,o=s.value,c=s.valueSpec||{},g=s.objectElementValidators||{},v=s.style,x=s.styleSpec,b=s.validateSpec;let S=[];const P=$t(o);if(P!=="object")return[new Ue(r,o,`object expected, ${P} found`)];for(const M in o){const R=M.split(".")[0],B=c[R]||c["*"];let N;if(g[R])N=g[R];else if(c[R])N=b;else if(g["*"])N=g["*"];else{if(!c["*"]){S.push(new Ue(r,o[M],`unknown property "${M}"`));continue}N=b}S=S.concat(N({key:(r&&`${r}.`)+M,value:o[M],valueSpec:B,style:v,styleSpec:x,object:o,objectKey:M,validateSpec:b},o))}for(const M in c)g[M]||c[M].required&&c[M].default===void 0&&o[M]===void 0&&S.push(new Ue(r,o,`missing required property "${M}"`));return S}function dl(s){const r=s.value,o=s.valueSpec,c=s.style,g=s.styleSpec,v=s.key,x=s.arrayElementValidator||s.validateSpec;if($t(r)!=="array")return[new Ue(v,r,`array expected, ${$t(r)} found`)];if(o.length&&r.length!==o.length)return[new Ue(v,r,`array length ${o.length} expected, length ${r.length} found`)];if(o["min-length"]&&r.length<o["min-length"])return[new Ue(v,r,`array length at least ${o["min-length"]} expected, length ${r.length} found`)];let b={type:o.value,values:o.values};g.$version<7&&(b.function=o.function),$t(o.value)==="object"&&(b=o.value);let S=[];for(let P=0;P<r.length;P++)S=S.concat(x({array:r,arrayIndex:P,value:r[P],valueSpec:b,validateSpec:s.validateSpec,style:c,styleSpec:g,key:`${v}[${P}]`}));return S}function wh(s){const r=s.key,o=s.value,c=s.valueSpec;let g=$t(o);return g==="number"&&o!=o&&(g="NaN"),g!=="number"?[new Ue(r,o,`number expected, ${g} found`)]:"minimum"in c&&o<c.minimum?[new Ue(r,o,`${o} is less than the minimum value ${c.minimum}`)]:"maximum"in c&&o>c.maximum?[new Ue(r,o,`${o} is greater than the maximum value ${c.maximum}`)]:[]}function wu(s){const r=s.valueSpec,o=wn(s.value.type);let c,g,v,x={};const b=o!=="categorical"&&s.value.property===void 0,S=!b,P=$t(s.value.stops)==="array"&&$t(s.value.stops[0])==="array"&&$t(s.value.stops[0][0])==="object",M=Kr({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(N){if(o==="identity")return[new Ue(N.key,N.value,'identity function may not have a "stops" property')];let q=[];const W=N.value;return q=q.concat(dl({key:N.key,value:W,valueSpec:N.valueSpec,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec,arrayElementValidator:R})),$t(W)==="array"&&W.length===0&&q.push(new Ue(N.key,W,"array must have at least one stop")),q},default:function(N){return N.validateSpec({key:N.key,value:N.value,valueSpec:r,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec})}}});return o==="identity"&&b&&M.push(new Ue(s.key,s.value,'missing required property "property"')),o==="identity"||s.value.stops||M.push(new Ue(s.key,s.value,'missing required property "stops"')),o==="exponential"&&s.valueSpec.expression&&!_h(s.valueSpec)&&M.push(new Ue(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(S&&!ea(s.valueSpec)?M.push(new Ue(s.key,s.value,"property functions not supported")):b&&!Xf(s.valueSpec)&&M.push(new Ue(s.key,s.value,"zoom functions not supported"))),o!=="categorical"&&!P||s.value.property!==void 0||M.push(new Ue(s.key,s.value,'"property" property is required')),M;function R(N){let q=[];const W=N.value,te=N.key;if($t(W)!=="array")return[new Ue(te,W,`array expected, ${$t(W)} found`)];if(W.length!==2)return[new Ue(te,W,`array length 2 expected, length ${W.length} found`)];if(P){if($t(W[0])!=="object")return[new Ue(te,W,`object expected, ${$t(W[0])} found`)];if(W[0].zoom===void 0)return[new Ue(te,W,"object stop key must have zoom")];if(W[0].value===void 0)return[new Ue(te,W,"object stop key must have value")];if(v&&v>wn(W[0].zoom))return[new Ue(te,W[0].zoom,"stop zoom values must appear in ascending order")];wn(W[0].zoom)!==v&&(v=wn(W[0].zoom),g=void 0,x={}),q=q.concat(Kr({key:`${te}[0]`,value:W[0],valueSpec:{zoom:{}},validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec,objectElementValidators:{zoom:wh,value:B}}))}else q=q.concat(B({key:`${te}[0]`,value:W[0],validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec},W));return _u(Mi(W[1]))?q.concat([new Ue(`${te}[1]`,W[1],"expressions are not allowed in function stops.")]):q.concat(N.validateSpec({key:`${te}[1]`,value:W[1],valueSpec:r,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec}))}function B(N,q){const W=$t(N.value),te=wn(N.value),oe=N.value!==null?N.value:q;if(c){if(W!==c)return[new Ue(N.key,oe,`${W} stop domain type must match previous stop domain type ${c}`)]}else c=W;if(W!=="number"&&W!=="string"&&W!=="boolean")return[new Ue(N.key,oe,"stop domain value must be a number, string, or boolean")];if(W!=="number"&&o!=="categorical"){let Se=`number expected, ${W} found`;return ea(r)&&o===void 0&&(Se+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ue(N.key,oe,Se)]}return o!=="categorical"||W!=="number"||isFinite(te)&&Math.floor(te)===te?o!=="categorical"&&W==="number"&&g!==void 0&&te<g?[new Ue(N.key,oe,"stop domain values must appear in ascending order")]:(g=te,o==="categorical"&&te in x?[new Ue(N.key,oe,"stop domain values must be unique")]:(x[te]=!0,[])):[new Ue(N.key,oe,`integer expected, found ${te}`)]}}function oa(s){const r=(s.expressionContext==="property"?vh:na)(Mi(s.value),s.valueSpec);if(r.result==="error")return r.value.map(c=>new Ue(`${s.key}${c.key}`,s.value,c.message));const o=r.value.expression||r.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!o.outputDefined())return[new Ue(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!Jo(o))return[new Ue(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!Jo(o))return[new Ue(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!ll(o,["zoom","feature-state"]))return[new Ue(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!al(o))return[new Ue(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ts(s){const r=s.key,o=s.value,c=s.valueSpec,g=[];return Array.isArray(c.values)?c.values.indexOf(wn(o))===-1&&g.push(new Ue(r,o,`expected one of [${c.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(c.values).indexOf(wn(o))===-1&&g.push(new Ue(r,o,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(o)} found`)),g}function Sh(s){return vu(Mi(s.value))?oa(Ki({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Su(s)}function Su(s){const r=s.value,o=s.key;if($t(r)!=="array")return[new Ue(o,r,`array expected, ${$t(r)} found`)];const c=s.styleSpec;let g,v=[];if(r.length<1)return[new Ue(o,r,"filter array must have at least 1 element")];switch(v=v.concat(Ts({key:`${o}[0]`,value:r[0],valueSpec:c.filter_operator,style:s.style,styleSpec:s.styleSpec})),wn(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&wn(r[1])==="$type"&&v.push(new Ue(o,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&v.push(new Ue(o,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(g=$t(r[1]),g!=="string"&&v.push(new Ue(`${o}[1]`,r[1],`string expected, ${g} found`)));for(let x=2;x<r.length;x++)g=$t(r[x]),wn(r[1])==="$type"?v=v.concat(Ts({key:`${o}[${x}]`,value:r[x],valueSpec:c.geometry_type,style:s.style,styleSpec:s.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&v.push(new Ue(`${o}[${x}]`,r[x],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let x=1;x<r.length;x++)v=v.concat(Su({key:`${o}[${x}]`,value:r[x],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":g=$t(r[1]),r.length!==2?v.push(new Ue(o,r,`filter array for "${r[0]}" operator must have 2 elements`)):g!=="string"&&v.push(new Ue(`${o}[1]`,r[1],`string expected, ${g} found`))}return v}function Th(s,r){const o=s.key,c=s.validateSpec,g=s.style,v=s.styleSpec,x=s.value,b=s.objectKey,S=v[`${r}_${s.layerType}`];if(!S)return[];const P=b.match(/^(.*)-transition$/);if(r==="paint"&&P&&S[P[1]]&&S[P[1]].transition)return c({key:o,value:x,valueSpec:v.transition,style:g,styleSpec:v});const M=s.valueSpec||S[b];if(!M)return[new Ue(o,x,`unknown property "${b}"`)];let R;if($t(x)==="string"&&ea(M)&&!M.tokens&&(R=/^{([^}]+)}$/.exec(x)))return[new Ue(o,x,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const B=[];return s.layerType==="symbol"&&(b==="text-field"&&g&&!g.glyphs&&B.push(new Ue(o,x,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&mu(Mi(x))&&wn(x.type)==="identity"&&B.push(new Ue(o,x,'"text-font" does not support identity functions'))),B.concat(c({key:s.key,value:x,valueSpec:M,style:g,styleSpec:v,expressionContext:"property",propertyType:r,propertyKey:b}))}function Tu(s){return Th(s,"paint")}function Ch(s){return Th(s,"layout")}function kh(s){let r=[];const o=s.value,c=s.key,g=s.style,v=s.styleSpec;o.type||o.ref||r.push(new Ue(c,o,'either "type" or "ref" is required'));let x=wn(o.type);const b=wn(o.ref);if(o.id){const S=wn(o.id);for(let P=0;P<s.arrayIndex;P++){const M=g.layers[P];wn(M.id)===S&&r.push(new Ue(c,o.id,`duplicate layer id "${o.id}", previously used at line ${M.id.__line__}`))}}if("ref"in o){let S;["type","source","source-layer","filter","layout"].forEach(P=>{P in o&&r.push(new Ue(c,o[P],`"${P}" is prohibited for ref layers`))}),g.layers.forEach(P=>{wn(P.id)===b&&(S=P)}),S?S.ref?r.push(new Ue(c,o.ref,"ref cannot reference another ref layer")):x=wn(S.type):r.push(new Ue(c,o.ref,`ref layer "${b}" not found`))}else if(x!=="background")if(o.source){const S=g.sources&&g.sources[o.source],P=S&&wn(S.type);S?P==="vector"&&x==="raster"?r.push(new Ue(c,o.source,`layer "${o.id}" requires a raster source`)):P!=="raster-dem"&&x==="hillshade"?r.push(new Ue(c,o.source,`layer "${o.id}" requires a raster-dem source`)):P==="raster"&&x!=="raster"?r.push(new Ue(c,o.source,`layer "${o.id}" requires a vector source`)):P!=="vector"||o["source-layer"]?P==="raster-dem"&&x!=="hillshade"?r.push(new Ue(c,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!o.paint||!o.paint["line-gradient"]||P==="geojson"&&S.lineMetrics||r.push(new Ue(c,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new Ue(c,o,`layer "${o.id}" must specify a "source-layer"`)):r.push(new Ue(c,o.source,`source "${o.source}" not found`))}else r.push(new Ue(c,o,'missing required property "source"'));return r=r.concat(Kr({key:c,value:o,valueSpec:v.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${c}.type`,value:o.type,valueSpec:v.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:o,objectKey:"type"}),filter:Sh,layout:S=>Kr({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":P=>Ch(Ki({layerType:x},P))}}),paint:S=>Kr({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":P=>Tu(Ki({layerType:x},P))}})}})),r}function xo(s){const r=s.value,o=s.key,c=$t(r);return c!=="string"?[new Ue(o,r,`string expected, ${c} found`)]:[]}const Cu={promoteId:function({key:s,value:r}){if($t(r)==="string")return xo({key:s,value:r});{const o=[];for(const c in r)o.push(...xo({key:`${s}.${c}`,value:r[c]}));return o}}};function fl(s){const r=s.value,o=s.key,c=s.styleSpec,g=s.style,v=s.validateSpec;if(!r.type)return[new Ue(o,r,'"type" is required')];const x=wn(r.type);let b;switch(x){case"vector":case"raster":return b=Kr({key:o,value:r,valueSpec:c[`source_${x.replace("-","_")}`],style:s.style,styleSpec:c,objectElementValidators:Cu,validateSpec:v}),b;case"raster-dem":return b=function(S){var P;const M=(P=S.sourceName)!==null&&P!==void 0?P:"",R=S.value,B=S.styleSpec,N=B.source_raster_dem,q=S.style;let W=[];const te=$t(R);if(R===void 0)return W;if(te!=="object")return W.push(new Ue("source_raster_dem",R,`object expected, ${te} found`)),W;const oe=wn(R.encoding)==="custom",Se=["redFactor","greenFactor","blueFactor","baseShift"],pe=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const xe in R)!oe&&Se.includes(xe)?W.push(new Ue(xe,R[xe],`In "${M}": "${xe}" is only valid when "encoding" is set to "custom". ${pe} encoding found`)):N[xe]?W=W.concat(S.validateSpec({key:xe,value:R[xe],valueSpec:N[xe],validateSpec:S.validateSpec,style:q,styleSpec:B})):W.push(new Ue(xe,R[xe],`unknown property "${xe}"`));return W}({sourceName:o,value:r,style:s.style,styleSpec:c,validateSpec:v}),b;case"geojson":if(b=Kr({key:o,value:r,valueSpec:c.source_geojson,style:g,styleSpec:c,validateSpec:v,objectElementValidators:Cu}),r.cluster)for(const S in r.clusterProperties){const[P,M]=r.clusterProperties[S],R=typeof P=="string"?[P,["accumulated"],["get",S]]:P;b.push(...oa({key:`${o}.${S}.map`,value:M,expressionContext:"cluster-map"})),b.push(...oa({key:`${o}.${S}.reduce`,value:R,expressionContext:"cluster-reduce"}))}return b;case"video":return Kr({key:o,value:r,valueSpec:c.source_video,style:g,validateSpec:v,styleSpec:c});case"image":return Kr({key:o,value:r,valueSpec:c.source_image,style:g,validateSpec:v,styleSpec:c});case"canvas":return[new Ue(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ts({key:`${o}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Ph(s){const r=s.value,o=s.styleSpec,c=o.light,g=s.style;let v=[];const x=$t(r);if(r===void 0)return v;if(x!=="object")return v=v.concat([new Ue("light",r,`object expected, ${x} found`)]),v;for(const b in r){const S=b.match(/^(.*)-transition$/);v=v.concat(S&&c[S[1]]&&c[S[1]].transition?s.validateSpec({key:b,value:r[b],valueSpec:o.transition,validateSpec:s.validateSpec,style:g,styleSpec:o}):c[b]?s.validateSpec({key:b,value:r[b],valueSpec:c[b],validateSpec:s.validateSpec,style:g,styleSpec:o}):[new Ue(b,r[b],`unknown property "${b}"`)])}return v}function Eh(s){const r=s.value,o=s.styleSpec,c=o.sky,g=s.style,v=$t(r);if(r===void 0)return[];if(v!=="object")return[new Ue("sky",r,`object expected, ${v} found`)];let x=[];for(const b in r)x=x.concat(c[b]?s.validateSpec({key:b,value:r[b],valueSpec:c[b],style:g,styleSpec:o}):[new Ue(b,r[b],`unknown property "${b}"`)]);return x}function Ih(s){const r=s.value,o=s.styleSpec,c=o.terrain,g=s.style;let v=[];const x=$t(r);if(r===void 0)return v;if(x!=="object")return v=v.concat([new Ue("terrain",r,`object expected, ${x} found`)]),v;for(const b in r)v=v.concat(c[b]?s.validateSpec({key:b,value:r[b],valueSpec:c[b],validateSpec:s.validateSpec,style:g,styleSpec:o}):[new Ue(b,r[b],`unknown property "${b}"`)]);return v}function Mh(s){let r=[];const o=s.value,c=s.key;if(Array.isArray(o)){const g=[],v=[];for(const x in o)o[x].id&&g.includes(o[x].id)&&r.push(new Ue(c,o,`all the sprites' ids must be unique, but ${o[x].id} is duplicated`)),g.push(o[x].id),o[x].url&&v.includes(o[x].url)&&r.push(new Ue(c,o,`all the sprites' URLs must be unique, but ${o[x].url} is duplicated`)),v.push(o[x].url),r=r.concat(Kr({key:`${c}[${x}]`,value:o[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return r}return xo({key:c,value:o})}const ku={"*":()=>[],array:dl,boolean:function(s){const r=s.value,o=s.key,c=$t(r);return c!=="boolean"?[new Ue(o,r,`boolean expected, ${c} found`)]:[]},number:wh,color:function(s){const r=s.key,o=s.value,c=$t(o);return c!=="string"?[new Ue(r,o,`color expected, ${c} found`)]:Ht.parse(String(o))?[]:[new Ue(r,o,`color expected, "${o}" found`)]},constants:np,enum:Ts,filter:Sh,function:wu,layer:kh,object:Kr,source:fl,light:Ph,sky:Eh,terrain:Ih,projection:function(s){const r=s.value,o=s.styleSpec,c=o.projection,g=s.style,v=$t(r);if(r===void 0)return[];if(v!=="object")return[new Ue("projection",r,`object expected, ${v} found`)];let x=[];for(const b in r)x=x.concat(c[b]?s.validateSpec({key:b,value:r[b],valueSpec:c[b],style:g,styleSpec:o}):[new Ue(b,r[b],`unknown property "${b}"`)]);return x},string:xo,formatted:function(s){return xo(s).length===0?[]:oa(s)},resolvedImage:function(s){return xo(s).length===0?[]:oa(s)},padding:function(s){const r=s.key,o=s.value;if($t(o)==="array"){if(o.length<1||o.length>4)return[new Ue(r,o,`padding requires 1 to 4 values; ${o.length} values found`)];const c={type:"number"};let g=[];for(let v=0;v<o.length;v++)g=g.concat(s.validateSpec({key:`${r}[${v}]`,value:o[v],validateSpec:s.validateSpec,valueSpec:c}));return g}return wh({key:r,value:o,valueSpec:{}})},variableAnchorOffsetCollection:function(s){const r=s.key,o=s.value,c=$t(o),g=s.styleSpec;if(c!=="array"||o.length<1||o.length%2!=0)return[new Ue(r,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let v=[];for(let x=0;x<o.length;x+=2)v=v.concat(Ts({key:`${r}[${x}]`,value:o[x],valueSpec:g.layout_symbol["text-anchor"]})),v=v.concat(dl({key:`${r}[${x+1}]`,value:o[x+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:g}));return v},sprite:Mh};function pl(s){const r=s.value,o=s.valueSpec,c=s.styleSpec;return s.validateSpec=pl,o.expression&&mu(wn(r))?wu(s):o.expression&&_u(Mi(r))?oa(s):o.type&&ku[o.type]?ku[o.type](s):Kr(Ki({},s,{valueSpec:o.type?c[o.type]:o}))}function rp(s){const r=s.value,o=s.key,c=xo(s);return c.length||(r.indexOf("{fontstack}")===-1&&c.push(new Ue(o,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&c.push(new Ue(o,r,'"glyphs" url must include a "{range}" token'))),c}function hi(s,r=ke){let o=[];return o=o.concat(pl({key:"",value:s,valueSpec:r.$root,styleSpec:r,style:s,validateSpec:pl,objectElementValidators:{glyphs:rp,"*":()=>[]}})),s.constants&&(o=o.concat(np({key:"constants",value:s.constants}))),Ah(o)}function ts(s){return function(r){return s({...r,validateSpec:pl})}}function Ah(s){return[].concat(s).sort((r,o)=>r.line-o.line)}function Ai(s){return function(...r){return Ah(s.apply(this,r))}}hi.source=Ai(ts(fl)),hi.sprite=Ai(ts(Mh)),hi.glyphs=Ai(ts(rp)),hi.light=Ai(ts(Ph)),hi.sky=Ai(ts(Eh)),hi.terrain=Ai(ts(Ih)),hi.layer=Ai(ts(kh)),hi.filter=Ai(ts(Sh)),hi.paintProperty=Ai(ts(Tu)),hi.layoutProperty=Ai(ts(Ch));const bo=hi,Ay=bo.light,zy=bo.sky,ip=bo.paintProperty,sp=bo.layoutProperty;function zh(s,r){let o=!1;if(r&&r.length)for(const c of r)s.fire(new oi(new Error(c.message))),o=!0;return o}class aa{constructor(r,o,c){const g=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const x=new Int32Array(this.arrayBuffer);r=x[0],this.d=(o=x[1])+2*(c=x[2]);for(let S=0;S<this.d*this.d;S++){const P=x[3+S],M=x[3+S+1];g.push(P===M?null:x.subarray(P,M))}const b=x[3+g.length+1];this.keys=x.subarray(x[3+g.length],b),this.bboxes=x.subarray(b),this.insert=this._insertReadonly}else{this.d=o+2*c;for(let x=0;x<this.d*this.d;x++)g.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=r,this.padding=c,this.scale=o/r,this.uid=0;const v=c/o*r;this.min=-v,this.max=r+v}insert(r,o,c,g,v){this._forEachCell(o,c,g,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(g),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,o,c,g,v,x){this.cells[v].push(x)}query(r,o,c,g,v){const x=this.min,b=this.max;if(r<=x&&o<=x&&b<=c&&b<=g&&!v)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(r,o,c,g,this._queryCell,S,{},v),S}}_queryCell(r,o,c,g,v,x,b,S){const P=this.cells[v];if(P!==null){const M=this.keys,R=this.bboxes;for(let B=0;B<P.length;B++){const N=P[B];if(b[N]===void 0){const q=4*N;(S?S(R[q+0],R[q+1],R[q+2],R[q+3]):r<=R[q+2]&&o<=R[q+3]&&c>=R[q+0]&&g>=R[q+1])?(b[N]=!0,x.push(M[N])):b[N]=!1}}}}_forEachCell(r,o,c,g,v,x,b,S){const P=this._convertToCellCoord(r),M=this._convertToCellCoord(o),R=this._convertToCellCoord(c),B=this._convertToCellCoord(g);for(let N=P;N<=R;N++)for(let q=M;q<=B;q++){const W=this.d*q+N;if((!S||S(this._convertFromCellCoord(N),this._convertFromCellCoord(q),this._convertFromCellCoord(N+1),this._convertFromCellCoord(q+1)))&&v.call(this,r,o,c,g,W,x,b,S))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,o=3+this.cells.length+1+1;let c=0;for(let x=0;x<this.cells.length;x++)c+=this.cells[x].length;const g=new Int32Array(o+c+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let v=o;for(let x=0;x<r.length;x++){const b=r[x];g[3+x]=v,g.set(b,v),v+=b.length}return g[3+r.length]=v,g.set(this.keys,v),v+=this.keys.length,g[3+r.length+1]=v,g.set(this.bboxes,v),v+=this.bboxes.length,g.buffer}static serialize(r,o){const c=r.toArrayBuffer();return o&&o.push(c),{buffer:c}}static deserialize(r){return new aa(r.buffer)}}const di={};function it(s,r,o={}){if(di[s])throw new Error(`${s} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:s,writeable:!1}),di[s]={klass:r,omit:o.omit||[],shallow:o.shallow||[]}}it("Object",Object),it("TransferableGridIndex",aa),it("Color",Ht),it("Error",Error),it("AJAXError",Dn),it("ResolvedImage",Xr),it("StylePropertyFunction",sa),it("StyleExpression",yu,{omit:["_evaluator"]}),it("ZoomDependentExpression",ia),it("ZoomConstantExpression",ra),it("CompoundExpression",ci,{omit:["_evaluate"]});for(const s in Yo)Yo[s]._classRegistryKey||it(`Expression_${s}`,Yo[s]);function Pu(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function Dh(s){return s.$name||s.constructor._classRegistryKey}function op(s){return!function(r){if(r===null||typeof r!="object")return!1;const o=Dh(r);return!(!o||o==="Object")}(s)&&(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||Pu(s)||_t(s)||ArrayBuffer.isView(s)||s instanceof ImageData)}function la(s,r){if(op(s))return(Pu(s)||_t(s))&&r&&r.push(s),ArrayBuffer.isView(s)&&r&&r.push(s.buffer),s instanceof ImageData&&r&&r.push(s.data.buffer),s;if(Array.isArray(s)){const v=[];for(const x of s)v.push(la(x,r));return v}if(typeof s!="object")throw new Error("can't serialize object of type "+typeof s);const o=Dh(s);if(!o)throw new Error(`can't serialize object of unregistered class ${s.constructor.name}`);if(!di[o])throw new Error(`${o} is not registered.`);const{klass:c}=di[o],g=c.serialize?c.serialize(s,r):{};if(c.serialize){if(r&&g===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in s){if(!s.hasOwnProperty(v)||di[o].omit.indexOf(v)>=0)continue;const x=s[v];g[v]=di[o].shallow.indexOf(v)>=0?x:la(x,r)}s instanceof Error&&(g.message=s.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(g.$name=o),g}function ua(s){if(op(s))return s;if(Array.isArray(s))return s.map(ua);if(typeof s!="object")throw new Error("can't deserialize object of type "+typeof s);const r=Dh(s)||"Object";if(!di[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:o}=di[r];if(!o)throw new Error(`can't deserialize unregistered class ${r}`);if(o.deserialize)return o.deserialize(s);const c=Object.create(o.prototype);for(const g of Object.keys(s)){if(g==="$name")continue;const v=s[g];c[g]=di[r].shallow.indexOf(g)>=0?v:ua(v)}return c}class Rh{constructor(){this.first=!0}update(r,o){const c=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=o),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=c,!0))}}const Lt={"Latin-1 Supplement":s=>s>=128&&s<=255,"Hangul Jamo":s=>s>=4352&&s<=4607,Khmer:s=>s>=6016&&s<=6143,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Katakana:s=>s>=12448&&s<=12543,Kanbun:s=>s>=12688&&s<=12703,"CJK Strokes":s=>s>=12736&&s<=12783,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"Private Use Area":s=>s>=57344&&s<=63743,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function Lh(s){for(const r of s)if(Bh(r.charCodeAt(0)))return!0;return!1}function Dy(s){for(const r of s)if(!ca(r.charCodeAt(0)))return!1;return!0}function Fh(s){const r=s.map(o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}}).filter(o=>o);return new RegExp(r.join("|"),"u")}const Ry=Fh(["Arab","Dupl","Mong","Ougr","Syrc"]);function ca(s){return!Ry.test(String.fromCodePoint(s))}const ap=Fh(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Bh(s){return!(s!==746&&s!==747&&(s<4352||!(Lt["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||Lt["CJK Compatibility"](s)||Lt["CJK Strokes"](s)||!(!Lt["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||Lt["Enclosed CJK Letters and Months"](s)||Lt["Ideographic Description Characters"](s)||Lt.Kanbun(s)||Lt.Katakana(s)&&s!==12540||!(!Lt["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!Lt["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||Lt["Vertical Forms"](s)||Lt["Yijing Hexagram Symbols"](s)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(s))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(s))||ap.test(String.fromCodePoint(s)))))}function lp(s){return!(Bh(s)||function(r){return!!(Lt["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||Lt["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||Lt["Letterlike Symbols"](r)||Lt["Number Forms"](r)||Lt["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||Lt["Control Pictures"](r)&&r!==9251||Lt["Optical Character Recognition"](r)||Lt["Enclosed Alphanumerics"](r)||Lt["Geometric Shapes"](r)||Lt["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||Lt["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Lt["CJK Symbols and Punctuation"](r)||Lt.Katakana(r)||Lt["Private Use Area"](r)||Lt["CJK Compatibility Forms"](r)||Lt["Small Form Variants"](r)||Lt["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(s))}const Ly=Fh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Oh(s){return Ly.test(String.fromCodePoint(s))}function Fy(s,r){return!(!r&&Oh(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||Lt.Khmer(s))}function By(s){for(const r of s)if(Oh(r.charCodeAt(0)))return!0;return!1}const Yr=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class un{constructor(r,o){this.zoom=r,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Rh,this.transition={})}isSupportedScript(r){return function(o,c){for(const g of o)if(!Fy(g.charCodeAt(0),c))return!1;return!0}(r,Yr.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,o=r-Math.floor(r),c=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*o}}}class ha{constructor(r,o){this.property=r,this.value=o,this.expression=function(c,g){if(mu(c))return new sa(c,g);if(_u(c)){const v=vh(c,g);if(v.result==="error")throw new Error(v.value.map(x=>`${x.key}: ${x.message}`).join(", "));return v.value}{let v=c;return g.type==="color"&&typeof c=="string"?v=Ht.parse(c):g.type!=="padding"||typeof c!="number"&&!Array.isArray(c)?g.type==="variableAnchorOffsetCollection"&&Array.isArray(c)&&(v=ui.parse(c)):v=Hr.parse(c),{kind:"constant",evaluate:()=>v}}}(o===void 0?r.specification.default:o,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,o,c){return this.property.possiblyEvaluate(this,r,o,c)}}class Eu{constructor(r){this.property=r,this.value=new ha(r,void 0)}transitioned(r,o){return new up(this.property,this.value,o,we({},r.transition,this.transition),r.now)}untransitioned(){return new up(this.property,this.value,null,{},0)}}class Iu{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return Ve(this._values[r].value.value)}setValue(r,o){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new Eu(this._values[r].property)),this._values[r].value=new ha(this._values[r].property,o===null?void 0:Ve(o))}getTransition(r){return Ve(this._values[r].transition)}setTransition(r,o){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new Eu(this._values[r].property)),this._values[r].transition=Ve(o)||void 0}serialize(){const r={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(r[o]=c);const g=this.getTransition(o);g!==void 0&&(r[`${o}-transition`]=g)}return r}transitioned(r,o){const c=new ml(this._properties);for(const g of Object.keys(this._values))c._values[g]=this._values[g].transitioned(r,o._values[g]);return c}untransitioned(){const r=new ml(this._properties);for(const o of Object.keys(this._values))r._values[o]=this._values[o].untransitioned();return r}}class up{constructor(r,o,c,g,v){this.property=r,this.value=o,this.begin=v+g.delay||0,this.end=this.begin+g.duration||0,r.specification.transition&&(g.delay||g.duration)&&(this.prior=c)}possiblyEvaluate(r,o,c){const g=r.now||0,v=this.value.possiblyEvaluate(r,o,c),x=this.prior;if(x){if(g>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(g<this.begin)return x.possiblyEvaluate(r,o,c);{const b=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(r,o,c),v,function(S){if(S<=0)return 0;if(S>=1)return 1;const P=S*S,M=P*S;return 4*(S<.5?M:3*(S-P)+M-.75)}(b))}}return v}}class ml{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,o,c){const g=new yl(this._properties);for(const v of Object.keys(this._values))g._values[v]=this._values[v].possiblyEvaluate(r,o,c);return g}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class gl{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}hasValue(r){return this._values[r].value!==void 0}getValue(r){return Ve(this._values[r].value)}setValue(r,o){this._values[r]=new ha(this._values[r].property,o===null?void 0:Ve(o))}serialize(){const r={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(r[o]=c)}return r}possiblyEvaluate(r,o,c){const g=new yl(this._properties);for(const v of Object.keys(this._values))g._values[v]=this._values[v].possiblyEvaluate(r,o,c);return g}}class ns{constructor(r,o,c){this.property=r,this.value=o,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,o,c,g){return this.property.evaluate(this.value,this.parameters,r,o,c,g)}}class yl{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class at{constructor(r){this.specification=r}possiblyEvaluate(r,o){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(o)}interpolate(r,o,c){const g=Mr[this.specification.type];return g?g(r,o,c):r}}class yt{constructor(r,o){this.specification=r,this.overrides=o}possiblyEvaluate(r,o,c,g){return new ns(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(o,null,{},c,g)}:r.expression,o)}interpolate(r,o,c){if(r.value.kind!=="constant"||o.value.kind!=="constant")return r;if(r.value.value===void 0||o.value.value===void 0)return new ns(this,{kind:"constant",value:void 0},r.parameters);const g=Mr[this.specification.type];if(g){const v=g(r.value.value,o.value.value,c);return new ns(this,{kind:"constant",value:v},r.parameters)}return r}evaluate(r,o,c,g,v,x){return r.kind==="constant"?r.value:r.evaluate(o,c,g,v,x)}}class Mu extends yt{possiblyEvaluate(r,o,c,g){if(r.value===void 0)return new ns(this,{kind:"constant",value:void 0},o);if(r.expression.kind==="constant"){const v=r.expression.evaluate(o,null,{},c,g),x=r.property.specification.type==="resolvedImage"&&typeof v!="string"?v.name:v,b=this._calculate(x,x,x,o);return new ns(this,{kind:"constant",value:b},o)}if(r.expression.kind==="camera"){const v=this._calculate(r.expression.evaluate({zoom:o.zoom-1}),r.expression.evaluate({zoom:o.zoom}),r.expression.evaluate({zoom:o.zoom+1}),o);return new ns(this,{kind:"constant",value:v},o)}return new ns(this,r.expression,o)}evaluate(r,o,c,g,v,x){if(r.kind==="source"){const b=r.evaluate(o,c,g,v,x);return this._calculate(b,b,b,o)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(o.zoom)-1},c,g),r.evaluate({zoom:Math.floor(o.zoom)},c,g),r.evaluate({zoom:Math.floor(o.zoom)+1},c,g),o):r.value}_calculate(r,o,c,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:o}:{from:c,to:o}}interpolate(r){return r}}class Au{constructor(r){this.specification=r}possiblyEvaluate(r,o,c,g){if(r.value!==void 0){if(r.expression.kind==="constant"){const v=r.expression.evaluate(o,null,{},c,g);return this._calculate(v,v,v,o)}return this._calculate(r.expression.evaluate(new un(Math.floor(o.zoom-1),o)),r.expression.evaluate(new un(Math.floor(o.zoom),o)),r.expression.evaluate(new un(Math.floor(o.zoom+1),o)),o)}}_calculate(r,o,c,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:o}:{from:c,to:o}}interpolate(r){return r}}class Vh{constructor(r){this.specification=r}possiblyEvaluate(r,o,c,g){return!!r.expression.evaluate(o,null,{},c,g)}interpolate(){return!1}}class _{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in r){const c=r[o];c.specification.overridable&&this.overridableProperties.push(o);const g=this.defaultPropertyValues[o]=new ha(c,void 0),v=this.defaultTransitionablePropertyValues[o]=new Eu(c);this.defaultTransitioningPropertyValues[o]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=g.possiblyEvaluate({})}}}it("DataDrivenProperty",yt),it("DataConstantProperty",at),it("CrossFadedDataDrivenProperty",Mu),it("CrossFadedProperty",Au),it("ColorRampProperty",Vh);const n="-transition";class l extends Fs{constructor(r,o){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),o.layout&&(this._unevaluatedLayout=new gl(o.layout)),o.paint)){this._transitionablePaint=new Iu(o.paint);for(const c in r.paint)this.setPaintProperty(c,r.paint[c],{validate:!1});for(const c in r.layout)this.setLayoutProperty(c,r.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new yl(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,o,c={}){o!=null&&this._validate(sp,`layers.${this.id}.layout.${r}`,r,o,c)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,o):this.visibility=o)}getPaintProperty(r){return r.endsWith(n)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,o,c={}){if(o!=null&&this._validate(ip,`layers.${this.id}.paint.${r}`,r,o,c))return!1;if(r.endsWith(n))return this._transitionablePaint.setTransition(r.slice(0,-11),o||void 0),!1;{const g=this._transitionablePaint._values[r],v=g.property.specification["property-type"]==="cross-faded-data-driven",x=g.value.isDataDriven(),b=g.value;this._transitionablePaint.setValue(r,o),this._handleSpecialPaintPropertyUpdate(r);const S=this._transitionablePaint._values[r].value;return S.isDataDriven()||x||v||this._handleOverridablePaintPropertyUpdate(r,b,S)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,o,c){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,o){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,o)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),$e(r,(o,c)=>!(o===void 0||c==="layout"&&!Object.keys(o).length||c==="paint"&&!Object.keys(o).length))}_validate(r,o,c,g,v={}){return(!v||v.validate!==!1)&&zh(this,r.call(bo,{key:o,layerType:this.type,objectKey:c,value:g,styleSpec:ke,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const o=this.paint.get(r);if(o instanceof ns&&ea(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const d={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class m{constructor(r,o){this._structArray=r,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class y{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,o){return r._trim(),o&&(r.isTransferred=!0,o.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const o=Object.create(this.prototype);return o.arrayBuffer=r.arrayBuffer,o.length=r.length,o.capacity=r.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function w(s,r=1){let o=0,c=0;return{members:s.map(g=>{const v=d[g.type].BYTES_PER_ELEMENT,x=o=C(o,Math.max(r,v)),b=g.components||1;return c=Math.max(c,v),o+=v*b,{name:g.name,type:g.type,components:b,offset:x}}),size:C(o,Math.max(c,r)),alignment:r}}function C(s,r){return Math.ceil(s/r)*r}class k extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o){const c=this.length;return this.resize(c+1),this.emplace(c,r,o)}emplace(r,o,c){const g=2*r;return this.int16[g+0]=o,this.int16[g+1]=c,r}}k.prototype.bytesPerElement=4,it("StructArrayLayout2i4",k);class A extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,c)}emplace(r,o,c,g){const v=3*r;return this.int16[v+0]=o,this.int16[v+1]=c,this.int16[v+2]=g,r}}A.prototype.bytesPerElement=6,it("StructArrayLayout3i6",A);class L extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,o,c,g)}emplace(r,o,c,g,v){const x=4*r;return this.int16[x+0]=o,this.int16[x+1]=c,this.int16[x+2]=g,this.int16[x+3]=v,r}}L.prototype.bytesPerElement=8,it("StructArrayLayout4i8",L);class F extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,c,g,v,x)}emplace(r,o,c,g,v,x,b){const S=6*r;return this.int16[S+0]=o,this.int16[S+1]=c,this.int16[S+2]=g,this.int16[S+3]=v,this.int16[S+4]=x,this.int16[S+5]=b,r}}F.prototype.bytesPerElement=12,it("StructArrayLayout2i4i12",F);class $ extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,c,g,v,x)}emplace(r,o,c,g,v,x,b){const S=4*r,P=8*r;return this.int16[S+0]=o,this.int16[S+1]=c,this.uint8[P+4]=g,this.uint8[P+5]=v,this.uint8[P+6]=x,this.uint8[P+7]=b,r}}$.prototype.bytesPerElement=8,it("StructArrayLayout2i4ub8",$);class H extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o){const c=this.length;return this.resize(c+1),this.emplace(c,r,o)}emplace(r,o,c){const g=2*r;return this.float32[g+0]=o,this.float32[g+1]=c,r}}H.prototype.bytesPerElement=8,it("StructArrayLayout2f8",H);class Y extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x,b,S,P,M){const R=this.length;return this.resize(R+1),this.emplace(R,r,o,c,g,v,x,b,S,P,M)}emplace(r,o,c,g,v,x,b,S,P,M,R){const B=10*r;return this.uint16[B+0]=o,this.uint16[B+1]=c,this.uint16[B+2]=g,this.uint16[B+3]=v,this.uint16[B+4]=x,this.uint16[B+5]=b,this.uint16[B+6]=S,this.uint16[B+7]=P,this.uint16[B+8]=M,this.uint16[B+9]=R,r}}Y.prototype.bytesPerElement=20,it("StructArrayLayout10ui20",Y);class ie extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x,b,S,P,M,R,B){const N=this.length;return this.resize(N+1),this.emplace(N,r,o,c,g,v,x,b,S,P,M,R,B)}emplace(r,o,c,g,v,x,b,S,P,M,R,B,N){const q=12*r;return this.int16[q+0]=o,this.int16[q+1]=c,this.int16[q+2]=g,this.int16[q+3]=v,this.uint16[q+4]=x,this.uint16[q+5]=b,this.uint16[q+6]=S,this.uint16[q+7]=P,this.int16[q+8]=M,this.int16[q+9]=R,this.int16[q+10]=B,this.int16[q+11]=N,r}}ie.prototype.bytesPerElement=24,it("StructArrayLayout4i4ui4i24",ie);class ae extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,c)}emplace(r,o,c,g){const v=3*r;return this.float32[v+0]=o,this.float32[v+1]=c,this.float32[v+2]=g,r}}ae.prototype.bytesPerElement=12,it("StructArrayLayout3f12",ae);class ue extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.uint32[1*r+0]=o,r}}ue.prototype.bytesPerElement=4,it("StructArrayLayout1ul4",ue);class de extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x,b,S,P){const M=this.length;return this.resize(M+1),this.emplace(M,r,o,c,g,v,x,b,S,P)}emplace(r,o,c,g,v,x,b,S,P,M){const R=10*r,B=5*r;return this.int16[R+0]=o,this.int16[R+1]=c,this.int16[R+2]=g,this.int16[R+3]=v,this.int16[R+4]=x,this.int16[R+5]=b,this.uint32[B+3]=S,this.uint16[R+8]=P,this.uint16[R+9]=M,r}}de.prototype.bytesPerElement=20,it("StructArrayLayout6i1ul2ui20",de);class ee extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,c,g,v,x)}emplace(r,o,c,g,v,x,b){const S=6*r;return this.int16[S+0]=o,this.int16[S+1]=c,this.int16[S+2]=g,this.int16[S+3]=v,this.int16[S+4]=x,this.int16[S+5]=b,r}}ee.prototype.bytesPerElement=12,it("StructArrayLayout2i2i2i12",ee);class ye extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v){const x=this.length;return this.resize(x+1),this.emplace(x,r,o,c,g,v)}emplace(r,o,c,g,v,x){const b=4*r,S=8*r;return this.float32[b+0]=o,this.float32[b+1]=c,this.float32[b+2]=g,this.int16[S+6]=v,this.int16[S+7]=x,r}}ye.prototype.bytesPerElement=16,it("StructArrayLayout2f1f2i16",ye);class ve extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,c,g,v,x)}emplace(r,o,c,g,v,x,b){const S=16*r,P=4*r,M=8*r;return this.uint8[S+0]=o,this.uint8[S+1]=c,this.float32[P+1]=g,this.float32[P+2]=v,this.int16[M+6]=x,this.int16[M+7]=b,r}}ve.prototype.bytesPerElement=16,it("StructArrayLayout2ub2f2i16",ve);class Te extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,c)}emplace(r,o,c,g){const v=3*r;return this.uint16[v+0]=o,this.uint16[v+1]=c,this.uint16[v+2]=g,r}}Te.prototype.bytesPerElement=6,it("StructArrayLayout3ui6",Te);class Re extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x,b,S,P,M,R,B,N,q,W,te,oe){const Se=this.length;return this.resize(Se+1),this.emplace(Se,r,o,c,g,v,x,b,S,P,M,R,B,N,q,W,te,oe)}emplace(r,o,c,g,v,x,b,S,P,M,R,B,N,q,W,te,oe,Se){const pe=24*r,xe=12*r,Pe=48*r;return this.int16[pe+0]=o,this.int16[pe+1]=c,this.uint16[pe+2]=g,this.uint16[pe+3]=v,this.uint32[xe+2]=x,this.uint32[xe+3]=b,this.uint32[xe+4]=S,this.uint16[pe+10]=P,this.uint16[pe+11]=M,this.uint16[pe+12]=R,this.float32[xe+7]=B,this.float32[xe+8]=N,this.uint8[Pe+36]=q,this.uint8[Pe+37]=W,this.uint8[Pe+38]=te,this.uint32[xe+10]=oe,this.int16[pe+22]=Se,r}}Re.prototype.bytesPerElement=48,it("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Re);class je extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x,b,S,P,M,R,B,N,q,W,te,oe,Se,pe,xe,Pe,Be,tt,gt,Je,Ke,ct,st){const rt=this.length;return this.resize(rt+1),this.emplace(rt,r,o,c,g,v,x,b,S,P,M,R,B,N,q,W,te,oe,Se,pe,xe,Pe,Be,tt,gt,Je,Ke,ct,st)}emplace(r,o,c,g,v,x,b,S,P,M,R,B,N,q,W,te,oe,Se,pe,xe,Pe,Be,tt,gt,Je,Ke,ct,st,rt){const Me=32*r,ht=16*r;return this.int16[Me+0]=o,this.int16[Me+1]=c,this.int16[Me+2]=g,this.int16[Me+3]=v,this.int16[Me+4]=x,this.int16[Me+5]=b,this.int16[Me+6]=S,this.int16[Me+7]=P,this.uint16[Me+8]=M,this.uint16[Me+9]=R,this.uint16[Me+10]=B,this.uint16[Me+11]=N,this.uint16[Me+12]=q,this.uint16[Me+13]=W,this.uint16[Me+14]=te,this.uint16[Me+15]=oe,this.uint16[Me+16]=Se,this.uint16[Me+17]=pe,this.uint16[Me+18]=xe,this.uint16[Me+19]=Pe,this.uint16[Me+20]=Be,this.uint16[Me+21]=tt,this.uint16[Me+22]=gt,this.uint32[ht+12]=Je,this.float32[ht+13]=Ke,this.float32[ht+14]=ct,this.uint16[Me+30]=st,this.uint16[Me+31]=rt,r}}je.prototype.bytesPerElement=64,it("StructArrayLayout8i15ui1ul2f2ui64",je);class Ye extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.float32[1*r+0]=o,r}}Ye.prototype.bytesPerElement=4,it("StructArrayLayout1f4",Ye);class nt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,c)}emplace(r,o,c,g){const v=3*r;return this.uint16[6*r+0]=o,this.float32[v+1]=c,this.float32[v+2]=g,r}}nt.prototype.bytesPerElement=12,it("StructArrayLayout1ui2f12",nt);class Ze extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,c)}emplace(r,o,c,g){const v=4*r;return this.uint32[2*r+0]=o,this.uint16[v+2]=c,this.uint16[v+3]=g,r}}Ze.prototype.bytesPerElement=8,it("StructArrayLayout1ul2ui8",Ze);class We extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o){const c=this.length;return this.resize(c+1),this.emplace(c,r,o)}emplace(r,o,c){const g=2*r;return this.uint16[g+0]=o,this.uint16[g+1]=c,r}}We.prototype.bytesPerElement=4,it("StructArrayLayout2ui4",We);class lt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.uint16[1*r+0]=o,r}}lt.prototype.bytesPerElement=2,it("StructArrayLayout1ui2",lt);class St extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,o,c,g)}emplace(r,o,c,g,v){const x=4*r;return this.float32[x+0]=o,this.float32[x+1]=c,this.float32[x+2]=g,this.float32[x+3]=v,r}}St.prototype.bytesPerElement=16,it("StructArrayLayout4f16",St);class Xe extends m{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new z(this.anchorPointX,this.anchorPointY)}}Xe.prototype.size=20;class Qe extends de{get(r){return new Xe(this,r)}}it("CollisionBoxArray",Qe);class bt extends m{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}bt.prototype.size=48;class cn extends Re{get(r){return new bt(this,r)}}it("PlacedSymbolArray",cn);class It extends m{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}It.prototype.size=64;class Rt extends je{get(r){return new It(this,r)}}it("SymbolInstanceArray",Rt);class hn extends Ye{getoffsetX(r){return this.float32[1*r+0]}}it("GlyphOffsetArray",hn);class lr extends A{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}it("SymbolLineVertexArray",lr);class zi extends m{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}zi.prototype.size=12;class dn extends nt{get(r){return new zi(this,r)}}it("TextAnchorOffsetArray",dn);class zr extends m{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}zr.prototype.size=8;class xr extends Ze{get(r){return new zr(this,r)}}it("FeatureIndexArray",xr);class ur extends k{}class br extends k{}class rs extends k{}class da extends F{}class zu extends ${}class fa extends H{}class fi extends Y{}class Du extends ie{}class Nh extends ae{}class pi extends ue{}class mi extends ee{}class js extends ve{}class Di extends Te{}class er extends We{}const cr=w([{name:"a_pos",components:2,type:"Int16"}],4),{members:Jr}=cr;class Ft{constructor(r=[]){this.segments=r}prepareSegment(r,o,c,g){let v=this.segments[this.segments.length-1];return r>Ft.MAX_VERTEX_ARRAY_LENGTH&&ze(`Max vertices per segment is ${Ft.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!v||v.vertexLength+r>Ft.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==g)&&(v={vertexOffset:o.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},g!==void 0&&(v.sortKey=g),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const r of this.segments)for(const o in r.vaos)r.vaos[o].destroy()}static simpleSegment(r,o,c,g){return new Ft([{vertexOffset:r,primitiveOffset:o,vertexLength:c,primitiveLength:g,vaos:{},sortKey:0}])}}function wo(s,r){return 256*(s=ge(Math.floor(s),0,255))+ge(Math.floor(r),0,255)}Ft.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,it("SegmentVector",Ft);const pa=w([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ma={exports:{}},cp={exports:{}};cp.exports=function(s,r){var o,c,g,v,x,b,S,P;for(c=s.length-(o=3&s.length),g=r,x=3432918353,b=461845907,P=0;P<c;)S=255&s.charCodeAt(P)|(255&s.charCodeAt(++P))<<8|(255&s.charCodeAt(++P))<<16|(255&s.charCodeAt(++P))<<24,++P,g=27492+(65535&(v=5*(65535&(g=(g^=S=(65535&(S=(S=(65535&S)*x+(((S>>>16)*x&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(S=0,o){case 3:S^=(255&s.charCodeAt(P+2))<<16;case 2:S^=(255&s.charCodeAt(P+1))<<8;case 1:g^=S=(65535&(S=(S=(65535&(S^=255&s.charCodeAt(P)))*x+(((S>>>16)*x&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295}return g^=s.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var Oy=cp.exports,hp={exports:{}};hp.exports=function(s,r){for(var o,c=s.length,g=r^c,v=0;c>=4;)o=1540483477*(65535&(o=255&s.charCodeAt(v)|(255&s.charCodeAt(++v))<<8|(255&s.charCodeAt(++v))<<16|(255&s.charCodeAt(++v))<<24))+((1540483477*(o>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),c-=4,++v;switch(c){case 3:g^=(255&s.charCodeAt(v+2))<<16;case 2:g^=(255&s.charCodeAt(v+1))<<8;case 1:g=1540483477*(65535&(g^=255&s.charCodeAt(v)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var $s=Oy,dp=hp.exports;ma.exports=$s,ma.exports.murmur3=$s,ma.exports.murmur2=dp;var Ru=T(ma.exports);class _l{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,o,c,g){this.ids.push(Lu(r)),this.positions.push(o,c,g)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=Lu(r);let c=0,g=this.ids.length-1;for(;c<g;){const x=c+g>>1;this.ids[x]>=o?g=x:c=x+1}const v=[];for(;this.ids[c]===o;)v.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return v}static serialize(r,o){const c=new Float64Array(r.ids),g=new Uint32Array(r.positions);return Fu(c,g,0,c.length-1),o&&o.push(c.buffer,g.buffer),{ids:c,positions:g}}static deserialize(r){const o=new _l;return o.ids=r.ids,o.positions=r.positions,o.indexed=!0,o}}function Lu(s){const r=+s;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:Ru(String(s))}function Fu(s,r,o,c){for(;o<c;){const g=s[o+c>>1];let v=o-1,x=c+1;for(;;){do v++;while(s[v]<g);do x--;while(s[x]>g);if(v>=x)break;ga(s,v,x),ga(r,3*v,3*x),ga(r,3*v+1,3*x+1),ga(r,3*v+2,3*x+2)}x-o<c-x?(Fu(s,r,o,x),o=x+1):(Fu(s,r,x+1,c),c=x)}}function ga(s,r,o){const c=s[r];s[r]=s[o],s[o]=c}it("FeaturePositionMap",_l);class vl{constructor(r,o){this.gl=r.gl,this.location=o}}class fp extends vl{constructor(r,o){super(r,o),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class G1 extends vl{constructor(r,o){super(r,o),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class W1 extends vl{constructor(r,o){super(r,o),this.current=Ht.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const LI=new Float32Array(16);function Vy(s){return[wo(255*s.r,255*s.g),wo(255*s.b,255*s.a)]}class jh{constructor(r,o,c){this.value=r,this.uniformNames=o.map(g=>`u_${g}`),this.type=c}setUniform(r,o,c){r.set(c.constantOr(this.value))}getBinding(r,o,c){return this.type==="color"?new W1(r,o):new fp(r,o)}}class Bu{constructor(r,o){this.uniformNames=o.map(c=>`u_${c}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=r.tlbr}setUniform(r,o,c,g){const v=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;v&&r.set(v)}getBinding(r,o,c){return c.substr(0,9)==="u_pattern"?new G1(r,o):new fp(r,o)}}class So{constructor(r,o,c,g){this.expression=r,this.type=c,this.maxValue=0,this.paintVertexAttributes=o.map(v=>({name:`a_${v}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(r,o,c,g,v){const x=this.paintVertexArray.length,b=this.expression.evaluate(new un(0),o,{},g,[],v);this.paintVertexArray.resize(r),this._setPaintValue(x,r,b)}updatePaintArray(r,o,c,g){const v=this.expression.evaluate({zoom:0},c,g);this._setPaintValue(r,o,v)}_setPaintValue(r,o,c){if(this.type==="color"){const g=Vy(c);for(let v=r;v<o;v++)this.paintVertexArray.emplace(v,g[0],g[1])}else{for(let g=r;g<o;g++)this.paintVertexArray.emplace(g,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Cs{constructor(r,o,c,g,v,x){this.expression=r,this.uniformNames=o.map(b=>`u_${b}_t`),this.type=c,this.useIntegerZoom=g,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=o.map(b=>({name:`a_${b}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(r,o,c,g,v){const x=this.expression.evaluate(new un(this.zoom),o,{},g,[],v),b=this.expression.evaluate(new un(this.zoom+1),o,{},g,[],v),S=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(S,r,x,b)}updatePaintArray(r,o,c,g){const v=this.expression.evaluate({zoom:this.zoom},c,g),x=this.expression.evaluate({zoom:this.zoom+1},c,g);this._setPaintValue(r,o,v,x)}_setPaintValue(r,o,c,g){if(this.type==="color"){const v=Vy(c),x=Vy(g);for(let b=r;b<o;b++)this.paintVertexArray.emplace(b,v[0],v[1],x[0],x[1])}else{for(let v=r;v<o;v++)this.paintVertexArray.emplace(v,c,g);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(g))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,o){const c=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,g=ge(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);r.set(g)}getBinding(r,o,c){return new fp(r,o)}}class ya{constructor(r,o,c,g,v,x){this.expression=r,this.type=o,this.useIntegerZoom=c,this.zoom=g,this.layerId=x,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(r,o,c){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(g,r,o.patterns&&o.patterns[this.layerId],c)}updatePaintArray(r,o,c,g,v){this._setPaintValues(r,o,c.patterns&&c.patterns[this.layerId],v)}_setPaintValues(r,o,c,g){if(!g||!c)return;const{min:v,mid:x,max:b}=c,S=g[v],P=g[x],M=g[b];if(S&&P&&M)for(let R=r;R<o;R++)this.zoomInPaintVertexArray.emplace(R,P.tl[0],P.tl[1],P.br[0],P.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],P.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(R,P.tl[0],P.tl[1],P.br[0],P.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],P.pixelRatio,M.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,pa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,pa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Z1{constructor(r,o,c){this.binders={},this._buffers=[];const g=[];for(const v in r.paint._values){if(!c(v))continue;const x=r.paint.get(v);if(!(x instanceof ns&&ea(x.property.specification)))continue;const b=FI(v,r.type),S=x.value,P=x.property.specification.type,M=x.property.useIntegerZoom,R=x.property.specification["property-type"],B=R==="cross-faded"||R==="cross-faded-data-driven";if(S.kind==="constant")this.binders[v]=B?new Bu(S.value,b):new jh(S.value,b,P),g.push(`/u_${v}`);else if(S.kind==="source"||B){const N=H1(v,P,"source");this.binders[v]=B?new ya(S,P,M,o,N,r.id):new So(S,b,P,N),g.push(`/a_${v}`)}else{const N=H1(v,P,"composite");this.binders[v]=new Cs(S,b,P,M,o,N),g.push(`/z_${v}`)}}this.cacheKey=g.sort().join("")}getMaxValue(r){const o=this.binders[r];return o instanceof So||o instanceof Cs?o.maxValue:0}populatePaintArrays(r,o,c,g,v){for(const x in this.binders){const b=this.binders[x];(b instanceof So||b instanceof Cs||b instanceof ya)&&b.populatePaintArray(r,o,c,g,v)}}setConstantPatternPositions(r,o){for(const c in this.binders){const g=this.binders[c];g instanceof Bu&&g.setConstantPatternPositions(r,o)}}updatePaintArrays(r,o,c,g,v){let x=!1;for(const b in r){const S=o.getPositions(b);for(const P of S){const M=c.feature(P.index);for(const R in this.binders){const B=this.binders[R];if((B instanceof So||B instanceof Cs||B instanceof ya)&&B.expression.isStateDependent===!0){const N=g.paint.get(R);B.expression=N.value,B.updatePaintArray(P.start,P.end,M,r[b],v),x=!0}}}}return x}defines(){const r=[];for(const o in this.binders){const c=this.binders[o];(c instanceof jh||c instanceof Bu)&&r.push(...c.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return r}getBinderAttributes(){const r=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof So||c instanceof Cs)for(let g=0;g<c.paintVertexAttributes.length;g++)r.push(c.paintVertexAttributes[g].name);else if(c instanceof ya)for(let g=0;g<pa.members.length;g++)r.push(pa.members[g].name)}return r}getBinderUniforms(){const r=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof jh||c instanceof Bu||c instanceof Cs)for(const g of c.uniformNames)r.push(g)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,o){const c=[];for(const g in this.binders){const v=this.binders[g];if(v instanceof jh||v instanceof Bu||v instanceof Cs){for(const x of v.uniformNames)if(o[x]){const b=v.getBinding(r,o[x],x);c.push({name:x,property:g,binding:b})}}}return c}setUniforms(r,o,c,g){for(const{name:v,property:x,binding:b}of o)this.binders[x].setUniform(b,g,c.get(x),v)}updatePaintBuffers(r){this._buffers=[];for(const o in this.binders){const c=this.binders[o];if(r&&c instanceof ya){const g=r.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(c instanceof So||c instanceof Cs)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(r){for(const o in this.binders){const c=this.binders[o];(c instanceof So||c instanceof Cs||c instanceof ya)&&c.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const o=this.binders[r];(o instanceof So||o instanceof Cs||o instanceof ya)&&o.destroy()}}}class xl{constructor(r,o,c=()=>!0){this.programConfigurations={};for(const g of r)this.programConfigurations[g.id]=new Z1(g,o,c);this.needsUpload=!1,this._featureMap=new _l,this._bufferOffset=0}populatePaintArrays(r,o,c,g,v,x){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(r,o,g,v,x);o.id!==void 0&&this._featureMap.add(o.id,c,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,o,c,g){for(const v of c)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(r,this._featureMap,o,v,g)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function FI(s,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${r}-`,"").replace(/-/g,"_")]}function H1(s,r,o){const c={color:{source:H,composite:St},number:{source:Ye,composite:H}},g=function(v){return{"line-pattern":{source:fi,composite:fi},"fill-pattern":{source:fi,composite:fi},"fill-extrusion-pattern":{source:fi,composite:fi}}[v]}(s);return g&&g[o]||c[r][o]}it("ConstantBinder",jh),it("CrossFadedConstantBinder",Bu),it("SourceExpressionBinder",So),it("CrossFadedCompositeBinder",ya),it("CompositeExpressionBinder",Cs),it("ProgramConfiguration",Z1,{omit:["_buffers"]}),it("ProgramConfigurationSet",xl);const Fn=8192,Ny=Math.pow(2,14)-1,X1=-Ny-1;function bl(s){const r=Fn/s.extent,o=s.loadGeometry();for(let c=0;c<o.length;c++){const g=o[c];for(let v=0;v<g.length;v++){const x=g[v],b=Math.round(x.x*r),S=Math.round(x.y*r);x.x=ge(b,X1,Ny),x.y=ge(S,X1,Ny),(b<x.x||b>x.x+1||S<x.y||S>x.y+1)&&ze("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function wl(s,r){return{type:s.type,id:s.id,properties:s.properties,geometry:r?bl(s):[]}}function pp(s,r,o,c,g){s.emplaceBack(2*r+(c+1)/2,2*o+(g+1)/2)}class jy{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new br,this.indexArray=new Di,this.segments=new Ft,this.programConfigurations=new xl(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,c){const g=this.layers[0],v=[];let x=null,b=!1;g.type==="circle"&&(x=g.layout.get("circle-sort-key"),b=!x.isConstant());for(const{feature:S,id:P,index:M,sourceLayerIndex:R}of r){const B=this.layers[0]._featureFilter.needGeometry,N=wl(S,B);if(!this.layers[0]._featureFilter.filter(new un(this.zoom),N,c))continue;const q=b?x.evaluate(N,{},c):void 0,W={id:P,properties:S.properties,type:S.type,sourceLayerIndex:R,index:M,geometry:B?N.geometry:bl(S),patterns:{},sortKey:q};v.push(W)}b&&v.sort((S,P)=>S.sortKey-P.sortKey);for(const S of v){const{geometry:P,index:M,sourceLayerIndex:R}=S,B=r[M].feature;this.addFeature(S,P,M,c),o.featureIndex.insert(B,P,M,R,this.index)}}update(r,o,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Jr),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,o,c,g){for(const v of o)for(const x of v){const b=x.x,S=x.y;if(b<0||b>=Fn||S<0||S>=Fn)continue;const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),M=P.vertexLength;pp(this.layoutVertexArray,b,S,-1,-1),pp(this.layoutVertexArray,b,S,1,-1),pp(this.layoutVertexArray,b,S,1,1),pp(this.layoutVertexArray,b,S,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+3,M+2),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,{},g)}}function K1(s,r){for(let o=0;o<s.length;o++)if(Ou(r,s[o]))return!0;for(let o=0;o<r.length;o++)if(Ou(s,r[o]))return!0;return!!$y(s,r)}function BI(s,r,o){return!!Ou(s,r)||!!Uy(r,s,o)}function Y1(s,r){if(s.length===1)return Q1(r,s[0]);for(let o=0;o<r.length;o++){const c=r[o];for(let g=0;g<c.length;g++)if(Ou(s,c[g]))return!0}for(let o=0;o<s.length;o++)if(Q1(r,s[o]))return!0;for(let o=0;o<r.length;o++)if($y(s,r[o]))return!0;return!1}function OI(s,r,o){if(s.length>1){if($y(s,r))return!0;for(let c=0;c<r.length;c++)if(Uy(r[c],s,o))return!0}for(let c=0;c<s.length;c++)if(Uy(s[c],r,o))return!0;return!1}function $y(s,r){if(s.length===0||r.length===0)return!1;for(let o=0;o<s.length-1;o++){const c=s[o],g=s[o+1];for(let v=0;v<r.length-1;v++)if(VI(c,g,r[v],r[v+1]))return!0}return!1}function VI(s,r,o,c){return Le(s,o,c)!==Le(r,o,c)&&Le(s,r,o)!==Le(s,r,c)}function Uy(s,r,o){const c=o*o;if(r.length===1)return s.distSqr(r[0])<c;for(let g=1;g<r.length;g++)if(J1(s,r[g-1],r[g])<c)return!0;return!1}function J1(s,r,o){const c=r.distSqr(o);if(c===0)return s.distSqr(r);const g=((s.x-r.x)*(o.x-r.x)+(s.y-r.y)*(o.y-r.y))/c;return s.distSqr(g<0?r:g>1?o:o.sub(r)._mult(g)._add(r))}function Q1(s,r){let o,c,g,v=!1;for(let x=0;x<s.length;x++){o=s[x];for(let b=0,S=o.length-1;b<o.length;S=b++)c=o[b],g=o[S],c.y>r.y!=g.y>r.y&&r.x<(g.x-c.x)*(r.y-c.y)/(g.y-c.y)+c.x&&(v=!v)}return v}function Ou(s,r){let o=!1;for(let c=0,g=s.length-1;c<s.length;g=c++){const v=s[c],x=s[g];v.y>r.y!=x.y>r.y&&r.x<(x.x-v.x)*(r.y-v.y)/(x.y-v.y)+v.x&&(o=!o)}return o}function NI(s,r,o){const c=o[0],g=o[2];if(s.x<c.x&&r.x<c.x||s.x>g.x&&r.x>g.x||s.y<c.y&&r.y<c.y||s.y>g.y&&r.y>g.y)return!1;const v=Le(s,r,o[0]);return v!==Le(s,r,o[1])||v!==Le(s,r,o[2])||v!==Le(s,r,o[3])}function $h(s,r,o){const c=r.paint.get(s).value;return c.kind==="constant"?c.value:o.programConfigurations.get(r.id).getMaxValue(s)}function mp(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function gp(s,r,o,c,g){if(!r[0]&&!r[1])return s;const v=z.convert(r)._mult(g);o==="viewport"&&v._rotate(-c);const x=[];for(let b=0;b<s.length;b++)x.push(s[b].sub(v));return x}let eb,tb;it("CircleBucket",jy,{omit:["layers"]});var jI={get paint(){return tb=tb||new _({"circle-radius":new yt(ke.paint_circle["circle-radius"]),"circle-color":new yt(ke.paint_circle["circle-color"]),"circle-blur":new yt(ke.paint_circle["circle-blur"]),"circle-opacity":new yt(ke.paint_circle["circle-opacity"]),"circle-translate":new at(ke.paint_circle["circle-translate"]),"circle-translate-anchor":new at(ke.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new at(ke.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new at(ke.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new yt(ke.paint_circle["circle-stroke-width"]),"circle-stroke-color":new yt(ke.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new yt(ke.paint_circle["circle-stroke-opacity"])})},get layout(){return eb=eb||new _({"circle-sort-key":new yt(ke.layout_circle["circle-sort-key"])})}},Dr=1e-6,Vu=typeof Float32Array<"u"?Float32Array:Array;function qy(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function nb(s,r,o){var c=r[0],g=r[1],v=r[2],x=r[3],b=r[4],S=r[5],P=r[6],M=r[7],R=r[8],B=r[9],N=r[10],q=r[11],W=r[12],te=r[13],oe=r[14],Se=r[15],pe=o[0],xe=o[1],Pe=o[2],Be=o[3];return s[0]=pe*c+xe*b+Pe*R+Be*W,s[1]=pe*g+xe*S+Pe*B+Be*te,s[2]=pe*v+xe*P+Pe*N+Be*oe,s[3]=pe*x+xe*M+Pe*q+Be*Se,s[4]=(pe=o[4])*c+(xe=o[5])*b+(Pe=o[6])*R+(Be=o[7])*W,s[5]=pe*g+xe*S+Pe*B+Be*te,s[6]=pe*v+xe*P+Pe*N+Be*oe,s[7]=pe*x+xe*M+Pe*q+Be*Se,s[8]=(pe=o[8])*c+(xe=o[9])*b+(Pe=o[10])*R+(Be=o[11])*W,s[9]=pe*g+xe*S+Pe*B+Be*te,s[10]=pe*v+xe*P+Pe*N+Be*oe,s[11]=pe*x+xe*M+Pe*q+Be*Se,s[12]=(pe=o[12])*c+(xe=o[13])*b+(Pe=o[14])*R+(Be=o[15])*W,s[13]=pe*g+xe*S+Pe*B+Be*te,s[14]=pe*v+xe*P+Pe*N+Be*oe,s[15]=pe*x+xe*M+Pe*q+Be*Se,s}Math.hypot||(Math.hypot=function(){for(var s=0,r=arguments.length;r--;)s+=arguments[r]*arguments[r];return Math.sqrt(s)});var Uh,$I=nb;function yp(s,r,o){var c=r[0],g=r[1],v=r[2],x=r[3];return s[0]=o[0]*c+o[4]*g+o[8]*v+o[12]*x,s[1]=o[1]*c+o[5]*g+o[9]*v+o[13]*x,s[2]=o[2]*c+o[6]*g+o[10]*v+o[14]*x,s[3]=o[3]*c+o[7]*g+o[11]*v+o[15]*x,s}Uh=new Vu(4),Vu!=Float32Array&&(Uh[0]=0,Uh[1]=0,Uh[2]=0,Uh[3]=0);class UI extends l{constructor(r){super(r,jI)}createBucket(r){return new jy(r)}queryRadius(r){const o=r;return $h("circle-radius",this,o)+$h("circle-stroke-width",this,o)+mp(this.paint.get("circle-translate"))}queryIntersectsFeature(r,o,c,g,v,x,b,S){const P=gp(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,b),M=this.paint.get("circle-radius").evaluate(o,c)+this.paint.get("circle-stroke-width").evaluate(o,c),R=this.paint.get("circle-pitch-alignment")==="map",B=R?P:function(q,W){return q.map(te=>rb(te,W))}(P,S),N=R?M*b:M;for(const q of g)for(const W of q){const te=R?W:rb(W,S);let oe=N;const Se=yp([],[W.x,W.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?oe*=Se[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(oe*=x.cameraToCenterDistance/Se[3]),BI(B,te,oe))return!0}return!1}}function rb(s,r){const o=yp([],[s.x,s.y,0,1],r);return new z(o[0]/o[3],o[1]/o[3])}class ib extends jy{}let sb;it("HeatmapBucket",ib,{omit:["layers"]});var qI={get paint(){return sb=sb||new _({"heatmap-radius":new yt(ke.paint_heatmap["heatmap-radius"]),"heatmap-weight":new yt(ke.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new at(ke.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Vh(ke.paint_heatmap["heatmap-color"]),"heatmap-opacity":new at(ke.paint_heatmap["heatmap-opacity"])})}};function Gy(s,{width:r,height:o},c,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==r*o*c)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${r*o*c}`)}else g=new Uint8Array(r*o*c);return s.width=r,s.height=o,s.data=g,s}function ob(s,{width:r,height:o},c){if(r===s.width&&o===s.height)return;const g=Gy({},{width:r,height:o},c);Wy(s,g,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,r),height:Math.min(s.height,o)},c),s.width=r,s.height=o,s.data=g.data}function Wy(s,r,o,c,g,v){if(g.width===0||g.height===0)return r;if(g.width>s.width||g.height>s.height||o.x>s.width-g.width||o.y>s.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>r.width||g.height>r.height||c.x>r.width-g.width||c.y>r.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const x=s.data,b=r.data;if(x===b)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<g.height;S++){const P=((o.y+S)*s.width+o.x)*v,M=((c.y+S)*r.width+c.x)*v;for(let R=0;R<g.width*v;R++)b[M+R]=x[P+R]}return r}class qh{constructor(r,o){Gy(this,r,1,o)}resize(r){ob(this,r,1)}clone(){return new qh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,o,c,g,v){Wy(r,o,c,g,v,1)}}class Ri{constructor(r,o){Gy(this,r,4,o)}resize(r){ob(this,r,4)}replace(r,o){o?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Ri({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,o,c,g,v){Wy(r,o,c,g,v,4)}}function ab(s){const r={},o=s.resolution||256,c=s.clips?s.clips.length:1,g=s.image||new Ri({width:o,height:c});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const v=(x,b,S)=>{r[s.evaluationKey]=S;const P=s.expression.evaluate(r);g.data[x+b+0]=Math.floor(255*P.r/P.a),g.data[x+b+1]=Math.floor(255*P.g/P.a),g.data[x+b+2]=Math.floor(255*P.b/P.a),g.data[x+b+3]=Math.floor(255*P.a)};if(s.clips)for(let x=0,b=0;x<c;++x,b+=4*o)for(let S=0,P=0;S<o;S++,P+=4){const M=S/(o-1),{start:R,end:B}=s.clips[x];v(b,P,R*(1-M)+B*M)}else for(let x=0,b=0;x<o;x++,b+=4)v(0,b,x/(o-1));return g}it("AlphaImage",qh),it("RGBAImage",Ri);const Zy="big-fb";class GI extends l{createBucket(r){return new ib(r)}constructor(r){super(r,qI),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ab({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Zy)&&this.heatmapFbos.delete(Zy)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let lb;var WI={get paint(){return lb=lb||new _({"hillshade-illumination-direction":new at(ke.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new at(ke.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new at(ke.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new at(ke.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new at(ke.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new at(ke.paint_hillshade["hillshade-accent-color"])})}};class ZI extends l{constructor(r){super(r,WI)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const HI=w([{name:"a_pos",components:2,type:"Int16"}],4),{members:XI}=HI;function ub(s,r,o=2){const c=r&&r.length,g=c?r[0]*o:s.length;let v=cb(s,0,g,o,!0);const x=[];if(!v||v.next===v.prev)return x;let b,S,P;if(c&&(v=function(M,R,B,N){const q=[];for(let W=0,te=R.length;W<te;W++){const oe=cb(M,R[W]*N,W<te-1?R[W+1]*N:M.length,N,!1);oe===oe.next&&(oe.steiner=!0),q.push(rM(oe))}q.sort(eM);for(let W=0;W<q.length;W++)B=tM(q[W],B);return B}(s,r,v,o)),s.length>80*o){b=1/0,S=1/0;let M=-1/0,R=-1/0;for(let B=o;B<g;B+=o){const N=s[B],q=s[B+1];N<b&&(b=N),q<S&&(S=q),N>M&&(M=N),q>R&&(R=q)}P=Math.max(M-b,R-S),P=P!==0?32767/P:0}return Gh(v,x,o,b,S,P,0),x}function cb(s,r,o,c,g){let v;if(g===function(x,b,S,P){let M=0;for(let R=b,B=S-P;R<S;R+=P)M+=(x[B]-x[R])*(x[R+1]+x[B+1]),B=R;return M}(s,r,o,c)>0)for(let x=r;x<o;x+=c)v=fb(x/c|0,s[x],s[x+1],v);else for(let x=o-c;x>=r;x-=c)v=fb(x/c|0,s[x],s[x+1],v);return v&&_p(v,v.next)&&(Zh(v),v=v.next),v}function Sl(s,r){if(!s)return s;r||(r=s);let o,c=s;do if(o=!1,c.steiner||!_p(c,c.next)&&En(c.prev,c,c.next)!==0)c=c.next;else{if(Zh(c),c=r=c.prev,c===c.next)break;o=!0}while(o||c!==r);return r}function Gh(s,r,o,c,g,v,x){if(!s)return;!x&&v&&function(S,P,M,R){let B=S;do B.z===0&&(B.z=Hy(B.x,B.y,P,M,R)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==S);B.prevZ.nextZ=null,B.prevZ=null,function(N){let q,W=1;do{let te,oe=N;N=null;let Se=null;for(q=0;oe;){q++;let pe=oe,xe=0;for(let Be=0;Be<W&&(xe++,pe=pe.nextZ,pe);Be++);let Pe=W;for(;xe>0||Pe>0&&pe;)xe!==0&&(Pe===0||!pe||oe.z<=pe.z)?(te=oe,oe=oe.nextZ,xe--):(te=pe,pe=pe.nextZ,Pe--),Se?Se.nextZ=te:N=te,te.prevZ=Se,Se=te;oe=pe}Se.nextZ=null,W*=2}while(q>1)}(B)}(s,c,g,v);let b=s;for(;s.prev!==s.next;){const S=s.prev,P=s.next;if(v?YI(s,c,g,v):KI(s))r.push(S.i,s.i,P.i),Zh(s),s=P.next,b=P.next;else if((s=P)===b){x?x===1?Gh(s=JI(Sl(s),r),r,o,c,g,v,2):x===2&&QI(s,r,o,c,g,v):Gh(Sl(s),r,o,c,g,v,1);break}}}function KI(s){const r=s.prev,o=s,c=s.next;if(En(r,o,c)>=0)return!1;const g=r.x,v=o.x,x=c.x,b=r.y,S=o.y,P=c.y,M=g<v?g<x?g:x:v<x?v:x,R=b<S?b<P?b:P:S<P?S:P,B=g>v?g>x?g:x:v>x?v:x,N=b>S?b>P?b:P:S>P?S:P;let q=c.next;for(;q!==r;){if(q.x>=M&&q.x<=B&&q.y>=R&&q.y<=N&&Nu(g,b,v,S,x,P,q.x,q.y)&&En(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function YI(s,r,o,c){const g=s.prev,v=s,x=s.next;if(En(g,v,x)>=0)return!1;const b=g.x,S=v.x,P=x.x,M=g.y,R=v.y,B=x.y,N=b<S?b<P?b:P:S<P?S:P,q=M<R?M<B?M:B:R<B?R:B,W=b>S?b>P?b:P:S>P?S:P,te=M>R?M>B?M:B:R>B?R:B,oe=Hy(N,q,r,o,c),Se=Hy(W,te,r,o,c);let pe=s.prevZ,xe=s.nextZ;for(;pe&&pe.z>=oe&&xe&&xe.z<=Se;){if(pe.x>=N&&pe.x<=W&&pe.y>=q&&pe.y<=te&&pe!==g&&pe!==x&&Nu(b,M,S,R,P,B,pe.x,pe.y)&&En(pe.prev,pe,pe.next)>=0||(pe=pe.prevZ,xe.x>=N&&xe.x<=W&&xe.y>=q&&xe.y<=te&&xe!==g&&xe!==x&&Nu(b,M,S,R,P,B,xe.x,xe.y)&&En(xe.prev,xe,xe.next)>=0))return!1;xe=xe.nextZ}for(;pe&&pe.z>=oe;){if(pe.x>=N&&pe.x<=W&&pe.y>=q&&pe.y<=te&&pe!==g&&pe!==x&&Nu(b,M,S,R,P,B,pe.x,pe.y)&&En(pe.prev,pe,pe.next)>=0)return!1;pe=pe.prevZ}for(;xe&&xe.z<=Se;){if(xe.x>=N&&xe.x<=W&&xe.y>=q&&xe.y<=te&&xe!==g&&xe!==x&&Nu(b,M,S,R,P,B,xe.x,xe.y)&&En(xe.prev,xe,xe.next)>=0)return!1;xe=xe.nextZ}return!0}function JI(s,r){let o=s;do{const c=o.prev,g=o.next.next;!_p(c,g)&&hb(c,o,o.next,g)&&Wh(c,g)&&Wh(g,c)&&(r.push(c.i,o.i,g.i),Zh(o),Zh(o.next),o=s=g),o=o.next}while(o!==s);return Sl(o)}function QI(s,r,o,c,g,v){let x=s;do{let b=x.next.next;for(;b!==x.prev;){if(x.i!==b.i&&iM(x,b)){let S=db(x,b);return x=Sl(x,x.next),S=Sl(S,S.next),Gh(x,r,o,c,g,v,0),void Gh(S,r,o,c,g,v,0)}b=b.next}x=x.next}while(x!==s)}function eM(s,r){return s.x-r.x}function tM(s,r){const o=function(g,v){let x=v;const b=g.x,S=g.y;let P,M=-1/0;do{if(S<=x.y&&S>=x.next.y&&x.next.y!==x.y){const W=x.x+(S-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(W<=b&&W>M&&(M=W,P=x.x<x.next.x?x:x.next,W===b))return P}x=x.next}while(x!==v);if(!P)return null;const R=P,B=P.x,N=P.y;let q=1/0;x=P;do{if(b>=x.x&&x.x>=B&&b!==x.x&&Nu(S<N?b:M,S,B,N,S<N?M:b,S,x.x,x.y)){const W=Math.abs(S-x.y)/(b-x.x);Wh(x,g)&&(W<q||W===q&&(x.x>P.x||x.x===P.x&&nM(P,x)))&&(P=x,q=W)}x=x.next}while(x!==R);return P}(s,r);if(!o)return r;const c=db(o,s);return Sl(c,c.next),Sl(o,o.next)}function nM(s,r){return En(s.prev,s,r.prev)<0&&En(r.next,s,s.next)<0}function Hy(s,r,o,c,g){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-o)*g|0)|s<<8))|s<<4))|s<<2))|s<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-c)*g|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function rM(s){let r=s,o=s;do(r.x<o.x||r.x===o.x&&r.y<o.y)&&(o=r),r=r.next;while(r!==s);return o}function Nu(s,r,o,c,g,v,x,b){return(g-x)*(r-b)>=(s-x)*(v-b)&&(s-x)*(c-b)>=(o-x)*(r-b)&&(o-x)*(v-b)>=(g-x)*(c-b)}function iM(s,r){return s.next.i!==r.i&&s.prev.i!==r.i&&!function(o,c){let g=o;do{if(g.i!==o.i&&g.next.i!==o.i&&g.i!==c.i&&g.next.i!==c.i&&hb(g,g.next,o,c))return!0;g=g.next}while(g!==o);return!1}(s,r)&&(Wh(s,r)&&Wh(r,s)&&function(o,c){let g=o,v=!1;const x=(o.x+c.x)/2,b=(o.y+c.y)/2;do g.y>b!=g.next.y>b&&g.next.y!==g.y&&x<(g.next.x-g.x)*(b-g.y)/(g.next.y-g.y)+g.x&&(v=!v),g=g.next;while(g!==o);return v}(s,r)&&(En(s.prev,s,r.prev)||En(s,r.prev,r))||_p(s,r)&&En(s.prev,s,s.next)>0&&En(r.prev,r,r.next)>0)}function En(s,r,o){return(r.y-s.y)*(o.x-r.x)-(r.x-s.x)*(o.y-r.y)}function _p(s,r){return s.x===r.x&&s.y===r.y}function hb(s,r,o,c){const g=xp(En(s,r,o)),v=xp(En(s,r,c)),x=xp(En(o,c,s)),b=xp(En(o,c,r));return g!==v&&x!==b||!(g!==0||!vp(s,o,r))||!(v!==0||!vp(s,c,r))||!(x!==0||!vp(o,s,c))||!(b!==0||!vp(o,r,c))}function vp(s,r,o){return r.x<=Math.max(s.x,o.x)&&r.x>=Math.min(s.x,o.x)&&r.y<=Math.max(s.y,o.y)&&r.y>=Math.min(s.y,o.y)}function xp(s){return s>0?1:s<0?-1:0}function Wh(s,r){return En(s.prev,s,s.next)<0?En(s,r,s.next)>=0&&En(s,s.prev,r)>=0:En(s,r,s.prev)<0||En(s,s.next,r)<0}function db(s,r){const o=Xy(s.i,s.x,s.y),c=Xy(r.i,r.x,r.y),g=s.next,v=r.prev;return s.next=r,r.prev=s,o.next=g,g.prev=o,c.next=o,o.prev=c,v.next=c,c.prev=v,c}function fb(s,r,o,c){const g=Xy(s,r,o);return c?(g.next=c.next,g.prev=c,c.next.prev=g,c.next=g):(g.prev=g,g.next=g),g}function Zh(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Xy(s,r,o){return{i:s,x:r,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Ky(s,r,o){const c=o.patternDependencies;let g=!1;for(const v of r){const x=v.paint.get(`${s}-pattern`);x.isConstant()||(g=!0);const b=x.constantOr(null);b&&(g=!0,c[b.to]=!0,c[b.from]=!0)}return g}function Yy(s,r,o,c,g){const v=g.patternDependencies;for(const x of r){const b=x.paint.get(`${s}-pattern`).value;if(b.kind!=="constant"){let S=b.evaluate({zoom:c-1},o,{},g.availableImages),P=b.evaluate({zoom:c},o,{},g.availableImages),M=b.evaluate({zoom:c+1},o,{},g.availableImages);S=S&&S.name?S.name:S,P=P&&P.name?P.name:P,M=M&&M.name?M.name:M,v[S]=!0,v[P]=!0,v[M]=!0,o.patterns[x.id]={min:S,mid:P,max:M}}}return o}class Jy{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new rs,this.indexArray=new Di,this.indexArray2=new er,this.programConfigurations=new xl(r.layers,r.zoom),this.segments=new Ft,this.segments2=new Ft,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,c){this.hasPattern=Ky("fill",this.layers,o);const g=this.layers[0].layout.get("fill-sort-key"),v=!g.isConstant(),x=[];for(const{feature:b,id:S,index:P,sourceLayerIndex:M}of r){const R=this.layers[0]._featureFilter.needGeometry,B=wl(b,R);if(!this.layers[0]._featureFilter.filter(new un(this.zoom),B,c))continue;const N=v?g.evaluate(B,{},c,o.availableImages):void 0,q={id:S,properties:b.properties,type:b.type,sourceLayerIndex:M,index:P,geometry:R?B.geometry:bl(b),patterns:{},sortKey:N};x.push(q)}v&&x.sort((b,S)=>b.sortKey-S.sortKey);for(const b of x){const{geometry:S,index:P,sourceLayerIndex:M}=b;if(this.hasPattern){const R=Yy("fill",this.layers,b,this.zoom,o);this.patternFeatures.push(R)}else this.addFeature(b,S,P,c,{});o.featureIndex.insert(r[P].feature,S,P,M,this.index)}}update(r,o,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,c)}addFeatures(r,o,c){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,o,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,XI),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,o,c,g,v){for(const x of cu(o,500)){let b=0;for(const N of x)b+=N.length;const S=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),P=S.vertexLength,M=[],R=[];for(const N of x){if(N.length===0)continue;N!==x[0]&&R.push(M.length/2);const q=this.segments2.prepareSegment(N.length,this.layoutVertexArray,this.indexArray2),W=q.vertexLength;this.layoutVertexArray.emplaceBack(N[0].x,N[0].y),this.indexArray2.emplaceBack(W+N.length-1,W),M.push(N[0].x),M.push(N[0].y);for(let te=1;te<N.length;te++)this.layoutVertexArray.emplaceBack(N[te].x,N[te].y),this.indexArray2.emplaceBack(W+te-1,W+te),M.push(N[te].x),M.push(N[te].y);q.vertexLength+=N.length,q.primitiveLength+=N.length}const B=ub(M,R);for(let N=0;N<B.length;N+=3)this.indexArray.emplaceBack(P+B[N],P+B[N+1],P+B[N+2]);S.vertexLength+=b,S.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,v,g)}}let pb,mb;it("FillBucket",Jy,{omit:["layers","patternFeatures"]});var sM={get paint(){return mb=mb||new _({"fill-antialias":new at(ke.paint_fill["fill-antialias"]),"fill-opacity":new yt(ke.paint_fill["fill-opacity"]),"fill-color":new yt(ke.paint_fill["fill-color"]),"fill-outline-color":new yt(ke.paint_fill["fill-outline-color"]),"fill-translate":new at(ke.paint_fill["fill-translate"]),"fill-translate-anchor":new at(ke.paint_fill["fill-translate-anchor"]),"fill-pattern":new Mu(ke.paint_fill["fill-pattern"])})},get layout(){return pb=pb||new _({"fill-sort-key":new yt(ke.layout_fill["fill-sort-key"])})}};class oM extends l{constructor(r){super(r,sM)}recalculate(r,o){super.recalculate(r,o);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Jy(r)}queryRadius(){return mp(this.paint.get("fill-translate"))}queryIntersectsFeature(r,o,c,g,v,x,b){return Y1(gp(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,b),g)}isTileClipped(){return!0}}const aM=w([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),lM=w([{name:"a_centroid",components:2,type:"Int16"}],4),{members:uM}=aM;var _a={},cM=E,gb=ju;function ju(s,r,o,c,g){this.properties={},this.extent=o,this.type=0,this._pbf=s,this._geometry=-1,this._keys=c,this._values=g,s.readFields(hM,this,r)}function hM(s,r,o){s==1?r.id=o.readVarint():s==2?function(c,g){for(var v=c.readVarint()+c.pos;c.pos<v;){var x=g._keys[c.readVarint()],b=g._values[c.readVarint()];g.properties[x]=b}}(o,r):s==3?r.type=o.readVarint():s==4&&(r._geometry=o.pos)}function dM(s){for(var r,o,c=0,g=0,v=s.length,x=v-1;g<v;x=g++)c+=((o=s[x]).x-(r=s[g]).x)*(r.y+o.y);return c}ju.types=["Unknown","Point","LineString","Polygon"],ju.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var r,o=s.readVarint()+s.pos,c=1,g=0,v=0,x=0,b=[];s.pos<o;){if(g<=0){var S=s.readVarint();c=7&S,g=S>>3}if(g--,c===1||c===2)v+=s.readSVarint(),x+=s.readSVarint(),c===1&&(r&&b.push(r),r=[]),r.push(new cM(v,x));else{if(c!==7)throw new Error("unknown command "+c);r&&r.push(r[0].clone())}}return r&&b.push(r),b},ju.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var r=s.readVarint()+s.pos,o=1,c=0,g=0,v=0,x=1/0,b=-1/0,S=1/0,P=-1/0;s.pos<r;){if(c<=0){var M=s.readVarint();o=7&M,c=M>>3}if(c--,o===1||o===2)(g+=s.readSVarint())<x&&(x=g),g>b&&(b=g),(v+=s.readSVarint())<S&&(S=v),v>P&&(P=v);else if(o!==7)throw new Error("unknown command "+o)}return[x,S,b,P]},ju.prototype.toGeoJSON=function(s,r,o){var c,g,v=this.extent*Math.pow(2,o),x=this.extent*s,b=this.extent*r,S=this.loadGeometry(),P=ju.types[this.type];function M(N){for(var q=0;q<N.length;q++){var W=N[q];N[q]=[360*(W.x+x)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(W.y+b)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(c=0;c<S.length;c++)R[c]=S[c][0];M(S=R);break;case 2:for(c=0;c<S.length;c++)M(S[c]);break;case 3:for(S=function(N){var q=N.length;if(q<=1)return[N];for(var W,te,oe=[],Se=0;Se<q;Se++){var pe=dM(N[Se]);pe!==0&&(te===void 0&&(te=pe<0),te===pe<0?(W&&oe.push(W),W=[N[Se]]):W.push(N[Se]))}return W&&oe.push(W),oe}(S),c=0;c<S.length;c++)for(g=0;g<S[c].length;g++)M(S[c][g])}S.length===1?S=S[0]:P="Multi"+P;var B={type:"Feature",geometry:{type:P,coordinates:S},properties:this.properties};return"id"in this&&(B.id=this.id),B};var fM=gb,yb=_b;function _b(s,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(pM,this,r),this.length=this._features.length}function pM(s,r,o){s===15?r.version=o.readVarint():s===1?r.name=o.readString():s===5?r.extent=o.readVarint():s===2?r._features.push(o.pos):s===3?r._keys.push(o.readString()):s===4&&r._values.push(function(c){for(var g=null,v=c.readVarint()+c.pos;c.pos<v;){var x=c.readVarint()>>3;g=x===1?c.readString():x===2?c.readFloat():x===3?c.readDouble():x===4?c.readVarint64():x===5?c.readVarint():x===6?c.readSVarint():x===7?c.readBoolean():null}return g}(o))}_b.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var r=this._pbf.readVarint()+this._pbf.pos;return new fM(this._pbf,r,this.extent,this._keys,this._values)};var mM=yb;function gM(s,r,o){if(s===3){var c=new mM(o,o.readVarint()+o.pos);c.length&&(r[c.name]=c)}}_a.VectorTile=function(s,r){this.layers=s.readFields(gM,{},r)},_a.VectorTileFeature=gb,_a.VectorTileLayer=yb;const yM=_a.VectorTileFeature.types,Qy=Math.pow(2,13);function Hh(s,r,o,c,g,v,x,b){s.emplaceBack(r,o,2*Math.floor(c*Qy)+x,g*Qy*2,v*Qy*2,Math.round(b))}class e_{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new da,this.centroidVertexArray=new ur,this.indexArray=new Di,this.programConfigurations=new xl(r.layers,r.zoom),this.segments=new Ft,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,c){this.features=[],this.hasPattern=Ky("fill-extrusion",this.layers,o);for(const{feature:g,id:v,index:x,sourceLayerIndex:b}of r){const S=this.layers[0]._featureFilter.needGeometry,P=wl(g,S);if(!this.layers[0]._featureFilter.filter(new un(this.zoom),P,c))continue;const M={id:v,sourceLayerIndex:b,index:x,geometry:S?P.geometry:bl(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(Yy("fill-extrusion",this.layers,M,this.zoom,o)):this.addFeature(M,M.geometry,x,c,{}),o.featureIndex.insert(g,M.geometry,x,b,this.index,!0)}}addFeatures(r,o,c){for(const g of this.features){const{geometry:v}=g;this.addFeature(g,v,g.index,o,c)}}update(r,o,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,uM),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,lM.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,o,c,g,v){for(const x of cu(o,500)){const b={x:0,y:0,vertexCount:0};let S=0;for(const q of x)S+=q.length;let P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const q of x){if(q.length===0||vM(q))continue;let W=0;for(let te=0;te<q.length;te++){const oe=q[te];if(te>=1){const Se=q[te-1];if(!_M(oe,Se)){P.vertexLength+4>Ft.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const pe=oe.sub(Se)._perp()._unit(),xe=Se.dist(oe);W+xe>32768&&(W=0),Hh(this.layoutVertexArray,oe.x,oe.y,pe.x,pe.y,0,0,W),Hh(this.layoutVertexArray,oe.x,oe.y,pe.x,pe.y,0,1,W),b.x+=2*oe.x,b.y+=2*oe.y,b.vertexCount+=2,W+=xe,Hh(this.layoutVertexArray,Se.x,Se.y,pe.x,pe.y,0,0,W),Hh(this.layoutVertexArray,Se.x,Se.y,pe.x,pe.y,0,1,W),b.x+=2*Se.x,b.y+=2*Se.y,b.vertexCount+=2;const Pe=P.vertexLength;this.indexArray.emplaceBack(Pe,Pe+2,Pe+1),this.indexArray.emplaceBack(Pe+1,Pe+2,Pe+3),P.vertexLength+=4,P.primitiveLength+=2}}}}if(P.vertexLength+S>Ft.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),yM[r.type]!=="Polygon")continue;const M=[],R=[],B=P.vertexLength;for(const q of x)if(q.length!==0){q!==x[0]&&R.push(M.length/2);for(let W=0;W<q.length;W++){const te=q[W];Hh(this.layoutVertexArray,te.x,te.y,0,0,1,1,0),b.x+=te.x,b.y+=te.y,b.vertexCount+=1,M.push(te.x),M.push(te.y)}}const N=ub(M,R);for(let q=0;q<N.length;q+=3)this.indexArray.emplaceBack(B+N[q],B+N[q+2],B+N[q+1]);P.primitiveLength+=N.length/3,P.vertexLength+=S;for(let q=0;q<b.vertexCount;q++){const W=Math.floor(b.x/b.vertexCount),te=Math.floor(b.y/b.vertexCount);this.centroidVertexArray.emplaceBack(W,te)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,v,g)}}function _M(s,r){return s.x===r.x&&(s.x<0||s.x>Fn)||s.y===r.y&&(s.y<0||s.y>Fn)}function vM(s){return s.every(r=>r.x<0)||s.every(r=>r.x>Fn)||s.every(r=>r.y<0)||s.every(r=>r.y>Fn)}let vb;it("FillExtrusionBucket",e_,{omit:["layers","features"]});var xM={get paint(){return vb=vb||new _({"fill-extrusion-opacity":new at(ke["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new yt(ke["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new at(ke["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new at(ke["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Mu(ke["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new yt(ke["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new yt(ke["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new at(ke["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class bM extends l{constructor(r){super(r,xM)}createBucket(r){return new e_(r)}queryRadius(){return mp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,o,c,g,v,x,b,S){const P=gp(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,b),M=this.paint.get("fill-extrusion-height").evaluate(o,c),R=this.paint.get("fill-extrusion-base").evaluate(o,c),B=function(q,W,te,oe){const Se=[];for(const pe of q){const xe=[pe.x,pe.y,0,1];yp(xe,xe,W),Se.push(new z(xe[0]/xe[3],xe[1]/xe[3]))}return Se}(P,S),N=function(q,W,te,oe){const Se=[],pe=[],xe=oe[8]*W,Pe=oe[9]*W,Be=oe[10]*W,tt=oe[11]*W,gt=oe[8]*te,Je=oe[9]*te,Ke=oe[10]*te,ct=oe[11]*te;for(const st of q){const rt=[],Me=[];for(const ht of st){const ut=ht.x,wt=ht.y,en=oe[0]*ut+oe[4]*wt+oe[12],Yt=oe[1]*ut+oe[5]*wt+oe[13],Zn=oe[2]*ut+oe[6]*wt+oe[14],is=oe[3]*ut+oe[7]*wt+oe[15],dr=Zn+Be,Hn=is+tt,Rr=en+gt,Lr=Yt+Je,Fr=Zn+Ke,Sn=is+ct,Xn=new z((en+xe)/Hn,(Yt+Pe)/Hn);Xn.z=dr/Hn,rt.push(Xn);const wr=new z(Rr/Sn,Lr/Sn);wr.z=Fr/Sn,Me.push(wr)}Se.push(rt),pe.push(Me)}return[Se,pe]}(g,R,M,S);return function(q,W,te){let oe=1/0;Y1(te,W)&&(oe=xb(te,W[0]));for(let Se=0;Se<W.length;Se++){const pe=W[Se],xe=q[Se];for(let Pe=0;Pe<pe.length-1;Pe++){const Be=pe[Pe],tt=[Be,pe[Pe+1],xe[Pe+1],xe[Pe],Be];K1(te,tt)&&(oe=Math.min(oe,xb(te,tt)))}}return oe!==1/0&&oe}(N[0],N[1],B)}}function Xh(s,r){return s.x*r.x+s.y*r.y}function xb(s,r){if(s.length===1){let o=0;const c=r[o++];let g;for(;!g||c.equals(g);)if(g=r[o++],!g)return 1/0;for(;o<r.length;o++){const v=r[o],x=s[0],b=g.sub(c),S=v.sub(c),P=x.sub(c),M=Xh(b,b),R=Xh(b,S),B=Xh(S,S),N=Xh(P,b),q=Xh(P,S),W=M*B-R*R,te=(B*N-R*q)/W,oe=(M*q-R*N)/W,Se=c.z*(1-te-oe)+g.z*te+v.z*oe;if(isFinite(Se))return Se}return 1/0}{let o=1/0;for(const c of r)o=Math.min(o,c.z);return o}}const wM=w([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:SM}=wM,TM=w([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:CM}=TM,kM=_a.VectorTileFeature.types,PM=Math.cos(Math.PI/180*37.5),bb=Math.pow(2,14)/.5;class t_{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new zu,this.layoutVertexArray2=new fa,this.indexArray=new Di,this.programConfigurations=new xl(r.layers,r.zoom),this.segments=new Ft,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,c){this.hasPattern=Ky("line",this.layers,o);const g=this.layers[0].layout.get("line-sort-key"),v=!g.isConstant(),x=[];for(const{feature:b,id:S,index:P,sourceLayerIndex:M}of r){const R=this.layers[0]._featureFilter.needGeometry,B=wl(b,R);if(!this.layers[0]._featureFilter.filter(new un(this.zoom),B,c))continue;const N=v?g.evaluate(B,{},c):void 0,q={id:S,properties:b.properties,type:b.type,sourceLayerIndex:M,index:P,geometry:R?B.geometry:bl(b),patterns:{},sortKey:N};x.push(q)}v&&x.sort((b,S)=>b.sortKey-S.sortKey);for(const b of x){const{geometry:S,index:P,sourceLayerIndex:M}=b;if(this.hasPattern){const R=Yy("line",this.layers,b,this.zoom,o);this.patternFeatures.push(R)}else this.addFeature(b,S,P,c,{});o.featureIndex.insert(r[P].feature,S,P,M,this.index)}}update(r,o,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,c)}addFeatures(r,o,c){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,o,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,CM)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,SM),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,o,c,g,v){const x=this.layers[0].layout,b=x.get("line-join").evaluate(r,{}),S=x.get("line-cap"),P=x.get("line-miter-limit"),M=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const R of o)this.addLine(R,r,b,S,P,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,v,g)}addLine(r,o,c,g,v,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let oe=0;oe<r.length-1;oe++)this.totalDistance+=r[oe].dist(r[oe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=kM[o.type]==="Polygon";let S=r.length;for(;S>=2&&r[S-1].equals(r[S-2]);)S--;let P=0;for(;P<S-1&&r[P].equals(r[P+1]);)P++;if(S<(b?3:2))return;c==="bevel"&&(v=1.05);const M=this.overscaling<=16?15*Fn/(512*this.overscaling):0,R=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let B,N,q,W,te;this.e1=this.e2=-1,b&&(B=r[S-2],te=r[P].sub(B)._unit()._perp());for(let oe=P;oe<S;oe++){if(q=oe===S-1?b?r[P+1]:void 0:r[oe+1],q&&r[oe].equals(q))continue;te&&(W=te),B&&(N=B),B=r[oe],te=q?q.sub(B)._unit()._perp():W,W=W||te;let Se=W.add(te);Se.x===0&&Se.y===0||Se._unit();const pe=W.x*te.x+W.y*te.y,xe=Se.x*te.x+Se.y*te.y,Pe=xe!==0?1/xe:1/0,Be=2*Math.sqrt(2-2*xe),tt=xe<PM&&N&&q,gt=W.x*te.y-W.y*te.x>0;if(tt&&oe>P){const ct=B.dist(N);if(ct>2*M){const st=B.sub(B.sub(N)._mult(M/ct)._round());this.updateDistance(N,st),this.addCurrentVertex(st,W,0,0,R),N=st}}const Je=N&&q;let Ke=Je?c:b?"butt":g;if(Je&&Ke==="round"&&(Pe<x?Ke="miter":Pe<=2&&(Ke="fakeround")),Ke==="miter"&&Pe>v&&(Ke="bevel"),Ke==="bevel"&&(Pe>2&&(Ke="flipbevel"),Pe<v&&(Ke="miter")),N&&this.updateDistance(N,B),Ke==="miter")Se._mult(Pe),this.addCurrentVertex(B,Se,0,0,R);else if(Ke==="flipbevel"){if(Pe>100)Se=te.mult(-1);else{const ct=Pe*W.add(te).mag()/W.sub(te).mag();Se._perp()._mult(ct*(gt?-1:1))}this.addCurrentVertex(B,Se,0,0,R),this.addCurrentVertex(B,Se.mult(-1),0,0,R)}else if(Ke==="bevel"||Ke==="fakeround"){const ct=-Math.sqrt(Pe*Pe-1),st=gt?ct:0,rt=gt?0:ct;if(N&&this.addCurrentVertex(B,W,st,rt,R),Ke==="fakeround"){const Me=Math.round(180*Be/Math.PI/20);for(let ht=1;ht<Me;ht++){let ut=ht/Me;if(ut!==.5){const en=ut-.5;ut+=ut*en*(ut-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*en*en+(.848013+pe*(.215638*pe-1.06021)))}const wt=te.sub(W)._mult(ut)._add(W)._unit()._mult(gt?-1:1);this.addHalfVertex(B,wt.x,wt.y,!1,gt,0,R)}}q&&this.addCurrentVertex(B,te,-st,-rt,R)}else if(Ke==="butt")this.addCurrentVertex(B,Se,0,0,R);else if(Ke==="square"){const ct=N?1:-1;this.addCurrentVertex(B,Se,ct,ct,R)}else Ke==="round"&&(N&&(this.addCurrentVertex(B,W,0,0,R),this.addCurrentVertex(B,W,1,1,R,!0)),q&&(this.addCurrentVertex(B,te,-1,-1,R,!0),this.addCurrentVertex(B,te,0,0,R)));if(tt&&oe<S-1){const ct=B.dist(q);if(ct>2*M){const st=B.add(q.sub(B)._mult(M/ct)._round());this.updateDistance(B,st),this.addCurrentVertex(st,te,0,0,R),B=st}}}}addCurrentVertex(r,o,c,g,v,x=!1){const b=o.y*g-o.x,S=-o.y-o.x*g;this.addHalfVertex(r,o.x+o.y*c,o.y-o.x*c,x,!1,c,v),this.addHalfVertex(r,b,S,x,!0,-g,v),this.distance>bb/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,o,c,g,v,x))}addHalfVertex({x:r,y:o},c,g,v,x,b,S){const P=.5*(this.lineClips?this.scaledDistance*(bb-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(v?1:0),(o<<1)+(x?1:0),Math.round(63*c)+128,Math.round(63*g)+128,1+(b===0?0:b<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const M=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),S.primitiveLength++),x?this.e2=M:this.e1=M}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,o){this.distance+=r.dist(o),this.updateScaledDistance()}}let wb,Sb;it("LineBucket",t_,{omit:["layers","patternFeatures"]});var Tb={get paint(){return Sb=Sb||new _({"line-opacity":new yt(ke.paint_line["line-opacity"]),"line-color":new yt(ke.paint_line["line-color"]),"line-translate":new at(ke.paint_line["line-translate"]),"line-translate-anchor":new at(ke.paint_line["line-translate-anchor"]),"line-width":new yt(ke.paint_line["line-width"]),"line-gap-width":new yt(ke.paint_line["line-gap-width"]),"line-offset":new yt(ke.paint_line["line-offset"]),"line-blur":new yt(ke.paint_line["line-blur"]),"line-dasharray":new Au(ke.paint_line["line-dasharray"]),"line-pattern":new Mu(ke.paint_line["line-pattern"]),"line-gradient":new Vh(ke.paint_line["line-gradient"])})},get layout(){return wb=wb||new _({"line-cap":new at(ke.layout_line["line-cap"]),"line-join":new yt(ke.layout_line["line-join"]),"line-miter-limit":new at(ke.layout_line["line-miter-limit"]),"line-round-limit":new at(ke.layout_line["line-round-limit"]),"line-sort-key":new yt(ke.layout_line["line-sort-key"])})}};class EM extends yt{possiblyEvaluate(r,o){return o=new un(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(r,o)}evaluate(r,o,c,g){return o=we({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(r,o,c,g)}}let bp;class IM extends l{constructor(r){super(r,Tb),this.gradientVersion=0,bp||(bp=new EM(Tb.paint.properties["line-width"].specification),bp.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(c){return c._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof Ho,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,o){super.recalculate(r,o),this.paint._values["line-floorwidth"]=bp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new t_(r)}queryRadius(r){const o=r,c=Cb($h("line-width",this,o),$h("line-gap-width",this,o)),g=$h("line-offset",this,o);return c/2+Math.abs(g)+mp(this.paint.get("line-translate"))}queryIntersectsFeature(r,o,c,g,v,x,b){const S=gp(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,b),P=b/2*Cb(this.paint.get("line-width").evaluate(o,c),this.paint.get("line-gap-width").evaluate(o,c)),M=this.paint.get("line-offset").evaluate(o,c);return M&&(g=function(R,B){const N=[];for(let q=0;q<R.length;q++){const W=R[q],te=[];for(let oe=0;oe<W.length;oe++){const Se=W[oe-1],pe=W[oe],xe=W[oe+1],Pe=oe===0?new z(0,0):pe.sub(Se)._unit()._perp(),Be=oe===W.length-1?new z(0,0):xe.sub(pe)._unit()._perp(),tt=Pe._add(Be)._unit(),gt=tt.x*Be.x+tt.y*Be.y;gt!==0&&tt._mult(1/gt),te.push(tt._mult(B)._add(pe))}N.push(te)}return N}(g,M*b)),function(R,B,N){for(let q=0;q<B.length;q++){const W=B[q];if(R.length>=3){for(let te=0;te<W.length;te++)if(Ou(R,W[te]))return!0}if(OI(R,W,N))return!0}return!1}(S,g,P)}isTileClipped(){return!0}}function Cb(s,r){return r>0?r+2*s:s}const MM=w([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),AM=w([{name:"a_projected_pos",components:3,type:"Float32"}],4);w([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const zM=w([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);w([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const kb=w([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),DM=w([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function RM(s,r,o){return s.sections.forEach(c=>{c.text=function(g,v,x){const b=v.layout.get("text-transform").evaluate(x,{});return b==="uppercase"?g=g.toLocaleUpperCase():b==="lowercase"&&(g=g.toLocaleLowerCase()),Yr.applyArabicShaping&&(g=Yr.applyArabicShaping(g)),g}(c.text,r,o)}),s}w([{name:"triangle",components:3,type:"Uint16"}]),w([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),w([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),w([{type:"Float32",name:"offsetX"}]),w([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),w([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Kh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var jn=24,Pb=Kt,Eb=function(s,r,o,c,g){var v,x,b=8*g-c-1,S=(1<<b)-1,P=S>>1,M=-7,R=g-1,B=-1,N=s[r+R];for(R+=B,v=N&(1<<-M)-1,N>>=-M,M+=b;M>0;v=256*v+s[r+R],R+=B,M-=8);for(x=v&(1<<-M)-1,v>>=-M,M+=c;M>0;x=256*x+s[r+R],R+=B,M-=8);if(v===0)v=1-P;else{if(v===S)return x?NaN:1/0*(N?-1:1);x+=Math.pow(2,c),v-=P}return(N?-1:1)*x*Math.pow(2,v-c)},Ib=function(s,r,o,c,g,v){var x,b,S,P=8*v-g-1,M=(1<<P)-1,R=M>>1,B=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=0,q=1,W=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(b=isNaN(r)?1:0,x=M):(x=Math.floor(Math.log(r)/Math.LN2),r*(S=Math.pow(2,-x))<1&&(x--,S*=2),(r+=x+R>=1?B/S:B*Math.pow(2,1-R))*S>=2&&(x++,S/=2),x+R>=M?(b=0,x=M):x+R>=1?(b=(r*S-1)*Math.pow(2,g),x+=R):(b=r*Math.pow(2,R-1)*Math.pow(2,g),x=0));g>=8;s[o+N]=255&b,N+=q,b/=256,g-=8);for(x=x<<g|b,P+=g;P>0;s[o+N]=255&x,N+=q,x/=256,P-=8);s[o+N-q]|=128*W};function Kt(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}Kt.Varint=0,Kt.Fixed64=1,Kt.Bytes=2,Kt.Fixed32=5;var n_=4294967296,Mb=1/n_,Ab=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function To(s){return s.type===Kt.Bytes?s.readVarint()+s.pos:s.pos+1}function $u(s,r,o){return o?4294967296*r+(s>>>0):4294967296*(r>>>0)+(s>>>0)}function zb(s,r,o){var c=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));o.realloc(c);for(var g=o.pos-1;g>=s;g--)o.buf[g+c]=o.buf[g]}function LM(s,r){for(var o=0;o<s.length;o++)r.writeVarint(s[o])}function FM(s,r){for(var o=0;o<s.length;o++)r.writeSVarint(s[o])}function BM(s,r){for(var o=0;o<s.length;o++)r.writeFloat(s[o])}function OM(s,r){for(var o=0;o<s.length;o++)r.writeDouble(s[o])}function VM(s,r){for(var o=0;o<s.length;o++)r.writeBoolean(s[o])}function NM(s,r){for(var o=0;o<s.length;o++)r.writeFixed32(s[o])}function jM(s,r){for(var o=0;o<s.length;o++)r.writeSFixed32(s[o])}function $M(s,r){for(var o=0;o<s.length;o++)r.writeFixed64(s[o])}function UM(s,r){for(var o=0;o<s.length;o++)r.writeSFixed64(s[o])}function wp(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+16777216*s[r+3]}function Uu(s,r,o){s[o]=r,s[o+1]=r>>>8,s[o+2]=r>>>16,s[o+3]=r>>>24}function Db(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+(s[r+3]<<24)}Kt.prototype={destroy:function(){this.buf=null},readFields:function(s,r,o){for(o=o||this.length;this.pos<o;){var c=this.readVarint(),g=c>>3,v=this.pos;this.type=7&c,s(g,r,this),this.pos===v&&this.skip(c)}return r},readMessage:function(s,r){return this.readFields(s,r,this.readVarint()+this.pos)},readFixed32:function(){var s=wp(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=Db(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=wp(this.buf,this.pos)+wp(this.buf,this.pos+4)*n_;return this.pos+=8,s},readSFixed64:function(){var s=wp(this.buf,this.pos)+Db(this.buf,this.pos+4)*n_;return this.pos+=8,s},readFloat:function(){var s=Eb(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=Eb(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var r,o,c=this.buf;return r=127&(o=c[this.pos++]),o<128?r:(r|=(127&(o=c[this.pos++]))<<7,o<128?r:(r|=(127&(o=c[this.pos++]))<<14,o<128?r:(r|=(127&(o=c[this.pos++]))<<21,o<128?r:function(g,v,x){var b,S,P=x.buf;if(b=(112&(S=P[x.pos++]))>>4,S<128||(b|=(127&(S=P[x.pos++]))<<3,S<128)||(b|=(127&(S=P[x.pos++]))<<10,S<128)||(b|=(127&(S=P[x.pos++]))<<17,S<128)||(b|=(127&(S=P[x.pos++]))<<24,S<128)||(b|=(1&(S=P[x.pos++]))<<31,S<128))return $u(g,b,v);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(o=c[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,r=this.pos;return this.pos=s,s-r>=12&&Ab?function(o,c,g){return Ab.decode(o.subarray(c,g))}(this.buf,r,s):function(o,c,g){for(var v="",x=c;x<g;){var b,S,P,M=o[x],R=null,B=M>239?4:M>223?3:M>191?2:1;if(x+B>g)break;B===1?M<128&&(R=M):B===2?(192&(b=o[x+1]))==128&&(R=(31&M)<<6|63&b)<=127&&(R=null):B===3?(S=o[x+2],(192&(b=o[x+1]))==128&&(192&S)==128&&((R=(15&M)<<12|(63&b)<<6|63&S)<=2047||R>=55296&&R<=57343)&&(R=null)):B===4&&(S=o[x+2],P=o[x+3],(192&(b=o[x+1]))==128&&(192&S)==128&&(192&P)==128&&((R=(15&M)<<18|(63&b)<<12|(63&S)<<6|63&P)<=65535||R>=1114112)&&(R=null)),R===null?(R=65533,B=1):R>65535&&(R-=65536,v+=String.fromCharCode(R>>>10&1023|55296),R=56320|1023&R),v+=String.fromCharCode(R),x+=B}return v}(this.buf,r,s)},readBytes:function(){var s=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,s);return this.pos=s,r},readPackedVarint:function(s,r){if(this.type!==Kt.Bytes)return s.push(this.readVarint(r));var o=To(this);for(s=s||[];this.pos<o;)s.push(this.readVarint(r));return s},readPackedSVarint:function(s){if(this.type!==Kt.Bytes)return s.push(this.readSVarint());var r=To(this);for(s=s||[];this.pos<r;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==Kt.Bytes)return s.push(this.readBoolean());var r=To(this);for(s=s||[];this.pos<r;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==Kt.Bytes)return s.push(this.readFloat());var r=To(this);for(s=s||[];this.pos<r;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==Kt.Bytes)return s.push(this.readDouble());var r=To(this);for(s=s||[];this.pos<r;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==Kt.Bytes)return s.push(this.readFixed32());var r=To(this);for(s=s||[];this.pos<r;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==Kt.Bytes)return s.push(this.readSFixed32());var r=To(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==Kt.Bytes)return s.push(this.readFixed64());var r=To(this);for(s=s||[];this.pos<r;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==Kt.Bytes)return s.push(this.readSFixed64());var r=To(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed64());return s},skip:function(s){var r=7&s;if(r===Kt.Varint)for(;this.buf[this.pos++]>127;);else if(r===Kt.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Kt.Fixed32)this.pos+=4;else{if(r!==Kt.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(s,r){this.writeVarint(s<<3|r)},realloc:function(s){for(var r=this.length||16;r<this.pos+s;)r*=2;if(r!==this.length){var o=new Uint8Array(r);o.set(this.buf),this.buf=o,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),Uu(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),Uu(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),Uu(this.buf,-1&s,this.pos),Uu(this.buf,Math.floor(s*Mb),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),Uu(this.buf,-1&s,this.pos),Uu(this.buf,Math.floor(s*Mb),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(r,o){var c,g;if(r>=0?(c=r%4294967296|0,g=r/4294967296|0):(g=~(-r/4294967296),4294967295^(c=~(-r%4294967296))?c=c+1|0:(c=0,g=g+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(v,x,b){b.buf[b.pos++]=127&v|128,v>>>=7,b.buf[b.pos++]=127&v|128,v>>>=7,b.buf[b.pos++]=127&v|128,v>>>=7,b.buf[b.pos++]=127&v|128,b.buf[b.pos]=127&(v>>>=7)}(c,0,o),function(v,x){var b=(7&v)<<4;x.buf[x.pos++]|=b|((v>>>=3)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v)))))}(g,o)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var r=this.pos;this.pos=function(c,g,v){for(var x,b,S=0;S<g.length;S++){if((x=g.charCodeAt(S))>55295&&x<57344){if(!b){x>56319||S+1===g.length?(c[v++]=239,c[v++]=191,c[v++]=189):b=x;continue}if(x<56320){c[v++]=239,c[v++]=191,c[v++]=189,b=x;continue}x=b-55296<<10|x-56320|65536,b=null}else b&&(c[v++]=239,c[v++]=191,c[v++]=189,b=null);x<128?c[v++]=x:(x<2048?c[v++]=x>>6|192:(x<65536?c[v++]=x>>12|224:(c[v++]=x>>18|240,c[v++]=x>>12&63|128),c[v++]=x>>6&63|128),c[v++]=63&x|128)}return v}(this.buf,s,this.pos);var o=this.pos-r;o>=128&&zb(r,o,this),this.pos=r-1,this.writeVarint(o),this.pos+=o},writeFloat:function(s){this.realloc(4),Ib(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),Ib(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var r=s.length;this.writeVarint(r),this.realloc(r);for(var o=0;o<r;o++)this.buf[this.pos++]=s[o]},writeRawMessage:function(s,r){this.pos++;var o=this.pos;s(r,this);var c=this.pos-o;c>=128&&zb(o,c,this),this.pos=o-1,this.writeVarint(c),this.pos+=c},writeMessage:function(s,r,o){this.writeTag(s,Kt.Bytes),this.writeRawMessage(r,o)},writePackedVarint:function(s,r){r.length&&this.writeMessage(s,LM,r)},writePackedSVarint:function(s,r){r.length&&this.writeMessage(s,FM,r)},writePackedBoolean:function(s,r){r.length&&this.writeMessage(s,VM,r)},writePackedFloat:function(s,r){r.length&&this.writeMessage(s,BM,r)},writePackedDouble:function(s,r){r.length&&this.writeMessage(s,OM,r)},writePackedFixed32:function(s,r){r.length&&this.writeMessage(s,NM,r)},writePackedSFixed32:function(s,r){r.length&&this.writeMessage(s,jM,r)},writePackedFixed64:function(s,r){r.length&&this.writeMessage(s,$M,r)},writePackedSFixed64:function(s,r){r.length&&this.writeMessage(s,UM,r)},writeBytesField:function(s,r){this.writeTag(s,Kt.Bytes),this.writeBytes(r)},writeFixed32Field:function(s,r){this.writeTag(s,Kt.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(s,r){this.writeTag(s,Kt.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(s,r){this.writeTag(s,Kt.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(s,r){this.writeTag(s,Kt.Fixed64),this.writeSFixed64(r)},writeVarintField:function(s,r){this.writeTag(s,Kt.Varint),this.writeVarint(r)},writeSVarintField:function(s,r){this.writeTag(s,Kt.Varint),this.writeSVarint(r)},writeStringField:function(s,r){this.writeTag(s,Kt.Bytes),this.writeString(r)},writeFloatField:function(s,r){this.writeTag(s,Kt.Fixed32),this.writeFloat(r)},writeDoubleField:function(s,r){this.writeTag(s,Kt.Fixed64),this.writeDouble(r)},writeBooleanField:function(s,r){this.writeVarintField(s,!!r)}};var r_=T(Pb);const i_=3;function qM(s,r,o){s===1&&o.readMessage(GM,r)}function GM(s,r,o){if(s===3){const{id:c,bitmap:g,width:v,height:x,left:b,top:S,advance:P}=o.readMessage(WM,{});r.push({id:c,bitmap:new qh({width:v+2*i_,height:x+2*i_},g),metrics:{width:v,height:x,left:b,top:S,advance:P}})}}function WM(s,r,o){s===1?r.id=o.readVarint():s===2?r.bitmap=o.readBytes():s===3?r.width=o.readVarint():s===4?r.height=o.readVarint():s===5?r.left=o.readSVarint():s===6?r.top=o.readSVarint():s===7&&(r.advance=o.readVarint())}const Rb=i_;function Lb(s){let r=0,o=0;for(const x of s)r+=x.w*x.h,o=Math.max(o,x.w);s.sort((x,b)=>b.h-x.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),o),h:1/0}];let g=0,v=0;for(const x of s)for(let b=c.length-1;b>=0;b--){const S=c[b];if(!(x.w>S.w||x.h>S.h)){if(x.x=S.x,x.y=S.y,v=Math.max(v,x.y+x.h),g=Math.max(g,x.x+x.w),x.w===S.w&&x.h===S.h){const P=c.pop();b<c.length&&(c[b]=P)}else x.h===S.h?(S.x+=x.w,S.w-=x.w):x.w===S.w?(S.y+=x.h,S.h-=x.h):(c.push({x:S.x+x.w,y:S.y,w:S.w-x.w,h:x.h}),S.y+=x.h,S.h-=x.h);break}}return{w:g,h:v,fill:r/(g*v)||0}}const Qr=1;class s_{constructor(r,{pixelRatio:o,version:c,stretchX:g,stretchY:v,content:x,textFitWidth:b,textFitHeight:S}){this.paddedRect=r,this.pixelRatio=o,this.stretchX=g,this.stretchY=v,this.content=x,this.version=c,this.textFitWidth=b,this.textFitHeight=S}get tl(){return[this.paddedRect.x+Qr,this.paddedRect.y+Qr]}get br(){return[this.paddedRect.x+this.paddedRect.w-Qr,this.paddedRect.y+this.paddedRect.h-Qr]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Qr)/this.pixelRatio,(this.paddedRect.h-2*Qr)/this.pixelRatio]}}class Fb{constructor(r,o){const c={},g={};this.haveRenderCallbacks=[];const v=[];this.addImages(r,c,v),this.addImages(o,g,v);const{w:x,h:b}=Lb(v),S=new Ri({width:x||1,height:b||1});for(const P in r){const M=r[P],R=c[P].paddedRect;Ri.copy(M.data,S,{x:0,y:0},{x:R.x+Qr,y:R.y+Qr},M.data)}for(const P in o){const M=o[P],R=g[P].paddedRect,B=R.x+Qr,N=R.y+Qr,q=M.data.width,W=M.data.height;Ri.copy(M.data,S,{x:0,y:0},{x:B,y:N},M.data),Ri.copy(M.data,S,{x:0,y:W-1},{x:B,y:N-1},{width:q,height:1}),Ri.copy(M.data,S,{x:0,y:0},{x:B,y:N+W},{width:q,height:1}),Ri.copy(M.data,S,{x:q-1,y:0},{x:B-1,y:N},{width:1,height:W}),Ri.copy(M.data,S,{x:0,y:0},{x:B+q,y:N},{width:1,height:W})}this.image=S,this.iconPositions=c,this.patternPositions=g}addImages(r,o,c){for(const g in r){const v=r[g],x={x:0,y:0,w:v.data.width+2*Qr,h:v.data.height+2*Qr};c.push(x),o[g]=new s_(x,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(r,o){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in r.updatedImages)this.patchUpdatedImage(this.iconPositions[c],r.getImage(c),o),this.patchUpdatedImage(this.patternPositions[c],r.getImage(c),o)}patchUpdatedImage(r,o,c){if(!r||!o||r.version===o.version)return;r.version=o.version;const[g,v]=r.tl;c.update(o.data,void 0,{x:g,y:v})}}var va;it("ImagePosition",s_),it("ImageAtlas",Fb),f.ah=void 0,(va=f.ah||(f.ah={}))[va.none=0]="none",va[va.horizontal=1]="horizontal",va[va.vertical=2]="vertical",va[va.horizontalOnly=3]="horizontalOnly";const Yh=-17;class Jh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,o){const c=new Jh;return c.scale=r||1,c.fontStack=o,c}static forImage(r){const o=new Jh;return o.imageName=r,o}}class qu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,o){const c=new qu;for(let g=0;g<r.sections.length;g++){const v=r.sections[g];v.image?c.addImageSection(v):c.addTextSection(v,o)}return c}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=function(r){let o="";for(let c=0;c<r.length;c++){const g=r.charCodeAt(c+1)||null,v=r.charCodeAt(c-1)||null;o+=g&&lp(g)&&!Kh[r[c+1]]||v&&lp(v)&&!Kh[r[c-1]]||!Kh[r[c]]?r[c]:Kh[r[c]]}return o}(this.text)}trim(){let r=0;for(let c=0;c<this.text.length&&Tp[this.text.charCodeAt(c)];c++)r++;let o=this.text.length;for(let c=this.text.length-1;c>=0&&c>=r&&Tp[this.text.charCodeAt(c)];c--)o--;this.text=this.text.substring(r,o),this.sectionIndex=this.sectionIndex.slice(r,o)}substring(r,o){const c=new qu;return c.text=this.text.substring(r,o),c.sectionIndex=this.sectionIndex.slice(r,o),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,o)=>Math.max(r,this.sections[o].scale),0)}addTextSection(r,o){this.text+=r.text,this.sections.push(Jh.forText(r.scale,r.fontStack||o));const c=this.sections.length-1;for(let g=0;g<r.text.length;++g)this.sectionIndex.push(c)}addImageSection(r){const o=r.image?r.image.name:"";if(o.length===0)return void ze("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Jh.forImage(o)),this.sectionIndex.push(this.sections.length-1)):ze("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Sp(s,r,o,c,g,v,x,b,S,P,M,R,B,N,q){const W=qu.fromFeature(s,g);let te;R===f.ah.vertical&&W.verticalizePunctuation();const{processBidirectionalText:oe,processStyledBidirectionalText:Se}=Yr;if(oe&&W.sections.length===1){te=[];const Pe=oe(W.toString(),o_(W,P,v,r,c,N));for(const Be of Pe){const tt=new qu;tt.text=Be,tt.sections=W.sections;for(let gt=0;gt<Be.length;gt++)tt.sectionIndex.push(0);te.push(tt)}}else if(Se){te=[];const Pe=Se(W.text,W.sectionIndex,o_(W,P,v,r,c,N));for(const Be of Pe){const tt=new qu;tt.text=Be[0],tt.sectionIndex=Be[1],tt.sections=W.sections,te.push(tt)}}else te=function(Pe,Be){const tt=[],gt=Pe.text;let Je=0;for(const Ke of Be)tt.push(Pe.substring(Je,Ke)),Je=Ke;return Je<gt.length&&tt.push(Pe.substring(Je,gt.length)),tt}(W,o_(W,P,v,r,c,N));const pe=[],xe={positionedLines:pe,text:W.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:R,iconsInText:!1,verticalizable:!1};return function(Pe,Be,tt,gt,Je,Ke,ct,st,rt,Me,ht,ut){let wt=0,en=Yh,Yt=0,Zn=0;const is=st==="right"?1:st==="left"?0:.5;let dr=0;for(const Sn of Je){Sn.trim();const Xn=Sn.getMaxScale(),wr=(Xn-1)*jn,fr={positionedGlyphs:[],lineOffset:0};Pe.positionedLines[dr]=fr;const Br=fr.positionedGlyphs;let pr=0;if(!Sn.length()){en+=Ke,++dr;continue}for(let ei=0;ei<Sn.length();ei++){const Ut=Sn.getSection(ei),nn=Sn.getSectionIndex(ei),fn=Sn.getCharCode(ei);let gi=0,_n=null,Hu=null,qs=null,Gs=jn;const ss=!(rt===f.ah.horizontal||!ht&&!Bh(fn)||ht&&(Tp[fn]||(Hn=fn,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Hn)))));if(Ut.imageName){const Bi=gt[Ut.imageName];if(!Bi)continue;qs=Ut.imageName,Pe.iconsInText=Pe.iconsInText||!0,Hu=Bi.paddedRect;const tr=Bi.displaySize;Ut.scale=Ut.scale*jn/ut,_n={width:tr[0],height:tr[1],left:Qr,top:-Rb,advance:ss?tr[1]:tr[0]},gi=wr+(jn-tr[1]*Ut.scale),Gs=_n.advance;const Co=ss?tr[0]*Ut.scale-jn*Xn:tr[1]*Ut.scale-jn*Xn;Co>0&&Co>pr&&(pr=Co)}else{const Bi=tt[Ut.fontStack],tr=Bi&&Bi[fn];if(tr&&tr.rect)Hu=tr.rect,_n=tr.metrics;else{const Co=Be[Ut.fontStack],id=Co&&Co[fn];if(!id)continue;_n=id.metrics}gi=(Xn-Ut.scale)*jn}ss?(Pe.verticalizable=!0,Br.push({glyph:fn,imageName:qs,x:wt,y:en+gi,vertical:ss,scale:Ut.scale,fontStack:Ut.fontStack,sectionIndex:nn,metrics:_n,rect:Hu}),wt+=Gs*Ut.scale+Me):(Br.push({glyph:fn,imageName:qs,x:wt,y:en+gi,vertical:ss,scale:Ut.scale,fontStack:Ut.fontStack,sectionIndex:nn,metrics:_n,rect:Hu}),wt+=_n.advance*Ut.scale+Me)}Br.length!==0&&(Yt=Math.max(wt-Me,Yt),KM(Br,0,Br.length-1,is,pr)),wt=0;const Fi=Ke*Xn+pr;fr.lineOffset=Math.max(pr,wr),en+=Fi,Zn=Math.max(Fi,Zn),++dr}var Hn;const Rr=en-Yh,{horizontalAlign:Lr,verticalAlign:Fr}=a_(ct);(function(Sn,Xn,wr,fr,Br,pr,Fi,ei,Ut){const nn=(Xn-wr)*Br;let fn=0;fn=pr!==Fi?-ei*fr-Yh:(-fr*Ut+.5)*Fi;for(const gi of Sn)for(const _n of gi.positionedGlyphs)_n.x+=nn,_n.y+=fn})(Pe.positionedLines,is,Lr,Fr,Yt,Zn,Ke,Rr,Je.length),Pe.top+=-Fr*Rr,Pe.bottom=Pe.top+Rr,Pe.left+=-Lr*Yt,Pe.right=Pe.left+Yt}(xe,r,o,c,te,x,b,S,R,P,B,q),!function(Pe){for(const Be of Pe)if(Be.positionedGlyphs.length!==0)return!1;return!0}(pe)&&xe}const Tp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ZM={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},HM={40:!0};function Bb(s,r,o,c,g,v){if(r.imageName){const x=c[r.imageName];return x?x.displaySize[0]*r.scale*jn/v+g:0}{const x=o[r.fontStack],b=x&&x[s];return b?b.metrics.advance*r.scale+g:0}}function Ob(s,r,o,c){const g=Math.pow(s-r,2);return c?s<r?g/2:2*g:g+Math.abs(o)*o}function XM(s,r,o){let c=0;return s===10&&(c-=1e4),o&&(c+=150),s!==40&&s!==65288||(c+=50),r!==41&&r!==65289||(c+=50),c}function Vb(s,r,o,c,g,v){let x=null,b=Ob(r,o,g,v);for(const S of c){const P=Ob(r-S.x,o,g,v)+S.badness;P<=b&&(x=S,b=P)}return{index:s,x:r,priorBreak:x,badness:b}}function Nb(s){return s?Nb(s.priorBreak).concat(s.index):[]}function o_(s,r,o,c,g,v){if(!s)return[];const x=[],b=function(R,B,N,q,W,te){let oe=0;for(let Se=0;Se<R.length();Se++){const pe=R.getSection(Se);oe+=Bb(R.getCharCode(Se),pe,q,W,B,te)}return oe/Math.max(1,Math.ceil(oe/N))}(s,r,o,c,g,v),S=s.text.indexOf("")>=0;let P=0;for(let R=0;R<s.length();R++){const B=s.getSection(R),N=s.getCharCode(R);if(Tp[N]||(P+=Bb(N,B,c,g,r,v)),R<s.length()-1){const q=!((M=N)<11904)&&(!!Lt["CJK Compatibility Forms"](M)||!!Lt["CJK Compatibility"](M)||!!Lt["CJK Strokes"](M)||!!Lt["CJK Symbols and Punctuation"](M)||!!Lt["Enclosed CJK Letters and Months"](M)||!!Lt["Halfwidth and Fullwidth Forms"](M)||!!Lt["Ideographic Description Characters"](M)||!!Lt["Vertical Forms"](M)||ap.test(String.fromCodePoint(M)));(ZM[N]||q||B.imageName||R!==s.length()-2&&HM[s.getCharCode(R+1)])&&x.push(Vb(R+1,P,b,x,XM(N,s.getCharCode(R+1),q&&S),!1))}}var M;return Nb(Vb(s.length(),P,b,x,0,!0))}function a_(s){let r=.5,o=.5;switch(s){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:r,verticalAlign:o}}function KM(s,r,o,c,g){if(!c&&!g)return;const v=s[o],x=(s[o].x+v.metrics.advance*v.scale)*c;for(let b=r;b<=o;b++)s[b].x-=x,s[b].y+=g}function YM(s,r,o){const{horizontalAlign:c,verticalAlign:g}=a_(o),v=r[0]-s.displaySize[0]*c,x=r[1]-s.displaySize[1]*g;return{image:s,top:x,bottom:x+s.displaySize[1],left:v,right:v+s.displaySize[0]}}function jb(s){var r,o;let c=s.left,g=s.top,v=s.right-c,x=s.bottom-g;const b=(r=s.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",S=(o=s.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",P=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(S==="proportional"){if(b==="stretchOnly"&&v/x<P||b==="proportional"){const M=Math.ceil(x*P);c*=M/v,v=M}}else if(b==="proportional"&&S==="stretchOnly"&&P!==0&&v/x>P){const M=Math.ceil(v/P);g*=M/x,x=M}return{x1:c,y1:g,x2:c+v,y2:g+x}}function $b(s,r,o,c,g,v){const x=s.image;let b;if(x.content){const te=x.content,oe=x.pixelRatio||1;b=[te[0]/oe,te[1]/oe,x.displaySize[0]-te[2]/oe,x.displaySize[1]-te[3]/oe]}const S=r.left*v,P=r.right*v;let M,R,B,N;o==="width"||o==="both"?(N=g[0]+S-c[3],R=g[0]+P+c[1]):(N=g[0]+(S+P-x.displaySize[0])/2,R=N+x.displaySize[0]);const q=r.top*v,W=r.bottom*v;return o==="height"||o==="both"?(M=g[1]+q-c[0],B=g[1]+W+c[2]):(M=g[1]+(q+W-x.displaySize[1])/2,B=M+x.displaySize[1]),{image:x,top:M,right:R,bottom:B,left:N,collisionPadding:b}}const Qh=255,Us=128,xa=Qh*Us;function Ub(s,r){const{expression:o}=r;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new un(s+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:g}=o;let v=0;for(;v<c.length&&c[v]<=s;)v++;v=Math.max(0,v-1);let x=v;for(;x<c.length&&c[x]<s+1;)x++;x=Math.min(c.length-1,x);const b=c[v],S=c[x];return o.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:S,interpolationType:g}:{kind:"camera",minZoom:b,maxZoom:S,minSize:o.evaluate(new un(b)),maxSize:o.evaluate(new un(S)),interpolationType:g}}}function l_(s,r,o){let c="never";const g=s.get(r);return g?c=g:s.get(o)&&(c="always"),c}const JM=_a.VectorTileFeature.types,QM=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Cp(s,r,o,c,g,v,x,b,S,P,M,R,B){const N=b?Math.min(xa,Math.round(b[0])):0,q=b?Math.min(xa,Math.round(b[1])):0;s.emplaceBack(r,o,Math.round(32*c),Math.round(32*g),v,x,(N<<1)+(S?1:0),q,16*P,16*M,256*R,256*B)}function u_(s,r,o){s.emplaceBack(r.x,r.y,o),s.emplaceBack(r.x,r.y,o),s.emplaceBack(r.x,r.y,o),s.emplaceBack(r.x,r.y,o)}function eA(s){for(const r of s.sections)if(By(r.text))return!0;return!1}class c_{constructor(r){this.layoutVertexArray=new Du,this.indexArray=new Di,this.programConfigurations=r,this.segments=new Ft,this.dynamicLayoutVertexArray=new Nh,this.opacityVertexArray=new pi,this.hasVisibleVertices=!1,this.placedSymbolArray=new cn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,o,c,g){this.isEmpty()||(c&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,MM.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,AM.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,QM,!0),this.opacityVertexBuffer.itemSize=1),(c||g)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}it("SymbolBuffers",c_);class h_{constructor(r,o,c){this.layoutVertexArray=new r,this.layoutAttributes=o,this.indexArray=new c,this.segments=new Ft,this.collisionVertexArray=new js}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,zM.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}it("CollisionBuffers",h_);class Gu{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(x=>x.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=qy([]),this.placementViewportMatrix=qy([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ub(this.zoom,o["text-size"]),this.iconSizeData=Ub(this.zoom,o["icon-size"]);const c=this.layers[0].layout,g=c.get("symbol-sort-key"),v=c.get("symbol-z-order");this.canOverlap=l_(c,"text-overlap","text-allow-overlap")!=="never"||l_(c,"icon-overlap","icon-allow-overlap")!=="never"||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,c.get("symbol-placement")==="point"&&(this.writingModes=c.get("text-writing-mode").map(x=>f.ah[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=r.sourceID}createArrays(){this.text=new c_(new xl(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new c_(new xl(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new hn,this.lineVertexArray=new lr,this.symbolInstances=new Rt,this.textAnchorOffsets=new dn}calculateGlyphDependencies(r,o,c,g,v){for(let x=0;x<r.length;x++)if(o[r.charCodeAt(x)]=!0,(c||g)&&v){const b=Kh[r.charAt(x)];b&&(o[b.charCodeAt(0)]=!0)}}populate(r,o,c){const g=this.layers[0],v=g.layout,x=v.get("text-font"),b=v.get("text-field"),S=v.get("icon-image"),P=(b.value.kind!=="constant"||b.value.value instanceof Zr&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),M=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,R=v.get("symbol-sort-key");if(this.features=[],!P&&!M)return;const B=o.iconDependencies,N=o.glyphDependencies,q=o.availableImages,W=new un(this.zoom);for(const{feature:te,id:oe,index:Se,sourceLayerIndex:pe}of r){const xe=g._featureFilter.needGeometry,Pe=wl(te,xe);if(!g._featureFilter.filter(W,Pe,c))continue;let Be,tt;if(xe||(Pe.geometry=bl(te)),P){const Je=g.getValueAndResolveTokens("text-field",Pe,c,q),Ke=Zr.factory(Je),ct=this.hasRTLText=this.hasRTLText||eA(Ke);(!ct||Yr.getRTLTextPluginStatus()==="unavailable"||ct&&Yr.isParsed())&&(Be=RM(Ke,g,Pe))}if(M){const Je=g.getValueAndResolveTokens("icon-image",Pe,c,q);tt=Je instanceof Xr?Je:Xr.fromString(Je)}if(!Be&&!tt)continue;const gt=this.sortFeaturesByKey?R.evaluate(Pe,{},c):void 0;if(this.features.push({id:oe,text:Be,icon:tt,index:Se,sourceLayerIndex:pe,geometry:Pe.geometry,properties:te.properties,type:JM[te.type],sortKey:gt}),tt&&(B[tt.name]=!0),Be){const Je=x.evaluate(Pe,{},c).join(","),Ke=v.get("text-rotation-alignment")!=="viewport"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(f.ah.vertical)>=0;for(const ct of Be.sections)if(ct.image)B[ct.image.name]=!0;else{const st=Lh(Be.toString()),rt=ct.fontStack||Je,Me=N[rt]=N[rt]||{};this.calculateGlyphDependencies(ct.text,Me,Ke,this.allowVerticalPlacement,st)}}}v.get("symbol-placement")==="line"&&(this.features=function(te){const oe={},Se={},pe=[];let xe=0;function Pe(Je){pe.push(te[Je]),xe++}function Be(Je,Ke,ct){const st=Se[Je];return delete Se[Je],Se[Ke]=st,pe[st].geometry[0].pop(),pe[st].geometry[0]=pe[st].geometry[0].concat(ct[0]),st}function tt(Je,Ke,ct){const st=oe[Ke];return delete oe[Ke],oe[Je]=st,pe[st].geometry[0].shift(),pe[st].geometry[0]=ct[0].concat(pe[st].geometry[0]),st}function gt(Je,Ke,ct){const st=ct?Ke[0][Ke[0].length-1]:Ke[0][0];return`${Je}:${st.x}:${st.y}`}for(let Je=0;Je<te.length;Je++){const Ke=te[Je],ct=Ke.geometry,st=Ke.text?Ke.text.toString():null;if(!st){Pe(Je);continue}const rt=gt(st,ct),Me=gt(st,ct,!0);if(rt in Se&&Me in oe&&Se[rt]!==oe[Me]){const ht=tt(rt,Me,ct),ut=Be(rt,Me,pe[ht].geometry);delete oe[rt],delete Se[Me],Se[gt(st,pe[ut].geometry,!0)]=ut,pe[ht].geometry=null}else rt in Se?Be(rt,Me,ct):Me in oe?tt(rt,Me,ct):(Pe(Je),oe[rt]=xe-1,Se[Me]=xe-1)}return pe.filter(Je=>Je.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((te,oe)=>te.sortKey-oe.sortKey)}update(r,o,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,o,this.layers,c),this.icon.programConfigurations.updatePaintArrays(r,o,this.layers,c))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,o){const c=this.lineVertexArray.length;if(r.segment!==void 0){let g=r.dist(o[r.segment+1]),v=r.dist(o[r.segment]);const x={};for(let b=r.segment+1;b<o.length;b++)x[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:g},b<o.length-1&&(g+=o[b+1].dist(o[b]));for(let b=r.segment||0;b>=0;b--)x[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:v},b>0&&(v+=o[b-1].dist(o[b]));for(let b=0;b<o.length;b++){const S=x[b];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(r,o,c,g,v,x,b,S,P,M,R,B){const N=r.indexArray,q=r.layoutVertexArray,W=r.segments.prepareSegment(4*o.length,q,N,this.canOverlap?x.sortKey:void 0),te=this.glyphOffsetArray.length,oe=W.vertexLength,Se=this.allowVerticalPlacement&&b===f.ah.vertical?Math.PI/2:0,pe=x.text&&x.text.sections;for(let xe=0;xe<o.length;xe++){const{tl:Pe,tr:Be,bl:tt,br:gt,tex:Je,pixelOffsetTL:Ke,pixelOffsetBR:ct,minFontScaleX:st,minFontScaleY:rt,glyphOffset:Me,isSDF:ht,sectionIndex:ut}=o[xe],wt=W.vertexLength,en=Me[1];Cp(q,S.x,S.y,Pe.x,en+Pe.y,Je.x,Je.y,c,ht,Ke.x,Ke.y,st,rt),Cp(q,S.x,S.y,Be.x,en+Be.y,Je.x+Je.w,Je.y,c,ht,ct.x,Ke.y,st,rt),Cp(q,S.x,S.y,tt.x,en+tt.y,Je.x,Je.y+Je.h,c,ht,Ke.x,ct.y,st,rt),Cp(q,S.x,S.y,gt.x,en+gt.y,Je.x+Je.w,Je.y+Je.h,c,ht,ct.x,ct.y,st,rt),u_(r.dynamicLayoutVertexArray,S,Se),N.emplaceBack(wt,wt+1,wt+2),N.emplaceBack(wt+1,wt+2,wt+3),W.vertexLength+=4,W.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Me[0]),xe!==o.length-1&&ut===o[xe+1].sectionIndex||r.programConfigurations.populatePaintArrays(q.length,x,x.index,{},B,pe&&pe[ut])}r.placedSymbolArray.emplaceBack(S.x,S.y,te,this.glyphOffsetArray.length-te,oe,P,M,S.segment,c?c[0]:0,c?c[1]:0,g[0],g[1],b,0,!1,0,R)}_addCollisionDebugVertex(r,o,c,g,v,x){return o.emplaceBack(0,0),r.emplaceBack(c.x,c.y,g,v,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(r,o,c,g,v,x,b){const S=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),P=S.vertexLength,M=v.layoutVertexArray,R=v.collisionVertexArray,B=b.anchorX,N=b.anchorY;this._addCollisionDebugVertex(M,R,x,B,N,new z(r,o)),this._addCollisionDebugVertex(M,R,x,B,N,new z(c,o)),this._addCollisionDebugVertex(M,R,x,B,N,new z(c,g)),this._addCollisionDebugVertex(M,R,x,B,N,new z(r,g)),S.vertexLength+=4;const q=v.indexArray;q.emplaceBack(P,P+1),q.emplaceBack(P+1,P+2),q.emplaceBack(P+2,P+3),q.emplaceBack(P+3,P),S.primitiveLength+=4}addDebugCollisionBoxes(r,o,c,g){for(let v=r;v<o;v++){const x=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,g?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,c)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new h_(mi,kb.members,er),this.iconCollisionBox=new h_(mi,kb.members,er);for(let r=0;r<this.symbolInstances.length;r++){const o=this.symbolInstances.get(r);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(r,o,c,g,v,x,b,S,P){const M={};for(let R=o;R<c;R++){const B=r.get(R);M.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.textFeatureIndex=B.featureIndex;break}for(let R=g;R<v;R++){const B=r.get(R);M.verticalTextBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.verticalTextFeatureIndex=B.featureIndex;break}for(let R=x;R<b;R++){const B=r.get(R);M.iconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.iconFeatureIndex=B.featureIndex;break}for(let R=S;R<P;R++){const B=r.get(R);M.verticalIconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.verticalIconFeatureIndex=B.featureIndex;break}return M}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const c=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,o){const c=r.placedSymbolArray.get(o),g=c.vertexStartIndex+4*c.numGlyphs;for(let v=c.vertexStartIndex;v<g;v+=4)r.indexArray.emplaceBack(v,v+1,v+2),r.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(r),c=Math.cos(r),g=[],v=[],x=[];for(let b=0;b<this.symbolInstances.length;++b){x.push(b);const S=this.symbolInstances.get(b);g.push(0|Math.round(o*S.anchorX+c*S.anchorY)),v.push(S.featureIndex)}return x.sort((b,S)=>g[b]-g[S]||v[S]-v[b]),x}addToSortKeyRanges(r,o){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===o?c.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const c=this.symbolInstances.get(o);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach((g,v,x)=>{g>=0&&x.indexOf(g)===v&&this.addIndicesForPlacedSymbol(this.text,g)}),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let qb,Gb;it("SymbolBucket",Gu,{omit:["layers","collisionBoxArray","features","compareText"]}),Gu.MAX_GLYPHS=65535,Gu.addDynamicAttributes=u_;var d_={get paint(){return Gb=Gb||new _({"icon-opacity":new yt(ke.paint_symbol["icon-opacity"]),"icon-color":new yt(ke.paint_symbol["icon-color"]),"icon-halo-color":new yt(ke.paint_symbol["icon-halo-color"]),"icon-halo-width":new yt(ke.paint_symbol["icon-halo-width"]),"icon-halo-blur":new yt(ke.paint_symbol["icon-halo-blur"]),"icon-translate":new at(ke.paint_symbol["icon-translate"]),"icon-translate-anchor":new at(ke.paint_symbol["icon-translate-anchor"]),"text-opacity":new yt(ke.paint_symbol["text-opacity"]),"text-color":new yt(ke.paint_symbol["text-color"],{runtimeType:Ir,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new yt(ke.paint_symbol["text-halo-color"]),"text-halo-width":new yt(ke.paint_symbol["text-halo-width"]),"text-halo-blur":new yt(ke.paint_symbol["text-halo-blur"]),"text-translate":new at(ke.paint_symbol["text-translate"]),"text-translate-anchor":new at(ke.paint_symbol["text-translate-anchor"])})},get layout(){return qb=qb||new _({"symbol-placement":new at(ke.layout_symbol["symbol-placement"]),"symbol-spacing":new at(ke.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new at(ke.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new yt(ke.layout_symbol["symbol-sort-key"]),"symbol-z-order":new at(ke.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new at(ke.layout_symbol["icon-allow-overlap"]),"icon-overlap":new at(ke.layout_symbol["icon-overlap"]),"icon-ignore-placement":new at(ke.layout_symbol["icon-ignore-placement"]),"icon-optional":new at(ke.layout_symbol["icon-optional"]),"icon-rotation-alignment":new at(ke.layout_symbol["icon-rotation-alignment"]),"icon-size":new yt(ke.layout_symbol["icon-size"]),"icon-text-fit":new at(ke.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new at(ke.layout_symbol["icon-text-fit-padding"]),"icon-image":new yt(ke.layout_symbol["icon-image"]),"icon-rotate":new yt(ke.layout_symbol["icon-rotate"]),"icon-padding":new yt(ke.layout_symbol["icon-padding"]),"icon-keep-upright":new at(ke.layout_symbol["icon-keep-upright"]),"icon-offset":new yt(ke.layout_symbol["icon-offset"]),"icon-anchor":new yt(ke.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new at(ke.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new at(ke.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new at(ke.layout_symbol["text-rotation-alignment"]),"text-field":new yt(ke.layout_symbol["text-field"]),"text-font":new yt(ke.layout_symbol["text-font"]),"text-size":new yt(ke.layout_symbol["text-size"]),"text-max-width":new yt(ke.layout_symbol["text-max-width"]),"text-line-height":new at(ke.layout_symbol["text-line-height"]),"text-letter-spacing":new yt(ke.layout_symbol["text-letter-spacing"]),"text-justify":new yt(ke.layout_symbol["text-justify"]),"text-radial-offset":new yt(ke.layout_symbol["text-radial-offset"]),"text-variable-anchor":new at(ke.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new yt(ke.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new yt(ke.layout_symbol["text-anchor"]),"text-max-angle":new at(ke.layout_symbol["text-max-angle"]),"text-writing-mode":new at(ke.layout_symbol["text-writing-mode"]),"text-rotate":new yt(ke.layout_symbol["text-rotate"]),"text-padding":new at(ke.layout_symbol["text-padding"]),"text-keep-upright":new at(ke.layout_symbol["text-keep-upright"]),"text-transform":new yt(ke.layout_symbol["text-transform"]),"text-offset":new yt(ke.layout_symbol["text-offset"]),"text-allow-overlap":new at(ke.layout_symbol["text-allow-overlap"]),"text-overlap":new at(ke.layout_symbol["text-overlap"]),"text-ignore-placement":new at(ke.layout_symbol["text-ignore-placement"]),"text-optional":new at(ke.layout_symbol["text-optional"])})}};class Wb{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:Bs,this.defaultValue=r}evaluate(r){if(r.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(r.formattedSection))return o.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}it("FormatSectionOverride",Wb,{omit:["defaultValue"]});class kp extends l{constructor(r){super(r,d_)}recalculate(r,o){if(super.recalculate(r,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const c=this.layout.get("text-writing-mode");if(c){const g=[];for(const v of c)g.indexOf(v)<0&&g.push(v);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,o,c,g){const v=this.layout.get(r).evaluate(o,{},c,g),x=this._unevaluatedLayout._values[r];return x.isDataDriven()||_u(x.value)||!v?v:function(b,S){return S.replace(/{([^{}]+)}/g,(P,M)=>b&&M in b?String(b[M]):"")}(o.properties,v)}createBucket(r){return new Gu(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of d_.paint.overridableProperties){if(!kp.hasPaintOverride(this.layout,r))continue;const o=this.paint.get(r),c=new Wb(o),g=new yu(c,o.property.specification);let v=null;v=o.value.kind==="constant"||o.value.kind==="source"?new ra("source",g):new ia("composite",g,o.value.zoomStops),this.paint._values[r]=new ns(o.property,v,o.parameters)}}_handleOverridablePaintPropertyUpdate(r,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven())&&kp.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,o){const c=r.get("text-field"),g=d_.paint.properties[o];let v=!1;const x=b=>{for(const S of b)if(g.overrides&&g.overrides.hasOverride(S))return void(v=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Zr)x(c.value.value.sections);else if(c.value.kind==="source"){const b=P=>{v||(P instanceof Pi&&Ln(P.value)===ws?x(P.value.sections):P instanceof lu?x(P.sections):P.eachChild(b))},S=c.value;S._styleExpression&&b(S._styleExpression.expression)}return v}}let Zb;var tA={get paint(){return Zb=Zb||new _({"background-color":new at(ke.paint_background["background-color"]),"background-pattern":new Au(ke.paint_background["background-pattern"]),"background-opacity":new at(ke.paint_background["background-opacity"])})}};class nA extends l{constructor(r){super(r,tA)}}let Hb;var rA={get paint(){return Hb=Hb||new _({"raster-opacity":new at(ke.paint_raster["raster-opacity"]),"raster-hue-rotate":new at(ke.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new at(ke.paint_raster["raster-brightness-min"]),"raster-brightness-max":new at(ke.paint_raster["raster-brightness-max"]),"raster-saturation":new at(ke.paint_raster["raster-saturation"]),"raster-contrast":new at(ke.paint_raster["raster-contrast"]),"raster-resampling":new at(ke.paint_raster["raster-resampling"]),"raster-fade-duration":new at(ke.paint_raster["raster-fade-duration"])})}};class iA extends l{constructor(r){super(r,rA)}}class sA extends l{constructor(r){super(r,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class oA{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const f_=63710088e-1;class ba{constructor(r,o){if(isNaN(r)||isNaN(o))throw new Error(`Invalid LngLat object: (${r}, ${o})`);if(this.lng=+r,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ba(fe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const o=Math.PI/180,c=this.lat*o,g=r.lat*o,v=Math.sin(c)*Math.sin(g)+Math.cos(c)*Math.cos(g)*Math.cos((r.lng-this.lng)*o);return f_*Math.acos(Math.min(v,1))}static convert(r){if(r instanceof ba)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new ba(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new ba(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Xb=2*Math.PI*f_;function Kb(s){return Xb*Math.cos(s*Math.PI/180)}function Yb(s){return(180+s)/360}function Jb(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function Qb(s,r){return s/Kb(r)}function p_(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}class ed{constructor(r,o,c=0){this.x=+r,this.y=+o,this.z=+c}static fromLngLat(r,o=0){const c=ba.convert(r);return new ed(Yb(c.lng),Jb(c.lat),Qb(o,c.lat))}toLngLat(){return new ba(360*this.x-180,p_(this.y))}toAltitude(){return this.z*Kb(p_(this.y))}meterInMercatorCoordinateUnits(){return 1/Xb*(r=p_(this.y),1/Math.cos(r*Math.PI/180));var r}}function ew(s,r,o){var c=2*Math.PI*6378137/256/Math.pow(2,o);return[s*c-2*Math.PI*6378137/2,r*c-2*Math.PI*6378137/2]}class m_{constructor(r,o,c){if(!function(g,v,x){return!(g<0||g>25||x<0||x>=Math.pow(2,g)||v<0||v>=Math.pow(2,g))}(r,o,c))throw new Error(`x=${o}, y=${c}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=o,this.y=c,this.key=td(0,r,r,o,c)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,o,c){const g=(x=this.y,b=this.z,S=ew(256*(v=this.x),256*(x=Math.pow(2,b)-x-1),b),P=ew(256*(v+1),256*(x+1),b),S[0]+","+S[1]+","+P[0]+","+P[1]);var v,x,b,S,P;const M=function(R,B,N){let q,W="";for(let te=R;te>0;te--)q=1<<te-1,W+=(B&q?1:0)+(N&q?2:0);return W}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,g)}isChildOf(r){const o=this.z-r.z;return o>0&&r.x===this.x>>o&&r.y===this.y>>o}getTilePoint(r){const o=Math.pow(2,this.z);return new z((r.x*o-this.x)*Fn,(r.y*o-this.y)*Fn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class tw{constructor(r,o){this.wrap=r,this.canonical=o,this.key=td(r,o.z,o.z,o.x,o.y)}}class Li{constructor(r,o,c,g,v){if(r<c)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${c}`);this.overscaledZ=r,this.wrap=o,this.canonical=new m_(c,+g,+v),this.key=td(o,r,c,g,v)}clone(){return new Li(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-r;return r>this.canonical.z?new Li(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Li(r,this.wrap,r,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(r,o){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-r;return r>this.canonical.z?td(this.wrap*+o,r,this.canonical.z,this.canonical.x,this.canonical.y):td(this.wrap*+o,r,r,this.canonical.x>>c,this.canonical.y>>c)}isChildOf(r){if(r.wrap!==this.wrap)return!1;const o=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>o&&r.canonical.y===this.canonical.y>>o}children(r){if(this.overscaledZ>=r)return[new Li(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,c=2*this.canonical.x,g=2*this.canonical.y;return[new Li(o,this.wrap,o,c,g),new Li(o,this.wrap,o,c+1,g),new Li(o,this.wrap,o,c,g+1),new Li(o,this.wrap,o,c+1,g+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Li(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Li(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new tw(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new ed(r.x-this.wrap,r.y))}}function td(s,r,o,c,g){(s*=2)<0&&(s=-1*s-1);const v=1<<o;return(v*v*s+v*g+c).toString(36)+o.toString(36)+r.toString(36)}it("CanonicalTileID",m_),it("OverscaledTileID",Li,{omit:["posMatrix"]});class nw{constructor(r,o,c,g=1,v=1,x=1,b=0){if(this.uid=r,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(c&&!["mapbox","terrarium","custom"].includes(c))return void ze(`"${c}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const S=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),c){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=v,this.blueFactor=x,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let P=0;P<S;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(S,P)]=this.data[this._idx(S-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,S)]=this.data[this._idx(P,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let P=0;P<S;P++)for(let M=0;M<S;M++){const R=this.get(P,M);R>this.max&&(this.max=R),R<this.min&&(this.min=R)}}get(r,o){const c=new Uint8Array(this.data.buffer),g=4*this._idx(r,o);return this.unpack(c[g],c[g+1],c[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,o){if(r<-1||r>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(r+1)}unpack(r,o,c){return r*this.redFactor+o*this.greenFactor+c*this.blueFactor-this.baseShift}getPixels(){return new Ri({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,o,c){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let g=o*this.dim,v=o*this.dim+this.dim,x=c*this.dim,b=c*this.dim+this.dim;switch(o){case-1:g=v-1;break;case 1:v=g+1}switch(c){case-1:x=b-1;break;case 1:b=x+1}const S=-o*this.dim,P=-c*this.dim;for(let M=x;M<b;M++)for(let R=g;R<v;R++)this.data[this._idx(R,M)]=r.data[this._idx(R+S,M+P)]}}it("DEMData",nw);class rw{constructor(r){this._stringToNumber={},this._numberToString=[];for(let o=0;o<r.length;o++){const c=r[o];this._stringToNumber[c]=o,this._numberToString[o]=c}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class iw{constructor(r,o,c,g,v){this.type="Feature",this._vectorTileFeature=r,r._z=o,r._x=c,r._y=g,this.properties=r.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(r[o]=this[o]);return r}}class sw{constructor(r,o){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new aa(Fn,16,0),this.grid3D=new aa(Fn,16,0),this.featureIndexArray=new xr,this.promoteId=o}insert(r,o,c,g,v,x){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,g,v);const S=x?this.grid3D:this.grid;for(let P=0;P<o.length;P++){const M=o[P],R=[1/0,1/0,-1/0,-1/0];for(let B=0;B<M.length;B++){const N=M[B];R[0]=Math.min(R[0],N.x),R[1]=Math.min(R[1],N.y),R[2]=Math.max(R[2],N.x),R[3]=Math.max(R[3],N.y)}R[0]<Fn&&R[1]<Fn&&R[2]>=0&&R[3]>=0&&S.insert(b,R[0],R[1],R[2],R[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new _a.VectorTile(new r_(this.rawTileData)).layers,this.sourceLayerCoder=new rw(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,o,c,g){this.loadVTLayers();const v=r.params||{},x=Fn/r.tileSize/r.scale,b=xh(v.filter),S=r.queryGeometry,P=r.queryPadding*x,M=aw(S),R=this.grid.query(M.minX-P,M.minY-P,M.maxX+P,M.maxY+P),B=aw(r.cameraQueryGeometry),N=this.grid3D.query(B.minX-P,B.minY-P,B.maxX+P,B.maxY+P,(te,oe,Se,pe)=>function(xe,Pe,Be,tt,gt){for(const Ke of xe)if(Pe<=Ke.x&&Be<=Ke.y&&tt>=Ke.x&&gt>=Ke.y)return!0;const Je=[new z(Pe,Be),new z(Pe,gt),new z(tt,gt),new z(tt,Be)];if(xe.length>2){for(const Ke of Je)if(Ou(xe,Ke))return!0}for(let Ke=0;Ke<xe.length-1;Ke++)if(NI(xe[Ke],xe[Ke+1],Je))return!0;return!1}(r.cameraQueryGeometry,te-P,oe-P,Se+P,pe+P));for(const te of N)R.push(te);R.sort(aA);const q={};let W;for(let te=0;te<R.length;te++){const oe=R[te];if(oe===W)continue;W=oe;const Se=this.featureIndexArray.get(oe);let pe=null;this.loadMatchingFeature(q,Se.bucketIndex,Se.sourceLayerIndex,Se.featureIndex,b,v.layers,v.availableImages,o,c,g,(xe,Pe,Be)=>(pe||(pe=bl(xe)),Pe.queryIntersectsFeature(S,xe,Be,pe,this.z,r.transform,x,r.pixelPosMatrix)))}return q}loadMatchingFeature(r,o,c,g,v,x,b,S,P,M,R){const B=this.bucketLayerIDs[o];if(x&&!function(te,oe){for(let Se=0;Se<te.length;Se++)if(oe.indexOf(te[Se])>=0)return!0;return!1}(x,B))return;const N=this.sourceLayerCoder.decode(c),q=this.vtLayers[N].feature(g);if(v.needGeometry){const te=wl(q,!0);if(!v.filter(new un(this.tileID.overscaledZ),te,this.tileID.canonical))return}else if(!v.filter(new un(this.tileID.overscaledZ),q))return;const W=this.getId(q,N);for(let te=0;te<B.length;te++){const oe=B[te];if(x&&x.indexOf(oe)<0)continue;const Se=S[oe];if(!Se)continue;let pe={};W&&M&&(pe=M.getState(Se.sourceLayer||"_geojsonTileLayer",W));const xe=we({},P[oe]);xe.paint=ow(xe.paint,Se.paint,q,pe,b),xe.layout=ow(xe.layout,Se.layout,q,pe,b);const Pe=!R||R(q,Se,pe);if(!Pe)continue;const Be=new iw(q,this.z,this.x,this.y,W);Be.layer=xe;let tt=r[oe];tt===void 0&&(tt=r[oe]=[]),tt.push({featureIndex:g,feature:Be,intersectionZ:Pe})}}lookupSymbolFeatures(r,o,c,g,v,x,b,S){const P={};this.loadVTLayers();const M=xh(v);for(const R of r)this.loadMatchingFeature(P,c,g,R,M,x,b,S,o);return P}hasLayer(r){for(const o of this.bucketLayerIDs)for(const c of o)if(r===c)return!0;return!1}getId(r,o){let c=r.id;return this.promoteId&&(c=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof c=="boolean"&&(c=Number(c))),c}}function ow(s,r,o,c,g){return Ne(s,(v,x)=>{const b=r instanceof yl?r.get(x):null;return b&&b.evaluate?b.evaluate(o,c,g):b})}function aw(s){let r=1/0,o=1/0,c=-1/0,g=-1/0;for(const v of s)r=Math.min(r,v.x),o=Math.min(o,v.y),c=Math.max(c,v.x),g=Math.max(g,v.y);return{minX:r,minY:o,maxX:c,maxY:g}}function aA(s,r){return r-s}function lw(s,r,o,c,g){const v=[];for(let x=0;x<s.length;x++){const b=s[x];let S;for(let P=0;P<b.length-1;P++){let M=b[P],R=b[P+1];M.x<r&&R.x<r||(M.x<r?M=new z(r,M.y+(r-M.x)/(R.x-M.x)*(R.y-M.y))._round():R.x<r&&(R=new z(r,M.y+(r-M.x)/(R.x-M.x)*(R.y-M.y))._round()),M.y<o&&R.y<o||(M.y<o?M=new z(M.x+(o-M.y)/(R.y-M.y)*(R.x-M.x),o)._round():R.y<o&&(R=new z(M.x+(o-M.y)/(R.y-M.y)*(R.x-M.x),o)._round()),M.x>=c&&R.x>=c||(M.x>=c?M=new z(c,M.y+(c-M.x)/(R.x-M.x)*(R.y-M.y))._round():R.x>=c&&(R=new z(c,M.y+(c-M.x)/(R.x-M.x)*(R.y-M.y))._round()),M.y>=g&&R.y>=g||(M.y>=g?M=new z(M.x+(g-M.y)/(R.y-M.y)*(R.x-M.x),g)._round():R.y>=g&&(R=new z(M.x+(g-M.y)/(R.y-M.y)*(R.x-M.x),g)._round()),S&&M.equals(S[S.length-1])||(S=[M],v.push(S)),S.push(R)))))}}return v}it("FeatureIndex",sw,{omit:["rawTileData","sourceLayerCoder"]});class wa extends z{constructor(r,o,c,g){super(r,o),this.angle=c,g!==void 0&&(this.segment=g)}clone(){return new wa(this.x,this.y,this.angle,this.segment)}}function uw(s,r,o,c,g){if(r.segment===void 0||o===0)return!0;let v=r,x=r.segment+1,b=0;for(;b>-o/2;){if(x--,x<0)return!1;b-=s[x].dist(v),v=s[x]}b+=s[x].dist(s[x+1]),x++;const S=[];let P=0;for(;b<o/2;){const M=s[x],R=s[x+1];if(!R)return!1;let B=s[x-1].angleTo(M)-M.angleTo(R);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:b,angleDelta:B}),P+=B;b-S[0].distance>c;)P-=S.shift().angleDelta;if(P>g)return!1;x++,b+=M.dist(R)}return!0}function cw(s){let r=0;for(let o=0;o<s.length-1;o++)r+=s[o].dist(s[o+1]);return r}function hw(s,r,o){return s?.6*r*o:0}function dw(s,r){return Math.max(s?s.right-s.left:0,r?r.right-r.left:0)}function lA(s,r,o,c,g,v){const x=hw(o,g,v),b=dw(o,c)*v;let S=0;const P=cw(s)/2;for(let M=0;M<s.length-1;M++){const R=s[M],B=s[M+1],N=R.dist(B);if(S+N>P){const q=(P-S)/N,W=Mr.number(R.x,B.x,q),te=Mr.number(R.y,B.y,q),oe=new wa(W,te,B.angleTo(R),M);return oe._round(),!x||uw(s,oe,b,x,r)?oe:void 0}S+=N}}function uA(s,r,o,c,g,v,x,b,S){const P=hw(c,v,x),M=dw(c,g),R=M*x,B=s[0].x===0||s[0].x===S||s[0].y===0||s[0].y===S;return r-R<r/4&&(r=R+r/4),fw(s,B?r/2*b%r:(M/2+2*v)*x*b%r,r,P,o,R,B,!1,S)}function fw(s,r,o,c,g,v,x,b,S){const P=v/2,M=cw(s);let R=0,B=r-o,N=[];for(let q=0;q<s.length-1;q++){const W=s[q],te=s[q+1],oe=W.dist(te),Se=te.angleTo(W);for(;B+o<R+oe;){B+=o;const pe=(B-R)/oe,xe=Mr.number(W.x,te.x,pe),Pe=Mr.number(W.y,te.y,pe);if(xe>=0&&xe<S&&Pe>=0&&Pe<S&&B-P>=0&&B+P<=M){const Be=new wa(xe,Pe,Se,q);Be._round(),c&&!uw(s,Be,v,c,g)||N.push(Be)}}R+=oe}return b||N.length||x||(N=fw(s,R/2,o,c,g,v,x,!0,S)),N}it("Anchor",wa);const Wu=Qr;function pw(s,r,o,c){const g=[],v=s.image,x=v.pixelRatio,b=v.paddedRect.w-2*Wu,S=v.paddedRect.h-2*Wu;let P={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const M=v.stretchX||[[0,b]],R=v.stretchY||[[0,S]],B=(Me,ht)=>Me+ht[1]-ht[0],N=M.reduce(B,0),q=R.reduce(B,0),W=b-N,te=S-q;let oe=0,Se=N,pe=0,xe=q,Pe=0,Be=W,tt=0,gt=te;if(v.content&&c){const Me=v.content,ht=Me[2]-Me[0],ut=Me[3]-Me[1];(v.textFitWidth||v.textFitHeight)&&(P=jb(s)),oe=Pp(M,0,Me[0]),pe=Pp(R,0,Me[1]),Se=Pp(M,Me[0],Me[2]),xe=Pp(R,Me[1],Me[3]),Pe=Me[0]-oe,tt=Me[1]-pe,Be=ht-Se,gt=ut-xe}const Je=P.x1,Ke=P.y1,ct=P.x2-Je,st=P.y2-Ke,rt=(Me,ht,ut,wt)=>{const en=Ep(Me.stretch-oe,Se,ct,Je),Yt=Ip(Me.fixed-Pe,Be,Me.stretch,N),Zn=Ep(ht.stretch-pe,xe,st,Ke),is=Ip(ht.fixed-tt,gt,ht.stretch,q),dr=Ep(ut.stretch-oe,Se,ct,Je),Hn=Ip(ut.fixed-Pe,Be,ut.stretch,N),Rr=Ep(wt.stretch-pe,xe,st,Ke),Lr=Ip(wt.fixed-tt,gt,wt.stretch,q),Fr=new z(en,Zn),Sn=new z(dr,Zn),Xn=new z(dr,Rr),wr=new z(en,Rr),fr=new z(Yt/x,is/x),Br=new z(Hn/x,Lr/x),pr=r*Math.PI/180;if(pr){const Ut=Math.sin(pr),nn=Math.cos(pr),fn=[nn,-Ut,Ut,nn];Fr._matMult(fn),Sn._matMult(fn),wr._matMult(fn),Xn._matMult(fn)}const Fi=Me.stretch+Me.fixed,ei=ht.stretch+ht.fixed;return{tl:Fr,tr:Sn,bl:wr,br:Xn,tex:{x:v.paddedRect.x+Wu+Fi,y:v.paddedRect.y+Wu+ei,w:ut.stretch+ut.fixed-Fi,h:wt.stretch+wt.fixed-ei},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:fr,pixelOffsetBR:Br,minFontScaleX:Be/x/ct,minFontScaleY:gt/x/st,isSDF:o}};if(c&&(v.stretchX||v.stretchY)){const Me=mw(M,W,N),ht=mw(R,te,q);for(let ut=0;ut<Me.length-1;ut++){const wt=Me[ut],en=Me[ut+1];for(let Yt=0;Yt<ht.length-1;Yt++)g.push(rt(wt,ht[Yt],en,ht[Yt+1]))}}else g.push(rt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:S+1}));return g}function Pp(s,r,o){let c=0;for(const g of s)c+=Math.max(r,Math.min(o,g[1]))-Math.max(r,Math.min(o,g[0]));return c}function mw(s,r,o){const c=[{fixed:-Wu,stretch:0}];for(const[g,v]of s){const x=c[c.length-1];c.push({fixed:g-x.stretch,stretch:x.stretch}),c.push({fixed:g-x.stretch,stretch:x.stretch+(v-g)})}return c.push({fixed:r+Wu,stretch:o}),c}function Ep(s,r,o,c){return s/r*o+c}function Ip(s,r,o,c){return s-r*o/c}class Mp{constructor(r,o,c,g,v,x,b,S,P,M){var R;if(this.boxStartIndex=r.length,P){let B=x.top,N=x.bottom;const q=x.collisionPadding;q&&(B-=q[1],N+=q[3]);let W=N-B;W>0&&(W=Math.max(10,W),this.circleDiameter=W)}else{const B=!((R=x.image)===null||R===void 0)&&R.content&&(x.image.textFitWidth||x.image.textFitHeight)?jb(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};B.y1=B.y1*b-S[0],B.y2=B.y2*b+S[2],B.x1=B.x1*b-S[3],B.x2=B.x2*b+S[1];const N=x.collisionPadding;if(N&&(B.x1-=N[0]*b,B.y1-=N[1]*b,B.x2+=N[2]*b,B.y2+=N[3]*b),M){const q=new z(B.x1,B.y1),W=new z(B.x2,B.y1),te=new z(B.x1,B.y2),oe=new z(B.x2,B.y2),Se=M*Math.PI/180;q._rotate(Se),W._rotate(Se),te._rotate(Se),oe._rotate(Se),B.x1=Math.min(q.x,W.x,te.x,oe.x),B.x2=Math.max(q.x,W.x,te.x,oe.x),B.y1=Math.min(q.y,W.y,te.y,oe.y),B.y2=Math.max(q.y,W.y,te.y,oe.y)}r.emplaceBack(o.x,o.y,B.x1,B.y1,B.x2,B.y2,c,g,v)}this.boxEndIndex=r.length}}class cA{constructor(r=[],o=(c,g)=>c<g?-1:c>g?1:0){if(this.data=r,this.length=this.data.length,this.compare=o,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:o,compare:c}=this,g=o[r];for(;r>0;){const v=r-1>>1,x=o[v];if(c(g,x)>=0)break;o[r]=x,r=v}o[r]=g}_down(r){const{data:o,compare:c}=this,g=this.length>>1,v=o[r];for(;r<g;){let x=1+(r<<1);const b=x+1;if(b<this.length&&c(o[b],o[x])<0&&(x=b),c(o[x],v)>=0)break;o[r]=o[x],r=x}o[r]=v}}function hA(s,r=1,o=!1){let c=1/0,g=1/0,v=-1/0,x=-1/0;const b=s[0];for(let N=0;N<b.length;N++){const q=b[N];(!N||q.x<c)&&(c=q.x),(!N||q.y<g)&&(g=q.y),(!N||q.x>v)&&(v=q.x),(!N||q.y>x)&&(x=q.y)}const S=Math.min(v-c,x-g);let P=S/2;const M=new cA([],dA);if(S===0)return new z(c,g);for(let N=c;N<v;N+=S)for(let q=g;q<x;q+=S)M.push(new Zu(N+P,q+P,P,s));let R=function(N){let q=0,W=0,te=0;const oe=N[0];for(let Se=0,pe=oe.length,xe=pe-1;Se<pe;xe=Se++){const Pe=oe[Se],Be=oe[xe],tt=Pe.x*Be.y-Be.x*Pe.y;W+=(Pe.x+Be.x)*tt,te+=(Pe.y+Be.y)*tt,q+=3*tt}return new Zu(W/q,te/q,0,N)}(s),B=M.length;for(;M.length;){const N=M.pop();(N.d>R.d||!R.d)&&(R=N,o&&console.log("found best %d after %d probes",Math.round(1e4*N.d)/1e4,B)),N.max-R.d<=r||(P=N.h/2,M.push(new Zu(N.p.x-P,N.p.y-P,P,s)),M.push(new Zu(N.p.x+P,N.p.y-P,P,s)),M.push(new Zu(N.p.x-P,N.p.y+P,P,s)),M.push(new Zu(N.p.x+P,N.p.y+P,P,s)),B+=4)}return o&&(console.log(`num probes: ${B}`),console.log(`best distance: ${R.d}`)),R.p}function dA(s,r){return r.max-s.max}function Zu(s,r,o,c){this.p=new z(s,r),this.h=o,this.d=function(g,v){let x=!1,b=1/0;for(let S=0;S<v.length;S++){const P=v[S];for(let M=0,R=P.length,B=R-1;M<R;B=M++){const N=P[M],q=P[B];N.y>g.y!=q.y>g.y&&g.x<(q.x-N.x)*(g.y-N.y)/(q.y-N.y)+N.x&&(x=!x),b=Math.min(b,J1(g,N,q))}}return(x?1:-1)*Math.sqrt(b)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}var hr;f.aq=void 0,(hr=f.aq||(f.aq={}))[hr.center=1]="center",hr[hr.left=2]="left",hr[hr.right=3]="right",hr[hr.top=4]="top",hr[hr.bottom=5]="bottom",hr[hr["top-left"]=6]="top-left",hr[hr["top-right"]=7]="top-right",hr[hr["bottom-left"]=8]="bottom-left",hr[hr["bottom-right"]=9]="bottom-right";const Sa=7,g_=Number.POSITIVE_INFINITY;function gw(s,r){return r[1]!==g_?function(o,c,g){let v=0,x=0;switch(c=Math.abs(c),g=Math.abs(g),o){case"top-right":case"top-left":case"top":x=g-Sa;break;case"bottom-right":case"bottom-left":case"bottom":x=-g+Sa}switch(o){case"top-right":case"bottom-right":case"right":v=-c;break;case"top-left":case"bottom-left":case"left":v=c}return[v,x]}(s,r[0],r[1]):function(o,c){let g=0,v=0;c<0&&(c=0);const x=c/Math.SQRT2;switch(o){case"top-right":case"top-left":v=x-Sa;break;case"bottom-right":case"bottom-left":v=-x+Sa;break;case"bottom":v=-c+Sa;break;case"top":v=c-Sa}switch(o){case"top-right":case"bottom-right":g=-x;break;case"top-left":case"bottom-left":g=x;break;case"left":g=c;break;case"right":g=-c}return[g,v]}(s,r[0])}function yw(s,r,o){var c;const g=s.layout,v=(c=g.get("text-variable-anchor-offset"))===null||c===void 0?void 0:c.evaluate(r,{},o);if(v){const b=v.values,S=[];for(let P=0;P<b.length;P+=2){const M=S[P]=b[P],R=b[P+1].map(B=>B*jn);M.startsWith("top")?R[1]-=Sa:M.startsWith("bottom")&&(R[1]+=Sa),S[P+1]=R}return new ui(S)}const x=g.get("text-variable-anchor");if(x){let b;b=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(r,{},o)*jn,g_]:g.get("text-offset").evaluate(r,{},o).map(P=>P*jn);const S=[];for(const P of x)S.push(P,gw(P,b));return new ui(S)}return null}function y_(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function fA(s,r,o,c,g,v,x,b,S,P,M){let R=v.textMaxSize.evaluate(r,{});R===void 0&&(R=x);const B=s.layers[0].layout,N=B.get("icon-offset").evaluate(r,{},M),q=vw(o.horizontal),W=x/24,te=s.tilePixelRatio*W,oe=s.tilePixelRatio*R/24,Se=s.tilePixelRatio*b,pe=s.tilePixelRatio*B.get("symbol-spacing"),xe=B.get("text-padding")*s.tilePixelRatio,Pe=function(Me,ht,ut,wt=1){const en=Me.get("icon-padding").evaluate(ht,{},ut),Yt=en&&en.values;return[Yt[0]*wt,Yt[1]*wt,Yt[2]*wt,Yt[3]*wt]}(B,r,M,s.tilePixelRatio),Be=B.get("text-max-angle")/180*Math.PI,tt=B.get("text-rotation-alignment")!=="viewport"&&B.get("symbol-placement")!=="point",gt=B.get("icon-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",Je=B.get("symbol-placement"),Ke=pe/2,ct=B.get("icon-text-fit");let st;c&&ct!=="none"&&(s.allowVerticalPlacement&&o.vertical&&(st=$b(c,o.vertical,ct,B.get("icon-text-fit-padding"),N,W)),q&&(c=$b(c,q,ct,B.get("icon-text-fit-padding"),N,W)));const rt=(Me,ht)=>{ht.x<0||ht.x>=Fn||ht.y<0||ht.y>=Fn||function(ut,wt,en,Yt,Zn,is,dr,Hn,Rr,Lr,Fr,Sn,Xn,wr,fr,Br,pr,Fi,ei,Ut,nn,fn,gi,_n,Hu){const qs=ut.addToLineVertexArray(wt,en);let Gs,ss,Bi,tr,Co=0,id=0,Sw=0,Tw=0,C_=-1,k_=-1;const ko={};let Cw=Ru("");if(ut.allowVerticalPlacement&&Yt.vertical){const Sr=Hn.layout.get("text-rotate").evaluate(nn,{},_n)+90;Bi=new Mp(Rr,wt,Lr,Fr,Sn,Yt.vertical,Xn,wr,fr,Sr),dr&&(tr=new Mp(Rr,wt,Lr,Fr,Sn,dr,pr,Fi,fr,Sr))}if(Zn){const Sr=Hn.layout.get("icon-rotate").evaluate(nn,{}),Oi=Hn.layout.get("icon-text-fit")!=="none",Tl=pw(Zn,Sr,gi,Oi),Ps=dr?pw(dr,Sr,gi,Oi):void 0;ss=new Mp(Rr,wt,Lr,Fr,Sn,Zn,pr,Fi,!1,Sr),Co=4*Tl.length;const Cl=ut.iconSizeData;let Ws=null;Cl.kind==="source"?(Ws=[Us*Hn.layout.get("icon-size").evaluate(nn,{})],Ws[0]>xa&&ze(`${ut.layerIds[0]}: Value for "icon-size" is >= ${Qh}. Reduce your "icon-size".`)):Cl.kind==="composite"&&(Ws=[Us*fn.compositeIconSizes[0].evaluate(nn,{},_n),Us*fn.compositeIconSizes[1].evaluate(nn,{},_n)],(Ws[0]>xa||Ws[1]>xa)&&ze(`${ut.layerIds[0]}: Value for "icon-size" is >= ${Qh}. Reduce your "icon-size".`)),ut.addSymbols(ut.icon,Tl,Ws,Ut,ei,nn,f.ah.none,wt,qs.lineStartIndex,qs.lineLength,-1,_n),C_=ut.icon.placedSymbolArray.length-1,Ps&&(id=4*Ps.length,ut.addSymbols(ut.icon,Ps,Ws,Ut,ei,nn,f.ah.vertical,wt,qs.lineStartIndex,qs.lineLength,-1,_n),k_=ut.icon.placedSymbolArray.length-1)}const kw=Object.keys(Yt.horizontal);for(const Sr of kw){const Oi=Yt.horizontal[Sr];if(!Gs){Cw=Ru(Oi.text);const Ps=Hn.layout.get("text-rotate").evaluate(nn,{},_n);Gs=new Mp(Rr,wt,Lr,Fr,Sn,Oi,Xn,wr,fr,Ps)}const Tl=Oi.positionedLines.length===1;if(Sw+=_w(ut,wt,Oi,is,Hn,fr,nn,Br,qs,Yt.vertical?f.ah.horizontal:f.ah.horizontalOnly,Tl?kw:[Sr],ko,C_,fn,_n),Tl)break}Yt.vertical&&(Tw+=_w(ut,wt,Yt.vertical,is,Hn,fr,nn,Br,qs,f.ah.vertical,["vertical"],ko,k_,fn,_n));const gA=Gs?Gs.boxStartIndex:ut.collisionBoxArray.length,yA=Gs?Gs.boxEndIndex:ut.collisionBoxArray.length,_A=Bi?Bi.boxStartIndex:ut.collisionBoxArray.length,vA=Bi?Bi.boxEndIndex:ut.collisionBoxArray.length,xA=ss?ss.boxStartIndex:ut.collisionBoxArray.length,bA=ss?ss.boxEndIndex:ut.collisionBoxArray.length,wA=tr?tr.boxStartIndex:ut.collisionBoxArray.length,SA=tr?tr.boxEndIndex:ut.collisionBoxArray.length;let ks=-1;const zp=(Sr,Oi)=>Sr&&Sr.circleDiameter?Math.max(Sr.circleDiameter,Oi):Oi;ks=zp(Gs,ks),ks=zp(Bi,ks),ks=zp(ss,ks),ks=zp(tr,ks);const Pw=ks>-1?1:0;Pw&&(ks*=Hu/jn),ut.glyphOffsetArray.length>=Gu.MAX_GLYPHS&&ze("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),nn.sortKey!==void 0&&ut.addToSortKeyRanges(ut.symbolInstances.length,nn.sortKey);const TA=yw(Hn,nn,_n),[CA,kA]=function(Sr,Oi){const Tl=Sr.length,Ps=Oi==null?void 0:Oi.values;if((Ps==null?void 0:Ps.length)>0)for(let Cl=0;Cl<Ps.length;Cl+=2){const Ws=Ps[Cl+1];Sr.emplaceBack(f.aq[Ps[Cl]],Ws[0],Ws[1])}return[Tl,Sr.length]}(ut.textAnchorOffsets,TA);ut.symbolInstances.emplaceBack(wt.x,wt.y,ko.right>=0?ko.right:-1,ko.center>=0?ko.center:-1,ko.left>=0?ko.left:-1,ko.vertical||-1,C_,k_,Cw,gA,yA,_A,vA,xA,bA,wA,SA,Lr,Sw,Tw,Co,id,Pw,0,Xn,ks,CA,kA)}(s,ht,Me,o,c,g,st,s.layers[0],s.collisionBoxArray,r.index,r.sourceLayerIndex,s.index,te,[xe,xe,xe,xe],tt,S,Se,Pe,gt,N,r,v,P,M,x)};if(Je==="line")for(const Me of lw(r.geometry,0,0,Fn,Fn)){const ht=uA(Me,pe,Be,o.vertical||q,c,24,oe,s.overscaling,Fn);for(const ut of ht)q&&pA(s,q.text,Ke,ut)||rt(Me,ut)}else if(Je==="line-center"){for(const Me of r.geometry)if(Me.length>1){const ht=lA(Me,Be,o.vertical||q,c,24,oe);ht&&rt(Me,ht)}}else if(r.type==="Polygon")for(const Me of cu(r.geometry,0)){const ht=hA(Me,16);rt(Me[0],new wa(ht.x,ht.y,0))}else if(r.type==="LineString")for(const Me of r.geometry)rt(Me,new wa(Me[0].x,Me[0].y,0));else if(r.type==="Point")for(const Me of r.geometry)for(const ht of Me)rt([ht],new wa(ht.x,ht.y,0))}function _w(s,r,o,c,g,v,x,b,S,P,M,R,B,N,q){const W=function(Se,pe,xe,Pe,Be,tt,gt,Je){const Ke=Pe.layout.get("text-rotate").evaluate(tt,{})*Math.PI/180,ct=[];for(const st of pe.positionedLines)for(const rt of st.positionedGlyphs){if(!rt.rect)continue;const Me=rt.rect||{};let ht=Rb+1,ut=!0,wt=1,en=0;const Yt=(Be||Je)&&rt.vertical,Zn=rt.metrics.advance*rt.scale/2;if(Je&&pe.verticalizable&&(en=st.lineOffset/2-(rt.imageName?-(jn-rt.metrics.width*rt.scale)/2:(rt.scale-1)*jn)),rt.imageName){const Ut=gt[rt.imageName];ut=Ut.sdf,wt=Ut.pixelRatio,ht=Qr/wt}const is=Be?[rt.x+Zn,rt.y]:[0,0];let dr=Be?[0,0]:[rt.x+Zn+xe[0],rt.y+xe[1]-en],Hn=[0,0];Yt&&(Hn=dr,dr=[0,0]);const Rr=rt.metrics.isDoubleResolution?2:1,Lr=(rt.metrics.left-ht)*rt.scale-Zn+dr[0],Fr=(-rt.metrics.top-ht)*rt.scale+dr[1],Sn=Lr+Me.w/Rr*rt.scale/wt,Xn=Fr+Me.h/Rr*rt.scale/wt,wr=new z(Lr,Fr),fr=new z(Sn,Fr),Br=new z(Lr,Xn),pr=new z(Sn,Xn);if(Yt){const Ut=new z(-Zn,Zn-Yh),nn=-Math.PI/2,fn=jn/2-Zn,gi=new z(5-Yh-fn,-(rt.imageName?fn:0)),_n=new z(...Hn);wr._rotateAround(nn,Ut)._add(gi)._add(_n),fr._rotateAround(nn,Ut)._add(gi)._add(_n),Br._rotateAround(nn,Ut)._add(gi)._add(_n),pr._rotateAround(nn,Ut)._add(gi)._add(_n)}if(Ke){const Ut=Math.sin(Ke),nn=Math.cos(Ke),fn=[nn,-Ut,Ut,nn];wr._matMult(fn),fr._matMult(fn),Br._matMult(fn),pr._matMult(fn)}const Fi=new z(0,0),ei=new z(0,0);ct.push({tl:wr,tr:fr,bl:Br,br:pr,tex:Me,writingMode:pe.writingMode,glyphOffset:is,sectionIndex:rt.sectionIndex,isSDF:ut,pixelOffsetTL:Fi,pixelOffsetBR:ei,minFontScaleX:0,minFontScaleY:0})}return ct}(0,o,b,g,v,x,c,s.allowVerticalPlacement),te=s.textSizeData;let oe=null;te.kind==="source"?(oe=[Us*g.layout.get("text-size").evaluate(x,{})],oe[0]>xa&&ze(`${s.layerIds[0]}: Value for "text-size" is >= ${Qh}. Reduce your "text-size".`)):te.kind==="composite"&&(oe=[Us*N.compositeTextSizes[0].evaluate(x,{},q),Us*N.compositeTextSizes[1].evaluate(x,{},q)],(oe[0]>xa||oe[1]>xa)&&ze(`${s.layerIds[0]}: Value for "text-size" is >= ${Qh}. Reduce your "text-size".`)),s.addSymbols(s.text,W,oe,b,v,x,P,r,S.lineStartIndex,S.lineLength,B,q);for(const Se of M)R[Se]=s.text.placedSymbolArray.length-1;return 4*W.length}function vw(s){for(const r in s)return s[r];return null}function pA(s,r,o,c){const g=s.compareText;if(r in g){const v=g[r];for(let x=v.length-1;x>=0;x--)if(c.dist(v[x])<o)return!0}else g[r]=[];return g[r].push(c),!1}const xw=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class __{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,c]=new Uint8Array(r,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=c>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const v=xw[15&c];if(!v)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(r,2,1),[b]=new Uint32Array(r,4,1);return new __(b,x,v,r)}constructor(r,o=64,c=Float64Array,g){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=c,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const v=xw.indexOf(this.ArrayType),x=2*r*this.ArrayType.BYTES_PER_ELEMENT,b=r*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-b%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${c}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+S,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+x+b+S),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+S,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=r)}add(r,o){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=r,this.coords[this._pos++]=o,c}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return v_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,o,c,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:x,nodeSize:b}=this,S=[0,v.length-1,0],P=[];for(;S.length;){const M=S.pop()||0,R=S.pop()||0,B=S.pop()||0;if(R-B<=b){for(let te=B;te<=R;te++){const oe=x[2*te],Se=x[2*te+1];oe>=r&&oe<=c&&Se>=o&&Se<=g&&P.push(v[te])}continue}const N=B+R>>1,q=x[2*N],W=x[2*N+1];q>=r&&q<=c&&W>=o&&W<=g&&P.push(v[N]),(M===0?r<=q:o<=W)&&(S.push(B),S.push(N-1),S.push(1-M)),(M===0?c>=q:g>=W)&&(S.push(N+1),S.push(R),S.push(1-M))}return P}within(r,o,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:v,nodeSize:x}=this,b=[0,g.length-1,0],S=[],P=c*c;for(;b.length;){const M=b.pop()||0,R=b.pop()||0,B=b.pop()||0;if(R-B<=x){for(let te=B;te<=R;te++)ww(v[2*te],v[2*te+1],r,o)<=P&&S.push(g[te]);continue}const N=B+R>>1,q=v[2*N],W=v[2*N+1];ww(q,W,r,o)<=P&&S.push(g[N]),(M===0?r-c<=q:o-c<=W)&&(b.push(B),b.push(N-1),b.push(1-M)),(M===0?r+c>=q:o+c>=W)&&(b.push(N+1),b.push(R),b.push(1-M))}return S}}function v_(s,r,o,c,g,v){if(g-c<=o)return;const x=c+g>>1;bw(s,r,x,c,g,v),v_(s,r,o,c,x-1,1-v),v_(s,r,o,x+1,g,1-v)}function bw(s,r,o,c,g,v){for(;g>c;){if(g-c>600){const P=g-c+1,M=o-c+1,R=Math.log(P),B=.5*Math.exp(2*R/3),N=.5*Math.sqrt(R*B*(P-B)/P)*(M-P/2<0?-1:1);bw(s,r,o,Math.max(c,Math.floor(o-M*B/P+N)),Math.min(g,Math.floor(o+(P-M)*B/P+N)),v)}const x=r[2*o+v];let b=c,S=g;for(nd(s,r,c,o),r[2*g+v]>x&&nd(s,r,c,g);b<S;){for(nd(s,r,b,S),b++,S--;r[2*b+v]<x;)b++;for(;r[2*S+v]>x;)S--}r[2*c+v]===x?nd(s,r,c,S):(S++,nd(s,r,S,g)),S<=o&&(c=S+1),o<=S&&(g=S-1)}}function nd(s,r,o,c){x_(s,o,c),x_(r,2*o,2*c),x_(r,2*o+1,2*c+1)}function x_(s,r,o){const c=s[r];s[r]=s[o],s[o]=c}function ww(s,r,o,c){const g=s-o,v=r-c;return g*g+v*v}var b_;f.bg=void 0,(b_=f.bg||(f.bg={})).create="create",b_.load="load",b_.fullLoad="fullLoad";let Ap=null,rd=[];const w_=1e3/60,S_="loadTime",T_="fullLoadTime",mA={mark(s){performance.mark(s)},frame(s){const r=s;Ap!=null&&rd.push(r-Ap),Ap=r},clearMetrics(){Ap=null,rd=[],performance.clearMeasures(S_),performance.clearMeasures(T_);for(const s in f.bg)performance.clearMarks(f.bg[s])},getPerformanceMetrics(){performance.measure(S_,f.bg.create,f.bg.load),performance.measure(T_,f.bg.create,f.bg.fullLoad);const s=performance.getEntriesByName(S_)[0].duration,r=performance.getEntriesByName(T_)[0].duration,o=rd.length,c=1/(rd.reduce((v,x)=>v+x,0)/o/1e3),g=rd.filter(v=>v>w_).reduce((v,x)=>v+(x-w_)/w_,0);return{loadTime:s,fullLoadTime:r,fps:c,percentDroppedFrames:g/(o+g)*100,totalFrames:o}}};f.$=class extends L{},f.A=Vu,f.B=zy,f.C=function(s){if(xt==null){const r=s.navigator?s.navigator.userAgent:null;xt=!!s.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return xt},f.D=at,f.E=Fs,f.F=class{constructor(s,r){this.target=s,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new oA(()=>this.process()),this.subscription=function(o,c,g,v){return o.addEventListener(c,g,!1),{unsubscribe:()=>{o.removeEventListener(c,g,!1)}}}(this.target,"message",o=>this.receive(o)),this.globalScope=ot(self)?s:window}registerMessageHandler(s,r){this.messageHandlers[s]=r}sendAsync(s,r){return new Promise((o,c)=>{const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[g]={resolve:o,reject:c},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[g];const b={id:g,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(b)},{once:!0});const v=[],x=Object.assign(Object.assign({},s),{id:g,sourceMapId:this.mapId,origin:location.origin,data:la(s.data,v)});this.target.postMessage(x,{transfer:v})})}receive(s){const r=s.data,o=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!=="resource://android"&&location.origin!=="resource://android"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[o];const c=this.abortControllers[o];return delete this.abortControllers[o],void(c&&c.abort())}if(ot(self)||r.mustQueue)return this.tasks[o]=r,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,r)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),r=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(s,r)}processTask(s,r){return u(this,void 0,void 0,function*(){if(r.type==="<response>"){const g=this.resolveRejects[s];return delete this.resolveRejects[s],g?void(r.error?g.reject(ua(r.error)):g.resolve(ua(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=ua(r.data),c=new AbortController;this.abortControllers[s]=c;try{const g=yield this.messageHandlers[r.type](r.sourceMapId,o,c);this.completeTask(s,null,g)}catch(g){this.completeTask(s,g)}})}completeTask(s,r,o){const c=[];delete this.abortControllers[s];const g={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?la(r):null,data:la(o,c)};this.target.postMessage(g,{transfer:c})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},f.G=or,f.H=function(){var s=new Vu(16);return Vu!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},f.I=s_,f.J=function(s,r,o){var c,g,v,x,b,S,P,M,R,B,N,q,W=o[0],te=o[1],oe=o[2];return r===s?(s[12]=r[0]*W+r[4]*te+r[8]*oe+r[12],s[13]=r[1]*W+r[5]*te+r[9]*oe+r[13],s[14]=r[2]*W+r[6]*te+r[10]*oe+r[14],s[15]=r[3]*W+r[7]*te+r[11]*oe+r[15]):(g=r[1],v=r[2],x=r[3],b=r[4],S=r[5],P=r[6],M=r[7],R=r[8],B=r[9],N=r[10],q=r[11],s[0]=c=r[0],s[1]=g,s[2]=v,s[3]=x,s[4]=b,s[5]=S,s[6]=P,s[7]=M,s[8]=R,s[9]=B,s[10]=N,s[11]=q,s[12]=c*W+b*te+R*oe+r[12],s[13]=g*W+S*te+B*oe+r[13],s[14]=v*W+P*te+N*oe+r[14],s[15]=x*W+M*te+q*oe+r[15]),s},f.K=function(s,r,o){var c=o[0],g=o[1],v=o[2];return s[0]=r[0]*c,s[1]=r[1]*c,s[2]=r[2]*c,s[3]=r[3]*c,s[4]=r[4]*g,s[5]=r[5]*g,s[6]=r[6]*g,s[7]=r[7]*g,s[8]=r[8]*v,s[9]=r[9]*v,s[10]=r[10]*v,s[11]=r[11]*v,s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},f.L=nb,f.M=function(s,r){const o={};for(let c=0;c<r.length;c++){const g=r[c];g in s&&(o[g]=s[g])}return o},f.N=ba,f.O=Yb,f.P=z,f.Q=Jb,f.R=Ri,f.S=Li,f.T=Iu,f.U=j,f.V=U,f.W=et,f.X=Fn,f.Y=w,f.Z=ed,f._=u,f.a=Gn,f.a$=function(s,r){var o=s[0],c=s[1],g=s[2],v=s[3],x=s[4],b=s[5],S=s[6],P=s[7],M=s[8],R=s[9],B=s[10],N=s[11],q=s[12],W=s[13],te=s[14],oe=s[15],Se=r[0],pe=r[1],xe=r[2],Pe=r[3],Be=r[4],tt=r[5],gt=r[6],Je=r[7],Ke=r[8],ct=r[9],st=r[10],rt=r[11],Me=r[12],ht=r[13],ut=r[14],wt=r[15];return Math.abs(o-Se)<=Dr*Math.max(1,Math.abs(o),Math.abs(Se))&&Math.abs(c-pe)<=Dr*Math.max(1,Math.abs(c),Math.abs(pe))&&Math.abs(g-xe)<=Dr*Math.max(1,Math.abs(g),Math.abs(xe))&&Math.abs(v-Pe)<=Dr*Math.max(1,Math.abs(v),Math.abs(Pe))&&Math.abs(x-Be)<=Dr*Math.max(1,Math.abs(x),Math.abs(Be))&&Math.abs(b-tt)<=Dr*Math.max(1,Math.abs(b),Math.abs(tt))&&Math.abs(S-gt)<=Dr*Math.max(1,Math.abs(S),Math.abs(gt))&&Math.abs(P-Je)<=Dr*Math.max(1,Math.abs(P),Math.abs(Je))&&Math.abs(M-Ke)<=Dr*Math.max(1,Math.abs(M),Math.abs(Ke))&&Math.abs(R-ct)<=Dr*Math.max(1,Math.abs(R),Math.abs(ct))&&Math.abs(B-st)<=Dr*Math.max(1,Math.abs(B),Math.abs(st))&&Math.abs(N-rt)<=Dr*Math.max(1,Math.abs(N),Math.abs(rt))&&Math.abs(q-Me)<=Dr*Math.max(1,Math.abs(q),Math.abs(Me))&&Math.abs(W-ht)<=Dr*Math.max(1,Math.abs(W),Math.abs(ht))&&Math.abs(te-ut)<=Dr*Math.max(1,Math.abs(te),Math.abs(ut))&&Math.abs(oe-wt)<=Dr*Math.max(1,Math.abs(oe),Math.abs(wt))},f.a0=Ft,f.a1=m_,f.a2=Ue,f.a3=s=>{const r=window.document.createElement("video");return r.muted=!0,new Promise(o=>{r.onloadstart=()=>{o(r)};for(const c of s){const g=window.document.createElement("source");xs(c)||(r.crossOrigin="Anonymous"),g.src=c,r.appendChild(g)}})},f.a4=function(){return Ie++},f.a5=Qe,f.a6=Gu,f.a7=xh,f.a8=wl,f.a9=iw,f.aA=function(s){if(s.type==="custom")return new sA(s);switch(s.type){case"background":return new nA(s);case"circle":return new UI(s);case"fill":return new oM(s);case"fill-extrusion":return new bM(s);case"heatmap":return new GI(s);case"hillshade":return new ZI(s);case"line":return new IM(s);case"raster":return new iA(s);case"symbol":return new kp(s)}},f.aB=Ve,f.aC=function(s,r){if(!s)return[{command:"setStyle",args:[r]}];let o=[];try{if(!Ot(s.version,r.version))return[{command:"setStyle",args:[r]}];Ot(s.center,r.center)||o.push({command:"setCenter",args:[r.center]}),Ot(s.zoom,r.zoom)||o.push({command:"setZoom",args:[r.zoom]}),Ot(s.bearing,r.bearing)||o.push({command:"setBearing",args:[r.bearing]}),Ot(s.pitch,r.pitch)||o.push({command:"setPitch",args:[r.pitch]}),Ot(s.sprite,r.sprite)||o.push({command:"setSprite",args:[r.sprite]}),Ot(s.glyphs,r.glyphs)||o.push({command:"setGlyphs",args:[r.glyphs]}),Ot(s.transition,r.transition)||o.push({command:"setTransition",args:[r.transition]}),Ot(s.light,r.light)||o.push({command:"setLight",args:[r.light]}),Ot(s.terrain,r.terrain)||o.push({command:"setTerrain",args:[r.terrain]}),Ot(s.sky,r.sky)||o.push({command:"setSky",args:[r.sky]}),Ot(s.projection,r.projection)||o.push({command:"setProjection",args:[r.projection]});const c={},g=[];(function(x,b,S,P){let M;for(M in b=b||{},x=x||{})Object.prototype.hasOwnProperty.call(x,M)&&(Object.prototype.hasOwnProperty.call(b,M)||Tt(M,S,P));for(M in b)Object.prototype.hasOwnProperty.call(b,M)&&(Object.prototype.hasOwnProperty.call(x,M)?Ot(x[M],b[M])||(x[M].type==="geojson"&&b[M].type==="geojson"&&qo(x,b,M)?ln(S,{command:"setGeoJSONSourceData",args:[M,b[M].data]}):bs(M,b,S,P)):lo(M,b,S))})(s.sources,r.sources,g,c);const v=[];s.layers&&s.layers.forEach(x=>{"source"in x&&c[x.source]?o.push({command:"removeLayer",args:[x.id]}):v.push(x)}),o=o.concat(g),function(x,b,S){b=b||[];const P=(x=x||[]).map(Ya),M=b.map(Ya),R=x.reduce(Ja,{}),B=b.reduce(Ja,{}),N=P.slice(),q=Object.create(null);let W,te,oe,Se,pe;for(let xe=0,Pe=0;xe<P.length;xe++)W=P[xe],Object.prototype.hasOwnProperty.call(B,W)?Pe++:(ln(S,{command:"removeLayer",args:[W]}),N.splice(N.indexOf(W,Pe),1));for(let xe=0,Pe=0;xe<M.length;xe++)W=M[M.length-1-xe],N[N.length-1-xe]!==W&&(Object.prototype.hasOwnProperty.call(R,W)?(ln(S,{command:"removeLayer",args:[W]}),N.splice(N.lastIndexOf(W,N.length-Pe),1)):Pe++,Se=N[N.length-xe],ln(S,{command:"addLayer",args:[B[W],Se]}),N.splice(N.length-xe,0,W),q[W]=!0);for(let xe=0;xe<M.length;xe++)if(W=M[xe],te=R[W],oe=B[W],!q[W]&&!Ot(te,oe))if(Ot(te.source,oe.source)&&Ot(te["source-layer"],oe["source-layer"])&&Ot(te.type,oe.type)){for(pe in li(te.layout,oe.layout,S,W,null,"setLayoutProperty"),li(te.paint,oe.paint,S,W,null,"setPaintProperty"),Ot(te.filter,oe.filter)||ln(S,{command:"setFilter",args:[W,oe.filter]}),Ot(te.minzoom,oe.minzoom)&&Ot(te.maxzoom,oe.maxzoom)||ln(S,{command:"setLayerZoomRange",args:[W,oe.minzoom,oe.maxzoom]}),te)Object.prototype.hasOwnProperty.call(te,pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?li(te[pe],oe[pe],S,W,pe.slice(6),"setPaintProperty"):Ot(te[pe],oe[pe])||ln(S,{command:"setLayerProperty",args:[W,pe,oe[pe]]}));for(pe in oe)Object.prototype.hasOwnProperty.call(oe,pe)&&!Object.prototype.hasOwnProperty.call(te,pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?li(te[pe],oe[pe],S,W,pe.slice(6),"setPaintProperty"):Ot(te[pe],oe[pe])||ln(S,{command:"setLayerProperty",args:[W,pe,oe[pe]]}))}else ln(S,{command:"removeLayer",args:[W]}),Se=N[N.lastIndexOf(W)+1],ln(S,{command:"addLayer",args:[oe,Se]})}(v,r.layers,o)}catch(c){console.warn("Unable to compute style diff:",c),o=[{command:"setStyle",args:[r]}]}return o},f.aD=function(s){const r=[],o=s.id;return o===void 0&&r.push({message:`layers.${o}: missing required property "id"`}),s.render===void 0&&r.push({message:`layers.${o}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&r.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),r},f.aE=function s(r,o){if(Array.isArray(r)){if(!Array.isArray(o)||r.length!==o.length)return!1;for(let c=0;c<r.length;c++)if(!s(r[c],o[c]))return!1;return!0}if(typeof r=="object"&&r!==null&&o!==null){if(typeof o!="object"||Object.keys(r).length!==Object.keys(o).length)return!1;for(const c in r)if(!s(r[c],o[c]))return!1;return!0}return r===o},f.aF=Ne,f.aG=$e,f.aH=class extends vl{constructor(s,r){super(s,r),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},f.aI=fp,f.aJ=class extends vl{constructor(s,r){super(s,r),this.current=LI}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let r=1;r<16;r++)if(s[r]!==this.current[r]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},f.aK=G1,f.aL=W1,f.aM=Ht,f.aN=class extends vl{constructor(s,r){super(s,r),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},f.aO=class extends vl{constructor(s,r){super(s,r),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},f.aP=function(s,r,o,c,g,v,x){var b=1/(r-o),S=1/(c-g),P=1/(v-x);return s[0]=-2*b,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*S,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*P,s[11]=0,s[12]=(r+o)*b,s[13]=(g+c)*S,s[14]=(x+v)*P,s[15]=1,s},f.aQ=$I,f.aR=class extends ye{},f.aS=DM,f.aT=class extends Te{},f.aU=Zy,f.aV=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},f.aW=ab,f.aX=ur,f.aY=Di,f.aZ=class extends lt{},f.a_=function(s,r){return s[0]===r[0]&&s[1]===r[1]&&s[2]===r[2]&&s[3]===r[3]&&s[4]===r[4]&&s[5]===r[5]&&s[6]===r[6]&&s[7]===r[7]&&s[8]===r[8]&&s[9]===r[9]&&s[10]===r[10]&&s[11]===r[11]&&s[12]===r[12]&&s[13]===r[13]&&s[14]===r[14]&&s[15]===r[15]},f.aa=function(s){const r={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,c,g,v)=>{const x=g||v;return r[c]=!x||x.toLowerCase(),""}),r["max-age"]){const o=parseInt(r["max-age"],10);isNaN(o)?delete r["max-age"]:r["max-age"]=o}return r},f.ab=function(s,r){const o=[];for(const c in s)c in r||o.push(c);return o},f.ac=ge,f.ad=function(s,r,o){var c=Math.sin(o),g=Math.cos(o),v=r[0],x=r[1],b=r[2],S=r[3],P=r[4],M=r[5],R=r[6],B=r[7];return r!==s&&(s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[0]=v*g+P*c,s[1]=x*g+M*c,s[2]=b*g+R*c,s[3]=S*g+B*c,s[4]=P*g-v*c,s[5]=M*g-x*c,s[6]=R*g-b*c,s[7]=B*g-S*c,s},f.ae=function(s){var r=new Vu(16);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],r[4]=s[4],r[5]=s[5],r[6]=s[6],r[7]=s[7],r[8]=s[8],r[9]=s[9],r[10]=s[10],r[11]=s[11],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15],r},f.af=yp,f.ag=function(s,r){let o=0,c=0;if(s.kind==="constant")c=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:g,minZoom:v,maxZoom:x}=s,b=g?ge(Ar.interpolationFactor(g,r,v,x),0,1):0;s.kind==="camera"?c=Mr.number(s.minSize,s.maxSize,b):o=b}return{uSizeT:o,uSize:c}},f.ai=function(s,{uSize:r,uSizeT:o},{lowerSize:c,upperSize:g}){return s.kind==="source"?c/Us:s.kind==="composite"?Mr.number(c/Us,g/Us,o):r},f.aj=u_,f.ak=function(s,r,o,c){const g=r.y-s.y,v=r.x-s.x,x=c.y-o.y,b=c.x-o.x,S=x*v-b*g;if(S===0)return null;const P=(b*(s.y-o.y)-x*(s.x-o.x))/S;return new z(s.x+P*v,s.y+P*g)},f.al=lw,f.am=K1,f.an=qy,f.ao=function(s){let r=1/0,o=1/0,c=-1/0,g=-1/0;for(const v of s)r=Math.min(r,v.x),o=Math.min(o,v.y),c=Math.max(c,v.x),g=Math.max(g,v.y);return[r,o,c,g]},f.ap=jn,f.ar=l_,f.as=function(s,r){var o=r[0],c=r[1],g=r[2],v=r[3],x=r[4],b=r[5],S=r[6],P=r[7],M=r[8],R=r[9],B=r[10],N=r[11],q=r[12],W=r[13],te=r[14],oe=r[15],Se=o*b-c*x,pe=o*S-g*x,xe=o*P-v*x,Pe=c*S-g*b,Be=c*P-v*b,tt=g*P-v*S,gt=M*W-R*q,Je=M*te-B*q,Ke=M*oe-N*q,ct=R*te-B*W,st=R*oe-N*W,rt=B*oe-N*te,Me=Se*rt-pe*st+xe*ct+Pe*Ke-Be*Je+tt*gt;return Me?(s[0]=(b*rt-S*st+P*ct)*(Me=1/Me),s[1]=(g*st-c*rt-v*ct)*Me,s[2]=(W*tt-te*Be+oe*Pe)*Me,s[3]=(B*Be-R*tt-N*Pe)*Me,s[4]=(S*Ke-x*rt-P*Je)*Me,s[5]=(o*rt-g*Ke+v*Je)*Me,s[6]=(te*xe-q*tt-oe*pe)*Me,s[7]=(M*tt-B*xe+N*pe)*Me,s[8]=(x*st-b*Ke+P*gt)*Me,s[9]=(c*Ke-o*st-v*gt)*Me,s[10]=(q*Be-W*xe+oe*Se)*Me,s[11]=(R*xe-M*Be-N*Se)*Me,s[12]=(b*Je-x*ct-S*gt)*Me,s[13]=(o*ct-c*Je+g*gt)*Me,s[14]=(W*pe-q*Pe-te*Se)*Me,s[15]=(M*Pe-R*pe+B*Se)*Me,s):null},f.at=y_,f.au=a_,f.av=__,f.aw=function(){const s={},r=ke.$version;for(const o in ke.$root){const c=ke.$root[o];if(c.required){let g=null;g=o==="version"?r:c.type==="array"?[]:{},g!=null&&(s[o]=g)}}return s},f.ax=Rh,f.ay=Wr,f.az=function(s){s=s.slice();const r=Object.create(null);for(let o=0;o<s.length;o++)r[s[o].id]=s[o];for(let o=0;o<s.length;o++)"ref"in s[o]&&(s[o]=Ci(s[o],r[s[o].ref]));return s},f.b=_t,f.b0=function(s,r){return s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[4]=r[4],s[5]=r[5],s[6]=r[6],s[7]=r[7],s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},f.b1=function(s,r,o){return s[0]=r[0]*o[0],s[1]=r[1]*o[1],s[2]=r[2]*o[2],s[3]=r[3]*o[3],s},f.b2=function(s,r){return s[0]*r[0]+s[1]*r[1]+s[2]*r[2]+s[3]*r[3]},f.b3=fe,f.b4=tw,f.b5=Qb,f.b6=function(s,r,o,c,g){var v,x=1/Math.tan(r/2);return s[0]=x/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=x,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,g!=null&&g!==1/0?(s[10]=(g+c)*(v=1/(c-g)),s[14]=2*g*c*v):(s[10]=-1,s[14]=-2*c),s},f.b7=function(s,r,o){var c=Math.sin(o),g=Math.cos(o),v=r[4],x=r[5],b=r[6],S=r[7],P=r[8],M=r[9],R=r[10],B=r[11];return r!==s&&(s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[4]=v*g+P*c,s[5]=x*g+M*c,s[6]=b*g+R*c,s[7]=S*g+B*c,s[8]=P*g-v*c,s[9]=M*g-x*c,s[10]=R*g-b*c,s[11]=B*g-S*c,s},f.b8=X,f.b9=ne,f.bA=Pb,f.bB=function(s){return s.message===Bt},f.bC=na,f.bD=Yr,f.ba=function(s){return s*Math.PI/180},f.bb=function(s,r){const{x:o,y:c}=ed.fromLngLat(r);return!(s<0||s>25||c<0||c>=1||o<0||o>=1)},f.bc=function(s,r){return s[0]=r[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=r[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=r[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},f.bd=class extends A{},f.be=f_,f.bf=mA,f.bh=Dn,f.bi=function(s,r){Gn.REGISTERED_PROTOCOLS[s]=r},f.bj=function(s){delete Gn.REGISTERED_PROTOCOLS[s]},f.bk=function(s,r){const o={};for(let g=0;g<s.length;g++){const v=r&&r[s[g].id]||tp(s[g]);r&&(r[s[g].id]=v);let x=o[v];x||(x=o[v]=[]),x.push(s[g])}const c=[];for(const g in o)c.push(o[g]);return c},f.bl=it,f.bm=rw,f.bn=sw,f.bo=Fb,f.bp=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=Fn/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const r=s.bucket.layers[0],o=r.layout,c=r._unevaluatedLayout._values,g={layoutIconSize:c["icon-size"].possiblyEvaluate(new un(s.bucket.zoom+1),s.canonical),layoutTextSize:c["text-size"].possiblyEvaluate(new un(s.bucket.zoom+1),s.canonical),textMaxSize:c["text-size"].possiblyEvaluate(new un(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:M}=s.bucket.textSizeData;g.compositeTextSizes=[c["text-size"].possiblyEvaluate(new un(P),s.canonical),c["text-size"].possiblyEvaluate(new un(M),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:M}=s.bucket.iconSizeData;g.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new un(P),s.canonical),c["icon-size"].possiblyEvaluate(new un(M),s.canonical)]}const v=o.get("text-line-height")*jn,x=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",b=o.get("text-keep-upright"),S=o.get("text-size");for(const P of s.bucket.features){const M=o.get("text-font").evaluate(P,{},s.canonical).join(","),R=S.evaluate(P,{},s.canonical),B=g.layoutTextSize.evaluate(P,{},s.canonical),N=g.layoutIconSize.evaluate(P,{},s.canonical),q={horizontal:{},vertical:void 0},W=P.text;let te,oe=[0,0];if(W){const xe=W.toString(),Pe=o.get("text-letter-spacing").evaluate(P,{},s.canonical)*jn,Be=Dy(xe)?Pe:0,tt=o.get("text-anchor").evaluate(P,{},s.canonical),gt=yw(r,P,s.canonical);if(!gt){const st=o.get("text-radial-offset").evaluate(P,{},s.canonical);oe=st?gw(tt,[st*jn,g_]):o.get("text-offset").evaluate(P,{},s.canonical).map(rt=>rt*jn)}let Je=x?"center":o.get("text-justify").evaluate(P,{},s.canonical);const Ke=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(P,{},s.canonical)*jn:1/0,ct=()=>{s.bucket.allowVerticalPlacement&&Lh(xe)&&(q.vertical=Sp(W,s.glyphMap,s.glyphPositions,s.imagePositions,M,Ke,v,tt,"left",Be,oe,f.ah.vertical,!0,B,R))};if(!x&&gt){const st=new Set;if(Je==="auto")for(let Me=0;Me<gt.values.length;Me+=2)st.add(y_(gt.values[Me]));else st.add(Je);let rt=!1;for(const Me of st)if(!q.horizontal[Me])if(rt)q.horizontal[Me]=q.horizontal[0];else{const ht=Sp(W,s.glyphMap,s.glyphPositions,s.imagePositions,M,Ke,v,"center",Me,Be,oe,f.ah.horizontal,!1,B,R);ht&&(q.horizontal[Me]=ht,rt=ht.positionedLines.length===1)}ct()}else{Je==="auto"&&(Je=y_(tt));const st=Sp(W,s.glyphMap,s.glyphPositions,s.imagePositions,M,Ke,v,tt,Je,Be,oe,f.ah.horizontal,!1,B,R);st&&(q.horizontal[Je]=st),ct(),Lh(xe)&&x&&b&&(q.vertical=Sp(W,s.glyphMap,s.glyphPositions,s.imagePositions,M,Ke,v,tt,Je,Be,oe,f.ah.vertical,!1,B,R))}}let Se=!1;if(P.icon&&P.icon.name){const xe=s.imageMap[P.icon.name];xe&&(te=YM(s.imagePositions[P.icon.name],o.get("icon-offset").evaluate(P,{},s.canonical),o.get("icon-anchor").evaluate(P,{},s.canonical)),Se=!!xe.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=Se:s.bucket.sdfIcons!==Se&&ze("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(xe.pixelRatio!==s.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const pe=vw(q.horizontal)||q.vertical;s.bucket.iconsInText=!!pe&&pe.iconsInText,(pe||te)&&fA(s.bucket,P,q,te,s.imageMap,g,B,N,oe,Se,s.canonical)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},f.bq=t_,f.br=Jy,f.bs=e_,f.bt=_a,f.bu=r_,f.bv=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},f.bw=function(s,r,o,c,g){return u(this,void 0,void 0,function*(){if(U())try{return yield et(s,r,o,c,g)}catch{}return function(v,x,b,S,P){const M=v.width,R=v.height;pt&&Pt||(pt=new OffscreenCanvas(M,R),Pt=pt.getContext("2d",{willReadFrequently:!0})),pt.width=M,pt.height=R,Pt.drawImage(v,0,0,M,R);const B=Pt.getImageData(x,b,S,P);return Pt.clearRect(0,0,M,R),B.data}(s,r,o,c,g)})},f.bx=nw,f.by=T,f.bz=E,f.c=Gr,f.d=s=>u(void 0,void 0,void 0,function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(r)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),f.e=we,f.f=s=>new Promise((r,o)=>{const c=new Image;c.onload=()=>{r(c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame(()=>{c.src=Oe})},c.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const g=new Blob([new Uint8Array(s)],{type:"image/png"});c.src=s.byteLength?URL.createObjectURL(g):Oe}),f.g=sr,f.h=(s,r)=>vs(we(s,{type:"json"}),r),f.i=ot,f.j=oi,f.k=Xi,f.l=(s,r)=>vs(we(s,{type:"arrayBuffer"}),r),f.m=vs,f.n=function(s){return new r_(s).readFields(qM,[])},f.o=qh,f.p=Lb,f.q=_,f.r=Ay,f.s=xs,f.t=zh,f.u=bo,f.v=ke,f.w=ze,f.x=function([s,r,o]){return r+=90,r*=Math.PI/180,o*=Math.PI/180,{x:s*Math.cos(r)*Math.sin(o),y:s*Math.sin(r)*Math.sin(o),z:s*Math.cos(o)}},f.y=Mr,f.z=un}),h("worker",["./shared"],function(f){class u{constructor(V){this.keyCache={},V&&this.replace(V)}replace(V){this._layerConfigs={},this._layers={},this.update(V,[])}update(V,O){for(const re of V){this._layerConfigs[re.id]=re;const me=this._layers[re.id]=f.aA(re);me._featureFilter=f.a7(me.filter),this.keyCache[re.id]&&delete this.keyCache[re.id]}for(const re of O)delete this.keyCache[re],delete this._layerConfigs[re],delete this._layers[re];this.familiesBySource={};const Z=f.bk(Object.values(this._layerConfigs),this.keyCache);for(const re of Z){const me=re.map(Ce=>this._layers[Ce.id]),_e=me[0];if(_e.visibility==="none")continue;const be=_e.source||"";let he=this.familiesBySource[be];he||(he=this.familiesBySource[be]={});const Ee=_e.sourceLayer||"_geojsonTileLayer";let Fe=he[Ee];Fe||(Fe=he[Ee]=[]),Fe.push(me)}}}class T{constructor(V){const O={},Z=[];for(const be in V){const he=V[be],Ee=O[be]={};for(const Fe in he){const Ce=he[+Fe];if(!Ce||Ce.bitmap.width===0||Ce.bitmap.height===0)continue;const Ge={x:0,y:0,w:Ce.bitmap.width+2,h:Ce.bitmap.height+2};Z.push(Ge),Ee[Fe]={rect:Ge,metrics:Ce.metrics}}}const{w:re,h:me}=f.p(Z),_e=new f.o({width:re||1,height:me||1});for(const be in V){const he=V[be];for(const Ee in he){const Fe=he[+Ee];if(!Fe||Fe.bitmap.width===0||Fe.bitmap.height===0)continue;const Ce=O[be][Ee].rect;f.o.copy(Fe.bitmap,_e,{x:0,y:0},{x:Ce.x+1,y:Ce.y+1},Fe.bitmap)}}this.image=_e,this.positions=O}}f.bl("GlyphAtlas",T);class E{constructor(V){this.tileID=new f.S(V.tileID.overscaledZ,V.tileID.wrap,V.tileID.canonical.z,V.tileID.canonical.x,V.tileID.canonical.y),this.uid=V.uid,this.zoom=V.zoom,this.pixelRatio=V.pixelRatio,this.tileSize=V.tileSize,this.source=V.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=V.showCollisionBoxes,this.collectResourceTiming=!!V.collectResourceTiming,this.returnDependencies=!!V.returnDependencies,this.promoteId=V.promoteId,this.inFlightDependencies=[]}parse(V,O,Z,re){return f._(this,void 0,void 0,function*(){this.status="parsing",this.data=V,this.collisionBoxArray=new f.a5;const me=new f.bm(Object.keys(V.layers).sort()),_e=new f.bn(this.tileID,this.promoteId);_e.bucketLayerIDs=[];const be={},he={featureIndex:_e,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Z},Ee=O.familiesBySource[this.source];for(const At in Ee){const Zt=V.layers[At];if(!Zt)continue;Zt.version===1&&f.w(`Vector tile source "${this.source}" layer "${At}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const pn=me.encode(At),Wn=[];for(let Qn=0;Qn<Zt.length;Qn++){const vr=Zt.feature(Qn),Go=_e.getId(vr,At);Wn.push({feature:vr,id:Go,index:Qn,sourceLayerIndex:pn})}for(const Qn of Ee[At]){const vr=Qn[0];vr.source!==this.source&&f.w(`layer.source = ${vr.source} does not equal this.source = ${this.source}`),vr.minzoom&&this.zoom<Math.floor(vr.minzoom)||vr.maxzoom&&this.zoom>=vr.maxzoom||vr.visibility!=="none"&&(D(Qn,this.zoom,Z),(be[vr.id]=vr.createBucket({index:_e.bucketLayerIDs.length,layers:Qn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:pn,sourceID:this.source})).populate(Wn,he,this.tileID.canonical),_e.bucketLayerIDs.push(Qn.map(Go=>Go.id)))}}const Fe=f.aF(he.glyphDependencies,At=>Object.keys(At).map(Number));this.inFlightDependencies.forEach(At=>At==null?void 0:At.abort()),this.inFlightDependencies=[];let Ce=Promise.resolve({});if(Object.keys(Fe).length){const At=new AbortController;this.inFlightDependencies.push(At),Ce=re.sendAsync({type:"GG",data:{stacks:Fe,source:this.source,tileID:this.tileID,type:"glyphs"}},At)}const Ge=Object.keys(he.iconDependencies);let dt=Promise.resolve({});if(Ge.length){const At=new AbortController;this.inFlightDependencies.push(At),dt=re.sendAsync({type:"GI",data:{icons:Ge,source:this.source,tileID:this.tileID,type:"icons"}},At)}const mt=Object.keys(he.patternDependencies);let Vt=Promise.resolve({});if(mt.length){const At=new AbortController;this.inFlightDependencies.push(At),Vt=re.sendAsync({type:"GI",data:{icons:mt,source:this.source,tileID:this.tileID,type:"patterns"}},At)}const[kt,Nt,Dt]=yield Promise.all([Ce,dt,Vt]),Rn=new T(kt),yn=new f.bo(Nt,Dt);for(const At in be){const Zt=be[At];Zt instanceof f.a6?(D(Zt.layers,this.zoom,Z),f.bp({bucket:Zt,glyphMap:kt,glyphPositions:Rn.positions,imageMap:Nt,imagePositions:yn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Zt.hasPattern&&(Zt instanceof f.bq||Zt instanceof f.br||Zt instanceof f.bs)&&(D(Zt.layers,this.zoom,Z),Zt.addFeatures(he,this.tileID.canonical,yn.patternPositions))}return this.status="done",{buckets:Object.values(be).filter(At=>!At.isEmpty()),featureIndex:_e,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Rn.image,imageAtlas:yn,glyphMap:this.returnDependencies?kt:null,iconMap:this.returnDependencies?Nt:null,glyphPositions:this.returnDependencies?Rn.positions:null}})}}function D(se,V,O){const Z=new f.z(V);for(const re of se)re.recalculate(Z,O)}class z{constructor(V,O,Z){this.actor=V,this.layerIndex=O,this.availableImages=Z,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(V,O){return f._(this,void 0,void 0,function*(){const Z=yield f.l(V.request,O);try{return{vectorTile:new f.bt.VectorTile(new f.bu(Z.data)),rawData:Z.data,cacheControl:Z.cacheControl,expires:Z.expires}}catch(re){const me=new Uint8Array(Z.data);let _e=`Unable to parse the tile at ${V.request.url}, `;throw _e+=me[0]===31&&me[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${re.message}`,new Error(_e)}})}loadTile(V){return f._(this,void 0,void 0,function*(){const O=V.uid,Z=!!(V&&V.request&&V.request.collectResourceTiming)&&new f.bv(V.request),re=new E(V);this.loading[O]=re;const me=new AbortController;re.abort=me;try{const _e=yield this.loadVectorTile(V,me);if(delete this.loading[O],!_e)return null;const be=_e.rawData,he={};_e.expires&&(he.expires=_e.expires),_e.cacheControl&&(he.cacheControl=_e.cacheControl);const Ee={};if(Z){const Ce=Z.finish();Ce&&(Ee.resourceTiming=JSON.parse(JSON.stringify(Ce)))}re.vectorTile=_e.vectorTile;const Fe=re.parse(_e.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[O]=re,this.fetching[O]={rawTileData:be,cacheControl:he,resourceTiming:Ee};try{const Ce=yield Fe;return f.e({rawTileData:be.slice(0)},Ce,he,Ee)}finally{delete this.fetching[O]}}catch(_e){throw delete this.loading[O],re.status="done",this.loaded[O]=re,_e}})}reloadTile(V){return f._(this,void 0,void 0,function*(){const O=V.uid;if(!this.loaded||!this.loaded[O])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const Z=this.loaded[O];if(Z.showCollisionBoxes=V.showCollisionBoxes,Z.status==="parsing"){const re=yield Z.parse(Z.vectorTile,this.layerIndex,this.availableImages,this.actor);let me;if(this.fetching[O]){const{rawTileData:_e,cacheControl:be,resourceTiming:he}=this.fetching[O];delete this.fetching[O],me=f.e({rawTileData:_e.slice(0)},re,be,he)}else me=re;return me}if(Z.status==="done"&&Z.vectorTile)return Z.parse(Z.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(V){return f._(this,void 0,void 0,function*(){const O=this.loading,Z=V.uid;O&&O[Z]&&O[Z].abort&&(O[Z].abort.abort(),delete O[Z])})}removeTile(V){return f._(this,void 0,void 0,function*(){this.loaded&&this.loaded[V.uid]&&delete this.loaded[V.uid]})}}class I{constructor(){this.loaded={}}loadTile(V){return f._(this,void 0,void 0,function*(){const{uid:O,encoding:Z,rawImageData:re,redFactor:me,greenFactor:_e,blueFactor:be,baseShift:he}=V,Ee=re.width+2,Fe=re.height+2,Ce=f.b(re)?new f.R({width:Ee,height:Fe},yield f.bw(re,-1,-1,Ee,Fe)):re,Ge=new f.bx(O,Ce,Z,me,_e,be,he);return this.loaded=this.loaded||{},this.loaded[O]=Ge,Ge})}removeTile(V){const O=this.loaded,Z=V.uid;O&&O[Z]&&delete O[Z]}}function G(se,V){if(se.length!==0){K(se[0],V);for(var O=1;O<se.length;O++)K(se[O],!V)}}function K(se,V){for(var O=0,Z=0,re=0,me=se.length,_e=me-1;re<me;_e=re++){var be=(se[re][0]-se[_e][0])*(se[_e][1]+se[re][1]),he=O+be;Z+=Math.abs(O)>=Math.abs(be)?O-he+be:be-he+O,O=he}O+Z>=0!=!!V&&se.reverse()}var Q=f.by(function se(V,O){var Z,re=V&&V.type;if(re==="FeatureCollection")for(Z=0;Z<V.features.length;Z++)se(V.features[Z],O);else if(re==="GeometryCollection")for(Z=0;Z<V.geometries.length;Z++)se(V.geometries[Z],O);else if(re==="Feature")se(V.geometry,O);else if(re==="Polygon")G(V.coordinates,O);else if(re==="MultiPolygon")for(Z=0;Z<V.coordinates.length;Z++)G(V.coordinates[Z],O);return V});const ce=f.bt.VectorTileFeature.prototype.toGeoJSON;var j={exports:{}},U=f.bz,X=f.bt.VectorTileFeature,ne=ge;function ge(se,V){this.options=V||{},this.features=se,this.length=se.length}function fe(se,V){this.id=typeof se.id=="number"?se.id:void 0,this.type=se.type,this.rawGeometry=se.type===1?[se.geometry]:se.geometry,this.properties=se.tags,this.extent=V||4096}ge.prototype.feature=function(se){return new fe(this.features[se],this.options.extent)},fe.prototype.loadGeometry=function(){var se=this.rawGeometry;this.geometry=[];for(var V=0;V<se.length;V++){for(var O=se[V],Z=[],re=0;re<O.length;re++)Z.push(new U(O[re][0],O[re][1]));this.geometry.push(Z)}return this.geometry},fe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var se=this.geometry,V=1/0,O=-1/0,Z=1/0,re=-1/0,me=0;me<se.length;me++)for(var _e=se[me],be=0;be<_e.length;be++){var he=_e[be];V=Math.min(V,he.x),O=Math.max(O,he.x),Z=Math.min(Z,he.y),re=Math.max(re,he.y)}return[V,Z,O,re]},fe.prototype.toGeoJSON=X.prototype.toGeoJSON;var we=f.bA,Ie=ne;function Ne(se){var V=new we;return function(O,Z){for(var re in O.layers)Z.writeMessage(3,$e,O.layers[re])}(se,V),V.finish()}function $e(se,V){var O;V.writeVarintField(15,se.version||1),V.writeStringField(1,se.name||""),V.writeVarintField(5,se.extent||4096);var Z={keys:[],values:[],keycache:{},valuecache:{}};for(O=0;O<se.length;O++)Z.feature=se.feature(O),V.writeMessage(2,Ve,Z);var re=Z.keys;for(O=0;O<re.length;O++)V.writeStringField(3,re[O]);var me=Z.values;for(O=0;O<me.length;O++)V.writeMessage(4,xt,me[O])}function Ve(se,V){var O=se.feature;O.id!==void 0&&V.writeVarintField(1,O.id),V.writeMessage(2,J,se),V.writeVarintField(3,O.type),V.writeMessage(4,ot,O)}function J(se,V){var O=se.feature,Z=se.keys,re=se.values,me=se.keycache,_e=se.valuecache;for(var be in O.properties){var he=O.properties[be],Ee=me[be];if(he!==null){Ee===void 0&&(Z.push(be),me[be]=Ee=Z.length-1),V.writeVarint(Ee);var Fe=typeof he;Fe!=="string"&&Fe!=="boolean"&&Fe!=="number"&&(he=JSON.stringify(he));var Ce=Fe+":"+he,Ge=_e[Ce];Ge===void 0&&(re.push(he),_e[Ce]=Ge=re.length-1),V.writeVarint(Ge)}}}function ze(se,V){return(V<<3)+(7&se)}function Le(se){return se<<1^se>>31}function ot(se,V){for(var O=se.loadGeometry(),Z=se.type,re=0,me=0,_e=O.length,be=0;be<_e;be++){var he=O[be],Ee=1;Z===1&&(Ee=he.length),V.writeVarint(ze(1,Ee));for(var Fe=Z===3?he.length-1:he.length,Ce=0;Ce<Fe;Ce++){Ce===1&&Z!==1&&V.writeVarint(ze(2,Fe-1));var Ge=he[Ce].x-re,dt=he[Ce].y-me;V.writeVarint(Le(Ge)),V.writeVarint(Le(dt)),re+=Ge,me+=dt}Z===3&&V.writeVarint(ze(7,1))}}function xt(se,V){var O=typeof se;O==="string"?V.writeStringField(1,se):O==="boolean"?V.writeBooleanField(7,se):O==="number"&&(se%1!=0?V.writeDoubleField(3,se):se<0?V.writeSVarintField(6,se):V.writeVarintField(5,se))}j.exports=Ne,j.exports.fromVectorTileJs=Ne,j.exports.fromGeojsonVt=function(se,V){V=V||{};var O={};for(var Z in se)O[Z]=new Ie(se[Z].features,V),O[Z].name=Z,O[Z].version=V.version,O[Z].extent=V.extent;return Ne({layers:O})},j.exports.GeoJSONWrapper=Ie;var _t=f.by(j.exports);const Oe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:se=>se},et=Math.fround||(pt=new Float32Array(1),se=>(pt[0]=+se,pt[0]));var pt;const Pt=3,Bt=5,Gr=6;class Gn{constructor(V){this.options=Object.assign(Object.create(Oe),V),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(V){const{log:O,minZoom:Z,maxZoom:re}=this.options;O&&console.time("total time");const me=`prepare ${V.length} points`;O&&console.time(me),this.points=V;const _e=[];for(let he=0;he<V.length;he++){const Ee=V[he];if(!Ee.geometry)continue;const[Fe,Ce]=Ee.geometry.coordinates,Ge=et(Dn(Fe)),dt=et(Wr(Ce));_e.push(Ge,dt,1/0,he,-1,1),this.options.reduce&&_e.push(0)}let be=this.trees[re+1]=this._createTree(_e);O&&console.timeEnd(me);for(let he=re;he>=Z;he--){const Ee=+Date.now();be=this.trees[he]=this._createTree(this._cluster(be,he)),O&&console.log("z%d: %d clusters in %dms",he,be.numItems,+Date.now()-Ee)}return O&&console.timeEnd("total time"),this}getClusters(V,O){let Z=((V[0]+180)%360+360)%360-180;const re=Math.max(-90,Math.min(90,V[1]));let me=V[2]===180?180:((V[2]+180)%360+360)%360-180;const _e=Math.max(-90,Math.min(90,V[3]));if(V[2]-V[0]>=360)Z=-180,me=180;else if(Z>me){const Ce=this.getClusters([Z,re,180,_e],O),Ge=this.getClusters([-180,re,me,_e],O);return Ce.concat(Ge)}const be=this.trees[this._limitZoom(O)],he=be.range(Dn(Z),Wr(_e),Dn(me),Wr(re)),Ee=be.data,Fe=[];for(const Ce of he){const Ge=this.stride*Ce;Fe.push(Ee[Ge+Bt]>1?sr(Ee,Ge,this.clusterProps):this.points[Ee[Ge+Pt]])}return Fe}getChildren(V){const O=this._getOriginId(V),Z=this._getOriginZoom(V),re="No cluster with the specified id.",me=this.trees[Z];if(!me)throw new Error(re);const _e=me.data;if(O*this.stride>=_e.length)throw new Error(re);const be=this.options.radius/(this.options.extent*Math.pow(2,Z-1)),he=me.within(_e[O*this.stride],_e[O*this.stride+1],be),Ee=[];for(const Fe of he){const Ce=Fe*this.stride;_e[Ce+4]===V&&Ee.push(_e[Ce+Bt]>1?sr(_e,Ce,this.clusterProps):this.points[_e[Ce+Pt]])}if(Ee.length===0)throw new Error(re);return Ee}getLeaves(V,O,Z){const re=[];return this._appendLeaves(re,V,O=O||10,Z=Z||0,0),re}getTile(V,O,Z){const re=this.trees[this._limitZoom(V)],me=Math.pow(2,V),{extent:_e,radius:be}=this.options,he=be/_e,Ee=(Z-he)/me,Fe=(Z+1+he)/me,Ce={features:[]};return this._addTileFeatures(re.range((O-he)/me,Ee,(O+1+he)/me,Fe),re.data,O,Z,me,Ce),O===0&&this._addTileFeatures(re.range(1-he/me,Ee,1,Fe),re.data,me,Z,me,Ce),O===me-1&&this._addTileFeatures(re.range(0,Ee,he/me,Fe),re.data,-1,Z,me,Ce),Ce.features.length?Ce:null}getClusterExpansionZoom(V){let O=this._getOriginZoom(V)-1;for(;O<=this.options.maxZoom;){const Z=this.getChildren(V);if(O++,Z.length!==1)break;V=Z[0].properties.cluster_id}return O}_appendLeaves(V,O,Z,re,me){const _e=this.getChildren(O);for(const be of _e){const he=be.properties;if(he&&he.cluster?me+he.point_count<=re?me+=he.point_count:me=this._appendLeaves(V,he.cluster_id,Z,re,me):me<re?me++:V.push(be),V.length===Z)break}return me}_createTree(V){const O=new f.av(V.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Z=0;Z<V.length;Z+=this.stride)O.add(V[Z],V[Z+1]);return O.finish(),O.data=V,O}_addTileFeatures(V,O,Z,re,me,_e){for(const be of V){const he=be*this.stride,Ee=O[he+Bt]>1;let Fe,Ce,Ge;if(Ee)Fe=or(O,he,this.clusterProps),Ce=O[he],Ge=O[he+1];else{const Vt=this.points[O[he+Pt]];Fe=Vt.properties;const[kt,Nt]=Vt.geometry.coordinates;Ce=Dn(kt),Ge=Wr(Nt)}const dt={type:1,geometry:[[Math.round(this.options.extent*(Ce*me-Z)),Math.round(this.options.extent*(Ge*me-re))]],tags:Fe};let mt;mt=Ee||this.options.generateId?O[he+Pt]:this.points[O[he+Pt]].id,mt!==void 0&&(dt.id=mt),_e.features.push(dt)}}_limitZoom(V){return Math.max(this.options.minZoom,Math.min(Math.floor(+V),this.options.maxZoom+1))}_cluster(V,O){const{radius:Z,extent:re,reduce:me,minPoints:_e}=this.options,be=Z/(re*Math.pow(2,O)),he=V.data,Ee=[],Fe=this.stride;for(let Ce=0;Ce<he.length;Ce+=Fe){if(he[Ce+2]<=O)continue;he[Ce+2]=O;const Ge=he[Ce],dt=he[Ce+1],mt=V.within(he[Ce],he[Ce+1],be),Vt=he[Ce+Bt];let kt=Vt;for(const Nt of mt){const Dt=Nt*Fe;he[Dt+2]>O&&(kt+=he[Dt+Bt])}if(kt>Vt&&kt>=_e){let Nt,Dt=Ge*Vt,Rn=dt*Vt,yn=-1;const At=((Ce/Fe|0)<<5)+(O+1)+this.points.length;for(const Zt of mt){const pn=Zt*Fe;if(he[pn+2]<=O)continue;he[pn+2]=O;const Wn=he[pn+Bt];Dt+=he[pn]*Wn,Rn+=he[pn+1]*Wn,he[pn+4]=At,me&&(Nt||(Nt=this._map(he,Ce,!0),yn=this.clusterProps.length,this.clusterProps.push(Nt)),me(Nt,this._map(he,pn)))}he[Ce+4]=At,Ee.push(Dt/kt,Rn/kt,1/0,At,-1,kt),me&&Ee.push(yn)}else{for(let Nt=0;Nt<Fe;Nt++)Ee.push(he[Ce+Nt]);if(kt>1)for(const Nt of mt){const Dt=Nt*Fe;if(!(he[Dt+2]<=O)){he[Dt+2]=O;for(let Rn=0;Rn<Fe;Rn++)Ee.push(he[Dt+Rn])}}}}return Ee}_getOriginId(V){return V-this.points.length>>5}_getOriginZoom(V){return(V-this.points.length)%32}_map(V,O,Z){if(V[O+Bt]>1){const _e=this.clusterProps[V[O+Gr]];return Z?Object.assign({},_e):_e}const re=this.points[V[O+Pt]].properties,me=this.options.map(re);return Z&&me===re?Object.assign({},me):me}}function sr(se,V,O){return{type:"Feature",id:se[V+Pt],properties:or(se,V,O),geometry:{type:"Point",coordinates:[(Z=se[V],360*(Z-.5)),vs(se[V+1])]}};var Z}function or(se,V,O){const Z=se[V+Bt],re=Z>=1e4?`${Math.round(Z/1e3)}k`:Z>=1e3?Math.round(Z/100)/10+"k":Z,me=se[V+Gr],_e=me===-1?{}:Object.assign({},O[me]);return Object.assign(_e,{cluster:!0,cluster_id:se[V+Pt],point_count:Z,point_count_abbreviated:re})}function Dn(se){return se/360+.5}function Wr(se){const V=Math.sin(se*Math.PI/180),O=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return O<0?0:O>1?1:O}function vs(se){const V=(180-360*se)*Math.PI/180;return 360*Math.atan(Math.exp(V))/Math.PI-90}function xs(se,V,O,Z){let re=Z;const me=V+(O-V>>1);let _e,be=O-V;const he=se[V],Ee=se[V+1],Fe=se[O],Ce=se[O+1];for(let Ge=V+3;Ge<O;Ge+=3){const dt=ao(se[Ge],se[Ge+1],he,Ee,Fe,Ce);if(dt>re)_e=Ge,re=dt;else if(dt===re){const mt=Math.abs(Ge-me);mt<be&&(_e=Ge,be=mt)}}re>Z&&(_e-V>3&&xs(se,V,_e,Z),se[_e+2]=re,O-_e>3&&xs(se,_e,O,Z))}function ao(se,V,O,Z,re,me){let _e=re-O,be=me-Z;if(_e!==0||be!==0){const he=((se-O)*_e+(V-Z)*be)/(_e*_e+be*be);he>1?(O=re,Z=me):he>0&&(O+=_e*he,Z+=be*he)}return _e=se-O,be=V-Z,_e*_e+be*be}function Ti(se,V,O,Z){const re={id:se??null,type:V,geometry:O,tags:Z,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(V==="Point"||V==="MultiPoint"||V==="LineString")Xi(re,O);else if(V==="Polygon")Xi(re,O[0]);else if(V==="MultiLineString")for(const me of O)Xi(re,me);else if(V==="MultiPolygon")for(const me of O)Xi(re,me[0]);return re}function Xi(se,V){for(let O=0;O<V.length;O+=3)se.minX=Math.min(se.minX,V[O]),se.minY=Math.min(se.minY,V[O+1]),se.maxX=Math.max(se.maxX,V[O]),se.maxY=Math.max(se.maxY,V[O+1])}function oi(se,V,O,Z){if(!V.geometry)return;const re=V.geometry.coordinates;if(re&&re.length===0)return;const me=V.geometry.type,_e=Math.pow(O.tolerance/((1<<O.maxZoom)*O.extent),2);let be=[],he=V.id;if(O.promoteId?he=V.properties[O.promoteId]:O.generateId&&(he=Z||0),me==="Point")Fs(re,be);else if(me==="MultiPoint")for(const Ee of re)Fs(Ee,be);else if(me==="LineString")ke(re,be,_e,!1);else if(me==="MultiLineString"){if(O.lineMetrics){for(const Ee of re)be=[],ke(Ee,be,_e,!1),se.push(Ti(he,"LineString",be,V.properties));return}ai(re,be,_e,!1)}else if(me==="Polygon")ai(re,be,_e,!0);else{if(me!=="MultiPolygon"){if(me==="GeometryCollection"){for(const Ee of V.geometry.geometries)oi(se,{id:he,geometry:Ee,properties:V.properties},O,Z);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ee of re){const Fe=[];ai(Ee,Fe,_e,!0),be.push(Fe)}}se.push(Ti(he,me,be,V.properties))}function Fs(se,V){V.push(Ci(se[0]),Ot(se[1]),0)}function ke(se,V,O,Z){let re,me,_e=0;for(let he=0;he<se.length;he++){const Ee=Ci(se[he][0]),Fe=Ot(se[he][1]);V.push(Ee,Fe,0),he>0&&(_e+=Z?(re*Fe-Ee*me)/2:Math.sqrt(Math.pow(Ee-re,2)+Math.pow(Fe-me,2))),re=Ee,me=Fe}const be=V.length-3;V[2]=1,xs(V,0,be,O),V[be+2]=1,V.size=Math.abs(_e),V.start=0,V.end=V.size}function ai(se,V,O,Z){for(let re=0;re<se.length;re++){const me=[];ke(se[re],me,O,Z),V.push(me)}}function Ci(se){return se/360+.5}function Ot(se){const V=Math.sin(se*Math.PI/180),O=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return O<0?0:O>1?1:O}function ln(se,V,O,Z,re,me,_e,be){if(Z/=V,me>=(O/=V)&&_e<Z)return se;if(_e<O||me>=Z)return null;const he=[];for(const Ee of se){const Fe=Ee.geometry;let Ce=Ee.type;const Ge=re===0?Ee.minX:Ee.minY,dt=re===0?Ee.maxX:Ee.maxY;if(Ge>=O&&dt<Z){he.push(Ee);continue}if(dt<O||Ge>=Z)continue;let mt=[];if(Ce==="Point"||Ce==="MultiPoint")lo(Fe,mt,O,Z,re);else if(Ce==="LineString")Tt(Fe,mt,O,Z,re,!1,be.lineMetrics);else if(Ce==="MultiLineString")qo(Fe,mt,O,Z,re,!1);else if(Ce==="Polygon")qo(Fe,mt,O,Z,re,!0);else if(Ce==="MultiPolygon")for(const Vt of Fe){const kt=[];qo(Vt,kt,O,Z,re,!0),kt.length&&mt.push(kt)}if(mt.length){if(be.lineMetrics&&Ce==="LineString"){for(const Vt of mt)he.push(Ti(Ee.id,Ce,Vt,Ee.tags));continue}Ce!=="LineString"&&Ce!=="MultiLineString"||(mt.length===1?(Ce="LineString",mt=mt[0]):Ce="MultiLineString"),Ce!=="Point"&&Ce!=="MultiPoint"||(Ce=mt.length===3?"Point":"MultiPoint"),he.push(Ti(Ee.id,Ce,mt,Ee.tags))}}return he.length?he:null}function lo(se,V,O,Z,re){for(let me=0;me<se.length;me+=3){const _e=se[me+re];_e>=O&&_e<=Z&&li(V,se[me],se[me+1],se[me+2])}}function Tt(se,V,O,Z,re,me,_e){let be=bs(se);const he=re===0?Ya:Ja;let Ee,Fe,Ce=se.start;for(let kt=0;kt<se.length-3;kt+=3){const Nt=se[kt],Dt=se[kt+1],Rn=se[kt+2],yn=se[kt+3],At=se[kt+4],Zt=re===0?Nt:Dt,pn=re===0?yn:At;let Wn=!1;_e&&(Ee=Math.sqrt(Math.pow(Nt-yn,2)+Math.pow(Dt-At,2))),Zt<O?pn>O&&(Fe=he(be,Nt,Dt,yn,At,O),_e&&(be.start=Ce+Ee*Fe)):Zt>Z?pn<Z&&(Fe=he(be,Nt,Dt,yn,At,Z),_e&&(be.start=Ce+Ee*Fe)):li(be,Nt,Dt,Rn),pn<O&&Zt>=O&&(Fe=he(be,Nt,Dt,yn,At,O),Wn=!0),pn>Z&&Zt<=Z&&(Fe=he(be,Nt,Dt,yn,At,Z),Wn=!0),!me&&Wn&&(_e&&(be.end=Ce+Ee*Fe),V.push(be),be=bs(se)),_e&&(Ce+=Ee)}let Ge=se.length-3;const dt=se[Ge],mt=se[Ge+1],Vt=re===0?dt:mt;Vt>=O&&Vt<=Z&&li(be,dt,mt,se[Ge+2]),Ge=be.length-3,me&&Ge>=3&&(be[Ge]!==be[0]||be[Ge+1]!==be[1])&&li(be,be[0],be[1],be[2]),be.length&&V.push(be)}function bs(se){const V=[];return V.size=se.size,V.start=se.start,V.end=se.end,V}function qo(se,V,O,Z,re,me){for(const _e of se)Tt(_e,V,O,Z,re,me,!1)}function li(se,V,O,Z){se.push(V,O,Z)}function Ya(se,V,O,Z,re,me){const _e=(me-V)/(Z-V);return li(se,me,O+(re-O)*_e,1),_e}function Ja(se,V,O,Z,re,me){const _e=(me-O)/(re-O);return li(se,V+(Z-V)*_e,me,1),_e}function Ue(se,V){const O=[];for(let Z=0;Z<se.length;Z++){const re=se[Z],me=re.type;let _e;if(me==="Point"||me==="MultiPoint"||me==="LineString")_e=Ki(re.geometry,V);else if(me==="MultiLineString"||me==="Polygon"){_e=[];for(const be of re.geometry)_e.push(Ki(be,V))}else if(me==="MultiPolygon"){_e=[];for(const be of re.geometry){const he=[];for(const Ee of be)he.push(Ki(Ee,V));_e.push(he)}}O.push(Ti(re.id,me,_e,re.tags))}return O}function Ki(se,V){const O=[];O.size=se.size,se.start!==void 0&&(O.start=se.start,O.end=se.end);for(let Z=0;Z<se.length;Z+=3)O.push(se[Z]+V,se[Z+1],se[Z+2]);return O}function _r(se,V){if(se.transformed)return se;const O=1<<se.z,Z=se.x,re=se.y;for(const me of se.features){const _e=me.geometry,be=me.type;if(me.geometry=[],be===1)for(let he=0;he<_e.length;he+=2)me.geometry.push(Yi(_e[he],_e[he+1],V,O,Z,re));else for(let he=0;he<_e.length;he++){const Ee=[];for(let Fe=0;Fe<_e[he].length;Fe+=2)Ee.push(Yi(_e[he][Fe],_e[he][Fe+1],V,O,Z,re));me.geometry.push(Ee)}}return se.transformed=!0,se}function Yi(se,V,O,Z,re,me){return[Math.round(O*(se*Z-re)),Math.round(O*(V*Z-me))]}function Bs(se,V,O,Z,re){const me=V===re.maxZoom?0:re.tolerance/((1<<V)*re.extent),_e={features:[],numPoints:0,numSimplified:0,numFeatures:se.length,source:null,x:O,y:Z,z:V,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const be of se)He(_e,be,me,re);return _e}function He(se,V,O,Z){const re=V.geometry,me=V.type,_e=[];if(se.minX=Math.min(se.minX,V.minX),se.minY=Math.min(se.minY,V.minY),se.maxX=Math.max(se.maxX,V.maxX),se.maxY=Math.max(se.maxY,V.maxY),me==="Point"||me==="MultiPoint")for(let be=0;be<re.length;be+=3)_e.push(re[be],re[be+1]),se.numPoints++,se.numSimplified++;else if(me==="LineString")Mt(_e,re,se,O,!1,!1);else if(me==="MultiLineString"||me==="Polygon")for(let be=0;be<re.length;be++)Mt(_e,re[be],se,O,me==="Polygon",be===0);else if(me==="MultiPolygon")for(let be=0;be<re.length;be++){const he=re[be];for(let Ee=0;Ee<he.length;Ee++)Mt(_e,he[Ee],se,O,!0,Ee===0)}if(_e.length){let be=V.tags||null;if(me==="LineString"&&Z.lineMetrics){be={};for(const Ee in V.tags)be[Ee]=V.tags[Ee];be.mapbox_clip_start=re.start/re.size,be.mapbox_clip_end=re.end/re.size}const he={geometry:_e,type:me==="Polygon"||me==="MultiPolygon"?3:me==="LineString"||me==="MultiLineString"?2:1,tags:be};V.id!==null&&(he.id=V.id),se.features.push(he)}}function Mt(se,V,O,Z,re,me){const _e=Z*Z;if(Z>0&&V.size<(re?_e:Z))return void(O.numPoints+=V.length/3);const be=[];for(let he=0;he<V.length;he+=3)(Z===0||V[he+2]>_e)&&(O.numSimplified++,be.push(V[he],V[he+1])),O.numPoints++;re&&function(he,Ee){let Fe=0;for(let Ce=0,Ge=he.length,dt=Ge-2;Ce<Ge;dt=Ce,Ce+=2)Fe+=(he[Ce]-he[dt])*(he[Ce+1]+he[dt+1]);if(Fe>0===Ee)for(let Ce=0,Ge=he.length;Ce<Ge/2;Ce+=2){const dt=he[Ce],mt=he[Ce+1];he[Ce]=he[Ge-2-Ce],he[Ce+1]=he[Ge-1-Ce],he[Ge-2-Ce]=dt,he[Ge-1-Ce]=mt}}(be,me),se.push(be)}const vt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ir{constructor(V,O){const Z=(O=this.options=function(me,_e){for(const be in _e)me[be]=_e[be];return me}(Object.create(vt),O)).debug;if(Z&&console.time("preprocess data"),O.maxZoom<0||O.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(O.promoteId&&O.generateId)throw new Error("promoteId and generateId cannot be used together.");let re=function(me,_e){const be=[];if(me.type==="FeatureCollection")for(let he=0;he<me.features.length;he++)oi(be,me.features[he],_e,he);else oi(be,me.type==="Feature"?me:{geometry:me},_e);return be}(V,O);this.tiles={},this.tileCoords=[],Z&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",O.indexMaxZoom,O.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),re=function(me,_e){const be=_e.buffer/_e.extent;let he=me;const Ee=ln(me,1,-1-be,be,0,-1,2,_e),Fe=ln(me,1,1-be,2+be,0,-1,2,_e);return(Ee||Fe)&&(he=ln(me,1,-be,1+be,0,-1,2,_e)||[],Ee&&(he=Ue(Ee,1).concat(he)),Fe&&(he=he.concat(Ue(Fe,-1)))),he}(re,O),re.length&&this.splitTile(re,0,0,0),Z&&(re.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(V,O,Z,re,me,_e,be){const he=[V,O,Z,re],Ee=this.options,Fe=Ee.debug;for(;he.length;){re=he.pop(),Z=he.pop(),O=he.pop(),V=he.pop();const Ce=1<<O,Ge=ki(O,Z,re);let dt=this.tiles[Ge];if(!dt&&(Fe>1&&console.time("creation"),dt=this.tiles[Ge]=Bs(V,O,Z,re,Ee),this.tileCoords.push({z:O,x:Z,y:re}),Fe)){Fe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",O,Z,re,dt.numFeatures,dt.numPoints,dt.numSimplified),console.timeEnd("creation"));const Wn=`z${O}`;this.stats[Wn]=(this.stats[Wn]||0)+1,this.total++}if(dt.source=V,me==null){if(O===Ee.indexMaxZoom||dt.numPoints<=Ee.indexMaxPoints)continue}else{if(O===Ee.maxZoom||O===me)continue;if(me!=null){const Wn=me-O;if(Z!==_e>>Wn||re!==be>>Wn)continue}}if(dt.source=null,V.length===0)continue;Fe>1&&console.time("clipping");const mt=.5*Ee.buffer/Ee.extent,Vt=.5-mt,kt=.5+mt,Nt=1+mt;let Dt=null,Rn=null,yn=null,At=null,Zt=ln(V,Ce,Z-mt,Z+kt,0,dt.minX,dt.maxX,Ee),pn=ln(V,Ce,Z+Vt,Z+Nt,0,dt.minX,dt.maxX,Ee);V=null,Zt&&(Dt=ln(Zt,Ce,re-mt,re+kt,1,dt.minY,dt.maxY,Ee),Rn=ln(Zt,Ce,re+Vt,re+Nt,1,dt.minY,dt.maxY,Ee),Zt=null),pn&&(yn=ln(pn,Ce,re-mt,re+kt,1,dt.minY,dt.maxY,Ee),At=ln(pn,Ce,re+Vt,re+Nt,1,dt.minY,dt.maxY,Ee),pn=null),Fe>1&&console.timeEnd("clipping"),he.push(Dt||[],O+1,2*Z,2*re),he.push(Rn||[],O+1,2*Z,2*re+1),he.push(yn||[],O+1,2*Z+1,2*re),he.push(At||[],O+1,2*Z+1,2*re+1)}}getTile(V,O,Z){V=+V,O=+O,Z=+Z;const re=this.options,{extent:me,debug:_e}=re;if(V<0||V>24)return null;const be=1<<V,he=ki(V,O=O+be&be-1,Z);if(this.tiles[he])return _r(this.tiles[he],me);_e>1&&console.log("drilling down to z%d-%d-%d",V,O,Z);let Ee,Fe=V,Ce=O,Ge=Z;for(;!Ee&&Fe>0;)Fe--,Ce>>=1,Ge>>=1,Ee=this.tiles[ki(Fe,Ce,Ge)];return Ee&&Ee.source?(_e>1&&(console.log("found parent tile z%d-%d-%d",Fe,Ce,Ge),console.time("drilling down")),this.splitTile(Ee.source,Fe,Ce,Ge,V,O,Z),_e>1&&console.timeEnd("drilling down"),this.tiles[he]?_r(this.tiles[he],me):null):null}}function ki(se,V,O){return 32*((1<<se)*O+V)+se}function Ct(se,V){return V?se.properties[V]:se.id}function Ji(se,V){if(se==null)return!0;if(se.type==="Feature")return Ct(se,V)!=null;if(se.type==="FeatureCollection"){const O=new Set;for(const Z of se.features){const re=Ct(Z,V);if(re==null||O.has(re))return!1;O.add(re)}return!0}return!1}function ws(se,V){const O=new Map;if(se!=null)if(se.type==="Feature")O.set(Ct(se,V),se);else for(const Z of se.features)O.set(Ct(Z,V),Z);return O}class Os extends z{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(V,O){return f._(this,void 0,void 0,function*(){const Z=V.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const re=this._geoJSONIndex.getTile(Z.z,Z.x,Z.y);if(!re)return null;const me=new class{constructor(be){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f.X,this.length=be.length,this._features=be}feature(be){return new class{constructor(he){this._feature=he,this.extent=f.X,this.type=he.type,this.properties=he.tags,"id"in he&&!isNaN(he.id)&&(this.id=parseInt(he.id,10))}loadGeometry(){if(this._feature.type===1){const he=[];for(const Ee of this._feature.geometry)he.push([new f.P(Ee[0],Ee[1])]);return he}{const he=[];for(const Ee of this._feature.geometry){const Fe=[];for(const Ce of Ee)Fe.push(new f.P(Ce[0],Ce[1]));he.push(Fe)}return he}}toGeoJSON(he,Ee,Fe){return ce.call(this,he,Ee,Fe)}}(this._features[be])}}(re.features);let _e=_t(me);return _e.byteOffset===0&&_e.byteLength===_e.buffer.byteLength||(_e=new Uint8Array(_e)),{vectorTile:me,rawData:_e.buffer}})}loadData(V){return f._(this,void 0,void 0,function*(){var O;(O=this._pendingRequest)===null||O===void 0||O.abort();const Z=!!(V&&V.request&&V.request.collectResourceTiming)&&new f.bv(V.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(V,this._pendingRequest),this._geoJSONIndex=V.cluster?new Gn(function({superclusterOptions:_e,clusterProperties:be}){if(!be||!_e)return _e;const he={},Ee={},Fe={accumulated:null,zoom:0},Ce={properties:null},Ge=Object.keys(be);for(const dt of Ge){const[mt,Vt]=be[dt],kt=f.bC(Vt),Nt=f.bC(typeof mt=="string"?[mt,["accumulated"],["get",dt]]:mt);he[dt]=kt.value,Ee[dt]=Nt.value}return _e.map=dt=>{Ce.properties=dt;const mt={};for(const Vt of Ge)mt[Vt]=he[Vt].evaluate(Fe,Ce);return mt},_e.reduce=(dt,mt)=>{Ce.properties=mt;for(const Vt of Ge)Fe.accumulated=dt[Vt],dt[Vt]=Ee[Vt].evaluate(Fe,Ce)},_e}(V)).load((yield this._pendingData).features):(re=yield this._pendingData,new Ir(re,V.geojsonVtOptions)),this.loaded={};const me={};if(Z){const _e=Z.finish();_e&&(me.resourceTiming={},me.resourceTiming[V.source]=JSON.parse(JSON.stringify(_e)))}return me}catch(me){if(delete this._pendingRequest,f.bB(me))return{abandoned:!0};throw me}var re})}getData(){return f._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(V){const O=this.loaded;return O&&O[V.uid]?super.reloadTile(V):this.loadTile(V)}loadAndProcessGeoJSON(V,O){return f._(this,void 0,void 0,function*(){let Z=yield this.loadGeoJSON(V,O);if(delete this._pendingRequest,typeof Z!="object")throw new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`);if(Q(Z,!0),V.filter){const re=f.bC(V.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(re.result==="error")throw new Error(re.value.map(_e=>`${_e.key}: ${_e.message}`).join(", "));Z={type:"FeatureCollection",features:Z.features.filter(_e=>re.value.evaluate({zoom:0},_e))}}return Z})}loadGeoJSON(V,O){return f._(this,void 0,void 0,function*(){const{promoteId:Z}=V;if(V.request){const re=yield f.h(V.request,O);return this._dataUpdateable=Ji(re.data,Z)?ws(re.data,Z):void 0,re.data}if(typeof V.data=="string")try{const re=JSON.parse(V.data);return this._dataUpdateable=Ji(re,Z)?ws(re,Z):void 0,re}catch{throw new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`)}if(!V.dataDiff)throw new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${V.source}`);return function(re,me,_e){var be,he,Ee,Fe;if(me.removeAll&&re.clear(),me.remove)for(const Ce of me.remove)re.delete(Ce);if(me.add)for(const Ce of me.add){const Ge=Ct(Ce,_e);Ge!=null&&re.set(Ge,Ce)}if(me.update)for(const Ce of me.update){let Ge=re.get(Ce.id);if(Ge==null)continue;const dt=!Ce.removeAllProperties&&(((be=Ce.removeProperties)===null||be===void 0?void 0:be.length)>0||((he=Ce.addOrUpdateProperties)===null||he===void 0?void 0:he.length)>0);if((Ce.newGeometry||Ce.removeAllProperties||dt)&&(Ge=Object.assign({},Ge),re.set(Ce.id,Ge),dt&&(Ge.properties=Object.assign({},Ge.properties))),Ce.newGeometry&&(Ge.geometry=Ce.newGeometry),Ce.removeAllProperties)Ge.properties={};else if(((Ee=Ce.removeProperties)===null||Ee===void 0?void 0:Ee.length)>0)for(const mt of Ce.removeProperties)Object.prototype.hasOwnProperty.call(Ge.properties,mt)&&delete Ge.properties[mt];if(((Fe=Ce.addOrUpdateProperties)===null||Fe===void 0?void 0:Fe.length)>0)for(const{key:mt,value:Vt}of Ce.addOrUpdateProperties)Ge.properties[mt]=Vt}}(this._dataUpdateable,V.dataDiff,Z),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(V){return f._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(V){return this._geoJSONIndex.getClusterExpansionZoom(V.clusterId)}getClusterChildren(V){return this._geoJSONIndex.getChildren(V.clusterId)}getClusterLeaves(V){return this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset)}}class Qi{constructor(V){this.self=V,this.actor=new f.F(V),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(O,Z)=>{if(this.externalWorkerSourceTypes[O])throw new Error(`Worker source with name "${O}" already registered.`);this.externalWorkerSourceTypes[O]=Z},this.self.addProtocol=f.bi,this.self.removeProtocol=f.bj,this.self.registerRTLTextPlugin=O=>{if(f.bD.isParsed())throw new Error("RTL text plugin already registered.");f.bD.setMethods(O)},this.actor.registerMessageHandler("LDT",(O,Z)=>this._getDEMWorkerSource(O,Z.source).loadTile(Z)),this.actor.registerMessageHandler("RDT",(O,Z)=>f._(this,void 0,void 0,function*(){this._getDEMWorkerSource(O,Z.source).removeTile(Z)})),this.actor.registerMessageHandler("GCEZ",(O,Z)=>f._(this,void 0,void 0,function*(){return this._getWorkerSource(O,Z.type,Z.source).getClusterExpansionZoom(Z)})),this.actor.registerMessageHandler("GCC",(O,Z)=>f._(this,void 0,void 0,function*(){return this._getWorkerSource(O,Z.type,Z.source).getClusterChildren(Z)})),this.actor.registerMessageHandler("GCL",(O,Z)=>f._(this,void 0,void 0,function*(){return this._getWorkerSource(O,Z.type,Z.source).getClusterLeaves(Z)})),this.actor.registerMessageHandler("LD",(O,Z)=>this._getWorkerSource(O,Z.type,Z.source).loadData(Z)),this.actor.registerMessageHandler("GD",(O,Z)=>this._getWorkerSource(O,Z.type,Z.source).getData()),this.actor.registerMessageHandler("LT",(O,Z)=>this._getWorkerSource(O,Z.type,Z.source).loadTile(Z)),this.actor.registerMessageHandler("RT",(O,Z)=>this._getWorkerSource(O,Z.type,Z.source).reloadTile(Z)),this.actor.registerMessageHandler("AT",(O,Z)=>this._getWorkerSource(O,Z.type,Z.source).abortTile(Z)),this.actor.registerMessageHandler("RMT",(O,Z)=>this._getWorkerSource(O,Z.type,Z.source).removeTile(Z)),this.actor.registerMessageHandler("RS",(O,Z)=>f._(this,void 0,void 0,function*(){if(!this.workerSources[O]||!this.workerSources[O][Z.type]||!this.workerSources[O][Z.type][Z.source])return;const re=this.workerSources[O][Z.type][Z.source];delete this.workerSources[O][Z.type][Z.source],re.removeSource!==void 0&&re.removeSource(Z)})),this.actor.registerMessageHandler("RM",O=>f._(this,void 0,void 0,function*(){delete this.layerIndexes[O],delete this.availableImages[O],delete this.workerSources[O],delete this.demWorkerSources[O]})),this.actor.registerMessageHandler("SR",(O,Z)=>f._(this,void 0,void 0,function*(){this.referrer=Z})),this.actor.registerMessageHandler("SRPS",(O,Z)=>this._syncRTLPluginState(O,Z)),this.actor.registerMessageHandler("IS",(O,Z)=>f._(this,void 0,void 0,function*(){this.self.importScripts(Z)})),this.actor.registerMessageHandler("SI",(O,Z)=>this._setImages(O,Z)),this.actor.registerMessageHandler("UL",(O,Z)=>f._(this,void 0,void 0,function*(){this._getLayerIndex(O).update(Z.layers,Z.removedIds)})),this.actor.registerMessageHandler("SL",(O,Z)=>f._(this,void 0,void 0,function*(){this._getLayerIndex(O).replace(Z)}))}_setImages(V,O){return f._(this,void 0,void 0,function*(){this.availableImages[V]=O;for(const Z in this.workerSources[V]){const re=this.workerSources[V][Z];for(const me in re)re[me].availableImages=O}})}_syncRTLPluginState(V,O){return f._(this,void 0,void 0,function*(){if(f.bD.isParsed())return f.bD.getState();if(O.pluginStatus!=="loading")return f.bD.setState(O),O;const Z=O.pluginURL;if(this.self.importScripts(Z),f.bD.isParsed()){const re={pluginStatus:"loaded",pluginURL:Z};return f.bD.setState(re),re}throw f.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${Z}`)})}_getAvailableImages(V){let O=this.availableImages[V];return O||(O=[]),O}_getLayerIndex(V){let O=this.layerIndexes[V];return O||(O=this.layerIndexes[V]=new u),O}_getWorkerSource(V,O,Z){if(this.workerSources[V]||(this.workerSources[V]={}),this.workerSources[V][O]||(this.workerSources[V][O]={}),!this.workerSources[V][O][Z]){const re={sendAsync:(me,_e)=>(me.targetMapId=V,this.actor.sendAsync(me,_e))};switch(O){case"vector":this.workerSources[V][O][Z]=new z(re,this._getLayerIndex(V),this._getAvailableImages(V));break;case"geojson":this.workerSources[V][O][Z]=new Os(re,this._getLayerIndex(V),this._getAvailableImages(V));break;default:this.workerSources[V][O][Z]=new this.externalWorkerSourceTypes[O](re,this._getLayerIndex(V),this._getAvailableImages(V))}}return this.workerSources[V][O][Z]}_getDEMWorkerSource(V,O){return this.demWorkerSources[V]||(this.demWorkerSources[V]={}),this.demWorkerSources[V][O]||(this.demWorkerSources[V][O]=new I),this.demWorkerSources[V][O]}}return f.i(self)&&(self.worker=new Qi(self)),Qi}),h("index",["exports","./shared"],function(f,u){var T="4.7.1";let E,D;const z={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:_=>new Promise((n,l)=>{const d=requestAnimationFrame(n);_.signal.addEventListener("abort",()=>{cancelAnimationFrame(d),l(u.c())})}),getImageData(_,n=0){return this.getImageCanvasContext(_).getImageData(-n,-n,_.width+2*n,_.height+2*n)},getImageCanvasContext(_){const n=window.document.createElement("canvas"),l=n.getContext("2d",{willReadFrequently:!0});if(!l)throw new Error("failed to create canvas 2d context");return n.width=_.width,n.height=_.height,l.drawImage(_,0,0,_.width,_.height),l},resolveURL:_=>(E||(E=document.createElement("a")),E.href=_,E.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(D==null&&(D=matchMedia("(prefers-reduced-motion: reduce)")),D.matches)}};class I{static testProp(n){if(!I.docStyle)return n[0];for(let l=0;l<n.length;l++)if(n[l]in I.docStyle)return n[l];return n[0]}static create(n,l,d){const m=window.document.createElement(n);return l!==void 0&&(m.className=l),d&&d.appendChild(m),m}static createNS(n,l){return window.document.createElementNS(n,l)}static disableDrag(){I.docStyle&&I.selectProp&&(I.userSelect=I.docStyle[I.selectProp],I.docStyle[I.selectProp]="none")}static enableDrag(){I.docStyle&&I.selectProp&&(I.docStyle[I.selectProp]=I.userSelect)}static setTransform(n,l){n.style[I.transformProp]=l}static addEventListener(n,l,d,m={}){n.addEventListener(l,d,"passive"in m?m:m.capture)}static removeEventListener(n,l,d,m={}){n.removeEventListener(l,d,"passive"in m?m:m.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",I.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",I.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",I.suppressClickInternal,!0)},0)}static getScale(n){const l=n.getBoundingClientRect();return{x:l.width/n.offsetWidth||1,y:l.height/n.offsetHeight||1,boundingClientRect:l}}static getPoint(n,l,d){const m=l.boundingClientRect;return new u.P((d.clientX-m.left)/l.x-n.clientLeft,(d.clientY-m.top)/l.y-n.clientTop)}static mousePos(n,l){const d=I.getScale(n);return I.getPoint(n,d,l)}static touchPos(n,l){const d=[],m=I.getScale(n);for(let y=0;y<l.length;y++)d.push(I.getPoint(n,m,l[y]));return d}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}}I.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,I.selectProp=I.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),I.transformProp=I.testProp(["transform","WebkitTransform"]);const G={supported:!1,testSupport:function(_){!ce&&Q&&(j?U(_):K=_)}};let K,Q,ce=!1,j=!1;function U(_){const n=_.createTexture();_.bindTexture(_.TEXTURE_2D,n);try{if(_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,Q),_.isContextLost())return;G.supported=!0}catch{}_.deleteTexture(n),ce=!0}var X;typeof document<"u"&&(Q=document.createElement("img"),Q.onload=()=>{K&&U(K),K=null,j=!0},Q.onerror=()=>{ce=!0,K=null},Q.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(_){let n,l,d,m;_.resetRequestQueue=()=>{n=[],l=0,d=0,m={}},_.addThrottleControl=k=>{const A=d++;return m[A]=k,A},_.removeThrottleControl=k=>{delete m[k],w()},_.getImage=(k,A,L=!0)=>new Promise((F,$)=>{G.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*"),u.e(k,{type:"image"}),n.push({abortController:A,requestParameters:k,supportImageRefresh:L,state:"queued",onError:H=>{$(H)},onSuccess:H=>{F(H)}}),w()});const y=k=>u._(this,void 0,void 0,function*(){k.state="running";const{requestParameters:A,supportImageRefresh:L,onError:F,onSuccess:$,abortController:H}=k,Y=L===!1&&!u.i(self)&&!u.g(A.url)&&(!A.headers||Object.keys(A.headers).reduce((ue,de)=>ue&&de==="accept",!0));l++;const ie=Y?C(A,H):u.m(A,H);try{const ue=yield ie;delete k.abortController,k.state="completed",ue.data instanceof HTMLImageElement||u.b(ue.data)?$(ue):ue.data&&$({data:yield(ae=ue.data,typeof createImageBitmap=="function"?u.d(ae):u.f(ae)),cacheControl:ue.cacheControl,expires:ue.expires})}catch(ue){delete k.abortController,F(ue)}finally{l--,w()}var ae}),w=()=>{const k=(()=>{for(const A of Object.keys(m))if(m[A]())return!0;return!1})()?u.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let A=l;A<k&&n.length>0;A++){const L=n.shift();L.abortController.signal.aborted?A--:y(L)}},C=(k,A)=>new Promise((L,F)=>{const $=new Image,H=k.url,Y=k.credentials;Y&&Y==="include"?$.crossOrigin="use-credentials":(Y&&Y==="same-origin"||!u.s(H))&&($.crossOrigin="anonymous"),A.signal.addEventListener("abort",()=>{$.src="",F(u.c())}),$.fetchPriority="high",$.onload=()=>{$.onerror=$.onload=null,L({data:$})},$.onerror=()=>{$.onerror=$.onload=null,A.signal.aborted||F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},$.src=H})}(X||(X={})),X.resetRequestQueue();class ne{constructor(n){this._transformRequestFn=n}transformRequest(n,l){return this._transformRequestFn&&this._transformRequestFn(n,l)||{url:n}}setTransformRequest(n){this._transformRequestFn=n}}function ge(_){var n=new u.A(3);return n[0]=_[0],n[1]=_[1],n[2]=_[2],n}var fe,we=function(_,n,l){return _[0]=n[0]-l[0],_[1]=n[1]-l[1],_[2]=n[2]-l[2],_};fe=new u.A(3),u.A!=Float32Array&&(fe[0]=0,fe[1]=0,fe[2]=0);var Ie=function(_){var n=_[0],l=_[1];return n*n+l*l};function Ne(_){const n=[];if(typeof _=="string")n.push({id:"default",url:_});else if(_&&_.length>0){const l=[];for(const{id:d,url:m}of _){const y=`${d}${m}`;l.indexOf(y)===-1&&(l.push(y),n.push({id:d,url:m}))}}return n}function $e(_,n,l){const d=_.split("?");return d[0]+=`${n}${l}`,d.join("?")}(function(){var _=new u.A(2);u.A!=Float32Array&&(_[0]=0,_[1]=0)})();class Ve{constructor(n,l,d,m){this.context=n,this.format=d,this.texture=n.gl.createTexture(),this.update(l,m)}update(n,l,d){const{width:m,height:y}=n,w=!(this.size&&this.size[0]===m&&this.size[1]===y||d),{context:C}=this,{gl:k}=C;if(this.useMipmap=!!(l&&l.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!l||l.premultiply!==!1)),w)this.size=[m,y],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||u.b(n)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,n):k.texImage2D(k.TEXTURE_2D,0,this.format,m,y,0,this.format,k.UNSIGNED_BYTE,n.data);else{const{x:A,y:L}=d||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||u.b(n)?k.texSubImage2D(k.TEXTURE_2D,0,A,L,k.RGBA,k.UNSIGNED_BYTE,n):k.texSubImage2D(k.TEXTURE_2D,0,A,L,m,y,k.RGBA,k.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(n,l,d){const{context:m}=this,{gl:y}=m;y.bindTexture(y.TEXTURE_2D,this.texture),d!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=y.LINEAR),n!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,n),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,d||n),this.filter=n),l!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,l),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}function J(_){const{userImage:n}=_;return!!(n&&n.render&&n.render())&&(_.data.replace(new Uint8Array(n.data.buffer)),!0)}class ze extends u.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:l,promiseResolve:d}of this.requestors)d(this._getImagesForIds(l));this.requestors=[]}}getImage(n){const l=this.images[n];if(l&&!l.data&&l.spriteData){const d=l.spriteData;l.data=new u.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),l.spriteData=null}return l}addImage(n,l){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,l)&&(this.images[n]=l)}_validate(n,l){let d=!0;const m=l.data||l.spriteData;return this._validateStretch(l.stretchX,m&&m.width)||(this.fire(new u.j(new Error(`Image "${n}" has invalid "stretchX" value`))),d=!1),this._validateStretch(l.stretchY,m&&m.height)||(this.fire(new u.j(new Error(`Image "${n}" has invalid "stretchY" value`))),d=!1),this._validateContent(l.content,l)||(this.fire(new u.j(new Error(`Image "${n}" has invalid "content" value`))),d=!1),d}_validateStretch(n,l){if(!n)return!0;let d=0;for(const m of n){if(m[0]<d||m[1]<m[0]||l<m[1])return!1;d=m[1]}return!0}_validateContent(n,l){if(!n)return!0;if(n.length!==4)return!1;const d=l.spriteData,m=d&&d.width||l.data.width,y=d&&d.height||l.data.height;return!(n[0]<0||m<n[0]||n[1]<0||y<n[1]||n[2]<0||m<n[2]||n[3]<0||y<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,l,d=!0){const m=this.getImage(n);if(d&&(m.data.width!==l.data.width||m.data.height!==l.data.height))throw new Error(`size mismatch between old image (${m.data.width}x${m.data.height}) and new image (${l.data.width}x${l.data.height}).`);l.version=m.version+1,this.images[n]=l,this.updatedImages[n]=!0}removeImage(n){const l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise((l,d)=>{let m=!0;if(!this.isLoaded())for(const y of n)this.images[y]||(m=!1);this.isLoaded()||m?l(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:l})})}_getImagesForIds(n){const l={};for(const d of n){let m=this.getImage(d);m||(this.fire(new u.k("styleimagemissing",{id:d})),m=this.getImage(d)),m?l[d]={data:m.data.clone(),pixelRatio:m.pixelRatio,sdf:m.sdf,version:m.version,stretchX:m.stretchX,stretchY:m.stretchY,content:m.content,textFitWidth:m.textFitWidth,textFitHeight:m.textFitHeight,hasRenderCallback:!!(m.userImage&&m.userImage.render)}:u.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return l}getPixelSize(){const{width:n,height:l}=this.atlasImage;return{width:n,height:l}}getPattern(n){const l=this.patterns[n],d=this.getImage(n);if(!d)return null;if(l&&l.position.version===d.version)return l.position;if(l)l.position.version=d.version;else{const m={w:d.data.width+2,h:d.data.height+2,x:0,y:0},y=new u.I(m,d);this.patterns[n]={bin:m,position:y}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ve(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const y in this.patterns)n.push(this.patterns[y].bin);const{w:l,h:d}=u.p(n),m=this.atlasImage;m.resize({width:l||1,height:d||1});for(const y in this.patterns){const{bin:w}=this.patterns[y],C=w.x+1,k=w.y+1,A=this.getImage(y).data,L=A.width,F=A.height;u.R.copy(A,m,{x:0,y:0},{x:C,y:k},{width:L,height:F}),u.R.copy(A,m,{x:0,y:F-1},{x:C,y:k-1},{width:L,height:1}),u.R.copy(A,m,{x:0,y:0},{x:C,y:k+F},{width:L,height:1}),u.R.copy(A,m,{x:L-1,y:0},{x:C-1,y:k},{width:1,height:F}),u.R.copy(A,m,{x:0,y:0},{x:C+L,y:k},{width:1,height:F})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const l of n){if(this.callbackDispatchedThisFrame[l])continue;this.callbackDispatchedThisFrame[l]=!0;const d=this.getImage(l);d||u.w(`Image with ID: "${l}" was not found`),J(d)&&this.updateImage(l,d)}}}const Le=1e20;function ot(_,n,l,d,m,y,w,C,k){for(let A=n;A<n+d;A++)xt(_,l*y+A,y,m,w,C,k);for(let A=l;A<l+m;A++)xt(_,A*y+n,1,d,w,C,k)}function xt(_,n,l,d,m,y,w){y[0]=0,w[0]=-Le,w[1]=Le,m[0]=_[n];for(let C=1,k=0,A=0;C<d;C++){m[C]=_[n+C*l];const L=C*C;do{const F=y[k];A=(m[C]-m[F]+L-F*F)/(C-F)/2}while(A<=w[k]&&--k>-1);k++,y[k]=C,w[k]=A,w[k+1]=Le}for(let C=0,k=0;C<d;C++){for(;w[k+1]<C;)k++;const A=y[k],L=C-A;_[n+C*l]=m[A]+L*L}}class _t{constructor(n,l){this.requestManager=n,this.localIdeographFontFamily=l,this.entries={}}setURL(n){this.url=n}getGlyphs(n){return u._(this,void 0,void 0,function*(){const l=[];for(const y in n)for(const w of n[y])l.push(this._getAndCacheGlyphsPromise(y,w));const d=yield Promise.all(l),m={};for(const{stack:y,id:w,glyph:C}of d)m[y]||(m[y]={}),m[y][w]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics};return m})}_getAndCacheGlyphsPromise(n,l){return u._(this,void 0,void 0,function*(){let d=this.entries[n];d||(d=this.entries[n]={glyphs:{},requests:{},ranges:{}});let m=d.glyphs[l];if(m!==void 0)return{stack:n,id:l,glyph:m};if(m=this._tinySDF(d,n,l),m)return d.glyphs[l]=m,{stack:n,id:l,glyph:m};const y=Math.floor(l/256);if(256*y>65535)throw new Error("glyphs > 65535 not supported");if(d.ranges[y])return{stack:n,id:l,glyph:m};if(!this.url)throw new Error("glyphsUrl is not set");if(!d.requests[y]){const C=_t.loadGlyphRange(n,y,this.url,this.requestManager);d.requests[y]=C}const w=yield d.requests[y];for(const C in w)this._doesCharSupportLocalGlyph(+C)||(d.glyphs[+C]=w[+C]);return d.ranges[y]=!0,{stack:n,id:l,glyph:w[l]||null}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(n))}_tinySDF(n,l,d){const m=this.localIdeographFontFamily;if(!m||!this._doesCharSupportLocalGlyph(d))return;let y=n.tinySDF;if(!y){let C="400";/bold/i.test(l)?C="900":/medium/i.test(l)?C="500":/light/i.test(l)&&(C="200"),y=n.tinySDF=new _t.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:m,fontWeight:C})}const w=y.draw(String.fromCharCode(d));return{id:d,bitmap:new u.o({width:w.width||60,height:w.height||60},w.data),metrics:{width:w.glyphWidth/2||24,height:w.glyphHeight/2||24,left:w.glyphLeft/2+.5||0,top:w.glyphTop/2-27.5||-8,advance:w.glyphAdvance/2||24,isDoubleResolution:!0}}}}_t.loadGlyphRange=function(_,n,l,d){return u._(this,void 0,void 0,function*(){const m=256*n,y=m+255,w=d.transformRequest(l.replace("{fontstack}",_).replace("{range}",`${m}-${y}`),"Glyphs"),C=yield u.l(w,new AbortController);if(!C||!C.data)throw new Error(`Could not load glyph range. range: ${n}, ${m}-${y}`);const k={};for(const A of u.n(C.data))k[A.id]=A;return k})},_t.TinySDF=class{constructor({fontSize:_=24,buffer:n=3,radius:l=8,cutoff:d=.25,fontFamily:m="sans-serif",fontWeight:y="normal",fontStyle:w="normal"}={}){this.buffer=n,this.cutoff=d,this.radius=l;const C=this.size=_+4*n,k=this._createCanvas(C),A=this.ctx=k.getContext("2d",{willReadFrequently:!0});A.font=`${w} ${y} ${_}px ${m}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(_){const n=document.createElement("canvas");return n.width=n.height=_,n}draw(_){const{width:n,actualBoundingBoxAscent:l,actualBoundingBoxDescent:d,actualBoundingBoxLeft:m,actualBoundingBoxRight:y}=this.ctx.measureText(_),w=Math.ceil(l),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-m))),k=Math.min(this.size-this.buffer,w+Math.ceil(d)),A=C+2*this.buffer,L=k+2*this.buffer,F=Math.max(A*L,0),$=new Uint8ClampedArray(F),H={data:$,width:A,height:L,glyphWidth:C,glyphHeight:k,glyphTop:w,glyphLeft:0,glyphAdvance:n};if(C===0||k===0)return H;const{ctx:Y,buffer:ie,gridInner:ae,gridOuter:ue}=this;Y.clearRect(ie,ie,C,k),Y.fillText(_,ie,ie+w);const de=Y.getImageData(ie,ie,C,k);ue.fill(Le,0,F),ae.fill(0,0,F);for(let ee=0;ee<k;ee++)for(let ye=0;ye<C;ye++){const ve=de.data[4*(ee*C+ye)+3]/255;if(ve===0)continue;const Te=(ee+ie)*A+ye+ie;if(ve===1)ue[Te]=0,ae[Te]=Le;else{const Re=.5-ve;ue[Te]=Re>0?Re*Re:0,ae[Te]=Re<0?Re*Re:0}}ot(ue,0,0,A,L,A,this.f,this.v,this.z),ot(ae,ie,ie,C,k,A,this.f,this.v,this.z);for(let ee=0;ee<F;ee++){const ye=Math.sqrt(ue[ee])-Math.sqrt(ae[ee]);$[ee]=Math.round(255-255*(ye/this.radius+this.cutoff))}return H}};class Oe{constructor(){this.specification=u.v.light.position}possiblyEvaluate(n,l){return u.x(n.expression.evaluate(l))}interpolate(n,l,d){return{x:u.y.number(n.x,l.x,d),y:u.y.number(n.y,l.y,d),z:u.y.number(n.z,l.z,d)}}}let et;class pt extends u.E{constructor(n){super(),et=et||new u.q({anchor:new u.D(u.v.light.anchor),position:new Oe,color:new u.D(u.v.light.color),intensity:new u.D(u.v.light.intensity)}),this._transitionable=new u.T(et),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,l={}){if(!this._validate(u.r,n,l))for(const d in n){const m=n[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),m):this._transitionable.setValue(d,m)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,d){return(!d||d.validate!==!1)&&u.t(this,n.call(u.u,{value:l,style:{glyphs:!0,sprite:!0},styleSpec:u.v}))}}const Pt=new u.q({"sky-color":new u.D(u.v.sky["sky-color"]),"horizon-color":new u.D(u.v.sky["horizon-color"]),"fog-color":new u.D(u.v.sky["fog-color"]),"fog-ground-blend":new u.D(u.v.sky["fog-ground-blend"]),"horizon-fog-blend":new u.D(u.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new u.D(u.v.sky["sky-horizon-blend"]),"atmosphere-blend":new u.D(u.v.sky["atmosphere-blend"])});class Bt extends u.E{constructor(n){super(),this._transitionable=new u.T(Pt),this.setSky(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.z(0))}setSky(n,l={}){if(!this._validate(u.B,n,l)){n||(n={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const d in n){const m=n[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),m):this._transitionable.setValue(d,m)}}}getSky(){return this._transitionable.serialize()}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,d={}){return(d==null?void 0:d.validate)!==!1&&u.t(this,n.call(u.u,u.e({value:l,style:{glyphs:!0,sprite:!0},styleSpec:u.v})))}calculateFogBlendOpacity(n){return n<60?0:n<70?(n-60)/10:1}}class Gr{constructor(n,l){this.width=n,this.height=l,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,l){const d=n.join(",")+String(l);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(n,l)),this.dashEntry[d]}getDashRanges(n,l,d){const m=[];let y=n.length%2==1?-n[n.length-1]*d:0,w=n[0]*d,C=!0;m.push({left:y,right:w,isDash:C,zeroLength:n[0]===0});let k=n[0];for(let A=1;A<n.length;A++){C=!C;const L=n[A];y=k*d,k+=L,w=k*d,m.push({left:y,right:w,isDash:C,zeroLength:L===0})}return m}addRoundDash(n,l,d){const m=l/2;for(let y=-d;y<=d;y++){const w=this.width*(this.nextRow+d+y);let C=0,k=n[C];for(let A=0;A<this.width;A++){A/k.right>1&&(k=n[++C]);const L=Math.abs(A-k.left),F=Math.abs(A-k.right),$=Math.min(L,F);let H;const Y=y/d*(m+1);if(k.isDash){const ie=m-Math.abs(Y);H=Math.sqrt($*$+ie*ie)}else H=m-Math.sqrt($*$+Y*Y);this.data[w+A]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(n){for(let C=n.length-1;C>=0;--C){const k=n[C],A=n[C+1];k.zeroLength?n.splice(C,1):A&&A.isDash===k.isDash&&(A.left=k.left,n.splice(C,1))}const l=n[0],d=n[n.length-1];l.isDash===d.isDash&&(l.left=d.left-this.width,d.right=l.right+this.width);const m=this.width*this.nextRow;let y=0,w=n[y];for(let C=0;C<this.width;C++){C/w.right>1&&(w=n[++y]);const k=Math.abs(C-w.left),A=Math.abs(C-w.right),L=Math.min(k,A);this.data[m+C]=Math.max(0,Math.min(255,(w.isDash?L:-L)+128))}}addDash(n,l){const d=l?7:0,m=2*d+1;if(this.nextRow+m>this.height)return u.w("LineAtlas out of space"),null;let y=0;for(let C=0;C<n.length;C++)y+=n[C];if(y!==0){const C=this.width/y,k=this.getDashRanges(n,this.width,C);l?this.addRoundDash(k,C,d):this.addRegularDash(k)}const w={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:y};return this.nextRow+=m,this.dirty=!0,w}bind(n){const l=n.gl;this.texture?(l.bindTexture(l.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,l.texSubImage2D(l.TEXTURE_2D,0,0,0,this.width,this.height,l.ALPHA,l.UNSIGNED_BYTE,this.data))):(this.texture=l.createTexture(),l.bindTexture(l.TEXTURE_2D,this.texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texImage2D(l.TEXTURE_2D,0,l.ALPHA,this.width,this.height,0,l.ALPHA,l.UNSIGNED_BYTE,this.data))}}const Gn="maplibre_preloaded_worker_pool";class sr{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<sr.workerCount;)this.workers.push(new Worker(u.a.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Gn]}numActive(){return Object.keys(this.active).length}}const or=Math.floor(z.hardwareConcurrency/2);let Dn,Wr;function vs(){return Dn||(Dn=new sr),Dn}sr.workerCount=u.C(globalThis)?Math.max(Math.min(or,3),1):1;class xs{constructor(n,l){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=l;const d=this.workerPool.acquire(l);for(let m=0;m<d.length;m++){const y=new u.F(d[m],l);y.name=`Worker ${m}`,this.actors.push(y)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,l){const d=[];for(const m of this.actors)d.push(m.sendAsync({type:n,data:l}));return Promise.all(d)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach(l=>{l.remove()}),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,l){for(const d of this.actors)d.registerMessageHandler(n,l)}}function ao(){return Wr||(Wr=new xs(vs(),u.G),Wr.registerMessageHandler("GR",(_,n,l)=>u.m(n,l))),Wr}function Ti(_,n){const l=u.H();return u.J(l,l,[1,1,0]),u.K(l,l,[.5*_.width,.5*_.height,1]),u.L(l,l,_.calculatePosMatrix(n.toUnwrapped()))}function Xi(_,n,l,d,m,y){const w=function(F,$,H){if(F)for(const Y of F){const ie=$[Y];if(ie&&ie.source===H&&ie.type==="fill-extrusion")return!0}else for(const Y in $){const ie=$[Y];if(ie.source===H&&ie.type==="fill-extrusion")return!0}return!1}(m&&m.layers,n,_.id),C=y.maxPitchScaleFactor(),k=_.tilesIn(d,C,w);k.sort(oi);const A=[];for(const F of k)A.push({wrappedTileID:F.tileID.wrapped().key,queryResults:F.tile.queryRenderedFeatures(n,l,_._state,F.queryGeometry,F.cameraQueryGeometry,F.scale,m,y,C,Ti(_.transform,F.tileID))});const L=function(F){const $={},H={};for(const Y of F){const ie=Y.queryResults,ae=Y.wrappedTileID,ue=H[ae]=H[ae]||{};for(const de in ie){const ee=ie[de],ye=ue[de]=ue[de]||{},ve=$[de]=$[de]||[];for(const Te of ee)ye[Te.featureIndex]||(ye[Te.featureIndex]=!0,ve.push(Te))}}return $}(A);for(const F in L)L[F].forEach($=>{const H=$.feature,Y=_.getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=Y});return L}function oi(_,n){const l=_.tileID,d=n.tileID;return l.overscaledZ-d.overscaledZ||l.canonical.y-d.canonical.y||l.wrap-d.wrap||l.canonical.x-d.canonical.x}function Fs(_,n,l){return u._(this,void 0,void 0,function*(){let d=_;if(_.url?d=(yield u.h(n.transformRequest(_.url,"Source"),l)).data:yield z.frameAsync(l),!d)return null;const m=u.M(u.e(d,_),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in d&&d.vector_layers&&(m.vectorLayerIds=d.vector_layers.map(y=>y.id)),m})}class ke{constructor(n,l){n&&(l?this.setSouthWest(n).setNorthEast(l):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof u.N?new u.N(n.lng,n.lat):u.N.convert(n),this}setSouthWest(n){return this._sw=n instanceof u.N?new u.N(n.lng,n.lat):u.N.convert(n),this}extend(n){const l=this._sw,d=this._ne;let m,y;if(n instanceof u.N)m=n,y=n;else{if(!(n instanceof ke))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(ke.convert(n)):this.extend(u.N.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(u.N.convert(n)):this;if(m=n._sw,y=n._ne,!m||!y)return this}return l||d?(l.lng=Math.min(m.lng,l.lng),l.lat=Math.min(m.lat,l.lat),d.lng=Math.max(y.lng,d.lng),d.lat=Math.max(y.lat,d.lat)):(this._sw=new u.N(m.lng,m.lat),this._ne=new u.N(y.lng,y.lat)),this}getCenter(){return new u.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.N(this.getWest(),this.getNorth())}getSouthEast(){return new u.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:l,lat:d}=u.N.convert(n);let m=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&m}static convert(n){return n instanceof ke?n:n&&new ke(n)}static fromLngLat(n,l=0){const d=360*l/40075017,m=d/Math.cos(Math.PI/180*n.lat);return new ke(new u.N(n.lng-m,n.lat-d),new u.N(n.lng+m,n.lat+d))}adjustAntiMeridian(){const n=new u.N(this._sw.lng,this._sw.lat),l=new u.N(this._ne.lng,this._ne.lat);return new ke(n,n.lng>l.lng?new u.N(l.lng+360,l.lat):l)}}class ai{constructor(n,l,d){this.bounds=ke.convert(this.validateBounds(n)),this.minzoom=l||0,this.maxzoom=d||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const l=Math.pow(2,n.z),d=Math.floor(u.O(this.bounds.getWest())*l),m=Math.floor(u.Q(this.bounds.getNorth())*l),y=Math.ceil(u.O(this.bounds.getEast())*l),w=Math.ceil(u.Q(this.bounds.getSouth())*l);return n.x>=d&&n.x<y&&n.y>=m&&n.y<w}}class Ci extends u.E{constructor(n,l,d,m){if(super(),this.id=n,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.e(this,u.M(l,["url","scheme","tileSize","promoteId"])),this._options=u.e({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(m)}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield Fs(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n&&(u.e(this,n),n.bounds&&(this.tileBounds=new ai(n.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new u.j(n))}})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return u.e({},this._options)}loadTile(n){return u._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(l,"Tile"),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};d.request.collectResourceTiming=this._collectResourceTiming;let m="RT";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise((y,w)=>{n.reloadPromise={resolve:y,reject:w}})}else n.actor=this.dispatcher.getActor(),m="LT";n.abortController=new AbortController;try{const y=yield n.actor.sendAsync({type:m,data:d},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,y)}catch(y){if(delete n.abortController,n.aborted)return;if(y&&y.status!==404)throw y;this._afterTileLoadWorkerResponse(n,null)}})}_afterTileLoadWorkerResponse(n,l){if(l&&l.resourceTiming&&(n.resourceTiming=l.resourceTiming),l&&this.map._refreshExpiredTiles&&n.setExpiryData(l),n.loadVectorData(l,this.map.painter),n.reloadPromise){const d=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(d.resolve).catch(d.reject)}}abortTile(n){return u._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"AT",data:{uid:n.uid,type:this.type,source:this.id}}))})}unloadTile(n){return u._(this,void 0,void 0,function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ot extends u.E{constructor(n,l,d,m){super(),this.id=n,this.dispatcher=d,this.setEventedParent(m),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.e({type:"raster"},l),u.e(this,u.M(l,["url","scheme","tileSize"]))}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield Fs(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(u.e(this,n),n.bounds&&(this.tileBounds=new ai(n.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new u.j(n))}})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}serialize(){return u.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return u._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{const d=yield X.getImage(this.map._requestManager.transformRequest(l,"Tile"),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(d&&d.data){this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&n.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const m=this.map.painter.context,y=m.gl,w=d.data;n.texture=this.map.painter.getTileTexture(w.width),n.texture?n.texture.update(w,{useMipmap:!0}):(n.texture=new Ve(m,w,y.RGBA,{useMipmap:!0}),n.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST)),n.state="loaded"}}catch(d){if(delete n.abortController,n.aborted)n.state="unloaded";else if(d)throw n.state="errored",d}})}abortTile(n){return u._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)})}unloadTile(n){return u._(this,void 0,void 0,function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)})}hasTransition(){return!1}}class ln extends Ot{constructor(n,l,d,m){super(n,l,d,m),this.type="raster-dem",this.maxzoom=22,this._options=u.e({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox",this.redFactor=l.redFactor,this.greenFactor=l.greenFactor,this.blueFactor=l.blueFactor,this.baseShift=l.baseShift}loadTile(n){return u._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(l,"Tile");n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{const m=yield X.getImage(d,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(m&&m.data){const y=m.data;this.map._refreshExpiredTiles&&m.cacheControl&&m.expires&&n.setExpiryData({cacheControl:m.cacheControl,expires:m.expires});const w=u.b(y)&&u.U()?y:yield this.readImageNow(y),C={type:this.type,uid:n.uid,source:this.id,rawImageData:w,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();const k=yield n.actor.sendAsync({type:"LDT",data:C});n.dem=k,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(m){if(delete n.abortController,n.aborted)n.state="unloaded";else if(m)throw n.state="errored",m}})}readImageNow(n){return u._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&u.V()){const l=n.width+2,d=n.height+2;try{return new u.R({width:l,height:d},yield u.W(n,-1,-1,l,d))}catch{}}return z.getImageData(n,1)})}_getNeighboringTiles(n){const l=n.canonical,d=Math.pow(2,l.z),m=(l.x-1+d)%d,y=l.x===0?n.wrap-1:n.wrap,w=(l.x+1+d)%d,C=l.x+1===d?n.wrap+1:n.wrap,k={};return k[new u.S(n.overscaledZ,y,l.z,m,l.y).key]={backfilled:!1},k[new u.S(n.overscaledZ,C,l.z,w,l.y).key]={backfilled:!1},l.y>0&&(k[new u.S(n.overscaledZ,y,l.z,m,l.y-1).key]={backfilled:!1},k[new u.S(n.overscaledZ,n.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},k[new u.S(n.overscaledZ,C,l.z,w,l.y-1).key]={backfilled:!1}),l.y+1<d&&(k[new u.S(n.overscaledZ,y,l.z,m,l.y+1).key]={backfilled:!1},k[new u.S(n.overscaledZ,n.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},k[new u.S(n.overscaledZ,C,l.z,w,l.y+1).key]={backfilled:!1}),k}unloadTile(n){return u._(this,void 0,void 0,function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"RDT",data:{type:this.type,uid:n.uid,source:this.id}}))})}}class lo extends u.E{constructor(n,l,d,m){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=d.getActor(),this.setEventedParent(m),this._data=l.data,this._options=u.e({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const y=u.X/this.tileSize;l.clusterMaxZoom!==void 0&&this.maxzoom<=l.clusterMaxZoom&&u.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${l.clusterMaxZoom}".`),this.workerOptions=u.e({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*y,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*y,extent:u.X,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:u.X,radius:(l.clusterRadius||50)*y,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return u._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData(),this}updateData(n){return this._updateWorkerData(n),this}getData(){return u._(this,void 0,void 0,function*(){const n=u.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:n})})}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=n.clusterRadius),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=n.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,l,d){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:n,limit:l,offset:d}})}_updateWorkerData(n){return u._(this,void 0,void 0,function*(){const l=u.e({type:this.type},this.workerOptions);n?l.dataDiff=n:typeof this._data=="string"?(l.request=this.map._requestManager.transformRequest(z.resolveURL(this._data),"Source"),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new u.k("dataloading",{dataType:"source"}));try{const d=yield this.actor.sendAsync({type:"LD",data:l});if(this._pendingLoads--,this._removed||d.abandoned)return void this.fire(new u.k("dataabort",{dataType:"source"}));let m=null;d.resourceTiming&&d.resourceTiming[this.id]&&(m=d.resourceTiming[this.id].slice(0));const y={dataType:"source"};this._collectResourceTiming&&m&&m.length>0&&u.e(y,{resourceTiming:m}),this.fire(new u.k("data",Object.assign(Object.assign({},y),{sourceDataType:"metadata"}))),this.fire(new u.k("data",Object.assign(Object.assign({},y),{sourceDataType:"content"})))}catch(d){if(this._pendingLoads--,this._removed)return void this.fire(new u.k("dataabort",{dataType:"source"}));this.fire(new u.j(d))}})}loaded(){return this._pendingLoads===0}loadTile(n){return u._(this,void 0,void 0,function*(){const l=n.actor?"RT":"LT";n.actor=this.actor;const d={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.abortController=new AbortController;const m=yield this.actor.sendAsync({type:l,data:d},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(m,this.map.painter,l==="RT")})}abortTile(n){return u._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0})}unloadTile(n){return u._(this,void 0,void 0,function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return u.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Tt=u.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class bs extends u.E{constructor(n,l,d,m){super(),this.id=n,this.dispatcher=d,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(m),this.options=l}load(n){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const l=yield X.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,l&&l.data&&(this.image=l.data,n&&(this.coordinates=n),this._finishLoading())}catch(l){this._request=null,this._loaded=!0,this.fire(new u.j(l))}})}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;const l=n.map(u.Z.fromLngLat);this.tileID=function(m){let y=1/0,w=1/0,C=-1/0,k=-1/0;for(const $ of m)y=Math.min(y,$.x),w=Math.min(w,$.y),C=Math.max(C,$.x),k=Math.max(k,$.y);const A=Math.max(C-y,k-w),L=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),F=Math.pow(2,L);return new u.a1(L,Math.floor((y+C)/2*F),Math.floor((w+k)/2*F))}(l),this.minzoom=this.maxzoom=this.tileID.z;const d=l.map(m=>this.tileID.getTilePoint(m)._round());return this._boundsArray=new u.$,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,u.X,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,u.X),this._boundsArray.emplaceBack(d[2].x,d[2].y,u.X,u.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,l=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Tt.members)),this.boundsSegments||(this.boundsSegments=u.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ve(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let d=!1;for(const m in this.tiles){const y=this.tiles[m];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,d=!0)}d&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return u._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class qo extends bs{constructor(n,l,d,m){super(n,l,d,m),this.roundZoom=!0,this.type="video",this.options=l}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1;const n=this.options;this.urls=[];for(const l of n.urls)this.urls.push(this.map._requestManager.transformRequest(l,"Source").url);try{const l=yield u.a3(this.urls);if(this._loaded=!0,!l)return;this.video=l,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(l){this.fire(new u.j(l))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const l=this.video.seekable;n<l.start(0)||n>l.end(0)?this.fire(new u.j(new u.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,l=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Tt.members)),this.boundsSegments||(this.boundsSegments=u.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new Ve(n,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let d=!1;for(const m in this.tiles){const y=this.tiles[m];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,d=!0)}d&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class li extends bs{constructor(n,l,d,m){super(n,l,d,m),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(w=>typeof w!="number"))||this.fire(new u.j(new u.a2(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.j(new u.a2(`sources.${n}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new u.j(new u.a2(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof HTMLCanvasElement||this.fire(new u.j(new u.a2(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.j(new u.a2(`sources.${n}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}load(){return u._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const l=this.map.painter.context,d=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Tt.members)),this.boundsSegments||(this.boundsSegments=u.a0.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ve(l,this.canvas,d.RGBA,{premultiply:!0});let m=!1;for(const y in this.tiles){const w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,m=!0)}m&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const Ya={},Ja=_=>{switch(_){case"geojson":return lo;case"image":return bs;case"raster":return Ot;case"raster-dem":return ln;case"vector":return Ci;case"video":return qo;case"canvas":return li}return Ya[_]},Ue="RTLPluginLoaded";class Ki extends u.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ao()}_syncState(n){return this.status=n,this.dispatcher.broadcast("SRPS",{pluginStatus:n,pluginURL:this.url}).catch(l=>{throw this.status="error",l})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return u._(this,arguments,void 0,function*(l,d=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=z.resolveURL(l),!this.url)throw new Error(`requested url ${l} is invalid`);if(this.status==="unavailable"){if(!d)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return u._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new u.k(Ue))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let _r=null;function Yi(){return _r||(_r=new Ki),_r}class Bs{constructor(n,l){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=u.a4(),this.uses=0,this.tileSize=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const l=n+this.timeAdded;l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,l,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(m,y){const w={};if(!y)return w;for(const C of m){const k=C.layerIds.map(A=>y.getLayer(A)).filter(Boolean);if(k.length!==0){C.layers=k,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(A=>k.filter(L=>L.id===A)[0]));for(const A of k)w[A.id]=C}}return w}(n.buckets,l.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const y=this.buckets[m];if(y instanceof u.a6){if(this.hasSymbolBuckets=!0,!d)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const y=this.buckets[m];if(y instanceof u.a6&&y.hasRTLText){this.hasRTLText=!0,Yi().lazyLoad();break}}this.queryPadding=0;for(const m in this.buckets){const y=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(m).queryRadius(y))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new u.a5}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const d in this.buckets){const m=this.buckets[d];m.uploadPending()&&m.upload(n)}const l=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ve(n,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ve(n,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,l,d,m,y,w,C,k,A,L){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:m,cameraQueryGeometry:y,scale:w,tileSize:this.tileSize,pixelPosMatrix:L,transform:k,params:C,queryPadding:this.queryPadding*A},n,l,d):{}}querySourceFeatures(n,l){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const m=d.loadVTLayers(),y=l&&l.sourceLayer?l.sourceLayer:"",w=m._geojsonTileLayer||m[y];if(!w)return;const C=u.a7(l&&l.filter),{z:k,x:A,y:L}=this.tileID.canonical,F={z:k,x:A,y:L};for(let $=0;$<w.length;$++){const H=w.feature($);if(C.needGeometry){const ae=u.a8(H,!0);if(!C.filter(new u.z(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!C.filter(new u.z(this.tileID.overscaledZ),H))continue;const Y=d.getId(H,y),ie=new u.a9(H,k,A,L,Y);ie.tile=F,n.push(ie)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const l=this.expirationTime;if(n.cacheControl){const d=u.aa(n.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const d=Date.now();let m=!1;if(this.expirationTime>d)m=!1;else if(l)if(this.expirationTime<l)m=!0;else{const y=this.expirationTime-l;y?this.expirationTime=d+Math.max(y,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const m in this.buckets){if(!l.style.hasLayer(m))continue;const y=this.buckets[m],w=y.layers[0].sourceLayer||"_geojsonTileLayer",C=d[w],k=n[w];if(!C||!k||Object.keys(k).length===0)continue;y.update(k,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});const A=l&&l.style&&l.style.getLayer(m);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<z.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=z.now()+n}setDependencies(n,l){const d={};for(const m of l)d[m]=!0;this.dependencies[n]=d}hasDependency(n,l){for(const d of n){const m=this.dependencies[d];if(m){for(const y of l)if(m[y])return!0}}return!1}}class He{constructor(n,l){this.max=n,this.onRemove=l,this.reset()}reset(){for(const n in this.data)for(const l of this.data[n])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(n,l,d){const m=n.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const y={value:l,timeout:void 0};if(d!==void 0&&(y.timeout=setTimeout(()=>{this.remove(n,y)},d)),this.data[m].push(y),this.order.push(m),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const l=this.data[n].shift();return l.timeout&&clearTimeout(l.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),l.value}getByKey(n){const l=this.data[n];return l?l[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,l){if(!this.has(n))return this;const d=n.wrapped().key,m=l===void 0?0:this.data[d].indexOf(l),y=this.data[d][m];return this.data[d].splice(m,1),y.timeout&&clearTimeout(y.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(y.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(n){const l=[];for(const d in this.data)for(const m of this.data[d])n(m.value)||l.push(m);for(const d of l)this.remove(d.value.tileID,d)}}class Mt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,l,d){const m=String(l);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][m]=this.stateChanges[n][m]||{},u.e(this.stateChanges[n][m],d),this.deletedStates[n]===null){this.deletedStates[n]={};for(const y in this.state[n])y!==m&&(this.deletedStates[n][y]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][m]===null){this.deletedStates[n][m]={};for(const y in this.state[n][m])d[y]||(this.deletedStates[n][m][y]=null)}else for(const y in d)this.deletedStates[n]&&this.deletedStates[n][m]&&this.deletedStates[n][m][y]===null&&delete this.deletedStates[n][m][y]}removeFeatureState(n,l,d){if(this.deletedStates[n]===null)return;const m=String(l);if(this.deletedStates[n]=this.deletedStates[n]||{},d&&l!==void 0)this.deletedStates[n][m]!==null&&(this.deletedStates[n][m]=this.deletedStates[n][m]||{},this.deletedStates[n][m][d]=null);else if(l!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][m])for(d in this.deletedStates[n][m]={},this.stateChanges[n][m])this.deletedStates[n][m][d]=null;else this.deletedStates[n][m]=null;else this.deletedStates[n]=null}getState(n,l){const d=String(l),m=u.e({},(this.state[n]||{})[d],(this.stateChanges[n]||{})[d]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const y=this.deletedStates[n][l];if(y===null)return{};for(const w in y)delete m[w]}return m}initializeTileState(n,l){n.setFeatureState(this.state,l)}coalesceChanges(n,l){const d={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const y={};for(const w in this.stateChanges[m])this.state[m][w]||(this.state[m][w]={}),u.e(this.state[m][w],this.stateChanges[m][w]),y[w]=this.state[m][w];d[m]=y}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const y={};if(this.deletedStates[m]===null)for(const w in this.state[m])y[w]={},this.state[m][w]={};else for(const w in this.deletedStates[m]){if(this.deletedStates[m][w]===null)this.state[m][w]={};else for(const C of Object.keys(this.deletedStates[m][w]))delete this.state[m][w][C];y[w]=this.state[m][w]}d[m]=d[m]||{},u.e(d[m],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const m in n)n[m].setFeatureState(d,l)}}class vt extends u.E{constructor(n,l,d){super(),this.id=n,this.dispatcher=d,this.on("data",m=>this._dataHandler(m)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((m,y,w,C)=>{const k=new(Ja(y.type))(m,y,w,C);if(k.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${k.id}`);return k})(n,l,d,this),this._tiles={},this._cache=new He(0,m=>this._unloadTile(m)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Mt,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,l,d){return u._(this,void 0,void 0,function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,l,d)}catch(m){n.state="errored",m.status!==404?this._source.fire(new u.j(m,{tile:n})):this.update(this.transform,this.terrain)}})}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new u.k("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const d=this._tiles[l];d.upload(n),d.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(Ir).map(n=>n.key)}getRenderableIds(n){const l=[];for(const d in this._tiles)this._isIdRenderable(d,n)&&l.push(this._tiles[d]);return n?l.sort((d,m)=>{const y=d.tileID,w=m.tileID,C=new u.P(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),k=new u.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-w.overscaledZ||k.y-C.y||k.x-C.x}).map(d=>d.tileID.key):l.map(d=>d.tileID).sort(Ir).map(d=>d.key)}hasRenderableParent(n){const l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")}}_reloadTile(n,l){return u._(this,void 0,void 0,function*(){const d=this._tiles[n];d&&(d.state!=="loading"&&(d.state=l),yield this._loadTile(d,n,l))})}_tileLoaded(n,l,d){n.timeAdded=z.now(),d==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new u.k("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const l=this.getRenderableIds();for(let m=0;m<l.length;m++){const y=l[m];if(n.neighboringTiles&&n.neighboringTiles[y]){const w=this.getTileByID(y);d(n,w),d(w,n)}}function d(m,y){m.needsHillshadePrepare=!0,m.needsTerrainPrepare=!0;let w=y.tileID.canonical.x-m.tileID.canonical.x;const C=y.tileID.canonical.y-m.tileID.canonical.y,k=Math.pow(2,m.tileID.canonical.z),A=y.tileID.key;w===0&&C===0||Math.abs(C)>1||(Math.abs(w)>1&&(Math.abs(w+k)===1?w+=k:Math.abs(w-k)===1&&(w-=k)),y.dem&&m.dem&&(m.dem.backfillBorder(y.dem,w,C),m.neighboringTiles&&m.neighboringTiles[A]&&(m.neighboringTiles[A].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,l,d,m){for(const y in this._tiles){let w=this._tiles[y];if(m[y]||!w.hasData()||w.tileID.overscaledZ<=l||w.tileID.overscaledZ>d)continue;let C=w.tileID;for(;w&&w.tileID.overscaledZ>l+1;){const A=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[A.key],w&&w.hasData()&&(C=A)}let k=C;for(;k.overscaledZ>l;)if(k=k.scaledTo(k.overscaledZ-1),n[k.key]){m[C.key]=C;break}}}findLoadedParent(n,l){if(n.key in this._loadedParentTiles){const d=this._loadedParentTiles[n.key];return d&&d.tileID.overscaledZ>=l?d:null}for(let d=n.overscaledZ-1;d>=l;d--){const m=n.scaledTo(d),y=this._getLoadedTile(m);if(y)return y}}findLoadedSibling(n){return this._getLoadedTile(n)}_getLoadedTile(n){const l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const l=Math.ceil(n.width/this._source.tileSize)+1,d=Math.ceil(n.height/this._source.tileSize)+1,m=Math.floor(l*d*(this._maxTileCacheZoomLevels===null?u.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(y)}handleWrapJump(n){const l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){const d={};for(const m in this._tiles){const y=this._tiles[m];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+l),d[y.tileID.key]=y}this._tiles=d;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(m,this._tiles[m])}}_updateCoveredAndRetainedTiles(n,l,d,m,y,w){const C={},k={},A=Object.keys(n),L=z.now();for(const F of A){const $=n[F],H=this._tiles[F];if(!H||H.fadeEndTime!==0&&H.fadeEndTime<=L)continue;const Y=this.findLoadedParent($,l),ie=this.findLoadedSibling($),ae=Y||ie||null;ae&&(this._addTile(ae.tileID),C[ae.tileID.key]=ae.tileID),k[F]=$}this._retainLoadedChildren(k,m,d,n);for(const F in C)n[F]||(this._coveredTiles[F]=!0,n[F]=C[F]);if(w){const F={},$={};for(const H of y)this._tiles[H.key].hasData()?F[H.key]=H:$[H.key]=H;for(const H in $){const Y=$[H].children(this._source.maxzoom);this._tiles[Y[0].key]&&this._tiles[Y[1].key]&&this._tiles[Y[2].key]&&this._tiles[Y[3].key]&&(F[Y[0].key]=n[Y[0].key]=Y[0],F[Y[1].key]=n[Y[1].key]=Y[1],F[Y[2].key]=n[Y[2].key]=Y[2],F[Y[3].key]=n[Y[3].key]=Y[3],delete $[H])}for(const H in $){const Y=$[H],ie=this.findLoadedParent(Y,this._source.minzoom),ae=this.findLoadedSibling(Y),ue=ie||ae||null;if(ue){F[ue.tileID.key]=n[ue.tileID.key]=ue.tileID;for(const de in F)F[de].isChildOf(ue.tileID)&&delete F[de]}}for(const H in this._tiles)F[H]||(this._coveredTiles[H]=!0)}}update(n,l){if(!this._sourceLoaded||this._paused)return;let d;this.transform=n,this.terrain=l,this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(L=>new u.S(L.canonical.z,L.wrap,L.canonical.z,L.canonical.x,L.canonical.y)):(d=n.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:l}),this._source.hasTile&&(d=d.filter(L=>this._source.hasTile(L)))):d=[];const m=n.coveringZoomLevel(this._source),y=Math.max(m-vt.maxOverzooming,this._source.minzoom),w=Math.max(m+vt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const L={};for(const F of d)if(F.canonical.z>this._source.minzoom){const $=F.scaledTo(F.canonical.z-1);L[$.key]=$;const H=F.scaledTo(Math.max(this._source.minzoom,Math.min(F.canonical.z,5)));L[H.key]=H}d=d.concat(Object.values(L))}const C=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new u.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const k=this._updateRetainedTiles(d,m);ki(this._source.type)&&this._updateCoveredAndRetainedTiles(k,y,w,m,d,l);for(const L in k)this._tiles[L].clearFadeHold();const A=u.ab(this._tiles,k);for(const L of A){const F=this._tiles[L];F.hasSymbolBuckets&&!F.holdingForFade()?F.setHoldDuration(this.map._fadeDuration):F.hasSymbolBuckets&&!F.symbolFadeFinished()||this._removeTile(L)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,l){var d;const m={},y={},w=Math.max(l-vt.maxOverzooming,this._source.minzoom),C=Math.max(l+vt.maxUnderzooming,this._source.minzoom),k={};for(const A of n){const L=this._addTile(A);m[A.key]=A,L.hasData()||l<this._source.maxzoom&&(k[A.key]=A)}this._retainLoadedChildren(k,l,C,m);for(const A of n){let L=this._tiles[A.key];if(L.hasData())continue;if(l+1>this._source.maxzoom){const $=A.children(this._source.maxzoom)[0],H=this.getTile($);if(H&&H.hasData()){m[$.key]=$;continue}}else{const $=A.children(this._source.maxzoom);if(m[$[0].key]&&m[$[1].key]&&m[$[2].key]&&m[$[3].key])continue}let F=L.wasRequested();for(let $=A.overscaledZ-1;$>=w;--$){const H=A.scaledTo($);if(y[H.key])break;if(y[H.key]=!0,L=this.getTile(H),!L&&F&&(L=this._addTile(H)),L){const Y=L.hasData();if((Y||!(!((d=this.map)===null||d===void 0)&&d.cancelPendingTileRequestsWhileZooming)||F)&&(m[H.key]=H),F=L.wasRequested(),Y)break}}}return m}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const l=[];let d,m=this._tiles[n].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){d=this._loadedParentTiles[m.key];break}l.push(m.key);const y=m.scaledTo(m.overscaledZ-1);if(d=this._getLoadedTile(y),d)break;m=y}for(const y of l)this._loadedParentTiles[y]=d}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const n in this._tiles){const l=this._tiles[n].tileID,d=this._getLoadedTile(l);this._loadedSiblingTiles[l.key]=d}}_addTile(n){let l=this._tiles[n.key];if(l)return l;l=this._cache.getAndRemove(n),l&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));const d=l;return l||(l=new Bs(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(l,n.key,l.state)),l.uses++,this._tiles[n.key]=l,d||this._source.fire(new u.k("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l}_setTileReloadTimer(n,l){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const d=l.getExpiryTimeout();d&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},d))}_removeTile(n){const l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}_dataHandler(n){const l=n.sourceDataType;n.dataType==="source"&&l==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&n.dataType==="source"&&l==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,l,d){const m=[],y=this.transform;if(!y)return m;const w=d?y.getCameraQueryGeometry(n):n,C=n.map(Y=>y.pointCoordinate(Y,this.terrain)),k=w.map(Y=>y.pointCoordinate(Y,this.terrain)),A=this.getIds();let L=1/0,F=1/0,$=-1/0,H=-1/0;for(const Y of k)L=Math.min(L,Y.x),F=Math.min(F,Y.y),$=Math.max($,Y.x),H=Math.max(H,Y.y);for(let Y=0;Y<A.length;Y++){const ie=this._tiles[A[Y]];if(ie.holdingForFade())continue;const ae=ie.tileID,ue=Math.pow(2,y.zoom-ie.tileID.overscaledZ),de=l*ie.queryPadding*u.X/ie.tileSize/ue,ee=[ae.getTilePoint(new u.Z(L,F)),ae.getTilePoint(new u.Z($,H))];if(ee[0].x-de<u.X&&ee[0].y-de<u.X&&ee[1].x+de>=0&&ee[1].y+de>=0){const ye=C.map(Te=>ae.getTilePoint(Te)),ve=k.map(Te=>ae.getTilePoint(Te));m.push({tile:ie,tileID:ae,queryGeometry:ye,cameraQueryGeometry:ve,scale:ue})}}return m}getVisibleCoordinates(n){const l=this.getRenderableIds(n).map(d=>this._tiles[d].tileID);for(const d of l)d.posMatrix=this.transform.calculatePosMatrix(d.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(ki(this._source.type)){const n=z.now();for(const l in this._tiles)if(this._tiles[l].fadeEndTime>=n)return!0}return!1}setFeatureState(n,l,d){this._state.updateState(n=n||"_geojsonTileLayer",l,d)}removeFeatureState(n,l,d){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,d)}getFeatureState(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)}setDependencies(n,l,d){const m=this._tiles[n];m&&m.setDependencies(l,d)}reloadTilesForDependencies(n,l){for(const d in this._tiles)this._tiles[d].hasDependency(n,l)&&this._reloadTile(d,"reloading");this._cache.filter(d=>!d.hasDependency(n,l))}}function Ir(_,n){const l=Math.abs(2*_.wrap)-+(_.wrap<0),d=Math.abs(2*n.wrap)-+(n.wrap<0);return _.overscaledZ-n.overscaledZ||d-l||n.canonical.y-_.canonical.y||n.canonical.x-_.canonical.x}function ki(_){return _==="raster"||_==="image"||_==="video"}vt.maxOverzooming=10,vt.maxUnderzooming=3;class Ct{constructor(n,l){this.reset(n,l)}reset(n,l){this.points=n||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=u.ac(n,0,1);let l=1,d=this._distances[l];const m=n*this.paddedLength+this.padding;for(;d<m&&l<this._distances.length;)d=this._distances[++l];const y=l-1,w=this._distances[y],C=d-w,k=C>0?(m-w)/C:0;return this.points[y].mult(1-k).add(this.points[l].mult(k))}}function Ji(_,n){let l=!0;return _==="always"||_!=="never"&&n!=="never"||(l=!1),l}class ws{constructor(n,l,d){const m=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(n/d),this.yCellCount=Math.ceil(l/d);for(let w=0;w<this.xCellCount*this.yCellCount;w++)m.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=l,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,l,d,m,y){this._forEachCell(l,d,m,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(m),this.bboxes.push(y)}insertCircle(n,l,d,m){this._forEachCell(l-m,d-m,l+m,d+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(l),this.circles.push(d),this.circles.push(m)}_insertBoxCell(n,l,d,m,y,w){this.boxCells[y].push(w)}_insertCircleCell(n,l,d,m,y,w){this.circleCells[y].push(w)}_query(n,l,d,m,y,w,C){if(d<0||n>this.width||m<0||l>this.height)return[];const k=[];if(n<=0&&l<=0&&this.width<=d&&this.height<=m){if(y)return[{key:null,x1:n,y1:l,x2:d,y2:m}];for(let A=0;A<this.boxKeys.length;A++)k.push({key:this.boxKeys[A],x1:this.bboxes[4*A],y1:this.bboxes[4*A+1],x2:this.bboxes[4*A+2],y2:this.bboxes[4*A+3]});for(let A=0;A<this.circleKeys.length;A++){const L=this.circles[3*A],F=this.circles[3*A+1],$=this.circles[3*A+2];k.push({key:this.circleKeys[A],x1:L-$,y1:F-$,x2:L+$,y2:F+$})}}else this._forEachCell(n,l,d,m,this._queryCell,k,{hitTest:y,overlapMode:w,seenUids:{box:{},circle:{}}},C);return k}query(n,l,d,m){return this._query(n,l,d,m,!1,null)}hitTest(n,l,d,m,y,w){return this._query(n,l,d,m,!0,y,w).length>0}hitTestCircle(n,l,d,m,y){const w=n-d,C=n+d,k=l-d,A=l+d;if(C<0||w>this.width||A<0||k>this.height)return!1;const L=[];return this._forEachCell(w,k,C,A,this._queryCellCircle,L,{hitTest:!0,overlapMode:m,circle:{x:n,y:l,radius:d},seenUids:{box:{},circle:{}}},y),L.length>0}_queryCell(n,l,d,m,y,w,C,k){const{seenUids:A,hitTest:L,overlapMode:F}=C,$=this.boxCells[y];if($!==null){const Y=this.bboxes;for(const ie of $)if(!A.box[ie]){A.box[ie]=!0;const ae=4*ie,ue=this.boxKeys[ie];if(n<=Y[ae+2]&&l<=Y[ae+3]&&d>=Y[ae+0]&&m>=Y[ae+1]&&(!k||k(ue))&&(!L||!Ji(F,ue.overlapMode))&&(w.push({key:ue,x1:Y[ae],y1:Y[ae+1],x2:Y[ae+2],y2:Y[ae+3]}),L))return!0}}const H=this.circleCells[y];if(H!==null){const Y=this.circles;for(const ie of H)if(!A.circle[ie]){A.circle[ie]=!0;const ae=3*ie,ue=this.circleKeys[ie];if(this._circleAndRectCollide(Y[ae],Y[ae+1],Y[ae+2],n,l,d,m)&&(!k||k(ue))&&(!L||!Ji(F,ue.overlapMode))){const de=Y[ae],ee=Y[ae+1],ye=Y[ae+2];if(w.push({key:ue,x1:de-ye,y1:ee-ye,x2:de+ye,y2:ee+ye}),L)return!0}}}return!1}_queryCellCircle(n,l,d,m,y,w,C,k){const{circle:A,seenUids:L,overlapMode:F}=C,$=this.boxCells[y];if($!==null){const Y=this.bboxes;for(const ie of $)if(!L.box[ie]){L.box[ie]=!0;const ae=4*ie,ue=this.boxKeys[ie];if(this._circleAndRectCollide(A.x,A.y,A.radius,Y[ae+0],Y[ae+1],Y[ae+2],Y[ae+3])&&(!k||k(ue))&&!Ji(F,ue.overlapMode))return w.push(!0),!0}}const H=this.circleCells[y];if(H!==null){const Y=this.circles;for(const ie of H)if(!L.circle[ie]){L.circle[ie]=!0;const ae=3*ie,ue=this.circleKeys[ie];if(this._circlesCollide(Y[ae],Y[ae+1],Y[ae+2],A.x,A.y,A.radius)&&(!k||k(ue))&&!Ji(F,ue.overlapMode))return w.push(!0),!0}}}_forEachCell(n,l,d,m,y,w,C,k){const A=this._convertToXCellCoord(n),L=this._convertToYCellCoord(l),F=this._convertToXCellCoord(d),$=this._convertToYCellCoord(m);for(let H=A;H<=F;H++)for(let Y=L;Y<=$;Y++)if(y.call(this,n,l,d,m,this.xCellCount*Y+H,w,C,k))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,l,d,m,y,w){const C=m-n,k=y-l,A=d+w;return A*A>C*C+k*k}_circleAndRectCollide(n,l,d,m,y,w,C){const k=(w-m)/2,A=Math.abs(n-(m+k));if(A>k+d)return!1;const L=(C-y)/2,F=Math.abs(l-(y+L));if(F>L+d)return!1;if(A<=k||F<=L)return!0;const $=A-k,H=F-L;return $*$+H*H<=d*d}}function Os(_,n,l,d,m){const y=u.H();return n?(u.K(y,y,[1/m,1/m,1]),l||u.ad(y,y,d.angle)):u.L(y,d.labelPlaneMatrix,_),y}function Qi(_,n,l,d,m){if(n){const y=u.ae(_);return u.K(y,y,[m,m,1]),l||u.ad(y,y,-d.angle),y}return d.glCoordMatrix}function se(_,n,l,d){let m;d?(m=[_,n,d(_,n),1],u.af(m,m,l)):(m=[_,n,0,1],Vt(m,m,l));const y=m[3];return{point:new u.P(m[0]/y,m[1]/y),signedDistanceFromCamera:y,isOccluded:!1}}function V(_,n){return .5+_/n*.5}function O(_,n){return _.x>=-n[0]&&_.x<=n[0]&&_.y>=-n[1]&&_.y<=n[1]}function Z(_,n,l,d,m,y,w,C,k,A,L,F,$,H,Y){const ie=d?_.textSizeData:_.iconSizeData,ae=u.ag(ie,l.transform.zoom),ue=[256/l.width*2+1,256/l.height*2+1],de=d?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;de.clear();const ee=_.lineVertexArray,ye=d?_.text.placedSymbolArray:_.icon.placedSymbolArray,ve=l.transform.width/l.transform.height;let Te=!1;for(let Re=0;Re<ye.length;Re++){const je=ye.get(Re);if(je.hidden||je.writingMode===u.ah.vertical&&!Te){mt(je.numGlyphs,de);continue}Te=!1;const Ye=se(je.anchorX,je.anchorY,n,Y);if(!O(Ye.point,ue)){mt(je.numGlyphs,de);continue}const nt=V(l.transform.cameraToCenterDistance,Ye.signedDistanceFromCamera),Ze=u.ai(ie,ae,je),We=w?Ze/nt:Ze*nt,lt={getElevation:Y,labelPlaneMatrix:m,lineVertexArray:ee,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:A,tileAnchorPoint:new u.P(je.anchorX,je.anchorY),unwrappedTileID:L,width:F,height:$,translation:H},St=_e(lt,je,We,!1,C,n,y,_.glyphOffsetArray,de,ve,k);Te=St.useVertical,(St.notEnoughRoom||Te||St.needsFlipping&&_e(lt,je,We,!0,C,n,y,_.glyphOffsetArray,de,ve,k).notEnoughRoom)&&mt(je.numGlyphs,de)}d?_.text.dynamicLayoutVertexBuffer.updateData(de):_.icon.dynamicLayoutVertexBuffer.updateData(de)}function re(_,n,l,d,m,y,w,C){const k=y.glyphStartIndex+y.numGlyphs,A=y.lineStartIndex,L=y.lineStartIndex+y.lineLength,F=n.getoffsetX(y.glyphStartIndex),$=n.getoffsetX(k-1),H=Ge(_*F,l,d,m,y.segment,A,L,C,w);if(!H)return null;const Y=Ge(_*$,l,d,m,y.segment,A,L,C,w);return Y?C.projectionCache.anyProjectionOccluded?null:{first:H,last:Y}:null}function me(_,n,l,d){return _===u.ah.horizontal&&Math.abs(l.y-n.y)>Math.abs(l.x-n.x)*d?{useVertical:!0}:(_===u.ah.vertical?n.y<l.y:n.x>l.x)?{needsFlipping:!0}:null}function _e(_,n,l,d,m,y,w,C,k,A,L){const F=l/24,$=n.lineOffsetX*F,H=n.lineOffsetY*F;let Y;if(n.numGlyphs>1){const ie=n.glyphStartIndex+n.numGlyphs,ae=n.lineStartIndex,ue=n.lineStartIndex+n.lineLength,de=re(F,C,$,H,d,n,L,_);if(!de)return{notEnoughRoom:!0};const ee=se(de.first.point.x,de.first.point.y,w,_.getElevation).point,ye=se(de.last.point.x,de.last.point.y,w,_.getElevation).point;if(m&&!d){const ve=me(n.writingMode,ee,ye,A);if(ve)return ve}Y=[de.first];for(let ve=n.glyphStartIndex+1;ve<ie-1;ve++)Y.push(Ge(F*C.getoffsetX(ve),$,H,d,n.segment,ae,ue,_,L));Y.push(de.last)}else{if(m&&!d){const ae=se(_.tileAnchorPoint.x,_.tileAnchorPoint.y,y,_.getElevation).point,ue=n.lineStartIndex+n.segment+1,de=new u.P(_.lineVertexArray.getx(ue),_.lineVertexArray.gety(ue)),ee=se(de.x,de.y,y,_.getElevation),ye=ee.signedDistanceFromCamera>0?ee.point:function(Te,Re,je,Ye,nt,Ze){return be(Te,Re,je,1,nt,Ze)}(_.tileAnchorPoint,de,ae,0,y,_),ve=me(n.writingMode,ae,ye,A);if(ve)return ve}const ie=Ge(F*C.getoffsetX(n.glyphStartIndex),$,H,d,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,_,L);if(!ie||_.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Y=[ie]}for(const ie of Y)u.aj(k,ie.point,ie.angle);return{}}function be(_,n,l,d,m,y){const w=_.add(_.sub(n)._unit()),C=m!==void 0?se(w.x,w.y,m,y.getElevation).point:Ee(w.x,w.y,y).point,k=l.sub(C);return l.add(k._mult(d/k.mag()))}function he(_,n,l){const d=n.projectionCache;if(d.projections[_])return d.projections[_];const m=new u.P(n.lineVertexArray.getx(_),n.lineVertexArray.gety(_)),y=Ee(m.x,m.y,n);if(y.signedDistanceFromCamera>0)return d.projections[_]=y.point,d.anyProjectionOccluded=d.anyProjectionOccluded||y.isOccluded,y.point;const w=_-l.direction;return function(C,k,A,L,F){return be(C,k,A,L,void 0,F)}(l.distanceFromAnchor===0?n.tileAnchorPoint:new u.P(n.lineVertexArray.getx(w),n.lineVertexArray.gety(w)),m,l.previousVertex,l.absOffsetX-l.distanceFromAnchor+1,n)}function Ee(_,n,l){const d=_+l.translation[0],m=n+l.translation[1];let y;return!l.pitchWithMap&&l.projection.useSpecialProjectionForSymbols?(y=l.projection.projectTileCoordinates(d,m,l.unwrappedTileID,l.getElevation),y.point.x=(.5*y.point.x+.5)*l.width,y.point.y=(.5*-y.point.y+.5)*l.height):(y=se(d,m,l.labelPlaneMatrix,l.getElevation),y.isOccluded=!1),y}function Fe(_,n,l){return _._unit()._perp()._mult(n*l)}function Ce(_,n,l,d,m,y,w,C,k){if(C.projectionCache.offsets[_])return C.projectionCache.offsets[_];const A=l.add(n);if(_+k.direction<d||_+k.direction>=m)return C.projectionCache.offsets[_]=A,A;const L=he(_+k.direction,C,k),F=Fe(L.sub(l),w,k.direction),$=l.add(F),H=L.add(F);return C.projectionCache.offsets[_]=u.ak(y,A,$,H)||A,C.projectionCache.offsets[_]}function Ge(_,n,l,d,m,y,w,C,k){const A=d?_-n:_+n;let L=A>0?1:-1,F=0;d&&(L*=-1,F=Math.PI),L<0&&(F+=Math.PI);let $,H=L>0?y+m:y+m+1;C.projectionCache.cachedAnchorPoint?$=C.projectionCache.cachedAnchorPoint:($=Ee(C.tileAnchorPoint.x,C.tileAnchorPoint.y,C).point,C.projectionCache.cachedAnchorPoint=$);let Y,ie,ae=$,ue=$,de=0,ee=0;const ye=Math.abs(A),ve=[];let Te;for(;de+ee<=ye;){if(H+=L,H<y||H>=w)return null;de+=ee,ue=ae,ie=Y;const Ye={absOffsetX:ye,direction:L,distanceFromAnchor:de,previousVertex:ue};if(ae=he(H,C,Ye),l===0)ve.push(ue),Te=ae.sub(ue);else{let nt;const Ze=ae.sub(ue);nt=Ze.mag()===0?Fe(he(H+L,C,Ye).sub(ae),l,L):Fe(Ze,l,L),ie||(ie=ue.add(nt)),Y=Ce(H,nt,ae,y,w,ie,l,C,Ye),ve.push(ie),Te=Y.sub(ie)}ee=Te.mag()}const Re=Te._mult((ye-de)/ee)._add(ie||ue),je=F+Math.atan2(ae.y-ue.y,ae.x-ue.x);return ve.push(Re),{point:Re,angle:k?je:0,path:ve}}const dt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function mt(_,n){for(let l=0;l<_;l++){const d=n.length;n.resize(d+4),n.float32.set(dt,3*d)}}function Vt(_,n,l){const d=n[0],m=n[1];return _[0]=l[0]*d+l[4]*m+l[12],_[1]=l[1]*d+l[5]*m+l[13],_[3]=l[3]*d+l[7]*m+l[15],_}const kt=100;class Nt{constructor(n,l,d=new ws(n.width+200,n.height+200,25),m=new ws(n.width+200,n.height+200,25)){this.transform=n,this.mapProjection=l,this.grid=d,this.ignoredGrid=m,this.pitchFactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+kt,this.screenBottomBoundary=n.height+kt,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,l,d,m,y,w,C,k,A,L,F){const $=n.anchorPointX+k[0],H=n.anchorPointY+k[1],Y=this.projectAndGetPerspectiveRatio(m,$,H,y,L),ie=d*Y.perspectiveRatio;let ae;if(w||C)ae=this._projectCollisionBox(n,ie,m,y,w,C,k,Y,L,F);else{const ve=Y.point.x+(F?F.x*ie:0),Te=Y.point.y+(F?F.y*ie:0);ae={allPointsOccluded:!1,box:[ve+n.x1*ie,Te+n.y1*ie,ve+n.x2*ie,Te+n.y2*ie]}}const[ue,de,ee,ye]=ae.box;return this.mapProjection.useSpecialProjectionForSymbols&&(w?ae.allPointsOccluded:this.mapProjection.isOccluded($,H,y))||Y.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(ue,de,ee,ye)||l!=="always"&&this.grid.hitTest(ue,de,ee,ye,l,A)?{box:[ue,de,ee,ye],placeable:!1,offscreen:!1}:{box:[ue,de,ee,ye],placeable:!0,offscreen:this.isOffscreen(ue,de,ee,ye)}}placeCollisionCircles(n,l,d,m,y,w,C,k,A,L,F,$,H,Y,ie,ae){const ue=[],de=new u.P(l.anchorX,l.anchorY),ee=this.getPerspectiveRatio(w,de.x,de.y,C,ae),ye=(F?y/ee:y*ee)/u.ap,ve={getElevation:ae,labelPlaneMatrix:k,lineVertexArray:d,pitchWithMap:F,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:de,unwrappedTileID:C,width:this.transform.width,height:this.transform.height,translation:ie},Te=re(ye,m,l.lineOffsetX*ye,l.lineOffsetY*ye,!1,l,!1,ve);let Re=!1,je=!1,Ye=!0;if(Te){const nt=.5*H*ee+Y,Ze=new u.P(-100,-100),We=new u.P(this.screenRightBoundary,this.screenBottomBoundary),lt=new Ct,St=Te.first,Xe=Te.last;let Qe=[];for(let It=St.path.length-1;It>=1;It--)Qe.push(St.path[It]);for(let It=1;It<Xe.path.length;It++)Qe.push(Xe.path[It]);const bt=2.5*nt;if(A){const It=this.projectPathToScreenSpace(Qe,ve,A);Qe=It.some(Rt=>Rt.signedDistanceFromCamera<=0)?[]:It.map(Rt=>Rt.point)}let cn=[];if(Qe.length>0){const It=Qe[0].clone(),Rt=Qe[0].clone();for(let hn=1;hn<Qe.length;hn++)It.x=Math.min(It.x,Qe[hn].x),It.y=Math.min(It.y,Qe[hn].y),Rt.x=Math.max(Rt.x,Qe[hn].x),Rt.y=Math.max(Rt.y,Qe[hn].y);cn=It.x>=Ze.x&&Rt.x<=We.x&&It.y>=Ze.y&&Rt.y<=We.y?[Qe]:Rt.x<Ze.x||It.x>We.x||Rt.y<Ze.y||It.y>We.y?[]:u.al([Qe],Ze.x,Ze.y,We.x,We.y)}for(const It of cn){lt.reset(It,.25*nt);let Rt=0;Rt=lt.length<=.5*nt?1:Math.ceil(lt.paddedLength/bt)+1;for(let hn=0;hn<Rt;hn++){const lr=hn/Math.max(Rt-1,1),zi=lt.lerp(lr),dn=zi.x+kt,zr=zi.y+kt;ue.push(dn,zr,nt,0);const xr=dn-nt,ur=zr-nt,br=dn+nt,rs=zr+nt;if(Ye=Ye&&this.isOffscreen(xr,ur,br,rs),je=je||this.isInsideGrid(xr,ur,br,rs),n!=="always"&&this.grid.hitTestCircle(dn,zr,nt,n,$)&&(Re=!0,!L))return{circles:[],offscreen:!1,collisionDetected:Re}}}}return{circles:!L&&Re||!je||ee<this.perspectiveRatioCutoff?[]:ue,offscreen:Ye,collisionDetected:Re}}projectPathToScreenSpace(n,l,d){return n.map(m=>se(m.x,m.y,d,l.getElevation))}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let d=1/0,m=1/0,y=-1/0,w=-1/0;for(const L of n){const F=new u.P(L.x+kt,L.y+kt);d=Math.min(d,F.x),m=Math.min(m,F.y),y=Math.max(y,F.x),w=Math.max(w,F.y),l.push(F)}const C=this.grid.query(d,m,y,w).concat(this.ignoredGrid.query(d,m,y,w)),k={},A={};for(const L of C){const F=L.key;if(k[F.bucketInstanceId]===void 0&&(k[F.bucketInstanceId]={}),k[F.bucketInstanceId][F.featureIndex])continue;const $=[new u.P(L.x1,L.y1),new u.P(L.x2,L.y1),new u.P(L.x2,L.y2),new u.P(L.x1,L.y2)];u.am(l,$)&&(k[F.bucketInstanceId][F.featureIndex]=!0,A[F.bucketInstanceId]===void 0&&(A[F.bucketInstanceId]=[]),A[F.bucketInstanceId].push(F.featureIndex))}return A}insertCollisionBox(n,l,d,m,y,w){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:y,collisionGroupID:w,overlapMode:l},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,l,d,m,y,w){const C=d?this.ignoredGrid:this.grid,k={bucketInstanceId:m,featureIndex:y,collisionGroupID:w,overlapMode:l};for(let A=0;A<n.length;A+=4)C.insertCircle(k,n[A],n[A+1],n[A+2])}projectAndGetPerspectiveRatio(n,l,d,m,y){let w;y?(w=[l,d,y(l,d),1],u.af(w,w,n)):(w=[l,d,0,1],Vt(w,w,n));const C=w[3];return{point:new u.P((w[0]/C+1)/2*this.transform.width+kt,(-w[1]/C+1)/2*this.transform.height+kt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/C*.5,isOccluded:!1,signedDistanceFromCamera:C}}getPerspectiveRatio(n,l,d,m,y){const w=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(l,d,m,y):se(l,d,n,y);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(n,l,d,m){return d<kt||n>=this.screenRightBoundary||m<kt||l>this.screenBottomBoundary}isInsideGrid(n,l,d,m){return d>=0&&n<this.gridRightBoundary&&m>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const n=u.an([]);return u.J(n,n,[-100,-100,0]),n}_projectCollisionBox(n,l,d,m,y,w,C,k,A,L){let F=new u.P(1,0),$=new u.P(0,1);const H=new u.P(n.anchorPointX+C[0],n.anchorPointY+C[1]);if(w&&!y){const Ye=this.projectAndGetPerspectiveRatio(d,H.x+1,H.y,m,A).point.sub(k.point).unit(),nt=Math.atan(Ye.y/Ye.x)+(Ye.x<0?Math.PI:0),Ze=Math.sin(nt),We=Math.cos(nt);F=new u.P(We,Ze),$=new u.P(-Ze,We)}else if(!w&&y){const Ye=-this.transform.angle,nt=Math.sin(Ye),Ze=Math.cos(Ye);F=new u.P(Ze,nt),$=new u.P(-nt,Ze)}let Y=k.point,ie=l;if(y){Y=H;const Ye=this.transform.zoom-Math.floor(this.transform.zoom);ie=Math.pow(2,-Ye),ie*=this.mapProjection.getPitchedTextCorrection(this.transform,H,m),L||(ie*=u.ac(.5+k.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}L&&(Y=Y.add(F.mult(L.x*ie)).add($.mult(L.y*ie)));const ae=n.x1*ie,ue=n.x2*ie,de=(ae+ue)/2,ee=n.y1*ie,ye=n.y2*ie,ve=(ee+ye)/2,Te=[{offsetX:ae,offsetY:ee},{offsetX:de,offsetY:ee},{offsetX:ue,offsetY:ee},{offsetX:ue,offsetY:ve},{offsetX:ue,offsetY:ye},{offsetX:de,offsetY:ye},{offsetX:ae,offsetY:ye},{offsetX:ae,offsetY:ve}];let Re=[];for(const{offsetX:Ye,offsetY:nt}of Te)Re.push(new u.P(Y.x+F.x*Ye+$.x*nt,Y.y+F.y*Ye+$.y*nt));let je=!1;if(y){const Ye=Re.map(nt=>this.projectAndGetPerspectiveRatio(d,nt.x,nt.y,m,A));je=Ye.some(nt=>!nt.isOccluded),Re=Ye.map(nt=>nt.point)}else je=!0;return{box:u.ao(Re),allPointsOccluded:!je}}}function Dt(_,n,l){return n*(u.X/(_.tileSize*Math.pow(2,l-_.tileID.overscaledZ)))}class Rn{constructor(n,l,d,m){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?l:-l))):m&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class yn{constructor(n,l,d,m,y){this.text=new Rn(n?n.text:null,l,d,y),this.icon=new Rn(n?n.icon:null,l,m,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class At{constructor(n,l,d){this.text=n,this.icon=l,this.skipFade=d}}class Zt{constructor(){this.invProjMatrix=u.H(),this.viewportMatrix=u.H(),this.circles=[]}}class pn{constructor(n,l,d,m,y){this.bucketInstanceId=n,this.featureIndex=l,this.sourceLayerIndex=d,this.bucketIndex=m,this.tileID=y}}class Wn{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const l=++this.maxGroupID;this.collisionGroups[n]={ID:l,predicate:d=>d.collisionGroupID===l}}return this.collisionGroups[n]}}function Qn(_,n,l,d,m){const{horizontalAlign:y,verticalAlign:w}=u.au(_);return new u.P(-(y-.5)*n+d[0]*m,-(w-.5)*l+d[1]*m)}class vr{constructor(n,l,d,m,y,w){this.transform=n.clone(),this.terrain=d,this.collisionIndex=new Nt(this.transform,l),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new Wn(y),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(n){const l=this.terrain;return l?(d,m)=>l.getElevation(n,d,m):null}getBucketParts(n,l,d,m){const y=d.getBucket(l),w=d.latestFeatureIndex;if(!y||!w||l.id!==y.layerIds[0])return;const C=d.collisionBoxArray,k=y.layers[0].layout,A=y.layers[0].paint,L=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),F=d.tileSize/u.X,$=d.tileID.toUnwrapped(),H=this.transform.calculatePosMatrix($),Y=k.get("text-pitch-alignment")==="map",ie=k.get("text-rotation-alignment")==="map",ae=Dt(d,1,this.transform.zoom),ue=this.collisionIndex.mapProjection.translatePosition(this.transform,d,A.get("text-translate"),A.get("text-translate-anchor")),de=this.collisionIndex.mapProjection.translatePosition(this.transform,d,A.get("icon-translate"),A.get("icon-translate-anchor")),ee=Os(H,Y,ie,this.transform,ae);let ye=null;if(Y){const Te=Qi(H,Y,ie,this.transform,ae);ye=u.L([],this.transform.labelPlaneMatrix,Te)}this.retainedQueryData[y.bucketInstanceId]=new pn(y.bucketInstanceId,w,y.sourceLayerIndex,y.index,d.tileID);const ve={bucket:y,layout:k,translationText:ue,translationIcon:de,posMatrix:H,unwrappedTileID:$,textLabelPlaneMatrix:ee,labelToScreenMatrix:ye,scale:L,textPixelRatio:F,holdingForFade:d.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:u.ag(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(m)for(const Te of y.sortKeyRanges){const{sortKey:Re,symbolInstanceStart:je,symbolInstanceEnd:Ye}=Te;n.push({sortKey:Re,symbolInstanceStart:je,symbolInstanceEnd:Ye,parameters:ve})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:ve})}attemptAnchorPlacement(n,l,d,m,y,w,C,k,A,L,F,$,H,Y,ie,ae,ue,de,ee){const ye=u.aq[n.textAnchor],ve=[n.textOffset0,n.textOffset1],Te=Qn(ye,d,m,ve,y),Re=this.collisionIndex.placeCollisionBox(l,$,k,A,L,C,w,ae,F.predicate,ee,Te);if((!de||this.collisionIndex.placeCollisionBox(de,$,k,A,L,C,w,ue,F.predicate,ee,Te).placeable)&&Re.placeable){let je;if(this.prevPlacement&&this.prevPlacement.variableOffsets[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID].text&&(je=this.prevPlacement.variableOffsets[H.crossTileID].anchor),H.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[H.crossTileID]={textOffset:ve,width:d,height:m,anchor:ye,textBoxScale:y,prevAnchor:je},this.markUsedJustification(Y,ye,H,ie),Y.allowVerticalPlacement&&(this.markUsedOrientation(Y,ie,H),this.placedOrientations[H.crossTileID]=ie),{shift:Te,placedGlyphBoxes:Re}}}placeLayerBucketPart(n,l,d){const{bucket:m,layout:y,translationText:w,translationIcon:C,posMatrix:k,unwrappedTileID:A,textLabelPlaneMatrix:L,labelToScreenMatrix:F,textPixelRatio:$,holdingForFade:H,collisionBoxArray:Y,partiallyEvaluatedTextSize:ie,collisionGroup:ae}=n.parameters,ue=y.get("text-optional"),de=y.get("icon-optional"),ee=u.ar(y,"text-overlap","text-allow-overlap"),ye=ee==="always",ve=u.ar(y,"icon-overlap","icon-allow-overlap"),Te=ve==="always",Re=y.get("text-rotation-alignment")==="map",je=y.get("text-pitch-alignment")==="map",Ye=y.get("icon-text-fit")!=="none",nt=y.get("symbol-z-order")==="viewport-y",Ze=ye&&(Te||!m.hasIconData()||de),We=Te&&(ye||!m.hasTextData()||ue);!m.collisionArrays&&Y&&m.deserializeCollisionBoxes(Y);const lt=this._getTerrainElevationFunc(this.retainedQueryData[m.bucketInstanceId].tileID),St=(Xe,Qe,bt)=>{var cn,It;if(l[Xe.crossTileID])return;if(H)return void(this.placements[Xe.crossTileID]=new At(!1,!1,!1));let Rt=!1,hn=!1,lr=!0,zi=null,dn={box:null,placeable:!1,offscreen:null},zr={placeable:!1},xr=null,ur=null,br=null,rs=0,da=0,zu=0;Qe.textFeatureIndex?rs=Qe.textFeatureIndex:Xe.useRuntimeCollisionCircles&&(rs=Xe.featureIndex),Qe.verticalTextFeatureIndex&&(da=Qe.verticalTextFeatureIndex);const fa=Qe.textBox;if(fa){const pi=er=>{let cr=u.ah.horizontal;if(m.allowVerticalPlacement&&!er&&this.prevPlacement){const Jr=this.prevPlacement.placedOrientations[Xe.crossTileID];Jr&&(this.placedOrientations[Xe.crossTileID]=Jr,cr=Jr,this.markUsedOrientation(m,cr,Xe))}return cr},mi=(er,cr)=>{if(m.allowVerticalPlacement&&Xe.numVerticalGlyphVertices>0&&Qe.verticalTextBox){for(const Jr of m.writingModes)if(Jr===u.ah.vertical?(dn=cr(),zr=dn):dn=er(),dn&&dn.placeable)break}else dn=er()},js=Xe.textAnchorOffsetStartIndex,Di=Xe.textAnchorOffsetEndIndex;if(Di===js){const er=(cr,Jr)=>{const Ft=this.collisionIndex.placeCollisionBox(cr,ee,$,k,A,je,Re,w,ae.predicate,lt);return Ft&&Ft.placeable&&(this.markUsedOrientation(m,Jr,Xe),this.placedOrientations[Xe.crossTileID]=Jr),Ft};mi(()=>er(fa,u.ah.horizontal),()=>{const cr=Qe.verticalTextBox;return m.allowVerticalPlacement&&Xe.numVerticalGlyphVertices>0&&cr?er(cr,u.ah.vertical):{box:null,offscreen:null}}),pi(dn&&dn.placeable)}else{let er=u.aq[(It=(cn=this.prevPlacement)===null||cn===void 0?void 0:cn.variableOffsets[Xe.crossTileID])===null||It===void 0?void 0:It.anchor];const cr=(Ft,wo,pa)=>{const ma=Ft.x2-Ft.x1,cp=Ft.y2-Ft.y1,Oy=Xe.textBoxScale,hp=Ye&&ve==="never"?wo:null;let $s=null,dp=ee==="never"?1:2,Ru="never";er&&dp++;for(let _l=0;_l<dp;_l++){for(let Lu=js;Lu<Di;Lu++){const Fu=m.textAnchorOffsets.get(Lu);if(er&&Fu.textAnchor!==er)continue;const ga=this.attemptAnchorPlacement(Fu,Ft,ma,cp,Oy,Re,je,$,k,A,ae,Ru,Xe,m,pa,w,C,hp,lt);if(ga&&($s=ga.placedGlyphBoxes,$s&&$s.placeable))return Rt=!0,zi=ga.shift,$s}er?er=null:Ru=ee}return d&&!$s&&($s={box:this.collisionIndex.placeCollisionBox(fa,"always",$,k,A,je,Re,w,ae.predicate,lt,new u.P(0,0)).box,offscreen:!1,placeable:!1}),$s};mi(()=>cr(fa,Qe.iconBox,u.ah.horizontal),()=>{const Ft=Qe.verticalTextBox;return m.allowVerticalPlacement&&(!dn||!dn.placeable)&&Xe.numVerticalGlyphVertices>0&&Ft?cr(Ft,Qe.verticalIconBox,u.ah.vertical):{box:null,occluded:!0,offscreen:null}}),dn&&(Rt=dn.placeable,lr=dn.offscreen);const Jr=pi(dn&&dn.placeable);if(!Rt&&this.prevPlacement){const Ft=this.prevPlacement.variableOffsets[Xe.crossTileID];Ft&&(this.variableOffsets[Xe.crossTileID]=Ft,this.markUsedJustification(m,Ft.anchor,Xe,Jr))}}}if(xr=dn,Rt=xr&&xr.placeable,lr=xr&&xr.offscreen,Xe.useRuntimeCollisionCircles){const pi=m.text.placedSymbolArray.get(Xe.centerJustifiedTextSymbolIndex),mi=u.ai(m.textSizeData,ie,pi),js=y.get("text-padding");ur=this.collisionIndex.placeCollisionCircles(ee,pi,m.lineVertexArray,m.glyphOffsetArray,mi,k,A,L,F,d,je,ae.predicate,Xe.collisionCircleDiameter,js,w,lt),ur.circles.length&&ur.collisionDetected&&!d&&u.w("Collisions detected, but collision boxes are not shown"),Rt=ye||ur.circles.length>0&&!ur.collisionDetected,lr=lr&&ur.offscreen}if(Qe.iconFeatureIndex&&(zu=Qe.iconFeatureIndex),Qe.iconBox){const pi=mi=>this.collisionIndex.placeCollisionBox(mi,ve,$,k,A,je,Re,C,ae.predicate,lt,Ye&&zi?zi:void 0);zr&&zr.placeable&&Qe.verticalIconBox?(br=pi(Qe.verticalIconBox),hn=br.placeable):(br=pi(Qe.iconBox),hn=br.placeable),lr=lr&&br.offscreen}const fi=ue||Xe.numHorizontalGlyphVertices===0&&Xe.numVerticalGlyphVertices===0,Du=de||Xe.numIconVertices===0;fi||Du?Du?fi||(hn=hn&&Rt):Rt=hn&&Rt:hn=Rt=hn&&Rt;const Nh=hn&&br.placeable;if(Rt&&xr.placeable&&this.collisionIndex.insertCollisionBox(xr.box,ee,y.get("text-ignore-placement"),m.bucketInstanceId,zr&&zr.placeable&&da?da:rs,ae.ID),Nh&&this.collisionIndex.insertCollisionBox(br.box,ve,y.get("icon-ignore-placement"),m.bucketInstanceId,zu,ae.ID),ur&&Rt&&this.collisionIndex.insertCollisionCircles(ur.circles,ee,y.get("text-ignore-placement"),m.bucketInstanceId,rs,ae.ID),d&&this.storeCollisionData(m.bucketInstanceId,bt,Qe,xr,br,ur),Xe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(m.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Xe.crossTileID]=new At(Rt||Ze,hn||We,lr||m.justReloaded),l[Xe.crossTileID]=!0};if(nt){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Xe=m.getSortedSymbolIndexes(this.transform.angle);for(let Qe=Xe.length-1;Qe>=0;--Qe){const bt=Xe[Qe];St(m.symbolInstances.get(bt),m.collisionArrays[bt],bt)}}else for(let Xe=n.symbolInstanceStart;Xe<n.symbolInstanceEnd;Xe++)St(m.symbolInstances.get(Xe),m.collisionArrays[Xe],Xe);if(d&&m.bucketInstanceId in this.collisionCircleArrays){const Xe=this.collisionCircleArrays[m.bucketInstanceId];u.as(Xe.invProjMatrix,k),Xe.viewportMatrix=this.collisionIndex.getViewportMatrix()}m.justReloaded=!1}storeCollisionData(n,l,d,m,y,w){if(d.textBox||d.iconBox){let C,k;this.collisionBoxArrays.has(n)?C=this.collisionBoxArrays.get(n):(C=new Map,this.collisionBoxArrays.set(n,C)),C.has(l)?k=C.get(l):(k={text:null,icon:null},C.set(l,k)),d.textBox&&(k.text=m.box),d.iconBox&&(k.icon=y.box)}if(w){let C=this.collisionCircleArrays[n];C===void 0&&(C=this.collisionCircleArrays[n]=new Zt);for(let k=0;k<w.circles.length;k+=4)C.circles.push(w.circles[k+0]),C.circles.push(w.circles[k+1]),C.circles.push(w.circles[k+2]),C.circles.push(w.collisionDetected?1:0)}}markUsedJustification(n,l,d,m){let y;y=m===u.ah.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[u.at(l)];const w=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const C of w)C>=0&&(n.text.placedSymbolArray.get(C).crossTileID=y>=0&&C!==y?0:d.crossTileID)}markUsedOrientation(n,l,d){const m=l===u.ah.horizontal||l===u.ah.horizontalOnly?l:0,y=l===u.ah.vertical?l:0,w=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const C of w)n.text.placedSymbolArray.get(C).placedOrientation=m;d.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let d=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const m=l?l.symbolFadeChange(n):1,y=l?l.opacities:{},w=l?l.variableOffsets:{},C=l?l.placedOrientations:{};for(const k in this.placements){const A=this.placements[k],L=y[k];L?(this.opacities[k]=new yn(L,m,A.text,A.icon),d=d||A.text!==L.text.placed||A.icon!==L.icon.placed):(this.opacities[k]=new yn(null,m,A.text,A.icon,A.skipFade),d=d||A.text||A.icon)}for(const k in y){const A=y[k];if(!this.opacities[k]){const L=new yn(A,m,!1,!1);L.isHidden()||(this.opacities[k]=L,d=d||A.text.placed||A.icon.placed)}}for(const k in w)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=w[k]);for(const k in C)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=C[k]);if(l&&l.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:n)}updateLayerOpacities(n,l){const d={};for(const m of l){const y=m.getBucket(n);y&&m.latestFeatureIndex&&n.id===y.layerIds[0]&&this.updateBucketOpacities(y,m.tileID,d,m.collisionBoxArray)}}updateBucketOpacities(n,l,d,m){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const y=n.layers[0],w=y.layout,C=new yn(null,0,!1,!1,!0),k=w.get("text-allow-overlap"),A=w.get("icon-allow-overlap"),L=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),F=w.get("text-rotation-alignment")==="map",$=w.get("text-pitch-alignment")==="map",H=w.get("icon-text-fit")!=="none",Y=new yn(null,0,k&&(A||!n.hasIconData()||w.get("icon-optional")),A&&(k||!n.hasTextData()||w.get("text-optional")),!0);!n.collisionArrays&&m&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(m);const ie=(ue,de,ee)=>{for(let ye=0;ye<de/4;ye++)ue.opacityVertexArray.emplaceBack(ee);ue.hasVisibleVertices=ue.hasVisibleVertices||ee!==Wo},ae=this.collisionBoxArrays.get(n.bucketInstanceId);for(let ue=0;ue<n.symbolInstances.length;ue++){const de=n.symbolInstances.get(ue),{numHorizontalGlyphVertices:ee,numVerticalGlyphVertices:ye,crossTileID:ve}=de;let Te=this.opacities[ve];d[ve]?Te=C:Te||(Te=Y,this.opacities[ve]=Te),d[ve]=!0;const Re=de.numIconVertices>0,je=this.placedOrientations[de.crossTileID],Ye=je===u.ah.vertical,nt=je===u.ah.horizontal||je===u.ah.horizontalOnly;if(ee>0||ye>0){const We=Xr(Te.text);ie(n.text,ee,Ye?Wo:We),ie(n.text,ye,nt?Wo:We);const lt=Te.text.isHidden();[de.rightJustifiedTextSymbolIndex,de.centerJustifiedTextSymbolIndex,de.leftJustifiedTextSymbolIndex].forEach(Qe=>{Qe>=0&&(n.text.placedSymbolArray.get(Qe).hidden=lt||Ye?1:0)}),de.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(de.verticalPlacedTextSymbolIndex).hidden=lt||nt?1:0);const St=this.variableOffsets[de.crossTileID];St&&this.markUsedJustification(n,St.anchor,de,je);const Xe=this.placedOrientations[de.crossTileID];Xe&&(this.markUsedJustification(n,"left",de,Xe),this.markUsedOrientation(n,Xe,de))}if(Re){const We=Xr(Te.icon),lt=!(H&&de.verticalPlacedIconSymbolIndex&&Ye);de.placedIconSymbolIndex>=0&&(ie(n.icon,de.numIconVertices,lt?We:Wo),n.icon.placedSymbolArray.get(de.placedIconSymbolIndex).hidden=Te.icon.isHidden()),de.verticalPlacedIconSymbolIndex>=0&&(ie(n.icon,de.numVerticalIconVertices,lt?Wo:We),n.icon.placedSymbolArray.get(de.verticalPlacedIconSymbolIndex).hidden=Te.icon.isHidden())}const Ze=ae&&ae.has(ue)?ae.get(ue):{text:null,icon:null};if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const We=n.collisionArrays[ue];if(We){let lt=new u.P(0,0);if(We.textBox||We.verticalTextBox){let St=!0;if(L){const Xe=this.variableOffsets[ve];Xe?(lt=Qn(Xe.anchor,Xe.width,Xe.height,Xe.textOffset,Xe.textBoxScale),F&&lt._rotate($?this.transform.angle:-this.transform.angle)):St=!1}if(We.textBox||We.verticalTextBox){let Xe;We.textBox&&(Xe=Ye),We.verticalTextBox&&(Xe=nt),Go(n.textCollisionBox.collisionVertexArray,Te.text.placed,!St||Xe,Ze.text,lt.x,lt.y)}}if(We.iconBox||We.verticalIconBox){const St=!!(!nt&&We.verticalIconBox);let Xe;We.iconBox&&(Xe=St),We.verticalIconBox&&(Xe=!St),Go(n.iconCollisionBox.collisionVertexArray,Te.icon.placed,Xe,Ze.icon,H?lt.x:0,H?lt.y:0)}}}}if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);if(n.bucketInstanceId in this.collisionCircleArrays){const ue=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=ue.invProjMatrix,n.placementViewportMatrix=ue.viewportMatrix,n.collisionCircleArray=ue.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,l){const d=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*d>n}setStale(){this.stale=!0}}function Go(_,n,l,d,m,y){d&&d.length!==0||(d=[0,0,0,0]);const w=d[0]-kt,C=d[1]-kt,k=d[2]-kt,A=d[3]-kt;_.emplaceBack(n?1:0,l?1:0,m||0,y||0,w,C),_.emplaceBack(n?1:0,l?1:0,m||0,y||0,k,C),_.emplaceBack(n?1:0,l?1:0,m||0,y||0,k,A),_.emplaceBack(n?1:0,l?1:0,m||0,y||0,w,A)}const Ht=Math.pow(2,25),Yc=Math.pow(2,24),Jc=Math.pow(2,17),Zr=Math.pow(2,16),Hr=Math.pow(2,9),dy=Math.pow(2,8),ui=Math.pow(2,1);function Xr(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const n=_.placed?1:0,l=Math.floor(127*_.opacity);return l*Ht+n*Yc+l*Jc+n*Zr+l*Hr+n*dy+l*ui+n}const Wo=0;function uo(){return{isOccluded:(_,n,l)=>!1,getPitchedTextCorrection:(_,n,l)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(_,n,l,d){throw new Error("Not implemented.")},translatePosition:(_,n,l,d)=>function(m,y,w,C,k=!1){if(!w[0]&&!w[1])return[0,0];const A=k?C==="map"?m.angle:0:C==="viewport"?-m.angle:0;if(A){const L=Math.sin(A),F=Math.cos(A);w=[w[0]*F-w[1]*L,w[0]*L+w[1]*F]}return[k?w[0]:Dt(y,w[0],m.zoom),k?w[1]:Dt(y,w[1],m.zoom)]}(_,n,l,d),getCircleRadiusCorrection:_=>1}}class Ln{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,l,d,m,y){const w=this._bucketParts;for(;this._currentTileIndex<n.length;)if(l.getBucketParts(w,m,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((C,k)=>C.sortKey-k.sortKey));this._currentPartIndex<w.length;)if(l.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,y())return!0;return!1}}class Qa{constructor(n,l,d,m,y,w,C,k){this.placement=new vr(n,uo(),l,w,C,k),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(n,l,d){const m=z.now(),y=()=>!this._forceFullPlacement&&z.now()-m>2;for(;this._currentPlacementIndex>=0;){const w=l[n[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=C)&&(!w.maxzoom||w.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new Ln(w)),this._inProgressLayer.continuePlacement(d[w.source],this.placement,this._showCollisionBoxes,w,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Pi=512/u.X/2;class Pn{constructor(n,l,d){this.tileID=n,this.bucketInstanceId=d,this._symbolsByKey={};const m=new Map;for(let y=0;y<l.length;y++){const w=l.get(y),C=w.key,k=m.get(C);k?k.push(w):m.set(C,[w])}for(const[y,w]of m){const C={positions:w.map(k=>({x:Math.floor(k.anchorX*Pi),y:Math.floor(k.anchorY*Pi)})),crossTileIDs:w.map(k=>k.crossTileID)};if(C.positions.length>128){const k=new u.av(C.positions.length,16,Uint16Array);for(const{x:A,y:L}of C.positions)k.add(A,L);k.finish(),delete C.positions,C.index=k}this._symbolsByKey[y]=C}}getScaledCoordinates(n,l){const{x:d,y:m,z:y}=this.tileID.canonical,{x:w,y:C,z:k}=l.canonical,A=Pi/Math.pow(2,k-y),L=(C*u.X+n.anchorY)*A,F=m*u.X*Pi;return{x:Math.floor((w*u.X+n.anchorX)*A-d*u.X*Pi),y:Math.floor(L-F)}}findMatches(n,l,d){const m=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z);for(let y=0;y<n.length;y++){const w=n.get(y);if(w.crossTileID)continue;const C=this._symbolsByKey[w.key];if(!C)continue;const k=this.getScaledCoordinates(w,l);if(C.index){const A=C.index.range(k.x-m,k.y-m,k.x+m,k.y+m).sort();for(const L of A){const F=C.crossTileIDs[L];if(!d[F]){d[F]=!0,w.crossTileID=F;break}}}else if(C.positions)for(let A=0;A<C.positions.length;A++){const L=C.positions[A],F=C.crossTileIDs[A];if(Math.abs(L.x-k.x)<=m&&Math.abs(L.y-k.y)<=m&&!d[F]){d[F]=!0,w.crossTileID=F;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:n})=>n)}}class tu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ei{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const l=Math.round((n-this.lng)/360);if(l!==0)for(const d in this.indexes){const m=this.indexes[d],y={};for(const w in m){const C=m[w];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+l),y[C.tileID.key]=C}this.indexes[d]=y}this.lng=n}addBucket(n,l,d){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let y=0;y<l.symbolInstances.length;y++)l.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const m=this.usedCrossTileIDs[n.overscaledZ];for(const y in this.indexes){const w=this.indexes[y];if(Number(y)>n.overscaledZ)for(const C in w){const k=w[C];k.tileID.isChildOf(n)&&k.findMatches(l.symbolInstances,n,m)}else{const C=w[n.scaledTo(Number(y)).key];C&&C.findMatches(l.symbolInstances,n,m)}}for(let y=0;y<l.symbolInstances.length;y++){const w=l.symbolInstances.get(y);w.crossTileID||(w.crossTileID=d.generate(),m[w.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Pn(n,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(n,l){for(const d of l.getCrossTileIDsLists())for(const m of d)delete this.usedCrossTileIDs[n][m]}removeStaleBuckets(n){let l=!1;for(const d in this.indexes){const m=this.indexes[d];for(const y in m)n[m[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,m[y]),delete m[y],l=!0)}return l}}class Qc{constructor(){this.layerIndexes={},this.crossTileIDs=new tu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,l,d){let m=this.layerIndexes[n.id];m===void 0&&(m=this.layerIndexes[n.id]=new Ei);let y=!1;const w={};m.handleWrapJump(d);for(const C of l){const k=C.getBucket(n);k&&n.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(C.tileID,k,this.crossTileIDs)&&(y=!0),w[k.bucketInstanceId]=!0)}return m.removeStaleBuckets(w)&&(y=!0),y}pruneUnusedLayers(n){const l={};n.forEach(d=>{l[d]=!0});for(const d in this.layerIndexes)l[d]||delete this.layerIndexes[d]}}const Ii=(_,n)=>u.t(_,n&&n.filter(l=>l.identifier!=="source.canvas")),fy=u.aw();class nu extends u.E{constructor(n,l={}){super(),this._rtlPluginLoaded=()=>{for(const d in this.sourceCaches){const m=this.sourceCaches[d].getSource().type;m!=="vector"&&m!=="geojson"||this.sourceCaches[d].reload()}},this.map=n,this.dispatcher=new xs(vs(),n._getMapId()),this.dispatcher.registerMessageHandler("GG",(d,m)=>this.getGlyphs(d,m)),this.dispatcher.registerMessageHandler("GI",(d,m)=>this.getImages(d,m)),this.imageManager=new ze,this.imageManager.setEventedParent(this),this.glyphManager=new _t(n._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Gr(256,512),this.crossTileSymbolIndex=new Qc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",u.ay()),Yi().on(Ue,this._rtlPluginLoaded),this.on("data",d=>{if(d.dataType!=="source"||d.sourceDataType!=="metadata")return;const m=this.sourceCaches[d.sourceId];if(!m)return;const y=m.getSource();if(y&&y.vectorLayerIds)for(const w in this._layers){const C=this._layers[w];C.source===y.id&&this._validateLayer(C)}})}loadURL(n,l={},d){this.fire(new u.k("dataloading",{dataType:"style"})),l.validate=typeof l.validate!="boolean"||l.validate;const m=this.map._requestManager.transformRequest(n,"Style");this._loadStyleRequest=new AbortController;const y=this._loadStyleRequest;u.h(m,this._loadStyleRequest).then(w=>{this._loadStyleRequest=null,this._load(w.data,l,d)}).catch(w=>{this._loadStyleRequest=null,w&&!y.signal.aborted&&this.fire(new u.j(w))})}loadJSON(n,l={},d){this.fire(new u.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,z.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,l.validate=l.validate!==!1,this._load(n,l,d)}).catch(()=>{})}loadEmpty(){this.fire(new u.k("dataloading",{dataType:"style"})),this._load(fy,{validate:!1})}_load(n,l,d){var m;const y=l.transformStyle?l.transformStyle(d,n):n;if(!l.validate||!Ii(this,u.u(y))){this._loaded=!0,this.stylesheet=y;for(const w in y.sources)this.addSource(w,y.sources[w],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new pt(this.stylesheet.light),this.sky=new Bt(this.stylesheet.sky),this.map.setTerrain((m=this.stylesheet.terrain)!==null&&m!==void 0?m:null),this.fire(new u.k("data",{dataType:"style"})),this.fire(new u.k("style.load"))}}_createLayers(){const n=u.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",n),this._order=n.map(l=>l.id),this._layers={},this._serializedLayers=null;for(const l of n){const d=u.aA(l);d.setEventedParent(this,{layer:{id:l.id}}),this._layers[l.id]=d}}_loadSprite(n,l=!1,d=void 0){let m;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(y,w,C,k){return u._(this,void 0,void 0,function*(){const A=Ne(y),L=C>1?"@2x":"",F={},$={};for(const{id:H,url:Y}of A){const ie=w.transformRequest($e(Y,L,".json"),"SpriteJSON");F[H]=u.h(ie,k);const ae=w.transformRequest($e(Y,L,".png"),"SpriteImage");$[H]=X.getImage(ae,k)}return yield Promise.all([...Object.values(F),...Object.values($)]),function(H,Y){return u._(this,void 0,void 0,function*(){const ie={};for(const ae in H){ie[ae]={};const ue=z.getImageCanvasContext((yield Y[ae]).data),de=(yield H[ae]).data;for(const ee in de){const{width:ye,height:ve,x:Te,y:Re,sdf:je,pixelRatio:Ye,stretchX:nt,stretchY:Ze,content:We,textFitWidth:lt,textFitHeight:St}=de[ee];ie[ae][ee]={data:null,pixelRatio:Ye,sdf:je,stretchX:nt,stretchY:Ze,content:We,textFitWidth:lt,textFitHeight:St,spriteData:{width:ye,height:ve,x:Te,y:Re,context:ue}}}}return ie})}(F,$)})}(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(y=>{if(this._spriteRequest=null,y)for(const w in y){this._spritesImagesIds[w]=[];const C=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter(k=>!(k in y)):[];for(const k of C)this.imageManager.removeImage(k),this._changedImages[k]=!0;for(const k in y[w]){const A=w==="default"?k:`${w}:${k}`;this._spritesImagesIds[w].push(A),A in this.imageManager.images?this.imageManager.updateImage(A,y[w][k],!1):this.imageManager.addImage(A,y[w][k]),l&&(this._changedImages[A]=!0)}}}).catch(y=>{this._spriteRequest=null,m=y,this.fire(new u.j(m))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),l&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"})),d&&d(m)})}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}_validateLayer(n){const l=this.sourceCaches[n.source];if(!l)return;const d=n.sourceLayer;if(!d)return;const m=l.getSource();(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(d)===-1)&&this.fire(new u.j(new Error(`Source layer "${d}" does not exist on source "${m.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n,l=!1){const d=this._serializedAllLayers();if(!n||n.length===0)return Object.values(l?u.aB(d):d);const m=[];for(const y of n)if(d[y]){const w=l?u.aB(d[y]):d[y];m.push(w)}return m}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const l=Object.keys(this._layers);for(const d of l){const m=this._layers[d];m.type!=="custom"&&(n[d]=m.serialize())}return n}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const l=this._changed;if(l){const m=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(m.length||y.length)&&this._updateWorkerLayers(m,y);for(const w in this._updatedSources){const C=this._updatedSources[w];if(C==="reload")this._reloadSource(w);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(n);this.light.updateTransitions(n),this.sky.updateTransitions(n),this._resetUpdates()}const d={};for(const m in this.sourceCaches){const y=this.sourceCaches[m];d[m]=y.used,y.used=!1}for(const m of this._order){const y=this._layers[m];y.recalculate(n,this._availableImages),!y.isHidden(n.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const m in d){const y=this.sourceCaches[m];!!d[m]!=!!y.used&&y.fire(new u.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:m}))}this.light.recalculate(n),this.sky.recalculate(n),this.z=n.zoom,l&&this.fire(new u.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,l){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(n,!1),removedIds:l})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,l={}){var d;this._checkLoaded();const m=this.serialize();if(n=l.transformStyle?l.transformStyle(m,n):n,((d=l.validate)===null||d===void 0||d)&&Ii(this,u.u(n)))return!1;(n=u.aB(n)).layers=u.az(n.layers);const y=u.aC(m,n),w=this._getOperationsToPerform(y);if(w.unimplemented.length>0)throw new Error(`Unimplemented: ${w.unimplemented.join(", ")}.`);if(w.operations.length===0)return!1;for(const C of w.operations)C();return this.stylesheet=n,this._serializedLayers=null,!0}_getOperationsToPerform(n){const l=[],d=[];for(const m of n)switch(m.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":l.push(()=>this.addLayer.apply(this,m.args));break;case"removeLayer":l.push(()=>this.removeLayer.apply(this,m.args));break;case"setPaintProperty":l.push(()=>this.setPaintProperty.apply(this,m.args));break;case"setLayoutProperty":l.push(()=>this.setLayoutProperty.apply(this,m.args));break;case"setFilter":l.push(()=>this.setFilter.apply(this,m.args));break;case"addSource":l.push(()=>this.addSource.apply(this,m.args));break;case"removeSource":l.push(()=>this.removeSource.apply(this,m.args));break;case"setLayerZoomRange":l.push(()=>this.setLayerZoomRange.apply(this,m.args));break;case"setLight":l.push(()=>this.setLight.apply(this,m.args));break;case"setGeoJSONSourceData":l.push(()=>this.setGeoJSONSourceData.apply(this,m.args));break;case"setGlyphs":l.push(()=>this.setGlyphs.apply(this,m.args));break;case"setSprite":l.push(()=>this.setSprite.apply(this,m.args));break;case"setSky":l.push(()=>this.setSky.apply(this,m.args));break;case"setTerrain":l.push(()=>this.map.setTerrain.apply(this,m.args));break;case"setTransition":l.push(()=>{});break;default:d.push(m.command)}return{operations:l,unimplemented:d}}addImage(n,l){if(this.getImage(n))return this.fire(new u.j(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,l),this._afterImageUpdated(n)}updateImage(n,l){this.imageManager.updateImage(n,l)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new u.j(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,l,d={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(u.u.source,`sources.${n}`,l,null,d))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const m=this.sourceCaches[n]=new vt(n,l,this.dispatcher);m.style=this,m.setEventedParent(this,()=>({isSourceLoaded:m.loaded(),source:m.serialize(),sourceId:n})),m.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===n)return this.fire(new u.j(new Error(`Source "${n}" cannot be removed while layer "${d}" is using it.`)));const l=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],l.fire(new u.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),l.setEventedParent(null),l.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,l){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const d=this.sourceCaches[n].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(l),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,l,d={}){this._checkLoaded();const m=n.id;if(this.getLayer(m))return void this.fire(new u.j(new Error(`Layer "${m}" already exists on this map.`)));let y;if(n.type==="custom"){if(Ii(this,u.aD(n)))return;y=u.aA(n)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(m,n.source),n=u.aB(n),n=u.e(n,{source:m})),this._validate(u.u.layer,`layers.${m}`,n,{arrayIndex:-1},d))return;y=u.aA(n),this._validateLayer(y),y.setEventedParent(this,{layer:{id:m}})}const w=l?this._order.indexOf(l):this._order.length;if(l&&w===-1)this.fire(new u.j(new Error(`Cannot add layer "${m}" before non-existing layer "${l}".`)));else{if(this._order.splice(w,0,m),this._layerOrderChanged=!0,this._layers[m]=y,this._removedLayers[m]&&y.source&&y.type!=="custom"){const C=this._removedLayers[m];delete this._removedLayers[m],C.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(n,l){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new u.j(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===l)return;const d=this._order.indexOf(n);this._order.splice(d,1);const m=l?this._order.indexOf(l):this._order.length;l&&m===-1?this.fire(new u.j(new Error(`Cannot move layer "${n}" before non-existing layer "${l}".`))):(this._order.splice(m,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const l=this._layers[n];if(!l)return void this.fire(new u.j(new Error(`Cannot remove non-existing layer "${n}".`)));l.setEventedParent(null);const d=this._order.indexOf(n);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,l,d){this._checkLoaded();const m=this.getLayer(n);m?m.minzoom===l&&m.maxzoom===d||(l!=null&&(m.minzoom=l),d!=null&&(m.maxzoom=d),this._updateLayer(m)):this.fire(new u.j(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,l,d={}){this._checkLoaded();const m=this.getLayer(n);if(m){if(!u.aE(m.filter,l))return l==null?(m.filter=void 0,void this._updateLayer(m)):void(this._validate(u.u.filter,`layers.${m.id}.filter`,l,null,d)||(m.filter=u.aB(l),this._updateLayer(m)))}else this.fire(new u.j(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return u.aB(this.getLayer(n).filter)}setLayoutProperty(n,l,d,m={}){this._checkLoaded();const y=this.getLayer(n);y?u.aE(y.getLayoutProperty(l),d)||(y.setLayoutProperty(l,d,m),this._updateLayer(y)):this.fire(new u.j(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,l){const d=this.getLayer(n);if(d)return d.getLayoutProperty(l);this.fire(new u.j(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,l,d,m={}){this._checkLoaded();const y=this.getLayer(n);y?u.aE(y.getPaintProperty(l),d)||(y.setPaintProperty(l,d,m)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[n]=!0,this._serializedLayers=null):this.fire(new u.j(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,l){return this.getLayer(n).getPaintProperty(l)}setFeatureState(n,l){this._checkLoaded();const d=n.source,m=n.sourceLayer,y=this.sourceCaches[d];if(y===void 0)return void this.fire(new u.j(new Error(`The source '${d}' does not exist in the map's style.`)));const w=y.getSource().type;w==="geojson"&&m?this.fire(new u.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||m?(n.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),y.setFeatureState(m,n.id,l)):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,l){this._checkLoaded();const d=n.source,m=this.sourceCaches[d];if(m===void 0)return void this.fire(new u.j(new Error(`The source '${d}' does not exist in the map's style.`)));const y=m.getSource().type,w=y==="vector"?n.sourceLayer:void 0;y!=="vector"||w?l&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new u.j(new Error("A feature id is required to remove its specific state property."))):m.removeFeatureState(w,n.id,l):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const l=n.source,d=n.sourceLayer,m=this.sourceCaches[l];if(m!==void 0)return m.getSource().type!=="vector"||d?(n.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),m.getFeatureState(d,n.id)):void this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.j(new Error(`The source '${l}' does not exist in the map's style.`)))}getTransition(){return u.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=u.aF(this.sourceCaches,y=>y.serialize()),l=this._serializeByIds(this._order,!0),d=this.map.getTerrain()||void 0,m=this.stylesheet;return u.aG({version:m.version,name:m.name,metadata:m.metadata,light:m.light,sky:m.sky,center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch,sprite:m.sprite,glyphs:m.glyphs,transition:m.transition,sources:n,layers:l,terrain:d},y=>y!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const l=w=>this._layers[w].type==="fill-extrusion",d={},m=[];for(let w=this._order.length-1;w>=0;w--){const C=this._order[w];if(l(C)){d[C]=w;for(const k of n){const A=k[C];if(A)for(const L of A)m.push(L)}}}m.sort((w,C)=>C.intersectionZ-w.intersectionZ);const y=[];for(let w=this._order.length-1;w>=0;w--){const C=this._order[w];if(l(C))for(let k=m.length-1;k>=0;k--){const A=m[k].feature;if(d[A.layer.id]<w)break;y.push(A),m.pop()}else for(const k of n){const A=k[C];if(A)for(const L of A)y.push(L.feature)}}return y}queryRenderedFeatures(n,l,d){l&&l.filter&&this._validate(u.u.filter,"queryRenderedFeatures.filter",l.filter,null,l);const m={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new u.j(new Error("parameters.layers must be an Array."))),[];for(const C of l.layers){const k=this._layers[C];if(!k)return this.fire(new u.j(new Error(`The layer '${C}' does not exist in the map's style and cannot be queried for features.`))),[];m[k.source]=!0}}const y=[];l.availableImages=this._availableImages;const w=this._serializedAllLayers();for(const C in this.sourceCaches)l.layers&&!m[C]||y.push(Xi(this.sourceCaches[C],this._layers,w,n,l,d));return this.placement&&y.push(function(C,k,A,L,F,$,H){const Y={},ie=$.queryRenderedSymbols(L),ae=[];for(const ue of Object.keys(ie).map(Number))ae.push(H[ue]);ae.sort(oi);for(const ue of ae){const de=ue.featureIndex.lookupSymbolFeatures(ie[ue.bucketInstanceId],k,ue.bucketIndex,ue.sourceLayerIndex,F.filter,F.layers,F.availableImages,C);for(const ee in de){const ye=Y[ee]=Y[ee]||[],ve=de[ee];ve.sort((Te,Re)=>{const je=ue.featureSortOrder;if(je){const Ye=je.indexOf(Te.featureIndex);return je.indexOf(Re.featureIndex)-Ye}return Re.featureIndex-Te.featureIndex});for(const Te of ve)ye.push(Te)}}for(const ue in Y)Y[ue].forEach(de=>{const ee=de.feature,ye=A[C[ue].source].getFeatureState(ee.layer["source-layer"],ee.id);ee.source=ee.layer.source,ee.layer["source-layer"]&&(ee.sourceLayer=ee.layer["source-layer"]),ee.state=ye});return Y}(this._layers,w,this.sourceCaches,n,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(n,l){l&&l.filter&&this._validate(u.u.filter,"querySourceFeatures.filter",l.filter,null,l);const d=this.sourceCaches[n];return d?function(m,y){const w=m.getRenderableIds().map(A=>m.getTileByID(A)),C=[],k={};for(let A=0;A<w.length;A++){const L=w[A],F=L.tileID.canonical.key;k[F]||(k[F]=!0,L.querySourceFeatures(C,y))}return C}(d,l):[]}getLight(){return this.light.getLight()}setLight(n,l={}){this._checkLoaded();const d=this.light.getLight();let m=!1;for(const w in n)if(!u.aE(n[w],d[w])){m=!0;break}if(!m)return;const y={now:z.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(y)}getSky(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.sky}setSky(n,l={}){const d=this.getSky();let m=!1;if(!n&&!d)return;if(n&&!d)m=!0;else if(!n&&d)m=!0;else for(const w in n)if(!u.aE(n[w],d[w])){m=!0;break}if(!m)return;const y={now:z.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=n,this.sky.setSky(n,l),this.sky.updateTransitions(y)}_validate(n,l,d,m,y={}){return(!y||y.validate!==!1)&&Ii(this,n.call(u.u,u.e({key:l,style:this.serialize(),value:d,styleSpec:u.v},m)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Yi().off(Ue,this._rtlPluginLoaded);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this.sourceCaches){const d=this.sourceCaches[l];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const l in this.sourceCaches)this.sourceCaches[l].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,l,d,m,y=!1){let w=!1,C=!1;const k={};for(const A of this._order){const L=this._layers[A];if(L.type!=="symbol")continue;if(!k[L.source]){const $=this.sourceCaches[L.source];k[L.source]=$.getRenderableIds(!0).map(H=>$.getTileByID(H)).sort((H,Y)=>Y.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(Y.tileID)?-1:1))}const F=this.crossTileSymbolIndex.addLayer(L,k[L.source],n.center.lng);w=w||F}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(z.now(),n.zoom))&&(this.pauseablePlacement=new Qa(n,this.map.terrain,this._order,y,l,d,m,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(z.now()),C=!0),w&&this.pauseablePlacement.placement.setStale()),C||w)for(const A of this._order){const L=this._layers[A];L.type==="symbol"&&this.placement.updateLayerOpacities(L,k[L.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(z.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,l){return u._(this,void 0,void 0,function*(){const d=yield this.imageManager.getImages(l.icons);this._updateTilesForChangedImages();const m=this.sourceCaches[l.source];return m&&m.setDependencies(l.tileID.key,l.type,l.icons),d})}getGlyphs(n,l){return u._(this,void 0,void 0,function*(){const d=yield this.glyphManager.getGlyphs(l.stacks),m=this.sourceCaches[l.source];return m&&m.setDependencies(l.tileID.key,l.type,[""]),d})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,l={}){this._checkLoaded(),n&&this._validate(u.u.glyphs,"glyphs",n,null,l)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,l,d={},m){this._checkLoaded();const y=[{id:n,url:l}],w=[...Ne(this.stylesheet.sprite),...y];this._validate(u.u.sprite,"sprite",w,null,d)||(this.stylesheet.sprite=w,this._loadSprite(y,!0,m))}removeSprite(n){this._checkLoaded();const l=Ne(this.stylesheet.sprite);if(l.find(d=>d.id===n)){if(this._spritesImagesIds[n])for(const d of this._spritesImagesIds[n])this.imageManager.removeImage(d),this._changedImages[d]=!0;l.splice(l.findIndex(d=>d.id===n),1),this.stylesheet.sprite=l.length>0?l:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}else this.fire(new u.j(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return Ne(this.stylesheet.sprite)}setSprite(n,l={},d){this._checkLoaded(),n&&this._validate(u.u.sprite,"sprite",n,null,l)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,d):(this._unloadSprite(),d&&d(null)))}}var co=u.Y([{name:"a_pos",type:"Int16",components:2}]);const Vs={prelude:qt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:qt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:qt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:qt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:qt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:qt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:qt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:qt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:qt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:qt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:qt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:qt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:qt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:qt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:qt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:qt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:qt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:qt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:qt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:qt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:qt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:qt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:qt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:qt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:qt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:qt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:qt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:qt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:qt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:qt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function qt(_,n){const l=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=n.match(/attribute ([\w]+) ([\w]+)/g),m=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=y?y.concat(m):m,C={};return{fragmentSource:_=_.replace(l,(k,A,L,F,$)=>(C[$]=!0,A==="define"?`
#ifndef HAS_UNIFORM_u_${$}
varying ${L} ${F} ${$};
#else
uniform ${L} ${F} u_${$};
#endif
`:`
#ifdef HAS_UNIFORM_u_${$}
    ${L} ${F} ${$} = u_${$};
#endif
`)),vertexSource:n=n.replace(l,(k,A,L,F,$)=>{const H=F==="float"?"vec2":"vec4",Y=$.match(/color/)?"color":H;return C[$]?A==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${L} ${H} a_${$};
varying ${L} ${F} ${$};
#else
uniform ${L} ${F} u_${$};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = a_${$};
#else
    ${L} ${F} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = unpack_mix_${Y}(a_${$}, u_${$}_t);
#else
    ${L} ${F} ${$} = u_${$};
#endif
`:A==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${L} ${H} a_${$};
#else
uniform ${L} ${F} u_${$};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${L} ${F} ${$} = a_${$};
#else
    ${L} ${F} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${L} ${F} ${$} = unpack_mix_${Y}(a_${$}, u_${$}_t);
#else
    ${L} ${F} ${$} = u_${$};
#endif
`}),staticAttributes:d,staticUniforms:w}}class eh{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,l,d,m,y,w,C,k,A){this.context=n;let L=this.boundPaintVertexBuffers.length!==m.length;for(let F=0;!L&&F<m.length;F++)this.boundPaintVertexBuffers[F]!==m[F]&&(L=!0);!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==d||L||this.boundIndexBuffer!==y||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==k||this.boundDynamicVertexBuffer3!==A?this.freshBind(l,d,m,y,w,C,k,A):(n.bindVertexArray.set(this.vao),C&&C.bind(),y&&y.dynamicDraw&&y.bind(),k&&k.bind(),A&&A.bind())}freshBind(n,l,d,m,y,w,C,k){const A=n.numAttributes,L=this.context,F=L.gl;this.vao&&this.destroy(),this.vao=L.createVertexArray(),L.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=m,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=k,l.enableAttributes(F,n);for(const $ of d)$.enableAttributes(F,n);w&&w.enableAttributes(F,n),C&&C.enableAttributes(F,n),k&&k.enableAttributes(F,n),l.bind(),l.setVertexAttribPointers(F,n,y);for(const $ of d)$.bind(),$.setVertexAttribPointers(F,n,y);w&&(w.bind(),w.setVertexAttribPointers(F,n,y)),m&&m.bind(),C&&(C.bind(),C.setVertexAttribPointers(F,n,y)),k&&(k.bind(),k.setVertexAttribPointers(F,n,y)),L.currentNumAttributes=A}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const th=(_,n,l,d,m)=>({u_matrix:_,u_texture:0,u_ele_delta:n,u_fog_matrix:l,u_fog_color:d?d.properties.get("fog-color"):u.aM.white,u_fog_ground_blend:d?d.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:d?d.calculateFogBlendOpacity(m):0,u_horizon_color:d?d.properties.get("horizon-color"):u.aM.white,u_horizon_fog_blend:d?d.properties.get("horizon-fog-blend"):1});function Zo(_){const n=[];for(let l=0;l<_.length;l++){if(_[l]===null)continue;const d=_[l].split(" ");n.push(d.pop())}return n}class nh{constructor(n,l,d,m,y,w){const C=n.gl;this.program=C.createProgram();const k=Zo(l.staticAttributes),A=d?d.getBinderAttributes():[],L=k.concat(A),F=Vs.prelude.staticUniforms?Zo(Vs.prelude.staticUniforms):[],$=l.staticUniforms?Zo(l.staticUniforms):[],H=d?d.getBinderUniforms():[],Y=F.concat($).concat(H),ie=[];for(const Te of Y)ie.indexOf(Te)<0&&ie.push(Te);const ae=d?d.defines():[];y&&ae.push("#define OVERDRAW_INSPECTOR;"),w&&ae.push("#define TERRAIN3D;");const ue=ae.concat(Vs.prelude.fragmentSource,l.fragmentSource).join(`
`),de=ae.concat(Vs.prelude.vertexSource,l.vertexSource).join(`
`),ee=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(ee,ue),C.compileShader(ee),!C.getShaderParameter(ee,C.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${C.getShaderInfoLog(ee)}`);C.attachShader(this.program,ee);const ye=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(ye,de),C.compileShader(ye),!C.getShaderParameter(ye,C.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${C.getShaderInfoLog(ye)}`);C.attachShader(this.program,ye),this.attributes={};const ve={};this.numAttributes=L.length;for(let Te=0;Te<this.numAttributes;Te++)L[Te]&&(C.bindAttribLocation(this.program,Te,L[Te]),this.attributes[L[Te]]=Te);if(C.linkProgram(this.program),!C.getProgramParameter(this.program,C.LINK_STATUS))throw new Error(`Program failed to link: ${C.getProgramInfoLog(this.program)}`);C.deleteShader(ye),C.deleteShader(ee);for(let Te=0;Te<ie.length;Te++){const Re=ie[Te];if(Re&&!ve[Re]){const je=C.getUniformLocation(this.program,Re);je&&(ve[Re]=je)}}this.fixedUniforms=m(n,ve),this.terrainUniforms=((Te,Re)=>({u_depth:new u.aH(Te,Re.u_depth),u_terrain:new u.aH(Te,Re.u_terrain),u_terrain_dim:new u.aI(Te,Re.u_terrain_dim),u_terrain_matrix:new u.aJ(Te,Re.u_terrain_matrix),u_terrain_unpack:new u.aK(Te,Re.u_terrain_unpack),u_terrain_exaggeration:new u.aI(Te,Re.u_terrain_exaggeration)}))(n,ve),this.binderUniforms=d?d.getUniforms(n,ve):[]}draw(n,l,d,m,y,w,C,k,A,L,F,$,H,Y,ie,ae,ue,de){const ee=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(d),n.setStencilMode(m),n.setColorMode(y),n.setCullFace(w),k){n.activeTexture.set(ee.TEXTURE2),ee.bindTexture(ee.TEXTURE_2D,k.depthTexture),n.activeTexture.set(ee.TEXTURE3),ee.bindTexture(ee.TEXTURE_2D,k.texture);for(const ve in this.terrainUniforms)this.terrainUniforms[ve].set(k[ve])}for(const ve in this.fixedUniforms)this.fixedUniforms[ve].set(C[ve]);ie&&ie.setUniforms(n,this.binderUniforms,H,{zoom:Y});let ye=0;switch(l){case ee.LINES:ye=2;break;case ee.TRIANGLES:ye=3;break;case ee.LINE_STRIP:ye=1}for(const ve of $.get()){const Te=ve.vaos||(ve.vaos={});(Te[A]||(Te[A]=new eh)).bind(n,this,L,ie?ie.getPaintVertexBuffers():[],F,ve.vertexOffset,ae,ue,de),ee.drawElements(l,ve.primitiveLength*ye,ee.UNSIGNED_SHORT,ve.primitiveOffset*ye*2)}}}function ru(_,n,l){const d=1/Dt(l,1,n.transform.tileZoom),m=Math.pow(2,l.tileID.overscaledZ),y=l.tileSize*Math.pow(2,n.transform.tileZoom)/m,w=y*(l.tileID.canonical.x+l.tileID.wrap*m),C=y*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[d,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[w>>16,C>>16],u_pixel_coord_lower:[65535&w,65535&C]}}const el=(_,n,l,d)=>{const m=n.style.light,y=m.properties.get("position"),w=[y.x,y.y,y.z],C=function(){var A=new u.A(9);return u.A!=Float32Array&&(A[1]=0,A[2]=0,A[3]=0,A[5]=0,A[6]=0,A[7]=0),A[0]=1,A[4]=1,A[8]=1,A}();m.properties.get("anchor")==="viewport"&&function(A,L){var F=Math.sin(L),$=Math.cos(L);A[0]=$,A[1]=F,A[2]=0,A[3]=-F,A[4]=$,A[5]=0,A[6]=0,A[7]=0,A[8]=1}(C,-n.transform.angle),function(A,L,F){var $=L[0],H=L[1],Y=L[2];A[0]=$*F[0]+H*F[3]+Y*F[6],A[1]=$*F[1]+H*F[4]+Y*F[7],A[2]=$*F[2]+H*F[5]+Y*F[8]}(w,w,C);const k=m.properties.get("color");return{u_matrix:_,u_lightpos:w,u_lightintensity:m.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+l,u_opacity:d}},iu=(_,n,l,d,m,y,w)=>u.e(el(_,n,l,d),ru(y,n,w),{u_height_factor:-Math.pow(2,m.overscaledZ)/w.tileSize/8}),Ho=_=>({u_matrix:_}),Af=(_,n,l,d)=>u.e(Ho(_),ru(l,n,d)),py=(_,n)=>({u_matrix:_,u_world:n}),zf=(_,n,l,d,m)=>u.e(Af(_,n,l,d),{u_world:m}),my=(_,n,l,d)=>{const m=_.transform;let y,w;if(d.paint.get("circle-pitch-alignment")==="map"){const C=Dt(l,1,m.zoom);y=!0,w=[C,C]}else y=!1,w=m.pixelsToGLUnits;return{u_camera_to_center_distance:m.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:_.translatePosMatrix(n.posMatrix,l,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:_.pixelRatio,u_extrude_scale:w}},ho=(_,n,l)=>({u_matrix:_,u_inv_matrix:n,u_camera_to_center_distance:l.cameraToCenterDistance,u_viewport_size:[l.width,l.height]}),tl=(_,n,l=1)=>({u_matrix:_,u_color:n,u_overlay:0,u_overlay_scale:l}),Mr=_=>({u_matrix:_}),Ar=(_,n,l,d)=>({u_matrix:_,u_extrude_scale:Dt(n,1,l),u_intensity:d}),su=(_,n,l,d)=>{const m=u.H();u.aP(m,0,_.width,_.height,0,0,1);const y=_.context.gl;return{u_matrix:m,u_world:[y.drawingBufferWidth,y.drawingBufferHeight],u_image:l,u_color_ramp:d,u_opacity:n.paint.get("heatmap-opacity")}};function ou(_,n){const l=Math.pow(2,n.canonical.z),d=n.canonical.y;return[new u.Z(0,d/l).toLngLat().lat,new u.Z(0,(d+1)/l).toLngLat().lat]}const au=(_,n,l,d)=>{const m=_.transform;return{u_matrix:Lf(_,n,l,d),u_ratio:1/Dt(n,1,m.zoom),u_device_pixel_ratio:_.pixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Df=(_,n,l,d,m)=>u.e(au(_,n,l,m),{u_image:0,u_image_height:d}),Xo=(_,n,l,d,m)=>{const y=_.transform,w=Rf(n,y);return{u_matrix:Lf(_,n,l,m),u_texsize:n.imageAtlasTexture.size,u_ratio:1/Dt(n,1,y.zoom),u_device_pixel_ratio:_.pixelRatio,u_image:0,u_scale:[w,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},gy=(_,n,l,d,m,y)=>{const w=_.lineAtlas,C=Rf(n,_.transform),k=l.layout.get("line-cap")==="round",A=w.getDash(d.from,k),L=w.getDash(d.to,k),F=A.width*m.fromScale,$=L.width*m.toScale;return u.e(au(_,n,l,y),{u_patternscale_a:[C/F,-A.height/2],u_patternscale_b:[C/$,-L.height/2],u_sdfgamma:w.width/(256*Math.min(F,$)*_.pixelRatio)/2,u_image:0,u_tex_y_a:A.y,u_tex_y_b:L.y,u_mix:m.t})};function Rf(_,n){return 1/Dt(_,1,n.tileZoom)}function Lf(_,n,l,d){return _.translatePosMatrix(d?d.posMatrix:n.tileID.posMatrix,n,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const yy=(_,n,l,d,m)=>{return{u_matrix:_,u_tl_parent:n,u_scale_parent:l,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(w=m.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(y=m.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:_y(m.paint.get("raster-hue-rotate"))};var y,w};function _y(_){_*=Math.PI/180;const n=Math.sin(_),l=Math.cos(_);return[(2*l+1)/3,(-Math.sqrt(3)*n-l+1)/3,(Math.sqrt(3)*n-l+1)/3]}const Ff=(_,n,l,d,m,y,w,C,k,A,L,F,$,H)=>{const Y=w.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:Y.cameraToCenterDistance,u_pitch:Y.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:Y.width/Y.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:k,u_coord_matrix:A,u_is_text:+F,u_pitch_with_map:+d,u_is_along_line:m,u_is_variable_anchor:y,u_texsize:$,u_texture:0,u_translation:L,u_pitched_scale:H}},nl=(_,n,l,d,m,y,w,C,k,A,L,F,$,H,Y)=>{const ie=w.transform;return u.e(Ff(_,n,l,d,m,y,w,C,k,A,L,F,$,Y),{u_gamma_scale:d?Math.cos(ie._pitch)*ie.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:1})},rh=(_,n,l,d,m,y,w,C,k,A,L,F,$,H)=>u.e(nl(_,n,l,d,m,y,w,C,k,A,L,!0,F,!0,H),{u_texsize_icon:$,u_texture_icon:1}),lu=(_,n,l)=>({u_matrix:_,u_opacity:n,u_color:l}),ih=(_,n,l,d,m,y)=>u.e(function(w,C,k,A){const L=k.imageManager.getPattern(w.from.toString()),F=k.imageManager.getPattern(w.to.toString()),{width:$,height:H}=k.imageManager.getPixelSize(),Y=Math.pow(2,A.tileID.overscaledZ),ie=A.tileSize*Math.pow(2,k.transform.tileZoom)/Y,ae=ie*(A.tileID.canonical.x+A.tileID.wrap*Y),ue=ie*A.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:L.tl,u_pattern_br_a:L.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[$,H],u_mix:C.t,u_pattern_size_a:L.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:C.fromScale,u_scale_b:C.toScale,u_tile_units_to_pixels:1/Dt(A,1,k.transform.tileZoom),u_pixel_coord_upper:[ae>>16,ue>>16],u_pixel_coord_lower:[65535&ae,65535&ue]}}(d,y,l,m),{u_matrix:_,u_opacity:n}),sh={fillExtrusion:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_lightpos:new u.aN(_,n.u_lightpos),u_lightintensity:new u.aI(_,n.u_lightintensity),u_lightcolor:new u.aN(_,n.u_lightcolor),u_vertical_gradient:new u.aI(_,n.u_vertical_gradient),u_opacity:new u.aI(_,n.u_opacity)}),fillExtrusionPattern:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_lightpos:new u.aN(_,n.u_lightpos),u_lightintensity:new u.aI(_,n.u_lightintensity),u_lightcolor:new u.aN(_,n.u_lightcolor),u_vertical_gradient:new u.aI(_,n.u_vertical_gradient),u_height_factor:new u.aI(_,n.u_height_factor),u_image:new u.aH(_,n.u_image),u_texsize:new u.aO(_,n.u_texsize),u_pixel_coord_upper:new u.aO(_,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(_,n.u_pixel_coord_lower),u_scale:new u.aN(_,n.u_scale),u_fade:new u.aI(_,n.u_fade),u_opacity:new u.aI(_,n.u_opacity)}),fill:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix)}),fillPattern:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_image:new u.aH(_,n.u_image),u_texsize:new u.aO(_,n.u_texsize),u_pixel_coord_upper:new u.aO(_,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(_,n.u_pixel_coord_lower),u_scale:new u.aN(_,n.u_scale),u_fade:new u.aI(_,n.u_fade)}),fillOutline:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_world:new u.aO(_,n.u_world)}),fillOutlinePattern:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_world:new u.aO(_,n.u_world),u_image:new u.aH(_,n.u_image),u_texsize:new u.aO(_,n.u_texsize),u_pixel_coord_upper:new u.aO(_,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(_,n.u_pixel_coord_lower),u_scale:new u.aN(_,n.u_scale),u_fade:new u.aI(_,n.u_fade)}),circle:(_,n)=>({u_camera_to_center_distance:new u.aI(_,n.u_camera_to_center_distance),u_scale_with_map:new u.aH(_,n.u_scale_with_map),u_pitch_with_map:new u.aH(_,n.u_pitch_with_map),u_extrude_scale:new u.aO(_,n.u_extrude_scale),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_matrix:new u.aJ(_,n.u_matrix)}),collisionBox:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_pixel_extrude_scale:new u.aO(_,n.u_pixel_extrude_scale)}),collisionCircle:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_inv_matrix:new u.aJ(_,n.u_inv_matrix),u_camera_to_center_distance:new u.aI(_,n.u_camera_to_center_distance),u_viewport_size:new u.aO(_,n.u_viewport_size)}),debug:(_,n)=>({u_color:new u.aL(_,n.u_color),u_matrix:new u.aJ(_,n.u_matrix),u_overlay:new u.aH(_,n.u_overlay),u_overlay_scale:new u.aI(_,n.u_overlay_scale)}),clippingMask:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix)}),heatmap:(_,n)=>({u_extrude_scale:new u.aI(_,n.u_extrude_scale),u_intensity:new u.aI(_,n.u_intensity),u_matrix:new u.aJ(_,n.u_matrix)}),heatmapTexture:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_world:new u.aO(_,n.u_world),u_image:new u.aH(_,n.u_image),u_color_ramp:new u.aH(_,n.u_color_ramp),u_opacity:new u.aI(_,n.u_opacity)}),hillshade:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_image:new u.aH(_,n.u_image),u_latrange:new u.aO(_,n.u_latrange),u_light:new u.aO(_,n.u_light),u_shadow:new u.aL(_,n.u_shadow),u_highlight:new u.aL(_,n.u_highlight),u_accent:new u.aL(_,n.u_accent)}),hillshadePrepare:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_image:new u.aH(_,n.u_image),u_dimension:new u.aO(_,n.u_dimension),u_zoom:new u.aI(_,n.u_zoom),u_unpack:new u.aK(_,n.u_unpack)}),line:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_ratio:new u.aI(_,n.u_ratio),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_units_to_pixels:new u.aO(_,n.u_units_to_pixels)}),lineGradient:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_ratio:new u.aI(_,n.u_ratio),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_units_to_pixels:new u.aO(_,n.u_units_to_pixels),u_image:new u.aH(_,n.u_image),u_image_height:new u.aI(_,n.u_image_height)}),linePattern:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_texsize:new u.aO(_,n.u_texsize),u_ratio:new u.aI(_,n.u_ratio),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_image:new u.aH(_,n.u_image),u_units_to_pixels:new u.aO(_,n.u_units_to_pixels),u_scale:new u.aN(_,n.u_scale),u_fade:new u.aI(_,n.u_fade)}),lineSDF:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_ratio:new u.aI(_,n.u_ratio),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_units_to_pixels:new u.aO(_,n.u_units_to_pixels),u_patternscale_a:new u.aO(_,n.u_patternscale_a),u_patternscale_b:new u.aO(_,n.u_patternscale_b),u_sdfgamma:new u.aI(_,n.u_sdfgamma),u_image:new u.aH(_,n.u_image),u_tex_y_a:new u.aI(_,n.u_tex_y_a),u_tex_y_b:new u.aI(_,n.u_tex_y_b),u_mix:new u.aI(_,n.u_mix)}),raster:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_tl_parent:new u.aO(_,n.u_tl_parent),u_scale_parent:new u.aI(_,n.u_scale_parent),u_buffer_scale:new u.aI(_,n.u_buffer_scale),u_fade_t:new u.aI(_,n.u_fade_t),u_opacity:new u.aI(_,n.u_opacity),u_image0:new u.aH(_,n.u_image0),u_image1:new u.aH(_,n.u_image1),u_brightness_low:new u.aI(_,n.u_brightness_low),u_brightness_high:new u.aI(_,n.u_brightness_high),u_saturation_factor:new u.aI(_,n.u_saturation_factor),u_contrast_factor:new u.aI(_,n.u_contrast_factor),u_spin_weights:new u.aN(_,n.u_spin_weights)}),symbolIcon:(_,n)=>({u_is_size_zoom_constant:new u.aH(_,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aH(_,n.u_is_size_feature_constant),u_size_t:new u.aI(_,n.u_size_t),u_size:new u.aI(_,n.u_size),u_camera_to_center_distance:new u.aI(_,n.u_camera_to_center_distance),u_pitch:new u.aI(_,n.u_pitch),u_rotate_symbol:new u.aH(_,n.u_rotate_symbol),u_aspect_ratio:new u.aI(_,n.u_aspect_ratio),u_fade_change:new u.aI(_,n.u_fade_change),u_matrix:new u.aJ(_,n.u_matrix),u_label_plane_matrix:new u.aJ(_,n.u_label_plane_matrix),u_coord_matrix:new u.aJ(_,n.u_coord_matrix),u_is_text:new u.aH(_,n.u_is_text),u_pitch_with_map:new u.aH(_,n.u_pitch_with_map),u_is_along_line:new u.aH(_,n.u_is_along_line),u_is_variable_anchor:new u.aH(_,n.u_is_variable_anchor),u_texsize:new u.aO(_,n.u_texsize),u_texture:new u.aH(_,n.u_texture),u_translation:new u.aO(_,n.u_translation),u_pitched_scale:new u.aI(_,n.u_pitched_scale)}),symbolSDF:(_,n)=>({u_is_size_zoom_constant:new u.aH(_,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aH(_,n.u_is_size_feature_constant),u_size_t:new u.aI(_,n.u_size_t),u_size:new u.aI(_,n.u_size),u_camera_to_center_distance:new u.aI(_,n.u_camera_to_center_distance),u_pitch:new u.aI(_,n.u_pitch),u_rotate_symbol:new u.aH(_,n.u_rotate_symbol),u_aspect_ratio:new u.aI(_,n.u_aspect_ratio),u_fade_change:new u.aI(_,n.u_fade_change),u_matrix:new u.aJ(_,n.u_matrix),u_label_plane_matrix:new u.aJ(_,n.u_label_plane_matrix),u_coord_matrix:new u.aJ(_,n.u_coord_matrix),u_is_text:new u.aH(_,n.u_is_text),u_pitch_with_map:new u.aH(_,n.u_pitch_with_map),u_is_along_line:new u.aH(_,n.u_is_along_line),u_is_variable_anchor:new u.aH(_,n.u_is_variable_anchor),u_texsize:new u.aO(_,n.u_texsize),u_texture:new u.aH(_,n.u_texture),u_gamma_scale:new u.aI(_,n.u_gamma_scale),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_is_halo:new u.aH(_,n.u_is_halo),u_translation:new u.aO(_,n.u_translation),u_pitched_scale:new u.aI(_,n.u_pitched_scale)}),symbolTextAndIcon:(_,n)=>({u_is_size_zoom_constant:new u.aH(_,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aH(_,n.u_is_size_feature_constant),u_size_t:new u.aI(_,n.u_size_t),u_size:new u.aI(_,n.u_size),u_camera_to_center_distance:new u.aI(_,n.u_camera_to_center_distance),u_pitch:new u.aI(_,n.u_pitch),u_rotate_symbol:new u.aH(_,n.u_rotate_symbol),u_aspect_ratio:new u.aI(_,n.u_aspect_ratio),u_fade_change:new u.aI(_,n.u_fade_change),u_matrix:new u.aJ(_,n.u_matrix),u_label_plane_matrix:new u.aJ(_,n.u_label_plane_matrix),u_coord_matrix:new u.aJ(_,n.u_coord_matrix),u_is_text:new u.aH(_,n.u_is_text),u_pitch_with_map:new u.aH(_,n.u_pitch_with_map),u_is_along_line:new u.aH(_,n.u_is_along_line),u_is_variable_anchor:new u.aH(_,n.u_is_variable_anchor),u_texsize:new u.aO(_,n.u_texsize),u_texsize_icon:new u.aO(_,n.u_texsize_icon),u_texture:new u.aH(_,n.u_texture),u_texture_icon:new u.aH(_,n.u_texture_icon),u_gamma_scale:new u.aI(_,n.u_gamma_scale),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_is_halo:new u.aH(_,n.u_is_halo),u_translation:new u.aO(_,n.u_translation),u_pitched_scale:new u.aI(_,n.u_pitched_scale)}),background:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_opacity:new u.aI(_,n.u_opacity),u_color:new u.aL(_,n.u_color)}),backgroundPattern:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_opacity:new u.aI(_,n.u_opacity),u_image:new u.aH(_,n.u_image),u_pattern_tl_a:new u.aO(_,n.u_pattern_tl_a),u_pattern_br_a:new u.aO(_,n.u_pattern_br_a),u_pattern_tl_b:new u.aO(_,n.u_pattern_tl_b),u_pattern_br_b:new u.aO(_,n.u_pattern_br_b),u_texsize:new u.aO(_,n.u_texsize),u_mix:new u.aI(_,n.u_mix),u_pattern_size_a:new u.aO(_,n.u_pattern_size_a),u_pattern_size_b:new u.aO(_,n.u_pattern_size_b),u_scale_a:new u.aI(_,n.u_scale_a),u_scale_b:new u.aI(_,n.u_scale_b),u_pixel_coord_upper:new u.aO(_,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(_,n.u_pixel_coord_lower),u_tile_units_to_pixels:new u.aI(_,n.u_tile_units_to_pixels)}),terrain:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_texture:new u.aH(_,n.u_texture),u_ele_delta:new u.aI(_,n.u_ele_delta),u_fog_matrix:new u.aJ(_,n.u_fog_matrix),u_fog_color:new u.aL(_,n.u_fog_color),u_fog_ground_blend:new u.aI(_,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new u.aI(_,n.u_fog_ground_blend_opacity),u_horizon_color:new u.aL(_,n.u_horizon_color),u_horizon_fog_blend:new u.aI(_,n.u_horizon_fog_blend)}),terrainDepth:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_ele_delta:new u.aI(_,n.u_ele_delta)}),terrainCoords:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_texture:new u.aH(_,n.u_texture),u_terrain_coords_id:new u.aI(_,n.u_terrain_coords_id),u_ele_delta:new u.aI(_,n.u_ele_delta)}),sky:(_,n)=>({u_sky_color:new u.aL(_,n.u_sky_color),u_horizon_color:new u.aL(_,n.u_horizon_color),u_horizon:new u.aI(_,n.u_horizon),u_sky_horizon_blend:new u.aI(_,n.u_sky_horizon_blend)})};class es{constructor(n,l,d){this.context=n;const m=n.gl;this.buffer=m.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const l=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const vy={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class oh{constructor(n,l,d,m){this.length=l.length,this.attributes=d,this.itemSize=l.bytesPerElement,this.dynamicDraw=m,this.context=n;const y=n.gl;this.buffer=y.createBuffer(),n.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,l){for(let d=0;d<this.attributes.length;d++){const m=l.attributes[this.attributes[d].name];m!==void 0&&n.enableVertexAttribArray(m)}}setVertexAttribPointers(n,l,d){for(let m=0;m<this.attributes.length;m++){const y=this.attributes[m],w=l.attributes[y.name];w!==void 0&&n.vertexAttribPointer(w,y.components,n[vy[y.type]],!1,this.itemSize,y.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const fo=new WeakMap;function Ns(_){var n;if(fo.has(_))return fo.get(_);{const l=(n=_.getParameter(_.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return fo.set(_,l),l}}class Gt{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class uu extends Gt{getDefault(){return u.aM.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class xy extends Gt{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Ko extends Gt{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class by extends Gt{getDefault(){return[!0,!0,!0,!0]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Bf extends Gt{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class wy extends Gt{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class Of extends Gt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class ah extends Gt{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Vf extends Gt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}}class Nf extends Gt{getDefault(){return[0,1]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class jf extends Gt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}}class $f extends Gt{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class po extends Gt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}}class Uf extends Gt{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Sy extends Gt{getDefault(){return u.aM.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class qf extends Gt{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class rl extends Gt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}}class Ty extends Gt{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class cu extends Gt{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class Cy extends Gt{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class ky extends Gt{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Gf extends Gt{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Wf extends Gt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Zf extends Gt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class lh extends Gt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Hf extends Gt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class hu extends Gt{getDefault(){return null}set(n){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Ss extends Gt{getDefault(){return null}set(n){var l;if(n===this.current&&!this.dirty)return;const d=this.gl;Ns(d)?d.bindVertexArray(n):(l=d.getExtension("OES_vertex_array_object"))===null||l===void 0||l.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class uh extends Gt{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class ch extends Gt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class hh extends Gt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class du extends Gt{constructor(n,l){super(n),this.context=n,this.parent=l}getDefault(){return null}}class dh extends du{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class mo extends du{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class fh extends du{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Py{constructor(n,l,d,m,y){this.context=n,this.width=l,this.height=d;const w=n.gl,C=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new dh(n,C),m)this.depthAttachment=y?new fh(n,C):new mo(n,C);else if(y)throw new Error("Stencil cannot be set without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const n=this.context.gl,l=this.colorAttachment.get();if(l&&n.deleteTexture(l),this.depthAttachment){const d=this.depthAttachment.get();d&&n.deleteRenderbuffer(d)}n.deleteFramebuffer(this.framebuffer)}}class bn{constructor(n,l,d){this.blendFunction=n,this.blendColor=l,this.mask=d}}bn.Replace=[1,0],bn.disabled=new bn(bn.Replace,u.aM.transparent,[!1,!1,!1,!1]),bn.unblended=new bn(bn.Replace,u.aM.transparent,[!0,!0,!0,!0]),bn.alphaBlended=new bn([1,771],u.aM.transparent,[!0,!0,!0,!0]);class Ey{constructor(n){var l,d;if(this.gl=n,this.clearColor=new uu(this),this.clearDepth=new xy(this),this.clearStencil=new Ko(this),this.colorMask=new by(this),this.depthMask=new Bf(this),this.stencilMask=new wy(this),this.stencilFunc=new Of(this),this.stencilOp=new ah(this),this.stencilTest=new Vf(this),this.depthRange=new Nf(this),this.depthTest=new jf(this),this.depthFunc=new $f(this),this.blend=new po(this),this.blendFunc=new Uf(this),this.blendColor=new Sy(this),this.blendEquation=new qf(this),this.cullFace=new rl(this),this.cullFaceSide=new Ty(this),this.frontFace=new cu(this),this.program=new Cy(this),this.activeTexture=new ky(this),this.viewport=new Gf(this),this.bindFramebuffer=new Wf(this),this.bindRenderbuffer=new Zf(this),this.bindTexture=new lh(this),this.bindVertexBuffer=new Hf(this),this.bindElementBuffer=new hu(this),this.bindVertexArray=new Ss(this),this.pixelStoreUnpack=new uh(this),this.pixelStoreUnpackPremultiplyAlpha=new ch(this),this.pixelStoreUnpackFlipY=new hh(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),Ns(n)){this.HALF_FLOAT=n.HALF_FLOAT;const m=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(l=n.RGBA16F)!==null&&l!==void 0?l:m==null?void 0:m.RGBA16F_EXT,this.RGB16F=(d=n.RGB16F)!==null&&d!==void 0?d:m==null?void 0:m.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const m=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=m==null?void 0:m.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,l){return new es(this,n,l)}createVertexBuffer(n,l,d){return new oh(this,n,l,d)}createRenderbuffer(n,l,d){const m=this.gl,y=m.createRenderbuffer();return this.bindRenderbuffer.set(y),m.renderbufferStorage(m.RENDERBUFFER,n,l,d),this.bindRenderbuffer.set(null),y}createFramebuffer(n,l,d,m){return new Py(this,n,l,d,m)}clear({color:n,depth:l,stencil:d}){const m=this.gl;let y=0;n&&(y|=m.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),l!==void 0&&(y|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),d!==void 0&&(y|=m.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),m.clear(y)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){u.aE(n.blendFunction,bn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return Ns(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var l;return Ns(this.gl)?this.gl.deleteVertexArray(n):(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}class zt{constructor(n,l,d){this.func=n,this.mask=l,this.range=d}}zt.ReadOnly=!1,zt.ReadWrite=!0,zt.disabled=new zt(519,zt.ReadOnly,[0,1]);const fu=7680;class tn{constructor(n,l,d,m,y,w){this.test=n,this.ref=l,this.mask=d,this.fail=m,this.depthFail=y,this.pass=w}}tn.disabled=new tn({func:519,mask:0},0,0,fu,fu,fu);class Xt{constructor(n,l,d){this.enable=n,this.mode=l,this.frontFace=d}}let go;function il(_,n,l,d,m){const y=_.context,w=y.gl,C=_.useProgram("collisionBox"),k=[];let A=0,L=0;for(let ue=0;ue<d.length;ue++){const de=d[ue],ee=n.getTile(de).getBucket(l);if(!ee)continue;const ye=m?ee.textCollisionBox:ee.iconCollisionBox,ve=ee.collisionCircleArray;if(ve.length>0){const Te=u.H();u.aQ(Te,ee.placementInvProjMatrix,_.transform.glCoordMatrix),u.aQ(Te,Te,ee.placementViewportMatrix),k.push({circleArray:ve,circleOffset:L,transform:de.posMatrix,invTransform:Te,coord:de}),A+=ve.length/4,L=A}ye&&C.draw(y,w.LINES,zt.disabled,tn.disabled,_.colorModeForRenderPass(),Xt.disabled,{u_matrix:de.posMatrix,u_pixel_extrude_scale:[1/(F=_.transform).width,1/F.height]},_.style.map.terrain&&_.style.map.terrain.getTerrainData(de),l.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,null,_.transform.zoom,null,null,ye.collisionVertexBuffer)}var F;if(!m||!k.length)return;const $=_.useProgram("collisionCircle"),H=new u.aR;H.resize(4*A),H._trim();let Y=0;for(const ue of k)for(let de=0;de<ue.circleArray.length/4;de++){const ee=4*de,ye=ue.circleArray[ee+0],ve=ue.circleArray[ee+1],Te=ue.circleArray[ee+2],Re=ue.circleArray[ee+3];H.emplace(Y++,ye,ve,Te,Re,0),H.emplace(Y++,ye,ve,Te,Re,1),H.emplace(Y++,ye,ve,Te,Re,2),H.emplace(Y++,ye,ve,Te,Re,3)}(!go||go.length<2*A)&&(go=function(ue){const de=2*ue,ee=new u.aT;ee.resize(de),ee._trim();for(let ye=0;ye<de;ye++){const ve=6*ye;ee.uint16[ve+0]=4*ye+0,ee.uint16[ve+1]=4*ye+1,ee.uint16[ve+2]=4*ye+2,ee.uint16[ve+3]=4*ye+2,ee.uint16[ve+4]=4*ye+3,ee.uint16[ve+5]=4*ye+0}return ee}(A));const ie=y.createIndexBuffer(go,!0),ae=y.createVertexBuffer(H,u.aS.members,!0);for(const ue of k){const de=ho(ue.transform,ue.invTransform,_.transform);$.draw(y,w.TRIANGLES,zt.disabled,tn.disabled,_.colorModeForRenderPass(),Xt.disabled,de,_.style.map.terrain&&_.style.map.terrain.getTerrainData(ue.coord),l.id,ae,ie,u.a0.simpleSegment(0,2*ue.circleOffset,ue.circleArray.length,ue.circleArray.length/2),null,_.transform.zoom,null,null,null)}ae.destroy(),ie.destroy()}Xt.disabled=new Xt(!1,1029,2305),Xt.backCCW=new Xt(!0,1029,2305);const sl=u.an(new Float32Array(16));function ph(_,n,l,d,m,y){const{horizontalAlign:w,verticalAlign:C}=u.au(_);return new u.P((-(w-.5)*n/m+d[0])*y,(-(C-.5)*l/m+d[1])*y)}function yo(_,n,l,d,m,y){const w=n.tileAnchorPoint.add(new u.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let C=d.mult(y);l||(C=C.rotate(-m));const k=w.add(C);return se(k.x,k.y,n.labelPlaneMatrix,n.getElevation).point}if(l){const C=Ee(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(_),k=Math.atan(C.y/C.x)+(C.x<0?Math.PI:0);return _.add(d.rotate(k))}return _.add(d)}function Yo(_,n,l,d,m,y,w,C,k,A,L,F,$,H){const Y=_.text.placedSymbolArray,ie=_.text.dynamicLayoutVertexArray,ae=_.icon.dynamicLayoutVertexArray,ue={};ie.clear();for(let de=0;de<Y.length;de++){const ee=Y.get(de),ye=ee.hidden||!ee.crossTileID||_.allowVerticalPlacement&&!ee.placedOrientation?null:d[ee.crossTileID];if(ye){const ve=new u.P(ee.anchorX,ee.anchorY),Te={getElevation:H,width:m.width,height:m.height,labelPlaneMatrix:y,pitchWithMap:l,projection:L,tileAnchorPoint:ve,translation:F,unwrappedTileID:$},Re=l?se(ve.x,ve.y,w,H):Ee(ve.x,ve.y,Te),je=V(m.cameraToCenterDistance,Re.signedDistanceFromCamera);let Ye=u.ai(_.textSizeData,k,ee)*je/u.ap;l&&(Ye*=_.tilePixelRatio/C);const{width:nt,height:Ze,anchor:We,textOffset:lt,textBoxScale:St}=ye,Xe=ph(We,nt,Ze,lt,St,Ye),Qe=L.getPitchedTextCorrection(m,ve.add(new u.P(F[0],F[1])),$),bt=yo(Re.point,Te,n,Xe,m.angle,Qe),cn=_.allowVerticalPlacement&&ee.placedOrientation===u.ah.vertical?Math.PI/2:0;for(let It=0;It<ee.numGlyphs;It++)u.aj(ie,bt,cn);A&&ee.associatedIconIndex>=0&&(ue[ee.associatedIconIndex]={shiftedAnchor:bt,angle:cn})}else mt(ee.numGlyphs,ie)}if(A){ae.clear();const de=_.icon.placedSymbolArray;for(let ee=0;ee<de.length;ee++){const ye=de.get(ee);if(ye.hidden)mt(ye.numGlyphs,ae);else{const ve=ue[ee];if(ve)for(let Te=0;Te<ye.numGlyphs;Te++)u.aj(ae,ve.shiftedAnchor,ve.angle);else mt(ye.numGlyphs,ae)}}_.icon.dynamicLayoutVertexBuffer.updateData(ae)}_.text.dynamicLayoutVertexBuffer.updateData(ie)}function ci(_,n,l){return l.iconsInText&&n?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function mh(_,n,l,d,m,y,w,C,k,A,L,F){const $=_.context,H=$.gl,Y=_.transform,ie=uo(),ae=C==="map",ue=k==="map",de=C!=="viewport"&&l.layout.get("symbol-placement")!=="point",ee=ae&&!ue&&!de,ye=!ue&&de,ve=!l.layout.get("symbol-sort-key").isConstant();let Te=!1;const Re=_.depthModeForSublayer(0,zt.ReadOnly),je=l._unevaluatedLayout.hasValue("text-variable-anchor")||l._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ye=[],nt=ie.getCircleRadiusCorrection(Y);for(const Ze of d){const We=n.getTile(Ze),lt=We.getBucket(l);if(!lt)continue;const St=m?lt.text:lt.icon;if(!St||!St.segments.get().length||!St.hasVisibleVertices)continue;const Xe=St.programConfigurations.get(l.id),Qe=m||lt.sdfIcons,bt=m?lt.textSizeData:lt.iconSizeData,cn=ue||Y.pitch!==0,It=_.useProgram(ci(Qe,m,lt),Xe),Rt=u.ag(bt,Y.zoom),hn=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ze);let lr,zi,dn,zr,xr=[0,0],ur=null;if(m)zi=We.glyphAtlasTexture,dn=H.LINEAR,lr=We.glyphAtlasTexture.size,lt.iconsInText&&(xr=We.imageAtlasTexture.size,ur=We.imageAtlasTexture,zr=cn||_.options.rotating||_.options.zooming||bt.kind==="composite"||bt.kind==="camera"?H.LINEAR:H.NEAREST);else{const Ft=l.layout.get("icon-size").constantOr(0)!==1||lt.iconsNeedLinear;zi=We.imageAtlasTexture,dn=Qe||_.options.rotating||_.options.zooming||Ft||cn?H.LINEAR:H.NEAREST,lr=We.imageAtlasTexture.size}const br=Dt(We,1,_.transform.zoom),rs=ye?Ze.posMatrix:sl,da=Os(rs,ue,ae,_.transform,br),zu=Qi(rs,ue,ae,_.transform,br),fa=Qi(Ze.posMatrix,ue,ae,_.transform,br),fi=ie.translatePosition(_.transform,We,y,w),Du=je&&lt.hasTextData(),Nh=l.layout.get("icon-text-fit")!=="none"&&Du&&lt.hasIconData();if(de){const Ft=_.style.map.terrain?(pa,ma)=>_.style.map.terrain.getElevation(Ze,pa,ma):null,wo=l.layout.get("text-rotation-alignment")==="map";Z(lt,Ze.posMatrix,_,m,da,fa,ue,A,wo,ie,Ze.toUnwrapped(),Y.width,Y.height,fi,Ft)}const pi=Ze.posMatrix,mi=m&&je||Nh,js=de||mi?sl:da,Di=zu,er=Qe&&l.paint.get(m?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let cr;cr=Qe?lt.iconsInText?rh(bt.kind,Rt,ee,ue,de,mi,_,pi,js,Di,fi,lr,xr,nt):nl(bt.kind,Rt,ee,ue,de,mi,_,pi,js,Di,fi,m,lr,!0,nt):Ff(bt.kind,Rt,ee,ue,de,mi,_,pi,js,Di,fi,m,lr,nt);const Jr={program:It,buffers:St,uniformValues:cr,atlasTexture:zi,atlasTextureIcon:ur,atlasInterpolation:dn,atlasInterpolationIcon:zr,isSDF:Qe,hasHalo:er};if(ve&&lt.canOverlap){Te=!0;const Ft=St.segments.get();for(const wo of Ft)Ye.push({segments:new u.a0([wo]),sortKey:wo.sortKey,state:Jr,terrainData:hn})}else Ye.push({segments:St.segments,sortKey:0,state:Jr,terrainData:hn})}Te&&Ye.sort((Ze,We)=>Ze.sortKey-We.sortKey);for(const Ze of Ye){const We=Ze.state;if($.activeTexture.set(H.TEXTURE0),We.atlasTexture.bind(We.atlasInterpolation,H.CLAMP_TO_EDGE),We.atlasTextureIcon&&($.activeTexture.set(H.TEXTURE1),We.atlasTextureIcon&&We.atlasTextureIcon.bind(We.atlasInterpolationIcon,H.CLAMP_TO_EDGE)),We.isSDF){const lt=We.uniformValues;We.hasHalo&&(lt.u_is_halo=1,gh(We.buffers,Ze.segments,l,_,We.program,Re,L,F,lt,Ze.terrainData)),lt.u_is_halo=0}gh(We.buffers,Ze.segments,l,_,We.program,Re,L,F,We.uniformValues,Ze.terrainData)}}function gh(_,n,l,d,m,y,w,C,k,A){const L=d.context;m.draw(L,L.gl.TRIANGLES,y,w,C,Xt.disabled,k,A,l.id,_.layoutVertexBuffer,_.indexBuffer,n,l.paint,d.transform.zoom,_.programConfigurations.get(l.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function yh(_,n,l,d){const m=_.context,y=m.gl,w=tn.disabled,C=new bn([y.ONE,y.ONE],u.aM.transparent,[!0,!0,!0,!0]),k=n.getBucket(l);if(!k)return;const A=d.key;let L=l.heatmapFbos.get(A);L||(L=ol(m,n.tileSize,n.tileSize),l.heatmapFbos.set(A,L)),m.bindFramebuffer.set(L.framebuffer),m.viewport.set([0,0,n.tileSize,n.tileSize]),m.clear({color:u.aM.transparent});const F=k.programConfigurations.get(l.id),$=_.useProgram("heatmap",F),H=_.style.map.terrain.getTerrainData(d);$.draw(m,y.TRIANGLES,zt.disabled,w,C,Xt.disabled,Ar(d.posMatrix,n,_.transform.zoom,l.paint.get("heatmap-intensity")),H,l.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,l.paint,_.transform.zoom,F)}function _o(_,n,l){const d=_.context,m=d.gl;d.setColorMode(_.colorModeForRenderPass());const y=al(d,n),w=l.key,C=n.heatmapFbos.get(w);C&&(d.activeTexture.set(m.TEXTURE0),m.bindTexture(m.TEXTURE_2D,C.colorAttachment.get()),d.activeTexture.set(m.TEXTURE1),y.bind(m.LINEAR,m.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(d,m.TRIANGLES,zt.disabled,tn.disabled,_.colorModeForRenderPass(),Xt.disabled,su(_,n,0,1),null,n.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments,n.paint,_.transform.zoom),C.destroy(),n.heatmapFbos.delete(w))}function ol(_,n,l){var d,m;const y=_.gl,w=y.createTexture();y.bindTexture(y.TEXTURE_2D,w),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR);const C=(d=_.HALF_FLOAT)!==null&&d!==void 0?d:y.UNSIGNED_BYTE,k=(m=_.RGBA16F)!==null&&m!==void 0?m:y.RGBA;y.texImage2D(y.TEXTURE_2D,0,k,n,l,0,y.RGBA,C,null);const A=_.createFramebuffer(n,l,!1,!1);return A.colorAttachment.set(w),A}function al(_,n){return n.colorRampTexture||(n.colorRampTexture=new Ve(_,n.colorRamp,_.gl.RGBA)),n.colorRampTexture}function Jo(_,n,l,d,m){if(!l||!d||!d.imageAtlas)return;const y=d.imageAtlas.patternPositions;let w=y[l.to.toString()],C=y[l.from.toString()];if(!w&&C&&(w=C),!C&&w&&(C=w),!w||!C){const k=m.getPaintProperty(n);w=y[k],C=y[k]}w&&C&&_.setConstantPatternPositions(w,C)}function ll(_,n,l,d,m,y,w){const C=_.context.gl,k="fill-pattern",A=l.paint.get(k),L=A&&A.constantOr(1),F=l.getCrossfadeParameters();let $,H,Y,ie,ae;w?(H=L&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=C.LINES):(H=L?"fillPattern":"fill",$=C.TRIANGLES);const ue=A.constantOr(null);for(const de of d){const ee=n.getTile(de);if(L&&!ee.patternsLoaded())continue;const ye=ee.getBucket(l);if(!ye)continue;const ve=ye.programConfigurations.get(l.id),Te=_.useProgram(H,ve),Re=_.style.map.terrain&&_.style.map.terrain.getTerrainData(de);L&&(_.context.activeTexture.set(C.TEXTURE0),ee.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),ve.updatePaintBuffers(F)),Jo(ve,k,ue,ee,l);const je=Re?de:null,Ye=_.translatePosMatrix(je?je.posMatrix:de.posMatrix,ee,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));if(w){ie=ye.indexBuffer2,ae=ye.segments2;const nt=[C.drawingBufferWidth,C.drawingBufferHeight];Y=H==="fillOutlinePattern"&&L?zf(Ye,_,F,ee,nt):py(Ye,nt)}else ie=ye.indexBuffer,ae=ye.segments,Y=L?Af(Ye,_,F,ee):Ho(Ye);Te.draw(_.context,$,m,_.stencilModeForClipping(de),y,Xt.disabled,Y,Re,l.id,ye.layoutVertexBuffer,ie,ae,l.paint,_.transform.zoom,ve)}}function pu(_,n,l,d,m,y,w){const C=_.context,k=C.gl,A="fill-extrusion-pattern",L=l.paint.get(A),F=L.constantOr(1),$=l.getCrossfadeParameters(),H=l.paint.get("fill-extrusion-opacity"),Y=L.constantOr(null);for(const ie of d){const ae=n.getTile(ie),ue=ae.getBucket(l);if(!ue)continue;const de=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ie),ee=ue.programConfigurations.get(l.id),ye=_.useProgram(F?"fillExtrusionPattern":"fillExtrusion",ee);F&&(_.context.activeTexture.set(k.TEXTURE0),ae.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ee.updatePaintBuffers($)),Jo(ee,A,Y,ae,l);const ve=_.translatePosMatrix(ie.posMatrix,ae,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Te=l.paint.get("fill-extrusion-vertical-gradient"),Re=F?iu(ve,_,Te,H,ie,$,ae):el(ve,_,Te,H);ye.draw(C,C.gl.TRIANGLES,m,y,w,Xt.backCCW,Re,de,l.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,l.paint,_.transform.zoom,ee,_.style.map.terrain&&ue.centroidVertexBuffer)}}function Qo(_,n,l,d,m,y,w){const C=_.context,k=C.gl,A=l.fbo;if(!A)return;const L=_.useProgram("hillshade"),F=_.style.map.terrain&&_.style.map.terrain.getTerrainData(n);C.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,A.colorAttachment.get()),L.draw(C,k.TRIANGLES,m,y,w,Xt.disabled,(($,H,Y,ie)=>{const ae=Y.paint.get("hillshade-shadow-color"),ue=Y.paint.get("hillshade-highlight-color"),de=Y.paint.get("hillshade-accent-color");let ee=Y.paint.get("hillshade-illumination-direction")*(Math.PI/180);Y.paint.get("hillshade-illumination-anchor")==="viewport"&&(ee-=$.transform.angle);const ye=!$.options.moving;return{u_matrix:ie?ie.posMatrix:$.transform.calculatePosMatrix(H.tileID.toUnwrapped(),ye),u_image:0,u_latrange:ou(0,H.tileID),u_light:[Y.paint.get("hillshade-exaggeration"),ee],u_shadow:ae,u_highlight:ue,u_accent:de}})(_,l,d,F?n:null),F,d.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}function ea(_,n,l,d,m,y){const w=_.context,C=w.gl,k=n.dem;if(k&&k.data){const A=k.dim,L=k.stride,F=k.getPixels();if(w.activeTexture.set(C.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||_.getTileTexture(L),n.demTexture){const H=n.demTexture;H.update(F,{premultiply:!1}),H.bind(C.NEAREST,C.CLAMP_TO_EDGE)}else n.demTexture=new Ve(w,F,C.RGBA,{premultiply:!1}),n.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);w.activeTexture.set(C.TEXTURE0);let $=n.fbo;if(!$){const H=new Ve(w,{width:A,height:A,data:null},C.RGBA);H.bind(C.LINEAR,C.CLAMP_TO_EDGE),$=n.fbo=w.createFramebuffer(A,A,!0,!1),$.colorAttachment.set(H.texture)}w.bindFramebuffer.set($.framebuffer),w.viewport.set([0,0,A,A]),_.useProgram("hillshadePrepare").draw(w,C.TRIANGLES,d,m,y,Xt.disabled,((H,Y)=>{const ie=Y.stride,ae=u.H();return u.aP(ae,0,u.X,-u.X,0,0,1),u.J(ae,ae,[0,-u.X,0]),{u_matrix:ae,u_image:1,u_dimension:[ie,ie],u_zoom:H.overscaledZ,u_unpack:Y.getUnpackVector()}})(n.tileID,k),null,l.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function Xf(_,n,l,d,m,y){const w=d.paint.get("raster-fade-duration");if(!y&&w>0){const C=z.now(),k=(C-_.timeAdded)/w,A=n?(C-n.timeAdded)/w:-1,L=l.getSource(),F=m.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),$=!n||Math.abs(n.tileID.overscaledZ-F)>Math.abs(_.tileID.overscaledZ-F),H=$&&_.refreshedUponExpiration?1:u.ac($?k:1-A,0,1);return _.refreshedUponExpiration&&k>=1&&(_.refreshedUponExpiration=!1),n?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}const _h=new u.aM(1,0,0,1),$t=new u.aM(0,1,0,1),mu=new u.aM(0,0,1,1),Iy=new u.aM(1,0,1,1),Kf=new u.aM(0,1,1,1);function ta(_,n,l,d){gu(_,0,n+l/2,_.transform.width,l,d)}function Yf(_,n,l,d){gu(_,n-l/2,0,l,_.transform.height,d)}function gu(_,n,l,d,m,y){const w=_.context,C=w.gl;C.enable(C.SCISSOR_TEST),C.scissor(n*_.pixelRatio,l*_.pixelRatio,d*_.pixelRatio,m*_.pixelRatio),w.clear({color:y}),C.disable(C.SCISSOR_TEST)}function Jf(_,n,l){const d=_.context,m=d.gl,y=l.posMatrix,w=_.useProgram("debug"),C=zt.disabled,k=tn.disabled,A=_.colorModeForRenderPass(),L="$debug",F=_.style.map.terrain&&_.style.map.terrain.getTerrainData(l);d.activeTexture.set(m.TEXTURE0);const $=n.getTileByID(l.key).latestRawTileData,H=Math.floor(($&&$.byteLength||0)/1024),Y=n.getTile(l).tileSize,ie=512/Math.min(Y,512)*(l.overscaledZ/_.transform.zoom)*.5;let ae=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(ae+=` => ${l.overscaledZ}`),function(ue,de){ue.initDebugOverlayCanvas();const ee=ue.debugOverlayCanvas,ye=ue.context.gl,ve=ue.debugOverlayCanvas.getContext("2d");ve.clearRect(0,0,ee.width,ee.height),ve.shadowColor="white",ve.shadowBlur=2,ve.lineWidth=1.5,ve.strokeStyle="white",ve.textBaseline="top",ve.font="bold 36px Open Sans, sans-serif",ve.fillText(de,5,5),ve.strokeText(de,5,5),ue.debugOverlayTexture.update(ee),ue.debugOverlayTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE)}(_,`${ae} ${H}kB`),w.draw(d,m.TRIANGLES,C,k,bn.alphaBlended,Xt.disabled,tl(y,u.aM.transparent,ie),null,L,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments),w.draw(d,m.LINE_STRIP,C,k,A,Xt.disabled,tl(y,u.aM.red),F,L,_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments)}function Qf(_,n,l){const d=_.context,m=d.gl,y=_.colorModeForRenderPass(),w=new zt(m.LEQUAL,zt.ReadWrite,_.depthRangeFor3D),C=_.useProgram("terrain"),k=n.getTerrainMesh();d.bindFramebuffer.set(null),d.viewport.set([0,0,_.width,_.height]);for(const A of l){const L=_.renderToTexture.getTexture(A),F=n.getTerrainData(A.tileID);d.activeTexture.set(m.TEXTURE0),m.bindTexture(m.TEXTURE_2D,L.texture);const $=_.transform.calculatePosMatrix(A.tileID.toUnwrapped()),H=n.getMeshFrameDelta(_.transform.zoom),Y=_.transform.calculateFogMatrix(A.tileID.toUnwrapped()),ie=th($,H,Y,_.style.sky,_.transform.pitch);C.draw(d,m.TRIANGLES,w,tn.disabled,y,Xt.backCCW,ie,F,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}class yu{constructor(n,l,d){this.vertexBuffer=n,this.indexBuffer=l,this.segments=d}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class _u{constructor(n,l){this.context=new Ey(n),this.transform=l,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=vt.maxUnderzooming+vt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Qc}resize(n,l,d){if(this.width=Math.floor(n*d),this.height=Math.floor(l*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style._order)this.style._layers[m].resize()}setup(){const n=this.context,l=new u.aX;l.emplaceBack(0,0),l.emplaceBack(u.X,0),l.emplaceBack(0,u.X),l.emplaceBack(u.X,u.X),this.tileExtentBuffer=n.createVertexBuffer(l,co.members),this.tileExtentSegments=u.a0.simpleSegment(0,0,4,2);const d=new u.aX;d.emplaceBack(0,0),d.emplaceBack(u.X,0),d.emplaceBack(0,u.X),d.emplaceBack(u.X,u.X),this.debugBuffer=n.createVertexBuffer(d,co.members),this.debugSegments=u.a0.simpleSegment(0,0,4,5);const m=new u.$;m.emplaceBack(0,0,0,0),m.emplaceBack(u.X,0,u.X,0),m.emplaceBack(0,u.X,0,u.X),m.emplaceBack(u.X,u.X,u.X,u.X),this.rasterBoundsBuffer=n.createVertexBuffer(m,Tt.members),this.rasterBoundsSegments=u.a0.simpleSegment(0,0,4,2);const y=new u.aX;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(y,co.members),this.viewportSegments=u.a0.simpleSegment(0,0,4,2);const w=new u.aZ;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);const C=new u.aY;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(C);const k=this.context.gl;this.stencilClearMode=new tn({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){const n=this.context,l=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=u.H();u.aP(d,0,this.width,this.height,0,0,1),u.K(d,d,[l.drawingBufferWidth,l.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,l.TRIANGLES,zt.disabled,this.stencilClearMode,bn.disabled,Xt.disabled,Mr(d),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,l){if(this.currentStencilSource===n.source||!n.isTileClipped()||!l||!l.length)return;this.currentStencilSource=n.source;const d=this.context,m=d.gl;this.nextStencilID+l.length>256&&this.clearStencil(),d.setColorMode(bn.disabled),d.setDepthMode(zt.disabled);const y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of l){const C=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(w);y.draw(d,m.TRIANGLES,zt.disabled,new tn({func:m.ALWAYS,mask:0},C,255,m.KEEP,m.KEEP,m.REPLACE),bn.disabled,Xt.disabled,Mr(w.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,l=this.context.gl;return new tn({func:l.NOTEQUAL,mask:255},n,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(n){const l=this.context.gl;return new tn({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(n){const l=this.context.gl,d=n.sort((w,C)=>C.overscaledZ-w.overscaledZ),m=d[d.length-1].overscaledZ,y=d[0].overscaledZ-m+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const w={};for(let C=0;C<y;C++)w[C+m]=new tn({func:l.GEQUAL,mask:255},C+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=y,[w,d]}return[{[m]:tn.disabled},d]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new bn([n.CONSTANT_COLOR,n.ONE],new u.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?bn.unblended:bn.alphaBlended}depthModeForSublayer(n,l,d){if(!this.opaquePassEnabledForLayer())return zt.disabled;const m=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new zt(d||this.context.gl.LEQUAL,l,[m,m])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,l){this.style=n,this.options=l,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(z.now()),this.imageManager.beginFrame();const d=this.style._order,m=this.style.sourceCaches,y={},w={},C={};for(const k in m){const A=m[k];A.used&&A.prepare(this.context),y[k]=A.getVisibleCoordinates(),w[k]=y[k].slice().reverse(),C[k]=A.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<d.length;k++)if(this.style._layers[d[k]].is3D()){this.opaquePassCutoff=k;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const k of d){const A=this.style._layers[k];if(!A.hasOffscreenPass()||A.isHidden(this.transform.zoom))continue;const L=w[A.source];(A.type==="custom"||L.length)&&this.renderLayer(this,m[A.source],A,L)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:l.showOverdrawInspector?u.aM.black:u.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(k,A){const L=k.context,F=L.gl,$=((ue,de,ee)=>({u_sky_color:ue.properties.get("sky-color"),u_horizon_color:ue.properties.get("horizon-color"),u_horizon:(de.height/2+de.getHorizon())*ee,u_sky_horizon_blend:ue.properties.get("sky-horizon-blend")*de.height/2*ee}))(A,k.style.map.transform,k.pixelRatio),H=new zt(F.LEQUAL,zt.ReadWrite,[0,1]),Y=tn.disabled,ie=k.colorModeForRenderPass(),ae=k.useProgram("sky");if(!A.mesh){const ue=new u.aX;ue.emplaceBack(-1,-1),ue.emplaceBack(1,-1),ue.emplaceBack(1,1),ue.emplaceBack(-1,1);const de=new u.aY;de.emplaceBack(0,1,2),de.emplaceBack(0,2,3),A.mesh=new yu(L.createVertexBuffer(ue,co.members),L.createIndexBuffer(de),u.a0.simpleSegment(0,0,ue.length,de.length))}ae.draw(L,F.TRIANGLES,H,Y,ie,Xt.disabled,$,void 0,"sky",A.mesh.vertexBuffer,A.mesh.indexBuffer,A.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=l.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[d[this.currentLayer]],A=m[k.source],L=y[k.source];this._renderTileClippingMasks(k,L),this.renderLayer(this,A,k,L)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){const k=this.style._layers[d[this.currentLayer]],A=m[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k))continue;const L=(k.type==="symbol"?C:w)[k.source];this._renderTileClippingMasks(k,y[k.source]),this.renderLayer(this,A,k,L)}if(this.options.showTileBoundaries){const k=function(A,L){let F=null;const $=Object.values(A._layers).flatMap(ae=>ae.source&&!ae.isHidden(L)?[A.sourceCaches[ae.source]]:[]),H=$.filter(ae=>ae.getSource().type==="vector"),Y=$.filter(ae=>ae.getSource().type!=="vector"),ie=ae=>{(!F||F.getSource().maxzoom<ae.getSource().maxzoom)&&(F=ae)};return H.forEach(ae=>ie(ae)),F||Y.forEach(ae=>ie(ae)),F}(this.style,this.transform.zoom);k&&function(A,L,F){for(let $=0;$<F.length;$++)Jf(A,L,F[$])}(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const A=k.transform.padding;ta(k,k.transform.height-(A.top||0),3,_h),ta(k,A.bottom||0,3,$t),Yf(k,A.left||0,3,mu),Yf(k,k.transform.width-(A.right||0),3,Iy);const L=k.transform.centerPoint;(function(F,$,H,Y){gu(F,$-1,H-10,2,20,Y),gu(F,$-10,H-1,20,2,Y)})(k,L.x,k.transform.height-L.y,Kf)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;const l=this.terrainFacilitator.matrix,d=this.transform.modelViewProjectionMatrix;let m=this.terrainFacilitator.dirty;m||(m=n?!u.a_(l,d):!u.a$(l,d)),m||(m=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),m&&(u.b0(l,d),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(y,w){const C=y.context,k=C.gl,A=bn.unblended,L=new zt(k.LEQUAL,zt.ReadWrite,[0,1]),F=w.getTerrainMesh(),$=w.sourceCache.getRenderableTiles(),H=y.useProgram("terrainDepth");C.bindFramebuffer.set(w.getFramebuffer("depth").framebuffer),C.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),C.clear({color:u.aM.transparent,depth:1});for(const Y of $){const ie=w.getTerrainData(Y.tileID),ae={u_matrix:y.transform.calculatePosMatrix(Y.tileID.toUnwrapped()),u_ele_delta:w.getMeshFrameDelta(y.transform.zoom)};H.draw(C,k.TRIANGLES,L,tn.disabled,A,Xt.backCCW,ae,ie,"terrain",F.vertexBuffer,F.indexBuffer,F.segments)}C.bindFramebuffer.set(null),C.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain),function(y,w){const C=y.context,k=C.gl,A=bn.unblended,L=new zt(k.LEQUAL,zt.ReadWrite,[0,1]),F=w.getTerrainMesh(),$=w.getCoordsTexture(),H=w.sourceCache.getRenderableTiles(),Y=y.useProgram("terrainCoords");C.bindFramebuffer.set(w.getFramebuffer("coords").framebuffer),C.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),C.clear({color:u.aM.transparent,depth:1}),w.coordsIndex=[];for(const ie of H){const ae=w.getTerrainData(ie.tileID);C.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,$.texture);const ue={u_matrix:y.transform.calculatePosMatrix(ie.tileID.toUnwrapped()),u_terrain_coords_id:(255-w.coordsIndex.length)/255,u_texture:0,u_ele_delta:w.getMeshFrameDelta(y.transform.zoom)};Y.draw(C,k.TRIANGLES,L,tn.disabled,A,Xt.backCCW,ue,ae,"terrain",F.vertexBuffer,F.indexBuffer,F.segments),w.coordsIndex.push(ie.tileID.key)}C.bindFramebuffer.set(null),C.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain))}renderLayer(n,l,d,m){if(!d.isHidden(this.transform.zoom)&&(d.type==="background"||d.type==="custom"||(m||[]).length))switch(this.id=d.id,d.type){case"symbol":(function(y,w,C,k,A){if(y.renderPass!=="translucent")return;const L=tn.disabled,F=y.colorModeForRenderPass();(C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function($,H,Y,ie,ae,ue,de,ee,ye){const ve=H.transform,Te=uo(),Re=ae==="map",je=ue==="map";for(const Ye of $){const nt=ie.getTile(Ye),Ze=nt.getBucket(Y);if(!Ze||!Ze.text||!Ze.text.segments.get().length)continue;const We=u.ag(Ze.textSizeData,ve.zoom),lt=Dt(nt,1,H.transform.zoom),St=Os(Ye.posMatrix,je,Re,H.transform,lt),Xe=Y.layout.get("icon-text-fit")!=="none"&&Ze.hasIconData();if(We){const Qe=Math.pow(2,ve.zoom-nt.tileID.overscaledZ),bt=H.style.map.terrain?(It,Rt)=>H.style.map.terrain.getElevation(Ye,It,Rt):null,cn=Te.translatePosition(ve,nt,de,ee);Yo(Ze,Re,je,ye,ve,St,Ye.posMatrix,Qe,We,Xe,Te,cn,Ye.toUnwrapped(),bt)}}}(k,y,C,w,C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),A),C.paint.get("icon-opacity").constantOr(1)!==0&&mh(y,w,C,k,!1,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),C.layout.get("icon-rotation-alignment"),C.layout.get("icon-pitch-alignment"),C.layout.get("icon-keep-upright"),L,F),C.paint.get("text-opacity").constantOr(1)!==0&&mh(y,w,C,k,!0,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.layout.get("text-keep-upright"),L,F),w.map.showCollisionBoxes&&(il(y,w,C,k,!0),il(y,w,C,k,!1))})(n,l,d,m,this.style.placement.variableOffsets);break;case"circle":(function(y,w,C,k){if(y.renderPass!=="translucent")return;const A=C.paint.get("circle-opacity"),L=C.paint.get("circle-stroke-width"),F=C.paint.get("circle-stroke-opacity"),$=!C.layout.get("circle-sort-key").isConstant();if(A.constantOr(1)===0&&(L.constantOr(1)===0||F.constantOr(1)===0))return;const H=y.context,Y=H.gl,ie=y.depthModeForSublayer(0,zt.ReadOnly),ae=tn.disabled,ue=y.colorModeForRenderPass(),de=[];for(let ee=0;ee<k.length;ee++){const ye=k[ee],ve=w.getTile(ye),Te=ve.getBucket(C);if(!Te)continue;const Re=Te.programConfigurations.get(C.id),je=y.useProgram("circle",Re),Ye=Te.layoutVertexBuffer,nt=Te.indexBuffer,Ze=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ye),We={programConfiguration:Re,program:je,layoutVertexBuffer:Ye,indexBuffer:nt,uniformValues:my(y,ye,ve,C),terrainData:Ze};if($){const lt=Te.segments.get();for(const St of lt)de.push({segments:new u.a0([St]),sortKey:St.sortKey,state:We})}else de.push({segments:Te.segments,sortKey:0,state:We})}$&&de.sort((ee,ye)=>ee.sortKey-ye.sortKey);for(const ee of de){const{programConfiguration:ye,program:ve,layoutVertexBuffer:Te,indexBuffer:Re,uniformValues:je,terrainData:Ye}=ee.state;ve.draw(H,Y.TRIANGLES,ie,ae,ue,Xt.disabled,je,Ye,C.id,Te,Re,ee.segments,C.paint,y.transform.zoom,ye)}})(n,l,d,m);break;case"heatmap":(function(y,w,C,k){if(C.paint.get("heatmap-opacity")===0)return;const A=y.context;if(y.style.map.terrain){for(const L of k){const F=w.getTile(L);w.hasRenderableParent(L)||(y.renderPass==="offscreen"?yh(y,F,C,L):y.renderPass==="translucent"&&_o(y,C,L))}A.viewport.set([0,0,y.width,y.height])}else y.renderPass==="offscreen"?function(L,F,$,H){const Y=L.context,ie=Y.gl,ae=tn.disabled,ue=new bn([ie.ONE,ie.ONE],u.aM.transparent,[!0,!0,!0,!0]);(function(de,ee,ye){const ve=de.gl;de.activeTexture.set(ve.TEXTURE1),de.viewport.set([0,0,ee.width/4,ee.height/4]);let Te=ye.heatmapFbos.get(u.aU);Te?(ve.bindTexture(ve.TEXTURE_2D,Te.colorAttachment.get()),de.bindFramebuffer.set(Te.framebuffer)):(Te=ol(de,ee.width/4,ee.height/4),ye.heatmapFbos.set(u.aU,Te))})(Y,L,$),Y.clear({color:u.aM.transparent});for(let de=0;de<H.length;de++){const ee=H[de];if(F.hasRenderableParent(ee))continue;const ye=F.getTile(ee),ve=ye.getBucket($);if(!ve)continue;const Te=ve.programConfigurations.get($.id),Re=L.useProgram("heatmap",Te),{zoom:je}=L.transform;Re.draw(Y,ie.TRIANGLES,zt.disabled,ae,ue,Xt.disabled,Ar(ee.posMatrix,ye,je,$.paint.get("heatmap-intensity")),null,$.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,$.paint,L.transform.zoom,Te)}Y.viewport.set([0,0,L.width,L.height])}(y,w,C,k):y.renderPass==="translucent"&&function(L,F){const $=L.context,H=$.gl;$.setColorMode(L.colorModeForRenderPass());const Y=F.heatmapFbos.get(u.aU);Y&&($.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,Y.colorAttachment.get()),$.activeTexture.set(H.TEXTURE1),al($,F).bind(H.LINEAR,H.CLAMP_TO_EDGE),L.useProgram("heatmapTexture").draw($,H.TRIANGLES,zt.disabled,tn.disabled,L.colorModeForRenderPass(),Xt.disabled,su(L,F,0,1),null,F.id,L.viewportBuffer,L.quadTriangleIndexBuffer,L.viewportSegments,F.paint,L.transform.zoom))}(y,C)})(n,l,d,m);break;case"line":(function(y,w,C,k){if(y.renderPass!=="translucent")return;const A=C.paint.get("line-opacity"),L=C.paint.get("line-width");if(A.constantOr(1)===0||L.constantOr(1)===0)return;const F=y.depthModeForSublayer(0,zt.ReadOnly),$=y.colorModeForRenderPass(),H=C.paint.get("line-dasharray"),Y=C.paint.get("line-pattern"),ie=Y.constantOr(1),ae=C.paint.get("line-gradient"),ue=C.getCrossfadeParameters(),de=ie?"linePattern":H?"lineSDF":ae?"lineGradient":"line",ee=y.context,ye=ee.gl;let ve=!0;for(const Te of k){const Re=w.getTile(Te);if(ie&&!Re.patternsLoaded())continue;const je=Re.getBucket(C);if(!je)continue;const Ye=je.programConfigurations.get(C.id),nt=y.context.program.get(),Ze=y.useProgram(de,Ye),We=ve||Ze.program!==nt,lt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Te),St=Y.constantOr(null);if(St&&Re.imageAtlas){const bt=Re.imageAtlas,cn=bt.patternPositions[St.to.toString()],It=bt.patternPositions[St.from.toString()];cn&&It&&Ye.setConstantPatternPositions(cn,It)}const Xe=lt?Te:null,Qe=ie?Xo(y,Re,C,ue,Xe):H?gy(y,Re,C,H,ue,Xe):ae?Df(y,Re,C,je.lineClipsArray.length,Xe):au(y,Re,C,Xe);if(ie)ee.activeTexture.set(ye.TEXTURE0),Re.imageAtlasTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),Ye.updatePaintBuffers(ue);else if(H&&(We||y.lineAtlas.dirty))ee.activeTexture.set(ye.TEXTURE0),y.lineAtlas.bind(ee);else if(ae){const bt=je.gradients[C.id];let cn=bt.texture;if(C.gradientVersion!==bt.version){let It=256;if(C.stepInterpolant){const Rt=w.getSource().maxzoom,hn=Te.canonical.z===Rt?Math.ceil(1<<y.transform.maxZoom-Te.canonical.z):1;It=u.ac(u.aV(je.maxLineLength/u.X*1024*hn),256,ee.maxTextureSize)}bt.gradient=u.aW({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:It,image:bt.gradient||void 0,clips:je.lineClipsArray}),bt.texture?bt.texture.update(bt.gradient):bt.texture=new Ve(ee,bt.gradient,ye.RGBA),bt.version=C.gradientVersion,cn=bt.texture}ee.activeTexture.set(ye.TEXTURE0),cn.bind(C.stepInterpolant?ye.NEAREST:ye.LINEAR,ye.CLAMP_TO_EDGE)}Ze.draw(ee,ye.TRIANGLES,F,y.stencilModeForClipping(Te),$,Xt.disabled,Qe,lt,C.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,C.paint,y.transform.zoom,Ye,je.layoutVertexBuffer2),ve=!1}})(n,l,d,m);break;case"fill":(function(y,w,C,k){const A=C.paint.get("fill-color"),L=C.paint.get("fill-opacity");if(L.constantOr(1)===0)return;const F=y.colorModeForRenderPass(),$=C.paint.get("fill-pattern"),H=y.opaquePassEnabledForLayer()&&!$.constantOr(1)&&A.constantOr(u.aM.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===H){const Y=y.depthModeForSublayer(1,y.renderPass==="opaque"?zt.ReadWrite:zt.ReadOnly);ll(y,w,C,k,Y,F,!1)}if(y.renderPass==="translucent"&&C.paint.get("fill-antialias")){const Y=y.depthModeForSublayer(C.getPaintProperty("fill-outline-color")?2:0,zt.ReadOnly);ll(y,w,C,k,Y,F,!0)}})(n,l,d,m);break;case"fill-extrusion":(function(y,w,C,k){const A=C.paint.get("fill-extrusion-opacity");if(A!==0&&y.renderPass==="translucent"){const L=new zt(y.context.gl.LEQUAL,zt.ReadWrite,y.depthRangeFor3D);if(A!==1||C.paint.get("fill-extrusion-pattern").constantOr(1))pu(y,w,C,k,L,tn.disabled,bn.disabled),pu(y,w,C,k,L,y.stencilModeFor3D(),y.colorModeForRenderPass());else{const F=y.colorModeForRenderPass();pu(y,w,C,k,L,tn.disabled,F)}}})(n,l,d,m);break;case"hillshade":(function(y,w,C,k){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const A=y.context,L=y.depthModeForSublayer(0,zt.ReadOnly),F=y.colorModeForRenderPass(),[$,H]=y.renderPass==="translucent"?y.stencilConfigForOverlap(k):[{},k];for(const Y of H){const ie=w.getTile(Y);ie.needsHillshadePrepare!==void 0&&ie.needsHillshadePrepare&&y.renderPass==="offscreen"?ea(y,ie,C,L,tn.disabled,F):y.renderPass==="translucent"&&Qo(y,Y,ie,C,L,$[Y.overscaledZ],F)}A.viewport.set([0,0,y.width,y.height])})(n,l,d,m);break;case"raster":(function(y,w,C,k){if(y.renderPass!=="translucent"||C.paint.get("raster-opacity")===0||!k.length)return;const A=y.context,L=A.gl,F=w.getSource(),$=y.useProgram("raster"),H=y.colorModeForRenderPass(),[Y,ie]=F instanceof bs?[{},k]:y.stencilConfigForOverlap(k),ae=ie[ie.length-1].overscaledZ,ue=!y.options.moving;for(const de of ie){const ee=y.depthModeForSublayer(de.overscaledZ-ae,C.paint.get("raster-opacity")===1?zt.ReadWrite:zt.ReadOnly,L.LESS),ye=w.getTile(de);ye.registerFadeDuration(C.paint.get("raster-fade-duration"));const ve=w.findLoadedParent(de,0),Te=w.findLoadedSibling(de),Re=Xf(ye,ve||Te||null,w,C,y.transform,y.style.map.terrain);let je,Ye;const nt=C.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;A.activeTexture.set(L.TEXTURE0),ye.texture.bind(nt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),A.activeTexture.set(L.TEXTURE1),ve?(ve.texture.bind(nt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),je=Math.pow(2,ve.tileID.overscaledZ-ye.tileID.overscaledZ),Ye=[ye.tileID.canonical.x*je%1,ye.tileID.canonical.y*je%1]):ye.texture.bind(nt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),ye.texture.useMipmap&&A.extTextureFilterAnisotropic&&y.transform.pitch>20&&L.texParameterf(L.TEXTURE_2D,A.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,A.extTextureFilterAnisotropicMax);const Ze=y.style.map.terrain&&y.style.map.terrain.getTerrainData(de),We=Ze?de:null,lt=We?We.posMatrix:y.transform.calculatePosMatrix(de.toUnwrapped(),ue),St=yy(lt,Ye||[0,0],je||1,Re,C);F instanceof bs?$.draw(A,L.TRIANGLES,ee,tn.disabled,H,Xt.disabled,St,Ze,C.id,F.boundsBuffer,y.quadTriangleIndexBuffer,F.boundsSegments):$.draw(A,L.TRIANGLES,ee,Y[de.overscaledZ],H,Xt.disabled,St,Ze,C.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}})(n,l,d,m);break;case"background":(function(y,w,C,k){const A=C.paint.get("background-color"),L=C.paint.get("background-opacity");if(L===0)return;const F=y.context,$=F.gl,H=y.transform,Y=H.tileSize,ie=C.paint.get("background-pattern");if(y.isPatternMissing(ie))return;const ae=!ie&&A.a===1&&L===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==ae)return;const ue=tn.disabled,de=y.depthModeForSublayer(0,ae==="opaque"?zt.ReadWrite:zt.ReadOnly),ee=y.colorModeForRenderPass(),ye=y.useProgram(ie?"backgroundPattern":"background"),ve=k||H.coveringTiles({tileSize:Y,terrain:y.style.map.terrain});ie&&(F.activeTexture.set($.TEXTURE0),y.imageManager.bind(y.context));const Te=C.getCrossfadeParameters();for(const Re of ve){const je=k?Re.posMatrix:y.transform.calculatePosMatrix(Re.toUnwrapped()),Ye=ie?ih(je,L,y,ie,{tileID:Re,tileSize:Y},Te):lu(je,L,A),nt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Re);ye.draw(F,$.TRIANGLES,de,ue,ee,Xt.disabled,Ye,nt,C.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}})(n,0,d,m);break;case"custom":(function(y,w,C){const k=y.context,A=C.implementation;if(y.renderPass==="offscreen"){const L=A.prerender;L&&(y.setCustomLayerDefaults(),k.setColorMode(y.colorModeForRenderPass()),L.call(A,k.gl,y.transform.customLayerMatrix()),k.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),k.setColorMode(y.colorModeForRenderPass()),k.setStencilMode(tn.disabled);const L=A.renderingMode==="3d"?new zt(y.context.gl.LEQUAL,zt.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,zt.ReadOnly);k.setDepthMode(L),A.render(k.gl,y.transform.customLayerMatrix(),{farZ:y.transform.farZ,nearZ:y.transform.nearZ,fov:y.transform._fov,modelViewProjectionMatrix:y.transform.modelViewProjectionMatrix,projectionMatrix:y.transform.projectionMatrix}),k.setDirty(),y.setBaseState(),k.bindFramebuffer.set(null)}})(n,0,d)}}translatePosMatrix(n,l,d,m,y){if(!d[0]&&!d[1])return n;const w=y?m==="map"?this.transform.angle:0:m==="viewport"?-this.transform.angle:0;if(w){const A=Math.sin(w),L=Math.cos(w);d=[d[0]*L-d[1]*A,d[0]*A+d[1]*L]}const C=[y?d[0]:Dt(l,d[0],this.transform.zoom),y?d[1]:Dt(l,d[1],this.transform.zoom),0],k=new Float32Array(16);return u.J(k,n,C),k}saveTileTexture(n){const l=this._tileTextures[n.size[0]];l?l.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const l=this._tileTextures[n];return l&&l.length>0?l.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const l=this.imageManager.getPattern(n.from.toString()),d=this.imageManager.getPattern(n.to.toString());return!l||!d}useProgram(n,l){this.cache=this.cache||{};const d=n+(l?l.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[d]||(this.cache[d]=new nh(this.context,Vs[n],l,sh[n],this._showOverdrawInspector,this.style.map.terrain)),this.cache[d]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ve(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:l}=this.context.gl;return this.width!==n||this.height!==l}}class na{constructor(n,l){this.points=n,this.planes=l}static fromInvProjectionMatrix(n,l,d){const m=Math.pow(2,d),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const k=1/(C=u.af([],C,n))[3]/l*m;return u.b1(C,C,[k,k,1/C[3],k])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const k=function($,H){var Y=H[0],ie=H[1],ae=H[2],ue=Y*Y+ie*ie+ae*ae;return ue>0&&(ue=1/Math.sqrt(ue)),$[0]=H[0]*ue,$[1]=H[1]*ue,$[2]=H[2]*ue,$}([],function($,H,Y){var ie=H[0],ae=H[1],ue=H[2],de=Y[0],ee=Y[1],ye=Y[2];return $[0]=ae*ye-ue*ee,$[1]=ue*de-ie*ye,$[2]=ie*ee-ae*de,$}([],we([],y[C[0]],y[C[1]]),we([],y[C[2]],y[C[1]]))),A=-((L=k)[0]*(F=y[C[1]])[0]+L[1]*F[1]+L[2]*F[2]);var L,F;return k.concat(A)});return new na(y,w)}}class ra{constructor(n,l){this.min=n,this.max=l,this.center=function(d,m,y){return d[0]=.5*m[0],d[1]=.5*m[1],d[2]=.5*m[2],d}([],function(d,m,y){return d[0]=m[0]+y[0],d[1]=m[1]+y[1],d[2]=m[2]+y[2],d}([],this.min,this.max))}quadrant(n){const l=[n%2==0,n<2],d=ge(this.min),m=ge(this.max);for(let y=0;y<l.length;y++)d[y]=l[y]?this.min[y]:this.center[y],m[y]=l[y]?this.center[y]:this.max[y];return m[2]=this.max[2],new ra(d,m)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersects(n){const l=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let d=!0;for(let m=0;m<n.planes.length;m++){const y=n.planes[m];let w=0;for(let C=0;C<l.length;C++)u.b2(y,l[C])>=0&&w++;if(w===0)return 0;w!==l.length&&(d=!1)}if(d)return 2;for(let m=0;m<3;m++){let y=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let C=0;C<n.points.length;C++){const k=n.points[C][m]-this.min[m];y=Math.min(y,k),w=Math.max(w,k)}if(w<0||y>this.max[m]-this.min[m])return 0}return 1}}class ia{constructor(n=0,l=0,d=0,m=0){if(isNaN(n)||n<0||isNaN(l)||l<0||isNaN(d)||d<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=l,this.left=d,this.right=m}interpolate(n,l,d){return l.top!=null&&n.top!=null&&(this.top=u.y.number(n.top,l.top,d)),l.bottom!=null&&n.bottom!=null&&(this.bottom=u.y.number(n.bottom,l.bottom,d)),l.left!=null&&n.left!=null&&(this.left=u.y.number(n.left,l.left,d)),l.right!=null&&n.right!=null&&(this.right=u.y.number(n.right,l.right,d)),this}getCenter(n,l){const d=u.ac((this.left+n-this.right)/2,0,n),m=u.ac((this.top+l-this.bottom)/2,0,l);return new u.P(d,m)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new ia(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const vh=85.051129;class sa{constructor(n,l,d,m,y){this.tileSize=512,this._renderWorldCopies=y===void 0||!!y,this._minZoom=n||0,this._maxZoom=l||22,this._minPitch=d??0,this._maxPitch=m??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ia,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const n=new sa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.apply(this),n}apply(n){this.tileSize=n.tileSize,this.latRange=n.latRange,this.lngRange=n.lngRange,this.width=n.width,this.height=n.height,this._center=n._center,this._elevation=n._elevation,this.minElevationForCurrentTile=n.minElevationForCurrentTile,this.zoom=n.zoom,this.angle=n.angle,this._fov=n._fov,this._pitch=n._pitch,this._unmodified=n._unmodified,this._edgeInsets=n._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(n){const l=-u.b3(n,-180,180)*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=function(){var d=new u.A(4);return u.A!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d}(),function(d,m,y){var w=m[0],C=m[1],k=m[2],A=m[3],L=Math.sin(y),F=Math.cos(y);d[0]=w*F+k*L,d[1]=C*F+A*L,d[2]=w*-L+k*F,d[3]=C*-L+A*F}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const l=u.ac(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(n){const l=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._zoom=l,this.tileZoom=Math.max(0,Math.floor(l)),this.scale=this.zoomScale(l),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,l,d){this._unmodified=!1,this._edgeInsets.interpolate(n,l,d),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const l=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(n){const l=[new u.b4(0,n)];if(this._renderWorldCopies){const d=this.pointCoordinate(new u.P(0,0)),m=this.pointCoordinate(new u.P(this.width,0)),y=this.pointCoordinate(new u.P(this.width,this.height)),w=this.pointCoordinate(new u.P(0,this.height)),C=Math.floor(Math.min(d.x,m.x,y.x,w.x)),k=Math.floor(Math.max(d.x,m.x,y.x,w.x)),A=1;for(let L=C-A;L<=k+A;L++)L!==0&&l.push(new u.b4(L,n))}return l}coveringTiles(n){var l,d;let m=this.coveringZoomLevel(n);const y=m;if(n.minzoom!==void 0&&m<n.minzoom)return[];n.maxzoom!==void 0&&m>n.maxzoom&&(m=n.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),C=u.Z.fromLngLat(this.center),k=Math.pow(2,m),A=[k*w.x,k*w.y,0],L=[k*C.x,k*C.y,0],F=na.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,m);let $=n.minzoom||0;!n.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&($=m);const H=n.terrain?2/Math.min(this.tileSize,n.tileSize)*this.tileSize:3,Y=ee=>({aabb:new ra([ee*k,0,0],[(ee+1)*k,k,0]),zoom:0,x:0,y:0,wrap:ee,fullyVisible:!1}),ie=[],ae=[],ue=m,de=n.reparseOverscaled?y:m;if(this._renderWorldCopies)for(let ee=1;ee<=3;ee++)ie.push(Y(-ee)),ie.push(Y(ee));for(ie.push(Y(0));ie.length>0;){const ee=ie.pop(),ye=ee.x,ve=ee.y;let Te=ee.fullyVisible;if(!Te){const Ze=ee.aabb.intersects(F);if(Ze===0)continue;Te=Ze===2}const Re=n.terrain?A:L,je=ee.aabb.distanceX(Re),Ye=ee.aabb.distanceY(Re),nt=Math.max(Math.abs(je),Math.abs(Ye));if(ee.zoom===ue||nt>H+(1<<ue-ee.zoom)-2&&ee.zoom>=$){const Ze=ue-ee.zoom,We=A[0]-.5-(ye<<Ze),lt=A[1]-.5-(ve<<Ze);ae.push({tileID:new u.S(ee.zoom===ue?de:ee.zoom,ee.wrap,ee.zoom,ye,ve),distanceSq:Ie([L[0]-.5-ye,L[1]-.5-ve]),tileDistanceToCamera:Math.sqrt(We*We+lt*lt)})}else for(let Ze=0;Ze<4;Ze++){const We=(ye<<1)+Ze%2,lt=(ve<<1)+(Ze>>1),St=ee.zoom+1;let Xe=ee.aabb.quadrant(Ze);if(n.terrain){const Qe=new u.S(St,ee.wrap,St,We,lt),bt=n.terrain.getMinMaxElevation(Qe),cn=(l=bt.minElevation)!==null&&l!==void 0?l:this.elevation,It=(d=bt.maxElevation)!==null&&d!==void 0?d:this.elevation;Xe=new ra([Xe.min[0],Xe.min[1],cn],[Xe.max[0],Xe.max[1],It])}ie.push({aabb:Xe,zoom:St,x:We,y:lt,wrap:ee.wrap,fullyVisible:Te})}}return ae.sort((ee,ye)=>ee.distanceSq-ye.distanceSq).map(ee=>ee.tileID)}resize(n,l){this.width=n,this.height=l,this.pixelsToGLUnits=[2/n,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const l=u.ac(n.lat,-85.051129,vh);return new u.P(u.O(n.lng)*this.worldSize,u.Q(l)*this.worldSize)}unproject(n){return new u.Z(n.x/this.worldSize,n.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(n){const l=this.elevation,d=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,m=this.pointLocation(this.centerPoint,n),y=n.getElevationForLngLatZoom(m,this.tileZoom);if(!(this.elevation-y))return;const w=d+l-y,C=Math.cos(this._pitch)*this.cameraToCenterDistance/w/u.b5(1,m.lat),k=this.scaleZoom(C/this.tileSize);this._elevation=y,this._center=m,this.zoom=k}setLocationAtPoint(n,l){const d=this.pointCoordinate(l),m=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(n),w=new u.Z(y.x-(d.x-m.x),y.y-(d.y-m.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(n,l){return l?this.coordinatePoint(this.locationCoordinate(n),l.getElevationForLngLatZoom(n,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(n))}pointLocation(n,l){return this.coordinateLocation(this.pointCoordinate(n,l))}locationCoordinate(n){return u.Z.fromLngLat(n)}coordinateLocation(n){return n&&n.toLngLat()}pointCoordinate(n,l){if(l){const $=l.pointCoordinate(n);if($!=null)return $}const d=[n.x,n.y,0,1],m=[n.x,n.y,1,1];u.af(d,d,this.pixelMatrixInverse),u.af(m,m,this.pixelMatrixInverse);const y=d[3],w=m[3],C=d[1]/y,k=m[1]/w,A=d[2]/y,L=m[2]/w,F=A===L?0:(0-A)/(L-A);return new u.Z(u.y.number(d[0]/y,m[0]/w,F)/this.worldSize,u.y.number(C,k,F)/this.worldSize)}coordinatePoint(n,l=0,d=this.pixelMatrix){const m=[n.x*this.worldSize,n.y*this.worldSize,l,1];return u.af(m,m,d),new u.P(m[0]/m[3],m[1]/m[3])}getBounds(){const n=Math.max(0,this.height/2-this.getHorizon());return new ke().extend(this.pointLocation(new u.P(0,n))).extend(this.pointLocation(new u.P(this.width,n))).extend(this.pointLocation(new u.P(this.width,this.height))).extend(this.pointLocation(new u.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ke([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,vh])}calculateTileMatrix(n){const l=n.canonical,d=this.worldSize/this.zoomScale(l.z),m=l.x+Math.pow(2,l.z)*n.wrap,y=u.an(new Float64Array(16));return u.J(y,y,[m*d,l.y*d,0]),u.K(y,y,[d/u.X,d/u.X,1]),y}calculatePosMatrix(n,l=!1){const d=n.key,m=l?this._alignedPosMatrixCache:this._posMatrixCache;if(m[d])return m[d];const y=this.calculateTileMatrix(n);return u.L(y,l?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,y),m[d]=new Float32Array(y),m[d]}calculateFogMatrix(n){const l=n.key,d=this._fogMatrixCache;if(d[l])return d[l];const m=this.calculateTileMatrix(n);return u.L(m,this.fogMatrix,m),d[l]=new Float32Array(m),d[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(n,l){l=u.ac(+l,this.minZoom,this.maxZoom);const d={center:new u.N(n.lng,n.lat),zoom:l};let m=this.lngRange;if(!this._renderWorldCopies&&m===null){const ee=179.9999999999;m=[-ee,ee]}const y=this.tileSize*this.zoomScale(d.zoom);let w=0,C=y,k=0,A=y,L=0,F=0;const{x:$,y:H}=this.size;if(this.latRange){const ee=this.latRange;w=u.Q(ee[1])*y,C=u.Q(ee[0])*y,C-w<H&&(L=H/(C-w))}m&&(k=u.b3(u.O(m[0])*y,0,y),A=u.b3(u.O(m[1])*y,0,y),A<k&&(A+=y),A-k<$&&(F=$/(A-k)));const{x:Y,y:ie}=this.project.call({worldSize:y},n);let ae,ue;const de=Math.max(F||0,L||0);if(de){const ee=new u.P(F?(A+k)/2:Y,L?(C+w)/2:ie);return d.center=this.unproject.call({worldSize:y},ee).wrap(),d.zoom+=this.scaleZoom(de),d}if(this.latRange){const ee=H/2;ie-ee<w&&(ue=w+ee),ie+ee>C&&(ue=C-ee)}if(m){const ee=(k+A)/2;let ye=Y;this._renderWorldCopies&&(ye=u.b3(Y,ee-y/2,ee+y/2));const ve=$/2;ye-ve<k&&(ae=k+ve),ye+ve>A&&(ae=A-ve)}if(ae!==void 0||ue!==void 0){const ee=new u.P(ae??Y,ue??ie);d.center=this.unproject.call({worldSize:y},ee).wrap()}return d}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this._unmodified,{center:l,zoom:d}=this.getConstrained(this.center,this.zoom);this.center=l,this.zoom=d,this._unmodified=n,this._constraining=!1}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,l=this.point.x,d=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=u.b5(1,this.center.lat)*this.worldSize;let m=u.an(new Float64Array(16));u.K(m,m,[this.width/2,-this.height/2,1]),u.J(m,m,[1,-1,0]),this.labelPlaneMatrix=m,m=u.an(new Float64Array(16)),u.K(m,m,[1,-1,1]),u.J(m,m,[-1,-1,0]),u.K(m,m,[2/this.width,2/this.height,1]),this.glCoordMatrix=m;const y=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),w=Math.min(this.elevation,this.minElevationForCurrentTile),C=y-w*this._pixelPerMeter/Math.cos(this._pitch),k=w<0?C:y,A=Math.PI/2+this._pitch,L=this._fov*(.5+n.y/this.height),F=Math.sin(L)*k/Math.sin(u.ac(Math.PI-A-L,.01,Math.PI-.01)),$=this.getHorizon(),H=2*Math.atan($/this.cameraToCenterDistance)*(.5+n.y/(2*$)),Y=Math.sin(H)*k/Math.sin(u.ac(Math.PI-A-H,.01,Math.PI-.01)),ie=Math.min(F,Y);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*ie+k),this.nearZ=this.height/50,m=new Float64Array(16),u.b6(m,this._fov,this.width/this.height,this.nearZ,this.farZ),m[8]=2*-n.x/this.width,m[9]=2*n.y/this.height,this.projectionMatrix=u.ae(m),u.K(m,m,[1,-1,1]),u.J(m,m,[0,0,-this.cameraToCenterDistance]),u.b7(m,m,this._pitch),u.ad(m,m,this.angle),u.J(m,m,[-l,-d,0]),this.mercatorMatrix=u.K([],m,[this.worldSize,this.worldSize,this.worldSize]),u.K(m,m,[1,1,this._pixelPerMeter]),this.pixelMatrix=u.L(new Float64Array(16),this.labelPlaneMatrix,m),u.J(m,m,[0,0,-this.elevation]),this.modelViewProjectionMatrix=m,this.invModelViewProjectionMatrix=u.as([],m),this.fogMatrix=new Float64Array(16),u.b6(this.fogMatrix,this._fov,this.width/this.height,y,this.farZ),this.fogMatrix[8]=2*-n.x/this.width,this.fogMatrix[9]=2*n.y/this.height,u.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),u.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),u.b7(this.fogMatrix,this.fogMatrix,this._pitch),u.ad(this.fogMatrix,this.fogMatrix,this.angle),u.J(this.fogMatrix,this.fogMatrix,[-l,-d,0]),u.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),u.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=u.L(new Float64Array(16),this.labelPlaneMatrix,m);const ae=this.width%2/2,ue=this.height%2/2,de=Math.cos(this.angle),ee=Math.sin(this.angle),ye=l-Math.round(l)+de*ae+ee*ue,ve=d-Math.round(d)+de*ue+ee*ae,Te=new Float64Array(m);if(u.J(Te,Te,[ye>.5?ye-1:ye,ve>.5?ve-1:ve,0]),this.alignedModelViewProjectionMatrix=Te,m=u.as(new Float64Array(16),this.pixelMatrix),!m)throw new Error("failed to invert matrix");this.pixelMatrixInverse=m,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const n=this.pointCoordinate(new u.P(0,0)),l=[n.x*this.worldSize,n.y*this.worldSize,0,1];return u.af(l,l,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.P(0,n))}getCameraQueryGeometry(n){const l=this.getCameraPoint();if(n.length===1)return[n[0],l];{let d=l.x,m=l.y,y=l.x,w=l.y;for(const C of n)d=Math.min(d,C.x),m=Math.min(m,C.y),y=Math.max(y,C.x),w=Math.max(w,C.y);return[new u.P(d,m),new u.P(y,m),new u.P(y,w),new u.P(d,w),new u.P(d,m)]}}lngLatToCameraDepth(n,l){const d=this.locationCoordinate(n),m=[d.x*this.worldSize,d.y*this.worldSize,l,1];return u.af(m,m,this.modelViewProjectionMatrix),m[2]/m[3]}}function ul(_,n){let l,d=!1,m=null,y=null;const w=()=>{m=null,d&&(_.apply(y,l),m=setTimeout(w,n),d=!1)};return(...C)=>(d=!0,y=this,l=C,m||w(),m)}class vu{constructor(n){this._getCurrentHash=()=>{const l=window.location.hash.replace("#","");if(this._hashName){let d;return l.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(d=m)}),(d&&d[1]||"").split("/")}return l.split("/")},this._onHashChange=()=>{const l=this._getCurrentHash();if(l.length>=3&&!l.some(d=>isNaN(d))){const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:d,pitch:+(l[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const l=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,l)},this._removeHash=()=>{const l=this._getCurrentHash();if(l.length===0)return;const d=l.join("/");let m=d;m.split("&").length>0&&(m=m.split("&")[0]),this._hashName&&(m=`${this._hashName}=${d}`);let y=window.location.hash.replace(m,"");y.startsWith("#&")?y=y.slice(0,1)+y.slice(2):y==="#"&&(y="");let w=window.location.href.replace(/(#.+)?$/,y);w=w.replace("&&","&"),window.history.replaceState(window.history.state,null,w)},this._updateHash=ul(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(n){const l=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,m=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,m),w=Math.round(l.lng*y)/y,C=Math.round(l.lat*y)/y,k=this._map.getBearing(),A=this._map.getPitch();let L="";if(L+=n?`/${w}/${C}/${d}`:`${d}/${C}/${w}`,(k||A)&&(L+="/"+Math.round(10*k)/10),A&&(L+=`/${Math.round(A)}`),this._hashName){const F=this._hashName;let $=!1;const H=window.location.hash.slice(1).split("&").map(Y=>{const ie=Y.split("=")[0];return ie===F?($=!0,`${ie}=${L}`):Y}).filter(Y=>Y);return $||H.push(`${F}=${L}`),`#${H.join("&")}`}return`#${L}`}}const xu={linearity:.3,easing:u.b8(0,0,.3,1)},xh=u.e({deceleration:2500,maxSpeed:1400},xu),My=u.e({deceleration:20,maxSpeed:1400},xu),ep=u.e({deceleration:1e3,maxSpeed:360},xu),bu=u.e({deceleration:1e3,maxSpeed:90},xu);class bh{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:z.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,l=z.now();for(;n.length>0&&l-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const l={zoom:0,bearing:0,pitch:0,pan:new u.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)l.zoom+=y.zoomDelta||0,l.bearing+=y.bearingDelta||0,l.pitch+=y.pitchDelta||0,y.panDelta&&l.pan._add(y.panDelta),y.around&&(l.around=y.around),y.pinchAround&&(l.pinchAround=y.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,m={};if(l.pan.mag()){const y=hl(l.pan.mag(),d,u.e({},xh,n||{}));m.offset=l.pan.mult(y.amount/l.pan.mag()),m.center=this._map.transform.center,cl(m,y)}if(l.zoom){const y=hl(l.zoom,d,My);m.zoom=this._map.transform.zoom+y.amount,cl(m,y)}if(l.bearing){const y=hl(l.bearing,d,ep);m.bearing=this._map.transform.bearing+u.ac(y.amount,-179,179),cl(m,y)}if(l.pitch){const y=hl(l.pitch,d,bu);m.pitch=this._map.transform.pitch+y.amount,cl(m,y)}if(m.zoom||m.bearing){const y=l.pinchAround===void 0?l.around:l.pinchAround;m.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),u.e(m,{noMoveStart:!0})}}function cl(_,n){(!_.duration||_.duration<n.duration)&&(_.duration=n.duration,_.easing=n.easing)}function hl(_,n,l){const{maxSpeed:d,linearity:m,deceleration:y}=l,w=u.ac(_*m/(n/1e3),-d,d),C=Math.abs(w)/(y*m);return{easing:l.easing,duration:1e3*C,amount:w*(C/2)}}class ar extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,d,m={}){const y=I.mousePos(l.getCanvas(),d),w=l.unproject(y);super(n,u.e({point:y,lngLat:w,originalEvent:d},m)),this._defaultPrevented=!1,this.target=l}}class vo extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,d){const m=n==="touchend"?d.changedTouches:d.touches,y=I.touchPos(l.getCanvasContainer(),m),w=y.map(k=>l.unproject(k)),C=y.reduce((k,A,L,F)=>k.add(A.div(F.length)),new u.P(0,0));super(n,{points:y,point:C,lngLats:w,lngLat:l.unproject(C),originalEvent:d}),this._defaultPrevented=!1}}class tp extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,d){super(n,{originalEvent:d}),this._defaultPrevented=!1}}class np{constructor(n,l){this._map=n,this._clickTolerance=l.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new tp(n.type,this._map,n))}mousedown(n,l){return this._mousedownPos=l,this._firePreventable(new ar(n.type,this._map,n))}mouseup(n){this._map.fire(new ar(n.type,this._map,n))}click(n,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||this._map.fire(new ar(n.type,this._map,n))}dblclick(n){return this._firePreventable(new ar(n.type,this._map,n))}mouseover(n){this._map.fire(new ar(n.type,this._map,n))}mouseout(n){this._map.fire(new ar(n.type,this._map,n))}touchstart(n){return this._firePreventable(new vo(n.type,this._map,n))}touchmove(n){this._map.fire(new vo(n.type,this._map,n))}touchend(n){this._map.fire(new vo(n.type,this._map,n))}touchcancel(n){this._map.fire(new vo(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wn{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new ar(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ar("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new ar(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Mi{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.pointLocation(u.P.convert(n),this._map.terrain)}}class Kr{constructor(n,l){this._map=n,this._tr=new Mi(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,l){this.isEnabled()&&n.shiftKey&&n.button===0&&(I.disableDrag(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(n,l){if(!this._active)return;const d=l;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const m=this._startPos;this._lastPos=d,this._box||(this._box=I.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const y=Math.min(m.x,d.x),w=Math.max(m.x,d.x),C=Math.min(m.y,d.y),k=Math.max(m.y,d.y);I.setTransform(this._box,`translate(${y}px,${C}px)`),this._box.style.width=w-y+"px",this._box.style.height=k-C+"px"}mouseupWindow(n,l){if(!this._active||n.button!==0)return;const d=this._startPos,m=l;if(this.reset(),I.suppressClick(),d.x!==m.x||d.y!==m.y)return this._map.fire(new u.k("boxzoomend",{originalEvent:n})),{cameraAnimation:y=>y.fitScreenCoordinates(d,m,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(I.remove(this._box),this._box=null),I.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,l){return this._map.fire(new u.k(n,{originalEvent:l}))}}function dl(_,n){if(_.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${_.length}, points ${n.length}`);const l={};for(let d=0;d<_.length;d++)l[_[d].identifier]=n[d];return l}class wh{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,l,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),d.length===this.numTouches&&(this.centroid=function(m){const y=new u.P(0,0);for(const w of m)y._add(w);return y.div(m.length)}(l),this.touches=dl(d,l)))}touchmove(n,l,d){if(this.aborted||!this.centroid)return;const m=dl(d,l);for(const y in this.touches){const w=m[y];(!w||w.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(n,l,d){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const m=!this.aborted&&this.centroid;if(this.reset(),m)return m}}}class wu{constructor(n){this.singleTap=new wh(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,l,d){this.singleTap.touchstart(n,l,d)}touchmove(n,l,d){this.singleTap.touchmove(n,l,d)}touchend(n,l,d){const m=this.singleTap.touchend(n,l,d);if(m){const y=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(m)<30;if(y&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}}}class oa{constructor(n){this._tr=new Mi(n),this._zoomIn=new wu({numTouches:1,numTaps:2}),this._zoomOut=new wu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,l,d){this._zoomIn.touchstart(n,l,d),this._zoomOut.touchstart(n,l,d)}touchmove(n,l,d){this._zoomIn.touchmove(n,l,d),this._zoomOut.touchmove(n,l,d)}touchend(n,l,d){const m=this._zoomIn.touchend(n,l,d),y=this._zoomOut.touchend(n,l,d),w=this._tr;return m?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(m)},{originalEvent:n})}):y?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(y)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ts{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const l=this._moveFunction(...n);if(l.bearingDelta||l.pitchDelta||l.around||l.panDelta)return this._active=!0,l}dragStart(n,l){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=l.length?l[0]:l,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,l){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const m=l.length?l[0]:l;return!this._moved&&m.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=m,this._move(d,m))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&I.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Sh={0:1,2:2};class Su{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const l=I.mouseButton(n);this._eventButton=l}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!function(l,d){const m=Sh[d];return l.buttons===void 0||(l.buttons&m)!==m}(n,this._eventButton)}isValidEndEvent(n){return I.mouseButton(n)===this._eventButton}}class Th{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}const Tu=_=>{_.mousedown=_.dragStart,_.mousemoveWindow=_.dragMove,_.mouseup=_.dragEnd,_.contextmenu=n=>{n.preventDefault()}},Ch=({enable:_,clickTolerance:n,bearingDegreesPerPixelMoved:l=.8})=>{const d=new Su({checkCorrectEvent:m=>I.mouseButton(m)===0&&m.ctrlKey||I.mouseButton(m)===2});return new Ts({clickTolerance:n,move:(m,y)=>({bearingDelta:(y.x-m.x)*l}),moveStateManager:d,enable:_,assignEvents:Tu})},kh=({enable:_,clickTolerance:n,pitchDegreesPerPixelMoved:l=-.5})=>{const d=new Su({checkCorrectEvent:m=>I.mouseButton(m)===0&&m.ctrlKey||I.mouseButton(m)===2});return new Ts({clickTolerance:n,move:(m,y)=>({pitchDelta:(y.y-m.y)*l}),moveStateManager:d,enable:_,assignEvents:Tu})};class xo{constructor(n,l){this._clickTolerance=n.clickTolerance||1,this._map=l,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.P(0,0)}_shouldBePrevented(n){return n<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(n,l,d){return this._calculateTransform(n,l,d)}touchmove(n,l,d){if(this._active){if(!this._shouldBePrevented(d.length))return n.preventDefault(),this._calculateTransform(n,l,d);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",n)}}touchend(n,l,d){this._calculateTransform(n,l,d),this._active&&this._shouldBePrevented(d.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,l,d){d.length>0&&(this._active=!0);const m=dl(d,l),y=new u.P(0,0),w=new u.P(0,0);let C=0;for(const A in m){const L=m[A],F=this._touches[A];F&&(y._add(L),w._add(L.sub(F)),C++,m[A]=L)}if(this._touches=m,this._shouldBePrevented(C)||!w.mag())return;const k=w.div(C);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(C),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,l,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([l[0],l[1]]))}touchmove(n,l,d){if(!this._firstTwoTouches)return;n.preventDefault();const[m,y]=this._firstTwoTouches,w=fl(d,l,m),C=fl(d,l,y);if(!w||!C)return;const k=this._aroundCenter?null:w.add(C).div(2);return this._move([w,C],k,n)}touchend(n,l,d){if(!this._firstTwoTouches)return;const[m,y]=this._firstTwoTouches,w=fl(d,l,m),C=fl(d,l,y);w&&C||(this._active&&I.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function fl(_,n,l){for(let d=0;d<_.length;d++)if(_[d].identifier===l)return n[d]}function Ph(_,n){return Math.log(_/n)/Math.LN2}class Eh extends Cu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,l){const d=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(Ph(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ph(this._distance,d),pinchAround:l}}}function Ih(_,n){return 180*_.angleWith(n)/Math.PI}class Mh extends Cu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,l,d){const m=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ih(this._vector,m),pinchAround:l}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const l=25/(Math.PI*this._minDiameter)*360,d=Ih(n,this._startVector);return Math.abs(d)<l}}function ku(_){return Math.abs(_.y)>Math.abs(_.x)}class pl extends Cu{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,l,d){super.touchstart(n,l,d),this._currentTouchCount=d.length}_start(n){this._lastPoints=n,ku(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,l,d){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const m=n[0].sub(this._lastPoints[0]),y=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(m,y,d.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(m.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(n,l,d){if(this._valid!==void 0)return this._valid;const m=n.mag()>=2,y=l.mag()>=2;if(!m&&!y)return;if(!m||!y)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const w=n.y>0==l.y>0;return ku(n)&&ku(l)&&w}}const rp={panStep:100,bearingStep:15,pitchStep:10};class hi{constructor(n){this._tr=new Mi(n);const l=rp;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let l=0,d=0,m=0,y=0,w=0;switch(n.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:n.shiftKey?d=-1:(n.preventDefault(),y=-1);break;case 39:n.shiftKey?d=1:(n.preventDefault(),y=1);break;case 38:n.shiftKey?m=1:(n.preventDefault(),w=-1);break;case 40:n.shiftKey?m=-1:(n.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(d=0,m=0),{cameraAnimation:C=>{const k=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:ts,zoom:l?Math.round(k.zoom)+l*(n.shiftKey?2:1):k.zoom,bearing:k.bearing+d*this._bearingStep,pitch:k.pitch+m*this._pitchStep,offset:[-y*this._panStep,-w*this._panStep],center:k.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ts(_){return _*(2-_)}const Ah=4.000244140625;class Ai{constructor(n,l){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=n,this._tr=new Mi(n),this._triggerRenderFrame=l,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(n){return!!this._map.cooperativeGestures.isEnabled()&&!(n.ctrlKey||this._map.cooperativeGestures.isBypassed(n))}wheel(n){if(!this.isEnabled())return;if(this._shouldBePrevented(n))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",n);let l=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const d=z.now(),m=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,l!==0&&l%Ah==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=l,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(m*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),n.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=n,this._delta-=l,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=I.mousePos(this._map.getCanvas(),n),d=this._tr;this._around=l.y>d.transform.height/2-d.transform.getHorizon()?u.N.convert(this._aroundCenter?d.center:d.unproject(l)):u.N.convert(d.center),this._aroundPoint=d.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>Ah?this._wheelZoomRate:this._defaultZoomRate;let A=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&A!==0&&(A=1/A);const L=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(L*A))),this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const l=typeof this._targetZoom=="number"?this._targetZoom:n.zoom,d=this._startZoom,m=this._easing;let y,w=!1;const C=z.now()-this._lastWheelEventTime;if(this._type==="wheel"&&d&&m&&C){const k=Math.min(C/200,1),A=m(k);y=u.y.number(d,l,A),k<1?this._frameId||(this._frameId=!0):w=!0}else y=l,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:y-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let l=u.b9;if(this._prevEase){const d=this._prevEase,m=(z.now()-d.start)/d.duration,y=d.easing(m+.01)-d.easing(m),w=.27/Math.sqrt(y*y+1e-4)*.01,C=Math.sqrt(.0729-w*w);l=u.b8(w,C,.25,1)}return this._prevEase={start:z.now(),duration:n,easing:l},l}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class bo{constructor(n,l){this._clickZoom=n,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ay{constructor(n){this._tr=new Mi(n),this.reset()}reset(){this._active=!1}dblclick(n,l){return n.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(l)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zy{constructor(){this._tap=new wu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,l,d){if(!this._swipePoint)if(this._tapTime){const m=l[0],y=n.timeStamp-this._tapTime<500,w=this._tapPoint.dist(m)<30;y&&w?d.length>0&&(this._swipePoint=m,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(n,l,d)}touchmove(n,l,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const m=l[0],y=m.y-this._swipePoint.y;return this._swipePoint=m,n.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(n,l,d)}touchend(n,l,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const m=this._tap.touchend(n,l,d);m&&(this._tapTime=n.timeStamp,this._tapPoint=m)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ip{constructor(n,l,d){this._el=n,this._mousePan=l,this._touchPan=d}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class sp{constructor(n,l,d){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=l,this._mousePitch=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class zh{constructor(n,l,d,m){this._el=n,this._touchZoom=l,this._touchRotate=d,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class aa{constructor(n,l){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=l,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=I.create("div","maplibregl-cooperative-gesture-screen",n);let l=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(l=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const d=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),m=document.createElement("div");m.className="maplibregl-desktop-message",m.textContent=l,this._container.appendChild(m);const y=document.createElement("div");y.className="maplibregl-mobile-message",y.textContent=d,this._container.appendChild(y),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(I.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(n){return n[this._bypassKey]}notifyGestureBlocked(n,l){this._enabled&&(this._map.fire(new u.k("cooperativegestureprevented",{gestureType:n,originalEvent:l})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const di=_=>_.zoom||_.drag||_.pitch||_.rotate;class it extends u.k{}function Pu(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class Dh{constructor(n,l){this.handleWindowEvent=m=>{this.handleEvent(m,`${m.type}Window`)},this.handleEvent=(m,y)=>{if(m.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=m.type==="renderFrame"?void 0:m,C={needsRenderFrame:!1},k={},A={},L=m.touches,F=L?this._getMapTouches(L):void 0,$=F?I.touchPos(this._map.getCanvas(),F):I.mousePos(this._map.getCanvas(),m);for(const{handlerName:ie,handler:ae,allowed:ue}of this._handlers){if(!ae.isEnabled())continue;let de;this._blockedByActive(A,ue,ie)?ae.reset():ae[y||m.type]&&(de=ae[y||m.type](m,$,F),this.mergeHandlerResult(C,k,de,ie,w),de&&de.needsRenderFrame&&this._triggerRenderFrame()),(de||ae.isActive())&&(A[ie]=ae)}const H={};for(const ie in this._previousActiveHandlers)A[ie]||(H[ie]=w);this._previousActiveHandlers=A,(Object.keys(H).length||Pu(C))&&(this._changes.push([C,k,H]),this._triggerRenderFrame()),(Object.keys(A).length||Pu(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Y}=C;Y&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Y(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bh(n),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(l);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[m,y,w]of this._listeners)I.addEventListener(m,y,m===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[n,l,d]of this._listeners)I.removeEventListener(n,l,n===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(n){const l=this._map,d=l.getCanvasContainer();this._add("mapEvent",new np(l,n));const m=l.boxZoom=new Kr(l,n);this._add("boxZoom",m),n.interactive&&n.boxZoom&&m.enable();const y=l.cooperativeGestures=new aa(l,n.cooperativeGestures);this._add("cooperativeGestures",y),n.cooperativeGestures&&y.enable();const w=new oa(l),C=new Ay(l);l.doubleClickZoom=new bo(C,w),this._add("tapZoom",w),this._add("clickZoom",C),n.interactive&&n.doubleClickZoom&&l.doubleClickZoom.enable();const k=new zy;this._add("tapDragZoom",k);const A=l.touchPitch=new pl(l);this._add("touchPitch",A),n.interactive&&n.touchPitch&&l.touchPitch.enable(n.touchPitch);const L=Ch(n),F=kh(n);l.dragRotate=new sp(n,L,F),this._add("mouseRotate",L,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]),n.interactive&&n.dragRotate&&l.dragRotate.enable();const $=(({enable:de,clickTolerance:ee})=>{const ye=new Su({checkCorrectEvent:ve=>I.mouseButton(ve)===0&&!ve.ctrlKey});return new Ts({clickTolerance:ee,move:(ve,Te)=>({around:Te,panDelta:Te.sub(ve)}),activateOnStart:!0,moveStateManager:ye,enable:de,assignEvents:Tu})})(n),H=new xo(n,l);l.dragPan=new ip(d,$,H),this._add("mousePan",$),this._add("touchPan",H,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&l.dragPan.enable(n.dragPan);const Y=new Mh,ie=new Eh;l.touchZoomRotate=new zh(d,ie,Y,k),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&l.touchZoomRotate.enable(n.touchZoomRotate);const ae=l.scrollZoom=new Ai(l,()=>this._triggerRenderFrame());this._add("scrollZoom",ae,["mousePan"]),n.interactive&&n.scrollZoom&&l.scrollZoom.enable(n.scrollZoom);const ue=l.keyboard=new hi(l);this._add("keyboard",ue),n.interactive&&n.keyboard&&l.keyboard.enable(),this._add("blockableMapEvent",new wn(l))}_add(n,l,d){this._handlers.push({handlerName:n,handler:l,allowed:d}),this._handlersById[n]=l}stop(n){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!di(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,l,d){for(const m in n)if(m!==d&&(!l||l.indexOf(m)<0))return!0;return!1}_getMapTouches(n){const l=[];for(const d of n)this._el.contains(d.target)&&l.push(d);return l}mergeHandlerResult(n,l,d,m,y){if(!d)return;u.e(n,d);const w={handlerName:m,originalEvent:d.originalEvent||y};d.zoomDelta!==void 0&&(l.zoom=w),d.panDelta!==void 0&&(l.drag=w),d.pitchDelta!==void 0&&(l.pitch=w),d.bearingDelta!==void 0&&(l.rotate=w)}_applyChanges(){const n={},l={},d={};for(const[m,y,w]of this._changes)m.panDelta&&(n.panDelta=(n.panDelta||new u.P(0,0))._add(m.panDelta)),m.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+m.zoomDelta),m.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+m.bearingDelta),m.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+m.pitchDelta),m.around!==void 0&&(n.around=m.around),m.pinchAround!==void 0&&(n.pinchAround=m.pinchAround),m.noInertia&&(n.noInertia=m.noInertia),u.e(l,y),u.e(d,w);this._updateMapTransform(n,l,d),this._changes=[]}_updateMapTransform(n,l,d){const m=this._map,y=m._getTransformForUpdate(),w=m.terrain;if(!(Pu(n)||w&&this._terrainMovement))return this._fireEvents(l,d,!0);let{panDelta:C,zoomDelta:k,bearingDelta:A,pitchDelta:L,around:F,pinchAround:$}=n;$!==void 0&&(F=$),m._stop(!0),F=F||m.transform.centerPoint;const H=y.pointLocation(C?F.sub(C):F);A&&(y.bearing+=A),L&&(y.pitch+=L),k&&(y.zoom+=k),w?this._terrainMovement||!l.drag&&!l.zoom?l.drag&&this._terrainMovement?y.center=y.pointLocation(y.centerPoint.sub(C)):y.setLocationAtPoint(H,F):(this._terrainMovement=!0,this._map._elevationFreeze=!0,y.setLocationAtPoint(H,F)):y.setLocationAtPoint(H,F),m._applyUpdatedTransform(y),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(l,d,!0)}_fireEvents(n,l,d){const m=di(this._eventsInProgress),y=di(n),w={};for(const F in n){const{originalEvent:$}=n[F];this._eventsInProgress[F]||(w[`${F}start`]=$),this._eventsInProgress[F]=n[F]}!m&&y&&this._fireEvent("movestart",y.originalEvent);for(const F in w)this._fireEvent(F,w[F]);y&&this._fireEvent("move",y.originalEvent);for(const F in n){const{originalEvent:$}=n[F];this._fireEvent(F,$)}const C={};let k;for(const F in this._eventsInProgress){const{handlerName:$,originalEvent:H}=this._eventsInProgress[F];this._handlersById[$].isActive()||(delete this._eventsInProgress[F],k=l[$]||H,C[`${F}end`]=k)}for(const F in C)this._fireEvent(F,C[F]);const A=di(this._eventsInProgress),L=(m||y)&&!A;if(L&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const F=this._map._getTransformForUpdate();F.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(F)}if(d&&L){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),$=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;!F||!F.essential&&z.prefersReducedMotion?(this._map.fire(new u.k("moveend",{originalEvent:k})),$(this._map.getBearing())&&this._map.resetNorth()):($(F.bearing||this._map.getBearing())&&(F.bearing=0),F.freezeElevation=!0,this._map.easeTo(F,{originalEvent:k})),this._updatingCamera=!1}}_fireEvent(n,l){this._map.fire(new u.k(n,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new it("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class op extends u.E{constructor(n,l){super(),this._renderFrameCallback=()=>{const d=Math.min((z.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new u.N(this.transform.center.lng,this.transform.center.lat)}setCenter(n,l){return this.jumpTo({center:n},l)}panBy(n,l,d){return n=u.P.convert(n).mult(-1),this.panTo(this.transform.center,u.e({offset:n},l),d)}panTo(n,l,d){return this.easeTo(u.e({center:n},l),d)}getZoom(){return this.transform.zoom}setZoom(n,l){return this.jumpTo({zoom:n},l),this}zoomTo(n,l,d){return this.easeTo(u.e({zoom:n},l),d)}zoomIn(n,l){return this.zoomTo(this.getZoom()+1,n,l),this}zoomOut(n,l){return this.zoomTo(this.getZoom()-1,n,l),this}getBearing(){return this.transform.bearing}setBearing(n,l){return this.jumpTo({bearing:n},l),this}getPadding(){return this.transform.padding}setPadding(n,l){return this.jumpTo({padding:n},l),this}rotateTo(n,l,d){return this.easeTo(u.e({bearing:n},l),d)}resetNorth(n,l){return this.rotateTo(0,u.e({duration:1e3},n),l),this}resetNorthPitch(n,l){return this.easeTo(u.e({bearing:0,pitch:0,duration:1e3},n),l),this}snapToNorth(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this}getPitch(){return this.transform.pitch}setPitch(n,l){return this.jumpTo({pitch:n},l),this}cameraForBounds(n,l){n=ke.convert(n).adjustAntiMeridian();const d=l&&l.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),d,l)}_cameraForBoxAndBearing(n,l,d,m){const y={top:0,bottom:0,right:0,left:0};if(typeof(m=u.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},m)).padding=="number"){const Ze=m.padding;m.padding={top:Ze,bottom:Ze,right:Ze,left:Ze}}m.padding=u.e(y,m.padding);const w=this.transform,C=w.padding,k=new ke(n,l),A=w.project(k.getNorthWest()),L=w.project(k.getNorthEast()),F=w.project(k.getSouthEast()),$=w.project(k.getSouthWest()),H=u.ba(-d),Y=A.rotate(H),ie=L.rotate(H),ae=F.rotate(H),ue=$.rotate(H),de=new u.P(Math.max(Y.x,ie.x,ue.x,ae.x),Math.max(Y.y,ie.y,ue.y,ae.y)),ee=new u.P(Math.min(Y.x,ie.x,ue.x,ae.x),Math.min(Y.y,ie.y,ue.y,ae.y)),ye=de.sub(ee),ve=(w.width-(C.left+C.right+m.padding.left+m.padding.right))/ye.x,Te=(w.height-(C.top+C.bottom+m.padding.top+m.padding.bottom))/ye.y;if(Te<0||ve<0)return void u.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Re=Math.min(w.scaleZoom(w.scale*Math.min(ve,Te)),m.maxZoom),je=u.P.convert(m.offset),Ye=new u.P((m.padding.left-m.padding.right)/2,(m.padding.top-m.padding.bottom)/2).rotate(u.ba(d)),nt=je.add(Ye).mult(w.scale/w.zoomScale(Re));return{center:w.unproject(A.add(F).div(2).sub(nt)),zoom:Re,bearing:d}}fitBounds(n,l,d){return this._fitInternal(this.cameraForBounds(n,l),l,d)}fitScreenCoordinates(n,l,d,m,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.P.convert(n)),this.transform.pointLocation(u.P.convert(l)),d,m),m,y)}_fitInternal(n,l,d){return n?(delete(l=u.e(n,l)).padding,l.linear?this.easeTo(l,d):this.flyTo(l,d)):this}jumpTo(n,l){this.stop();const d=this._getTransformForUpdate();let m=!1,y=!1,w=!1;return"zoom"in n&&d.zoom!==+n.zoom&&(m=!0,d.zoom=+n.zoom),n.center!==void 0&&(d.center=u.N.convert(n.center)),"bearing"in n&&d.bearing!==+n.bearing&&(y=!0,d.bearing=+n.bearing),"pitch"in n&&d.pitch!==+n.pitch&&(w=!0,d.pitch=+n.pitch),n.padding==null||d.isPaddingEqual(n.padding)||(d.padding=n.padding),this._applyUpdatedTransform(d),this.fire(new u.k("movestart",l)).fire(new u.k("move",l)),m&&this.fire(new u.k("zoomstart",l)).fire(new u.k("zoom",l)).fire(new u.k("zoomend",l)),y&&this.fire(new u.k("rotatestart",l)).fire(new u.k("rotate",l)).fire(new u.k("rotateend",l)),w&&this.fire(new u.k("pitchstart",l)).fire(new u.k("pitch",l)).fire(new u.k("pitchend",l)),this.fire(new u.k("moveend",l))}calculateCameraOptionsFromTo(n,l,d,m=0){const y=u.Z.fromLngLat(n,l),w=u.Z.fromLngLat(d,m),C=w.x-y.x,k=w.y-y.y,A=w.z-y.z,L=Math.hypot(C,k,A);if(L===0)throw new Error("Can't calculate camera options with same From and To");const F=Math.hypot(C,k),$=this.transform.scaleZoom(this.transform.cameraToCenterDistance/L/this.transform.tileSize),H=180*Math.atan2(C,-k)/Math.PI;let Y=180*Math.acos(F/L)/Math.PI;return Y=A<0?90-Y:90+Y,{center:w.toLngLat(),zoom:$,pitch:Y,bearing:H}}easeTo(n,l){var d;this._stop(!1,n.easeId),((n=u.e({offset:[0,0],duration:500,easing:u.b9},n)).animate===!1||!n.essential&&z.prefersReducedMotion)&&(n.duration=0);const m=this._getTransformForUpdate(),y=m.zoom,w=m.bearing,C=m.pitch,k=m.padding,A="bearing"in n?this._normalizeBearing(n.bearing,w):w,L="pitch"in n?+n.pitch:C,F="padding"in n?n.padding:m.padding,$=u.P.convert(n.offset);let H=m.centerPoint.add($);const Y=m.pointLocation(H),{center:ie,zoom:ae}=m.getConstrained(u.N.convert(n.center||Y),(d=n.zoom)!==null&&d!==void 0?d:y);this._normalizeCenter(ie,m);const ue=m.project(Y),de=m.project(ie).sub(ue),ee=m.zoomScale(ae-y);let ye,ve;n.around&&(ye=u.N.convert(n.around),ve=m.locationPoint(ye));const Te={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ae!==y,this._rotating=this._rotating||w!==A,this._pitching=this._pitching||L!==C,this._padding=!m.isPaddingEqual(F),this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,Te),this.terrain&&this._prepareElevation(ie),this._ease(Re=>{if(this._zooming&&(m.zoom=u.y.number(y,ae,Re)),this._rotating&&(m.bearing=u.y.number(w,A,Re)),this._pitching&&(m.pitch=u.y.number(C,L,Re)),this._padding&&(m.interpolatePadding(k,F,Re),H=m.centerPoint.add($)),this.terrain&&!n.freezeElevation&&this._updateElevation(Re),ye)m.setLocationAtPoint(ye,ve);else{const je=m.zoomScale(m.zoom-y),Ye=ae>y?Math.min(2,ee):Math.max(.5,ee),nt=Math.pow(Ye,1-Re),Ze=m.unproject(ue.add(de.mult(Re*nt)).mult(je));m.setLocationAtPoint(m.renderWorldCopies?Ze.wrap():Ze,H)}this._applyUpdatedTransform(m),this._fireMoveEvents(l)},Re=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(l,Re)},n),this}_prepareEase(n,l,d={}){this._moving=!0,l||d.moving||this.fire(new u.k("movestart",n)),this._zooming&&!d.zooming&&this.fire(new u.k("zoomstart",n)),this._rotating&&!d.rotating&&this.fire(new u.k("rotatestart",n)),this._pitching&&!d.pitching&&this.fire(new u.k("pitchstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const l=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&l!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(d-(l-(d*n+this._elevationStart))/(1-n)),this._elevationTarget=l}this.transform.elevation=u.y.number(this._elevationStart,this._elevationTarget,n)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(n){const l=n.getCameraPosition(),d=this.terrain.getElevationForLngLatZoom(l.lngLat,n.zoom);if(l.altitude<d){const m=this.calculateCameraOptionsFromTo(l.lngLat,d,n.center,n.elevation);return{pitch:m.pitch,zoom:m.zoom}}return{}}_applyUpdatedTransform(n){const l=[];if(this.terrain&&l.push(m=>this._elevateCameraIfInsideTerrain(m)),this.transformCameraUpdate&&l.push(m=>this.transformCameraUpdate(m)),!l.length)return;const d=n.clone();for(const m of l){const y=d.clone(),{center:w,zoom:C,pitch:k,bearing:A,elevation:L}=m(y);w&&(y.center=w),C!==void 0&&(y.zoom=C),k!==void 0&&(y.pitch=k),A!==void 0&&(y.bearing=A),L!==void 0&&(y.elevation=L),d.apply(y)}this.transform.apply(d)}_fireMoveEvents(n){this.fire(new u.k("move",n)),this._zooming&&this.fire(new u.k("zoom",n)),this._rotating&&this.fire(new u.k("rotate",n)),this._pitching&&this.fire(new u.k("pitch",n))}_afterEase(n,l){if(this._easeId&&l&&this._easeId===l)return;delete this._easeId;const d=this._zooming,m=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new u.k("zoomend",n)),m&&this.fire(new u.k("rotateend",n)),y&&this.fire(new u.k("pitchend",n)),this.fire(new u.k("moveend",n))}flyTo(n,l){var d;if(!n.essential&&z.prefersReducedMotion){const Qe=u.M(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Qe,l)}this.stop(),n=u.e({offset:[0,0],speed:1.2,curve:1.42,easing:u.b9},n);const m=this._getTransformForUpdate(),y=m.zoom,w=m.bearing,C=m.pitch,k=m.padding,A="bearing"in n?this._normalizeBearing(n.bearing,w):w,L="pitch"in n?+n.pitch:C,F="padding"in n?n.padding:m.padding,$=u.P.convert(n.offset);let H=m.centerPoint.add($);const Y=m.pointLocation(H),{center:ie,zoom:ae}=m.getConstrained(u.N.convert(n.center||Y),(d=n.zoom)!==null&&d!==void 0?d:y);this._normalizeCenter(ie,m);const ue=m.zoomScale(ae-y),de=m.project(Y),ee=m.project(ie).sub(de);let ye=n.curve;const ve=Math.max(m.width,m.height),Te=ve/ue,Re=ee.mag();if("minZoom"in n){const Qe=u.ac(Math.min(n.minZoom,y,ae),m.minZoom,m.maxZoom),bt=ve/m.zoomScale(Qe-y);ye=Math.sqrt(bt/Re*2)}const je=ye*ye;function Ye(Qe){const bt=(Te*Te-ve*ve+(Qe?-1:1)*je*je*Re*Re)/(2*(Qe?Te:ve)*je*Re);return Math.log(Math.sqrt(bt*bt+1)-bt)}function nt(Qe){return(Math.exp(Qe)-Math.exp(-Qe))/2}function Ze(Qe){return(Math.exp(Qe)+Math.exp(-Qe))/2}const We=Ye(!1);let lt=function(Qe){return Ze(We)/Ze(We+ye*Qe)},St=function(Qe){return ve*((Ze(We)*(nt(bt=We+ye*Qe)/Ze(bt))-nt(We))/je)/Re;var bt},Xe=(Ye(!0)-We)/ye;if(Math.abs(Re)<1e-6||!isFinite(Xe)){if(Math.abs(ve-Te)<1e-6)return this.easeTo(n,l);const Qe=Te<ve?-1:1;Xe=Math.abs(Math.log(Te/ve))/ye,St=()=>0,lt=bt=>Math.exp(Qe*ye*bt)}return n.duration="duration"in n?+n.duration:1e3*Xe/("screenSpeed"in n?+n.screenSpeed/ye:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=w!==A,this._pitching=L!==C,this._padding=!m.isPaddingEqual(F),this._prepareEase(l,!1),this.terrain&&this._prepareElevation(ie),this._ease(Qe=>{const bt=Qe*Xe,cn=1/lt(bt);m.zoom=Qe===1?ae:y+m.scaleZoom(cn),this._rotating&&(m.bearing=u.y.number(w,A,Qe)),this._pitching&&(m.pitch=u.y.number(C,L,Qe)),this._padding&&(m.interpolatePadding(k,F,Qe),H=m.centerPoint.add($)),this.terrain&&!n.freezeElevation&&this._updateElevation(Qe);const It=Qe===1?ie:m.unproject(de.add(ee.mult(St(bt))).mult(cn));m.setLocationAtPoint(m.renderWorldCopies?It.wrap():It,H),this._applyUpdatedTransform(m),this._fireMoveEvents(l)},()=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(l)},n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,l){var d;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,l)}return n||(d=this.handlers)===null||d===void 0||d.stop(!1),this}_ease(n,l,d){d.animate===!1||d.duration===0?(n(1),l()):(this._easeStart=z.now(),this._easeOptions=d,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,l){n=u.b3(n,-180,180);const d=Math.abs(n-l);return Math.abs(n-360-l)<d&&(n-=360),Math.abs(n+360-l)<d&&(n+=360),n}_normalizeCenter(n,l){if(!l.renderWorldCopies||l.lngRange)return;const d=n.lng-l.center.lng;n.lng+=d>180?-360:d<-180?360:0}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLatZoom(u.N.convert(n),this.transform.tileZoom)-this.transform.elevation:null}}const la={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class ua{constructor(n=la){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=l=>{!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"&&l.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=I.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=I.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=I.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){I.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,l){const d=this._map._getUIString(`AttributionControl.${l}`);n.title=d,n.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(m=>typeof m!="string"?"":m)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const m=this._map.style.stylesheet;this.styleOwner=m.owner,this.styleId=m.id}const l=this._map.style.sourceCaches;for(const m in l){const y=l[m];if(y.used||y.usedForTerrain){const w=y.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n=n.filter(m=>String(m).trim()),n.sort((m,y)=>m.length-y.length),n=n.filter((m,y)=>{for(let w=y+1;w<n.length;w++)if(n[w].indexOf(m)>=0)return!1;return!0});const d=n.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,n.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Rh{constructor(n={}){this._updateCompact=()=>{const l=this._container.children;if(l.length){const d=l[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=I.create("div","maplibregl-ctrl");const l=I.create("a","maplibregl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://maplibre.org/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){I.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Lt{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const l=++this._id;return this._queue.push({callback:n,id:l,cancelled:!1}),l}remove(n){const l=this._currentlyRunning,d=l?this._queue.concat(l):this._queue;for(const m of d)if(m.id===n)return void(m.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const l=this._currentlyRunning=this._queue;this._queue=[];for(const d of l)if(!d.cancelled&&(d.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Lh=u.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Dy extends u.E{constructor(n){super(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,n.usedForTerrain=!0,n.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,l){this.sourceCache.update(n,l),this._renderableTilesKeys=[];const d={};for(const m of n.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:l}))d[m.key]=!0,this._renderableTilesKeys.push(m.key),this._tiles[m.key]||(m.posMatrix=new Float64Array(16),u.aP(m.posMatrix,0,u.X,0,u.X,0,1),this._tiles[m.key]=new Bs(m,this.tileSize));for(const m in this._tiles)d[m]||delete this._tiles[m]}freeRtt(n){for(const l in this._tiles){const d=this._tiles[l];(!n||d.tileID.equals(n)||d.tileID.isChildOf(n)||n.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n){const l={};for(const d of this._renderableTilesKeys){const m=this._tiles[d].tileID;if(m.canonical.equals(n.canonical)){const y=n.clone();y.posMatrix=new Float64Array(16),u.aP(y.posMatrix,0,u.X,0,u.X,0,1),l[d]=y}else if(m.canonical.isChildOf(n.canonical)){const y=n.clone();y.posMatrix=new Float64Array(16);const w=m.canonical.z-n.canonical.z,C=m.canonical.x-(m.canonical.x>>w<<w),k=m.canonical.y-(m.canonical.y>>w<<w),A=u.X>>w;u.aP(y.posMatrix,0,A,0,A,0,1),u.J(y.posMatrix,y.posMatrix,[-C*A,-k*A,0]),l[d]=y}else if(n.canonical.isChildOf(m.canonical)){const y=n.clone();y.posMatrix=new Float64Array(16);const w=n.canonical.z-m.canonical.z,C=n.canonical.x-(n.canonical.x>>w<<w),k=n.canonical.y-(n.canonical.y>>w<<w),A=u.X>>w;u.aP(y.posMatrix,0,u.X,0,u.X,0,1),u.J(y.posMatrix,y.posMatrix,[C*A,k*A,0]),u.K(y.posMatrix,y.posMatrix,[1/2**w,1/2**w,0]),l[d]=y}}return l}getSourceTile(n,l){const d=this.sourceCache._source;let m=n.overscaledZ-this.deltaZoom;if(m>d.maxzoom&&(m=d.maxzoom),m<d.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(m).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!y||!y.dem)&&l)for(;m>=d.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(n.scaledTo(m--).key);return y}tilesAfterTime(n=Date.now()){return Object.values(this._tiles).filter(l=>l.timeAdded>=n)}}class Fh{constructor(n,l,d){this.painter=n,this.sourceCache=new Dy(l),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,l,d,m=u.X){var y;if(!(l>=0&&l<m&&d>=0&&d<m))return 0;const w=this.getTerrainData(n),C=(y=w.tile)===null||y===void 0?void 0:y.dem;if(!C)return 0;const k=function(Y,ie,ae){var ue=ie[0],de=ie[1];return Y[0]=ae[0]*ue+ae[4]*de+ae[12],Y[1]=ae[1]*ue+ae[5]*de+ae[13],Y}([],[l/m*u.X,d/m*u.X],w.u_terrain_matrix),A=[k[0]*C.dim,k[1]*C.dim],L=Math.floor(A[0]),F=Math.floor(A[1]),$=A[0]-L,H=A[1]-F;return C.get(L,F)*(1-$)*(1-H)+C.get(L+1,F)*$*(1-H)+C.get(L,F+1)*(1-$)*H+C.get(L+1,F+1)*$*H}getElevationForLngLatZoom(n,l){if(!u.bb(l,n.wrap()))return 0;const{tileID:d,mercatorX:m,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(n,l);return this.getElevation(d,m%u.X,y%u.X,u.X)}getElevation(n,l,d,m=u.X){return this.getDEMElevation(n,l,d,m)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const m=this.painter.context,y=new u.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Ve(m,y,m.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ve(m,new u.R({width:1,height:1}),m.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.an([])}const l=this.sourceCache.getSourceTile(n,!0);if(l&&l.dem&&(!l.demTexture||l.needsTerrainPrepare)){const m=this.painter.context;l.demTexture=this.painter.getTileTexture(l.dem.stride),l.demTexture?l.demTexture.update(l.dem.getPixels(),{premultiply:!1}):l.demTexture=new Ve(m,l.dem.getPixels(),m.gl.RGBA,{premultiply:!1}),l.demTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),l.needsTerrainPrepare=!1}const d=l&&l+l.tileID.key+n.key;if(d&&!this._demMatrixCache[d]){const m=this.sourceCache.sourceCache._source.maxzoom;let y=n.canonical.z-l.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=m?y=n.canonical.z-m:u.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=n.canonical.x-(n.canonical.x>>y<<y),C=n.canonical.y-(n.canonical.y>>y<<y),k=u.bc(new Float64Array(16),[1/(u.X<<y),1/(u.X<<y),0]);u.J(k,k,[w*u.X,C*u.X,0]),this._demMatrixCache[n.key]={matrix:k,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:l&&l.dem&&l.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:l&&l.dem&&l.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(l&&l.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:l}}getFramebuffer(n){const l=this.painter,d=l.width/devicePixelRatio,m=l.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===m||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ve(l.context,{width:d,height:m,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ve(l.context,{width:d,height:m,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=l.context.createFramebuffer(d,m,!0,!1),this._fbo.depthAttachment.set(l.context.createRenderbuffer(l.context.gl.DEPTH_COMPONENT16,d,m))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const l=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,w=0;y<this._coordsTextureSize;y++)for(let C=0;C<this._coordsTextureSize;C++,w+=4)l[w+0]=255&C,l[w+1]=255&y,l[w+2]=C>>8<<4|y>>8,l[w+3]=0;const d=new u.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(l.buffer)),m=new Ve(n,d,n.gl.RGBA,{premultiply:!1});return m.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=m,m}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);const l=new Uint8Array(4),d=this.painter.context,m=d.gl,y=Math.round(n.x*this.painter.pixelRatio/devicePixelRatio),w=Math.round(n.y*this.painter.pixelRatio/devicePixelRatio),C=Math.round(this.painter.height/devicePixelRatio);d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),m.readPixels(y,C-w-1,1,1,m.RGBA,m.UNSIGNED_BYTE,l),d.bindFramebuffer.set(null);const k=l[0]+(l[2]>>4<<8),A=l[1]+((15&l[2])<<8),L=this.coordsIndex[255-l[3]],F=L&&this.sourceCache.getTileByID(L);if(!F)return null;const $=this._coordsTextureSize,H=(1<<F.tileID.canonical.z)*$;return new u.Z((F.tileID.canonical.x*$+k)/H+F.tileID.wrap,(F.tileID.canonical.y*$+A)/H,this.getElevation(F.tileID,k,A,$))}depthAtPoint(n){const l=new Uint8Array(4),d=this.painter.context,m=d.gl;return d.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),m.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,m.RGBA,m.UNSIGNED_BYTE,l),d.bindFramebuffer.set(null),(l[0]/16777216+l[1]/65536+l[2]/256+l[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const n=this.painter.context,l=new u.bd,d=new u.aY,m=this.meshSize,y=u.X/m,w=m*m;for(let F=0;F<=m;F++)for(let $=0;$<=m;$++)l.emplaceBack($*y,F*y,0);for(let F=0;F<w;F+=m+1)for(let $=0;$<m;$++)d.emplaceBack($+F,m+$+F+1,m+$+F+2),d.emplaceBack($+F,m+$+F+2,$+F+1);const C=l.length,k=C+2*(m+1);for(const F of[0,1])for(let $=0;$<=m;$++)for(const H of[0,1])l.emplaceBack($*y,F*u.X,H);for(let F=0;F<2*m;F+=2)d.emplaceBack(k+F,k+F+1,k+F+3),d.emplaceBack(k+F,k+F+3,k+F+2),d.emplaceBack(C+F,C+F+3,C+F+1),d.emplaceBack(C+F,C+F+2,C+F+3);const A=l.length,L=A+2*(m+1);for(const F of[0,1])for(let $=0;$<=m;$++)for(const H of[0,1])l.emplaceBack(F*u.X,$*y,H);for(let F=0;F<2*m;F+=2)d.emplaceBack(A+F,A+F+1,A+F+3),d.emplaceBack(A+F,A+F+3,A+F+2),d.emplaceBack(L+F,L+F+3,L+F+1),d.emplaceBack(L+F,L+F+2,L+F+3);return this._mesh=new yu(n.createVertexBuffer(l,Lh.members),n.createIndexBuffer(d),u.a0.simpleSegment(0,0,l.length,d.length)),this._mesh}getMeshFrameDelta(n){return 2*Math.PI*u.be/Math.pow(2,n)/5}getMinTileElevationForLngLatZoom(n,l){var d;const{tileID:m}=this._getOverscaledTileIDFromLngLatZoom(n,l);return(d=this.getMinMaxElevation(m).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(n){const l=this.getTerrainData(n).tile,d={minElevation:null,maxElevation:null};return l&&l.dem&&(d.minElevation=l.dem.min*this.exaggeration,d.maxElevation=l.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(n,l){const d=u.Z.fromLngLat(n.wrap()),m=(1<<l)*u.X,y=d.x*m,w=d.y*m,C=Math.floor(y/u.X),k=Math.floor(w/u.X);return{tileID:new u.S(l,0,l,C,k),mercatorX:y,mercatorY:w}}}class Ry{constructor(n,l,d){this._context=n,this._size=l,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const l=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new Ve(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),l.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),l.colorAttachment.set(d.texture),{id:n,fbo:l,texture:d,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(l=>n.id!==l),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const l of this._recentlyUsed)if(!this._objects[l].inUse)return this._objects[l];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(n=>!n.inUse)===!1}}const ca={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class ap{constructor(n,l){this.painter=n,this.terrain=l,this.pool=new Ry(n.context,30,l.sourceCache.tileSize*l.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,l){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter(d=>!n._layers[d].isHidden(l)),this._coordsDescendingInv={};for(const d in n.sourceCaches){this._coordsDescendingInv[d]={};const m=n.sourceCaches[d].getVisibleCoordinates();for(const y of m){const w=this.terrain.sourceCache.getTerrainCoords(y);for(const C in w)this._coordsDescendingInv[d][C]||(this._coordsDescendingInv[d][C]=[]),this._coordsDescendingInv[d][C].push(w[C])}}this._coordsDescendingInvStr={};for(const d of n._order){const m=n._layers[d],y=m.source;if(ca[m.type]&&!this._coordsDescendingInvStr[y]){this._coordsDescendingInvStr[y]={};for(const w in this._coordsDescendingInv[y])this._coordsDescendingInvStr[y][w]=this._coordsDescendingInv[y][w].map(C=>C.key).sort().join()}}for(const d of this._renderableTiles)for(const m in this._coordsDescendingInvStr){const y=this._coordsDescendingInvStr[m][d.tileID.key];y&&y!==d.rttCoords[m]&&(d.rtt=[])}}renderLayer(n){if(n.isHidden(this.painter.transform.zoom))return!1;const l=n.type,d=this.painter,m=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(ca[l]&&(this._prevType&&ca[this._prevType]||this._stacks.push([]),this._prevType=l,this._stacks[this._stacks.length-1].push(n.id),!m))return!0;if(ca[this._prevType]||ca[l]&&m){this._prevType=l;const y=this._stacks.length-1,w=this._stacks[y]||[];for(const C of this._renderableTiles){if(this.pool.isFull()&&(Qf(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(C),C.rtt[y]){const A=this.pool.getObjectForId(C.rtt[y].id);if(A.stamp===C.rtt[y].stamp){this.pool.useObject(A);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),C.rtt[y]={id:k.id,stamp:k.stamp},d.context.bindFramebuffer.set(k.fbo.framebuffer),d.context.clear({color:u.aM.transparent,stencil:0}),d.currentStencilSource=void 0;for(let A=0;A<w.length;A++){const L=d.style._layers[w[A]],F=L.source?this._coordsDescendingInv[L.source][C.tileID.key]:[C.tileID];d.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),d._renderTileClippingMasks(L,F),d.renderLayer(d,d.style.sourceCaches[L.source],L,F),L.source&&(C.rttCoords[L.source]=this._coordsDescendingInvStr[L.source][C.tileID.key])}}return Qf(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ca[l]}return!1}}const Bh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},lp=T,Ly={hash:!1,interactive:!0,bearingSnap:7,attributionControl:la,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Oh=_=>{_.touchstart=_.dragStart,_.touchmoveWindow=_.dragMove,_.touchend=_.dragEnd},Fy={showCompass:!0,showZoom:!0,visualizePitch:!1};class By{constructor(n,l,d=!1){this.mousedown=w=>{this.startMouse(u.e({},w,{ctrlKey:!0,preventDefault:()=>w.preventDefault()}),I.mousePos(this.element,w)),I.addEventListener(window,"mousemove",this.mousemove),I.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.moveMouse(w,I.mousePos(this.element,w))},this.mouseup=w=>{this.mouseRotate.dragEnd(w),this.mousePitch&&this.mousePitch.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=I.touchPos(this.element,w.targetTouches)[0],this.startTouch(w,this._startPos),I.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),I.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=I.touchPos(this.element,w.targetTouches)[0],this.moveTouch(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const m=n.dragRotate._mouseRotate.getClickTolerance(),y=n.dragRotate._mousePitch.getClickTolerance();this.element=l,this.mouseRotate=Ch({clickTolerance:m,enable:!0}),this.touchRotate=(({enable:w,clickTolerance:C,bearingDegreesPerPixelMoved:k=.8})=>{const A=new Th;return new Ts({clickTolerance:C,move:(L,F)=>({bearingDelta:(F.x-L.x)*k}),moveStateManager:A,enable:w,assignEvents:Oh})})({clickTolerance:m,enable:!0}),this.map=n,d&&(this.mousePitch=kh({clickTolerance:y,enable:!0}),this.touchPitch=(({enable:w,clickTolerance:C,pitchDegreesPerPixelMoved:k=-.5})=>{const A=new Th;return new Ts({clickTolerance:C,move:(L,F)=>({pitchDelta:(F.y-L.y)*k}),moveStateManager:A,enable:w,assignEvents:Oh})})({clickTolerance:y,enable:!0})),I.addEventListener(l,"mousedown",this.mousedown),I.addEventListener(l,"touchstart",this.touchstart,{passive:!1}),I.addEventListener(l,"touchcancel",this.reset)}startMouse(n,l){this.mouseRotate.dragStart(n,l),this.mousePitch&&this.mousePitch.dragStart(n,l),I.disableDrag()}startTouch(n,l){this.touchRotate.dragStart(n,l),this.touchPitch&&this.touchPitch.dragStart(n,l),I.disableDrag()}moveMouse(n,l){const d=this.map,{bearingDelta:m}=this.mouseRotate.dragMove(n,l)||{};if(m&&d.setBearing(d.getBearing()+m),this.mousePitch){const{pitchDelta:y}=this.mousePitch.dragMove(n,l)||{};y&&d.setPitch(d.getPitch()+y)}}moveTouch(n,l){const d=this.map,{bearingDelta:m}=this.touchRotate.dragMove(n,l)||{};if(m&&d.setBearing(d.getBearing()+m),this.touchPitch){const{pitchDelta:y}=this.touchPitch.dragMove(n,l)||{};y&&d.setPitch(d.getPitch()+y)}}off(){const n=this.element;I.removeEventListener(n,"mousedown",this.mousedown),I.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),I.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),I.removeEventListener(window,"touchend",this.touchend),I.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){I.enableDrag(),I.removeEventListener(window,"mousemove",this.mousemove),I.removeEventListener(window,"mouseup",this.mouseup),I.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),I.removeEventListener(window,"touchend",this.touchend)}}let Yr;function un(_,n,l){const d=new u.N(_.lng,_.lat);if(_=new u.N(_.lng,_.lat),n){const m=new u.N(_.lng-360,_.lat),y=new u.N(_.lng+360,_.lat),w=l.locationPoint(_).distSqr(n);l.locationPoint(m).distSqr(n)<w?_=m:l.locationPoint(y).distSqr(n)<w&&(_=y)}for(;Math.abs(_.lng-l.center.lng)>180;){const m=l.locationPoint(_);if(m.x>=0&&m.y>=0&&m.x<=l.width&&m.y<=l.height)break;_.lng>l.center.lng?_.lng-=360:_.lng+=360}return _.lng!==d.lng&&l.locationPoint(_).y>l.height/2-l.getHorizon()?_:d}const ha={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Eu(_,n,l){const d=_.classList;for(const m in ha)d.remove(`maplibregl-${l}-anchor-${m}`);d.add(`maplibregl-${l}-anchor-${n}`)}class Iu extends u.E{constructor(n){if(super(),this._onKeyPress=l=>{const d=l.code,m=l.charCode||l.keyCode;d!=="Space"&&d!=="Enter"&&m!==32&&m!==13||this.togglePopup()},this._onMapClick=l=>{const d=l.originalEvent.target,m=this._element;this._popup&&(d===m||m.contains(d))&&this.togglePopup()},this._update=l=>{var d;if(!this._map)return;const m=this._map.loaded()&&!this._map.isMoving();((l==null?void 0:l.type)==="terrain"||(l==null?void 0:l.type)==="render"&&!m)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?un(this._lngLat,this._flatPos,this._map.transform):(d=this._lngLat)===null||d===void 0?void 0:d.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||l&&l.type!=="moveend"||(this._pos=this._pos.round()),I.setTransform(this._element,`${ha[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${y}`),z.frameAsync(new AbortController).then(()=>{this._updateOpacity(l&&l.type==="moveend")}).catch(()=>{})},this._onMove=l=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.k("dragstart"))),this.fire(new u.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.k("dragend")),this._state="inactive"},this._addDragHandler=l=>{this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._subpixelPositioning=n&&n.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(n==null?void 0:n.opacity,n==null?void 0:n.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=u.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=I.create("div");const l=I.createNS("http://www.w3.org/2000/svg","svg"),d=41,m=27;l.setAttributeNS(null,"display","block"),l.setAttributeNS(null,"height",`${d}px`),l.setAttributeNS(null,"width",`${m}px`),l.setAttributeNS(null,"viewBox",`0 0 ${m} ${d}`);const y=I.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const w=I.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");const C=I.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ue of k){const de=I.createNS("http://www.w3.org/2000/svg","ellipse");de.setAttributeNS(null,"opacity","0.04"),de.setAttributeNS(null,"cx","10.5"),de.setAttributeNS(null,"cy","5.80029008"),de.setAttributeNS(null,"rx",ue.rx),de.setAttributeNS(null,"ry",ue.ry),C.appendChild(de)}const A=I.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill",this._color);const L=I.createNS("http://www.w3.org/2000/svg","path");L.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),A.appendChild(L);const F=I.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"opacity","0.25"),F.setAttributeNS(null,"fill","#000000");const $=I.createNS("http://www.w3.org/2000/svg","path");$.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),F.appendChild($);const H=I.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const Y=I.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ie=I.createNS("http://www.w3.org/2000/svg","circle");ie.setAttributeNS(null,"fill","#000000"),ie.setAttributeNS(null,"opacity","0.25"),ie.setAttributeNS(null,"cx","5.5"),ie.setAttributeNS(null,"cy","5.5"),ie.setAttributeNS(null,"r","5.4999962");const ae=I.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#FFFFFF"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962"),Y.appendChild(ie),Y.appendChild(ae),w.appendChild(C),w.appendChild(A),w.appendChild(F),w.appendChild(H),w.appendChild(Y),l.appendChild(w),l.setAttributeNS(null,"height",d*this._scale+"px"),l.setAttributeNS(null,"width",m*this._scale+"px"),this._element.appendChild(l),this._offset=u.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",l=>{l.preventDefault()}),this._element.addEventListener("mousedown",l=>{l.preventDefault()}),Eu(this._element,this._anchor,"marker"),n&&n.className)for(const l of n.className.split(" "))this._element.classList.add(l);this._popup=null}addTo(n){return this.remove(),this._map=n,this._element.setAttribute("aria-label",n._getUIString("Marker.Title")),n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),I.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=u.N.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const m=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(38.1-13.5+m)],"bottom-right":[-m,-1*(38.1-13.5+m)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(n){return this._subpixelPositioning=n,this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var l,d;if(!(!((l=this._map)===null||l===void 0)&&l.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const m=this._map,y=m.terrain.depthAtPoint(this._pos),w=m.terrain.getElevationForLngLatZoom(this._lngLat,m.transform.tileZoom);if(m.transform.lngLatToCameraDepth(this._lngLat,w)-y<.006)return void(this._element.style.opacity=this._opacity);const C=-this._offset.y/m.transform._pixelPerMeter,k=Math.sin(m.getPitch()*Math.PI/180)*C,A=m.terrain.depthAtPoint(new u.P(this._pos.x,this._pos.y-this._offset.y)),L=m.transform.lngLatToCameraDepth(this._lngLat,w+k)-A>.006;!((d=this._popup)===null||d===void 0)&&d.isOpen()&&L&&this._popup.remove(),this._element.style.opacity=L?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=u.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,l){return n===void 0&&l===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),l!==void 0&&(this._opacityWhenCovered=l),this._map&&this._updateOpacity(!0),this}}const up={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ml=0,gl=!1;const ns={maxWidth:100,unit:"metric"};function yl(_,n,l){const d=l&&l.maxWidth||100,m=_._container.clientHeight/2,y=_.unproject([0,m]),w=_.unproject([d,m]),C=y.distanceTo(w);if(l&&l.unit==="imperial"){const k=3.2808*C;k>5280?at(n,d,k/5280,_._getUIString("ScaleControl.Miles")):at(n,d,k,_._getUIString("ScaleControl.Feet"))}else l&&l.unit==="nautical"?at(n,d,C/1852,_._getUIString("ScaleControl.NauticalMiles")):C>=1e3?at(n,d,C/1e3,_._getUIString("ScaleControl.Kilometers")):at(n,d,C,_._getUIString("ScaleControl.Meters"))}function at(_,n,l,d){const m=function(y){const w=Math.pow(10,`${Math.floor(y)}`.length-1);let C=y/w;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(k){const A=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*A)/A}(C),w*C}(l);_.style.width=n*(m/l)+"px",_.innerHTML=`${m}&nbsp;${d}`}const yt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Mu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Au(_){if(_){if(typeof _=="number"){const n=Math.round(Math.abs(_)/Math.SQRT2);return{center:new u.P(0,0),top:new u.P(0,_),"top-left":new u.P(n,n),"top-right":new u.P(-n,n),bottom:new u.P(0,-_),"bottom-left":new u.P(n,-n),"bottom-right":new u.P(-n,-n),left:new u.P(_,0),right:new u.P(-_,0)}}if(_ instanceof u.P||Array.isArray(_)){const n=u.P.convert(_);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:u.P.convert(_.center||[0,0]),top:u.P.convert(_.top||[0,0]),"top-left":u.P.convert(_["top-left"]||[0,0]),"top-right":u.P.convert(_["top-right"]||[0,0]),bottom:u.P.convert(_.bottom||[0,0]),"bottom-left":u.P.convert(_["bottom-left"]||[0,0]),"bottom-right":u.P.convert(_["bottom-right"]||[0,0]),left:u.P.convert(_.left||[0,0]),right:u.P.convert(_.right||[0,0])}}return Au(new u.P(0,0))}const Vh=T;f.AJAXError=u.bh,f.Evented=u.E,f.LngLat=u.N,f.MercatorCoordinate=u.Z,f.Point=u.P,f.addProtocol=u.bi,f.config=u.a,f.removeProtocol=u.bj,f.AttributionControl=ua,f.BoxZoomHandler=Kr,f.CanvasSource=li,f.CooperativeGesturesHandler=aa,f.DoubleClickZoomHandler=bo,f.DragPanHandler=ip,f.DragRotateHandler=sp,f.EdgeInsets=ia,f.FullscreenControl=class extends u.E{constructor(_={}){super(),this._onFullscreenChange=()=>{var n;let l=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((n=l==null?void 0:l.shadowRoot)===null||n===void 0)&&n.fullscreenElement;)l=l.shadowRoot.fullscreenElement;l===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:u.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=I.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){I.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const _=this._fullscreenButton=I.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);I.create("span","maplibregl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new u.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},f.GeoJSONSource=lo,f.GeolocateControl=class extends u.E{constructor(_){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new u.k("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.k("geolocate",n)),this._finish()}},this._updateCamera=n=>{const l=new u.N(n.coords.longitude,n.coords.latitude),d=n.coords.accuracy,m=this._map.getBearing(),y=u.e({bearing:m},this.options.fitBoundsOptions),w=ke.fromLngLat(l,d);this._map.fitBounds(w,y,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const l=new u.N(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=n=>{if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&gl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.k("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=I.create("button","maplibregl-ctrl-geolocate",this._container),I.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=n=>{if(this._map){if(n===!1){u.w("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=I.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Iu({element:this._dotElement}),this._circleElement=I.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Iu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.k("trackuserlocationend")),this.fire(new u.k("userlocationlostfocus")))})}},this.options=u.e({},up,_)}onAdd(_){return this._map=_,this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return u._(this,arguments,void 0,function*(n=!1){if(Yr!==void 0&&!n)return Yr;if(window.navigator.permissions===void 0)return Yr=!!window.navigator.geolocation,Yr;try{Yr=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Yr=!!window.navigator.geolocation}return Yr})}().then(n=>this._finishSetupUI(n)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),I.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ml=0,gl=!1}_isOutOfMapMaxBounds(_){const n=this._map.getMaxBounds(),l=_.coords;return n&&(l.longitude<n.getWest()||l.longitude>n.getEast()||l.latitude<n.getSouth()||l.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const _=this._map.getBounds(),n=_.getSouthEast(),l=_.getNorthEast(),d=n.distanceTo(l),m=Math.ceil(this._accuracy/(d/this._map._container.clientHeight)*2);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}trigger(){if(!this._setup)return u.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ml--,gl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.k("trackuserlocationstart")),this.fire(new u.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ml++,ml>1?(_={maximumAge:6e5,timeout:0},gl=!0):(_=this.options.positionOptions,gl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},f.Hash=vu,f.ImageSource=bs,f.KeyboardHandler=hi,f.LngLatBounds=ke,f.LogoControl=Rh,f.Map=class extends op{constructor(_){u.bf.mark(u.bg.create);const n=Object.assign(Object.assign({},Ly),_);if(n.minZoom!=null&&n.maxZoom!=null&&n.minZoom>n.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(n.minPitch!=null&&n.maxPitch!=null&&n.minPitch>n.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(n.minPitch!=null&&n.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(n.maxPitch!=null&&n.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new sa(n.minZoom,n.maxZoom,n.minPitch,n.maxPitch,n.renderWorldCopies),{bearingSnap:n.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Lt,this._controls=[],this._mapId=u.a4(),this._contextLost=l=>{l.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new u.k("webglcontextlost",{originalEvent:l}))},this._contextRestored=l=>{this._setupPainter(),this.resize(),this._update(),this.fire(new u.k("webglcontextrestored",{originalEvent:l}))},this._onMapScroll=l=>{if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=n.interactive,this._maxTileCacheSize=n.maxTileCacheSize,this._maxTileCacheZoomLevels=n.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=n.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=n.preserveDrawingBuffer===!0,this._antialias=n.antialias===!0,this._trackResize=n.trackResize===!0,this._bearingSnap=n.bearingSnap,this._refreshExpiredTiles=n.refreshExpiredTiles===!0,this._fadeDuration=n.fadeDuration,this._crossSourceCollisions=n.crossSourceCollisions===!0,this._collectResourceTiming=n.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Bh),n.locale),this._clickTolerance=n.clickTolerance,this._overridePixelRatio=n.pixelRatio,this._maxCanvasSize=n.maxCanvasSize,this.transformCameraUpdate=n.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=n.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=X.addThrottleControl(()=>this.isMoving()),this._requestManager=new ne(n.transformRequest),typeof n.container=="string"){if(this._container=document.getElementById(n.container),!this._container)throw new Error(`Container '${n.container}' not found.`)}else{if(!(n.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=n.container}if(n.maxBounds&&this.setMaxBounds(n.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let l=!1;const d=ul(m=>{this._trackResize&&!this._removed&&(this.resize(m),this.redraw())},50);this._resizeObserver=new ResizeObserver(m=>{l?d(m):l=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Dh(this,n),this._hash=n.hash&&new vu(typeof n.hash=="string"&&n.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),n.bounds&&(this.resize(),this.fitBounds(n.bounds,u.e({},n.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=n.localIdeographFontFamily,this._validateStyle=n.validateStyle,n.style&&this.setStyle(n.style,{localIdeographFontFamily:n.localIdeographFontFamily}),n.attributionControl&&this.addControl(new ua(typeof n.attributionControl=="boolean"?void 0:n.attributionControl)),n.maplibreLogo&&this.addControl(new Rh,n.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new u.k(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new u.k(`${l.dataType}dataloading`,l))}),this.on("dataabort",l=>{this.fire(new u.k("sourcedataabort",l))})}_getMapId(){return this._mapId}addControl(_,n){if(n===void 0&&(n=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new u.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=_.onAdd(this);this._controls.push(_);const d=this._controlPositions[n];return n.indexOf("bottom")!==-1?d.insertBefore(l,d.firstChild):d.appendChild(l),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new u.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(_);return n>-1&&this._controls.splice(n,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}calculateCameraOptionsFromTo(_,n,l,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(_,n,l,d)}resize(_){var n;const l=this._containerDimensions(),d=l[0],m=l[1],y=this._getClampedPixelRatio(d,m);if(this._resizeCanvas(d,m,y),this.painter.resize(d,m,y),this.painter.overLimit()){const C=this.painter.context.gl;this._maxCanvasSize=[C.drawingBufferWidth,C.drawingBufferHeight];const k=this._getClampedPixelRatio(d,m);this._resizeCanvas(d,m,k),this.painter.resize(d,m,k)}this.transform.resize(d,m),(n=this._requestedCameraState)===null||n===void 0||n.resize(d,m);const w=!this._moving;return w&&(this.stop(),this.fire(new u.k("movestart",_)).fire(new u.k("move",_))),this.fire(new u.k("resize",_)),w&&this.fire(new u.k("moveend",_)),this}_getClampedPixelRatio(_,n){const{0:l,1:d}=this._maxCanvasSize,m=this.getPixelRatio(),y=_*m,w=n*m;return Math.min(y>l?l/y:1,w>d?d/w:1)*m}getPixelRatio(){var _;return(_=this._overridePixelRatio)!==null&&_!==void 0?_:devicePixelRatio}setPixelRatio(_){this._overridePixelRatio=_,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(_){return this.transform.setMaxBounds(ke.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_&&this.setZoom(_),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_&&this.setZoom(_),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_&&this.setPitch(_),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_&&this.setPitch(_),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this._update()}project(_){return this.transform.locationPoint(u.N.convert(_),this.style&&this.terrain)}unproject(_){return this.transform.pointLocation(u.P.convert(_),this.terrain)}isMoving(){var _;return this._moving||((_=this.handlers)===null||_===void 0?void 0:_.isMoving())}isZooming(){var _;return this._zooming||((_=this.handlers)===null||_===void 0?void 0:_.isZooming())}isRotating(){var _;return this._rotating||((_=this.handlers)===null||_===void 0?void 0:_.isRotating())}_createDelegatedListener(_,n,l){if(_==="mouseenter"||_==="mouseover"){let d=!1;return{layers:n,listener:l,delegates:{mousemove:y=>{const w=n.filter(k=>this.getLayer(k)),C=w.length!==0?this.queryRenderedFeatures(y.point,{layers:w}):[];C.length?d||(d=!0,l.call(this,new ar(_,this,y.originalEvent,{features:C}))):d=!1},mouseout:()=>{d=!1}}}}if(_==="mouseleave"||_==="mouseout"){let d=!1;return{layers:n,listener:l,delegates:{mousemove:w=>{const C=n.filter(k=>this.getLayer(k));(C.length!==0?this.queryRenderedFeatures(w.point,{layers:C}):[]).length?d=!0:d&&(d=!1,l.call(this,new ar(_,this,w.originalEvent)))},mouseout:w=>{d&&(d=!1,l.call(this,new ar(_,this,w.originalEvent)))}}}}{const d=m=>{const y=n.filter(C=>this.getLayer(C)),w=y.length!==0?this.queryRenderedFeatures(m.point,{layers:y}):[];w.length&&(m.features=w,l.call(this,m),delete m.features)};return{layers:n,listener:l,delegates:{[_]:d}}}}_saveDelegatedListener(_,n){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(n)}_removeDelegatedListener(_,n,l){if(!this._delegatedListeners||!this._delegatedListeners[_])return;const d=this._delegatedListeners[_];for(let m=0;m<d.length;m++){const y=d[m];if(y.listener===l&&y.layers.length===n.length&&y.layers.every(w=>n.includes(w))){for(const w in y.delegates)this.off(w,y.delegates[w]);return void d.splice(m,1)}}}on(_,n,l){if(l===void 0)return super.on(_,n);const d=this._createDelegatedListener(_,typeof n=="string"?[n]:n,l);this._saveDelegatedListener(_,d);for(const m in d.delegates)this.on(m,d.delegates[m]);return this}once(_,n,l){if(l===void 0)return super.once(_,n);const d=typeof n=="string"?[n]:n,m=this._createDelegatedListener(_,d,l);for(const y in m.delegates){const w=m.delegates[y];m.delegates[y]=(...C)=>{this._removeDelegatedListener(_,d,l),w(...C)}}this._saveDelegatedListener(_,m);for(const y in m.delegates)this.once(y,m.delegates[y]);return this}off(_,n,l){return l===void 0?super.off(_,n):(this._removeDelegatedListener(_,typeof n=="string"?[n]:n,l),this)}queryRenderedFeatures(_,n){if(!this.style)return[];let l;const d=_ instanceof u.P||Array.isArray(_),m=d?_:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(d?{}:_)||{},m instanceof u.P||typeof m[0]=="number")l=[u.P.convert(m)];else{const y=u.P.convert(m[0]),w=u.P.convert(m[1]);l=[y,new u.P(w.x,y.y),w,new u.P(y.x,w.y),y]}return this.style.queryRenderedFeatures(l,n,this.transform)}querySourceFeatures(_,n){return this.style.querySourceFeatures(_,n)}setStyle(_,n){return(n=u.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&_?(this._diffStyle(_,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(_,n))}setTransformRequest(_){return this._requestManager.setTransformRequest(_),this}_getUIString(_){const n=this._locale[_];if(n==null)throw new Error(`Missing UI string '${_}'`);return n}_updateStyle(_,n){if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(_,n));const l=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!_)),_?(this.style=new nu(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_,n,l):this.style.loadJSON(_,n,l),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new nu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,n){if(typeof _=="string"){const l=this._requestManager.transformRequest(_,"Style");u.h(l,new AbortController).then(d=>{this._updateDiff(d.data,n)}).catch(d=>{d&&this.fire(new u.j(d))})}else typeof _=="object"&&this._updateDiff(_,n)}_updateDiff(_,n){try{this.style.setState(_,n)&&this._update(!0)}catch(l){u.w(`Unable to perform style diff: ${l.message||l.error||l}.  Rebuilding the style from scratch.`),this._updateStyle(_,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.w("There is no style added to the map.")}addSource(_,n){return this._lazyInitEmptyStyle(),this.style.addSource(_,n),this._update(!0)}isSourceLoaded(_){const n=this.style&&this.style.sourceCaches[_];if(n!==void 0)return n.loaded();this.fire(new u.j(new Error(`There is no source with ID '${_}'`)))}setTerrain(_){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),_){const n=this.style.sourceCaches[_.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${_.source}`);this.terrain===null&&n.reload();for(const l in this.style._layers){const d=this.style._layers[l];d.type==="hillshade"&&d.source===_.source&&u.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Fh(this.painter,n,_),this.painter.renderToTexture=new ap(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=l=>{l.dataType==="style"?this.terrain.sourceCache.freeRtt():l.dataType==="source"&&l.tile&&(l.sourceId!==_.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(l.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new u.k("terrain",{terrain:_})),this}getTerrain(){var _,n;return(n=(_=this.terrain)===null||_===void 0?void 0:_.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const _=this.style&&this.style.sourceCaches;for(const n in _){const l=_[n]._tiles;for(const d in l){const m=l[d];if(m.state!=="loaded"&&m.state!=="errored")return!1}}return!0}removeSource(_){return this.style.removeSource(_),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,n,l={}){const{pixelRatio:d=1,sdf:m=!1,stretchX:y,stretchY:w,content:C,textFitWidth:k,textFitHeight:A}=l;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||u.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:L,height:F,data:$}=n,H=n;return this.style.addImage(_,{data:new u.R({width:L,height:F},new Uint8Array($)),pixelRatio:d,stretchX:y,stretchY:w,content:C,textFitWidth:k,textFitHeight:A,sdf:m,version:0,userImage:H}),H.onAdd&&H.onAdd(this,_),this}}{const{width:L,height:F,data:$}=z.getImageData(n);this.style.addImage(_,{data:new u.R({width:L,height:F},$),pixelRatio:d,stretchX:y,stretchY:w,content:C,textFitWidth:k,textFitHeight:A,sdf:m,version:0})}}updateImage(_,n){const l=this.style.getImage(_);if(!l)return this.fire(new u.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=n instanceof HTMLImageElement||u.b(n)?z.getImageData(n):n,{width:m,height:y,data:w}=d;if(m===void 0||y===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(m!==l.data.width||y!==l.data.height)return this.fire(new u.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(n instanceof HTMLImageElement||u.b(n));return l.data.replace(w,C),this.style.updateImage(_,l),this}getImage(_){return this.style.getImage(_)}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new u.j(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_){return X.getImage(this._requestManager.transformRequest(_,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(_,n){return this._lazyInitEmptyStyle(),this.style.addLayer(_,n),this._update(!0)}moveLayer(_,n){return this.style.moveLayer(_,n),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(_,n,l){return this.style.setLayerZoomRange(_,n,l),this._update(!0)}setFilter(_,n,l={}){return this.style.setFilter(_,n,l),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,n,l,d={}){return this.style.setPaintProperty(_,n,l,d),this._update(!0)}getPaintProperty(_,n){return this.style.getPaintProperty(_,n)}setLayoutProperty(_,n,l,d={}){return this.style.setLayoutProperty(_,n,l,d),this._update(!0)}getLayoutProperty(_,n){return this.style.getLayoutProperty(_,n)}setGlyphs(_,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(_,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(_,n,l={}){return this._lazyInitEmptyStyle(),this.style.addSprite(_,n,l,d=>{d||this._update(!0)}),this}removeSprite(_){return this._lazyInitEmptyStyle(),this.style.removeSprite(_),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(_,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(_,n,l=>{l||this._update(!0)}),this}setLight(_,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,n),this._update(!0)}getLight(){return this.style.getLight()}setSky(_){return this._lazyInitEmptyStyle(),this.style.setSky(_),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(_,n){return this.style.setFeatureState(_,n),this._update()}removeFeatureState(_,n){return this.style.removeFeatureState(_,n),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let _=0,n=0;return this._container&&(_=this._container.clientWidth||400,n=this._container.clientHeight||300),[_,n]}_setupContainer(){const _=this._container;_.classList.add("maplibregl-map");const n=this._canvasContainer=I.create("div","maplibregl-canvas-container",_);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=I.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const l=this._containerDimensions(),d=this._getClampedPixelRatio(l[0],l[1]);this._resizeCanvas(l[0],l[1],d);const m=this._controlContainer=I.create("div","maplibregl-control-container",_),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{y[w]=I.create("div",`maplibregl-ctrl-${w} `,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,n,l){this._canvas.width=Math.floor(l*_),this._canvas.height=Math.floor(l*n),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const _={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let n=null;this._canvas.addEventListener("webglcontextcreationerror",d=>{n={requestedAttributes:_},d&&(n.statusMessage=d.statusMessage,n.type=d.type)},{once:!0});const l=this._canvas.getContext("webgl2",_)||this._canvas.getContext("webgl",_);if(!l){const d="Failed to initialize WebGL";throw n?(n.message=d,new Error(JSON.stringify(n))):new Error(d)}this.painter=new _u(l,this.transform),G.testSupport(l)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_render(_){const n=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._removed)return;let l=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const m=this.transform.zoom,y=z.now();this.style.zoomHistory.update(m,y);const w=new u.z(m,{now:y,fadeDuration:n,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),C=w.crossFadingFactor();C===1&&C===this._crossFadingFactor||(l=!0,this._crossFadingFactor=C),this.style.update(w)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,n,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:n,showPadding:this.showPadding}),this.fire(new u.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.bf.mark(u.bg.load),this.fire(new u.k("load"))),this.style&&(this.style.hasTransitions()||l)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.k("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,u.bf.mark(u.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var _;this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),X.removeThrottleControl(this._imageQueueHandle),(_=this._resizeObserver)===null||_===void 0||_.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n!=null&&n.loseContext&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),I.remove(this._canvasContainer),I.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),u.bf.clearMetrics(),this._removed=!0,this.fire(new u.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,z.frameAsync(this._frameRequest).then(_=>{u.bf.frame(_),this._frameRequest=null,this._render(_)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get version(){return lp}getCameraTargetElevation(){return this.transform.elevation}},f.MapMouseEvent=ar,f.MapTouchEvent=vo,f.MapWheelEvent=tp,f.Marker=Iu,f.NavigationControl=class{constructor(_){this._updateZoomButtons=()=>{const n=this._map.getZoom(),l=n===this._map.getMaxZoom(),d=n===this._map.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=n},this._setButtonTitle=(n,l)=>{const d=this._map._getUIString(`NavigationControl.${l}`);n.title=d,n.setAttribute("aria-label",d)},this.options=u.e({},Fy,_),this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),I.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),I.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=I.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new By(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){I.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,n){const l=I.create("button",_,this._container);return l.type="button",l.addEventListener("click",n),l}},f.Popup=class extends u.E{constructor(_){super(),this.remove=()=>(this._content&&I.remove(this._content),this._container&&(I.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new u.k("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{var l;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=I.create("div","maplibregl-popup",this._map.getContainer()),this._tip=I.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const C of this.options.className.split(" "))this._container.classList.add(C);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?un(this._lngLat,this._flatPos,this._map.transform):(l=this._lngLat)===null||l===void 0?void 0:l.wrap(),this._trackPointer&&!n)return;const d=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationPoint(this._lngLat));let m=this.options.anchor;const y=Au(this.options.offset);if(!m){const C=this._container.offsetWidth,k=this._container.offsetHeight;let A;A=d.y+y.bottom.y<k?["top"]:d.y>this._map.transform.height-k?["bottom"]:[],d.x<C/2?A.push("left"):d.x>this._map.transform.width-C/2&&A.push("right"),m=A.length===0?"bottom":A.join("-")}let w=d.add(y[m]);this.options.subpixelPositioning||(w=w.round()),I.setTransform(this._container,`${ha[m]} translate(${w.x}px,${w.y}px)`),Eu(this._container,m,"popup")},this._onClose=()=>{this.remove()},this.options=u.e(Object.create(yt),_)}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=u.N.convert(_),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const n=document.createDocumentFragment(),l=document.createElement("body");let d;for(l.innerHTML=_;d=l.firstChild,d;)n.appendChild(d);return this.setDOMContent(n)}getMaxWidth(){var _;return(_=this._container)===null||_===void 0?void 0:_.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=I.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){return this._container&&this._container.classList.add(_),this}removeClassName(_){return this._container&&this._container.classList.remove(_),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){if(this._container)return this._container.classList.toggle(_)}setSubpixelPositioning(_){this.options.subpixelPositioning=_}_createCloseButton(){this.options.closeButton&&(this._closeButton=I.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(Mu);_&&_.focus()}},f.RasterDEMTileSource=ln,f.RasterTileSource=Ot,f.ScaleControl=class{constructor(_){this._onMove=()=>{yl(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,yl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ns),_)}getDefaultPosition(){return"bottom-left"}onAdd(_){return this._map=_,this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){I.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},f.ScrollZoomHandler=Ai,f.Style=nu,f.TerrainControl=class{constructor(_){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=_}onAdd(_){return this._map=_,this._container=I.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=I.create("button","maplibregl-ctrl-terrain",this._container),I.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){I.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},f.TwoFingersTouchPitchHandler=pl,f.TwoFingersTouchRotateHandler=Mh,f.TwoFingersTouchZoomHandler=Eh,f.TwoFingersTouchZoomRotateHandler=zh,f.VectorTileSource=Ci,f.VideoSource=qo,f.addSourceType=(_,n)=>u._(void 0,void 0,void 0,function*(){if(Ja(_))throw new Error(`A source type called "${_}" already exists.`);((l,d)=>{Ya[l]=d})(_,n)}),f.clearPrewarmedResources=function(){const _=Dn;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(Gn),Dn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},f.getMaxParallelImageRequests=function(){return u.a.MAX_PARALLEL_IMAGE_REQUESTS},f.getRTLTextPluginStatus=function(){return Yi().getRTLTextPluginStatus()},f.getVersion=function(){return Vh},f.getWorkerCount=function(){return sr.workerCount},f.getWorkerUrl=function(){return u.a.WORKER_URL},f.importScriptInWorkers=function(_){return ao().broadcast("IS",_)},f.prewarm=function(){vs().acquire(Gn)},f.setMaxParallelImageRequests=function(_){u.a.MAX_PARALLEL_IMAGE_REQUESTS=_},f.setRTLTextPlugin=function(_,n){return Yi().setRTLTextPlugin(_,n)},f.setWorkerCount=function(_){sr.workerCount=_},f.setWorkerUrl=function(_){u.a.WORKER_URL=_}});var p=i;return p})})(GE);var Ol=GE.exports;const RF=XT(Ol),LF=HT({__proto__:null,default:RF},[Ol]),FF={width:"100%",background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:8,padding:"8px 10px",color:"#0f172a",fontSize:13,outline:"none",boxSizing:"border-box"},BF={position:"fixed",background:"#fff",border:"1px solid #e2e8f0",borderRadius:8,overflow:"hidden",zIndex:9999,boxShadow:"0 4px 16px rgba(0,0,0,0.1)"},OF={padding:"9px 12px",fontSize:12,color:"#1e293b",cursor:"pointer"};function hT({label:e,value:t,options:i,onInput:a,onSelect:h}){const[p,f]=le.useState((t==null?void 0:t.name)??""),[u,T]=le.useState(!1),[E,D]=le.useState(null),[z,I]=le.useState(null),G=le.useRef(null),K=le.useRef(null);le.useEffect(()=>{f((t==null?void 0:t.name)??"")},[t]),le.useEffect(()=>{const j=U=>{G.current&&!G.current.contains(U.target)&&T(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]);const Q=()=>{K.current&&I(K.current.getBoundingClientRect())},ce=u&&i.length>0&&z&&Cg.createPortal(Ae.jsx("div",{style:{...BF,top:z.bottom+4,left:z.left,width:z.width},children:i.map((j,U)=>Ae.jsx("div",{style:{...OF,background:E===U?"#f1f5f9":"transparent"},onMouseEnter:()=>D(U),onMouseLeave:()=>D(null),onMouseDown:()=>{h(j),f(j.name),T(!1)},children:j.name},j.id))}),document.body);return Ae.jsxs("div",{ref:G,children:[Ae.jsx("div",{style:{fontSize:10,color:"#94a3b8",fontWeight:600,letterSpacing:"0.06em",textTransform:"uppercase",marginBottom:5},children:e}),Ae.jsx("input",{ref:K,style:FF,value:p,placeholder:`Choose ${e.toLowerCase()}...`,onChange:j=>{f(j.target.value),a(j.target.value),Q(),T(!0),j.target.value||h(null)},onFocus:()=>{Q(),i.length>0&&T(!0)}}),ce]})}function VF(){return Ae.jsx("span",{style:{display:"inline-block",width:13,height:13,border:"2px solid rgba(255,255,255,0.35)",borderTopColor:"#fff",borderRadius:"50%",animation:"spin 0.7s linear infinite",verticalAlign:"middle",marginRight:6}})}function NF({onRoutes:e,targetMiles:t,polygon:i}){const{current:a}=xf(),[h,p]=le.useState(null),[f,u]=le.useState(null),[T,E]=le.useState([]),[D,z]=le.useState([]),[I,G]=le.useState(!1),[K,Q]=le.useState(!1),[ce,j]=le.useState(0),[U,X]=le.useState(null),ne=le.useRef(null),ge=le.useRef(null),fe=le.useRef(null),we=le.useRef(null),Ie=le.useRef(null),Ne=le.useRef(null),$e=le.useCallback((ze,Le,ot)=>{ot.current&&clearTimeout(ot.current),ot.current=setTimeout(async()=>{Le(await JR(ze))},250)},[]);le.useEffect(()=>{var xt,_t;if(!a)return;const ze=a.getMap();(xt=fe.current)==null||xt.remove(),(_t=we.current)==null||_t.remove(),fe.current=null,we.current=null;const Le=((h==null?void 0:h.id)??null)!==Ie.current,ot=((f==null?void 0:f.id)??null)!==Ne.current;if(Ie.current=(h==null?void 0:h.id)??null,Ne.current=(f==null?void 0:f.id)??null,I)h!=null&&h.coordinates&&(fe.current=new Ol.Marker({color:"#2563eb"}).setLngLat(h.coordinates).addTo(ze),Le&&a.flyTo({center:h.coordinates,zoom:13}));else if(h!=null&&h.coordinates&&(fe.current=new Ol.Marker({color:"#2563eb"}).setLngLat(h.coordinates).addTo(ze)),f!=null&&f.coordinates&&(we.current=new Ol.Marker({color:"#1e40af"}).setLngLat(f.coordinates).addTo(ze)),h!=null&&h.coordinates&&(f!=null&&f.coordinates)&&(h.coordinates[0]!==f.coordinates[0]||h.coordinates[1]!==f.coordinates[1])){if(Le||ot){const Oe=new Ol.LngLatBounds(h.coordinates,h.coordinates);Oe.extend(f.coordinates),a.fitBounds(Oe,{padding:80,duration:800})}}else h!=null&&h.coordinates&&Le?a.flyTo({center:h.coordinates,zoom:13}):f!=null&&f.coordinates&&ot&&a.flyTo({center:f.coordinates,zoom:13})},[h,f,I,a]),le.useEffect(()=>()=>{var ze,Le;(ze=fe.current)==null||ze.remove(),(Le=we.current)==null||Le.remove()},[]);const Ve=I?!!h:!!(h&&f),J=async()=>{if(!h)return;Q(!0),j(0),X(null),e([]);let ze=[];I?ze=await XR(h.coordinates,t,i,()=>{j(Le=>Le+1)}):f&&(ze=await KR(h.coordinates,f.coordinates)),ze.length>0?e(ze):X("No route found. Try different locations."),Q(!1)};return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),Ae.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[Ae.jsx(hT,{label:"Start",value:h,options:T,onInput:ze=>$e(ze,E,ne),onSelect:ze=>{p(ze),e([]),X(null)}}),Ae.jsx(P0,{children:!I&&Ae.jsx(vm.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.18},children:Ae.jsx(hT,{label:"End",value:f,options:D,onInput:ze=>$e(ze,z,ge),onSelect:ze=>{u(ze),e([]),X(null)}})},"end")}),Ae.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:2},children:[Ae.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer",userSelect:"none",flex:1},children:[Ae.jsx("div",{onClick:()=>{G(ze=>!ze),e([]),X(null)},style:{width:32,height:18,borderRadius:9,background:I?"#3b82f6":"#e2e8f0",position:"relative",transition:"background 0.2s",flexShrink:0},children:Ae.jsx("div",{style:{position:"absolute",top:2,left:I?16:2,width:14,height:14,borderRadius:"50%",background:"#fff",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.2)"}})}),Ae.jsx("span",{style:{fontSize:12,color:"#64748b"},children:"Loop"})]}),Ae.jsxs("button",{onClick:J,disabled:!Ve||K,style:{flex:2,display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 0",borderRadius:8,border:"none",background:Ve&&!K||K?"#3b82f6":"#f1f5f9",color:Ve||K?"#fff":"#94a3b8",fontSize:13,fontWeight:600,cursor:Ve&&!K?"pointer":"default",transition:"background 0.2s, color 0.2s"},children:[K&&Ae.jsx(VF,{}),K?ce>0?`Found ${ce}`:"Finding routes":"Get Route"]})]}),U&&Ae.jsx("div",{style:{fontSize:11,color:"#dc2626",marginTop:-4},children:U})]})]})}const El="route-line",dT="route-line-casing",fT="route-line-layer",pT="route-line-arrows",mv="route-arrow";function jF(e){const t=document.createElement("canvas");t.width=e,t.height=e;const i=t.getContext("2d");i.clearRect(0,0,e,e);const a=e/2,h=e*.82,p=e*.28;return i.beginPath(),i.moveTo(h,a),i.lineTo(a-e*.05,a-p),i.lineTo(a-e*.05,a+p),i.closePath(),i.fillStyle="rgba(255,255,255,0.92)",i.fill(),i.getImageData(0,0,e,e)}function $F({route:e}){var h;const t=xf(),i=(h=t==null?void 0:t.current)==null?void 0:h.getMap(),a=le.useRef(!1);return le.useEffect(()=>{if(!i)return;const p={type:"Feature",properties:{},geometry:{type:"LineString",coordinates:e?e.coordinates:[]}},f=()=>{i.hasImage(mv)||i.addImage(mv,jF(32),{pixelRatio:2}),i.getSource(El)?i.getSource(El).setData(p):a.current=!1,a.current||(i.getSource(El)||i.addSource(El,{type:"geojson",data:p,lineMetrics:!0}),i.getLayer(dT)||i.addLayer({id:dT,type:"line",source:El,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#1e40af","line-width":7,"line-opacity":.25}}),i.getLayer(fT)||i.addLayer({id:fT,type:"line",source:El,layout:{"line-join":"round","line-cap":"round"},paint:{"line-gradient":["interpolate",["linear"],["line-progress"],0,"#93c5fd",.5,"#3b82f6",1,"#1e3a8a"],"line-width":4}}),i.getLayer(pT)||i.addLayer({id:pT,type:"symbol",source:El,layout:{"symbol-placement":"line","symbol-spacing":100,"icon-image":mv,"icon-size":.55,"icon-allow-overlap":!0,"icon-ignore-placement":!0}}),a.current=!0)};if(i.isStyleLoaded())f();else{const u=()=>{f(),i.off("styledata",u)};i.on("styledata",u)}},[i,e]),null}function UF(e){const t=[0];for(let i=1;i<e.length;i++){const[a,h]=e[i-1],[p,f]=e[i],u=(p-a)*Math.cos((h+f)*.5*(Math.PI/180))*111320,T=(f-h)*111320;t.push(t[i-1]+Math.sqrt(u*u+T*T))}return{cumulative:t,total:t[t.length-1]}}function qF(e,t,i,a){if(e.length===0)return[0,0];if(a<=0)return e[0];if(a>=1)return e[e.length-1];const h=a*i;let p=0,f=t.length-1;for(;p<f-1;){const G=p+f>>1;t[G]<=h?p=G:f=G}const u=t[f]-t[p],T=u===0?0:(h-t[p])/u,[E,D]=e[p],[z,I]=e[f];return[E+(z-E)*T,D+(I-D)*T]}function GF(){const e=document.createElement("div");return e.style.cssText=`
    width: 14px; height: 14px; border-radius: 50%;
    background: #2563eb; border: 2.5px solid #fff;
    box-shadow: 0 2px 8px rgba(0,0,0,0.5);
    pointer-events: none;
  `,e}function WF({route:e}){const{current:t}=xf(),[i,a]=le.useState(0),h=le.useRef(null),p=le.useRef(null);le.useEffect(()=>{p.current=UF(e.coordinates),a(0)},[e]),le.useEffect(()=>{if(!t)return;const I=t.getMap(),G=GF(),K=new Ol.Marker({element:G,anchor:"center"});return e.coordinates.length>0&&K.setLngLat(e.coordinates[0]).addTo(I),h.current=K,()=>{K.remove(),h.current=null}},[t,e]),le.useEffect(()=>{if(!h.current||!p.current||e.coordinates.length===0)return;const{cumulative:I,total:G}=p.current,K=qF(e.coordinates,I,G,i);h.current.setLngLat(K)},[i,e]);const f=i*e.distanceMiles,u=i*e.durationMinutes,T=Math.round(u),E=Math.floor(T/60),D=T%60,z=E>0?`${E}h ${D}m`:`${T}m`;return Ae.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[Ae.jsxs("div",{style:{position:"relative",height:28,display:"flex",alignItems:"center"},children:[Ae.jsx("div",{style:{position:"absolute",left:0,right:0,height:4,borderRadius:2,background:"#e2e8f0"}}),Ae.jsx("div",{style:{position:"absolute",left:0,height:4,borderRadius:2,background:"#3b82f6",width:`${i*100}%`,transition:"width 0.05s"}}),Ae.jsx("input",{type:"range",min:0,max:1e3,value:Math.round(i*1e3),onChange:I=>a(Number(I.target.value)/1e3),style:{position:"absolute",left:0,right:0,width:"100%",opacity:0,cursor:"pointer",margin:0,height:28}}),Ae.jsx("div",{style:{position:"absolute",left:`calc(${i*100}% - 7px)`,width:14,height:14,borderRadius:"50%",background:"#3b82f6",border:"2px solid #fff",boxShadow:"0 1px 4px rgba(0,0,0,0.4)",pointerEvents:"none",transition:"left 0.05s"}})]}),Ae.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[Ae.jsxs("span",{style:{fontSize:11,color:"#64748b"},children:[f.toFixed(2)," ",Ae.jsxs("span",{style:{color:"#94a3b8"},children:["/ ",e.distanceMiles.toFixed(2)," mi"]})]}),Ae.jsxs("span",{style:{fontSize:11,color:"#64748b"},children:[z," ",Ae.jsx("span",{style:{color:"#94a3b8"},children:"elapsed"})]})]})]})}const mT=e=>e,ZF=()=>{let e=mT;return{configure(t){e=t},generate(t){return e(t)},reset(){e=mT}}},HF=ZF();function Yl(e,...t){const i=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach(a=>i.searchParams.append("args[]",a)),`Minified MUI error #${e}; visit ${i} for the full message.`}function ir(e){if(typeof e!="string")throw new Error(Yl(7));return e.charAt(0).toUpperCase()+e.slice(1)}function ZE(e){var t,i,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var h=e.length;for(t=0;t<h;t++)e[t]&&(i=ZE(e[t]))&&(a&&(a+=" "),a+=i)}else for(i in e)e[i]&&(a&&(a+=" "),a+=i);return a}function jr(){for(var e,t,i=0,a="",h=arguments.length;i<h;i++)(e=arguments[i])&&(t=ZE(e))&&(a&&(a+=" "),a+=t);return a}function kf(e,t,i=void 0){const a={};for(const h in e){const p=e[h];let f="",u=!0;for(let T=0;T<p.length;T+=1){const E=p[T];E&&(f+=(u===!0?"":" ")+t(E),u=!1,i&&i[E]&&(f+=" "+i[E]))}a[h]=f}return a}var HE={exports:{}},mn={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T1=Symbol.for("react.transitional.element"),C1=Symbol.for("react.portal"),Mg=Symbol.for("react.fragment"),Ag=Symbol.for("react.strict_mode"),zg=Symbol.for("react.profiler"),Dg=Symbol.for("react.consumer"),Rg=Symbol.for("react.context"),Lg=Symbol.for("react.forward_ref"),Fg=Symbol.for("react.suspense"),Bg=Symbol.for("react.suspense_list"),Og=Symbol.for("react.memo"),Vg=Symbol.for("react.lazy"),XF=Symbol.for("react.view_transition"),KF=Symbol.for("react.client.reference");function ys(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case T1:switch(e=e.type,e){case Mg:case zg:case Ag:case Fg:case Bg:case XF:return e;default:switch(e=e&&e.$$typeof,e){case Rg:case Lg:case Vg:case Og:return e;case Dg:return e;default:return t}}case C1:return t}}}mn.ContextConsumer=Dg;mn.ContextProvider=Rg;mn.Element=T1;mn.ForwardRef=Lg;mn.Fragment=Mg;mn.Lazy=Vg;mn.Memo=Og;mn.Portal=C1;mn.Profiler=zg;mn.StrictMode=Ag;mn.Suspense=Fg;mn.SuspenseList=Bg;mn.isContextConsumer=function(e){return ys(e)===Dg};mn.isContextProvider=function(e){return ys(e)===Rg};mn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===T1};mn.isForwardRef=function(e){return ys(e)===Lg};mn.isFragment=function(e){return ys(e)===Mg};mn.isLazy=function(e){return ys(e)===Vg};mn.isMemo=function(e){return ys(e)===Og};mn.isPortal=function(e){return ys(e)===C1};mn.isProfiler=function(e){return ys(e)===zg};mn.isStrictMode=function(e){return ys(e)===Ag};mn.isSuspense=function(e){return ys(e)===Fg};mn.isSuspenseList=function(e){return ys(e)===Bg};mn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Mg||e===zg||e===Ag||e===Fg||e===Bg||typeof e=="object"&&e!==null&&(e.$$typeof===Vg||e.$$typeof===Og||e.$$typeof===Rg||e.$$typeof===Dg||e.$$typeof===Lg||e.$$typeof===KF||e.getModuleId!==void 0)};mn.typeOf=ys;HE.exports=mn;var XE=HE.exports;function Ao(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function KE(e){if(le.isValidElement(e)||XE.isValidElementType(e)||!Ao(e))return e;const t={};return Object.keys(e).forEach(i=>{t[i]=KE(e[i])}),t}function Ui(e,t,i={clone:!0}){const a=i.clone?{...e}:e;return Ao(e)&&Ao(t)&&Object.keys(t).forEach(h=>{le.isValidElement(t[h])||XE.isValidElementType(t[h])?a[h]=t[h]:Ao(t[h])&&Object.prototype.hasOwnProperty.call(e,h)&&Ao(e[h])?a[h]=Ui(e[h],t[h],i):i.clone?a[h]=Ao(t[h])?KE(t[h]):t[h]:a[h]=t[h]}),a}function Vd(e,t){return t?Ui(e,t,{clone:!1}):e}function gT(e,t){if(!e.containerQueries)return t;const i=Object.keys(t).filter(a=>a.startsWith("@container")).sort((a,h)=>{var f,u;const p=/min-width:\s*([0-9.]+)/;return+(((f=a.match(p))==null?void 0:f[1])||0)-+(((u=h.match(p))==null?void 0:u[1])||0)});return i.length?i.reduce((a,h)=>{const p=t[h];return delete a[h],a[h]=p,a},{...t}):t}function YF(e,t){return t==="@"||t.startsWith("@")&&(e.some(i=>t.startsWith(`@${i}`))||!!t.match(/^@\d/))}function JF(e,t){const i=t.match(/^@([^/]+)?\/?(.+)?$/);if(!i)return null;const[,a,h]=i,p=Number.isNaN(+a)?a||0:+a;return e.containerQueries(h).up(p)}function QF(e){const t=(p,f)=>p.replace("@media",f?`@container ${f}`:"@container");function i(p,f){p.up=(...u)=>t(e.breakpoints.up(...u),f),p.down=(...u)=>t(e.breakpoints.down(...u),f),p.between=(...u)=>t(e.breakpoints.between(...u),f),p.only=(...u)=>t(e.breakpoints.only(...u),f),p.not=(...u)=>{const T=t(e.breakpoints.not(...u),f);return T.includes("not all and")?T.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):T}}const a={},h=p=>(i(a,p),a);return i(h),{...e,containerQueries:h}}const Ng={xs:0,sm:600,md:900,lg:1200,xl:1536},yT={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${Ng[e]}px)`},eB={containerQueries:e=>({up:t=>{let i=typeof t=="number"?t:Ng[t]||t;return typeof i=="number"&&(i=`${i}px`),e?`@container ${e} (min-width:${i})`:`@container (min-width:${i})`}})};function jo(e,t,i){const a=e.theme||{};if(Array.isArray(t)){const p=a.breakpoints||yT;return t.reduce((f,u,T)=>(f[p.up(p.keys[T])]=i(t[T]),f),{})}if(typeof t=="object"){const p=a.breakpoints||yT;return Object.keys(t).reduce((f,u)=>{if(YF(p.keys,u)){const T=JF(a.containerQueries?a:eB,u);T&&(f[T]=i(t[u],u))}else if(Object.keys(p.values||Ng).includes(u)){const T=p.up(u);f[T]=i(t[u],u)}else{const T=u;f[T]=t[T]}return f},{})}return i(t)}function tB(e={}){var i;return((i=e.keys)==null?void 0:i.reduce((a,h)=>{const p=e.up(h);return a[p]={},a},{}))||{}}function _T(e,t){return e.reduce((i,a)=>{const h=i[a];return(!h||Object.keys(h).length===0)&&delete i[a],i},t)}function jg(e,t,i=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&i){const a=`vars.${t}`.split(".").reduce((h,p)=>h&&h[p]?h[p]:null,e);if(a!=null)return a}return t.split(".").reduce((a,h)=>a&&a[h]!=null?a[h]:null,e)}function rg(e,t,i,a=i){let h;return typeof e=="function"?h=e(i):Array.isArray(e)?h=e[i]||a:h=jg(e,i)||a,t&&(h=t(h,a,e)),h}function qn(e){const{prop:t,cssProperty:i=e.prop,themeKey:a,transform:h}=e,p=f=>{if(f[t]==null)return null;const u=f[t],T=f.theme,E=jg(T,a)||{};return jo(f,u,z=>{let I=rg(E,h,z);return z===I&&typeof z=="string"&&(I=rg(E,h,`${t}${z==="default"?"":ir(z)}`,z)),i===!1?I:{[i]:I}})};return p.propTypes={},p.filterProps=[t],p}function nB(e){const t={};return i=>(t[i]===void 0&&(t[i]=e(i)),t[i])}const rB={m:"margin",p:"padding"},iB={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},vT={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},sB=nB(e=>{if(e.length>2)if(vT[e])e=vT[e];else return[e];const[t,i]=e.split(""),a=rB[t],h=iB[i]||"";return Array.isArray(h)?h.map(p=>a+p):[a+h]}),k1=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],P1=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...k1,...P1];function Pf(e,t,i,a){const h=jg(e,t,!0)??i;return typeof h=="number"||typeof h=="string"?p=>typeof p=="string"?p:typeof h=="string"?h.startsWith("var(")&&p===0?0:h.startsWith("var(")&&p===1?h:`calc(${p} * ${h})`:h*p:Array.isArray(h)?p=>{if(typeof p=="string")return p;const f=Math.abs(p),u=h[f];return p>=0?u:typeof u=="number"?-u:typeof u=="string"&&u.startsWith("var(")?`calc(-1 * ${u})`:`-${u}`}:typeof h=="function"?h:()=>{}}function E1(e){return Pf(e,"spacing",8)}function Ef(e,t){return typeof t=="string"||t==null?t:e(t)}function oB(e,t){return i=>e.reduce((a,h)=>(a[h]=Ef(t,i),a),{})}function aB(e,t,i,a){if(!t.includes(i))return null;const h=sB(i),p=oB(h,a),f=e[i];return jo(e,f,p)}function YE(e,t){const i=E1(e.theme);return Object.keys(e).map(a=>aB(e,t,a,i)).reduce(Vd,{})}function Bn(e){return YE(e,k1)}Bn.propTypes={};Bn.filterProps=k1;function On(e){return YE(e,P1)}On.propTypes={};On.filterProps=P1;function $g(...e){const t=e.reduce((a,h)=>(h.filterProps.forEach(p=>{a[p]=h}),a),{}),i=a=>Object.keys(a).reduce((h,p)=>t[p]?Vd(h,t[p](a)):h,{});return i.propTypes={},i.filterProps=e.reduce((a,h)=>a.concat(h.filterProps),[]),i}function hs(e){return typeof e!="number"?e:`${e}px solid`}function _s(e,t){return qn({prop:e,themeKey:"borders",transform:t})}const lB=_s("border",hs),uB=_s("borderTop",hs),cB=_s("borderRight",hs),hB=_s("borderBottom",hs),dB=_s("borderLeft",hs),fB=_s("borderColor"),pB=_s("borderTopColor"),mB=_s("borderRightColor"),gB=_s("borderBottomColor"),yB=_s("borderLeftColor"),_B=_s("outline",hs),vB=_s("outlineColor"),Ug=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=Pf(e.theme,"shape.borderRadius",4),i=a=>({borderRadius:Ef(t,a)});return jo(e,e.borderRadius,i)}return null};Ug.propTypes={};Ug.filterProps=["borderRadius"];$g(lB,uB,cB,hB,dB,fB,pB,mB,gB,yB,Ug,_B,vB);const qg=e=>{if(e.gap!==void 0&&e.gap!==null){const t=Pf(e.theme,"spacing",8),i=a=>({gap:Ef(t,a)});return jo(e,e.gap,i)}return null};qg.propTypes={};qg.filterProps=["gap"];const Gg=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=Pf(e.theme,"spacing",8),i=a=>({columnGap:Ef(t,a)});return jo(e,e.columnGap,i)}return null};Gg.propTypes={};Gg.filterProps=["columnGap"];const Wg=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=Pf(e.theme,"spacing",8),i=a=>({rowGap:Ef(t,a)});return jo(e,e.rowGap,i)}return null};Wg.propTypes={};Wg.filterProps=["rowGap"];const xB=qn({prop:"gridColumn"}),bB=qn({prop:"gridRow"}),wB=qn({prop:"gridAutoFlow"}),SB=qn({prop:"gridAutoColumns"}),TB=qn({prop:"gridAutoRows"}),CB=qn({prop:"gridTemplateColumns"}),kB=qn({prop:"gridTemplateRows"}),PB=qn({prop:"gridTemplateAreas"}),EB=qn({prop:"gridArea"});$g(qg,Gg,Wg,xB,bB,wB,SB,TB,CB,kB,PB,EB);function Pc(e,t){return t==="grey"?t:e}const IB=qn({prop:"color",themeKey:"palette",transform:Pc}),MB=qn({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Pc}),AB=qn({prop:"backgroundColor",themeKey:"palette",transform:Pc});$g(IB,MB,AB);function Ni(e){return e<=1&&e!==0?`${e*100}%`:e}const zB=qn({prop:"width",transform:Ni}),I1=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=i=>{var h,p,f,u,T;const a=((f=(p=(h=e.theme)==null?void 0:h.breakpoints)==null?void 0:p.values)==null?void 0:f[i])||Ng[i];return a?((T=(u=e.theme)==null?void 0:u.breakpoints)==null?void 0:T.unit)!=="px"?{maxWidth:`${a}${e.theme.breakpoints.unit}`}:{maxWidth:a}:{maxWidth:Ni(i)}};return jo(e,e.maxWidth,t)}return null};I1.filterProps=["maxWidth"];const DB=qn({prop:"minWidth",transform:Ni}),RB=qn({prop:"height",transform:Ni}),LB=qn({prop:"maxHeight",transform:Ni}),FB=qn({prop:"minHeight",transform:Ni});qn({prop:"size",cssProperty:"width",transform:Ni});qn({prop:"size",cssProperty:"height",transform:Ni});const BB=qn({prop:"boxSizing"});$g(zB,I1,DB,RB,LB,FB,BB);const Zg={border:{themeKey:"borders",transform:hs},borderTop:{themeKey:"borders",transform:hs},borderRight:{themeKey:"borders",transform:hs},borderBottom:{themeKey:"borders",transform:hs},borderLeft:{themeKey:"borders",transform:hs},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:hs},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Ug},color:{themeKey:"palette",transform:Pc},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Pc},backgroundColor:{themeKey:"palette",transform:Pc},p:{style:On},pt:{style:On},pr:{style:On},pb:{style:On},pl:{style:On},px:{style:On},py:{style:On},padding:{style:On},paddingTop:{style:On},paddingRight:{style:On},paddingBottom:{style:On},paddingLeft:{style:On},paddingX:{style:On},paddingY:{style:On},paddingInline:{style:On},paddingInlineStart:{style:On},paddingInlineEnd:{style:On},paddingBlock:{style:On},paddingBlockStart:{style:On},paddingBlockEnd:{style:On},m:{style:Bn},mt:{style:Bn},mr:{style:Bn},mb:{style:Bn},ml:{style:Bn},mx:{style:Bn},my:{style:Bn},margin:{style:Bn},marginTop:{style:Bn},marginRight:{style:Bn},marginBottom:{style:Bn},marginLeft:{style:Bn},marginX:{style:Bn},marginY:{style:Bn},marginInline:{style:Bn},marginInlineStart:{style:Bn},marginInlineEnd:{style:Bn},marginBlock:{style:Bn},marginBlockStart:{style:Bn},marginBlockEnd:{style:Bn},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:qg},rowGap:{style:Wg},columnGap:{style:Gg},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Ni},maxWidth:{style:I1},minWidth:{transform:Ni},height:{transform:Ni},maxHeight:{transform:Ni},minHeight:{transform:Ni},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function OB(...e){const t=e.reduce((a,h)=>a.concat(Object.keys(h)),[]),i=new Set(t);return e.every(a=>i.size===Object.keys(a).length)}function VB(e,t){return typeof e=="function"?e(t):e}function NB(){function e(i,a,h,p){const f={[i]:a,theme:h},u=p[i];if(!u)return{[i]:a};const{cssProperty:T=i,themeKey:E,transform:D,style:z}=u;if(a==null)return null;if(E==="typography"&&a==="inherit")return{[i]:a};const I=jg(h,E)||{};return z?z(f):jo(f,a,K=>{let Q=rg(I,D,K);return K===Q&&typeof K=="string"&&(Q=rg(I,D,`${i}${K==="default"?"":ir(K)}`,K)),T===!1?Q:{[T]:Q}})}function t(i){const{sx:a,theme:h={},nested:p}=i||{};if(!a)return null;const f=h.unstable_sxConfig??Zg;function u(T){let E=T;if(typeof T=="function")E=T(h);else if(typeof T!="object")return T;if(!E)return null;const D=tB(h.breakpoints),z=Object.keys(D);let I=D;return Object.keys(E).forEach(G=>{const K=VB(E[G],h);if(K!=null)if(typeof K=="object")if(f[G])I=Vd(I,e(G,K,h,f));else{const Q=jo({theme:h},K,ce=>({[G]:ce}));OB(Q,K)?I[G]=t({sx:K,theme:h,nested:!0}):I=Vd(I,Q)}else I=Vd(I,e(G,K,h,f))}),!p&&h.modularCssLayers?{"@layer sx":gT(h,_T(z,I))}:gT(h,_T(z,I))}return Array.isArray(a)?a.map(u):u(a)}return t}const Vc=NB();Vc.filterProps=["sx"];function ig(){return ig=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)({}).hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},ig.apply(null,arguments)}function jB(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function $B(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var UB=function(){function e(i){var a=this;this._insertTag=function(h){var p;a.tags.length===0?a.insertionPoint?p=a.insertionPoint.nextSibling:a.prepend?p=a.container.firstChild:p=a.before:p=a.tags[a.tags.length-1].nextSibling,a.container.insertBefore(h,p),a.tags.push(h)},this.isSpeedy=i.speedy===void 0?!0:i.speedy,this.tags=[],this.ctr=0,this.nonce=i.nonce,this.key=i.key,this.container=i.container,this.prepend=i.prepend,this.insertionPoint=i.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(a){a.forEach(this._insertTag)},t.insert=function(a){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag($B(this));var h=this.tags[this.tags.length-1];if(this.isSpeedy){var p=jB(h);try{p.insertRule(a,p.cssRules.length)}catch{}}else h.appendChild(document.createTextNode(a));this.ctr++},t.flush=function(){this.tags.forEach(function(a){var h;return(h=a.parentNode)==null?void 0:h.removeChild(a)}),this.tags=[],this.ctr=0},e}(),Nr="-ms-",sg="-moz-",Jt="-webkit-",JE="comm",M1="rule",A1="decl",qB="@import",QE="@keyframes",GB="@layer",WB=Math.abs,Hg=String.fromCharCode,ZB=Object.assign;function HB(e,t){return kr(e,0)^45?(((t<<2^kr(e,0))<<2^kr(e,1))<<2^kr(e,2))<<2^kr(e,3):0}function eI(e){return e.trim()}function XB(e,t){return(e=t.exec(e))?e[0]:e}function Qt(e,t,i){return e.replace(t,i)}function F0(e,t){return e.indexOf(t)}function kr(e,t){return e.charCodeAt(t)|0}function hf(e,t,i){return e.slice(t,i)}function Ys(e){return e.length}function z1(e){return e.length}function em(e,t){return t.push(e),e}function KB(e,t){return e.map(t).join("")}var Xg=1,Nc=1,tI=0,Si=0,Yn=0,Zc="";function Kg(e,t,i,a,h,p,f){return{value:e,root:t,parent:i,type:a,props:h,children:p,line:Xg,column:Nc,length:f,return:""}}function gd(e,t){return ZB(Kg("",null,null,"",null,null,0),e,{length:-e.length},t)}function YB(){return Yn}function JB(){return Yn=Si>0?kr(Zc,--Si):0,Nc--,Yn===10&&(Nc=1,Xg--),Yn}function qi(){return Yn=Si<tI?kr(Zc,Si++):0,Nc++,Yn===10&&(Nc=1,Xg++),Yn}function so(){return kr(Zc,Si)}function xm(){return Si}function If(e,t){return hf(Zc,e,t)}function df(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function nI(e){return Xg=Nc=1,tI=Ys(Zc=e),Si=0,[]}function rI(e){return Zc="",e}function bm(e){return eI(If(Si-1,B0(e===91?e+2:e===40?e+1:e)))}function QB(e){for(;(Yn=so())&&Yn<33;)qi();return df(e)>2||df(Yn)>3?"":" "}function eO(e,t){for(;--t&&qi()&&!(Yn<48||Yn>102||Yn>57&&Yn<65||Yn>70&&Yn<97););return If(e,xm()+(t<6&&so()==32&&qi()==32))}function B0(e){for(;qi();)switch(Yn){case e:return Si;case 34:case 39:e!==34&&e!==39&&B0(Yn);break;case 40:e===41&&B0(e);break;case 92:qi();break}return Si}function tO(e,t){for(;qi()&&e+Yn!==57;)if(e+Yn===84&&so()===47)break;return"/*"+If(t,Si-1)+"*"+Hg(e===47?e:qi())}function nO(e){for(;!df(so());)qi();return If(e,Si)}function rO(e){return rI(wm("",null,null,null,[""],e=nI(e),0,[0],e))}function wm(e,t,i,a,h,p,f,u,T){for(var E=0,D=0,z=f,I=0,G=0,K=0,Q=1,ce=1,j=1,U=0,X="",ne=h,ge=p,fe=a,we=X;ce;)switch(K=U,U=qi()){case 40:if(K!=108&&kr(we,z-1)==58){F0(we+=Qt(bm(U),"&","&\f"),"&\f")!=-1&&(j=-1);break}case 34:case 39:case 91:we+=bm(U);break;case 9:case 10:case 13:case 32:we+=QB(K);break;case 92:we+=eO(xm()-1,7);continue;case 47:switch(so()){case 42:case 47:em(iO(tO(qi(),xm()),t,i),T);break;default:we+="/"}break;case 123*Q:u[E++]=Ys(we)*j;case 125*Q:case 59:case 0:switch(U){case 0:case 125:ce=0;case 59+D:j==-1&&(we=Qt(we,/\f/g,"")),G>0&&Ys(we)-z&&em(G>32?bT(we+";",a,i,z-1):bT(Qt(we," ","")+";",a,i,z-2),T);break;case 59:we+=";";default:if(em(fe=xT(we,t,i,E,D,h,u,X,ne=[],ge=[],z),p),U===123)if(D===0)wm(we,t,fe,fe,ne,p,z,u,ge);else switch(I===99&&kr(we,3)===110?100:I){case 100:case 108:case 109:case 115:wm(e,fe,fe,a&&em(xT(e,fe,fe,0,0,h,u,X,h,ne=[],z),ge),h,ge,z,u,a?ne:ge);break;default:wm(we,fe,fe,fe,[""],ge,0,u,ge)}}E=D=G=0,Q=j=1,X=we="",z=f;break;case 58:z=1+Ys(we),G=K;default:if(Q<1){if(U==123)--Q;else if(U==125&&Q++==0&&JB()==125)continue}switch(we+=Hg(U),U*Q){case 38:j=D>0?1:(we+="\f",-1);break;case 44:u[E++]=(Ys(we)-1)*j,j=1;break;case 64:so()===45&&(we+=bm(qi())),I=so(),D=z=Ys(X=we+=nO(xm())),U++;break;case 45:K===45&&Ys(we)==2&&(Q=0)}}return p}function xT(e,t,i,a,h,p,f,u,T,E,D){for(var z=h-1,I=h===0?p:[""],G=z1(I),K=0,Q=0,ce=0;K<a;++K)for(var j=0,U=hf(e,z+1,z=WB(Q=f[K])),X=e;j<G;++j)(X=eI(Q>0?I[j]+" "+U:Qt(U,/&\f/g,I[j])))&&(T[ce++]=X);return Kg(e,t,i,h===0?M1:u,T,E,D)}function iO(e,t,i){return Kg(e,t,i,JE,Hg(YB()),hf(e,2,-2),0)}function bT(e,t,i,a){return Kg(e,t,i,A1,hf(e,0,a),hf(e,a+1,-1),a)}function Ec(e,t){for(var i="",a=z1(e),h=0;h<a;h++)i+=t(e[h],h,e,t)||"";return i}function sO(e,t,i,a){switch(e.type){case GB:if(e.children.length)break;case qB:case A1:return e.return=e.return||e.value;case JE:return"";case QE:return e.return=e.value+"{"+Ec(e.children,a)+"}";case M1:e.value=e.props.join(",")}return Ys(i=Ec(e.children,a))?e.return=e.value+"{"+i+"}":""}function oO(e){var t=z1(e);return function(i,a,h,p){for(var f="",u=0;u<t;u++)f+=e[u](i,a,h,p)||"";return f}}function aO(e){return function(t){t.root||(t=t.return)&&e(t)}}function iI(e){var t=Object.create(null);return function(i){return t[i]===void 0&&(t[i]=e(i)),t[i]}}var lO=function(t,i,a){for(var h=0,p=0;h=p,p=so(),h===38&&p===12&&(i[a]=1),!df(p);)qi();return If(t,Si)},uO=function(t,i){var a=-1,h=44;do switch(df(h)){case 0:h===38&&so()===12&&(i[a]=1),t[a]+=lO(Si-1,i,a);break;case 2:t[a]+=bm(h);break;case 4:if(h===44){t[++a]=so()===58?"&\f":"",i[a]=t[a].length;break}default:t[a]+=Hg(h)}while(h=qi());return t},cO=function(t,i){return rI(uO(nI(t),i))},wT=new WeakMap,hO=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var i=t.value,a=t.parent,h=t.column===a.column&&t.line===a.line;a.type!=="rule";)if(a=a.parent,!a)return;if(!(t.props.length===1&&i.charCodeAt(0)!==58&&!wT.get(a))&&!h){wT.set(t,!0);for(var p=[],f=cO(i,p),u=a.props,T=0,E=0;T<f.length;T++)for(var D=0;D<u.length;D++,E++)t.props[E]=p[T]?f[T].replace(/&\f/g,u[D]):u[D]+" "+f[T]}}},dO=function(t){if(t.type==="decl"){var i=t.value;i.charCodeAt(0)===108&&i.charCodeAt(2)===98&&(t.return="",t.value="")}};function sI(e,t){switch(HB(e,t)){case 5103:return Jt+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Jt+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Jt+e+sg+e+Nr+e+e;case 6828:case 4268:return Jt+e+Nr+e+e;case 6165:return Jt+e+Nr+"flex-"+e+e;case 5187:return Jt+e+Qt(e,/(\w+).+(:[^]+)/,Jt+"box-$1$2"+Nr+"flex-$1$2")+e;case 5443:return Jt+e+Nr+"flex-item-"+Qt(e,/flex-|-self/,"")+e;case 4675:return Jt+e+Nr+"flex-line-pack"+Qt(e,/align-content|flex-|-self/,"")+e;case 5548:return Jt+e+Nr+Qt(e,"shrink","negative")+e;case 5292:return Jt+e+Nr+Qt(e,"basis","preferred-size")+e;case 6060:return Jt+"box-"+Qt(e,"-grow","")+Jt+e+Nr+Qt(e,"grow","positive")+e;case 4554:return Jt+Qt(e,/([^-])(transform)/g,"$1"+Jt+"$2")+e;case 6187:return Qt(Qt(Qt(e,/(zoom-|grab)/,Jt+"$1"),/(image-set)/,Jt+"$1"),e,"")+e;case 5495:case 3959:return Qt(e,/(image-set\([^]*)/,Jt+"$1$`$1");case 4968:return Qt(Qt(e,/(.+:)(flex-)?(.*)/,Jt+"box-pack:$3"+Nr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Jt+e+e;case 4095:case 3583:case 4068:case 2532:return Qt(e,/(.+)-inline(.+)/,Jt+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ys(e)-1-t>6)switch(kr(e,t+1)){case 109:if(kr(e,t+4)!==45)break;case 102:return Qt(e,/(.+:)(.+)-([^]+)/,"$1"+Jt+"$2-$3$1"+sg+(kr(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~F0(e,"stretch")?sI(Qt(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(kr(e,t+1)!==115)break;case 6444:switch(kr(e,Ys(e)-3-(~F0(e,"!important")&&10))){case 107:return Qt(e,":",":"+Jt)+e;case 101:return Qt(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Jt+(kr(e,14)===45?"inline-":"")+"box$3$1"+Jt+"$2$3$1"+Nr+"$2box$3")+e}break;case 5936:switch(kr(e,t+11)){case 114:return Jt+e+Nr+Qt(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Jt+e+Nr+Qt(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Jt+e+Nr+Qt(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Jt+e+Nr+e+e}return e}var fO=function(t,i,a,h){if(t.length>-1&&!t.return)switch(t.type){case A1:t.return=sI(t.value,t.length);break;case QE:return Ec([gd(t,{value:Qt(t.value,"@","@"+Jt)})],h);case M1:if(t.length)return KB(t.props,function(p){switch(XB(p,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ec([gd(t,{props:[Qt(p,/:(read-\w+)/,":"+sg+"$1")]})],h);case"::placeholder":return Ec([gd(t,{props:[Qt(p,/:(plac\w+)/,":"+Jt+"input-$1")]}),gd(t,{props:[Qt(p,/:(plac\w+)/,":"+sg+"$1")]}),gd(t,{props:[Qt(p,/:(plac\w+)/,Nr+"input-$1")]})],h)}return""})}},pO=[fO],mO=function(t){var i=t.key;if(i==="css"){var a=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(a,function(Q){var ce=Q.getAttribute("data-emotion");ce.indexOf(" ")!==-1&&(document.head.appendChild(Q),Q.setAttribute("data-s",""))})}var h=t.stylisPlugins||pO,p={},f,u=[];f=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+i+' "]'),function(Q){for(var ce=Q.getAttribute("data-emotion").split(" "),j=1;j<ce.length;j++)p[ce[j]]=!0;u.push(Q)});var T,E=[hO,dO];{var D,z=[sO,aO(function(Q){D.insert(Q)})],I=oO(E.concat(h,z)),G=function(ce){return Ec(rO(ce),I)};T=function(ce,j,U,X){D=U,G(ce?ce+"{"+j.styles+"}":j.styles),X&&(K.inserted[j.name]=!0)}}var K={key:i,sheet:new UB({key:i,container:f,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:p,registered:{},insert:T};return K.sheet.hydrate(u),K},oI={exports:{}},an={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yr=typeof Symbol=="function"&&Symbol.for,D1=yr?Symbol.for("react.element"):60103,R1=yr?Symbol.for("react.portal"):60106,Yg=yr?Symbol.for("react.fragment"):60107,Jg=yr?Symbol.for("react.strict_mode"):60108,Qg=yr?Symbol.for("react.profiler"):60114,ey=yr?Symbol.for("react.provider"):60109,ty=yr?Symbol.for("react.context"):60110,L1=yr?Symbol.for("react.async_mode"):60111,ny=yr?Symbol.for("react.concurrent_mode"):60111,ry=yr?Symbol.for("react.forward_ref"):60112,iy=yr?Symbol.for("react.suspense"):60113,gO=yr?Symbol.for("react.suspense_list"):60120,sy=yr?Symbol.for("react.memo"):60115,oy=yr?Symbol.for("react.lazy"):60116,yO=yr?Symbol.for("react.block"):60121,_O=yr?Symbol.for("react.fundamental"):60117,vO=yr?Symbol.for("react.responder"):60118,xO=yr?Symbol.for("react.scope"):60119;function Hi(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case D1:switch(e=e.type,e){case L1:case ny:case Yg:case Qg:case Jg:case iy:return e;default:switch(e=e&&e.$$typeof,e){case ty:case ry:case oy:case sy:case ey:return e;default:return t}}case R1:return t}}}function aI(e){return Hi(e)===ny}an.AsyncMode=L1;an.ConcurrentMode=ny;an.ContextConsumer=ty;an.ContextProvider=ey;an.Element=D1;an.ForwardRef=ry;an.Fragment=Yg;an.Lazy=oy;an.Memo=sy;an.Portal=R1;an.Profiler=Qg;an.StrictMode=Jg;an.Suspense=iy;an.isAsyncMode=function(e){return aI(e)||Hi(e)===L1};an.isConcurrentMode=aI;an.isContextConsumer=function(e){return Hi(e)===ty};an.isContextProvider=function(e){return Hi(e)===ey};an.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===D1};an.isForwardRef=function(e){return Hi(e)===ry};an.isFragment=function(e){return Hi(e)===Yg};an.isLazy=function(e){return Hi(e)===oy};an.isMemo=function(e){return Hi(e)===sy};an.isPortal=function(e){return Hi(e)===R1};an.isProfiler=function(e){return Hi(e)===Qg};an.isStrictMode=function(e){return Hi(e)===Jg};an.isSuspense=function(e){return Hi(e)===iy};an.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Yg||e===ny||e===Qg||e===Jg||e===iy||e===gO||typeof e=="object"&&e!==null&&(e.$$typeof===oy||e.$$typeof===sy||e.$$typeof===ey||e.$$typeof===ty||e.$$typeof===ry||e.$$typeof===_O||e.$$typeof===vO||e.$$typeof===xO||e.$$typeof===yO)};an.typeOf=Hi;oI.exports=an;var bO=oI.exports,lI=bO,wO={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},SO={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},uI={};uI[lI.ForwardRef]=wO;uI[lI.Memo]=SO;var TO=!0;function cI(e,t,i){var a="";return i.split(" ").forEach(function(h){e[h]!==void 0?t.push(e[h]+";"):h&&(a+=h+" ")}),a}var F1=function(t,i,a){var h=t.key+"-"+i.name;(a===!1||TO===!1)&&t.registered[h]===void 0&&(t.registered[h]=i.styles)},hI=function(t,i,a){F1(t,i,a);var h=t.key+"-"+i.name;if(t.inserted[i.name]===void 0){var p=i;do t.insert(i===p?"."+h:"",p,t.sheet,!0),p=p.next;while(p!==void 0)}};function CO(e){for(var t=0,i,a=0,h=e.length;h>=4;++a,h-=4)i=e.charCodeAt(a)&255|(e.charCodeAt(++a)&255)<<8|(e.charCodeAt(++a)&255)<<16|(e.charCodeAt(++a)&255)<<24,i=(i&65535)*1540483477+((i>>>16)*59797<<16),i^=i>>>24,t=(i&65535)*1540483477+((i>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(h){case 3:t^=(e.charCodeAt(a+2)&255)<<16;case 2:t^=(e.charCodeAt(a+1)&255)<<8;case 1:t^=e.charCodeAt(a)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var kO={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},PO=/[A-Z]|^ms/g,EO=/_EMO_([^_]+?)_([^]*?)_EMO_/g,dI=function(t){return t.charCodeAt(1)===45},ST=function(t){return t!=null&&typeof t!="boolean"},gv=iI(function(e){return dI(e)?e:e.replace(PO,"-$&").toLowerCase()}),TT=function(t,i){switch(t){case"animation":case"animationName":if(typeof i=="string")return i.replace(EO,function(a,h,p){return Js={name:h,styles:p,next:Js},h})}return kO[t]!==1&&!dI(t)&&typeof i=="number"&&i!==0?i+"px":i};function ff(e,t,i){if(i==null)return"";var a=i;if(a.__emotion_styles!==void 0)return a;switch(typeof i){case"boolean":return"";case"object":{var h=i;if(h.anim===1)return Js={name:h.name,styles:h.styles,next:Js},h.name;var p=i;if(p.styles!==void 0){var f=p.next;if(f!==void 0)for(;f!==void 0;)Js={name:f.name,styles:f.styles,next:Js},f=f.next;var u=p.styles+";";return u}return IO(e,t,i)}case"function":{if(e!==void 0){var T=Js,E=i(e);return Js=T,ff(e,t,E)}break}}var D=i;if(t==null)return D;var z=t[D];return z!==void 0?z:D}function IO(e,t,i){var a="";if(Array.isArray(i))for(var h=0;h<i.length;h++)a+=ff(e,t,i[h])+";";else for(var p in i){var f=i[p];if(typeof f!="object"){var u=f;t!=null&&t[u]!==void 0?a+=p+"{"+t[u]+"}":ST(u)&&(a+=gv(p)+":"+TT(p,u)+";")}else if(Array.isArray(f)&&typeof f[0]=="string"&&(t==null||t[f[0]]===void 0))for(var T=0;T<f.length;T++)ST(f[T])&&(a+=gv(p)+":"+TT(p,f[T])+";");else{var E=ff(e,t,f);switch(p){case"animation":case"animationName":{a+=gv(p)+":"+E+";";break}default:a+=p+"{"+E+"}"}}}return a}var CT=/label:\s*([^\s;{]+)\s*(;|$)/g,Js;function ay(e,t,i){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var a=!0,h="";Js=void 0;var p=e[0];if(p==null||p.raw===void 0)a=!1,h+=ff(i,t,p);else{var f=p;h+=f[0]}for(var u=1;u<e.length;u++)if(h+=ff(i,t,e[u]),a){var T=p;h+=T[u]}CT.lastIndex=0;for(var E="",D;(D=CT.exec(h))!==null;)E+="-"+D[1];var z=CO(h)+E;return{name:z,styles:h,next:Js}}var MO=function(t){return t()},AO=Cm.useInsertionEffect?Cm.useInsertionEffect:!1,fI=AO||MO,pI=le.createContext(typeof HTMLElement<"u"?mO({key:"css"}):null);pI.Provider;var mI=function(t){return le.forwardRef(function(i,a){var h=le.useContext(pI);return t(i,h,a)})},B1=le.createContext({}),O1={}.hasOwnProperty,O0="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",zO=function(t,i){var a={};for(var h in i)O1.call(i,h)&&(a[h]=i[h]);return a[O0]=t,a},DO=function(t){var i=t.cache,a=t.serialized,h=t.isStringTag;return F1(i,a,h),fI(function(){return hI(i,a,h)}),null},RO=mI(function(e,t,i){var a=e.css;typeof a=="string"&&t.registered[a]!==void 0&&(a=t.registered[a]);var h=e[O0],p=[a],f="";typeof e.className=="string"?f=cI(t.registered,p,e.className):e.className!=null&&(f=e.className+" ");var u=ay(p,void 0,le.useContext(B1));f+=t.key+"-"+u.name;var T={};for(var E in e)O1.call(e,E)&&E!=="css"&&E!==O0&&(T[E]=e[E]);return T.className=f,i&&(T.ref=i),le.createElement(le.Fragment,null,le.createElement(DO,{cache:t,serialized:u,isStringTag:typeof h=="string"}),le.createElement(h,T))}),LO=RO,kT=function(t,i){var a=arguments;if(i==null||!O1.call(i,"css"))return le.createElement.apply(void 0,a);var h=a.length,p=new Array(h);p[0]=LO,p[1]=zO(t,i);for(var f=2;f<h;f++)p[f]=a[f];return le.createElement.apply(null,p)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(kT||(kT={}));function V1(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return ay(t)}function Mf(){var e=V1.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var FO=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,BO=iI(function(e){return FO.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),OO=BO,VO=function(t){return t!=="theme"},PT=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?OO:VO},ET=function(t,i,a){var h;if(i){var p=i.shouldForwardProp;h=t.__emotion_forwardProp&&p?function(f){return t.__emotion_forwardProp(f)&&p(f)}:p}return typeof h!="function"&&a&&(h=t.__emotion_forwardProp),h},NO=function(t){var i=t.cache,a=t.serialized,h=t.isStringTag;return F1(i,a,h),fI(function(){return hI(i,a,h)}),null},jO=function e(t,i){var a=t.__emotion_real===t,h=a&&t.__emotion_base||t,p,f;i!==void 0&&(p=i.label,f=i.target);var u=ET(t,i,a),T=u||PT(h),E=!T("as");return function(){var D=arguments,z=a&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(p!==void 0&&z.push("label:"+p+";"),D[0]==null||D[0].raw===void 0)z.push.apply(z,D);else{var I=D[0];z.push(I[0]);for(var G=D.length,K=1;K<G;K++)z.push(D[K],I[K])}var Q=mI(function(ce,j,U){var X=E&&ce.as||h,ne="",ge=[],fe=ce;if(ce.theme==null){fe={};for(var we in ce)fe[we]=ce[we];fe.theme=le.useContext(B1)}typeof ce.className=="string"?ne=cI(j.registered,ge,ce.className):ce.className!=null&&(ne=ce.className+" ");var Ie=ay(z.concat(ge),j.registered,fe);ne+=j.key+"-"+Ie.name,f!==void 0&&(ne+=" "+f);var Ne=E&&u===void 0?PT(X):T,$e={};for(var Ve in ce)E&&Ve==="as"||Ne(Ve)&&($e[Ve]=ce[Ve]);return $e.className=ne,U&&($e.ref=U),le.createElement(le.Fragment,null,le.createElement(NO,{cache:j,serialized:Ie,isStringTag:typeof X=="string"}),le.createElement(X,$e))});return Q.displayName=p!==void 0?p:"Styled("+(typeof h=="string"?h:h.displayName||h.name||"Component")+")",Q.defaultProps=t.defaultProps,Q.__emotion_real=Q,Q.__emotion_base=h,Q.__emotion_styles=z,Q.__emotion_forwardProp=u,Object.defineProperty(Q,"toString",{value:function(){return"."+f}}),Q.withComponent=function(ce,j){var U=e(ce,ig({},i,j,{shouldForwardProp:ET(Q,j,!0)}));return U.apply(void 0,z)},Q}},$O=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],V0=jO.bind(null);$O.forEach(function(e){V0[e]=V0(e)});function UO(e,t){return V0(e,t)}function qO(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}const IT=[];function Gl(e){return IT[0]=e,ay(IT)}const GO=e=>{const t=Object.keys(e).map(i=>({key:i,val:e[i]}))||[];return t.sort((i,a)=>i.val-a.val),t.reduce((i,a)=>({...i,[a.key]:a.val}),{})};function WO(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:i="px",step:a=5,...h}=e,p=GO(t),f=Object.keys(p);function u(I){return`@media (min-width:${typeof t[I]=="number"?t[I]:I}${i})`}function T(I){return`@media (max-width:${(typeof t[I]=="number"?t[I]:I)-a/100}${i})`}function E(I,G){const K=f.indexOf(G);return`@media (min-width:${typeof t[I]=="number"?t[I]:I}${i}) and (max-width:${(K!==-1&&typeof t[f[K]]=="number"?t[f[K]]:G)-a/100}${i})`}function D(I){return f.indexOf(I)+1<f.length?E(I,f[f.indexOf(I)+1]):u(I)}function z(I){const G=f.indexOf(I);return G===0?u(f[1]):G===f.length-1?T(f[G]):E(I,f[f.indexOf(I)+1]).replace("@media","@media not all and")}return{keys:f,values:p,up:u,down:T,between:E,only:D,not:z,unit:i,...h}}const ZO={borderRadius:4};function gI(e=8,t=E1({spacing:e})){if(e.mui)return e;const i=(...a)=>(a.length===0?[1]:a).map(p=>{const f=t(p);return typeof f=="number"?`${f}px`:f}).join(" ");return i.mui=!0,i}function HO(e,t){var a;const i=this;if(i.vars){if(!((a=i.colorSchemes)!=null&&a[e])||typeof i.getColorSchemeSelector!="function")return{};let h=i.getColorSchemeSelector(e);return h==="&"?t:((h.includes("data-")||h.includes("."))&&(h=`*:where(${h.replace(/\s*&$/,"")}) &`),{[h]:t})}return i.palette.mode===e?t:{}}function yI(e={},...t){const{breakpoints:i={},palette:a={},spacing:h,shape:p={},...f}=e,u=WO(i),T=gI(h);let E=Ui({breakpoints:u,direction:"ltr",components:{},palette:{mode:"light",...a},spacing:T,shape:{...ZO,...p}},f);return E=QF(E),E.applyStyles=HO,E=t.reduce((D,z)=>Ui(D,z),E),E.unstable_sxConfig={...Zg,...f==null?void 0:f.unstable_sxConfig},E.unstable_sx=function(z){return Vc({sx:z,theme:this})},E}function XO(e){return Object.keys(e).length===0}function KO(e=null){const t=le.useContext(B1);return!t||XO(t)?e:t}const YO={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Hc(e,t,i="Mui"){const a=YO[t];return a?`${i}-${a}`:`${HF.generate(e)}-${t}`}function Xc(e,t,i="Mui"){const a={};return t.forEach(h=>{a[h]=Hc(e,h,i)}),a}function _I(e){const{variants:t,...i}=e,a={variants:t,style:Gl(i),isProcessed:!0};return a.style===i||t&&t.forEach(h=>{typeof h.style!="function"&&(h.style=Gl(h.style))}),a}const JO=yI();function yv(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function Vl(e,t){return t&&e&&typeof e=="object"&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${t}{${String(e.styles)}}`),e}function QO(e){return e?(t,i)=>i[e]:null}function e6(e,t,i){e.theme=r6(e.theme)?i:e.theme[t]||e.theme}function Sm(e,t,i){const a=typeof t=="function"?t(e):t;if(Array.isArray(a))return a.flatMap(h=>Sm(e,h,i));if(Array.isArray(a==null?void 0:a.variants)){let h;if(a.isProcessed)h=i?Vl(a.style,i):a.style;else{const{variants:p,...f}=a;h=i?Vl(Gl(f),i):f}return vI(e,a.variants,[h],i)}return a!=null&&a.isProcessed?i?Vl(Gl(a.style),i):a.style:i?Vl(Gl(a),i):a}function vI(e,t,i=[],a=void 0){var p;let h;e:for(let f=0;f<t.length;f+=1){const u=t[f];if(typeof u.props=="function"){if(h??(h={...e,...e.ownerState,ownerState:e.ownerState}),!u.props(h))continue}else for(const T in u.props)if(e[T]!==u.props[T]&&((p=e.ownerState)==null?void 0:p[T])!==u.props[T])continue e;typeof u.style=="function"?(h??(h={...e,...e.ownerState,ownerState:e.ownerState}),i.push(a?Vl(Gl(u.style(h)),a):u.style(h))):i.push(a?Vl(Gl(u.style),a):u.style)}return i}function t6(e={}){const{themeId:t,defaultTheme:i=JO,rootShouldForwardProp:a=yv,slotShouldForwardProp:h=yv}=e;function p(u){e6(u,t,i)}return(u,T={})=>{qO(u,fe=>fe.filter(we=>we!==Vc));const{name:E,slot:D,skipVariantsResolver:z,skipSx:I,overridesResolver:G=QO(s6(D)),...K}=T,Q=E&&E.startsWith("Mui")||D?"components":"custom",ce=z!==void 0?z:D&&D!=="Root"&&D!=="root"||!1,j=I||!1;let U=yv;D==="Root"||D==="root"?U=a:D?U=h:i6(u)&&(U=void 0);const X=UO(u,{shouldForwardProp:U,label:n6(),...K}),ne=fe=>{if(fe.__emotion_real===fe)return fe;if(typeof fe=="function")return function(Ie){return Sm(Ie,fe,Ie.theme.modularCssLayers?Q:void 0)};if(Ao(fe)){const we=_I(fe);return function(Ne){return we.variants?Sm(Ne,we,Ne.theme.modularCssLayers?Q:void 0):Ne.theme.modularCssLayers?Vl(we.style,Q):we.style}}return fe},ge=(...fe)=>{const we=[],Ie=fe.map(ne),Ne=[];if(we.push(p),E&&G&&Ne.push(function(ze){var _t,Oe;const ot=(Oe=(_t=ze.theme.components)==null?void 0:_t[E])==null?void 0:Oe.styleOverrides;if(!ot)return null;const xt={};for(const et in ot)xt[et]=Sm(ze,ot[et],ze.theme.modularCssLayers?"theme":void 0);return G(ze,xt)}),E&&!ce&&Ne.push(function(ze){var xt,_t;const Le=ze.theme,ot=(_t=(xt=Le==null?void 0:Le.components)==null?void 0:xt[E])==null?void 0:_t.variants;return ot?vI(ze,ot,[],ze.theme.modularCssLayers?"theme":void 0):null}),j||Ne.push(Vc),Array.isArray(Ie[0])){const J=Ie.shift(),ze=new Array(we.length).fill(""),Le=new Array(Ne.length).fill("");let ot;ot=[...ze,...J,...Le],ot.raw=[...ze,...J.raw,...Le],we.unshift(ot)}const $e=[...we,...Ie,...Ne],Ve=X(...$e);return u.muiName&&(Ve.muiName=u.muiName),Ve};return X.withConfig&&(ge.withConfig=X.withConfig),ge}}function n6(e,t){return void 0}function r6(e){for(const t in e)return!1;return!0}function i6(e){return typeof e=="string"&&e.charCodeAt(0)>96}function s6(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}function og(e,t,i=!1){const a={...t};for(const h in e)if(Object.prototype.hasOwnProperty.call(e,h)){const p=h;if(p==="components"||p==="slots")a[p]={...e[p],...a[p]};else if(p==="componentsProps"||p==="slotProps"){const f=e[p],u=t[p];if(!u)a[p]=f||{};else if(!f)a[p]=u;else{a[p]={...u};for(const T in f)if(Object.prototype.hasOwnProperty.call(f,T)){const E=T;a[p][E]=og(f[E],u[E],i)}}}else p==="className"&&i&&t.className?a.className=jr(e==null?void 0:e.className,t==null?void 0:t.className):p==="style"&&i&&t.style?a.style={...e==null?void 0:e.style,...t==null?void 0:t.style}:a[p]===void 0&&(a[p]=e[p])}return a}function o6(e){const{theme:t,name:i,props:a}=e;return!t||!t.components||!t.components[i]||!t.components[i].defaultProps?a:og(t.components[i].defaultProps,a)}const xI=typeof window<"u"?le.useLayoutEffect:le.useEffect;function a6(e,t,i,a,h){const[p,f]=le.useState(()=>h&&i?i(e).matches:a?a(e).matches:t);return xI(()=>{if(!i)return;const u=i(e),T=()=>{f(u.matches)};return T(),u.addEventListener("change",T),()=>{u.removeEventListener("change",T)}},[e,i]),p}const l6={...Cm},bI=l6.useSyncExternalStore;function u6(e,t,i,a,h){const p=le.useCallback(()=>t,[t]),f=le.useMemo(()=>{if(h&&i)return()=>i(e).matches;if(a!==null){const{matches:D}=a(e);return()=>D}return p},[p,e,a,h,i]),[u,T]=le.useMemo(()=>{if(i===null)return[p,()=>()=>{}];const D=i(e);return[()=>D.matches,z=>(D.addEventListener("change",z),()=>{D.removeEventListener("change",z)})]},[p,i,e]);return bI(T,u,f)}function wI(e={}){const{themeId:t}=e;return function(a,h={}){let p=KO();p&&t&&(p=p[t]||p);const f=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:u=!1,matchMedia:T=f?window.matchMedia:null,ssrMatchMedia:E=null,noSsr:D=!1}=o6({name:"MuiUseMediaQuery",props:h,theme:p});let z=typeof a=="function"?a(p):a;return z=z.replace(/^@media( ?)/m,""),z.includes("print")&&console.warn(["MUI: You have provided a `print` query to the `useMediaQuery` hook.","Using the print media query to modify print styles can lead to unexpected results.","Consider using the `displayPrint` field in the `sx` prop instead.","More information about `displayPrint` on our docs: https://mui.com/system/display/#display-in-print."].join(`
`)),(bI!==void 0?u6:a6)(z,u,T,E,D)}}wI();function c6(e,t=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,i))}function N1(e,t=0,i=1){return c6(e,t,i)}function h6(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let i=e.match(t);return i&&i[0].length===1&&(i=i.map(a=>a+a)),i?`rgb${i.length===4?"a":""}(${i.map((a,h)=>h<3?parseInt(a,16):Math.round(parseInt(a,16)/255*1e3)/1e3).join(", ")})`:""}function Wa(e){if(e.type)return e;if(e.charAt(0)==="#")return Wa(h6(e));const t=e.indexOf("("),i=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(i))throw new Error(Yl(9,e));let a=e.substring(t+1,e.length-1),h;if(i==="color"){if(a=a.split(" "),h=a.shift(),a.length===4&&a[3].charAt(0)==="/"&&(a[3]=a[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(h))throw new Error(Yl(10,h))}else a=a.split(",");return a=a.map(p=>parseFloat(p)),{type:i,values:a,colorSpace:h}}const d6=e=>{const t=Wa(e);return t.values.slice(0,3).map((i,a)=>t.type.includes("hsl")&&a!==0?`${i}%`:i).join(" ")},Sd=(e,t)=>{try{return d6(e)}catch{return e}};function ly(e){const{type:t,colorSpace:i}=e;let{values:a}=e;return t.includes("rgb")?a=a.map((h,p)=>p<3?parseInt(h,10):h):t.includes("hsl")&&(a[1]=`${a[1]}%`,a[2]=`${a[2]}%`),t.includes("color")?a=`${i} ${a.join(" ")}`:a=`${a.join(", ")}`,`${t}(${a})`}function SI(e){e=Wa(e);const{values:t}=e,i=t[0],a=t[1]/100,h=t[2]/100,p=a*Math.min(h,1-h),f=(E,D=(E+i/30)%12)=>h-p*Math.max(Math.min(D-3,9-D,1),-1);let u="rgb";const T=[Math.round(f(0)*255),Math.round(f(8)*255),Math.round(f(4)*255)];return e.type==="hsla"&&(u+="a",T.push(t[3])),ly({type:u,values:T})}function N0(e){e=Wa(e);let t=e.type==="hsl"||e.type==="hsla"?Wa(SI(e)).values:e.values;return t=t.map(i=>(e.type!=="color"&&(i/=255),i<=.03928?i/12.92:((i+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function f6(e,t){const i=N0(e),a=N0(t);return(Math.max(i,a)+.05)/(Math.min(i,a)+.05)}function TI(e,t){return e=Wa(e),t=N1(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,ly(e)}function Il(e,t,i){try{return TI(e,t)}catch{return e}}function uy(e,t){if(e=Wa(e),t=N1(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let i=0;i<3;i+=1)e.values[i]*=1-t;return ly(e)}function rn(e,t,i){try{return uy(e,t)}catch{return e}}function cy(e,t){if(e=Wa(e),t=N1(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let i=0;i<3;i+=1)e.values[i]+=(255-e.values[i])*t;else if(e.type.includes("color"))for(let i=0;i<3;i+=1)e.values[i]+=(1-e.values[i])*t;return ly(e)}function sn(e,t,i){try{return cy(e,t)}catch{return e}}function p6(e,t=.15){return N0(e)>.5?uy(e,t):cy(e,t)}function tm(e,t,i){try{return p6(e,t)}catch{return e}}const m6=le.createContext(void 0);function g6(e){const{theme:t,name:i,props:a}=e;if(!t||!t.components||!t.components[i])return a;const h=t.components[i];return h.defaultProps?og(h.defaultProps,a,t.components.mergeClassNameAndStyle):!h.styleOverrides&&!h.variants?og(h,a,t.components.mergeClassNameAndStyle):a}function y6({props:e,name:t}){const i=le.useContext(m6);return g6({props:e,name:t,theme:{components:i}})}let MT=0;function _6(e){const[t,i]=le.useState(e),a=e||t;return le.useEffect(()=>{t==null&&(MT+=1,i(`mui-${MT}`))},[t]),a}const v6={...Cm},AT=v6.useId;function x6(e){if(AT!==void 0){const t=AT();return e??t}return _6(e)}const zT={theme:void 0};function b6(e){let t,i;return function(h){let p=t;return(p===void 0||h.theme!==i)&&(zT.theme=h.theme,p=_I(e(zT)),t=p,i=h.theme),p}}function w6(e=""){function t(...a){if(!a.length)return"";const h=a[0];return typeof h=="string"&&!h.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${h}${t(...a.slice(1))})`:`, ${h}`}return(a,...h)=>`var(--${e?`${e}-`:""}${a}${t(...h)})`}const DT=(e,t,i,a=[])=>{let h=e;t.forEach((p,f)=>{f===t.length-1?Array.isArray(h)?h[Number(p)]=i:h&&typeof h=="object"&&(h[p]=i):h&&typeof h=="object"&&(h[p]||(h[p]=a.includes(p)?[]:{}),h=h[p])})},S6=(e,t,i)=>{function a(h,p=[],f=[]){Object.entries(h).forEach(([u,T])=>{(!i||i&&!i([...p,u]))&&T!=null&&(typeof T=="object"&&Object.keys(T).length>0?a(T,[...p,u],Array.isArray(T)?[...f,u]:f):t([...p,u],T,f))})}a(e)},T6=(e,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(a=>e.includes(a))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t;function _v(e,t){const{prefix:i,shouldSkipGeneratingVar:a}=t||{},h={},p={},f={};return S6(e,(u,T,E)=>{if((typeof T=="string"||typeof T=="number")&&(!a||!a(u,T))){const D=`--${i?`${i}-`:""}${u.join("-")}`,z=T6(u,T);Object.assign(h,{[D]:z}),DT(p,u,`var(${D})`,E),DT(f,u,`var(${D}, ${z})`,E)}},u=>u[0]==="vars"),{css:h,vars:p,varsWithDefaults:f}}function C6(e,t={}){const{getSelector:i=j,disableCssColorScheme:a,colorSchemeSelector:h,enableContrastVars:p}=t,{colorSchemes:f={},components:u,defaultColorScheme:T="light",...E}=e,{vars:D,css:z,varsWithDefaults:I}=_v(E,t);let G=I;const K={},{[T]:Q,...ce}=f;if(Object.entries(ce||{}).forEach(([ne,ge])=>{const{vars:fe,css:we,varsWithDefaults:Ie}=_v(ge,t);G=Ui(G,Ie),K[ne]={css:we,vars:fe}}),Q){const{css:ne,vars:ge,varsWithDefaults:fe}=_v(Q,t);G=Ui(G,fe),K[T]={css:ne,vars:ge}}function j(ne,ge){var we,Ie;let fe=h;if(h==="class"&&(fe=".%s"),h==="data"&&(fe="[data-%s]"),h!=null&&h.startsWith("data-")&&!h.includes("%s")&&(fe=`[${h}="%s"]`),ne){if(fe==="media")return e.defaultColorScheme===ne?":root":{[`@media (prefers-color-scheme: ${((Ie=(we=f[ne])==null?void 0:we.palette)==null?void 0:Ie.mode)||ne})`]:{":root":ge}};if(fe)return e.defaultColorScheme===ne?`:root, ${fe.replace("%s",String(ne))}`:fe.replace("%s",String(ne))}return":root"}return{vars:G,generateThemeVars:()=>{let ne={...D};return Object.entries(K).forEach(([,{vars:ge}])=>{ne=Ui(ne,ge)}),ne},generateStyleSheets:()=>{var Ne,$e;const ne=[],ge=e.defaultColorScheme||"light";function fe(Ve,J){Object.keys(J).length&&ne.push(typeof Ve=="string"?{[Ve]:{...J}}:Ve)}fe(i(void 0,{...z}),z);const{[ge]:we,...Ie}=K;if(we){const{css:Ve}=we,J=($e=(Ne=f[ge])==null?void 0:Ne.palette)==null?void 0:$e.mode,ze=!a&&J?{colorScheme:J,...Ve}:{...Ve};fe(i(ge,{...ze}),ze)}return Object.entries(Ie).forEach(([Ve,{css:J}])=>{var ot,xt;const ze=(xt=(ot=f[Ve])==null?void 0:ot.palette)==null?void 0:xt.mode,Le=!a&&ze?{colorScheme:ze,...J}:{...J};fe(i(Ve,{...Le}),Le)}),p&&ne.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),ne}}}function k6(e){return function(i){return e==="media"?`@media (prefers-color-scheme: ${i})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${i}"] &`:e==="class"?`.${i} &`:e==="data"?`[data-${i}] &`:`${e.replace("%s",i)} &`:"&"}}const pf={black:"#000",white:"#fff"},P6={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Yu={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Ju={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},yd={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},Qu={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},ec={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},tc={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function CI(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:pf.white,default:pf.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const kI=CI();function PI(){return{text:{primary:pf.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:pf.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const j0=PI();function RT(e,t,i,a){const h=a.light||a,p=a.dark||a*1.5;e[t]||(e.hasOwnProperty(i)?e[t]=e[i]:t==="light"?e.light=cy(e.main,h):t==="dark"&&(e.dark=uy(e.main,p)))}function LT(e,t,i,a,h){const p=h.light||h,f=h.dark||h*1.5;t[i]||(t.hasOwnProperty(a)?t[i]=t[a]:i==="light"?t.light=`color-mix(in ${e}, ${t.main}, #fff ${(p*100).toFixed(0)}%)`:i==="dark"&&(t.dark=`color-mix(in ${e}, ${t.main}, #000 ${(f*100).toFixed(0)}%)`))}function E6(e="light"){return e==="dark"?{main:Qu[200],light:Qu[50],dark:Qu[400]}:{main:Qu[700],light:Qu[400],dark:Qu[800]}}function I6(e="light"){return e==="dark"?{main:Yu[200],light:Yu[50],dark:Yu[400]}:{main:Yu[500],light:Yu[300],dark:Yu[700]}}function M6(e="light"){return e==="dark"?{main:Ju[500],light:Ju[300],dark:Ju[700]}:{main:Ju[700],light:Ju[400],dark:Ju[800]}}function A6(e="light"){return e==="dark"?{main:ec[400],light:ec[300],dark:ec[700]}:{main:ec[700],light:ec[500],dark:ec[900]}}function z6(e="light"){return e==="dark"?{main:tc[400],light:tc[300],dark:tc[700]}:{main:tc[800],light:tc[500],dark:tc[900]}}function D6(e="light"){return e==="dark"?{main:yd[400],light:yd[300],dark:yd[700]}:{main:"#ed6c02",light:yd[500],dark:yd[900]}}function R6(e){return`oklch(from ${e} var(--__l) 0 h / var(--__a))`}function j1(e){const{mode:t="light",contrastThreshold:i=3,tonalOffset:a=.2,colorSpace:h,...p}=e,f=e.primary||E6(t),u=e.secondary||I6(t),T=e.error||M6(t),E=e.info||A6(t),D=e.success||z6(t),z=e.warning||D6(t);function I(ce){return h?R6(ce):f6(ce,j0.text.primary)>=i?j0.text.primary:kI.text.primary}const G=({color:ce,name:j,mainShade:U=500,lightShade:X=300,darkShade:ne=700})=>{if(ce={...ce},!ce.main&&ce[U]&&(ce.main=ce[U]),!ce.hasOwnProperty("main"))throw new Error(Yl(11,j?` (${j})`:"",U));if(typeof ce.main!="string")throw new Error(Yl(12,j?` (${j})`:"",JSON.stringify(ce.main)));return h?(LT(h,ce,"light",X,a),LT(h,ce,"dark",ne,a)):(RT(ce,"light",X,a),RT(ce,"dark",ne,a)),ce.contrastText||(ce.contrastText=I(ce.main)),ce};let K;return t==="light"?K=CI():t==="dark"&&(K=PI()),Ui({common:{...pf},mode:t,primary:G({color:f,name:"primary"}),secondary:G({color:u,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:G({color:T,name:"error"}),warning:G({color:z,name:"warning"}),info:G({color:E,name:"info"}),success:G({color:D,name:"success"}),grey:P6,contrastThreshold:i,getContrastText:I,augmentColor:G,tonalOffset:a,...K},p)}function L6(e){const t={};return Object.entries(e).forEach(a=>{const[h,p]=a;typeof p=="object"&&(t[h]=`${p.fontStyle?`${p.fontStyle} `:""}${p.fontVariant?`${p.fontVariant} `:""}${p.fontWeight?`${p.fontWeight} `:""}${p.fontStretch?`${p.fontStretch} `:""}${p.fontSize||""}${p.lineHeight?`/${p.lineHeight} `:""}${p.fontFamily||""}`)}),t}function F6(e,t){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...t}}function B6(e){return Math.round(e*1e5)/1e5}const FT={textTransform:"uppercase"},BT='"Roboto", "Helvetica", "Arial", sans-serif';function O6(e,t){const{fontFamily:i=BT,fontSize:a=14,fontWeightLight:h=300,fontWeightRegular:p=400,fontWeightMedium:f=500,fontWeightBold:u=700,htmlFontSize:T=16,allVariants:E,pxToRem:D,...z}=typeof t=="function"?t(e):t,I=a/14,G=D||(ce=>`${ce/T*I}rem`),K=(ce,j,U,X,ne)=>({fontFamily:i,fontWeight:ce,fontSize:G(j),lineHeight:U,...i===BT?{letterSpacing:`${B6(X/j)}em`}:{},...ne,...E}),Q={h1:K(h,96,1.167,-1.5),h2:K(h,60,1.2,-.5),h3:K(p,48,1.167,0),h4:K(p,34,1.235,.25),h5:K(p,24,1.334,0),h6:K(f,20,1.6,.15),subtitle1:K(p,16,1.75,.15),subtitle2:K(f,14,1.57,.1),body1:K(p,16,1.5,.15),body2:K(p,14,1.43,.15),button:K(f,14,1.75,.4,FT),caption:K(p,12,1.66,.4),overline:K(p,12,2.66,1,FT),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Ui({htmlFontSize:T,pxToRem:G,fontFamily:i,fontSize:a,fontWeightLight:h,fontWeightRegular:p,fontWeightMedium:f,fontWeightBold:u,...Q},z,{clone:!1})}const V6=.2,N6=.14,j6=.12;function Tn(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${V6})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${N6})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${j6})`].join(",")}const $6=["none",Tn(0,2,1,-1,0,1,1,0,0,1,3,0),Tn(0,3,1,-2,0,2,2,0,0,1,5,0),Tn(0,3,3,-2,0,3,4,0,0,1,8,0),Tn(0,2,4,-1,0,4,5,0,0,1,10,0),Tn(0,3,5,-1,0,5,8,0,0,1,14,0),Tn(0,3,5,-1,0,6,10,0,0,1,18,0),Tn(0,4,5,-2,0,7,10,1,0,2,16,1),Tn(0,5,5,-3,0,8,10,1,0,3,14,2),Tn(0,5,6,-3,0,9,12,1,0,3,16,2),Tn(0,6,6,-3,0,10,14,1,0,4,18,3),Tn(0,6,7,-4,0,11,15,1,0,4,20,3),Tn(0,7,8,-4,0,12,17,2,0,5,22,4),Tn(0,7,8,-4,0,13,19,2,0,5,24,4),Tn(0,7,9,-4,0,14,21,2,0,5,26,4),Tn(0,8,9,-5,0,15,22,2,0,6,28,5),Tn(0,8,10,-5,0,16,24,2,0,6,30,5),Tn(0,8,11,-5,0,17,26,2,0,6,32,5),Tn(0,9,11,-5,0,18,28,2,0,7,34,6),Tn(0,9,12,-6,0,19,29,2,0,7,36,6),Tn(0,10,13,-6,0,20,31,3,0,8,38,7),Tn(0,10,13,-6,0,21,33,3,0,8,40,7),Tn(0,10,14,-6,0,22,35,3,0,8,42,7),Tn(0,11,14,-7,0,23,36,3,0,9,44,8),Tn(0,11,15,-7,0,24,38,3,0,9,46,8)],U6={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},q6={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function OT(e){return`${Math.round(e)}ms`}function G6(e){if(!e)return 0;const t=e/36;return Math.min(Math.round((4+15*t**.25+t/5)*10),3e3)}function W6(e){const t={...U6,...e.easing},i={...q6,...e.duration};return{getAutoHeightDuration:G6,create:(h=["all"],p={})=>{const{duration:f=i.standard,easing:u=t.easeInOut,delay:T=0,...E}=p;return(Array.isArray(h)?h:[h]).map(D=>`${D} ${typeof f=="string"?f:OT(f)} ${u} ${typeof T=="string"?T:OT(T)}`).join(",")},...e,easing:t,duration:i}}const Z6={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function H6(e){return Ao(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function EI(e={}){const t={...e};function i(a){const h=Object.entries(a);for(let p=0;p<h.length;p++){const[f,u]=h[p];!H6(u)||f.startsWith("unstable_")?delete a[f]:Ao(u)&&(a[f]={...u},i(a[f]))}}return i(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(t,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function VT(e){return typeof e=="number"?`${(e*100).toFixed(0)}%`:`calc((${e}) * 100%)`}const X6=e=>{if(!Number.isNaN(+e))return+e;const t=e.match(/\d*\.?\d+/g);if(!t)return 0;let i=0;for(let a=0;a<t.length;a+=1)i+=+t[a];return i};function K6(e){Object.assign(e,{alpha(t,i){const a=this||e;return a.colorSpace?`oklch(from ${t} l c h / ${typeof i=="string"?`calc(${i})`:i})`:a.vars?`rgba(${t.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof i=="string"?`calc(${i})`:i})`:TI(t,X6(i))},lighten(t,i){const a=this||e;return a.colorSpace?`color-mix(in ${a.colorSpace}, ${t}, #fff ${VT(i)})`:cy(t,i)},darken(t,i){const a=this||e;return a.colorSpace?`color-mix(in ${a.colorSpace}, ${t}, #000 ${VT(i)})`:uy(t,i)}})}function $0(e={},...t){const{breakpoints:i,mixins:a={},spacing:h,palette:p={},transitions:f={},typography:u={},shape:T,colorSpace:E,...D}=e;if(e.vars&&e.generateThemeVars===void 0)throw new Error(Yl(20));const z=j1({...p,colorSpace:E}),I=yI(e);let G=Ui(I,{mixins:F6(I.breakpoints,a),palette:z,shadows:$6.slice(),typography:O6(z,u),transitions:W6(f),zIndex:{...Z6}});return G=Ui(G,D),G=t.reduce((K,Q)=>Ui(K,Q),G),G.unstable_sxConfig={...Zg,...D==null?void 0:D.unstable_sxConfig},G.unstable_sx=function(Q){return Vc({sx:Q,theme:this})},G.toRuntimeSource=EI,K6(G),G}function Y6(e){let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,Math.round(t*10)/1e3}const J6=[...Array(25)].map((e,t)=>{if(t===0)return"none";const i=Y6(t);return`linear-gradient(rgba(255 255 255 / ${i}), rgba(255 255 255 / ${i}))`});function II(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function MI(e){return e==="dark"?J6:[]}function Q6(e){const{palette:t={mode:"light"},opacity:i,overlays:a,colorSpace:h,...p}=e,f=j1({...t,colorSpace:h});return{palette:f,opacity:{...II(f.mode),...i},overlays:a||MI(f.mode),...p}}function eV(e){var t;return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!((t=e[1])!=null&&t.match(/(mode|contrastThreshold|tonalOffset)/))}const tV=e=>[...[...Array(25)].map((t,i)=>`--${e?`${e}-`:""}overlays-${i}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],nV=e=>(t,i)=>{const a=e.rootSelector||":root",h=e.colorSchemeSelector;let p=h;if(h==="class"&&(p=".%s"),h==="data"&&(p="[data-%s]"),h!=null&&h.startsWith("data-")&&!h.includes("%s")&&(p=`[${h}="%s"]`),e.defaultColorScheme===t){if(t==="dark"){const f={};return tV(e.cssVarPrefix).forEach(u=>{f[u]=i[u],delete i[u]}),p==="media"?{[a]:i,"@media (prefers-color-scheme: dark)":{[a]:f}}:p?{[p.replace("%s",t)]:f,[`${a}, ${p.replace("%s",t)}`]:i}:{[a]:{...i,...f}}}if(p&&p!=="media")return`${a}, ${p.replace("%s",String(t))}`}else if(t){if(p==="media")return{[`@media (prefers-color-scheme: ${String(t)})`]:{[a]:i}};if(p)return p.replace("%s",String(t))}return a};function rV(e,t){t.forEach(i=>{e[i]||(e[i]={})})}function De(e,t,i){!e[t]&&i&&(e[t]=i)}function Td(e){return typeof e!="string"||!e.startsWith("hsl")?e:SI(e)}function Po(e,t){`${t}Channel`in e||(e[`${t}Channel`]=Sd(Td(e[t])))}function iV(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const Hs=e=>{try{return e()}catch{}},sV=(e="mui")=>w6(e);function vv(e,t,i,a,h){if(!i)return;i=i===!0?{}:i;const p=h==="dark"?"dark":"light";if(!a){t[h]=Q6({...i,palette:{mode:p,...i==null?void 0:i.palette},colorSpace:e});return}const{palette:f,...u}=$0({...a,palette:{mode:p,...i==null?void 0:i.palette},colorSpace:e});return t[h]={...i,palette:f,opacity:{...II(p),...i==null?void 0:i.opacity},overlays:(i==null?void 0:i.overlays)||MI(p)},u}function oV(e={},...t){const{colorSchemes:i={light:!0},defaultColorScheme:a,disableCssColorScheme:h=!1,cssVarPrefix:p="mui",nativeColor:f=!1,shouldSkipGeneratingVar:u=eV,colorSchemeSelector:T=i.light&&i.dark?"media":void 0,rootSelector:E=":root",...D}=e,z=Object.keys(i)[0],I=a||(i.light&&z!=="light"?"light":z),G=sV(p),{[I]:K,light:Q,dark:ce,...j}=i,U={...j};let X=K;if((I==="dark"&&!("dark"in i)||I==="light"&&!("light"in i))&&(X=!0),!X)throw new Error(Yl(21,I));let ne;f&&(ne="oklch");const ge=vv(ne,U,X,D,I);Q&&!U.light&&vv(ne,U,Q,void 0,"light"),ce&&!U.dark&&vv(ne,U,ce,void 0,"dark");let fe={defaultColorScheme:I,...ge,cssVarPrefix:p,colorSchemeSelector:T,rootSelector:E,getCssVar:G,colorSchemes:U,font:{...L6(ge.typography),...ge.font},spacing:iV(D.spacing)};Object.keys(fe.colorSchemes).forEach(Ve=>{const J=fe.colorSchemes[Ve].palette,ze=ot=>{const xt=ot.split("-"),_t=xt[1],Oe=xt[2];return G(ot,J[_t][Oe])};J.mode==="light"&&(De(J.common,"background","#fff"),De(J.common,"onBackground","#000")),J.mode==="dark"&&(De(J.common,"background","#000"),De(J.common,"onBackground","#fff"));function Le(ot,xt,_t){if(ne){let Oe;return ot===Il&&(Oe=`transparent ${((1-_t)*100).toFixed(0)}%`),ot===rn&&(Oe=`#000 ${(_t*100).toFixed(0)}%`),ot===sn&&(Oe=`#fff ${(_t*100).toFixed(0)}%`),`color-mix(in ${ne}, ${xt}, ${Oe})`}return ot(xt,_t)}if(rV(J,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),J.mode==="light"){De(J.Alert,"errorColor",Le(rn,J.error.light,.6)),De(J.Alert,"infoColor",Le(rn,J.info.light,.6)),De(J.Alert,"successColor",Le(rn,J.success.light,.6)),De(J.Alert,"warningColor",Le(rn,J.warning.light,.6)),De(J.Alert,"errorFilledBg",ze("palette-error-main")),De(J.Alert,"infoFilledBg",ze("palette-info-main")),De(J.Alert,"successFilledBg",ze("palette-success-main")),De(J.Alert,"warningFilledBg",ze("palette-warning-main")),De(J.Alert,"errorFilledColor",Hs(()=>J.getContrastText(J.error.main))),De(J.Alert,"infoFilledColor",Hs(()=>J.getContrastText(J.info.main))),De(J.Alert,"successFilledColor",Hs(()=>J.getContrastText(J.success.main))),De(J.Alert,"warningFilledColor",Hs(()=>J.getContrastText(J.warning.main))),De(J.Alert,"errorStandardBg",Le(sn,J.error.light,.9)),De(J.Alert,"infoStandardBg",Le(sn,J.info.light,.9)),De(J.Alert,"successStandardBg",Le(sn,J.success.light,.9)),De(J.Alert,"warningStandardBg",Le(sn,J.warning.light,.9)),De(J.Alert,"errorIconColor",ze("palette-error-main")),De(J.Alert,"infoIconColor",ze("palette-info-main")),De(J.Alert,"successIconColor",ze("palette-success-main")),De(J.Alert,"warningIconColor",ze("palette-warning-main")),De(J.AppBar,"defaultBg",ze("palette-grey-100")),De(J.Avatar,"defaultBg",ze("palette-grey-400")),De(J.Button,"inheritContainedBg",ze("palette-grey-300")),De(J.Button,"inheritContainedHoverBg",ze("palette-grey-A100")),De(J.Chip,"defaultBorder",ze("palette-grey-400")),De(J.Chip,"defaultAvatarColor",ze("palette-grey-700")),De(J.Chip,"defaultIconColor",ze("palette-grey-700")),De(J.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),De(J.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),De(J.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),De(J.LinearProgress,"primaryBg",Le(sn,J.primary.main,.62)),De(J.LinearProgress,"secondaryBg",Le(sn,J.secondary.main,.62)),De(J.LinearProgress,"errorBg",Le(sn,J.error.main,.62)),De(J.LinearProgress,"infoBg",Le(sn,J.info.main,.62)),De(J.LinearProgress,"successBg",Le(sn,J.success.main,.62)),De(J.LinearProgress,"warningBg",Le(sn,J.warning.main,.62)),De(J.Skeleton,"bg",ne?Le(Il,J.text.primary,.11):`rgba(${ze("palette-text-primaryChannel")} / 0.11)`),De(J.Slider,"primaryTrack",Le(sn,J.primary.main,.62)),De(J.Slider,"secondaryTrack",Le(sn,J.secondary.main,.62)),De(J.Slider,"errorTrack",Le(sn,J.error.main,.62)),De(J.Slider,"infoTrack",Le(sn,J.info.main,.62)),De(J.Slider,"successTrack",Le(sn,J.success.main,.62)),De(J.Slider,"warningTrack",Le(sn,J.warning.main,.62));const ot=ne?Le(rn,J.background.default,.6825):tm(J.background.default,.8);De(J.SnackbarContent,"bg",ot),De(J.SnackbarContent,"color",Hs(()=>ne?j0.text.primary:J.getContrastText(ot))),De(J.SpeedDialAction,"fabHoverBg",tm(J.background.paper,.15)),De(J.StepConnector,"border",ze("palette-grey-400")),De(J.StepContent,"border",ze("palette-grey-400")),De(J.Switch,"defaultColor",ze("palette-common-white")),De(J.Switch,"defaultDisabledColor",ze("palette-grey-100")),De(J.Switch,"primaryDisabledColor",Le(sn,J.primary.main,.62)),De(J.Switch,"secondaryDisabledColor",Le(sn,J.secondary.main,.62)),De(J.Switch,"errorDisabledColor",Le(sn,J.error.main,.62)),De(J.Switch,"infoDisabledColor",Le(sn,J.info.main,.62)),De(J.Switch,"successDisabledColor",Le(sn,J.success.main,.62)),De(J.Switch,"warningDisabledColor",Le(sn,J.warning.main,.62)),De(J.TableCell,"border",Le(sn,Le(Il,J.divider,1),.88)),De(J.Tooltip,"bg",Le(Il,J.grey[700],.92))}if(J.mode==="dark"){De(J.Alert,"errorColor",Le(sn,J.error.light,.6)),De(J.Alert,"infoColor",Le(sn,J.info.light,.6)),De(J.Alert,"successColor",Le(sn,J.success.light,.6)),De(J.Alert,"warningColor",Le(sn,J.warning.light,.6)),De(J.Alert,"errorFilledBg",ze("palette-error-dark")),De(J.Alert,"infoFilledBg",ze("palette-info-dark")),De(J.Alert,"successFilledBg",ze("palette-success-dark")),De(J.Alert,"warningFilledBg",ze("palette-warning-dark")),De(J.Alert,"errorFilledColor",Hs(()=>J.getContrastText(J.error.dark))),De(J.Alert,"infoFilledColor",Hs(()=>J.getContrastText(J.info.dark))),De(J.Alert,"successFilledColor",Hs(()=>J.getContrastText(J.success.dark))),De(J.Alert,"warningFilledColor",Hs(()=>J.getContrastText(J.warning.dark))),De(J.Alert,"errorStandardBg",Le(rn,J.error.light,.9)),De(J.Alert,"infoStandardBg",Le(rn,J.info.light,.9)),De(J.Alert,"successStandardBg",Le(rn,J.success.light,.9)),De(J.Alert,"warningStandardBg",Le(rn,J.warning.light,.9)),De(J.Alert,"errorIconColor",ze("palette-error-main")),De(J.Alert,"infoIconColor",ze("palette-info-main")),De(J.Alert,"successIconColor",ze("palette-success-main")),De(J.Alert,"warningIconColor",ze("palette-warning-main")),De(J.AppBar,"defaultBg",ze("palette-grey-900")),De(J.AppBar,"darkBg",ze("palette-background-paper")),De(J.AppBar,"darkColor",ze("palette-text-primary")),De(J.Avatar,"defaultBg",ze("palette-grey-600")),De(J.Button,"inheritContainedBg",ze("palette-grey-800")),De(J.Button,"inheritContainedHoverBg",ze("palette-grey-700")),De(J.Chip,"defaultBorder",ze("palette-grey-700")),De(J.Chip,"defaultAvatarColor",ze("palette-grey-300")),De(J.Chip,"defaultIconColor",ze("palette-grey-300")),De(J.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),De(J.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),De(J.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),De(J.LinearProgress,"primaryBg",Le(rn,J.primary.main,.5)),De(J.LinearProgress,"secondaryBg",Le(rn,J.secondary.main,.5)),De(J.LinearProgress,"errorBg",Le(rn,J.error.main,.5)),De(J.LinearProgress,"infoBg",Le(rn,J.info.main,.5)),De(J.LinearProgress,"successBg",Le(rn,J.success.main,.5)),De(J.LinearProgress,"warningBg",Le(rn,J.warning.main,.5)),De(J.Skeleton,"bg",ne?Le(Il,J.text.primary,.13):`rgba(${ze("palette-text-primaryChannel")} / 0.13)`),De(J.Slider,"primaryTrack",Le(rn,J.primary.main,.5)),De(J.Slider,"secondaryTrack",Le(rn,J.secondary.main,.5)),De(J.Slider,"errorTrack",Le(rn,J.error.main,.5)),De(J.Slider,"infoTrack",Le(rn,J.info.main,.5)),De(J.Slider,"successTrack",Le(rn,J.success.main,.5)),De(J.Slider,"warningTrack",Le(rn,J.warning.main,.5));const ot=ne?Le(sn,J.background.default,.985):tm(J.background.default,.98);De(J.SnackbarContent,"bg",ot),De(J.SnackbarContent,"color",Hs(()=>ne?kI.text.primary:J.getContrastText(ot))),De(J.SpeedDialAction,"fabHoverBg",tm(J.background.paper,.15)),De(J.StepConnector,"border",ze("palette-grey-600")),De(J.StepContent,"border",ze("palette-grey-600")),De(J.Switch,"defaultColor",ze("palette-grey-300")),De(J.Switch,"defaultDisabledColor",ze("palette-grey-600")),De(J.Switch,"primaryDisabledColor",Le(rn,J.primary.main,.55)),De(J.Switch,"secondaryDisabledColor",Le(rn,J.secondary.main,.55)),De(J.Switch,"errorDisabledColor",Le(rn,J.error.main,.55)),De(J.Switch,"infoDisabledColor",Le(rn,J.info.main,.55)),De(J.Switch,"successDisabledColor",Le(rn,J.success.main,.55)),De(J.Switch,"warningDisabledColor",Le(rn,J.warning.main,.55)),De(J.TableCell,"border",Le(rn,Le(Il,J.divider,1),.68)),De(J.Tooltip,"bg",Le(Il,J.grey[700],.92))}Po(J.background,"default"),Po(J.background,"paper"),Po(J.common,"background"),Po(J.common,"onBackground"),Po(J,"divider"),Object.keys(J).forEach(ot=>{const xt=J[ot];ot!=="tonalOffset"&&xt&&typeof xt=="object"&&(xt.main&&De(J[ot],"mainChannel",Sd(Td(xt.main))),xt.light&&De(J[ot],"lightChannel",Sd(Td(xt.light))),xt.dark&&De(J[ot],"darkChannel",Sd(Td(xt.dark))),xt.contrastText&&De(J[ot],"contrastTextChannel",Sd(Td(xt.contrastText))),ot==="text"&&(Po(J[ot],"primary"),Po(J[ot],"secondary")),ot==="action"&&(xt.active&&Po(J[ot],"active"),xt.selected&&Po(J[ot],"selected")))})}),fe=t.reduce((Ve,J)=>Ui(Ve,J),fe);const we={prefix:p,disableCssColorScheme:h,shouldSkipGeneratingVar:u,getSelector:nV(fe),enableContrastVars:f},{vars:Ie,generateThemeVars:Ne,generateStyleSheets:$e}=C6(fe,we);return fe.vars=Ie,Object.entries(fe.colorSchemes[fe.defaultColorScheme]).forEach(([Ve,J])=>{fe[Ve]=J}),fe.generateThemeVars=Ne,fe.generateStyleSheets=$e,fe.generateSpacing=function(){return gI(D.spacing,E1(this))},fe.getColorSchemeSelector=k6(T),fe.spacing=fe.generateSpacing(),fe.shouldSkipGeneratingVar=u,fe.unstable_sxConfig={...Zg,...D==null?void 0:D.unstable_sxConfig},fe.unstable_sx=function(J){return Vc({sx:J,theme:this})},fe.toRuntimeSource=EI,fe}function NT(e,t,i){e.colorSchemes&&i&&(e.colorSchemes[t]={...i!==!0&&i,palette:j1({...i===!0?{}:i.palette,mode:t})})}function aV(e={},...t){const{palette:i,cssVariables:a=!1,colorSchemes:h=i?void 0:{light:!0},defaultColorScheme:p=i==null?void 0:i.mode,...f}=e,u=p||"light",T=h==null?void 0:h[u],E={...h,...i?{[u]:{...typeof T!="boolean"&&T,palette:i}}:void 0};if(a===!1){if(!("colorSchemes"in e))return $0(e,...t);let D=i;"palette"in e||E[u]&&(E[u]!==!0?D=E[u].palette:u==="dark"&&(D={mode:"dark"}));const z=$0({...e,palette:D},...t);return z.defaultColorScheme=u,z.colorSchemes=E,z.palette.mode==="light"&&(z.colorSchemes.light={...E.light!==!0&&E.light,palette:z.palette},NT(z,"dark",E.dark)),z.palette.mode==="dark"&&(z.colorSchemes.dark={...E.dark!==!0&&E.dark,palette:z.palette},NT(z,"light",E.light)),z}return!i&&!("light"in E)&&u==="light"&&(E.light=!0),oV({...f,colorSchemes:E,defaultColorScheme:u,...typeof a!="boolean"&&a},...t)}const lV=aV(),AI="$$material";function uV(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const zI=e=>uV(e)&&e!=="classes",oo=t6({themeId:AI,defaultTheme:lV,rootShouldForwardProp:zI}),ja=b6;function Kc(e){return y6(e)}function cV(e){return Hc("MuiSvgIcon",e)}Xc("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const hV=e=>{const{color:t,fontSize:i,classes:a}=e,h={root:["root",t!=="inherit"&&`color${ir(t)}`,`fontSize${ir(i)}`]};return kf(h,cV,a)},dV=oo("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.color!=="inherit"&&t[`color${ir(i.color)}`],t[`fontSize${ir(i.fontSize)}`]]}})(ja(({theme:e})=>{var t,i,a,h,p,f,u,T,E,D,z,I,G,K;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(h=(t=e.transitions)==null?void 0:t.create)==null?void 0:h.call(t,"fill",{duration:(a=(i=(e.vars??e).transitions)==null?void 0:i.duration)==null?void 0:a.shorter}),variants:[{props:Q=>!Q.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((f=(p=e.typography)==null?void 0:p.pxToRem)==null?void 0:f.call(p,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((T=(u=e.typography)==null?void 0:u.pxToRem)==null?void 0:T.call(u,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((D=(E=e.typography)==null?void 0:E.pxToRem)==null?void 0:D.call(E,35))||"2.1875rem"}},...Object.entries((e.vars??e).palette).filter(([,Q])=>Q&&Q.main).map(([Q])=>{var ce,j;return{props:{color:Q},style:{color:(j=(ce=(e.vars??e).palette)==null?void 0:ce[Q])==null?void 0:j.main}}}),{props:{color:"action"},style:{color:(I=(z=(e.vars??e).palette)==null?void 0:z.action)==null?void 0:I.active}},{props:{color:"disabled"},style:{color:(K=(G=(e.vars??e).palette)==null?void 0:G.action)==null?void 0:K.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),U0=le.forwardRef(function(t,i){const a=Kc({props:t,name:"MuiSvgIcon"}),{children:h,className:p,color:f="inherit",component:u="svg",fontSize:T="medium",htmlColor:E,inheritViewBox:D=!1,titleAccess:z,viewBox:I="0 0 24 24",...G}=a,K=le.isValidElement(h)&&h.type==="svg",Q={...a,color:f,component:u,fontSize:T,instanceFontSize:t.fontSize,inheritViewBox:D,viewBox:I,hasSvgAsChild:K},ce={};D||(ce.viewBox=I);const j=hV(Q);return Ae.jsxs(dV,{as:u,className:jr(j.root,p),focusable:"false",color:E,"aria-hidden":z?void 0:!0,role:z?"img":void 0,ref:i,...ce,...G,...K&&h.props,ownerState:Q,children:[K?h.props.children:h,z?Ae.jsx("title",{children:z}):null]})});U0.muiName="SvgIcon";function hy(e,t){function i(a,h){return Ae.jsx(U0,{"data-testid":void 0,ref:h,...a,children:e})}return i.muiName=U0.muiName,le.memo(le.forwardRef(i))}function Tm(e){const t=le.useRef(e);return xI(()=>{t.current=e}),le.useRef((...i)=>(0,t.current)(...i)).current}function jT(...e){const t=le.useRef(void 0),i=le.useCallback(a=>{const h=e.map(p=>{if(p==null)return null;if(typeof p=="function"){const f=p,u=f(a);return typeof u=="function"?u:()=>{f(null)}}return p.current=a,()=>{p.current=null}});return()=>{h.forEach(p=>p==null?void 0:p())}},e);return le.useMemo(()=>e.every(a=>a==null)?null:a=>{t.current&&(t.current(),t.current=void 0),a!=null&&(t.current=i(a))},e)}const fV=hy(Ae.jsx("path",{d:"M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"})),pV=hy(Ae.jsx("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"})),mV=hy(Ae.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),$T=hy(Ae.jsx("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}));function gV(e,t){if(e==null)return{};var i={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;i[a]=e[a]}return i}function q0(e,t){return q0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},q0(e,t)}function yV(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,q0(e,t)}const UT=nc.createContext(null);function _V(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $1(e,t){var i=function(p){return t&&le.isValidElement(p)?t(p):p},a=Object.create(null);return e&&le.Children.map(e,function(h){return h}).forEach(function(h){a[h.key]=i(h)}),a}function vV(e,t){e=e||{},t=t||{};function i(D){return D in t?t[D]:e[D]}var a=Object.create(null),h=[];for(var p in e)p in t?h.length&&(a[p]=h,h=[]):h.push(p);var f,u={};for(var T in t){if(a[T])for(f=0;f<a[T].length;f++){var E=a[T][f];u[a[T][f]]=i(E)}u[T]=i(T)}for(f=0;f<h.length;f++)u[h[f]]=i(h[f]);return u}function Nl(e,t,i){return i[t]!=null?i[t]:e.props[t]}function xV(e,t){return $1(e.children,function(i){return le.cloneElement(i,{onExited:t.bind(null,i),in:!0,appear:Nl(i,"appear",e),enter:Nl(i,"enter",e),exit:Nl(i,"exit",e)})})}function bV(e,t,i){var a=$1(e.children),h=vV(t,a);return Object.keys(h).forEach(function(p){var f=h[p];if(le.isValidElement(f)){var u=p in t,T=p in a,E=t[p],D=le.isValidElement(E)&&!E.props.in;T&&(!u||D)?h[p]=le.cloneElement(f,{onExited:i.bind(null,f),in:!0,exit:Nl(f,"exit",e),enter:Nl(f,"enter",e)}):!T&&u&&!D?h[p]=le.cloneElement(f,{in:!1}):T&&u&&le.isValidElement(E)&&(h[p]=le.cloneElement(f,{onExited:i.bind(null,f),in:E.props.in,exit:Nl(f,"exit",e),enter:Nl(f,"enter",e)}))}}),h}var wV=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},SV={component:"div",childFactory:function(t){return t}},U1=function(e){yV(t,e);function t(a,h){var p;p=e.call(this,a,h)||this;var f=p.handleExited.bind(_V(p));return p.state={contextValue:{isMounting:!0},handleExited:f,firstRender:!0},p}var i=t.prototype;return i.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},i.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(h,p){var f=p.children,u=p.handleExited,T=p.firstRender;return{children:T?xV(h,u):bV(h,f,u),firstRender:!1}},i.handleExited=function(h,p){var f=$1(this.props.children);h.key in f||(h.props.onExited&&h.props.onExited(p),this.mounted&&this.setState(function(u){var T=ig({},u.children);return delete T[h.key],{children:T}}))},i.render=function(){var h=this.props,p=h.component,f=h.childFactory,u=gV(h,["component","childFactory"]),T=this.state.contextValue,E=wV(this.state.children).map(f);return delete u.appear,delete u.enter,delete u.exit,p===null?nc.createElement(UT.Provider,{value:T},E):nc.createElement(UT.Provider,{value:T},nc.createElement(p,u,E))},t}(nc.Component);U1.propTypes={};U1.defaultProps=SV;const qT={};function DI(e,t){const i=le.useRef(qT);return i.current===qT&&(i.current=e(t)),i}const TV=[];function CV(e){le.useEffect(e,TV)}class q1{constructor(){sd(this,"currentId",null);sd(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});sd(this,"disposeEffect",()=>this.clear)}static create(){return new q1}start(t,i){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,i()},t)}}function kV(){const e=DI(q1.create).current;return CV(e.disposeEffect),e}function GT(e){try{return e.matches(":focus-visible")}catch{}return!1}class ag{constructor(){sd(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new ag}static use(){const t=DI(ag.create).current,[i,a]=le.useState(!1);return t.shouldMount=i,t.setShouldMount=a,le.useEffect(t.mountEffect,[i]),t}mount(){return this.mounted||(this.mounted=EV(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...t){this.mount().then(()=>{var i;return(i=this.ref.current)==null?void 0:i.start(...t)})}stop(...t){this.mount().then(()=>{var i;return(i=this.ref.current)==null?void 0:i.stop(...t)})}pulsate(...t){this.mount().then(()=>{var i;return(i=this.ref.current)==null?void 0:i.pulsate(...t)})}}function PV(){return ag.use()}function EV(){let e,t;const i=new Promise((a,h)=>{e=a,t=h});return i.resolve=e,i.reject=t,i}function IV(e){const{className:t,classes:i,pulsate:a=!1,rippleX:h,rippleY:p,rippleSize:f,in:u,onExited:T,timeout:E}=e,[D,z]=le.useState(!1),I=jr(t,i.ripple,i.rippleVisible,a&&i.ripplePulsate),G={width:f,height:f,top:-(f/2)+p,left:-(f/2)+h},K=jr(i.child,D&&i.childLeaving,a&&i.childPulsate);return!u&&!D&&z(!0),le.useEffect(()=>{if(!u&&T!=null){const Q=setTimeout(T,E);return()=>{clearTimeout(Q)}}},[T,u,E]),Ae.jsx("span",{className:I,style:G,children:Ae.jsx("span",{className:K})})}const ls=Xc("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),G0=550,MV=80,AV=Mf`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,zV=Mf`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,DV=Mf`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,RV=oo("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),LV=oo(IV,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${ls.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${AV};
    animation-duration: ${G0}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  &.${ls.ripplePulsate} {
    animation-duration: ${({theme:e})=>e.transitions.duration.shorter}ms;
  }

  & .${ls.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${ls.childLeaving} {
    opacity: 0;
    animation-name: ${zV};
    animation-duration: ${G0}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  & .${ls.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${DV};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,FV=le.forwardRef(function(t,i){const a=Kc({props:t,name:"MuiTouchRipple"}),{center:h=!1,classes:p={},className:f,...u}=a,[T,E]=le.useState([]),D=le.useRef(0),z=le.useRef(null);le.useEffect(()=>{z.current&&(z.current(),z.current=null)},[T]);const I=le.useRef(!1),G=kV(),K=le.useRef(null),Q=le.useRef(null),ce=le.useCallback(ne=>{const{pulsate:ge,rippleX:fe,rippleY:we,rippleSize:Ie,cb:Ne}=ne;E($e=>[...$e,Ae.jsx(LV,{classes:{ripple:jr(p.ripple,ls.ripple),rippleVisible:jr(p.rippleVisible,ls.rippleVisible),ripplePulsate:jr(p.ripplePulsate,ls.ripplePulsate),child:jr(p.child,ls.child),childLeaving:jr(p.childLeaving,ls.childLeaving),childPulsate:jr(p.childPulsate,ls.childPulsate)},timeout:G0,pulsate:ge,rippleX:fe,rippleY:we,rippleSize:Ie},D.current)]),D.current+=1,z.current=Ne},[p]),j=le.useCallback((ne={},ge={},fe=()=>{})=>{const{pulsate:we=!1,center:Ie=h||ge.pulsate,fakeElement:Ne=!1}=ge;if((ne==null?void 0:ne.type)==="mousedown"&&I.current){I.current=!1;return}(ne==null?void 0:ne.type)==="touchstart"&&(I.current=!0);const $e=Ne?null:Q.current,Ve=$e?$e.getBoundingClientRect():{width:0,height:0,left:0,top:0};let J,ze,Le;if(Ie||ne===void 0||ne.clientX===0&&ne.clientY===0||!ne.clientX&&!ne.touches)J=Math.round(Ve.width/2),ze=Math.round(Ve.height/2);else{const{clientX:ot,clientY:xt}=ne.touches&&ne.touches.length>0?ne.touches[0]:ne;J=Math.round(ot-Ve.left),ze=Math.round(xt-Ve.top)}if(Ie)Le=Math.sqrt((2*Ve.width**2+Ve.height**2)/3),Le%2===0&&(Le+=1);else{const ot=Math.max(Math.abs(($e?$e.clientWidth:0)-J),J)*2+2,xt=Math.max(Math.abs(($e?$e.clientHeight:0)-ze),ze)*2+2;Le=Math.sqrt(ot**2+xt**2)}ne!=null&&ne.touches?K.current===null&&(K.current=()=>{ce({pulsate:we,rippleX:J,rippleY:ze,rippleSize:Le,cb:fe})},G.start(MV,()=>{K.current&&(K.current(),K.current=null)})):ce({pulsate:we,rippleX:J,rippleY:ze,rippleSize:Le,cb:fe})},[h,ce,G]),U=le.useCallback(()=>{j({},{pulsate:!0})},[j]),X=le.useCallback((ne,ge)=>{if(G.clear(),(ne==null?void 0:ne.type)==="touchend"&&K.current){K.current(),K.current=null,G.start(0,()=>{X(ne,ge)});return}K.current=null,E(fe=>fe.length>0?fe.slice(1):fe),z.current=ge},[G]);return le.useImperativeHandle(i,()=>({pulsate:U,start:j,stop:X}),[U,j,X]),Ae.jsx(RV,{className:jr(ls.root,p.root,f),ref:Q,...u,children:Ae.jsx(U1,{component:null,exit:!0,children:T})})});function BV(e){return Hc("MuiButtonBase",e)}const OV=Xc("MuiButtonBase",["root","disabled","focusVisible"]),VV=e=>{const{disabled:t,focusVisible:i,focusVisibleClassName:a,classes:h}=e,f=kf({root:["root",t&&"disabled",i&&"focusVisible"]},BV,h);return i&&a&&(f.root+=` ${a}`),f},NV=oo("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${OV.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),RI=le.forwardRef(function(t,i){const a=Kc({props:t,name:"MuiButtonBase"}),{action:h,centerRipple:p=!1,children:f,className:u,component:T="button",disabled:E=!1,disableRipple:D=!1,disableTouchRipple:z=!1,focusRipple:I=!1,focusVisibleClassName:G,LinkComponent:K="a",onBlur:Q,onClick:ce,onContextMenu:j,onDragLeave:U,onFocus:X,onFocusVisible:ne,onKeyDown:ge,onKeyUp:fe,onMouseDown:we,onMouseLeave:Ie,onMouseUp:Ne,onTouchEnd:$e,onTouchMove:Ve,onTouchStart:J,tabIndex:ze=0,TouchRippleProps:Le,touchRippleRef:ot,type:xt,..._t}=a,Oe=le.useRef(null),et=PV(),pt=jT(et.ref,ot),[Pt,Bt]=le.useState(!1);E&&Pt&&Bt(!1),le.useImperativeHandle(h,()=>({focusVisible:()=>{Bt(!0),Oe.current.focus()}}),[]);const Gr=et.shouldMount&&!D&&!E;le.useEffect(()=>{Pt&&I&&!D&&et.pulsate()},[D,I,Pt,et]);const Gn=Eo(et,"start",we,z),sr=Eo(et,"stop",j,z),or=Eo(et,"stop",U,z),Dn=Eo(et,"stop",Ne,z),Wr=Eo(et,"stop",Tt=>{Pt&&Tt.preventDefault(),Ie&&Ie(Tt)},z),vs=Eo(et,"start",J,z),xs=Eo(et,"stop",$e,z),ao=Eo(et,"stop",Ve,z),Ti=Eo(et,"stop",Tt=>{GT(Tt.target)||Bt(!1),Q&&Q(Tt)},!1),Xi=Tm(Tt=>{Oe.current||(Oe.current=Tt.currentTarget),GT(Tt.target)&&(Bt(!0),ne&&ne(Tt)),X&&X(Tt)}),oi=()=>{const Tt=Oe.current;return T&&T!=="button"&&!(Tt.tagName==="A"&&Tt.href)},Fs=Tm(Tt=>{I&&!Tt.repeat&&Pt&&Tt.key===" "&&et.stop(Tt,()=>{et.start(Tt)}),Tt.target===Tt.currentTarget&&oi()&&Tt.key===" "&&Tt.preventDefault(),ge&&ge(Tt),Tt.target===Tt.currentTarget&&oi()&&Tt.key==="Enter"&&!E&&(Tt.preventDefault(),ce&&ce(Tt))}),ke=Tm(Tt=>{I&&Tt.key===" "&&Pt&&!Tt.defaultPrevented&&et.stop(Tt,()=>{et.pulsate(Tt)}),fe&&fe(Tt),ce&&Tt.target===Tt.currentTarget&&oi()&&Tt.key===" "&&!Tt.defaultPrevented&&ce(Tt)});let ai=T;ai==="button"&&(_t.href||_t.to)&&(ai=K);const Ci={};ai==="button"?(Ci.type=xt===void 0?"button":xt,Ci.disabled=E):(!_t.href&&!_t.to&&(Ci.role="button"),E&&(Ci["aria-disabled"]=E));const Ot=jT(i,Oe),ln={...a,centerRipple:p,component:T,disabled:E,disableRipple:D,disableTouchRipple:z,focusRipple:I,tabIndex:ze,focusVisible:Pt},lo=VV(ln);return Ae.jsxs(NV,{as:ai,className:jr(lo.root,u),ownerState:ln,onBlur:Ti,onClick:ce,onContextMenu:sr,onFocus:Xi,onKeyDown:Fs,onKeyUp:ke,onMouseDown:Gn,onMouseLeave:Wr,onMouseUp:Dn,onDragLeave:or,onTouchEnd:xs,onTouchMove:ao,onTouchStart:vs,ref:Ot,tabIndex:E?-1:ze,type:xt,...Ci,..._t,children:[f,Gr?Ae.jsx(FV,{ref:pt,center:p,...Le}):null]})});function Eo(e,t,i,a=!1){return Tm(h=>(i&&i(h),a||e[t](h),!0))}function jV(e){return typeof e.main=="string"}function $V(e,t=[]){if(!jV(e))return!1;for(const i of t)if(!e.hasOwnProperty(i)||typeof e[i]!="string")return!1;return!0}function lg(e=[]){return([,t])=>t&&$V(t,e)}function UV(e){return Hc("MuiCircularProgress",e)}Xc("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Ca=44,W0=Mf`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,Z0=Mf`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,qV=typeof W0!="string"?V1`
        animation: ${W0} 1.4s linear infinite;
      `:null,GV=typeof Z0!="string"?V1`
        animation: ${Z0} 1.4s ease-in-out infinite;
      `:null,WV=e=>{const{classes:t,variant:i,color:a,disableShrink:h}=e,p={root:["root",i,`color${ir(a)}`],svg:["svg"],circle:["circle",`circle${ir(i)}`,h&&"circleDisableShrink"]};return kf(p,UV,t)},ZV=oo("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t[i.variant],t[`color${ir(i.color)}`]]}})(ja(({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:qV||{animation:`${W0} 1.4s linear infinite`}},...Object.entries(e.palette).filter(lg()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}}))]}))),HV=oo("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),XV=oo("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.circle,t[`circle${ir(i.variant)}`],i.disableShrink&&t.circleDisableShrink]}})(ja(({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink,style:GV||{animation:`${Z0} 1.4s ease-in-out infinite`}}]}))),KV=le.forwardRef(function(t,i){const a=Kc({props:t,name:"MuiCircularProgress"}),{className:h,color:p="primary",disableShrink:f=!1,size:u=40,style:T,thickness:E=3.6,value:D=0,variant:z="indeterminate",...I}=a,G={...a,color:p,disableShrink:f,size:u,thickness:E,value:D,variant:z},K=WV(G),Q={},ce={},j={};if(z==="determinate"){const U=2*Math.PI*((Ca-E)/2);Q.strokeDasharray=U.toFixed(3),j["aria-valuenow"]=Math.round(D),Q.strokeDashoffset=`${((100-D)/100*U).toFixed(3)}px`,ce.transform="rotate(-90deg)"}return Ae.jsx(ZV,{className:jr(K.root,h),style:{width:u,height:u,...ce,...T},ownerState:G,ref:i,role:"progressbar",...j,...I,children:Ae.jsx(HV,{className:K.svg,ownerState:G,viewBox:`${Ca/2} ${Ca/2} ${Ca} ${Ca}`,children:Ae.jsx(XV,{className:K.circle,style:Q,ownerState:G,cx:Ca,cy:Ca,r:(Ca-E)/2,fill:"none",strokeWidth:E})})})});function YV(e){return Hc("MuiIconButton",e)}const WT=Xc("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),JV=e=>{const{classes:t,disabled:i,color:a,edge:h,size:p,loading:f}=e,u={root:["root",f&&"loading",i&&"disabled",a!=="default"&&`color${ir(a)}`,h&&`edge${ir(h)}`,`size${ir(p)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return kf(u,YV,t)},QV=oo(RI,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.loading&&t.loading,i.color!=="default"&&t[`color${ir(i.color)}`],i.edge&&t[`edge${ir(i.edge)}`],t[`size${ir(i.size)}`]]}})(ja(({theme:e})=>({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),variants:[{props:t=>!t.disableRipple,style:{"--IconButton-hoverBg":e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),ja(({theme:e})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(e.palette).filter(lg()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})),...Object.entries(e.palette).filter(lg()).map(([t])=>({props:{color:t},style:{"--IconButton-hoverBg":e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:e.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:e.typography.pxToRem(28)}}],[`&.${WT.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled},[`&.${WT.loading}`]:{color:"transparent"}}))),eN=oo("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:e})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(e.vars||e).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),xv=le.forwardRef(function(t,i){const a=Kc({props:t,name:"MuiIconButton"}),{edge:h=!1,children:p,className:f,color:u="default",disabled:T=!1,disableFocusRipple:E=!1,size:D="medium",id:z,loading:I=null,loadingIndicator:G,...K}=a,Q=x6(z),ce=G??Ae.jsx(KV,{"aria-labelledby":Q,color:"inherit",size:16}),j={...a,edge:h,color:u,disabled:T,disableFocusRipple:E,loading:I,loadingIndicator:ce,size:D},U=JV(j);return Ae.jsxs(QV,{id:I?Q:z,className:jr(U.root,f),centerRipple:!0,focusRipple:!E,disabled:T||I,ref:i,...K,ownerState:j,children:[typeof I=="boolean"&&Ae.jsx("span",{className:U.loadingWrapper,style:{display:"contents"},children:Ae.jsx(eN,{className:U.loadingIndicator,ownerState:j,children:I&&ce})}),p]})});function tN(e){return Hc("MuiFab",e)}const ZT=Xc("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),nN=e=>{const{color:t,variant:i,classes:a,size:h}=e,p={root:["root",i,`size${ir(h)}`,t==="inherit"?"colorInherit":t]},f=kf(p,tN,a);return{...a,...f}},rN=oo(RI,{name:"MuiFab",slot:"Root",shouldForwardProp:e=>zI(e)||e==="classes",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t[i.variant],t[`size${ir(i.size)}`],i.color==="inherit"&&t.colorInherit,t[ir(i.size)],t[i.color]]}})(ja(({theme:e})=>{var t,i;return{...e.typography.button,minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(e.vars||e).zIndex.fab,boxShadow:(e.vars||e).shadows[6],"&:active":{boxShadow:(e.vars||e).shadows[12]},color:e.vars?e.vars.palette.grey[900]:(i=(t=e.palette).getContrastText)==null?void 0:i.call(t,e.palette.grey[300]),backgroundColor:(e.vars||e).palette.grey[300],"&:hover":{backgroundColor:(e.vars||e).palette.grey.A100,"@media (hover: none)":{backgroundColor:(e.vars||e).palette.grey[300]},textDecoration:"none"},[`&.${ZT.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},variants:[{props:{size:"small"},style:{width:40,height:40}},{props:{size:"medium"},style:{width:48,height:48}},{props:{variant:"extended"},style:{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48}},{props:{variant:"extended",size:"small"},style:{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34}},{props:{variant:"extended",size:"medium"},style:{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40}},{props:{color:"inherit"},style:{color:"inherit"}}]}}),ja(({theme:e})=>({variants:[...Object.entries(e.palette).filter(lg(["dark","contrastText"])).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].contrastText,backgroundColor:(e.vars||e).palette[t].main,"&:hover":{backgroundColor:(e.vars||e).palette[t].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[t].main}}}}))]})),ja(({theme:e})=>({[`&.${ZT.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}))),iN=le.forwardRef(function(t,i){const a=Kc({props:t,name:"MuiFab"}),{children:h,className:p,color:f="default",component:u="button",disabled:T=!1,disableFocusRipple:E=!1,focusVisibleClassName:D,size:z="large",variant:I="circular",...G}=a,K={...a,color:f,component:u,disabled:T,disableFocusRipple:E,size:z,variant:I},Q=nN(K);return Ae.jsx(rN,{className:jr(Q.root,p),component:u,disabled:T,focusRipple:!E,focusVisibleClassName:jr(Q.focusVisible,D),ownerState:K,ref:i,...G,classes:Q,children:h})}),sN=wI({themeId:AI}),oN=40,aN={width:"min(320px, calc(100vw - 32px))",display:"flex",flexDirection:"column",gap:0,borderRadius:16,overflow:"hidden",background:"rgba(255,255,255,0.92)",backdropFilter:"blur(18px)",WebkitBackdropFilter:"blur(18px)",border:"1px solid rgba(0,0,0,0.08)",boxShadow:"0 4px 24px rgba(0,0,0,0.12)",color:"#0f172a"},lN={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 12px",borderBottom:"1px solid rgba(0,0,0,0.06)"},nm={padding:"14px 16px"},bv={height:1,background:"rgba(0,0,0,0.07)",margin:"0 16px"};function uN(){const e=sN("(max-width:640px)"),[t,i]=le.useState(5),[a,h]=le.useState(!0),[p,f]=le.useState([]),[u,T]=le.useState(0),[E,D]=le.useState([]),[z,I]=le.useState(!1),G=p[u]??null,K=le.useMemo(()=>({position:"absolute",top:e?8:16,left:e?8:16,right:e?8:void 0,pointerEvents:"auto",zIndex:10}),[e]),Q=e?"-110%":`calc(-100% + ${oN}px)`;return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx($F,{route:G}),Ae.jsx(P0,{children:e&&!a&&Ae.jsx(vm.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.18},style:{position:"absolute",top:16,left:16,zIndex:11},children:Ae.jsx(iN,{size:"small",onClick:()=>h(!0),sx:{background:"rgba(255,255,255,0.95)",color:"#0f172a",boxShadow:"0 4px 20px rgba(0,0,0,0.18)","&:hover":{background:"#fff"}},children:Ae.jsx($T,{fontSize:"small"})})})}),Ae.jsx(vm.div,{initial:!1,animate:{x:a?0:Q,opacity:1},transition:{type:"spring",stiffness:260,damping:30},style:K,children:Ae.jsxs("div",{style:aN,children:[Ae.jsxs("div",{style:lN,children:[Ae.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#0f172a"},children:"Routes"}),Ae.jsx(xv,{size:"small",onClick:()=>h(ce=>!ce),sx:{color:"#64748b"},children:a?Ae.jsx(mV,{fontSize:"small"}):Ae.jsx($T,{fontSize:"small"})})]}),Ae.jsxs("div",{style:{pointerEvents:a?"auto":"none",opacity:a?1:.6,transition:"opacity 0.2s ease"},children:[Ae.jsx("div",{style:nm,children:Ae.jsx(NF,{onRoutes:ce=>{f(ce),T(0)},targetMiles:t,polygon:z?E:void 0})}),Ae.jsx(P0,{children:p.length>0&&Ae.jsxs(vm.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:[Ae.jsx("div",{style:bv}),Ae.jsxs("div",{style:{...nm,paddingTop:10,paddingBottom:10},children:[Ae.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[Ae.jsx(xv,{size:"small",onClick:()=>T(ce=>Math.max(0,ce-1)),disabled:u===0,sx:{color:"#cbd5e1","&:not(:disabled)":{color:"#0f172a"},p:.5},children:Ae.jsx(fV,{sx:{fontSize:14}})}),Ae.jsxs("div",{style:{textAlign:"center"},children:[Ae.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#0f172a"},children:["Route ",u+1," ",Ae.jsxs("span",{style:{color:"#94a3b8"},children:["/ ",p.length]})]}),Ae.jsxs("div",{style:{fontSize:11,color:"#64748b",marginTop:1},children:[G==null?void 0:G.distanceMiles.toFixed(2)," mi "," ",(()=>{const ce=Math.round((G==null?void 0:G.durationMinutes)??0),j=Math.floor(ce/60),U=ce%60;return j>0?`${j}h ${U}m`:`${ce}m`})()]})]}),Ae.jsx(xv,{size:"small",onClick:()=>T(ce=>Math.min(p.length-1,ce+1)),disabled:u===p.length-1,sx:{color:"#cbd5e1","&:not(:disabled)":{color:"#0f172a"},p:.5},children:Ae.jsx(pV,{sx:{fontSize:14}})})]}),G&&Ae.jsx(WF,{route:G})]})]},"route-section")}),Ae.jsx("div",{style:bv}),Ae.jsx("div",{style:nm,children:Ae.jsx(DF,{value:t,onChange:i})}),Ae.jsx("div",{style:bv}),Ae.jsxs("div",{style:{...nm,paddingTop:10,paddingBottom:10},children:[Ae.jsx("div",{style:{fontSize:11,color:"#94a3b8",fontWeight:600,letterSpacing:"0.06em",textTransform:"uppercase",marginBottom:8},children:"Region"}),Ae.jsx(zF,{polygonCoords:E,polygonClosed:z,setPolygonCoords:D,setPolygonClosed:I})]})]})]})})]})}function cN(){return Ae.jsx(Ae.Fragment,{children:Ae.jsxs(pR,{initialViewState:{longitude:Km[0],latitude:Km[1],zoom:2},mapStyle:"https://tiles.openfreemap.org/styles/liberty",children:[Ae.jsx(QR,{}),Ae.jsx(uN,{})]})})}lP(document.getElementById("root")).render(Ae.jsx(cN,{}));
