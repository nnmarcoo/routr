var vA=Object.defineProperty;var xA=(e,t,i)=>t in e?vA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var td=(e,t,i)=>xA(e,typeof t!="symbol"?t+"":t,i);function $T(e,t){for(var i=0;i<t.length;i++){const a=t[i];if(typeof a!="string"&&!Array.isArray(a)){for(const h in a)if(h!=="default"&&!(h in e)){const p=Object.getOwnPropertyDescriptor(a,h);p&&Object.defineProperty(e,h,p.get?p:{enumerable:!0,get:()=>a[h]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))a(h);new MutationObserver(h=>{for(const p of h)if(p.type==="childList")for(const m of p.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function i(h){const p={};return h.integrity&&(p.integrity=h.integrity),h.referrerPolicy&&(p.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?p.credentials="include":h.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function a(h){if(h.ep)return;h.ep=!0;const p=i(h);fetch(h.href,p)}})();var bA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function UT(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var GT={exports:{}},ig={},qT={exports:{}},jt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hf=Symbol.for("react.element"),wA=Symbol.for("react.portal"),SA=Symbol.for("react.fragment"),TA=Symbol.for("react.strict_mode"),CA=Symbol.for("react.profiler"),kA=Symbol.for("react.provider"),PA=Symbol.for("react.context"),EA=Symbol.for("react.forward_ref"),IA=Symbol.for("react.suspense"),MA=Symbol.for("react.memo"),AA=Symbol.for("react.lazy"),Tw=Symbol.iterator;function zA(e){return e===null||typeof e!="object"?null:(e=Tw&&e[Tw]||e["@@iterator"],typeof e=="function"?e:null)}var ZT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},WT=Object.assign,HT={};function Nc(e,t,i){this.props=e,this.context=t,this.refs=HT,this.updater=i||ZT}Nc.prototype.isReactComponent={};Nc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Nc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function XT(){}XT.prototype=Nc.prototype;function Z0(e,t,i){this.props=e,this.context=t,this.refs=HT,this.updater=i||ZT}var W0=Z0.prototype=new XT;W0.constructor=Z0;WT(W0,Nc.prototype);W0.isPureReactComponent=!0;var Cw=Array.isArray,KT=Object.prototype.hasOwnProperty,H0={current:null},YT={key:!0,ref:!0,__self:!0,__source:!0};function JT(e,t,i){var a,h={},p=null,m=null;if(t!=null)for(a in t.ref!==void 0&&(m=t.ref),t.key!==void 0&&(p=""+t.key),t)KT.call(t,a)&&!YT.hasOwnProperty(a)&&(h[a]=t[a]);var u=arguments.length-2;if(u===1)h.children=i;else if(1<u){for(var C=Array(u),E=0;E<u;E++)C[E]=arguments[E+2];h.children=C}if(e&&e.defaultProps)for(a in u=e.defaultProps,u)h[a]===void 0&&(h[a]=u[a]);return{$$typeof:hf,type:e,key:p,ref:m,props:h,_owner:H0.current}}function DA(e,t){return{$$typeof:hf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function X0(e){return typeof e=="object"&&e!==null&&e.$$typeof===hf}function RA(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(i){return t[i]})}var kw=/\/+/g;function S_(e,t){return typeof e=="object"&&e!==null&&e.key!=null?RA(""+e.key):t.toString(36)}function tm(e,t,i,a,h){var p=typeof e;(p==="undefined"||p==="boolean")&&(e=null);var m=!1;if(e===null)m=!0;else switch(p){case"string":case"number":m=!0;break;case"object":switch(e.$$typeof){case hf:case wA:m=!0}}if(m)return m=e,h=h(m),e=a===""?"."+S_(m,0):a,Cw(h)?(i="",e!=null&&(i=e.replace(kw,"$&/")+"/"),tm(h,t,i,"",function(E){return E})):h!=null&&(X0(h)&&(h=DA(h,i+(!h.key||m&&m.key===h.key?"":(""+h.key).replace(kw,"$&/")+"/")+e)),t.push(h)),1;if(m=0,a=a===""?".":a+":",Cw(e))for(var u=0;u<e.length;u++){p=e[u];var C=a+S_(p,u);m+=tm(p,t,i,C,h)}else if(C=zA(e),typeof C=="function")for(e=C.call(e),u=0;!(p=e.next()).done;)p=p.value,C=a+S_(p,u++),m+=tm(p,t,i,C,h);else if(p==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return m}function Ap(e,t,i){if(e==null)return e;var a=[],h=0;return tm(e,a,"","",function(p){return t.call(i,p,h++)}),a}function LA(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(i){(e._status===0||e._status===-1)&&(e._status=1,e._result=i)},function(i){(e._status===0||e._status===-1)&&(e._status=2,e._result=i)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ri={current:null},nm={transition:null},FA={ReactCurrentDispatcher:ri,ReactCurrentBatchConfig:nm,ReactCurrentOwner:H0};function QT(){throw Error("act(...) is not supported in production builds of React.")}jt.Children={map:Ap,forEach:function(e,t,i){Ap(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return Ap(e,function(){t++}),t},toArray:function(e){return Ap(e,function(t){return t})||[]},only:function(e){if(!X0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};jt.Component=Nc;jt.Fragment=SA;jt.Profiler=CA;jt.PureComponent=Z0;jt.StrictMode=TA;jt.Suspense=IA;jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FA;jt.act=QT;jt.cloneElement=function(e,t,i){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=WT({},e.props),h=e.key,p=e.ref,m=e._owner;if(t!=null){if(t.ref!==void 0&&(p=t.ref,m=H0.current),t.key!==void 0&&(h=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(C in t)KT.call(t,C)&&!YT.hasOwnProperty(C)&&(a[C]=t[C]===void 0&&u!==void 0?u[C]:t[C])}var C=arguments.length-2;if(C===1)a.children=i;else if(1<C){u=Array(C);for(var E=0;E<C;E++)u[E]=arguments[E+2];a.children=u}return{$$typeof:hf,type:e.type,key:h,ref:p,props:a,_owner:m}};jt.createContext=function(e){return e={$$typeof:PA,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:kA,_context:e},e.Consumer=e};jt.createElement=JT;jt.createFactory=function(e){var t=JT.bind(null,e);return t.type=e,t};jt.createRef=function(){return{current:null}};jt.forwardRef=function(e){return{$$typeof:EA,render:e}};jt.isValidElement=X0;jt.lazy=function(e){return{$$typeof:AA,_payload:{_status:-1,_result:e},_init:LA}};jt.memo=function(e,t){return{$$typeof:MA,type:e,compare:t===void 0?null:t}};jt.startTransition=function(e){var t=nm.transition;nm.transition={};try{e()}finally{nm.transition=t}};jt.unstable_act=QT;jt.useCallback=function(e,t){return ri.current.useCallback(e,t)};jt.useContext=function(e){return ri.current.useContext(e)};jt.useDebugValue=function(){};jt.useDeferredValue=function(e){return ri.current.useDeferredValue(e)};jt.useEffect=function(e,t){return ri.current.useEffect(e,t)};jt.useId=function(){return ri.current.useId()};jt.useImperativeHandle=function(e,t,i){return ri.current.useImperativeHandle(e,t,i)};jt.useInsertionEffect=function(e,t){return ri.current.useInsertionEffect(e,t)};jt.useLayoutEffect=function(e,t){return ri.current.useLayoutEffect(e,t)};jt.useMemo=function(e,t){return ri.current.useMemo(e,t)};jt.useReducer=function(e,t,i){return ri.current.useReducer(e,t,i)};jt.useRef=function(e){return ri.current.useRef(e)};jt.useState=function(e){return ri.current.useState(e)};jt.useSyncExternalStore=function(e,t,i){return ri.current.useSyncExternalStore(e,t,i)};jt.useTransition=function(){return ri.current.useTransition()};jt.version="18.3.1";qT.exports=jt;var le=qT.exports;const tc=UT(le),wm=$T({__proto__:null,default:tc},[le]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BA=le,OA=Symbol.for("react.element"),VA=Symbol.for("react.fragment"),NA=Object.prototype.hasOwnProperty,jA=BA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$A={key:!0,ref:!0,__self:!0,__source:!0};function eC(e,t,i){var a,h={},p=null,m=null;i!==void 0&&(p=""+i),t.key!==void 0&&(p=""+t.key),t.ref!==void 0&&(m=t.ref);for(a in t)NA.call(t,a)&&!$A.hasOwnProperty(a)&&(h[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)h[a]===void 0&&(h[a]=t[a]);return{$$typeof:OA,type:e,key:p,ref:m,props:h,_owner:jA.current}}ig.Fragment=VA;ig.jsx=eC;ig.jsxs=eC;GT.exports=ig;var De=GT.exports,tC={exports:{}},Zi={},nC={exports:{}},rC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Oe,tt){var gt=Oe.length;Oe.push(tt);e:for(;0<gt;){var Pt=gt-1>>>1,Bt=Oe[Pt];if(0<h(Bt,tt))Oe[Pt]=tt,Oe[gt]=Bt,gt=Pt;else break e}}function i(Oe){return Oe.length===0?null:Oe[0]}function a(Oe){if(Oe.length===0)return null;var tt=Oe[0],gt=Oe.pop();if(gt!==tt){Oe[0]=gt;e:for(var Pt=0,Bt=Oe.length,Gr=Bt>>>1;Pt<Gr;){var qn=2*(Pt+1)-1,ir=Oe[qn],sr=qn+1,Dn=Oe[sr];if(0>h(ir,gt))sr<Bt&&0>h(Dn,ir)?(Oe[Pt]=Dn,Oe[sr]=gt,Pt=sr):(Oe[Pt]=ir,Oe[qn]=gt,Pt=qn);else if(sr<Bt&&0>h(Dn,gt))Oe[Pt]=Dn,Oe[sr]=gt,Pt=sr;else break e}}return tt}function h(Oe,tt){var gt=Oe.sortIndex-tt.sortIndex;return gt!==0?gt:Oe.id-tt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var p=performance;e.unstable_now=function(){return p.now()}}else{var m=Date,u=m.now();e.unstable_now=function(){return m.now()-u}}var C=[],E=[],D=1,z=null,A=3,Z=!1,Y=!1,te=!1,pe=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function X(Oe){for(var tt=i(E);tt!==null;){if(tt.callback===null)a(E);else if(tt.startTime<=Oe)a(E),tt.sortIndex=tt.expirationTime,t(C,tt);else break;tt=i(E)}}function ae(Oe){if(te=!1,X(Oe),!Y)if(i(C)!==null)Y=!0,Ct(_e);else{var tt=i(E);tt!==null&&bt(ae,tt.startTime-Oe)}}function _e(Oe,tt){Y=!1,te&&(te=!1,U(Ie),Ie=-1),Z=!0;var gt=A;try{for(X(tt),z=i(C);z!==null&&(!(z.expirationTime>tt)||Oe&&!Ne());){var Pt=z.callback;if(typeof Pt=="function"){z.callback=null,A=z.priorityLevel;var Bt=Pt(z.expirationTime<=tt);tt=e.unstable_now(),typeof Bt=="function"?z.callback=Bt:z===i(C)&&a(C),X(tt)}else a(C);z=i(C)}if(z!==null)var Gr=!0;else{var qn=i(E);qn!==null&&bt(ae,qn.startTime-tt),Gr=!1}return Gr}finally{z=null,A=gt,Z=!1}}var ye=!1,Se=null,Ie=-1,Be=5,Ue=-1;function Ne(){return!(e.unstable_now()-Ue<Be)}function J(){if(Se!==null){var Oe=e.unstable_now();Ue=Oe;var tt=!0;try{tt=Se(!0,Oe)}finally{tt?je():(ye=!1,Se=null)}}else ye=!1}var je;if(typeof G=="function")je=function(){G(J)};else if(typeof MessageChannel<"u"){var Fe=new MessageChannel,ft=Fe.port2;Fe.port1.onmessage=J,je=function(){ft.postMessage(null)}}else je=function(){pe(J,0)};function Ct(Oe){Se=Oe,ye||(ye=!0,je())}function bt(Oe,tt){Ie=pe(function(){Oe(e.unstable_now())},tt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Oe){Oe.callback=null},e.unstable_continueExecution=function(){Y||Z||(Y=!0,Ct(_e))},e.unstable_forceFrameRate=function(Oe){0>Oe||125<Oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Be=0<Oe?Math.floor(1e3/Oe):5},e.unstable_getCurrentPriorityLevel=function(){return A},e.unstable_getFirstCallbackNode=function(){return i(C)},e.unstable_next=function(Oe){switch(A){case 1:case 2:case 3:var tt=3;break;default:tt=A}var gt=A;A=tt;try{return Oe()}finally{A=gt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Oe,tt){switch(Oe){case 1:case 2:case 3:case 4:case 5:break;default:Oe=3}var gt=A;A=Oe;try{return tt()}finally{A=gt}},e.unstable_scheduleCallback=function(Oe,tt,gt){var Pt=e.unstable_now();switch(typeof gt=="object"&&gt!==null?(gt=gt.delay,gt=typeof gt=="number"&&0<gt?Pt+gt:Pt):gt=Pt,Oe){case 1:var Bt=-1;break;case 2:Bt=250;break;case 5:Bt=1073741823;break;case 4:Bt=1e4;break;default:Bt=5e3}return Bt=gt+Bt,Oe={id:D++,callback:tt,priorityLevel:Oe,startTime:gt,expirationTime:Bt,sortIndex:-1},gt>Pt?(Oe.sortIndex=gt,t(E,Oe),i(C)===null&&Oe===i(E)&&(te?(U(Ie),Ie=-1):te=!0,bt(ae,gt-Pt))):(Oe.sortIndex=Bt,t(C,Oe),Y||Z||(Y=!0,Ct(_e))),Oe},e.unstable_shouldYield=Ne,e.unstable_wrapCallback=function(Oe){var tt=A;return function(){var gt=A;A=tt;try{return Oe.apply(this,arguments)}finally{A=gt}}}})(rC);nC.exports=rC;var UA=nC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GA=le,qi=UA;function Ge(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iC=new Set,Fd={};function Yl(e,t){Ec(e,t),Ec(e+"Capture",t)}function Ec(e,t){for(Fd[e]=t,e=0;e<t.length;e++)iC.add(t[e])}var Ro=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_v=Object.prototype.hasOwnProperty,qA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Pw={},Ew={};function ZA(e){return _v.call(Ew,e)?!0:_v.call(Pw,e)?!1:qA.test(e)?Ew[e]=!0:(Pw[e]=!0,!1)}function WA(e,t,i,a){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return a?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function HA(e,t,i,a){if(t===null||typeof t>"u"||WA(e,t,i,a))return!0;if(a)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ii(e,t,i,a,h,p,m){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=a,this.attributeNamespace=h,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=p,this.removeEmptyString=m}var Pr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Pr[e]=new ii(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Pr[t]=new ii(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Pr[e]=new ii(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Pr[e]=new ii(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Pr[e]=new ii(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Pr[e]=new ii(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Pr[e]=new ii(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Pr[e]=new ii(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Pr[e]=new ii(e,5,!1,e.toLowerCase(),null,!1,!1)});var K0=/[\-:]([a-z])/g;function Y0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(K0,Y0);Pr[t]=new ii(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(K0,Y0);Pr[t]=new ii(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(K0,Y0);Pr[t]=new ii(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Pr[e]=new ii(e,1,!1,e.toLowerCase(),null,!1,!1)});Pr.xlinkHref=new ii("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Pr[e]=new ii(e,1,!1,e.toLowerCase(),null,!0,!0)});function J0(e,t,i,a){var h=Pr.hasOwnProperty(t)?Pr[t]:null;(h!==null?h.type!==0:a||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(HA(t,i,h,a)&&(i=null),a||h===null?ZA(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):h.mustUseProperty?e[h.propertyName]=i===null?h.type===3?!1:"":i:(t=h.attributeName,a=h.attributeNamespace,i===null?e.removeAttribute(t):(h=h.type,i=h===3||h===4&&i===!0?"":""+i,a?e.setAttributeNS(a,t,i):e.setAttribute(t,i))))}var jo=GA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zp=Symbol.for("react.element"),nc=Symbol.for("react.portal"),rc=Symbol.for("react.fragment"),Q0=Symbol.for("react.strict_mode"),vv=Symbol.for("react.profiler"),sC=Symbol.for("react.provider"),oC=Symbol.for("react.context"),ex=Symbol.for("react.forward_ref"),xv=Symbol.for("react.suspense"),bv=Symbol.for("react.suspense_list"),tx=Symbol.for("react.memo"),Pa=Symbol.for("react.lazy"),aC=Symbol.for("react.offscreen"),Iw=Symbol.iterator;function nd(e){return e===null||typeof e!="object"?null:(e=Iw&&e[Iw]||e["@@iterator"],typeof e=="function"?e:null)}var zn=Object.assign,T_;function pd(e){if(T_===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);T_=t&&t[1]||""}return`
`+T_+e}var C_=!1;function k_(e,t){if(!e||C_)return"";C_=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(E){var a=E}Reflect.construct(e,[],t)}else{try{t.call()}catch(E){a=E}e.call(t.prototype)}else{try{throw Error()}catch(E){a=E}e()}}catch(E){if(E&&a&&typeof E.stack=="string"){for(var h=E.stack.split(`
`),p=a.stack.split(`
`),m=h.length-1,u=p.length-1;1<=m&&0<=u&&h[m]!==p[u];)u--;for(;1<=m&&0<=u;m--,u--)if(h[m]!==p[u]){if(m!==1||u!==1)do if(m--,u--,0>u||h[m]!==p[u]){var C=`
`+h[m].replace(" at new "," at ");return e.displayName&&C.includes("<anonymous>")&&(C=C.replace("<anonymous>",e.displayName)),C}while(1<=m&&0<=u);break}}}finally{C_=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?pd(e):""}function XA(e){switch(e.tag){case 5:return pd(e.type);case 16:return pd("Lazy");case 13:return pd("Suspense");case 19:return pd("SuspenseList");case 0:case 2:case 15:return e=k_(e.type,!1),e;case 11:return e=k_(e.type.render,!1),e;case 1:return e=k_(e.type,!0),e;default:return""}}function wv(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case rc:return"Fragment";case nc:return"Portal";case vv:return"Profiler";case Q0:return"StrictMode";case xv:return"Suspense";case bv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case oC:return(e.displayName||"Context")+".Consumer";case sC:return(e._context.displayName||"Context")+".Provider";case ex:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case tx:return t=e.displayName||null,t!==null?t:wv(e.type)||"Memo";case Pa:t=e._payload,e=e._init;try{return wv(e(t))}catch{}}return null}function KA(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wv(t);case 8:return t===Q0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ja(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function lC(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function YA(e){var t=lC(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var h=i.get,p=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return h.call(this)},set:function(m){a=""+m,p.call(this,m)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return a},setValue:function(m){a=""+m},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Dp(e){e._valueTracker||(e._valueTracker=YA(e))}function uC(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),a="";return e&&(a=lC(e)?e.checked?"true":"false":e.value),e=a,e!==i?(t.setValue(e),!0):!1}function Sm(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Sv(e,t){var i=t.checked;return zn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function Mw(e,t){var i=t.defaultValue==null?"":t.defaultValue,a=t.checked!=null?t.checked:t.defaultChecked;i=ja(t.value!=null?t.value:i),e._wrapperState={initialChecked:a,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function cC(e,t){t=t.checked,t!=null&&J0(e,"checked",t,!1)}function Tv(e,t){cC(e,t);var i=ja(t.value),a=t.type;if(i!=null)a==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Cv(e,t.type,i):t.hasOwnProperty("defaultValue")&&Cv(e,t.type,ja(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Aw(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!(a!=="submit"&&a!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function Cv(e,t,i){(t!=="number"||Sm(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var md=Array.isArray;function vc(e,t,i,a){if(e=e.options,t){t={};for(var h=0;h<i.length;h++)t["$"+i[h]]=!0;for(i=0;i<e.length;i++)h=t.hasOwnProperty("$"+e[i].value),e[i].selected!==h&&(e[i].selected=h),h&&a&&(e[i].defaultSelected=!0)}else{for(i=""+ja(i),t=null,h=0;h<e.length;h++){if(e[h].value===i){e[h].selected=!0,a&&(e[h].defaultSelected=!0);return}t!==null||e[h].disabled||(t=e[h])}t!==null&&(t.selected=!0)}}function kv(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ge(91));return zn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function zw(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(Ge(92));if(md(i)){if(1<i.length)throw Error(Ge(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:ja(i)}}function hC(e,t){var i=ja(t.value),a=ja(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),a!=null&&(e.defaultValue=""+a)}function Dw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function dC(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pv(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?dC(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Rp,fC=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,a,h){MSApp.execUnsafeLocalFunction(function(){return e(t,i,a,h)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Rp=Rp||document.createElement("div"),Rp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Rp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Bd(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var bd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},JA=["Webkit","ms","Moz","O"];Object.keys(bd).forEach(function(e){JA.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),bd[t]=bd[e]})});function pC(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||bd.hasOwnProperty(e)&&bd[e]?(""+t).trim():t+"px"}function mC(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var a=i.indexOf("--")===0,h=pC(i,t[i],a);i==="float"&&(i="cssFloat"),a?e.setProperty(i,h):e[i]=h}}var QA=zn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ev(e,t){if(t){if(QA[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ge(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ge(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ge(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ge(62))}}function Iv(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mv=null;function nx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Av=null,xc=null,bc=null;function Rw(e){if(e=pf(e)){if(typeof Av!="function")throw Error(Ge(280));var t=e.stateNode;t&&(t=ug(t),Av(e.stateNode,e.type,t))}}function gC(e){xc?bc?bc.push(e):bc=[e]:xc=e}function yC(){if(xc){var e=xc,t=bc;if(bc=xc=null,Rw(e),t)for(e=0;e<t.length;e++)Rw(t[e])}}function _C(e,t){return e(t)}function vC(){}var P_=!1;function xC(e,t,i){if(P_)return e(t,i);P_=!0;try{return _C(e,t,i)}finally{P_=!1,(xc!==null||bc!==null)&&(vC(),yC())}}function Od(e,t){var i=e.stateNode;if(i===null)return null;var a=ug(i);if(a===null)return null;i=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(Ge(231,t,typeof i));return i}var zv=!1;if(Ro)try{var rd={};Object.defineProperty(rd,"passive",{get:function(){zv=!0}}),window.addEventListener("test",rd,rd),window.removeEventListener("test",rd,rd)}catch{zv=!1}function ez(e,t,i,a,h,p,m,u,C){var E=Array.prototype.slice.call(arguments,3);try{t.apply(i,E)}catch(D){this.onError(D)}}var wd=!1,Tm=null,Cm=!1,Dv=null,tz={onError:function(e){wd=!0,Tm=e}};function nz(e,t,i,a,h,p,m,u,C){wd=!1,Tm=null,ez.apply(tz,arguments)}function rz(e,t,i,a,h,p,m,u,C){if(nz.apply(this,arguments),wd){if(wd){var E=Tm;wd=!1,Tm=null}else throw Error(Ge(198));Cm||(Cm=!0,Dv=E)}}function Jl(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function bC(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Lw(e){if(Jl(e)!==e)throw Error(Ge(188))}function iz(e){var t=e.alternate;if(!t){if(t=Jl(e),t===null)throw Error(Ge(188));return t!==e?null:e}for(var i=e,a=t;;){var h=i.return;if(h===null)break;var p=h.alternate;if(p===null){if(a=h.return,a!==null){i=a;continue}break}if(h.child===p.child){for(p=h.child;p;){if(p===i)return Lw(h),e;if(p===a)return Lw(h),t;p=p.sibling}throw Error(Ge(188))}if(i.return!==a.return)i=h,a=p;else{for(var m=!1,u=h.child;u;){if(u===i){m=!0,i=h,a=p;break}if(u===a){m=!0,a=h,i=p;break}u=u.sibling}if(!m){for(u=p.child;u;){if(u===i){m=!0,i=p,a=h;break}if(u===a){m=!0,a=p,i=h;break}u=u.sibling}if(!m)throw Error(Ge(189))}}if(i.alternate!==a)throw Error(Ge(190))}if(i.tag!==3)throw Error(Ge(188));return i.stateNode.current===i?e:t}function wC(e){return e=iz(e),e!==null?SC(e):null}function SC(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=SC(e);if(t!==null)return t;e=e.sibling}return null}var TC=qi.unstable_scheduleCallback,Fw=qi.unstable_cancelCallback,sz=qi.unstable_shouldYield,oz=qi.unstable_requestPaint,Un=qi.unstable_now,az=qi.unstable_getCurrentPriorityLevel,rx=qi.unstable_ImmediatePriority,CC=qi.unstable_UserBlockingPriority,km=qi.unstable_NormalPriority,lz=qi.unstable_LowPriority,kC=qi.unstable_IdlePriority,sg=null,eo=null;function uz(e){if(eo&&typeof eo.onCommitFiberRoot=="function")try{eo.onCommitFiberRoot(sg,e,void 0,(e.current.flags&128)===128)}catch{}}var Ds=Math.clz32?Math.clz32:dz,cz=Math.log,hz=Math.LN2;function dz(e){return e>>>=0,e===0?32:31-(cz(e)/hz|0)|0}var Lp=64,Fp=4194304;function gd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Pm(e,t){var i=e.pendingLanes;if(i===0)return 0;var a=0,h=e.suspendedLanes,p=e.pingedLanes,m=i&268435455;if(m!==0){var u=m&~h;u!==0?a=gd(u):(p&=m,p!==0&&(a=gd(p)))}else m=i&~h,m!==0?a=gd(m):p!==0&&(a=gd(p));if(a===0)return 0;if(t!==0&&t!==a&&!(t&h)&&(h=a&-a,p=t&-t,h>=p||h===16&&(p&4194240)!==0))return t;if(a&4&&(a|=i&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=a;0<t;)i=31-Ds(t),h=1<<i,a|=e[i],t&=~h;return a}function fz(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pz(e,t){for(var i=e.suspendedLanes,a=e.pingedLanes,h=e.expirationTimes,p=e.pendingLanes;0<p;){var m=31-Ds(p),u=1<<m,C=h[m];C===-1?(!(u&i)||u&a)&&(h[m]=fz(u,t)):C<=t&&(e.expiredLanes|=u),p&=~u}}function Rv(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function PC(){var e=Lp;return Lp<<=1,!(Lp&4194240)&&(Lp=64),e}function E_(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function df(e,t,i){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ds(t),e[t]=i}function mz(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<i;){var h=31-Ds(i),p=1<<h;t[h]=0,a[h]=-1,e[h]=-1,i&=~p}}function ix(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var a=31-Ds(i),h=1<<a;h&t|e[a]&t&&(e[a]|=t),i&=~h}}var on=0;function EC(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var IC,sx,MC,AC,zC,Lv=!1,Bp=[],Da=null,Ra=null,La=null,Vd=new Map,Nd=new Map,Ia=[],gz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bw(e,t){switch(e){case"focusin":case"focusout":Da=null;break;case"dragenter":case"dragleave":Ra=null;break;case"mouseover":case"mouseout":La=null;break;case"pointerover":case"pointerout":Vd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nd.delete(t.pointerId)}}function id(e,t,i,a,h,p){return e===null||e.nativeEvent!==p?(e={blockedOn:t,domEventName:i,eventSystemFlags:a,nativeEvent:p,targetContainers:[h]},t!==null&&(t=pf(t),t!==null&&sx(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,h!==null&&t.indexOf(h)===-1&&t.push(h),e)}function yz(e,t,i,a,h){switch(t){case"focusin":return Da=id(Da,e,t,i,a,h),!0;case"dragenter":return Ra=id(Ra,e,t,i,a,h),!0;case"mouseover":return La=id(La,e,t,i,a,h),!0;case"pointerover":var p=h.pointerId;return Vd.set(p,id(Vd.get(p)||null,e,t,i,a,h)),!0;case"gotpointercapture":return p=h.pointerId,Nd.set(p,id(Nd.get(p)||null,e,t,i,a,h)),!0}return!1}function DC(e){var t=zl(e.target);if(t!==null){var i=Jl(t);if(i!==null){if(t=i.tag,t===13){if(t=bC(i),t!==null){e.blockedOn=t,zC(e.priority,function(){MC(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function rm(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=Fv(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var a=new i.constructor(i.type,i);Mv=a,i.target.dispatchEvent(a),Mv=null}else return t=pf(i),t!==null&&sx(t),e.blockedOn=i,!1;t.shift()}return!0}function Ow(e,t,i){rm(e)&&i.delete(t)}function _z(){Lv=!1,Da!==null&&rm(Da)&&(Da=null),Ra!==null&&rm(Ra)&&(Ra=null),La!==null&&rm(La)&&(La=null),Vd.forEach(Ow),Nd.forEach(Ow)}function sd(e,t){e.blockedOn===t&&(e.blockedOn=null,Lv||(Lv=!0,qi.unstable_scheduleCallback(qi.unstable_NormalPriority,_z)))}function jd(e){function t(h){return sd(h,e)}if(0<Bp.length){sd(Bp[0],e);for(var i=1;i<Bp.length;i++){var a=Bp[i];a.blockedOn===e&&(a.blockedOn=null)}}for(Da!==null&&sd(Da,e),Ra!==null&&sd(Ra,e),La!==null&&sd(La,e),Vd.forEach(t),Nd.forEach(t),i=0;i<Ia.length;i++)a=Ia[i],a.blockedOn===e&&(a.blockedOn=null);for(;0<Ia.length&&(i=Ia[0],i.blockedOn===null);)DC(i),i.blockedOn===null&&Ia.shift()}var wc=jo.ReactCurrentBatchConfig,Em=!0;function vz(e,t,i,a){var h=on,p=wc.transition;wc.transition=null;try{on=1,ox(e,t,i,a)}finally{on=h,wc.transition=p}}function xz(e,t,i,a){var h=on,p=wc.transition;wc.transition=null;try{on=4,ox(e,t,i,a)}finally{on=h,wc.transition=p}}function ox(e,t,i,a){if(Em){var h=Fv(e,t,i,a);if(h===null)O_(e,t,a,Im,i),Bw(e,a);else if(yz(h,e,t,i,a))a.stopPropagation();else if(Bw(e,a),t&4&&-1<gz.indexOf(e)){for(;h!==null;){var p=pf(h);if(p!==null&&IC(p),p=Fv(e,t,i,a),p===null&&O_(e,t,a,Im,i),p===h)break;h=p}h!==null&&a.stopPropagation()}else O_(e,t,a,null,i)}}var Im=null;function Fv(e,t,i,a){if(Im=null,e=nx(a),e=zl(e),e!==null)if(t=Jl(e),t===null)e=null;else if(i=t.tag,i===13){if(e=bC(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Im=e,null}function RC(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(az()){case rx:return 1;case CC:return 4;case km:case lz:return 16;case kC:return 536870912;default:return 16}default:return 16}}var Aa=null,ax=null,im=null;function LC(){if(im)return im;var e,t=ax,i=t.length,a,h="value"in Aa?Aa.value:Aa.textContent,p=h.length;for(e=0;e<i&&t[e]===h[e];e++);var m=i-e;for(a=1;a<=m&&t[i-a]===h[p-a];a++);return im=h.slice(e,1<a?1-a:void 0)}function sm(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Op(){return!0}function Vw(){return!1}function Wi(e){function t(i,a,h,p,m){this._reactName=i,this._targetInst=h,this.type=a,this.nativeEvent=p,this.target=m,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(i=e[u],this[u]=i?i(p):p[u]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Op:Vw,this.isPropagationStopped=Vw,this}return zn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Op)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Op)},persist:function(){},isPersistent:Op}),t}var jc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lx=Wi(jc),ff=zn({},jc,{view:0,detail:0}),bz=Wi(ff),I_,M_,od,og=zn({},ff,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ux,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==od&&(od&&e.type==="mousemove"?(I_=e.screenX-od.screenX,M_=e.screenY-od.screenY):M_=I_=0,od=e),I_)},movementY:function(e){return"movementY"in e?e.movementY:M_}}),Nw=Wi(og),wz=zn({},og,{dataTransfer:0}),Sz=Wi(wz),Tz=zn({},ff,{relatedTarget:0}),A_=Wi(Tz),Cz=zn({},jc,{animationName:0,elapsedTime:0,pseudoElement:0}),kz=Wi(Cz),Pz=zn({},jc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ez=Wi(Pz),Iz=zn({},jc,{data:0}),jw=Wi(Iz),Mz={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Az={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zz={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dz(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=zz[e])?!!t[e]:!1}function ux(){return Dz}var Rz=zn({},ff,{key:function(e){if(e.key){var t=Mz[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=sm(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Az[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ux,charCode:function(e){return e.type==="keypress"?sm(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?sm(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Lz=Wi(Rz),Fz=zn({},og,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$w=Wi(Fz),Bz=zn({},ff,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ux}),Oz=Wi(Bz),Vz=zn({},jc,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nz=Wi(Vz),jz=zn({},og,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$z=Wi(jz),Uz=[9,13,27,32],cx=Ro&&"CompositionEvent"in window,Sd=null;Ro&&"documentMode"in document&&(Sd=document.documentMode);var Gz=Ro&&"TextEvent"in window&&!Sd,FC=Ro&&(!cx||Sd&&8<Sd&&11>=Sd),Uw=" ",Gw=!1;function BC(e,t){switch(e){case"keyup":return Uz.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function OC(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ic=!1;function qz(e,t){switch(e){case"compositionend":return OC(t);case"keypress":return t.which!==32?null:(Gw=!0,Uw);case"textInput":return e=t.data,e===Uw&&Gw?null:e;default:return null}}function Zz(e,t){if(ic)return e==="compositionend"||!cx&&BC(e,t)?(e=LC(),im=ax=Aa=null,ic=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return FC&&t.locale!=="ko"?null:t.data;default:return null}}var Wz={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Wz[e.type]:t==="textarea"}function VC(e,t,i,a){gC(a),t=Mm(t,"onChange"),0<t.length&&(i=new lx("onChange","change",null,i,a),e.push({event:i,listeners:t}))}var Td=null,$d=null;function Hz(e){KC(e,0)}function ag(e){var t=ac(e);if(uC(t))return e}function Xz(e,t){if(e==="change")return t}var NC=!1;if(Ro){var z_;if(Ro){var D_="oninput"in document;if(!D_){var Zw=document.createElement("div");Zw.setAttribute("oninput","return;"),D_=typeof Zw.oninput=="function"}z_=D_}else z_=!1;NC=z_&&(!document.documentMode||9<document.documentMode)}function Ww(){Td&&(Td.detachEvent("onpropertychange",jC),$d=Td=null)}function jC(e){if(e.propertyName==="value"&&ag($d)){var t=[];VC(t,$d,e,nx(e)),xC(Hz,t)}}function Kz(e,t,i){e==="focusin"?(Ww(),Td=t,$d=i,Td.attachEvent("onpropertychange",jC)):e==="focusout"&&Ww()}function Yz(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ag($d)}function Jz(e,t){if(e==="click")return ag(t)}function Qz(e,t){if(e==="input"||e==="change")return ag(t)}function eD(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ls=typeof Object.is=="function"?Object.is:eD;function Ud(e,t){if(Ls(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(a=0;a<i.length;a++){var h=i[a];if(!_v.call(t,h)||!Ls(e[h],t[h]))return!1}return!0}function Hw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xw(e,t){var i=Hw(e);e=0;for(var a;i;){if(i.nodeType===3){if(a=e+i.textContent.length,e<=t&&a>=t)return{node:i,offset:t-e};e=a}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Hw(i)}}function $C(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?$C(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function UC(){for(var e=window,t=Sm();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=Sm(e.document)}return t}function hx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function tD(e){var t=UC(),i=e.focusedElem,a=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&$C(i.ownerDocument.documentElement,i)){if(a!==null&&hx(i)){if(t=a.start,e=a.end,e===void 0&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if(e=(t=i.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var h=i.textContent.length,p=Math.min(a.start,h);a=a.end===void 0?p:Math.min(a.end,h),!e.extend&&p>a&&(h=a,a=p,p=h),h=Xw(i,p);var m=Xw(i,a);h&&m&&(e.rangeCount!==1||e.anchorNode!==h.node||e.anchorOffset!==h.offset||e.focusNode!==m.node||e.focusOffset!==m.offset)&&(t=t.createRange(),t.setStart(h.node,h.offset),e.removeAllRanges(),p>a?(e.addRange(t),e.extend(m.node,m.offset)):(t.setEnd(m.node,m.offset),e.addRange(t)))}}for(t=[],e=i;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<t.length;i++)e=t[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var nD=Ro&&"documentMode"in document&&11>=document.documentMode,sc=null,Bv=null,Cd=null,Ov=!1;function Kw(e,t,i){var a=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Ov||sc==null||sc!==Sm(a)||(a=sc,"selectionStart"in a&&hx(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Cd&&Ud(Cd,a)||(Cd=a,a=Mm(Bv,"onSelect"),0<a.length&&(t=new lx("onSelect","select",null,t,i),e.push({event:t,listeners:a}),t.target=sc)))}function Vp(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var oc={animationend:Vp("Animation","AnimationEnd"),animationiteration:Vp("Animation","AnimationIteration"),animationstart:Vp("Animation","AnimationStart"),transitionend:Vp("Transition","TransitionEnd")},R_={},GC={};Ro&&(GC=document.createElement("div").style,"AnimationEvent"in window||(delete oc.animationend.animation,delete oc.animationiteration.animation,delete oc.animationstart.animation),"TransitionEvent"in window||delete oc.transitionend.transition);function lg(e){if(R_[e])return R_[e];if(!oc[e])return e;var t=oc[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in GC)return R_[e]=t[i];return e}var qC=lg("animationend"),ZC=lg("animationiteration"),WC=lg("animationstart"),HC=lg("transitionend"),XC=new Map,Yw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Za(e,t){XC.set(e,t),Yl(t,[e])}for(var L_=0;L_<Yw.length;L_++){var F_=Yw[L_],rD=F_.toLowerCase(),iD=F_[0].toUpperCase()+F_.slice(1);Za(rD,"on"+iD)}Za(qC,"onAnimationEnd");Za(ZC,"onAnimationIteration");Za(WC,"onAnimationStart");Za("dblclick","onDoubleClick");Za("focusin","onFocus");Za("focusout","onBlur");Za(HC,"onTransitionEnd");Ec("onMouseEnter",["mouseout","mouseover"]);Ec("onMouseLeave",["mouseout","mouseover"]);Ec("onPointerEnter",["pointerout","pointerover"]);Ec("onPointerLeave",["pointerout","pointerover"]);Yl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Yl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Yl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Yl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Yl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Yl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sD=new Set("cancel close invalid load scroll toggle".split(" ").concat(yd));function Jw(e,t,i){var a=e.type||"unknown-event";e.currentTarget=i,rz(a,t,void 0,e),e.currentTarget=null}function KC(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var a=e[i],h=a.event;a=a.listeners;e:{var p=void 0;if(t)for(var m=a.length-1;0<=m;m--){var u=a[m],C=u.instance,E=u.currentTarget;if(u=u.listener,C!==p&&h.isPropagationStopped())break e;Jw(h,u,E),p=C}else for(m=0;m<a.length;m++){if(u=a[m],C=u.instance,E=u.currentTarget,u=u.listener,C!==p&&h.isPropagationStopped())break e;Jw(h,u,E),p=C}}}if(Cm)throw e=Dv,Cm=!1,Dv=null,e}function vn(e,t){var i=t[Uv];i===void 0&&(i=t[Uv]=new Set);var a=e+"__bubble";i.has(a)||(YC(t,e,2,!1),i.add(a))}function B_(e,t,i){var a=0;t&&(a|=4),YC(i,e,a,t)}var Np="_reactListening"+Math.random().toString(36).slice(2);function Gd(e){if(!e[Np]){e[Np]=!0,iC.forEach(function(i){i!=="selectionchange"&&(sD.has(i)||B_(i,!1,e),B_(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Np]||(t[Np]=!0,B_("selectionchange",!1,t))}}function YC(e,t,i,a){switch(RC(t)){case 1:var h=vz;break;case 4:h=xz;break;default:h=ox}i=h.bind(null,t,i,e),h=void 0,!zv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(h=!0),a?h!==void 0?e.addEventListener(t,i,{capture:!0,passive:h}):e.addEventListener(t,i,!0):h!==void 0?e.addEventListener(t,i,{passive:h}):e.addEventListener(t,i,!1)}function O_(e,t,i,a,h){var p=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var m=a.tag;if(m===3||m===4){var u=a.stateNode.containerInfo;if(u===h||u.nodeType===8&&u.parentNode===h)break;if(m===4)for(m=a.return;m!==null;){var C=m.tag;if((C===3||C===4)&&(C=m.stateNode.containerInfo,C===h||C.nodeType===8&&C.parentNode===h))return;m=m.return}for(;u!==null;){if(m=zl(u),m===null)return;if(C=m.tag,C===5||C===6){a=p=m;continue e}u=u.parentNode}}a=a.return}xC(function(){var E=p,D=nx(i),z=[];e:{var A=XC.get(e);if(A!==void 0){var Z=lx,Y=e;switch(e){case"keypress":if(sm(i)===0)break e;case"keydown":case"keyup":Z=Lz;break;case"focusin":Y="focus",Z=A_;break;case"focusout":Y="blur",Z=A_;break;case"beforeblur":case"afterblur":Z=A_;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=Nw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=Sz;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=Oz;break;case qC:case ZC:case WC:Z=kz;break;case HC:Z=Nz;break;case"scroll":Z=bz;break;case"wheel":Z=$z;break;case"copy":case"cut":case"paste":Z=Ez;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=$w}var te=(t&4)!==0,pe=!te&&e==="scroll",U=te?A!==null?A+"Capture":null:A;te=[];for(var G=E,X;G!==null;){X=G;var ae=X.stateNode;if(X.tag===5&&ae!==null&&(X=ae,U!==null&&(ae=Od(G,U),ae!=null&&te.push(qd(G,ae,X)))),pe)break;G=G.return}0<te.length&&(A=new Z(A,Y,null,i,D),z.push({event:A,listeners:te}))}}if(!(t&7)){e:{if(A=e==="mouseover"||e==="pointerover",Z=e==="mouseout"||e==="pointerout",A&&i!==Mv&&(Y=i.relatedTarget||i.fromElement)&&(zl(Y)||Y[Lo]))break e;if((Z||A)&&(A=D.window===D?D:(A=D.ownerDocument)?A.defaultView||A.parentWindow:window,Z?(Y=i.relatedTarget||i.toElement,Z=E,Y=Y?zl(Y):null,Y!==null&&(pe=Jl(Y),Y!==pe||Y.tag!==5&&Y.tag!==6)&&(Y=null)):(Z=null,Y=E),Z!==Y)){if(te=Nw,ae="onMouseLeave",U="onMouseEnter",G="mouse",(e==="pointerout"||e==="pointerover")&&(te=$w,ae="onPointerLeave",U="onPointerEnter",G="pointer"),pe=Z==null?A:ac(Z),X=Y==null?A:ac(Y),A=new te(ae,G+"leave",Z,i,D),A.target=pe,A.relatedTarget=X,ae=null,zl(D)===E&&(te=new te(U,G+"enter",Y,i,D),te.target=X,te.relatedTarget=pe,ae=te),pe=ae,Z&&Y)t:{for(te=Z,U=Y,G=0,X=te;X;X=Hu(X))G++;for(X=0,ae=U;ae;ae=Hu(ae))X++;for(;0<G-X;)te=Hu(te),G--;for(;0<X-G;)U=Hu(U),X--;for(;G--;){if(te===U||U!==null&&te===U.alternate)break t;te=Hu(te),U=Hu(U)}te=null}else te=null;Z!==null&&Qw(z,A,Z,te,!1),Y!==null&&pe!==null&&Qw(z,pe,Y,te,!0)}}e:{if(A=E?ac(E):window,Z=A.nodeName&&A.nodeName.toLowerCase(),Z==="select"||Z==="input"&&A.type==="file")var _e=Xz;else if(qw(A))if(NC)_e=Qz;else{_e=Yz;var ye=Kz}else(Z=A.nodeName)&&Z.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(_e=Jz);if(_e&&(_e=_e(e,E))){VC(z,_e,i,D);break e}ye&&ye(e,A,E),e==="focusout"&&(ye=A._wrapperState)&&ye.controlled&&A.type==="number"&&Cv(A,"number",A.value)}switch(ye=E?ac(E):window,e){case"focusin":(qw(ye)||ye.contentEditable==="true")&&(sc=ye,Bv=E,Cd=null);break;case"focusout":Cd=Bv=sc=null;break;case"mousedown":Ov=!0;break;case"contextmenu":case"mouseup":case"dragend":Ov=!1,Kw(z,i,D);break;case"selectionchange":if(nD)break;case"keydown":case"keyup":Kw(z,i,D)}var Se;if(cx)e:{switch(e){case"compositionstart":var Ie="onCompositionStart";break e;case"compositionend":Ie="onCompositionEnd";break e;case"compositionupdate":Ie="onCompositionUpdate";break e}Ie=void 0}else ic?BC(e,i)&&(Ie="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(Ie="onCompositionStart");Ie&&(FC&&i.locale!=="ko"&&(ic||Ie!=="onCompositionStart"?Ie==="onCompositionEnd"&&ic&&(Se=LC()):(Aa=D,ax="value"in Aa?Aa.value:Aa.textContent,ic=!0)),ye=Mm(E,Ie),0<ye.length&&(Ie=new jw(Ie,e,null,i,D),z.push({event:Ie,listeners:ye}),Se?Ie.data=Se:(Se=OC(i),Se!==null&&(Ie.data=Se)))),(Se=Gz?qz(e,i):Zz(e,i))&&(E=Mm(E,"onBeforeInput"),0<E.length&&(D=new jw("onBeforeInput","beforeinput",null,i,D),z.push({event:D,listeners:E}),D.data=Se))}KC(z,t)})}function qd(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Mm(e,t){for(var i=t+"Capture",a=[];e!==null;){var h=e,p=h.stateNode;h.tag===5&&p!==null&&(h=p,p=Od(e,i),p!=null&&a.unshift(qd(e,p,h)),p=Od(e,t),p!=null&&a.push(qd(e,p,h))),e=e.return}return a}function Hu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Qw(e,t,i,a,h){for(var p=t._reactName,m=[];i!==null&&i!==a;){var u=i,C=u.alternate,E=u.stateNode;if(C!==null&&C===a)break;u.tag===5&&E!==null&&(u=E,h?(C=Od(i,p),C!=null&&m.unshift(qd(i,C,u))):h||(C=Od(i,p),C!=null&&m.push(qd(i,C,u)))),i=i.return}m.length!==0&&e.push({event:t,listeners:m})}var oD=/\r\n?/g,aD=/\u0000|\uFFFD/g;function e2(e){return(typeof e=="string"?e:""+e).replace(oD,`
`).replace(aD,"")}function jp(e,t,i){if(t=e2(t),e2(e)!==t&&i)throw Error(Ge(425))}function Am(){}var Vv=null,Nv=null;function jv(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var $v=typeof setTimeout=="function"?setTimeout:void 0,lD=typeof clearTimeout=="function"?clearTimeout:void 0,t2=typeof Promise=="function"?Promise:void 0,uD=typeof queueMicrotask=="function"?queueMicrotask:typeof t2<"u"?function(e){return t2.resolve(null).then(e).catch(cD)}:$v;function cD(e){setTimeout(function(){throw e})}function V_(e,t){var i=t,a=0;do{var h=i.nextSibling;if(e.removeChild(i),h&&h.nodeType===8)if(i=h.data,i==="/$"){if(a===0){e.removeChild(h),jd(t);return}a--}else i!=="$"&&i!=="$?"&&i!=="$!"||a++;i=h}while(i);jd(t)}function Fa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function n2(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var $c=Math.random().toString(36).slice(2),Qs="__reactFiber$"+$c,Zd="__reactProps$"+$c,Lo="__reactContainer$"+$c,Uv="__reactEvents$"+$c,hD="__reactListeners$"+$c,dD="__reactHandles$"+$c;function zl(e){var t=e[Qs];if(t)return t;for(var i=e.parentNode;i;){if(t=i[Lo]||i[Qs]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=n2(e);e!==null;){if(i=e[Qs])return i;e=n2(e)}return t}e=i,i=e.parentNode}return null}function pf(e){return e=e[Qs]||e[Lo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ac(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ge(33))}function ug(e){return e[Zd]||null}var Gv=[],lc=-1;function Wa(e){return{current:e}}function xn(e){0>lc||(e.current=Gv[lc],Gv[lc]=null,lc--)}function gn(e,t){lc++,Gv[lc]=e.current,e.current=t}var $a={},Ur=Wa($a),xi=Wa(!1),ql=$a;function Ic(e,t){var i=e.type.contextTypes;if(!i)return $a;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var h={},p;for(p in i)h[p]=t[p];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=h),h}function bi(e){return e=e.childContextTypes,e!=null}function zm(){xn(xi),xn(Ur)}function r2(e,t,i){if(Ur.current!==$a)throw Error(Ge(168));gn(Ur,t),gn(xi,i)}function JC(e,t,i){var a=e.stateNode;if(t=t.childContextTypes,typeof a.getChildContext!="function")return i;a=a.getChildContext();for(var h in a)if(!(h in t))throw Error(Ge(108,KA(e)||"Unknown",h));return zn({},i,a)}function Dm(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||$a,ql=Ur.current,gn(Ur,e),gn(xi,xi.current),!0}function i2(e,t,i){var a=e.stateNode;if(!a)throw Error(Ge(169));i?(e=JC(e,t,ql),a.__reactInternalMemoizedMergedChildContext=e,xn(xi),xn(Ur),gn(Ur,e)):xn(xi),gn(xi,i)}var Io=null,cg=!1,N_=!1;function QC(e){Io===null?Io=[e]:Io.push(e)}function fD(e){cg=!0,QC(e)}function Ha(){if(!N_&&Io!==null){N_=!0;var e=0,t=on;try{var i=Io;for(on=1;e<i.length;e++){var a=i[e];do a=a(!0);while(a!==null)}Io=null,cg=!1}catch(h){throw Io!==null&&(Io=Io.slice(e+1)),TC(rx,Ha),h}finally{on=t,N_=!1}}return null}var uc=[],cc=0,Rm=null,Lm=0,us=[],cs=0,Zl=null,Ao=1,zo="";function Il(e,t){uc[cc++]=Lm,uc[cc++]=Rm,Rm=e,Lm=t}function ek(e,t,i){us[cs++]=Ao,us[cs++]=zo,us[cs++]=Zl,Zl=e;var a=Ao;e=zo;var h=32-Ds(a)-1;a&=~(1<<h),i+=1;var p=32-Ds(t)+h;if(30<p){var m=h-h%5;p=(a&(1<<m)-1).toString(32),a>>=m,h-=m,Ao=1<<32-Ds(t)+h|i<<h|a,zo=p+e}else Ao=1<<p|i<<h|a,zo=e}function dx(e){e.return!==null&&(Il(e,1),ek(e,1,0))}function fx(e){for(;e===Rm;)Rm=uc[--cc],uc[cc]=null,Lm=uc[--cc],uc[cc]=null;for(;e===Zl;)Zl=us[--cs],us[cs]=null,zo=us[--cs],us[cs]=null,Ao=us[--cs],us[cs]=null}var $i=null,ji=null,Cn=!1,zs=null;function tk(e,t){var i=ds(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)}function s2(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,$i=e,ji=Fa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,$i=e,ji=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(i=Zl!==null?{id:Ao,overflow:zo}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},i=ds(18,null,null,0),i.stateNode=t,i.return=e,e.child=i,$i=e,ji=null,!0):!1;default:return!1}}function qv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Zv(e){if(Cn){var t=ji;if(t){var i=t;if(!s2(e,t)){if(qv(e))throw Error(Ge(418));t=Fa(i.nextSibling);var a=$i;t&&s2(e,t)?tk(a,i):(e.flags=e.flags&-4097|2,Cn=!1,$i=e)}}else{if(qv(e))throw Error(Ge(418));e.flags=e.flags&-4097|2,Cn=!1,$i=e}}}function o2(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;$i=e}function $p(e){if(e!==$i)return!1;if(!Cn)return o2(e),Cn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!jv(e.type,e.memoizedProps)),t&&(t=ji)){if(qv(e))throw nk(),Error(Ge(418));for(;t;)tk(e,t),t=Fa(t.nextSibling)}if(o2(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ge(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){ji=Fa(e.nextSibling);break e}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}ji=null}}else ji=$i?Fa(e.stateNode.nextSibling):null;return!0}function nk(){for(var e=ji;e;)e=Fa(e.nextSibling)}function Mc(){ji=$i=null,Cn=!1}function px(e){zs===null?zs=[e]:zs.push(e)}var pD=jo.ReactCurrentBatchConfig;function ad(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(Ge(309));var a=i.stateNode}if(!a)throw Error(Ge(147,e));var h=a,p=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===p?t.ref:(t=function(m){var u=h.refs;m===null?delete u[p]:u[p]=m},t._stringRef=p,t)}if(typeof e!="string")throw Error(Ge(284));if(!i._owner)throw Error(Ge(290,e))}return e}function Up(e,t){throw e=Object.prototype.toString.call(t),Error(Ge(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function a2(e){var t=e._init;return t(e._payload)}function rk(e){function t(U,G){if(e){var X=U.deletions;X===null?(U.deletions=[G],U.flags|=16):X.push(G)}}function i(U,G){if(!e)return null;for(;G!==null;)t(U,G),G=G.sibling;return null}function a(U,G){for(U=new Map;G!==null;)G.key!==null?U.set(G.key,G):U.set(G.index,G),G=G.sibling;return U}function h(U,G){return U=Na(U,G),U.index=0,U.sibling=null,U}function p(U,G,X){return U.index=X,e?(X=U.alternate,X!==null?(X=X.index,X<G?(U.flags|=2,G):X):(U.flags|=2,G)):(U.flags|=1048576,G)}function m(U){return e&&U.alternate===null&&(U.flags|=2),U}function u(U,G,X,ae){return G===null||G.tag!==6?(G=W_(X,U.mode,ae),G.return=U,G):(G=h(G,X),G.return=U,G)}function C(U,G,X,ae){var _e=X.type;return _e===rc?D(U,G,X.props.children,ae,X.key):G!==null&&(G.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===Pa&&a2(_e)===G.type)?(ae=h(G,X.props),ae.ref=ad(U,G,X),ae.return=U,ae):(ae=dm(X.type,X.key,X.props,null,U.mode,ae),ae.ref=ad(U,G,X),ae.return=U,ae)}function E(U,G,X,ae){return G===null||G.tag!==4||G.stateNode.containerInfo!==X.containerInfo||G.stateNode.implementation!==X.implementation?(G=H_(X,U.mode,ae),G.return=U,G):(G=h(G,X.children||[]),G.return=U,G)}function D(U,G,X,ae,_e){return G===null||G.tag!==7?(G=jl(X,U.mode,ae,_e),G.return=U,G):(G=h(G,X),G.return=U,G)}function z(U,G,X){if(typeof G=="string"&&G!==""||typeof G=="number")return G=W_(""+G,U.mode,X),G.return=U,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case zp:return X=dm(G.type,G.key,G.props,null,U.mode,X),X.ref=ad(U,null,G),X.return=U,X;case nc:return G=H_(G,U.mode,X),G.return=U,G;case Pa:var ae=G._init;return z(U,ae(G._payload),X)}if(md(G)||nd(G))return G=jl(G,U.mode,X,null),G.return=U,G;Up(U,G)}return null}function A(U,G,X,ae){var _e=G!==null?G.key:null;if(typeof X=="string"&&X!==""||typeof X=="number")return _e!==null?null:u(U,G,""+X,ae);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case zp:return X.key===_e?C(U,G,X,ae):null;case nc:return X.key===_e?E(U,G,X,ae):null;case Pa:return _e=X._init,A(U,G,_e(X._payload),ae)}if(md(X)||nd(X))return _e!==null?null:D(U,G,X,ae,null);Up(U,X)}return null}function Z(U,G,X,ae,_e){if(typeof ae=="string"&&ae!==""||typeof ae=="number")return U=U.get(X)||null,u(G,U,""+ae,_e);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case zp:return U=U.get(ae.key===null?X:ae.key)||null,C(G,U,ae,_e);case nc:return U=U.get(ae.key===null?X:ae.key)||null,E(G,U,ae,_e);case Pa:var ye=ae._init;return Z(U,G,X,ye(ae._payload),_e)}if(md(ae)||nd(ae))return U=U.get(X)||null,D(G,U,ae,_e,null);Up(G,ae)}return null}function Y(U,G,X,ae){for(var _e=null,ye=null,Se=G,Ie=G=0,Be=null;Se!==null&&Ie<X.length;Ie++){Se.index>Ie?(Be=Se,Se=null):Be=Se.sibling;var Ue=A(U,Se,X[Ie],ae);if(Ue===null){Se===null&&(Se=Be);break}e&&Se&&Ue.alternate===null&&t(U,Se),G=p(Ue,G,Ie),ye===null?_e=Ue:ye.sibling=Ue,ye=Ue,Se=Be}if(Ie===X.length)return i(U,Se),Cn&&Il(U,Ie),_e;if(Se===null){for(;Ie<X.length;Ie++)Se=z(U,X[Ie],ae),Se!==null&&(G=p(Se,G,Ie),ye===null?_e=Se:ye.sibling=Se,ye=Se);return Cn&&Il(U,Ie),_e}for(Se=a(U,Se);Ie<X.length;Ie++)Be=Z(Se,U,Ie,X[Ie],ae),Be!==null&&(e&&Be.alternate!==null&&Se.delete(Be.key===null?Ie:Be.key),G=p(Be,G,Ie),ye===null?_e=Be:ye.sibling=Be,ye=Be);return e&&Se.forEach(function(Ne){return t(U,Ne)}),Cn&&Il(U,Ie),_e}function te(U,G,X,ae){var _e=nd(X);if(typeof _e!="function")throw Error(Ge(150));if(X=_e.call(X),X==null)throw Error(Ge(151));for(var ye=_e=null,Se=G,Ie=G=0,Be=null,Ue=X.next();Se!==null&&!Ue.done;Ie++,Ue=X.next()){Se.index>Ie?(Be=Se,Se=null):Be=Se.sibling;var Ne=A(U,Se,Ue.value,ae);if(Ne===null){Se===null&&(Se=Be);break}e&&Se&&Ne.alternate===null&&t(U,Se),G=p(Ne,G,Ie),ye===null?_e=Ne:ye.sibling=Ne,ye=Ne,Se=Be}if(Ue.done)return i(U,Se),Cn&&Il(U,Ie),_e;if(Se===null){for(;!Ue.done;Ie++,Ue=X.next())Ue=z(U,Ue.value,ae),Ue!==null&&(G=p(Ue,G,Ie),ye===null?_e=Ue:ye.sibling=Ue,ye=Ue);return Cn&&Il(U,Ie),_e}for(Se=a(U,Se);!Ue.done;Ie++,Ue=X.next())Ue=Z(Se,U,Ie,Ue.value,ae),Ue!==null&&(e&&Ue.alternate!==null&&Se.delete(Ue.key===null?Ie:Ue.key),G=p(Ue,G,Ie),ye===null?_e=Ue:ye.sibling=Ue,ye=Ue);return e&&Se.forEach(function(J){return t(U,J)}),Cn&&Il(U,Ie),_e}function pe(U,G,X,ae){if(typeof X=="object"&&X!==null&&X.type===rc&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case zp:e:{for(var _e=X.key,ye=G;ye!==null;){if(ye.key===_e){if(_e=X.type,_e===rc){if(ye.tag===7){i(U,ye.sibling),G=h(ye,X.props.children),G.return=U,U=G;break e}}else if(ye.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===Pa&&a2(_e)===ye.type){i(U,ye.sibling),G=h(ye,X.props),G.ref=ad(U,ye,X),G.return=U,U=G;break e}i(U,ye);break}else t(U,ye);ye=ye.sibling}X.type===rc?(G=jl(X.props.children,U.mode,ae,X.key),G.return=U,U=G):(ae=dm(X.type,X.key,X.props,null,U.mode,ae),ae.ref=ad(U,G,X),ae.return=U,U=ae)}return m(U);case nc:e:{for(ye=X.key;G!==null;){if(G.key===ye)if(G.tag===4&&G.stateNode.containerInfo===X.containerInfo&&G.stateNode.implementation===X.implementation){i(U,G.sibling),G=h(G,X.children||[]),G.return=U,U=G;break e}else{i(U,G);break}else t(U,G);G=G.sibling}G=H_(X,U.mode,ae),G.return=U,U=G}return m(U);case Pa:return ye=X._init,pe(U,G,ye(X._payload),ae)}if(md(X))return Y(U,G,X,ae);if(nd(X))return te(U,G,X,ae);Up(U,X)}return typeof X=="string"&&X!==""||typeof X=="number"?(X=""+X,G!==null&&G.tag===6?(i(U,G.sibling),G=h(G,X),G.return=U,U=G):(i(U,G),G=W_(X,U.mode,ae),G.return=U,U=G),m(U)):i(U,G)}return pe}var Ac=rk(!0),ik=rk(!1),Fm=Wa(null),Bm=null,hc=null,mx=null;function gx(){mx=hc=Bm=null}function yx(e){var t=Fm.current;xn(Fm),e._currentValue=t}function Wv(e,t,i){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===i)break;e=e.return}}function Sc(e,t){Bm=e,mx=hc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(_i=!0),e.firstContext=null)}function ms(e){var t=e._currentValue;if(mx!==e)if(e={context:e,memoizedValue:t,next:null},hc===null){if(Bm===null)throw Error(Ge(308));hc=e,Bm.dependencies={lanes:0,firstContext:e}}else hc=hc.next=e;return t}var Dl=null;function _x(e){Dl===null?Dl=[e]:Dl.push(e)}function sk(e,t,i,a){var h=t.interleaved;return h===null?(i.next=i,_x(t)):(i.next=h.next,h.next=i),t.interleaved=i,Fo(e,a)}function Fo(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}var Ea=!1;function vx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ok(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Do(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ba(e,t,i){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,Zt&2){var h=a.pending;return h===null?t.next=t:(t.next=h.next,h.next=t),a.pending=t,Fo(e,i)}return h=a.interleaved,h===null?(t.next=t,_x(a)):(t.next=h.next,h.next=t),a.interleaved=t,Fo(e,i)}function om(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194240)!==0)){var a=t.lanes;a&=e.pendingLanes,i|=a,t.lanes=i,ix(e,i)}}function l2(e,t){var i=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,i===a)){var h=null,p=null;if(i=i.firstBaseUpdate,i!==null){do{var m={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};p===null?h=p=m:p=p.next=m,i=i.next}while(i!==null);p===null?h=p=t:p=p.next=t}else h=p=t;i={baseState:a.baseState,firstBaseUpdate:h,lastBaseUpdate:p,shared:a.shared,effects:a.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Om(e,t,i,a){var h=e.updateQueue;Ea=!1;var p=h.firstBaseUpdate,m=h.lastBaseUpdate,u=h.shared.pending;if(u!==null){h.shared.pending=null;var C=u,E=C.next;C.next=null,m===null?p=E:m.next=E,m=C;var D=e.alternate;D!==null&&(D=D.updateQueue,u=D.lastBaseUpdate,u!==m&&(u===null?D.firstBaseUpdate=E:u.next=E,D.lastBaseUpdate=C))}if(p!==null){var z=h.baseState;m=0,D=E=C=null,u=p;do{var A=u.lane,Z=u.eventTime;if((a&A)===A){D!==null&&(D=D.next={eventTime:Z,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var Y=e,te=u;switch(A=t,Z=i,te.tag){case 1:if(Y=te.payload,typeof Y=="function"){z=Y.call(Z,z,A);break e}z=Y;break e;case 3:Y.flags=Y.flags&-65537|128;case 0:if(Y=te.payload,A=typeof Y=="function"?Y.call(Z,z,A):Y,A==null)break e;z=zn({},z,A);break e;case 2:Ea=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,A=h.effects,A===null?h.effects=[u]:A.push(u))}else Z={eventTime:Z,lane:A,tag:u.tag,payload:u.payload,callback:u.callback,next:null},D===null?(E=D=Z,C=z):D=D.next=Z,m|=A;if(u=u.next,u===null){if(u=h.shared.pending,u===null)break;A=u,u=A.next,A.next=null,h.lastBaseUpdate=A,h.shared.pending=null}}while(!0);if(D===null&&(C=z),h.baseState=C,h.firstBaseUpdate=E,h.lastBaseUpdate=D,t=h.shared.interleaved,t!==null){h=t;do m|=h.lane,h=h.next;while(h!==t)}else p===null&&(h.shared.lanes=0);Hl|=m,e.lanes=m,e.memoizedState=z}}function u2(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var a=e[t],h=a.callback;if(h!==null){if(a.callback=null,a=i,typeof h!="function")throw Error(Ge(191,h));h.call(a)}}}var mf={},to=Wa(mf),Wd=Wa(mf),Hd=Wa(mf);function Rl(e){if(e===mf)throw Error(Ge(174));return e}function xx(e,t){switch(gn(Hd,t),gn(Wd,e),gn(to,mf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Pv(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Pv(t,e)}xn(to),gn(to,t)}function zc(){xn(to),xn(Wd),xn(Hd)}function ak(e){Rl(Hd.current);var t=Rl(to.current),i=Pv(t,e.type);t!==i&&(gn(Wd,e),gn(to,i))}function bx(e){Wd.current===e&&(xn(to),xn(Wd))}var In=Wa(0);function Vm(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var j_=[];function wx(){for(var e=0;e<j_.length;e++)j_[e]._workInProgressVersionPrimary=null;j_.length=0}var am=jo.ReactCurrentDispatcher,$_=jo.ReactCurrentBatchConfig,Wl=0,An=null,nr=null,pr=null,Nm=!1,kd=!1,Xd=0,mD=0;function Br(){throw Error(Ge(321))}function Sx(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!Ls(e[i],t[i]))return!1;return!0}function Tx(e,t,i,a,h,p){if(Wl=p,An=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,am.current=e===null||e.memoizedState===null?vD:xD,e=i(a,h),kd){p=0;do{if(kd=!1,Xd=0,25<=p)throw Error(Ge(301));p+=1,pr=nr=null,t.updateQueue=null,am.current=bD,e=i(a,h)}while(kd)}if(am.current=jm,t=nr!==null&&nr.next!==null,Wl=0,pr=nr=An=null,Nm=!1,t)throw Error(Ge(300));return e}function Cx(){var e=Xd!==0;return Xd=0,e}function Xs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pr===null?An.memoizedState=pr=e:pr=pr.next=e,pr}function gs(){if(nr===null){var e=An.alternate;e=e!==null?e.memoizedState:null}else e=nr.next;var t=pr===null?An.memoizedState:pr.next;if(t!==null)pr=t,nr=e;else{if(e===null)throw Error(Ge(310));nr=e,e={memoizedState:nr.memoizedState,baseState:nr.baseState,baseQueue:nr.baseQueue,queue:nr.queue,next:null},pr===null?An.memoizedState=pr=e:pr=pr.next=e}return pr}function Kd(e,t){return typeof t=="function"?t(e):t}function U_(e){var t=gs(),i=t.queue;if(i===null)throw Error(Ge(311));i.lastRenderedReducer=e;var a=nr,h=a.baseQueue,p=i.pending;if(p!==null){if(h!==null){var m=h.next;h.next=p.next,p.next=m}a.baseQueue=h=p,i.pending=null}if(h!==null){p=h.next,a=a.baseState;var u=m=null,C=null,E=p;do{var D=E.lane;if((Wl&D)===D)C!==null&&(C=C.next={lane:0,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null}),a=E.hasEagerState?E.eagerState:e(a,E.action);else{var z={lane:D,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null};C===null?(u=C=z,m=a):C=C.next=z,An.lanes|=D,Hl|=D}E=E.next}while(E!==null&&E!==p);C===null?m=a:C.next=u,Ls(a,t.memoizedState)||(_i=!0),t.memoizedState=a,t.baseState=m,t.baseQueue=C,i.lastRenderedState=a}if(e=i.interleaved,e!==null){h=e;do p=h.lane,An.lanes|=p,Hl|=p,h=h.next;while(h!==e)}else h===null&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function G_(e){var t=gs(),i=t.queue;if(i===null)throw Error(Ge(311));i.lastRenderedReducer=e;var a=i.dispatch,h=i.pending,p=t.memoizedState;if(h!==null){i.pending=null;var m=h=h.next;do p=e(p,m.action),m=m.next;while(m!==h);Ls(p,t.memoizedState)||(_i=!0),t.memoizedState=p,t.baseQueue===null&&(t.baseState=p),i.lastRenderedState=p}return[p,a]}function lk(){}function uk(e,t){var i=An,a=gs(),h=t(),p=!Ls(a.memoizedState,h);if(p&&(a.memoizedState=h,_i=!0),a=a.queue,kx(dk.bind(null,i,a,e),[e]),a.getSnapshot!==t||p||pr!==null&&pr.memoizedState.tag&1){if(i.flags|=2048,Yd(9,hk.bind(null,i,a,h,t),void 0,null),mr===null)throw Error(Ge(349));Wl&30||ck(i,t,h)}return h}function ck(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=An.updateQueue,t===null?(t={lastEffect:null,stores:null},An.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function hk(e,t,i,a){t.value=i,t.getSnapshot=a,fk(t)&&pk(e)}function dk(e,t,i){return i(function(){fk(t)&&pk(e)})}function fk(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!Ls(e,i)}catch{return!0}}function pk(e){var t=Fo(e,1);t!==null&&Rs(t,e,1,-1)}function c2(e){var t=Xs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kd,lastRenderedState:e},t.queue=e,e=e.dispatch=_D.bind(null,An,e),[t.memoizedState,e]}function Yd(e,t,i,a){return e={tag:e,create:t,destroy:i,deps:a,next:null},t=An.updateQueue,t===null?(t={lastEffect:null,stores:null},An.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(a=i.next,i.next=e,e.next=a,t.lastEffect=e)),e}function mk(){return gs().memoizedState}function lm(e,t,i,a){var h=Xs();An.flags|=e,h.memoizedState=Yd(1|t,i,void 0,a===void 0?null:a)}function hg(e,t,i,a){var h=gs();a=a===void 0?null:a;var p=void 0;if(nr!==null){var m=nr.memoizedState;if(p=m.destroy,a!==null&&Sx(a,m.deps)){h.memoizedState=Yd(t,i,p,a);return}}An.flags|=e,h.memoizedState=Yd(1|t,i,p,a)}function h2(e,t){return lm(8390656,8,e,t)}function kx(e,t){return hg(2048,8,e,t)}function gk(e,t){return hg(4,2,e,t)}function yk(e,t){return hg(4,4,e,t)}function _k(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function vk(e,t,i){return i=i!=null?i.concat([e]):null,hg(4,4,_k.bind(null,t,e),i)}function Px(){}function xk(e,t){var i=gs();t=t===void 0?null:t;var a=i.memoizedState;return a!==null&&t!==null&&Sx(t,a[1])?a[0]:(i.memoizedState=[e,t],e)}function bk(e,t){var i=gs();t=t===void 0?null:t;var a=i.memoizedState;return a!==null&&t!==null&&Sx(t,a[1])?a[0]:(e=e(),i.memoizedState=[e,t],e)}function wk(e,t,i){return Wl&21?(Ls(i,t)||(i=PC(),An.lanes|=i,Hl|=i,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,_i=!0),e.memoizedState=i)}function gD(e,t){var i=on;on=i!==0&&4>i?i:4,e(!0);var a=$_.transition;$_.transition={};try{e(!1),t()}finally{on=i,$_.transition=a}}function Sk(){return gs().memoizedState}function yD(e,t,i){var a=Va(e);if(i={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null},Tk(e))Ck(t,i);else if(i=sk(e,t,i,a),i!==null){var h=ni();Rs(i,e,a,h),kk(i,t,a)}}function _D(e,t,i){var a=Va(e),h={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null};if(Tk(e))Ck(t,h);else{var p=e.alternate;if(e.lanes===0&&(p===null||p.lanes===0)&&(p=t.lastRenderedReducer,p!==null))try{var m=t.lastRenderedState,u=p(m,i);if(h.hasEagerState=!0,h.eagerState=u,Ls(u,m)){var C=t.interleaved;C===null?(h.next=h,_x(t)):(h.next=C.next,C.next=h),t.interleaved=h;return}}catch{}finally{}i=sk(e,t,h,a),i!==null&&(h=ni(),Rs(i,e,a,h),kk(i,t,a))}}function Tk(e){var t=e.alternate;return e===An||t!==null&&t===An}function Ck(e,t){kd=Nm=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function kk(e,t,i){if(i&4194240){var a=t.lanes;a&=e.pendingLanes,i|=a,t.lanes=i,ix(e,i)}}var jm={readContext:ms,useCallback:Br,useContext:Br,useEffect:Br,useImperativeHandle:Br,useInsertionEffect:Br,useLayoutEffect:Br,useMemo:Br,useReducer:Br,useRef:Br,useState:Br,useDebugValue:Br,useDeferredValue:Br,useTransition:Br,useMutableSource:Br,useSyncExternalStore:Br,useId:Br,unstable_isNewReconciler:!1},vD={readContext:ms,useCallback:function(e,t){return Xs().memoizedState=[e,t===void 0?null:t],e},useContext:ms,useEffect:h2,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,lm(4194308,4,_k.bind(null,t,e),i)},useLayoutEffect:function(e,t){return lm(4194308,4,e,t)},useInsertionEffect:function(e,t){return lm(4,2,e,t)},useMemo:function(e,t){var i=Xs();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var a=Xs();return t=i!==void 0?i(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=yD.bind(null,An,e),[a.memoizedState,e]},useRef:function(e){var t=Xs();return e={current:e},t.memoizedState=e},useState:c2,useDebugValue:Px,useDeferredValue:function(e){return Xs().memoizedState=e},useTransition:function(){var e=c2(!1),t=e[0];return e=gD.bind(null,e[1]),Xs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var a=An,h=Xs();if(Cn){if(i===void 0)throw Error(Ge(407));i=i()}else{if(i=t(),mr===null)throw Error(Ge(349));Wl&30||ck(a,t,i)}h.memoizedState=i;var p={value:i,getSnapshot:t};return h.queue=p,h2(dk.bind(null,a,p,e),[e]),a.flags|=2048,Yd(9,hk.bind(null,a,p,i,t),void 0,null),i},useId:function(){var e=Xs(),t=mr.identifierPrefix;if(Cn){var i=zo,a=Ao;i=(a&~(1<<32-Ds(a)-1)).toString(32)+i,t=":"+t+"R"+i,i=Xd++,0<i&&(t+="H"+i.toString(32)),t+=":"}else i=mD++,t=":"+t+"r"+i.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},xD={readContext:ms,useCallback:xk,useContext:ms,useEffect:kx,useImperativeHandle:vk,useInsertionEffect:gk,useLayoutEffect:yk,useMemo:bk,useReducer:U_,useRef:mk,useState:function(){return U_(Kd)},useDebugValue:Px,useDeferredValue:function(e){var t=gs();return wk(t,nr.memoizedState,e)},useTransition:function(){var e=U_(Kd)[0],t=gs().memoizedState;return[e,t]},useMutableSource:lk,useSyncExternalStore:uk,useId:Sk,unstable_isNewReconciler:!1},bD={readContext:ms,useCallback:xk,useContext:ms,useEffect:kx,useImperativeHandle:vk,useInsertionEffect:gk,useLayoutEffect:yk,useMemo:bk,useReducer:G_,useRef:mk,useState:function(){return G_(Kd)},useDebugValue:Px,useDeferredValue:function(e){var t=gs();return nr===null?t.memoizedState=e:wk(t,nr.memoizedState,e)},useTransition:function(){var e=G_(Kd)[0],t=gs().memoizedState;return[e,t]},useMutableSource:lk,useSyncExternalStore:uk,useId:Sk,unstable_isNewReconciler:!1};function Ms(e,t){if(e&&e.defaultProps){t=zn({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}function Hv(e,t,i,a){t=e.memoizedState,i=i(a,t),i=i==null?t:zn({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var dg={isMounted:function(e){return(e=e._reactInternals)?Jl(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var a=ni(),h=Va(e),p=Do(a,h);p.payload=t,i!=null&&(p.callback=i),t=Ba(e,p,h),t!==null&&(Rs(t,e,h,a),om(t,e,h))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var a=ni(),h=Va(e),p=Do(a,h);p.tag=1,p.payload=t,i!=null&&(p.callback=i),t=Ba(e,p,h),t!==null&&(Rs(t,e,h,a),om(t,e,h))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=ni(),a=Va(e),h=Do(i,a);h.tag=2,t!=null&&(h.callback=t),t=Ba(e,h,a),t!==null&&(Rs(t,e,a,i),om(t,e,a))}};function d2(e,t,i,a,h,p,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,p,m):t.prototype&&t.prototype.isPureReactComponent?!Ud(i,a)||!Ud(h,p):!0}function Pk(e,t,i){var a=!1,h=$a,p=t.contextType;return typeof p=="object"&&p!==null?p=ms(p):(h=bi(t)?ql:Ur.current,a=t.contextTypes,p=(a=a!=null)?Ic(e,h):$a),t=new t(i,p),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=dg,e.stateNode=t,t._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=h,e.__reactInternalMemoizedMaskedChildContext=p),t}function f2(e,t,i,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,a),t.state!==e&&dg.enqueueReplaceState(t,t.state,null)}function Xv(e,t,i,a){var h=e.stateNode;h.props=i,h.state=e.memoizedState,h.refs={},vx(e);var p=t.contextType;typeof p=="object"&&p!==null?h.context=ms(p):(p=bi(t)?ql:Ur.current,h.context=Ic(e,p)),h.state=e.memoizedState,p=t.getDerivedStateFromProps,typeof p=="function"&&(Hv(e,t,p,i),h.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(t=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),t!==h.state&&dg.enqueueReplaceState(h,h.state,null),Om(e,i,h,a),h.state=e.memoizedState),typeof h.componentDidMount=="function"&&(e.flags|=4194308)}function Dc(e,t){try{var i="",a=t;do i+=XA(a),a=a.return;while(a);var h=i}catch(p){h=`
Error generating stack: `+p.message+`
`+p.stack}return{value:e,source:t,stack:h,digest:null}}function q_(e,t,i){return{value:e,source:null,stack:i??null,digest:t??null}}function Kv(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var wD=typeof WeakMap=="function"?WeakMap:Map;function Ek(e,t,i){i=Do(-1,i),i.tag=3,i.payload={element:null};var a=t.value;return i.callback=function(){Um||(Um=!0,o0=a),Kv(e,t)},i}function Ik(e,t,i){i=Do(-1,i),i.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var h=t.value;i.payload=function(){return a(h)},i.callback=function(){Kv(e,t)}}var p=e.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(i.callback=function(){Kv(e,t),typeof a!="function"&&(Oa===null?Oa=new Set([this]):Oa.add(this));var m=t.stack;this.componentDidCatch(t.value,{componentStack:m!==null?m:""})}),i}function p2(e,t,i){var a=e.pingCache;if(a===null){a=e.pingCache=new wD;var h=new Set;a.set(t,h)}else h=a.get(t),h===void 0&&(h=new Set,a.set(t,h));h.has(i)||(h.add(i),e=FD.bind(null,e,t,i),t.then(e,e))}function m2(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function g2(e,t,i,a,h){return e.mode&1?(e.flags|=65536,e.lanes=h,e):(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(t=Do(-1,1),t.tag=2,Ba(i,t,1))),i.lanes|=1),e)}var SD=jo.ReactCurrentOwner,_i=!1;function ei(e,t,i,a){t.child=e===null?ik(t,null,i,a):Ac(t,e.child,i,a)}function y2(e,t,i,a,h){i=i.render;var p=t.ref;return Sc(t,h),a=Tx(e,t,i,a,p,h),i=Cx(),e!==null&&!_i?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~h,Bo(e,t,h)):(Cn&&i&&dx(t),t.flags|=1,ei(e,t,a,h),t.child)}function _2(e,t,i,a,h){if(e===null){var p=i.type;return typeof p=="function"&&!Lx(p)&&p.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=p,Mk(e,t,p,a,h)):(e=dm(i.type,null,a,t,t.mode,h),e.ref=t.ref,e.return=t,t.child=e)}if(p=e.child,!(e.lanes&h)){var m=p.memoizedProps;if(i=i.compare,i=i!==null?i:Ud,i(m,a)&&e.ref===t.ref)return Bo(e,t,h)}return t.flags|=1,e=Na(p,a),e.ref=t.ref,e.return=t,t.child=e}function Mk(e,t,i,a,h){if(e!==null){var p=e.memoizedProps;if(Ud(p,a)&&e.ref===t.ref)if(_i=!1,t.pendingProps=a=p,(e.lanes&h)!==0)e.flags&131072&&(_i=!0);else return t.lanes=e.lanes,Bo(e,t,h)}return Yv(e,t,i,a,h)}function Ak(e,t,i){var a=t.pendingProps,h=a.children,p=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},gn(fc,Vi),Vi|=i;else{if(!(i&1073741824))return e=p!==null?p.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,gn(fc,Vi),Vi|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=p!==null?p.baseLanes:i,gn(fc,Vi),Vi|=a}else p!==null?(a=p.baseLanes|i,t.memoizedState=null):a=i,gn(fc,Vi),Vi|=a;return ei(e,t,h,i),t.child}function zk(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function Yv(e,t,i,a,h){var p=bi(i)?ql:Ur.current;return p=Ic(t,p),Sc(t,h),i=Tx(e,t,i,a,p,h),a=Cx(),e!==null&&!_i?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~h,Bo(e,t,h)):(Cn&&a&&dx(t),t.flags|=1,ei(e,t,i,h),t.child)}function v2(e,t,i,a,h){if(bi(i)){var p=!0;Dm(t)}else p=!1;if(Sc(t,h),t.stateNode===null)um(e,t),Pk(t,i,a),Xv(t,i,a,h),a=!0;else if(e===null){var m=t.stateNode,u=t.memoizedProps;m.props=u;var C=m.context,E=i.contextType;typeof E=="object"&&E!==null?E=ms(E):(E=bi(i)?ql:Ur.current,E=Ic(t,E));var D=i.getDerivedStateFromProps,z=typeof D=="function"||typeof m.getSnapshotBeforeUpdate=="function";z||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(u!==a||C!==E)&&f2(t,m,a,E),Ea=!1;var A=t.memoizedState;m.state=A,Om(t,a,m,h),C=t.memoizedState,u!==a||A!==C||xi.current||Ea?(typeof D=="function"&&(Hv(t,i,D,a),C=t.memoizedState),(u=Ea||d2(t,i,u,a,A,C,E))?(z||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(t.flags|=4194308)):(typeof m.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=C),m.props=a,m.state=C,m.context=E,a=u):(typeof m.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{m=t.stateNode,ok(e,t),u=t.memoizedProps,E=t.type===t.elementType?u:Ms(t.type,u),m.props=E,z=t.pendingProps,A=m.context,C=i.contextType,typeof C=="object"&&C!==null?C=ms(C):(C=bi(i)?ql:Ur.current,C=Ic(t,C));var Z=i.getDerivedStateFromProps;(D=typeof Z=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(u!==z||A!==C)&&f2(t,m,a,C),Ea=!1,A=t.memoizedState,m.state=A,Om(t,a,m,h);var Y=t.memoizedState;u!==z||A!==Y||xi.current||Ea?(typeof Z=="function"&&(Hv(t,i,Z,a),Y=t.memoizedState),(E=Ea||d2(t,i,E,a,A,Y,C)||!1)?(D||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(a,Y,C),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(a,Y,C)),typeof m.componentDidUpdate=="function"&&(t.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof m.componentDidUpdate!="function"||u===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=Y),m.props=a,m.state=Y,m.context=C,a=E):(typeof m.componentDidUpdate!="function"||u===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),a=!1)}return Jv(e,t,i,a,p,h)}function Jv(e,t,i,a,h,p){zk(e,t);var m=(t.flags&128)!==0;if(!a&&!m)return h&&i2(t,i,!1),Bo(e,t,p);a=t.stateNode,SD.current=t;var u=m&&typeof i.getDerivedStateFromError!="function"?null:a.render();return t.flags|=1,e!==null&&m?(t.child=Ac(t,e.child,null,p),t.child=Ac(t,null,u,p)):ei(e,t,u,p),t.memoizedState=a.state,h&&i2(t,i,!0),t.child}function Dk(e){var t=e.stateNode;t.pendingContext?r2(e,t.pendingContext,t.pendingContext!==t.context):t.context&&r2(e,t.context,!1),xx(e,t.containerInfo)}function x2(e,t,i,a,h){return Mc(),px(h),t.flags|=256,ei(e,t,i,a),t.child}var Qv={dehydrated:null,treeContext:null,retryLane:0};function e0(e){return{baseLanes:e,cachePool:null,transitions:null}}function Rk(e,t,i){var a=t.pendingProps,h=In.current,p=!1,m=(t.flags&128)!==0,u;if((u=m)||(u=e!==null&&e.memoizedState===null?!1:(h&2)!==0),u?(p=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(h|=1),gn(In,h&1),e===null)return Zv(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(m=a.children,e=a.fallback,p?(a=t.mode,p=t.child,m={mode:"hidden",children:m},!(a&1)&&p!==null?(p.childLanes=0,p.pendingProps=m):p=mg(m,a,0,null),e=jl(e,a,i,null),p.return=t,e.return=t,p.sibling=e,t.child=p,t.child.memoizedState=e0(i),t.memoizedState=Qv,e):Ex(t,m));if(h=e.memoizedState,h!==null&&(u=h.dehydrated,u!==null))return TD(e,t,m,a,u,h,i);if(p){p=a.fallback,m=t.mode,h=e.child,u=h.sibling;var C={mode:"hidden",children:a.children};return!(m&1)&&t.child!==h?(a=t.child,a.childLanes=0,a.pendingProps=C,t.deletions=null):(a=Na(h,C),a.subtreeFlags=h.subtreeFlags&14680064),u!==null?p=Na(u,p):(p=jl(p,m,i,null),p.flags|=2),p.return=t,a.return=t,a.sibling=p,t.child=a,a=p,p=t.child,m=e.child.memoizedState,m=m===null?e0(i):{baseLanes:m.baseLanes|i,cachePool:null,transitions:m.transitions},p.memoizedState=m,p.childLanes=e.childLanes&~i,t.memoizedState=Qv,a}return p=e.child,e=p.sibling,a=Na(p,{mode:"visible",children:a.children}),!(t.mode&1)&&(a.lanes=i),a.return=t,a.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=a,t.memoizedState=null,a}function Ex(e,t){return t=mg({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Gp(e,t,i,a){return a!==null&&px(a),Ac(t,e.child,null,i),e=Ex(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function TD(e,t,i,a,h,p,m){if(i)return t.flags&256?(t.flags&=-257,a=q_(Error(Ge(422))),Gp(e,t,m,a)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(p=a.fallback,h=t.mode,a=mg({mode:"visible",children:a.children},h,0,null),p=jl(p,h,m,null),p.flags|=2,a.return=t,p.return=t,a.sibling=p,t.child=a,t.mode&1&&Ac(t,e.child,null,m),t.child.memoizedState=e0(m),t.memoizedState=Qv,p);if(!(t.mode&1))return Gp(e,t,m,null);if(h.data==="$!"){if(a=h.nextSibling&&h.nextSibling.dataset,a)var u=a.dgst;return a=u,p=Error(Ge(419)),a=q_(p,a,void 0),Gp(e,t,m,a)}if(u=(m&e.childLanes)!==0,_i||u){if(a=mr,a!==null){switch(m&-m){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=h&(a.suspendedLanes|m)?0:h,h!==0&&h!==p.retryLane&&(p.retryLane=h,Fo(e,h),Rs(a,e,h,-1))}return Rx(),a=q_(Error(Ge(421))),Gp(e,t,m,a)}return h.data==="$?"?(t.flags|=128,t.child=e.child,t=BD.bind(null,e),h._reactRetry=t,null):(e=p.treeContext,ji=Fa(h.nextSibling),$i=t,Cn=!0,zs=null,e!==null&&(us[cs++]=Ao,us[cs++]=zo,us[cs++]=Zl,Ao=e.id,zo=e.overflow,Zl=t),t=Ex(t,a.children),t.flags|=4096,t)}function b2(e,t,i){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),Wv(e.return,t,i)}function Z_(e,t,i,a,h){var p=e.memoizedState;p===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:i,tailMode:h}:(p.isBackwards=t,p.rendering=null,p.renderingStartTime=0,p.last=a,p.tail=i,p.tailMode=h)}function Lk(e,t,i){var a=t.pendingProps,h=a.revealOrder,p=a.tail;if(ei(e,t,a.children,i),a=In.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&b2(e,i,t);else if(e.tag===19)b2(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(gn(In,a),!(t.mode&1))t.memoizedState=null;else switch(h){case"forwards":for(i=t.child,h=null;i!==null;)e=i.alternate,e!==null&&Vm(e)===null&&(h=i),i=i.sibling;i=h,i===null?(h=t.child,t.child=null):(h=i.sibling,i.sibling=null),Z_(t,!1,h,i,p);break;case"backwards":for(i=null,h=t.child,t.child=null;h!==null;){if(e=h.alternate,e!==null&&Vm(e)===null){t.child=h;break}e=h.sibling,h.sibling=i,i=h,h=e}Z_(t,!0,i,null,p);break;case"together":Z_(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function um(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Bo(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),Hl|=t.lanes,!(i&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ge(153));if(t.child!==null){for(e=t.child,i=Na(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=Na(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function CD(e,t,i){switch(t.tag){case 3:Dk(t),Mc();break;case 5:ak(t);break;case 1:bi(t.type)&&Dm(t);break;case 4:xx(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,h=t.memoizedProps.value;gn(Fm,a._currentValue),a._currentValue=h;break;case 13:if(a=t.memoizedState,a!==null)return a.dehydrated!==null?(gn(In,In.current&1),t.flags|=128,null):i&t.child.childLanes?Rk(e,t,i):(gn(In,In.current&1),e=Bo(e,t,i),e!==null?e.sibling:null);gn(In,In.current&1);break;case 19:if(a=(i&t.childLanes)!==0,e.flags&128){if(a)return Lk(e,t,i);t.flags|=128}if(h=t.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),gn(In,In.current),a)break;return null;case 22:case 23:return t.lanes=0,Ak(e,t,i)}return Bo(e,t,i)}var Fk,t0,Bk,Ok;Fk=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};t0=function(){};Bk=function(e,t,i,a){var h=e.memoizedProps;if(h!==a){e=t.stateNode,Rl(to.current);var p=null;switch(i){case"input":h=Sv(e,h),a=Sv(e,a),p=[];break;case"select":h=zn({},h,{value:void 0}),a=zn({},a,{value:void 0}),p=[];break;case"textarea":h=kv(e,h),a=kv(e,a),p=[];break;default:typeof h.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=Am)}Ev(i,a);var m;i=null;for(E in h)if(!a.hasOwnProperty(E)&&h.hasOwnProperty(E)&&h[E]!=null)if(E==="style"){var u=h[E];for(m in u)u.hasOwnProperty(m)&&(i||(i={}),i[m]="")}else E!=="dangerouslySetInnerHTML"&&E!=="children"&&E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(Fd.hasOwnProperty(E)?p||(p=[]):(p=p||[]).push(E,null));for(E in a){var C=a[E];if(u=h!=null?h[E]:void 0,a.hasOwnProperty(E)&&C!==u&&(C!=null||u!=null))if(E==="style")if(u){for(m in u)!u.hasOwnProperty(m)||C&&C.hasOwnProperty(m)||(i||(i={}),i[m]="");for(m in C)C.hasOwnProperty(m)&&u[m]!==C[m]&&(i||(i={}),i[m]=C[m])}else i||(p||(p=[]),p.push(E,i)),i=C;else E==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,u=u?u.__html:void 0,C!=null&&u!==C&&(p=p||[]).push(E,C)):E==="children"?typeof C!="string"&&typeof C!="number"||(p=p||[]).push(E,""+C):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&(Fd.hasOwnProperty(E)?(C!=null&&E==="onScroll"&&vn("scroll",e),p||u===C||(p=[])):(p=p||[]).push(E,C))}i&&(p=p||[]).push("style",i);var E=p;(t.updateQueue=E)&&(t.flags|=4)}};Ok=function(e,t,i,a){i!==a&&(t.flags|=4)};function ld(e,t){if(!Cn)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Or(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,a=0;if(t)for(var h=e.child;h!==null;)i|=h.lanes|h.childLanes,a|=h.subtreeFlags&14680064,a|=h.flags&14680064,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)i|=h.lanes|h.childLanes,a|=h.subtreeFlags,a|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=a,e.childLanes=i,t}function kD(e,t,i){var a=t.pendingProps;switch(fx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Or(t),null;case 1:return bi(t.type)&&zm(),Or(t),null;case 3:return a=t.stateNode,zc(),xn(xi),xn(Ur),wx(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&($p(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,zs!==null&&(u0(zs),zs=null))),t0(e,t),Or(t),null;case 5:bx(t);var h=Rl(Hd.current);if(i=t.type,e!==null&&t.stateNode!=null)Bk(e,t,i,a,h),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(t.stateNode===null)throw Error(Ge(166));return Or(t),null}if(e=Rl(to.current),$p(t)){a=t.stateNode,i=t.type;var p=t.memoizedProps;switch(a[Qs]=t,a[Zd]=p,e=(t.mode&1)!==0,i){case"dialog":vn("cancel",a),vn("close",a);break;case"iframe":case"object":case"embed":vn("load",a);break;case"video":case"audio":for(h=0;h<yd.length;h++)vn(yd[h],a);break;case"source":vn("error",a);break;case"img":case"image":case"link":vn("error",a),vn("load",a);break;case"details":vn("toggle",a);break;case"input":Mw(a,p),vn("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!p.multiple},vn("invalid",a);break;case"textarea":zw(a,p),vn("invalid",a)}Ev(i,p),h=null;for(var m in p)if(p.hasOwnProperty(m)){var u=p[m];m==="children"?typeof u=="string"?a.textContent!==u&&(p.suppressHydrationWarning!==!0&&jp(a.textContent,u,e),h=["children",u]):typeof u=="number"&&a.textContent!==""+u&&(p.suppressHydrationWarning!==!0&&jp(a.textContent,u,e),h=["children",""+u]):Fd.hasOwnProperty(m)&&u!=null&&m==="onScroll"&&vn("scroll",a)}switch(i){case"input":Dp(a),Aw(a,p,!0);break;case"textarea":Dp(a),Dw(a);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(a.onclick=Am)}a=h,t.updateQueue=a,a!==null&&(t.flags|=4)}else{m=h.nodeType===9?h:h.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=dC(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=m.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=m.createElement(i,{is:a.is}):(e=m.createElement(i),i==="select"&&(m=e,a.multiple?m.multiple=!0:a.size&&(m.size=a.size))):e=m.createElementNS(e,i),e[Qs]=t,e[Zd]=a,Fk(e,t,!1,!1),t.stateNode=e;e:{switch(m=Iv(i,a),i){case"dialog":vn("cancel",e),vn("close",e),h=a;break;case"iframe":case"object":case"embed":vn("load",e),h=a;break;case"video":case"audio":for(h=0;h<yd.length;h++)vn(yd[h],e);h=a;break;case"source":vn("error",e),h=a;break;case"img":case"image":case"link":vn("error",e),vn("load",e),h=a;break;case"details":vn("toggle",e),h=a;break;case"input":Mw(e,a),h=Sv(e,a),vn("invalid",e);break;case"option":h=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},h=zn({},a,{value:void 0}),vn("invalid",e);break;case"textarea":zw(e,a),h=kv(e,a),vn("invalid",e);break;default:h=a}Ev(i,h),u=h;for(p in u)if(u.hasOwnProperty(p)){var C=u[p];p==="style"?mC(e,C):p==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,C!=null&&fC(e,C)):p==="children"?typeof C=="string"?(i!=="textarea"||C!=="")&&Bd(e,C):typeof C=="number"&&Bd(e,""+C):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(Fd.hasOwnProperty(p)?C!=null&&p==="onScroll"&&vn("scroll",e):C!=null&&J0(e,p,C,m))}switch(i){case"input":Dp(e),Aw(e,a,!1);break;case"textarea":Dp(e),Dw(e);break;case"option":a.value!=null&&e.setAttribute("value",""+ja(a.value));break;case"select":e.multiple=!!a.multiple,p=a.value,p!=null?vc(e,!!a.multiple,p,!1):a.defaultValue!=null&&vc(e,!!a.multiple,a.defaultValue,!0);break;default:typeof h.onClick=="function"&&(e.onclick=Am)}switch(i){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Or(t),null;case 6:if(e&&t.stateNode!=null)Ok(e,t,e.memoizedProps,a);else{if(typeof a!="string"&&t.stateNode===null)throw Error(Ge(166));if(i=Rl(Hd.current),Rl(to.current),$p(t)){if(a=t.stateNode,i=t.memoizedProps,a[Qs]=t,(p=a.nodeValue!==i)&&(e=$i,e!==null))switch(e.tag){case 3:jp(a.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&jp(a.nodeValue,i,(e.mode&1)!==0)}p&&(t.flags|=4)}else a=(i.nodeType===9?i:i.ownerDocument).createTextNode(a),a[Qs]=t,t.stateNode=a}return Or(t),null;case 13:if(xn(In),a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Cn&&ji!==null&&t.mode&1&&!(t.flags&128))nk(),Mc(),t.flags|=98560,p=!1;else if(p=$p(t),a!==null&&a.dehydrated!==null){if(e===null){if(!p)throw Error(Ge(318));if(p=t.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(Ge(317));p[Qs]=t}else Mc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Or(t),p=!1}else zs!==null&&(u0(zs),zs=null),p=!0;if(!p)return t.flags&65536?t:null}return t.flags&128?(t.lanes=i,t):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(t.child.flags|=8192,t.mode&1&&(e===null||In.current&1?rr===0&&(rr=3):Rx())),t.updateQueue!==null&&(t.flags|=4),Or(t),null);case 4:return zc(),t0(e,t),e===null&&Gd(t.stateNode.containerInfo),Or(t),null;case 10:return yx(t.type._context),Or(t),null;case 17:return bi(t.type)&&zm(),Or(t),null;case 19:if(xn(In),p=t.memoizedState,p===null)return Or(t),null;if(a=(t.flags&128)!==0,m=p.rendering,m===null)if(a)ld(p,!1);else{if(rr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(m=Vm(e),m!==null){for(t.flags|=128,ld(p,!1),a=m.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=i,i=t.child;i!==null;)p=i,e=a,p.flags&=14680066,m=p.alternate,m===null?(p.childLanes=0,p.lanes=e,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=m.childLanes,p.lanes=m.lanes,p.child=m.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=m.memoizedProps,p.memoizedState=m.memoizedState,p.updateQueue=m.updateQueue,p.type=m.type,e=m.dependencies,p.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return gn(In,In.current&1|2),t.child}e=e.sibling}p.tail!==null&&Un()>Rc&&(t.flags|=128,a=!0,ld(p,!1),t.lanes=4194304)}else{if(!a)if(e=Vm(m),e!==null){if(t.flags|=128,a=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),ld(p,!0),p.tail===null&&p.tailMode==="hidden"&&!m.alternate&&!Cn)return Or(t),null}else 2*Un()-p.renderingStartTime>Rc&&i!==1073741824&&(t.flags|=128,a=!0,ld(p,!1),t.lanes=4194304);p.isBackwards?(m.sibling=t.child,t.child=m):(i=p.last,i!==null?i.sibling=m:t.child=m,p.last=m)}return p.tail!==null?(t=p.tail,p.rendering=t,p.tail=t.sibling,p.renderingStartTime=Un(),t.sibling=null,i=In.current,gn(In,a?i&1|2:i&1),t):(Or(t),null);case 22:case 23:return Dx(),a=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(t.flags|=8192),a&&t.mode&1?Vi&1073741824&&(Or(t),t.subtreeFlags&6&&(t.flags|=8192)):Or(t),null;case 24:return null;case 25:return null}throw Error(Ge(156,t.tag))}function PD(e,t){switch(fx(t),t.tag){case 1:return bi(t.type)&&zm(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return zc(),xn(xi),xn(Ur),wx(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return bx(t),null;case 13:if(xn(In),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ge(340));Mc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return xn(In),null;case 4:return zc(),null;case 10:return yx(t.type._context),null;case 22:case 23:return Dx(),null;case 24:return null;default:return null}}var qp=!1,Nr=!1,ED=typeof WeakSet=="function"?WeakSet:Set,dt=null;function dc(e,t){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(a){Nn(e,t,a)}else i.current=null}function n0(e,t,i){try{i()}catch(a){Nn(e,t,a)}}var w2=!1;function ID(e,t){if(Vv=Em,e=UC(),hx(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var a=i.getSelection&&i.getSelection();if(a&&a.rangeCount!==0){i=a.anchorNode;var h=a.anchorOffset,p=a.focusNode;a=a.focusOffset;try{i.nodeType,p.nodeType}catch{i=null;break e}var m=0,u=-1,C=-1,E=0,D=0,z=e,A=null;t:for(;;){for(var Z;z!==i||h!==0&&z.nodeType!==3||(u=m+h),z!==p||a!==0&&z.nodeType!==3||(C=m+a),z.nodeType===3&&(m+=z.nodeValue.length),(Z=z.firstChild)!==null;)A=z,z=Z;for(;;){if(z===e)break t;if(A===i&&++E===h&&(u=m),A===p&&++D===a&&(C=m),(Z=z.nextSibling)!==null)break;z=A,A=z.parentNode}z=Z}i=u===-1||C===-1?null:{start:u,end:C}}else i=null}i=i||{start:0,end:0}}else i=null;for(Nv={focusedElem:e,selectionRange:i},Em=!1,dt=t;dt!==null;)if(t=dt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,dt=e;else for(;dt!==null;){t=dt;try{var Y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(Y!==null){var te=Y.memoizedProps,pe=Y.memoizedState,U=t.stateNode,G=U.getSnapshotBeforeUpdate(t.elementType===t.type?te:Ms(t.type,te),pe);U.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var X=t.stateNode.containerInfo;X.nodeType===1?X.textContent="":X.nodeType===9&&X.documentElement&&X.removeChild(X.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ge(163))}}catch(ae){Nn(t,t.return,ae)}if(e=t.sibling,e!==null){e.return=t.return,dt=e;break}dt=t.return}return Y=w2,w2=!1,Y}function Pd(e,t,i){var a=t.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&e)===e){var p=h.destroy;h.destroy=void 0,p!==void 0&&n0(t,i,p)}h=h.next}while(h!==a)}}function fg(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var i=t=t.next;do{if((i.tag&e)===e){var a=i.create;i.destroy=a()}i=i.next}while(i!==t)}}function r0(e){var t=e.ref;if(t!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof t=="function"?t(e):t.current=e}}function Vk(e){var t=e.alternate;t!==null&&(e.alternate=null,Vk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Qs],delete t[Zd],delete t[Uv],delete t[hD],delete t[dD])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Nk(e){return e.tag===5||e.tag===3||e.tag===4}function S2(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Nk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function i0(e,t,i){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=Am));else if(a!==4&&(e=e.child,e!==null))for(i0(e,t,i),e=e.sibling;e!==null;)i0(e,t,i),e=e.sibling}function s0(e,t,i){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(s0(e,t,i),e=e.sibling;e!==null;)s0(e,t,i),e=e.sibling}var Sr=null,As=!1;function Ta(e,t,i){for(i=i.child;i!==null;)jk(e,t,i),i=i.sibling}function jk(e,t,i){if(eo&&typeof eo.onCommitFiberUnmount=="function")try{eo.onCommitFiberUnmount(sg,i)}catch{}switch(i.tag){case 5:Nr||dc(i,t);case 6:var a=Sr,h=As;Sr=null,Ta(e,t,i),Sr=a,As=h,Sr!==null&&(As?(e=Sr,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):Sr.removeChild(i.stateNode));break;case 18:Sr!==null&&(As?(e=Sr,i=i.stateNode,e.nodeType===8?V_(e.parentNode,i):e.nodeType===1&&V_(e,i),jd(e)):V_(Sr,i.stateNode));break;case 4:a=Sr,h=As,Sr=i.stateNode.containerInfo,As=!0,Ta(e,t,i),Sr=a,As=h;break;case 0:case 11:case 14:case 15:if(!Nr&&(a=i.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){h=a=a.next;do{var p=h,m=p.destroy;p=p.tag,m!==void 0&&(p&2||p&4)&&n0(i,t,m),h=h.next}while(h!==a)}Ta(e,t,i);break;case 1:if(!Nr&&(dc(i,t),a=i.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=i.memoizedProps,a.state=i.memoizedState,a.componentWillUnmount()}catch(u){Nn(i,t,u)}Ta(e,t,i);break;case 21:Ta(e,t,i);break;case 22:i.mode&1?(Nr=(a=Nr)||i.memoizedState!==null,Ta(e,t,i),Nr=a):Ta(e,t,i);break;default:Ta(e,t,i)}}function T2(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new ED),t.forEach(function(a){var h=OD.bind(null,e,a);i.has(a)||(i.add(a),a.then(h,h))})}}function Es(e,t){var i=t.deletions;if(i!==null)for(var a=0;a<i.length;a++){var h=i[a];try{var p=e,m=t,u=m;e:for(;u!==null;){switch(u.tag){case 5:Sr=u.stateNode,As=!1;break e;case 3:Sr=u.stateNode.containerInfo,As=!0;break e;case 4:Sr=u.stateNode.containerInfo,As=!0;break e}u=u.return}if(Sr===null)throw Error(Ge(160));jk(p,m,h),Sr=null,As=!1;var C=h.alternate;C!==null&&(C.return=null),h.return=null}catch(E){Nn(h,t,E)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)$k(t,e),t=t.sibling}function $k(e,t){var i=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Es(t,e),Ws(e),a&4){try{Pd(3,e,e.return),fg(3,e)}catch(te){Nn(e,e.return,te)}try{Pd(5,e,e.return)}catch(te){Nn(e,e.return,te)}}break;case 1:Es(t,e),Ws(e),a&512&&i!==null&&dc(i,i.return);break;case 5:if(Es(t,e),Ws(e),a&512&&i!==null&&dc(i,i.return),e.flags&32){var h=e.stateNode;try{Bd(h,"")}catch(te){Nn(e,e.return,te)}}if(a&4&&(h=e.stateNode,h!=null)){var p=e.memoizedProps,m=i!==null?i.memoizedProps:p,u=e.type,C=e.updateQueue;if(e.updateQueue=null,C!==null)try{u==="input"&&p.type==="radio"&&p.name!=null&&cC(h,p),Iv(u,m);var E=Iv(u,p);for(m=0;m<C.length;m+=2){var D=C[m],z=C[m+1];D==="style"?mC(h,z):D==="dangerouslySetInnerHTML"?fC(h,z):D==="children"?Bd(h,z):J0(h,D,z,E)}switch(u){case"input":Tv(h,p);break;case"textarea":hC(h,p);break;case"select":var A=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!p.multiple;var Z=p.value;Z!=null?vc(h,!!p.multiple,Z,!1):A!==!!p.multiple&&(p.defaultValue!=null?vc(h,!!p.multiple,p.defaultValue,!0):vc(h,!!p.multiple,p.multiple?[]:"",!1))}h[Zd]=p}catch(te){Nn(e,e.return,te)}}break;case 6:if(Es(t,e),Ws(e),a&4){if(e.stateNode===null)throw Error(Ge(162));h=e.stateNode,p=e.memoizedProps;try{h.nodeValue=p}catch(te){Nn(e,e.return,te)}}break;case 3:if(Es(t,e),Ws(e),a&4&&i!==null&&i.memoizedState.isDehydrated)try{jd(t.containerInfo)}catch(te){Nn(e,e.return,te)}break;case 4:Es(t,e),Ws(e);break;case 13:Es(t,e),Ws(e),h=e.child,h.flags&8192&&(p=h.memoizedState!==null,h.stateNode.isHidden=p,!p||h.alternate!==null&&h.alternate.memoizedState!==null||(Ax=Un())),a&4&&T2(e);break;case 22:if(D=i!==null&&i.memoizedState!==null,e.mode&1?(Nr=(E=Nr)||D,Es(t,e),Nr=E):Es(t,e),Ws(e),a&8192){if(E=e.memoizedState!==null,(e.stateNode.isHidden=E)&&!D&&e.mode&1)for(dt=e,D=e.child;D!==null;){for(z=dt=D;dt!==null;){switch(A=dt,Z=A.child,A.tag){case 0:case 11:case 14:case 15:Pd(4,A,A.return);break;case 1:dc(A,A.return);var Y=A.stateNode;if(typeof Y.componentWillUnmount=="function"){a=A,i=A.return;try{t=a,Y.props=t.memoizedProps,Y.state=t.memoizedState,Y.componentWillUnmount()}catch(te){Nn(a,i,te)}}break;case 5:dc(A,A.return);break;case 22:if(A.memoizedState!==null){k2(z);continue}}Z!==null?(Z.return=A,dt=Z):k2(z)}D=D.sibling}e:for(D=null,z=e;;){if(z.tag===5){if(D===null){D=z;try{h=z.stateNode,E?(p=h.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(u=z.stateNode,C=z.memoizedProps.style,m=C!=null&&C.hasOwnProperty("display")?C.display:null,u.style.display=pC("display",m))}catch(te){Nn(e,e.return,te)}}}else if(z.tag===6){if(D===null)try{z.stateNode.nodeValue=E?"":z.memoizedProps}catch(te){Nn(e,e.return,te)}}else if((z.tag!==22&&z.tag!==23||z.memoizedState===null||z===e)&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===e)break e;for(;z.sibling===null;){if(z.return===null||z.return===e)break e;D===z&&(D=null),z=z.return}D===z&&(D=null),z.sibling.return=z.return,z=z.sibling}}break;case 19:Es(t,e),Ws(e),a&4&&T2(e);break;case 21:break;default:Es(t,e),Ws(e)}}function Ws(e){var t=e.flags;if(t&2){try{e:{for(var i=e.return;i!==null;){if(Nk(i)){var a=i;break e}i=i.return}throw Error(Ge(160))}switch(a.tag){case 5:var h=a.stateNode;a.flags&32&&(Bd(h,""),a.flags&=-33);var p=S2(e);s0(e,p,h);break;case 3:case 4:var m=a.stateNode.containerInfo,u=S2(e);i0(e,u,m);break;default:throw Error(Ge(161))}}catch(C){Nn(e,e.return,C)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function MD(e,t,i){dt=e,Uk(e)}function Uk(e,t,i){for(var a=(e.mode&1)!==0;dt!==null;){var h=dt,p=h.child;if(h.tag===22&&a){var m=h.memoizedState!==null||qp;if(!m){var u=h.alternate,C=u!==null&&u.memoizedState!==null||Nr;u=qp;var E=Nr;if(qp=m,(Nr=C)&&!E)for(dt=h;dt!==null;)m=dt,C=m.child,m.tag===22&&m.memoizedState!==null?P2(h):C!==null?(C.return=m,dt=C):P2(h);for(;p!==null;)dt=p,Uk(p),p=p.sibling;dt=h,qp=u,Nr=E}C2(e)}else h.subtreeFlags&8772&&p!==null?(p.return=h,dt=p):C2(e)}}function C2(e){for(;dt!==null;){var t=dt;if(t.flags&8772){var i=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Nr||fg(5,t);break;case 1:var a=t.stateNode;if(t.flags&4&&!Nr)if(i===null)a.componentDidMount();else{var h=t.elementType===t.type?i.memoizedProps:Ms(t.type,i.memoizedProps);a.componentDidUpdate(h,i.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var p=t.updateQueue;p!==null&&u2(t,p,a);break;case 3:var m=t.updateQueue;if(m!==null){if(i=null,t.child!==null)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}u2(t,m,i)}break;case 5:var u=t.stateNode;if(i===null&&t.flags&4){i=u;var C=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":C.autoFocus&&i.focus();break;case"img":C.src&&(i.src=C.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var E=t.alternate;if(E!==null){var D=E.memoizedState;if(D!==null){var z=D.dehydrated;z!==null&&jd(z)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ge(163))}Nr||t.flags&512&&r0(t)}catch(A){Nn(t,t.return,A)}}if(t===e){dt=null;break}if(i=t.sibling,i!==null){i.return=t.return,dt=i;break}dt=t.return}}function k2(e){for(;dt!==null;){var t=dt;if(t===e){dt=null;break}var i=t.sibling;if(i!==null){i.return=t.return,dt=i;break}dt=t.return}}function P2(e){for(;dt!==null;){var t=dt;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{fg(4,t)}catch(C){Nn(t,i,C)}break;case 1:var a=t.stateNode;if(typeof a.componentDidMount=="function"){var h=t.return;try{a.componentDidMount()}catch(C){Nn(t,h,C)}}var p=t.return;try{r0(t)}catch(C){Nn(t,p,C)}break;case 5:var m=t.return;try{r0(t)}catch(C){Nn(t,m,C)}}}catch(C){Nn(t,t.return,C)}if(t===e){dt=null;break}var u=t.sibling;if(u!==null){u.return=t.return,dt=u;break}dt=t.return}}var AD=Math.ceil,$m=jo.ReactCurrentDispatcher,Ix=jo.ReactCurrentOwner,fs=jo.ReactCurrentBatchConfig,Zt=0,mr=null,Jn=null,kr=0,Vi=0,fc=Wa(0),rr=0,Jd=null,Hl=0,pg=0,Mx=0,Ed=null,yi=null,Ax=0,Rc=1/0,Eo=null,Um=!1,o0=null,Oa=null,Zp=!1,za=null,Gm=0,Id=0,a0=null,cm=-1,hm=0;function ni(){return Zt&6?Un():cm!==-1?cm:cm=Un()}function Va(e){return e.mode&1?Zt&2&&kr!==0?kr&-kr:pD.transition!==null?(hm===0&&(hm=PC()),hm):(e=on,e!==0||(e=window.event,e=e===void 0?16:RC(e.type)),e):1}function Rs(e,t,i,a){if(50<Id)throw Id=0,a0=null,Error(Ge(185));df(e,i,a),(!(Zt&2)||e!==mr)&&(e===mr&&(!(Zt&2)&&(pg|=i),rr===4&&Ma(e,kr)),wi(e,a),i===1&&Zt===0&&!(t.mode&1)&&(Rc=Un()+500,cg&&Ha()))}function wi(e,t){var i=e.callbackNode;pz(e,t);var a=Pm(e,e===mr?kr:0);if(a===0)i!==null&&Fw(i),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(i!=null&&Fw(i),t===1)e.tag===0?fD(E2.bind(null,e)):QC(E2.bind(null,e)),uD(function(){!(Zt&6)&&Ha()}),i=null;else{switch(EC(a)){case 1:i=rx;break;case 4:i=CC;break;case 16:i=km;break;case 536870912:i=kC;break;default:i=km}i=Yk(i,Gk.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function Gk(e,t){if(cm=-1,hm=0,Zt&6)throw Error(Ge(327));var i=e.callbackNode;if(Tc()&&e.callbackNode!==i)return null;var a=Pm(e,e===mr?kr:0);if(a===0)return null;if(a&30||a&e.expiredLanes||t)t=qm(e,a);else{t=a;var h=Zt;Zt|=2;var p=Zk();(mr!==e||kr!==t)&&(Eo=null,Rc=Un()+500,Nl(e,t));do try{RD();break}catch(u){qk(e,u)}while(!0);gx(),$m.current=p,Zt=h,Jn!==null?t=0:(mr=null,kr=0,t=rr)}if(t!==0){if(t===2&&(h=Rv(e),h!==0&&(a=h,t=l0(e,h))),t===1)throw i=Jd,Nl(e,0),Ma(e,a),wi(e,Un()),i;if(t===6)Ma(e,a);else{if(h=e.current.alternate,!(a&30)&&!zD(h)&&(t=qm(e,a),t===2&&(p=Rv(e),p!==0&&(a=p,t=l0(e,p))),t===1))throw i=Jd,Nl(e,0),Ma(e,a),wi(e,Un()),i;switch(e.finishedWork=h,e.finishedLanes=a,t){case 0:case 1:throw Error(Ge(345));case 2:Ml(e,yi,Eo);break;case 3:if(Ma(e,a),(a&130023424)===a&&(t=Ax+500-Un(),10<t)){if(Pm(e,0)!==0)break;if(h=e.suspendedLanes,(h&a)!==a){ni(),e.pingedLanes|=e.suspendedLanes&h;break}e.timeoutHandle=$v(Ml.bind(null,e,yi,Eo),t);break}Ml(e,yi,Eo);break;case 4:if(Ma(e,a),(a&4194240)===a)break;for(t=e.eventTimes,h=-1;0<a;){var m=31-Ds(a);p=1<<m,m=t[m],m>h&&(h=m),a&=~p}if(a=h,a=Un()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*AD(a/1960))-a,10<a){e.timeoutHandle=$v(Ml.bind(null,e,yi,Eo),a);break}Ml(e,yi,Eo);break;case 5:Ml(e,yi,Eo);break;default:throw Error(Ge(329))}}}return wi(e,Un()),e.callbackNode===i?Gk.bind(null,e):null}function l0(e,t){var i=Ed;return e.current.memoizedState.isDehydrated&&(Nl(e,t).flags|=256),e=qm(e,t),e!==2&&(t=yi,yi=i,t!==null&&u0(t)),e}function u0(e){yi===null?yi=e:yi.push.apply(yi,e)}function zD(e){for(var t=e;;){if(t.flags&16384){var i=t.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var a=0;a<i.length;a++){var h=i[a],p=h.getSnapshot;h=h.value;try{if(!Ls(p(),h))return!1}catch{return!1}}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ma(e,t){for(t&=~Mx,t&=~pg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-Ds(t),a=1<<i;e[i]=-1,t&=~a}}function E2(e){if(Zt&6)throw Error(Ge(327));Tc();var t=Pm(e,0);if(!(t&1))return wi(e,Un()),null;var i=qm(e,t);if(e.tag!==0&&i===2){var a=Rv(e);a!==0&&(t=a,i=l0(e,a))}if(i===1)throw i=Jd,Nl(e,0),Ma(e,t),wi(e,Un()),i;if(i===6)throw Error(Ge(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ml(e,yi,Eo),wi(e,Un()),null}function zx(e,t){var i=Zt;Zt|=1;try{return e(t)}finally{Zt=i,Zt===0&&(Rc=Un()+500,cg&&Ha())}}function Xl(e){za!==null&&za.tag===0&&!(Zt&6)&&Tc();var t=Zt;Zt|=1;var i=fs.transition,a=on;try{if(fs.transition=null,on=1,e)return e()}finally{on=a,fs.transition=i,Zt=t,!(Zt&6)&&Ha()}}function Dx(){Vi=fc.current,xn(fc)}function Nl(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,lD(i)),Jn!==null)for(i=Jn.return;i!==null;){var a=i;switch(fx(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&zm();break;case 3:zc(),xn(xi),xn(Ur),wx();break;case 5:bx(a);break;case 4:zc();break;case 13:xn(In);break;case 19:xn(In);break;case 10:yx(a.type._context);break;case 22:case 23:Dx()}i=i.return}if(mr=e,Jn=e=Na(e.current,null),kr=Vi=t,rr=0,Jd=null,Mx=pg=Hl=0,yi=Ed=null,Dl!==null){for(t=0;t<Dl.length;t++)if(i=Dl[t],a=i.interleaved,a!==null){i.interleaved=null;var h=a.next,p=i.pending;if(p!==null){var m=p.next;p.next=h,a.next=m}i.pending=a}Dl=null}return e}function qk(e,t){do{var i=Jn;try{if(gx(),am.current=jm,Nm){for(var a=An.memoizedState;a!==null;){var h=a.queue;h!==null&&(h.pending=null),a=a.next}Nm=!1}if(Wl=0,pr=nr=An=null,kd=!1,Xd=0,Ix.current=null,i===null||i.return===null){rr=1,Jd=t,Jn=null;break}e:{var p=e,m=i.return,u=i,C=t;if(t=kr,u.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){var E=C,D=u,z=D.tag;if(!(D.mode&1)&&(z===0||z===11||z===15)){var A=D.alternate;A?(D.updateQueue=A.updateQueue,D.memoizedState=A.memoizedState,D.lanes=A.lanes):(D.updateQueue=null,D.memoizedState=null)}var Z=m2(m);if(Z!==null){Z.flags&=-257,g2(Z,m,u,p,t),Z.mode&1&&p2(p,E,t),t=Z,C=E;var Y=t.updateQueue;if(Y===null){var te=new Set;te.add(C),t.updateQueue=te}else Y.add(C);break e}else{if(!(t&1)){p2(p,E,t),Rx();break e}C=Error(Ge(426))}}else if(Cn&&u.mode&1){var pe=m2(m);if(pe!==null){!(pe.flags&65536)&&(pe.flags|=256),g2(pe,m,u,p,t),px(Dc(C,u));break e}}p=C=Dc(C,u),rr!==4&&(rr=2),Ed===null?Ed=[p]:Ed.push(p),p=m;do{switch(p.tag){case 3:p.flags|=65536,t&=-t,p.lanes|=t;var U=Ek(p,C,t);l2(p,U);break e;case 1:u=C;var G=p.type,X=p.stateNode;if(!(p.flags&128)&&(typeof G.getDerivedStateFromError=="function"||X!==null&&typeof X.componentDidCatch=="function"&&(Oa===null||!Oa.has(X)))){p.flags|=65536,t&=-t,p.lanes|=t;var ae=Ik(p,u,t);l2(p,ae);break e}}p=p.return}while(p!==null)}Hk(i)}catch(_e){t=_e,Jn===i&&i!==null&&(Jn=i=i.return);continue}break}while(!0)}function Zk(){var e=$m.current;return $m.current=jm,e===null?jm:e}function Rx(){(rr===0||rr===3||rr===2)&&(rr=4),mr===null||!(Hl&268435455)&&!(pg&268435455)||Ma(mr,kr)}function qm(e,t){var i=Zt;Zt|=2;var a=Zk();(mr!==e||kr!==t)&&(Eo=null,Nl(e,t));do try{DD();break}catch(h){qk(e,h)}while(!0);if(gx(),Zt=i,$m.current=a,Jn!==null)throw Error(Ge(261));return mr=null,kr=0,rr}function DD(){for(;Jn!==null;)Wk(Jn)}function RD(){for(;Jn!==null&&!sz();)Wk(Jn)}function Wk(e){var t=Kk(e.alternate,e,Vi);e.memoizedProps=e.pendingProps,t===null?Hk(e):Jn=t,Ix.current=null}function Hk(e){var t=e;do{var i=t.alternate;if(e=t.return,t.flags&32768){if(i=PD(i,t),i!==null){i.flags&=32767,Jn=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{rr=6,Jn=null;return}}else if(i=kD(i,t,Vi),i!==null){Jn=i;return}if(t=t.sibling,t!==null){Jn=t;return}Jn=t=e}while(t!==null);rr===0&&(rr=5)}function Ml(e,t,i){var a=on,h=fs.transition;try{fs.transition=null,on=1,LD(e,t,i,a)}finally{fs.transition=h,on=a}return null}function LD(e,t,i,a){do Tc();while(za!==null);if(Zt&6)throw Error(Ge(327));i=e.finishedWork;var h=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(Ge(177));e.callbackNode=null,e.callbackPriority=0;var p=i.lanes|i.childLanes;if(mz(e,p),e===mr&&(Jn=mr=null,kr=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||Zp||(Zp=!0,Yk(km,function(){return Tc(),null})),p=(i.flags&15990)!==0,i.subtreeFlags&15990||p){p=fs.transition,fs.transition=null;var m=on;on=1;var u=Zt;Zt|=4,Ix.current=null,ID(e,i),$k(i,e),tD(Nv),Em=!!Vv,Nv=Vv=null,e.current=i,MD(i),oz(),Zt=u,on=m,fs.transition=p}else e.current=i;if(Zp&&(Zp=!1,za=e,Gm=h),p=e.pendingLanes,p===0&&(Oa=null),uz(i.stateNode),wi(e,Un()),t!==null)for(a=e.onRecoverableError,i=0;i<t.length;i++)h=t[i],a(h.value,{componentStack:h.stack,digest:h.digest});if(Um)throw Um=!1,e=o0,o0=null,e;return Gm&1&&e.tag!==0&&Tc(),p=e.pendingLanes,p&1?e===a0?Id++:(Id=0,a0=e):Id=0,Ha(),null}function Tc(){if(za!==null){var e=EC(Gm),t=fs.transition,i=on;try{if(fs.transition=null,on=16>e?16:e,za===null)var a=!1;else{if(e=za,za=null,Gm=0,Zt&6)throw Error(Ge(331));var h=Zt;for(Zt|=4,dt=e.current;dt!==null;){var p=dt,m=p.child;if(dt.flags&16){var u=p.deletions;if(u!==null){for(var C=0;C<u.length;C++){var E=u[C];for(dt=E;dt!==null;){var D=dt;switch(D.tag){case 0:case 11:case 15:Pd(8,D,p)}var z=D.child;if(z!==null)z.return=D,dt=z;else for(;dt!==null;){D=dt;var A=D.sibling,Z=D.return;if(Vk(D),D===E){dt=null;break}if(A!==null){A.return=Z,dt=A;break}dt=Z}}}var Y=p.alternate;if(Y!==null){var te=Y.child;if(te!==null){Y.child=null;do{var pe=te.sibling;te.sibling=null,te=pe}while(te!==null)}}dt=p}}if(p.subtreeFlags&2064&&m!==null)m.return=p,dt=m;else e:for(;dt!==null;){if(p=dt,p.flags&2048)switch(p.tag){case 0:case 11:case 15:Pd(9,p,p.return)}var U=p.sibling;if(U!==null){U.return=p.return,dt=U;break e}dt=p.return}}var G=e.current;for(dt=G;dt!==null;){m=dt;var X=m.child;if(m.subtreeFlags&2064&&X!==null)X.return=m,dt=X;else e:for(m=G;dt!==null;){if(u=dt,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:fg(9,u)}}catch(_e){Nn(u,u.return,_e)}if(u===m){dt=null;break e}var ae=u.sibling;if(ae!==null){ae.return=u.return,dt=ae;break e}dt=u.return}}if(Zt=h,Ha(),eo&&typeof eo.onPostCommitFiberRoot=="function")try{eo.onPostCommitFiberRoot(sg,e)}catch{}a=!0}return a}finally{on=i,fs.transition=t}}return!1}function I2(e,t,i){t=Dc(i,t),t=Ek(e,t,1),e=Ba(e,t,1),t=ni(),e!==null&&(df(e,1,t),wi(e,t))}function Nn(e,t,i){if(e.tag===3)I2(e,e,i);else for(;t!==null;){if(t.tag===3){I2(t,e,i);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Oa===null||!Oa.has(a))){e=Dc(i,e),e=Ik(t,e,1),t=Ba(t,e,1),e=ni(),t!==null&&(df(t,1,e),wi(t,e));break}}t=t.return}}function FD(e,t,i){var a=e.pingCache;a!==null&&a.delete(t),t=ni(),e.pingedLanes|=e.suspendedLanes&i,mr===e&&(kr&i)===i&&(rr===4||rr===3&&(kr&130023424)===kr&&500>Un()-Ax?Nl(e,0):Mx|=i),wi(e,t)}function Xk(e,t){t===0&&(e.mode&1?(t=Fp,Fp<<=1,!(Fp&130023424)&&(Fp=4194304)):t=1);var i=ni();e=Fo(e,t),e!==null&&(df(e,t,i),wi(e,i))}function BD(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),Xk(e,i)}function OD(e,t){var i=0;switch(e.tag){case 13:var a=e.stateNode,h=e.memoizedState;h!==null&&(i=h.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(Ge(314))}a!==null&&a.delete(t),Xk(e,i)}var Kk;Kk=function(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps||xi.current)_i=!0;else{if(!(e.lanes&i)&&!(t.flags&128))return _i=!1,CD(e,t,i);_i=!!(e.flags&131072)}else _i=!1,Cn&&t.flags&1048576&&ek(t,Lm,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;um(e,t),e=t.pendingProps;var h=Ic(t,Ur.current);Sc(t,i),h=Tx(null,t,a,e,h,i);var p=Cx();return t.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,bi(a)?(p=!0,Dm(t)):p=!1,t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,vx(t),h.updater=dg,t.stateNode=h,h._reactInternals=t,Xv(t,a,e,i),t=Jv(null,t,a,!0,p,i)):(t.tag=0,Cn&&p&&dx(t),ei(null,t,h,i),t=t.child),t;case 16:a=t.elementType;e:{switch(um(e,t),e=t.pendingProps,h=a._init,a=h(a._payload),t.type=a,h=t.tag=ND(a),e=Ms(a,e),h){case 0:t=Yv(null,t,a,e,i);break e;case 1:t=v2(null,t,a,e,i);break e;case 11:t=y2(null,t,a,e,i);break e;case 14:t=_2(null,t,a,Ms(a.type,e),i);break e}throw Error(Ge(306,a,""))}return t;case 0:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),Yv(e,t,a,h,i);case 1:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),v2(e,t,a,h,i);case 3:e:{if(Dk(t),e===null)throw Error(Ge(387));a=t.pendingProps,p=t.memoizedState,h=p.element,ok(e,t),Om(t,a,null,i);var m=t.memoizedState;if(a=m.element,p.isDehydrated)if(p={element:a,isDehydrated:!1,cache:m.cache,pendingSuspenseBoundaries:m.pendingSuspenseBoundaries,transitions:m.transitions},t.updateQueue.baseState=p,t.memoizedState=p,t.flags&256){h=Dc(Error(Ge(423)),t),t=x2(e,t,a,i,h);break e}else if(a!==h){h=Dc(Error(Ge(424)),t),t=x2(e,t,a,i,h);break e}else for(ji=Fa(t.stateNode.containerInfo.firstChild),$i=t,Cn=!0,zs=null,i=ik(t,null,a,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Mc(),a===h){t=Bo(e,t,i);break e}ei(e,t,a,i)}t=t.child}return t;case 5:return ak(t),e===null&&Zv(t),a=t.type,h=t.pendingProps,p=e!==null?e.memoizedProps:null,m=h.children,jv(a,h)?m=null:p!==null&&jv(a,p)&&(t.flags|=32),zk(e,t),ei(e,t,m,i),t.child;case 6:return e===null&&Zv(t),null;case 13:return Rk(e,t,i);case 4:return xx(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=Ac(t,null,a,i):ei(e,t,a,i),t.child;case 11:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),y2(e,t,a,h,i);case 7:return ei(e,t,t.pendingProps,i),t.child;case 8:return ei(e,t,t.pendingProps.children,i),t.child;case 12:return ei(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(a=t.type._context,h=t.pendingProps,p=t.memoizedProps,m=h.value,gn(Fm,a._currentValue),a._currentValue=m,p!==null)if(Ls(p.value,m)){if(p.children===h.children&&!xi.current){t=Bo(e,t,i);break e}}else for(p=t.child,p!==null&&(p.return=t);p!==null;){var u=p.dependencies;if(u!==null){m=p.child;for(var C=u.firstContext;C!==null;){if(C.context===a){if(p.tag===1){C=Do(-1,i&-i),C.tag=2;var E=p.updateQueue;if(E!==null){E=E.shared;var D=E.pending;D===null?C.next=C:(C.next=D.next,D.next=C),E.pending=C}}p.lanes|=i,C=p.alternate,C!==null&&(C.lanes|=i),Wv(p.return,i,t),u.lanes|=i;break}C=C.next}}else if(p.tag===10)m=p.type===t.type?null:p.child;else if(p.tag===18){if(m=p.return,m===null)throw Error(Ge(341));m.lanes|=i,u=m.alternate,u!==null&&(u.lanes|=i),Wv(m,i,t),m=p.sibling}else m=p.child;if(m!==null)m.return=p;else for(m=p;m!==null;){if(m===t){m=null;break}if(p=m.sibling,p!==null){p.return=m.return,m=p;break}m=m.return}p=m}ei(e,t,h.children,i),t=t.child}return t;case 9:return h=t.type,a=t.pendingProps.children,Sc(t,i),h=ms(h),a=a(h),t.flags|=1,ei(e,t,a,i),t.child;case 14:return a=t.type,h=Ms(a,t.pendingProps),h=Ms(a.type,h),_2(e,t,a,h,i);case 15:return Mk(e,t,t.type,t.pendingProps,i);case 17:return a=t.type,h=t.pendingProps,h=t.elementType===a?h:Ms(a,h),um(e,t),t.tag=1,bi(a)?(e=!0,Dm(t)):e=!1,Sc(t,i),Pk(t,a,h),Xv(t,a,h,i),Jv(null,t,a,!0,e,i);case 19:return Lk(e,t,i);case 22:return Ak(e,t,i)}throw Error(Ge(156,t.tag))};function Yk(e,t){return TC(e,t)}function VD(e,t,i,a){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ds(e,t,i,a){return new VD(e,t,i,a)}function Lx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ND(e){if(typeof e=="function")return Lx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ex)return 11;if(e===tx)return 14}return 2}function Na(e,t){var i=e.alternate;return i===null?(i=ds(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function dm(e,t,i,a,h,p){var m=2;if(a=e,typeof e=="function")Lx(e)&&(m=1);else if(typeof e=="string")m=5;else e:switch(e){case rc:return jl(i.children,h,p,t);case Q0:m=8,h|=8;break;case vv:return e=ds(12,i,t,h|2),e.elementType=vv,e.lanes=p,e;case xv:return e=ds(13,i,t,h),e.elementType=xv,e.lanes=p,e;case bv:return e=ds(19,i,t,h),e.elementType=bv,e.lanes=p,e;case aC:return mg(i,h,p,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case sC:m=10;break e;case oC:m=9;break e;case ex:m=11;break e;case tx:m=14;break e;case Pa:m=16,a=null;break e}throw Error(Ge(130,e==null?e:typeof e,""))}return t=ds(m,i,t,h),t.elementType=e,t.type=a,t.lanes=p,t}function jl(e,t,i,a){return e=ds(7,e,a,t),e.lanes=i,e}function mg(e,t,i,a){return e=ds(22,e,a,t),e.elementType=aC,e.lanes=i,e.stateNode={isHidden:!1},e}function W_(e,t,i){return e=ds(6,e,null,t),e.lanes=i,e}function H_(e,t,i){return t=ds(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jD(e,t,i,a,h){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=E_(0),this.expirationTimes=E_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=E_(0),this.identifierPrefix=a,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function Fx(e,t,i,a,h,p,m,u,C){return e=new jD(e,t,i,u,C),t===1?(t=1,p===!0&&(t|=8)):t=0,p=ds(3,null,null,t),e.current=p,p.stateNode=e,p.memoizedState={element:a,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},vx(p),e}function $D(e,t,i){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nc,key:a==null?null:""+a,children:e,containerInfo:t,implementation:i}}function Jk(e){if(!e)return $a;e=e._reactInternals;e:{if(Jl(e)!==e||e.tag!==1)throw Error(Ge(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(bi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ge(171))}if(e.tag===1){var i=e.type;if(bi(i))return JC(e,i,t)}return t}function Qk(e,t,i,a,h,p,m,u,C){return e=Fx(i,a,!0,e,h,p,m,u,C),e.context=Jk(null),i=e.current,a=ni(),h=Va(i),p=Do(a,h),p.callback=t??null,Ba(i,p,h),e.current.lanes=h,df(e,h,a),wi(e,a),e}function gg(e,t,i,a){var h=t.current,p=ni(),m=Va(h);return i=Jk(i),t.context===null?t.context=i:t.pendingContext=i,t=Do(p,m),t.payload={element:e},a=a===void 0?null:a,a!==null&&(t.callback=a),e=Ba(h,t,m),e!==null&&(Rs(e,h,m,p),om(e,h,m)),m}function Zm(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function M2(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function Bx(e,t){M2(e,t),(e=e.alternate)&&M2(e,t)}function UD(){return null}var eP=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ox(e){this._internalRoot=e}yg.prototype.render=Ox.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ge(409));gg(e,t,null,null)};yg.prototype.unmount=Ox.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Xl(function(){gg(null,e,null,null)}),t[Lo]=null}};function yg(e){this._internalRoot=e}yg.prototype.unstable_scheduleHydration=function(e){if(e){var t=AC();e={blockedOn:null,target:e,priority:t};for(var i=0;i<Ia.length&&t!==0&&t<Ia[i].priority;i++);Ia.splice(i,0,e),i===0&&DC(e)}};function Vx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function _g(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function A2(){}function GD(e,t,i,a,h){if(h){if(typeof a=="function"){var p=a;a=function(){var E=Zm(m);p.call(E)}}var m=Qk(t,a,e,0,null,!1,!1,"",A2);return e._reactRootContainer=m,e[Lo]=m.current,Gd(e.nodeType===8?e.parentNode:e),Xl(),m}for(;h=e.lastChild;)e.removeChild(h);if(typeof a=="function"){var u=a;a=function(){var E=Zm(C);u.call(E)}}var C=Fx(e,0,!1,null,null,!1,!1,"",A2);return e._reactRootContainer=C,e[Lo]=C.current,Gd(e.nodeType===8?e.parentNode:e),Xl(function(){gg(t,C,i,a)}),C}function vg(e,t,i,a,h){var p=i._reactRootContainer;if(p){var m=p;if(typeof h=="function"){var u=h;h=function(){var C=Zm(m);u.call(C)}}gg(t,m,e,h)}else m=GD(i,t,e,h,a);return Zm(m)}IC=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=gd(t.pendingLanes);i!==0&&(ix(t,i|1),wi(t,Un()),!(Zt&6)&&(Rc=Un()+500,Ha()))}break;case 13:Xl(function(){var a=Fo(e,1);if(a!==null){var h=ni();Rs(a,e,1,h)}}),Bx(e,1)}};sx=function(e){if(e.tag===13){var t=Fo(e,134217728);if(t!==null){var i=ni();Rs(t,e,134217728,i)}Bx(e,134217728)}};MC=function(e){if(e.tag===13){var t=Va(e),i=Fo(e,t);if(i!==null){var a=ni();Rs(i,e,t,a)}Bx(e,t)}};AC=function(){return on};zC=function(e,t){var i=on;try{return on=e,t()}finally{on=i}};Av=function(e,t,i){switch(t){case"input":if(Tv(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var a=i[t];if(a!==e&&a.form===e.form){var h=ug(a);if(!h)throw Error(Ge(90));uC(a),Tv(a,h)}}}break;case"textarea":hC(e,i);break;case"select":t=i.value,t!=null&&vc(e,!!i.multiple,t,!1)}};_C=zx;vC=Xl;var qD={usingClientEntryPoint:!1,Events:[pf,ac,ug,gC,yC,zx]},ud={findFiberByHostInstance:zl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ZD={bundleType:ud.bundleType,version:ud.version,rendererPackageName:ud.rendererPackageName,rendererConfig:ud.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:jo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=wC(e),e===null?null:e.stateNode},findFiberByHostInstance:ud.findFiberByHostInstance||UD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wp.isDisabled&&Wp.supportsFiber)try{sg=Wp.inject(ZD),eo=Wp}catch{}}Zi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qD;Zi.createPortal=function(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vx(t))throw Error(Ge(200));return $D(e,t,null,i)};Zi.createRoot=function(e,t){if(!Vx(e))throw Error(Ge(299));var i=!1,a="",h=eP;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(h=t.onRecoverableError)),t=Fx(e,1,!1,null,null,i,!1,a,h),e[Lo]=t.current,Gd(e.nodeType===8?e.parentNode:e),new Ox(t)};Zi.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ge(188)):(e=Object.keys(e).join(","),Error(Ge(268,e)));return e=wC(t),e=e===null?null:e.stateNode,e};Zi.flushSync=function(e){return Xl(e)};Zi.hydrate=function(e,t,i){if(!_g(t))throw Error(Ge(200));return vg(null,e,t,!0,i)};Zi.hydrateRoot=function(e,t,i){if(!Vx(e))throw Error(Ge(405));var a=i!=null&&i.hydratedSources||null,h=!1,p="",m=eP;if(i!=null&&(i.unstable_strictMode===!0&&(h=!0),i.identifierPrefix!==void 0&&(p=i.identifierPrefix),i.onRecoverableError!==void 0&&(m=i.onRecoverableError)),t=Qk(t,null,e,1,i??null,h,!1,p,m),e[Lo]=t.current,Gd(e),a)for(e=0;e<a.length;e++)i=a[e],h=i._getVersion,h=h(i._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[i,h]:t.mutableSourceEagerHydrationData.push(i,h);return new yg(t)};Zi.render=function(e,t,i){if(!_g(t))throw Error(Ge(200));return vg(null,e,t,!1,i)};Zi.unmountComponentAtNode=function(e){if(!_g(e))throw Error(Ge(40));return e._reactRootContainer?(Xl(function(){vg(null,null,e,!1,function(){e._reactRootContainer=null,e[Lo]=null})}),!0):!1};Zi.unstable_batchedUpdates=zx;Zi.unstable_renderSubtreeIntoContainer=function(e,t,i,a){if(!_g(i))throw Error(Ge(200));if(e==null||e._reactInternals===void 0)throw Error(Ge(38));return vg(e,t,i,!1,a)};Zi.version="18.3.1-next-f1338f8080-20240426";function tP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tP)}catch(e){console.error(e)}}tP(),tC.exports=Zi;var xg=tC.exports,nP,z2=xg;nP=z2.createRoot,z2.hydrateRoot;const WD="modulepreload",HD=function(e){return"/routr/"+e},D2={},XD=function(t,i,a){let h=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),u=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));h=Promise.allSettled(i.map(C=>{if(C=HD(C),C in D2)return;D2[C]=!0;const E=C.endsWith(".css"),D=E?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${C}"]${D}`))return;const z=document.createElement("link");if(z.rel=E?"stylesheet":WD,E||(z.as="script"),z.crossOrigin="",z.href=C,u&&z.setAttribute("nonce",u),document.head.appendChild(z),E)return new Promise((A,Z)=>{z.addEventListener("load",A),z.addEventListener("error",()=>Z(new Error(`Unable to preload CSS for ${C}`)))})}))}function p(m){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=m,window.dispatchEvent(u),!u.defaultPrevented)throw m}return h.then(m=>{for(const u of m||[])u.status==="rejected"&&p(u.reason);return t().catch(p)})},rP=le.createContext(null);function gf(){var a;const e=(a=le.useContext(rP))==null?void 0:a.maps,t=le.useContext(yf);return le.useMemo(()=>({...e,current:t==null?void 0:t.map}),[e,t])}function KD(e,t){const i=Array.isArray(e)?e[0]:e?e.x:0,a=Array.isArray(e)?e[1]:e?e.y:0,h=Array.isArray(t)?t[0]:t?t.x:0,p=Array.isArray(t)?t[1]:t?t.y:0;return i===h&&a===p}function Ks(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Ks(e[i],t[i]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(const h of i)if(!t.hasOwnProperty(h)||!Ks(e[h],t[h]))return!1;return!0}return!1}function R2(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function L2(e,t){const i=t.viewState||t,a={};if("longitude"in i&&"latitude"in i&&(i.longitude!==e.center.lng||i.latitude!==e.center.lat)){const h=e.center.constructor;a.center=new h(i.longitude,i.latitude)}return"zoom"in i&&i.zoom!==e.zoom&&(a.zoom=i.zoom),"bearing"in i&&i.bearing!==e.bearing&&(a.bearing=i.bearing),"pitch"in i&&i.pitch!==e.pitch&&(a.pitch=i.pitch),i.padding&&e.padding&&!Ks(i.padding,e.padding)&&(a.padding=i.padding),a}const YD=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function F2(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const a of e.layers)t[a.id]=a;const i=e.layers.map(a=>{let h=null;"interactive"in a&&(h=Object.assign({},a),delete h.interactive);const p=t[a.ref];if(p){h=h||Object.assign({},a),delete h.ref;for(const m of YD)m in p&&(h[m]=p[m])}return h||a});return{...e,layers:i}}const B2={version:8,sources:{},layers:[]},O2={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},V2={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},N2={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},JD=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],QD=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Lc{constructor(t,i,a){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=h=>{const p=this.props[N2[h.type]];p?p(h):h.type==="error"&&console.error(h.error)},this._onCameraEvent=h=>{if(this._internalUpdate)return;h.viewState=this._propsedCameraUpdate||R2(this._map.transform);const p=this.props[V2[h.type]];p&&p(h)},this._onCameraUpdate=h=>this._internalUpdate?h:(this._propsedCameraUpdate=R2(h),L2(h,this.props)),this._onPointerEvent=h=>{(h.type==="mousemove"||h.type==="mouseout")&&this._updateHover(h);const p=this.props[O2[h.type]];p&&(this.props.interactiveLayerIds&&h.type!=="mouseover"&&h.type!=="mouseout"&&(h.features=this._hoveredFeatures||this._queryRenderedFeatures(h.point)),p(h),delete h.features)},this._MapClass=t,this.props=i,this._initialize(a)}get map(){return this._map}setProps(t){const i=this.props;this.props=t;const a=this._updateSettings(t,i),h=this._updateSize(t),p=this._updateViewState(t);this._updateStyle(t,i),this._updateStyleComponents(t),this._updateHandlers(t,i),(a||h||p&&!this._map.isMoving())&&this.redraw()}static reuse(t,i){const a=Lc.savedMaps.pop();if(!a)return null;const h=a.map,p=h.getContainer();for(i.className=p.className;p.childNodes.length>0;)i.appendChild(p.childNodes[0]);h._container=i;const m=h._resizeObserver;m&&(m.disconnect(),m.observe(i)),a.setProps({...t,styleDiffing:!1}),h.resize();const{initialViewState:u}=t;return u&&(u.bounds?h.fitBounds(u.bounds,{...u.fitBoundsOptions,duration:0}):a._updateViewState(u)),h.isStyleLoaded()?h.fire("load"):h.once("style.load",()=>h.fire("load")),h._update(),a}_initialize(t){const{props:i}=this,{mapStyle:a=B2}=i,h={...i,...i.initialViewState,container:t,style:F2(a)},p=h.initialViewState||h.viewState||h;if(Object.assign(h,{center:[p.longitude||0,p.latitude||0],zoom:p.zoom||0,pitch:p.pitch||0,bearing:p.bearing||0}),i.gl){const u=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=u,i.gl)}const m=new this._MapClass(h);p.padding&&m.setPadding(p.padding),i.cursor&&(m.getCanvas().style.cursor=i.cursor),m.transformCameraUpdate=this._onCameraUpdate,m.on("style.load",()=>{var u;this._styleComponents={light:m.getLight(),sky:m.getSky(),projection:(u=m.getProjection)==null?void 0:u.call(m),terrain:m.getTerrain()},this._updateStyleComponents(this.props)}),m.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const u in O2)m.on(u,this._onPointerEvent);for(const u in V2)m.on(u,this._onCameraEvent);for(const u in N2)m.on(u,this._onEvent);this._map=m}recycle(){const i=this.map.getContainer().querySelector("[mapboxgl-children]");i==null||i.remove(),Lc.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_updateSize(t){const{viewState:i}=t;if(i){const a=this._map;if(i.width!==a.transform.width||i.height!==a.transform.height)return a.resize(),!0}return!1}_updateViewState(t){const i=this._map,a=i.transform;if(!i.isMoving()){const p=L2(a,t);if(Object.keys(p).length>0)return this._internalUpdate=!0,i.jumpTo(p),this._internalUpdate=!1,!0}return!1}_updateSettings(t,i){const a=this._map;let h=!1;for(const p of JD)if(p in t&&!Ks(t[p],i[p])){h=!0;const m=a[`set${p[0].toUpperCase()}${p.slice(1)}`];m==null||m.call(a,t[p])}return h}_updateStyle(t,i){if(t.cursor!==i.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==i.mapStyle){const{mapStyle:a=B2,styleDiffing:h=!0}=t,p={diff:h};"localIdeographFontFamily"in t&&(p.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(F2(a),p)}}_updateStyleComponents({light:t,projection:i,sky:a,terrain:h}){var u,C;const p=this._map,m=this._styleComponents;p.style._loaded&&(t&&!Ks(t,m.light)&&(m.light=t,p.setLight(t)),i&&!Ks(i,m.projection)&&i!==((u=m.projection)==null?void 0:u.type)&&(m.projection=i,(C=p.setProjection)==null||C.call(p,typeof i=="string"?{type:i}:i)),a&&!Ks(a,m.sky)&&(m.sky=a,p.setSky(a)),h!==void 0&&!Ks(h,m.terrain)&&(!h||p.getSource(h.source))&&(m.terrain=h,p.setTerrain(h)))}_updateHandlers(t,i){const a=this._map;for(const h of QD){const p=t[h]??!0,m=i[h]??!0;Ks(p,m)||(p?a[h].enable(p):a[h].disable())}}_queryRenderedFeatures(t){const i=this._map,{interactiveLayerIds:a=[]}=this.props;try{return i.queryRenderedFeatures(t,{layers:a.filter(i.getLayer.bind(i))})}catch{return[]}}_updateHover(t){var h;const{props:i}=this;if(i.interactiveLayerIds&&(i.onMouseMove||i.onMouseEnter||i.onMouseLeave)){const p=t.type,m=((h=this._hoveredFeatures)==null?void 0:h.length)>0,u=this._queryRenderedFeatures(t.point),C=u.length>0;!C&&m&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=u,C&&!m&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=p}else this._hoveredFeatures=null}}Lc.savedMaps=[];const eR=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function tR(e){if(!e)return null;const t=e.map,i={getMap:()=>t};for(const a of nR(t))!(a in i)&&!eR.includes(a)&&(i[a]=t[a].bind(t));return i}function nR(e){const t=new Set;let i=e;for(;i;){for(const a of Object.getOwnPropertyNames(i))a[0]!=="_"&&typeof e[a]=="function"&&a!=="fire"&&a!=="setEventedParent"&&t.add(a);i=Object.getPrototypeOf(i)}return Array.from(t)}const rR=typeof document<"u"?le.useLayoutEffect:le.useEffect;function iR(e,t){const{RTLTextPlugin:i="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js",maxParallelImageRequests:a,workerCount:h,workerUrl:p}=t;i&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"&&e.setRTLTextPlugin(i,m=>{m&&console.error(m)},!0),a!==void 0&&e.setMaxParallelImageRequests(a),h!==void 0&&e.setWorkerCount(h),p!==void 0&&e.setWorkerUrl(p)}const yf=le.createContext(null);function sR(e,t){const i=le.useContext(rP),[a,h]=le.useState(null),p=le.useRef(),{current:m}=le.useRef({mapLib:null,map:null});le.useEffect(()=>{const E=e.mapLib;let D=!0,z;return Promise.resolve(E||XD(()=>Promise.resolve().then(()=>vF),void 0)).then(A=>{if(!D)return;if(!A)throw new Error("Invalid mapLib");const Z="Map"in A?A:A.default;if(!Z.Map)throw new Error("Invalid mapLib");if(iR(Z,e),!Z.supported||Z.supported(e))e.reuseMaps&&(z=Lc.reuse(e,p.current)),z||(z=new Lc(Z.Map,e,p.current)),m.map=tR(z),m.mapLib=Z,h(z),i==null||i.onMapMount(m.map,e.id);else throw new Error("Map is not supported by this browser")}).catch(A=>{const{onError:Z}=e;Z?Z({type:"error",target:null,originalEvent:null,error:A}):console.error(A)}),()=>{D=!1,z&&(i==null||i.onMapUnmount(e.id),e.reuseMaps?z.recycle():z.destroy())}},[]),rR(()=>{a&&a.setProps(e)}),le.useImperativeHandle(t,()=>m.map,[a]);const u=le.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),C={height:"100%"};return le.createElement("div",{id:e.id,ref:p,style:u},a&&le.createElement(yf.Provider,{value:m},le.createElement("div",{"mapboxgl-children":"",style:C},e.children)))}const oR=le.forwardRef(sR),aR=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function $o(e,t){if(!e||!t)return;const i=e.style;for(const a in t){const h=t[a];Number.isFinite(h)&&!aR.test(a)?i[a]=`${h}px`:i[a]=h}}le.memo(le.forwardRef((e,t)=>{const{map:i,mapLib:a}=le.useContext(yf),h=le.useRef({props:e});h.current.props=e;const p=le.useMemo(()=>{let te=!1;le.Children.forEach(e.children,G=>{G&&(te=!0)});const pe={...e,element:te?document.createElement("div"):null},U=new a.Marker(pe);return U.setLngLat([e.longitude,e.latitude]),U.getElement().addEventListener("click",G=>{var X,ae;(ae=(X=h.current.props).onClick)==null||ae.call(X,{type:"click",target:U,originalEvent:G})}),U.on("dragstart",G=>{var ae,_e;const X=G;X.lngLat=p.getLngLat(),(_e=(ae=h.current.props).onDragStart)==null||_e.call(ae,X)}),U.on("drag",G=>{var ae,_e;const X=G;X.lngLat=p.getLngLat(),(_e=(ae=h.current.props).onDrag)==null||_e.call(ae,X)}),U.on("dragend",G=>{var ae,_e;const X=G;X.lngLat=p.getLngLat(),(_e=(ae=h.current.props).onDragEnd)==null||_e.call(ae,X)}),U},[]);le.useEffect(()=>(p.addTo(i.getMap()),()=>{p.remove()}),[]);const{longitude:m,latitude:u,offset:C,style:E,draggable:D=!1,popup:z=null,rotation:A=0,rotationAlignment:Z="auto",pitchAlignment:Y="auto"}=e;return le.useEffect(()=>{$o(p.getElement(),E)},[E]),le.useImperativeHandle(t,()=>p,[]),(p.getLngLat().lng!==m||p.getLngLat().lat!==u)&&p.setLngLat([m,u]),C&&!KD(p.getOffset(),C)&&p.setOffset(C),p.isDraggable()!==D&&p.setDraggable(D),p.getRotation()!==A&&p.setRotation(A),p.getRotationAlignment()!==Z&&p.setRotationAlignment(Z),p.getPitchAlignment()!==Y&&p.setPitchAlignment(Y),p.getPopup()!==z&&p.setPopup(z),xg.createPortal(e.children,p.getElement())}));function j2(e){return new Set(e?e.trim().split(/\s+/):[])}le.memo(le.forwardRef((e,t)=>{const{map:i,mapLib:a}=le.useContext(yf),h=le.useMemo(()=>document.createElement("div"),[]),p=le.useRef({props:e});p.current.props=e;const m=le.useMemo(()=>{const u={...e},C=new a.Popup(u);return C.setLngLat([e.longitude,e.latitude]),C.once("open",E=>{var D,z;(z=(D=p.current.props).onOpen)==null||z.call(D,E)}),C},[]);if(le.useEffect(()=>{const u=C=>{var E,D;(D=(E=p.current.props).onClose)==null||D.call(E,C)};return m.on("close",u),m.setDOMContent(h).addTo(i.getMap()),()=>{m.off("close",u),m.isOpen()&&m.remove()}},[]),le.useEffect(()=>{$o(m.getElement(),e.style)},[e.style]),le.useImperativeHandle(t,()=>m,[]),m.isOpen()&&((m.getLngLat().lng!==e.longitude||m.getLngLat().lat!==e.latitude)&&m.setLngLat([e.longitude,e.latitude]),e.offset&&!Ks(m.options.offset,e.offset)&&m.setOffset(e.offset),(m.options.anchor!==e.anchor||m.options.maxWidth!==e.maxWidth)&&(m.options.anchor=e.anchor,m.setMaxWidth(e.maxWidth)),m.options.className!==e.className)){const u=j2(m.options.className),C=j2(e.className);for(const E of u)C.has(E)||m.removeClassName(E);for(const E of C)u.has(E)||m.addClassName(E);m.options.className=e.className}return xg.createPortal(e.children,h)}));function Ql(e,t,i,a){const h=le.useContext(yf),p=le.useMemo(()=>e(h),[]);return le.useEffect(()=>{const m=t,u=null,C=typeof t=="function"?t:null,{map:E}=h;return E.hasControl(p)||(E.addControl(p,m==null?void 0:m.position),u&&u(h)),()=>{C&&C(h),E.hasControl(p)&&E.removeControl(p)}},[]),p}function lR(e){const t=Ql(({mapLib:i})=>new i.AttributionControl(e),{position:e.position});return le.useEffect(()=>{$o(t._container,e.style)},[e.style]),null}le.memo(lR);function uR(e){const t=Ql(({mapLib:i})=>new i.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return le.useEffect(()=>{$o(t._controlContainer,e.style)},[e.style]),null}le.memo(uR);function cR(e,t){const i=le.useRef({props:e}),a=Ql(({mapLib:h})=>{const p=new h.GeolocateControl(e),m=p._setupUI;return p._setupUI=()=>{p._container.hasChildNodes()||m()},p.on("geolocate",u=>{var C,E;(E=(C=i.current.props).onGeolocate)==null||E.call(C,u)}),p.on("error",u=>{var C,E;(E=(C=i.current.props).onError)==null||E.call(C,u)}),p.on("outofmaxbounds",u=>{var C,E;(E=(C=i.current.props).onOutOfMaxBounds)==null||E.call(C,u)}),p.on("trackuserlocationstart",u=>{var C,E;(E=(C=i.current.props).onTrackUserLocationStart)==null||E.call(C,u)}),p.on("trackuserlocationend",u=>{var C,E;(E=(C=i.current.props).onTrackUserLocationEnd)==null||E.call(C,u)}),p},{position:e.position});return i.current.props=e,le.useImperativeHandle(t,()=>a,[]),le.useEffect(()=>{$o(a._container,e.style)},[e.style]),null}le.memo(le.forwardRef(cR));function hR(e){const t=Ql(({mapLib:i})=>new i.NavigationControl(e),{position:e.position});return le.useEffect(()=>{$o(t._container,e.style)},[e.style]),null}le.memo(hR);function dR(e){const t=Ql(({mapLib:p})=>new p.ScaleControl(e),{position:e.position}),i=le.useRef(e),a=i.current;i.current=e;const{style:h}=e;return e.maxWidth!==void 0&&e.maxWidth!==a.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==a.unit&&t.setUnit(e.unit),le.useEffect(()=>{$o(t._container,h)},[h]),null}le.memo(dR);function fR(e){const t=Ql(({mapLib:i})=>new i.TerrainControl(e),{position:e.position});return le.useEffect(()=>{$o(t._container,e.style)},[e.style]),null}le.memo(fR);function pR(e){const t=Ql(({mapLib:i})=>new i.LogoControl(e),{position:e.position});return le.useEffect(()=>{$o(t._container,e.style)},[e.style]),null}le.memo(pR);const Wm=[-100,40],mR=.5,gR=26.2;function yR(e){const t=e.properties,i=[];return t.housenumber&&i.push(t.housenumber),t.street&&i.push(t.street),!t.street&&t.locality&&i.push(t.locality),!t.street&&!t.locality&&t.district&&i.push(t.district),t.city&&i.push(t.city),t.county&&!t.city&&i.push(t.county),t.state&&i.push(t.state),t.country&&i.push(t.country),i.join(", ")||t.name||"Unknown location"}function iP(e,t){const[i,a]=e;let h=!1;for(let p=0,m=t.length-1;p<t.length;m=p++){const[u,C]=t[p],[E,D]=t[m];C>a!=D>a&&i<(E-u)*(a-C)/(D-C)+u&&(h=!h)}return h}async function _R(){try{const t=await(await fetch("https://ipwho.is/")).json();if(typeof t.latitude=="number"&&typeof t.longitude=="number")return[t.longitude,t.latitude]}catch{}return Wm}function vR(e,t=6){const i=Math.pow(10,t),a=[];let h=0,p=0,m=0;for(;h<e.length;){let u=0,C=0,E;do E=e.charCodeAt(h++)-63,u|=(E&31)<<C,C+=5;while(E>=32);p+=u&1?~(u>>1):u>>1,u=0,C=0;do E=e.charCodeAt(h++)-63,u|=(E&31)<<C,C+=5;while(E>=32);m+=u&1?~(u>>1):u>>1,a.push([m/i,p/i])}return a}function c0(e){const t=e==null?void 0:e.trip;if(!(t!=null&&t.legs))return null;const i=t.legs,a=t.summary,h=[];for(const p of i)h.push(...vR(p.shape,6));return{coordinates:h,distanceMiles:a.length,durationMinutes:a.time/60}}function xR(e,t,i,a,h,p,m,u){const C=i-e,E=a-t,D=m-h,z=u-p,A=C*z-E*D;if(Math.abs(A)<1e-12)return!1;const Z=((h-e)*z-(p-t)*D)/A,Y=((h-e)*E-(p-t)*C)/A;return Z>0&&Z<1&&Y>0&&Y<1}function bR(e,t,i){const[a,h]=e,[p,m]=t;for(const u of i)for(let C=0;C<u.length-1;C++){const[E,D]=u[C],[z,A]=u[C+1];if(xR(a,h,p,m,E,D,z,A))return!0}return!1}async function wR(e,t,i){try{const h=`[out:json][timeout:8];(way["highway"~"^(motorway|trunk|motorway_link|trunk_link|primary|primary_link)$"](around:${Math.round(i)},${e},${t}););out geom;`,p=await fetch("https://overpass-api.de/api/interpreter",{method:"POST",body:h});return p.ok?((await p.json()).elements??[]).filter(C=>{var E;return((E=C.geometry)==null?void 0:E.length)>=2}).map(C=>C.geometry.map(({lat:E,lon:D})=>[D,E])):[]}catch{return[]}}const sP={pedestrian:{walkway_factor:.3,sidewalk_factor:.6,alley_factor:8,driveway_factor:20,use_living_streets:.5,use_tracks:.4,use_hills:.5,use_ferry:0,step_penalty:60,service_penalty:30,shortest:!1}},SR=(e,t,i,a,h)=>Array.from({length:7},(p,m)=>{const u=h+m*2*Math.PI/7;return[e+i*Math.cos(u),t+a*Math.sin(u)]}),TR=(e,t,i,a,h)=>{const p=[];for(let m=0;m<8;m++){const u=m/8*2*Math.PI,C=.55+.45*Math.cos(u/2),E=h+u;p.push([e+i*C*Math.cos(E),t+a*C*Math.sin(E)])}return p},CR=(e,t,i,a,h)=>{const p=[];for(let m=0;m<7;m++){const u=h+m*2*Math.PI/7,C=e+i*.35*Math.cos(h+Math.PI/2),E=t+a*.35*Math.sin(h+Math.PI/2);p.push([C+i*.75*Math.cos(u),E+a*.75*Math.sin(u)])}return p},kR=(e,t,i,a,h)=>{const p=[];for(let m=0;m<6;m++){const u=h+m*2*Math.PI/6;p.push([e+i*.55*Math.cos(u),t+a*.55*Math.sin(u)+a*.45])}for(let m=0;m<4;m++){const u=h-m*2*Math.PI/4;p.push([e+i*.45*Math.cos(u),t+a*.45*Math.sin(u)-a*.45])}return p},$2=[SR,TR,CR,kR];function U2(e,t,i,a){const h=!a||a.length<3||iP(e,a),p=i.length===0||!bR(t,e,i);return h&&p}function PR(e,t,i,a,h,p){const[m,u]=e,C=t/111320,E=t/(111320*Math.cos(u*(Math.PI/180)));return i(m,u,E,C,a).map(z=>{if(U2(z,e,h,p))return z;const[A,Z]=z,Y=A-m,te=Z-u,pe=Math.atan2(te/C,Y/E);for(let U=1;U<=24;U++){const G=pe+U*Math.PI/12,X=[m+E*Math.cos(G),u+C*Math.sin(G)];if(U2(X,e,h,p))return X}return z})}function ER(e,t){return e.length===0?1:e.filter(i=>iP(i,t)).length/e.length}function IR(e){if(e.length<10)return 0;const t=Math.max(1,Math.floor(e.length/60)),i=e.filter((m,u)=>u%t===0),a=7e-4,h=new Set;let p=0;for(const[m,u]of i){const C=`${Math.round(m/a)},${Math.round(u/a)}`;h.has(C)&&p++,h.add(C)}return p/i.length}async function G2(e,t,i,a,h,p){try{const m=PR(e,t,i,a,h,p),u={locations:[{lon:e[0],lat:e[1],type:"break"},...m.map(([D,z])=>({lon:D,lat:z,type:"through"})),{lon:e[0],lat:e[1],type:"break"}],costing:"pedestrian",costing_options:sP,directions_options:{units:"miles"}},C=await fetch("https://valhalla1.openstreetmap.de/route",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!C.ok)return null;const E=c0(await C.json());return!E||p&&p.length>=3&&ER(E.coordinates,p)<.8?null:(E._backtrack=IR(E.coordinates),E)}catch{return null}}function MR(e){const t=new Set,i=.0015;for(const[a,h]of e)t.add(`${Math.round(a/i)},${Math.round(h/i)}`);return t}function AR(e,t){let i=0;for(const a of e)t.has(a)&&i++;return i/(e.size+t.size-i)}function zR(e){const t=[],i=[];for(const a of e){const h=MR(a.coordinates);i.some(m=>AR(h,m)>.45)||(t.push(a),i.push(h))}return t}async function DR(e,t,i){const h=t*1609.34/(2*Math.PI*1.8),p=await wR(e[1],e[0],h*1.6),m=Array.from({length:6},(z,A)=>A*Math.PI/3),u=[.8,1,1.25],C=[];for(const z of $2)for(const A of m)for(const Z of u)C.push(G2(e,h*Z,z,A,p,i));let D=(await Promise.all(C)).filter(z=>z!==null);return D.length===0&&i&&i.length>=3&&(D=(await Promise.all($2.flatMap(A=>m.flatMap(Z=>u.map(Y=>G2(e,h*Y,A,Z,p)))))).filter(A=>A!==null)),D.sort((z,A)=>{const Z=Math.abs(z.distanceMiles-t)-Math.abs(A.distanceMiles-t);if(Math.abs(Z)>.3)return Z;const Y=z._backtrack??0,te=A._backtrack??0;return Y-te}),zR(D)}async function RR(e,t){return LR(e,t)}async function LR(e,t){try{const i={locations:[{lon:e[0],lat:e[1]},{lon:t[0],lat:t[1]}],costing:"pedestrian",costing_options:sP,directions_options:{units:"miles"},alternates:2},a=await fetch("https://valhalla1.openstreetmap.de/route",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!a.ok)return[];const h=await a.json(),p=[],m=c0(h);m&&p.push(m);const u=h.alternates??[];for(const C of u){const E=c0(C);E&&p.push(E)}return p}catch{return[]}}async function FR(e){try{const i=await(await fetch(`https://photon.komoot.io/api/?q=${encodeURIComponent(e)}&limit=3`)).json();if(!i.features)return[];const a=i.features.map(h=>({id:h.properties.osm_id,coordinates:h.geometry.coordinates,name:yR(h)}));return Array.from(new Map(a.map(h=>[h.id,h])).values())}catch{return[]}}function BR(){const{current:e}=gf();return le.useEffect(()=>{e&&(async()=>{const t=await _R();t!==Wm&&e.flyTo({center:t,zoom:8})})()},[e]),e?De.jsx(De.Fragment,{}):null}const Nx=le.createContext({});function jx(e){const t=le.useRef(null);return t.current===null&&(t.current=e()),t.current}const $x=typeof window<"u",oP=$x?le.useLayoutEffect:le.useEffect,bg=le.createContext(null);function Ux(e,t){e.indexOf(t)===-1&&e.push(t)}function Gx(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}const Oo=(e,t,i)=>i>t?t:i<e?e:i;let qx=()=>{};const Vo={},aP=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function lP(e){return typeof e=="object"&&e!==null}const uP=e=>/^0[^.\s]+$/u.test(e);function Zx(e){let t;return()=>(t===void 0&&(t=e()),t)}const ps=e=>e,OR=(e,t)=>i=>t(e(i)),_f=(...e)=>e.reduce(OR),Qd=(e,t,i)=>{const a=t-e;return a===0?1:(i-e)/a};class Wx{constructor(){this.subscriptions=[]}add(t){return Ux(this.subscriptions,t),()=>Gx(this.subscriptions,t)}notify(t,i,a){const h=this.subscriptions.length;if(h)if(h===1)this.subscriptions[0](t,i,a);else for(let p=0;p<h;p++){const m=this.subscriptions[p];m&&m(t,i,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const no=e=>e*1e3,ro=e=>e/1e3;function cP(e,t){return t?e*(1e3/t):0}const hP=(e,t,i)=>(((1-3*i+3*t)*e+(3*i-6*t))*e+3*t)*e,VR=1e-7,NR=12;function jR(e,t,i,a,h){let p,m,u=0;do m=t+(i-t)/2,p=hP(m,a,h)-e,p>0?i=m:t=m;while(Math.abs(p)>VR&&++u<NR);return m}function vf(e,t,i,a){if(e===t&&i===a)return ps;const h=p=>jR(p,0,1,e,i);return p=>p===0||p===1?p:hP(h(p),t,a)}const dP=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,fP=e=>t=>1-e(1-t),pP=vf(.33,1.53,.69,.99),Hx=fP(pP),mP=dP(Hx),gP=e=>(e*=2)<1?.5*Hx(e):.5*(2-Math.pow(2,-10*(e-1))),Xx=e=>1-Math.sin(Math.acos(e)),yP=fP(Xx),_P=dP(Xx),$R=vf(.42,0,1,1),UR=vf(0,0,.58,1),vP=vf(.42,0,.58,1),GR=e=>Array.isArray(e)&&typeof e[0]!="number",xP=e=>Array.isArray(e)&&typeof e[0]=="number",qR={linear:ps,easeIn:$R,easeInOut:vP,easeOut:UR,circIn:Xx,circInOut:_P,circOut:yP,backIn:Hx,backInOut:mP,backOut:pP,anticipate:gP},ZR=e=>typeof e=="string",q2=e=>{if(xP(e)){qx(e.length===4);const[t,i,a,h]=e;return vf(t,i,a,h)}else if(ZR(e))return qR[e];return e},Hp=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function WR(e,t){let i=new Set,a=new Set,h=!1,p=!1;const m=new WeakSet;let u={delta:0,timestamp:0,isProcessing:!1};function C(D){m.has(D)&&(E.schedule(D),e()),D(u)}const E={schedule:(D,z=!1,A=!1)=>{const Y=A&&h?i:a;return z&&m.add(D),Y.has(D)||Y.add(D),D},cancel:D=>{a.delete(D),m.delete(D)},process:D=>{if(u=D,h){p=!0;return}h=!0,[i,a]=[a,i],i.forEach(C),i.clear(),h=!1,p&&(p=!1,E.process(D))}};return E}const HR=40;function bP(e,t){let i=!1,a=!0;const h={delta:0,timestamp:0,isProcessing:!1},p=()=>i=!0,m=Hp.reduce((X,ae)=>(X[ae]=WR(p),X),{}),{setup:u,read:C,resolveKeyframes:E,preUpdate:D,update:z,preRender:A,render:Z,postRender:Y}=m,te=()=>{const X=Vo.useManualTiming?h.timestamp:performance.now();i=!1,Vo.useManualTiming||(h.delta=a?1e3/60:Math.max(Math.min(X-h.timestamp,HR),1)),h.timestamp=X,h.isProcessing=!0,u.process(h),C.process(h),E.process(h),D.process(h),z.process(h),A.process(h),Z.process(h),Y.process(h),h.isProcessing=!1,i&&t&&(a=!1,e(te))},pe=()=>{i=!0,a=!0,h.isProcessing||e(te)};return{schedule:Hp.reduce((X,ae)=>{const _e=m[ae];return X[ae]=(ye,Se=!1,Ie=!1)=>(i||pe(),_e.schedule(ye,Se,Ie)),X},{}),cancel:X=>{for(let ae=0;ae<Hp.length;ae++)m[Hp[ae]].cancel(X)},state:h,steps:m}}const{schedule:kn,cancel:Ua,state:Tr,steps:X_}=bP(typeof requestAnimationFrame<"u"?requestAnimationFrame:ps,!0);let fm;function XR(){fm=void 0}const vi={now:()=>(fm===void 0&&vi.set(Tr.isProcessing||Vo.useManualTiming?Tr.timestamp:performance.now()),fm),set:e=>{fm=e,queueMicrotask(XR)}},wP=e=>t=>typeof t=="string"&&t.startsWith(e),Kx=wP("--"),KR=wP("var(--"),Yx=e=>KR(e)?YR.test(e.split("/*")[0].trim()):!1,YR=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Uc={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},ef={...Uc,transform:e=>Oo(0,1,e)},Xp={...Uc,default:1},Md=e=>Math.round(e*1e5)/1e5,Jx=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function JR(e){return e==null}const QR=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Qx=(e,t)=>i=>!!(typeof i=="string"&&QR.test(i)&&i.startsWith(e)||t&&!JR(i)&&Object.prototype.hasOwnProperty.call(i,t)),SP=(e,t,i)=>a=>{if(typeof a!="string")return a;const[h,p,m,u]=a.match(Jx);return{[e]:parseFloat(h),[t]:parseFloat(p),[i]:parseFloat(m),alpha:u!==void 0?parseFloat(u):1}},eL=e=>Oo(0,255,e),K_={...Uc,transform:e=>Math.round(eL(e))},Ll={test:Qx("rgb","red"),parse:SP("red","green","blue"),transform:({red:e,green:t,blue:i,alpha:a=1})=>"rgba("+K_.transform(e)+", "+K_.transform(t)+", "+K_.transform(i)+", "+Md(ef.transform(a))+")"};function tL(e){let t="",i="",a="",h="";return e.length>5?(t=e.substring(1,3),i=e.substring(3,5),a=e.substring(5,7),h=e.substring(7,9)):(t=e.substring(1,2),i=e.substring(2,3),a=e.substring(3,4),h=e.substring(4,5),t+=t,i+=i,a+=a,h+=h),{red:parseInt(t,16),green:parseInt(i,16),blue:parseInt(a,16),alpha:h?parseInt(h,16)/255:1}}const h0={test:Qx("#"),parse:tL,transform:Ll.transform},xf=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),ka=xf("deg"),io=xf("%"),Et=xf("px"),nL=xf("vh"),rL=xf("vw"),Z2={...io,parse:e=>io.parse(e)/100,transform:e=>io.transform(e*100)},pc={test:Qx("hsl","hue"),parse:SP("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:i,alpha:a=1})=>"hsla("+Math.round(e)+", "+io.transform(Md(t))+", "+io.transform(Md(i))+", "+Md(ef.transform(a))+")"},Kn={test:e=>Ll.test(e)||h0.test(e)||pc.test(e),parse:e=>Ll.test(e)?Ll.parse(e):pc.test(e)?pc.parse(e):h0.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ll.transform(e):pc.transform(e),getAnimatableNone:e=>{const t=Kn.parse(e);return t.alpha=0,Kn.transform(t)}},iL=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function sL(e){var t,i;return isNaN(e)&&typeof e=="string"&&(((t=e.match(Jx))==null?void 0:t.length)||0)+(((i=e.match(iL))==null?void 0:i.length)||0)>0}const TP="number",CP="color",oL="var",aL="var(",W2="${}",lL=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function tf(e){const t=e.toString(),i=[],a={color:[],number:[],var:[]},h=[];let p=0;const u=t.replace(lL,C=>(Kn.test(C)?(a.color.push(p),h.push(CP),i.push(Kn.parse(C))):C.startsWith(aL)?(a.var.push(p),h.push(oL),i.push(C)):(a.number.push(p),h.push(TP),i.push(parseFloat(C))),++p,W2)).split(W2);return{values:i,split:u,indexes:a,types:h}}function kP(e){return tf(e).values}function PP(e){const{split:t,types:i}=tf(e),a=t.length;return h=>{let p="";for(let m=0;m<a;m++)if(p+=t[m],h[m]!==void 0){const u=i[m];u===TP?p+=Md(h[m]):u===CP?p+=Kn.transform(h[m]):p+=h[m]}return p}}const uL=e=>typeof e=="number"?0:Kn.test(e)?Kn.getAnimatableNone(e):e;function cL(e){const t=kP(e);return PP(e)(t.map(uL))}const Ga={test:sL,parse:kP,createTransformer:PP,getAnimatableNone:cL};function Y_(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function hL({hue:e,saturation:t,lightness:i,alpha:a}){e/=360,t/=100,i/=100;let h=0,p=0,m=0;if(!t)h=p=m=i;else{const u=i<.5?i*(1+t):i+t-i*t,C=2*i-u;h=Y_(C,u,e+1/3),p=Y_(C,u,e),m=Y_(C,u,e-1/3)}return{red:Math.round(h*255),green:Math.round(p*255),blue:Math.round(m*255),alpha:a}}function Hm(e,t){return i=>i>0?t:e}const Mn=(e,t,i)=>e+(t-e)*i,J_=(e,t,i)=>{const a=e*e,h=i*(t*t-a)+a;return h<0?0:Math.sqrt(h)},dL=[h0,Ll,pc],fL=e=>dL.find(t=>t.test(e));function H2(e){const t=fL(e);if(!t)return!1;let i=t.parse(e);return t===pc&&(i=hL(i)),i}const X2=(e,t)=>{const i=H2(e),a=H2(t);if(!i||!a)return Hm(e,t);const h={...i};return p=>(h.red=J_(i.red,a.red,p),h.green=J_(i.green,a.green,p),h.blue=J_(i.blue,a.blue,p),h.alpha=Mn(i.alpha,a.alpha,p),Ll.transform(h))},d0=new Set(["none","hidden"]);function pL(e,t){return d0.has(e)?i=>i<=0?e:t:i=>i>=1?t:e}function mL(e,t){return i=>Mn(e,t,i)}function e1(e){return typeof e=="number"?mL:typeof e=="string"?Yx(e)?Hm:Kn.test(e)?X2:_L:Array.isArray(e)?EP:typeof e=="object"?Kn.test(e)?X2:gL:Hm}function EP(e,t){const i=[...e],a=i.length,h=e.map((p,m)=>e1(p)(p,t[m]));return p=>{for(let m=0;m<a;m++)i[m]=h[m](p);return i}}function gL(e,t){const i={...e,...t},a={};for(const h in i)e[h]!==void 0&&t[h]!==void 0&&(a[h]=e1(e[h])(e[h],t[h]));return h=>{for(const p in a)i[p]=a[p](h);return i}}function yL(e,t){const i=[],a={color:0,var:0,number:0};for(let h=0;h<t.values.length;h++){const p=t.types[h],m=e.indexes[p][a[p]],u=e.values[m]??0;i[h]=u,a[p]++}return i}const _L=(e,t)=>{const i=Ga.createTransformer(t),a=tf(e),h=tf(t);return a.indexes.var.length===h.indexes.var.length&&a.indexes.color.length===h.indexes.color.length&&a.indexes.number.length>=h.indexes.number.length?d0.has(e)&&!h.values.length||d0.has(t)&&!a.values.length?pL(e,t):_f(EP(yL(a,h),h.values),i):Hm(e,t)};function IP(e,t,i){return typeof e=="number"&&typeof t=="number"&&typeof i=="number"?Mn(e,t,i):e1(e)(e,t)}const vL=e=>{const t=({timestamp:i})=>e(i);return{start:(i=!0)=>kn.update(t,i),stop:()=>Ua(t),now:()=>Tr.isProcessing?Tr.timestamp:vi.now()}},MP=(e,t,i=10)=>{let a="";const h=Math.max(Math.round(t/i),2);for(let p=0;p<h;p++)a+=Math.round(e(p/(h-1))*1e4)/1e4+", ";return`linear(${a.substring(0,a.length-2)})`},Xm=2e4;function t1(e){let t=0;const i=50;let a=e.next(t);for(;!a.done&&t<Xm;)t+=i,a=e.next(t);return t>=Xm?1/0:t}function xL(e,t=100,i){const a=i({...e,keyframes:[0,t]}),h=Math.min(t1(a),Xm);return{type:"keyframes",ease:p=>a.next(h*p).value/t,duration:ro(h)}}const bL=5;function AP(e,t,i){const a=Math.max(t-bL,0);return cP(i-e(a),t-a)}const Vn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Q_=.001;function wL({duration:e=Vn.duration,bounce:t=Vn.bounce,velocity:i=Vn.velocity,mass:a=Vn.mass}){let h,p,m=1-t;m=Oo(Vn.minDamping,Vn.maxDamping,m),e=Oo(Vn.minDuration,Vn.maxDuration,ro(e)),m<1?(h=E=>{const D=E*m,z=D*e,A=D-i,Z=f0(E,m),Y=Math.exp(-z);return Q_-A/Z*Y},p=E=>{const z=E*m*e,A=z*i+i,Z=Math.pow(m,2)*Math.pow(E,2)*e,Y=Math.exp(-z),te=f0(Math.pow(E,2),m);return(-h(E)+Q_>0?-1:1)*((A-Z)*Y)/te}):(h=E=>{const D=Math.exp(-E*e),z=(E-i)*e+1;return-Q_+D*z},p=E=>{const D=Math.exp(-E*e),z=(i-E)*(e*e);return D*z});const u=5/e,C=TL(h,p,u);if(e=no(e),isNaN(C))return{stiffness:Vn.stiffness,damping:Vn.damping,duration:e};{const E=Math.pow(C,2)*a;return{stiffness:E,damping:m*2*Math.sqrt(a*E),duration:e}}}const SL=12;function TL(e,t,i){let a=i;for(let h=1;h<SL;h++)a=a-e(a)/t(a);return a}function f0(e,t){return e*Math.sqrt(1-t*t)}const CL=["duration","bounce"],kL=["stiffness","damping","mass"];function K2(e,t){return t.some(i=>e[i]!==void 0)}function PL(e){let t={velocity:Vn.velocity,stiffness:Vn.stiffness,damping:Vn.damping,mass:Vn.mass,isResolvedFromDuration:!1,...e};if(!K2(e,kL)&&K2(e,CL))if(e.visualDuration){const i=e.visualDuration,a=2*Math.PI/(i*1.2),h=a*a,p=2*Oo(.05,1,1-(e.bounce||0))*Math.sqrt(h);t={...t,mass:Vn.mass,stiffness:h,damping:p}}else{const i=wL(e);t={...t,...i,mass:Vn.mass},t.isResolvedFromDuration=!0}return t}function Km(e=Vn.visualDuration,t=Vn.bounce){const i=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:a,restDelta:h}=i;const p=i.keyframes[0],m=i.keyframes[i.keyframes.length-1],u={done:!1,value:p},{stiffness:C,damping:E,mass:D,duration:z,velocity:A,isResolvedFromDuration:Z}=PL({...i,velocity:-ro(i.velocity||0)}),Y=A||0,te=E/(2*Math.sqrt(C*D)),pe=m-p,U=ro(Math.sqrt(C/D)),G=Math.abs(pe)<5;a||(a=G?Vn.restSpeed.granular:Vn.restSpeed.default),h||(h=G?Vn.restDelta.granular:Vn.restDelta.default);let X;if(te<1){const _e=f0(U,te);X=ye=>{const Se=Math.exp(-te*U*ye);return m-Se*((Y+te*U*pe)/_e*Math.sin(_e*ye)+pe*Math.cos(_e*ye))}}else if(te===1)X=_e=>m-Math.exp(-U*_e)*(pe+(Y+U*pe)*_e);else{const _e=U*Math.sqrt(te*te-1);X=ye=>{const Se=Math.exp(-te*U*ye),Ie=Math.min(_e*ye,300);return m-Se*((Y+te*U*pe)*Math.sinh(Ie)+_e*pe*Math.cosh(Ie))/_e}}const ae={calculatedDuration:Z&&z||null,next:_e=>{const ye=X(_e);if(Z)u.done=_e>=z;else{let Se=_e===0?Y:0;te<1&&(Se=_e===0?no(Y):AP(X,_e,ye));const Ie=Math.abs(Se)<=a,Be=Math.abs(m-ye)<=h;u.done=Ie&&Be}return u.value=u.done?m:ye,u},toString:()=>{const _e=Math.min(t1(ae),Xm),ye=MP(Se=>ae.next(_e*Se).value,_e,30);return _e+"ms "+ye},toTransition:()=>{}};return ae}Km.applyToOptions=e=>{const t=xL(e,100,Km);return e.ease=t.ease,e.duration=no(t.duration),e.type="keyframes",e};function p0({keyframes:e,velocity:t=0,power:i=.8,timeConstant:a=325,bounceDamping:h=10,bounceStiffness:p=500,modifyTarget:m,min:u,max:C,restDelta:E=.5,restSpeed:D}){const z=e[0],A={done:!1,value:z},Z=Ie=>u!==void 0&&Ie<u||C!==void 0&&Ie>C,Y=Ie=>u===void 0?C:C===void 0||Math.abs(u-Ie)<Math.abs(C-Ie)?u:C;let te=i*t;const pe=z+te,U=m===void 0?pe:m(pe);U!==pe&&(te=U-z);const G=Ie=>-te*Math.exp(-Ie/a),X=Ie=>U+G(Ie),ae=Ie=>{const Be=G(Ie),Ue=X(Ie);A.done=Math.abs(Be)<=E,A.value=A.done?U:Ue};let _e,ye;const Se=Ie=>{Z(A.value)&&(_e=Ie,ye=Km({keyframes:[A.value,Y(A.value)],velocity:AP(X,Ie,A.value),damping:h,stiffness:p,restDelta:E,restSpeed:D}))};return Se(0),{calculatedDuration:null,next:Ie=>{let Be=!1;return!ye&&_e===void 0&&(Be=!0,ae(Ie),Se(Ie)),_e!==void 0&&Ie>=_e?ye.next(Ie-_e):(!Be&&ae(Ie),A)}}}function EL(e,t,i){const a=[],h=i||Vo.mix||IP,p=e.length-1;for(let m=0;m<p;m++){let u=h(e[m],e[m+1]);if(t){const C=Array.isArray(t)?t[m]||ps:t;u=_f(C,u)}a.push(u)}return a}function IL(e,t,{clamp:i=!0,ease:a,mixer:h}={}){const p=e.length;if(qx(p===t.length),p===1)return()=>t[0];if(p===2&&t[0]===t[1])return()=>t[1];const m=e[0]===e[1];e[0]>e[p-1]&&(e=[...e].reverse(),t=[...t].reverse());const u=EL(t,a,h),C=u.length,E=D=>{if(m&&D<e[0])return t[0];let z=0;if(C>1)for(;z<e.length-2&&!(D<e[z+1]);z++);const A=Qd(e[z],e[z+1],D);return u[z](A)};return i?D=>E(Oo(e[0],e[p-1],D)):E}function ML(e,t){const i=e[e.length-1];for(let a=1;a<=t;a++){const h=Qd(0,t,a);e.push(Mn(i,1,h))}}function AL(e){const t=[0];return ML(t,e.length-1),t}function zL(e,t){return e.map(i=>i*t)}function DL(e,t){return e.map(()=>t||vP).splice(0,e.length-1)}function Ad({duration:e=300,keyframes:t,times:i,ease:a="easeInOut"}){const h=GR(a)?a.map(q2):q2(a),p={done:!1,value:t[0]},m=zL(i&&i.length===t.length?i:AL(t),e),u=IL(m,t,{ease:Array.isArray(h)?h:DL(t,h)});return{calculatedDuration:e,next:C=>(p.value=u(C),p.done=C>=e,p)}}const RL=e=>e!==null;function n1(e,{repeat:t,repeatType:i="loop"},a,h=1){const p=e.filter(RL),u=h<0||t&&i!=="loop"&&t%2===1?0:p.length-1;return!u||a===void 0?p[u]:a}const LL={decay:p0,inertia:p0,tween:Ad,keyframes:Ad,spring:Km};function zP(e){typeof e.type=="string"&&(e.type=LL[e.type])}class r1{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,i){return this.finished.then(t,i)}}const FL=e=>e/100;class i1 extends r1{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var a,h;const{motionValue:i}=this.options;i&&i.updatedAt!==vi.now()&&this.tick(vi.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(h=(a=this.options).onStop)==null||h.call(a))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;zP(t);const{type:i=Ad,repeat:a=0,repeatDelay:h=0,repeatType:p,velocity:m=0}=t;let{keyframes:u}=t;const C=i||Ad;C!==Ad&&typeof u[0]!="number"&&(this.mixKeyframes=_f(FL,IP(u[0],u[1])),u=[0,100]);const E=C({...t,keyframes:u});p==="mirror"&&(this.mirroredGenerator=C({...t,keyframes:[...u].reverse(),velocity:-m})),E.calculatedDuration===null&&(E.calculatedDuration=t1(E));const{calculatedDuration:D}=E;this.calculatedDuration=D,this.resolvedDuration=D+h,this.totalDuration=this.resolvedDuration*(a+1)-h,this.generator=E}updateTime(t){const i=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=i}tick(t,i=!1){const{generator:a,totalDuration:h,mixKeyframes:p,mirroredGenerator:m,resolvedDuration:u,calculatedDuration:C}=this;if(this.startTime===null)return a.next(0);const{delay:E=0,keyframes:D,repeat:z,repeatType:A,repeatDelay:Z,type:Y,onUpdate:te,finalKeyframe:pe}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-h/this.speed,this.startTime)),i?this.currentTime=t:this.updateTime(t);const U=this.currentTime-E*(this.playbackSpeed>=0?1:-1),G=this.playbackSpeed>=0?U<0:U>h;this.currentTime=Math.max(U,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let X=this.currentTime,ae=a;if(z){const Ie=Math.min(this.currentTime,h)/u;let Be=Math.floor(Ie),Ue=Ie%1;!Ue&&Ie>=1&&(Ue=1),Ue===1&&Be--,Be=Math.min(Be,z+1),!!(Be%2)&&(A==="reverse"?(Ue=1-Ue,Z&&(Ue-=Z/u)):A==="mirror"&&(ae=m)),X=Oo(0,1,Ue)*u}const _e=G?{done:!1,value:D[0]}:ae.next(X);p&&(_e.value=p(_e.value));let{done:ye}=_e;!G&&C!==null&&(ye=this.playbackSpeed>=0?this.currentTime>=h:this.currentTime<=0);const Se=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&ye);return Se&&Y!==p0&&(_e.value=n1(D,this.options,pe,this.speed)),te&&te(_e.value),Se&&this.finish(),_e}then(t,i){return this.finished.then(t,i)}get duration(){return ro(this.calculatedDuration)}get time(){return ro(this.currentTime)}set time(t){var i;t=no(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(i=this.driver)==null||i.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(vi.now());const i=this.playbackSpeed!==t;this.playbackSpeed=t,i&&(this.time=ro(this.currentTime))}play(){var h,p;if(this.isStopped)return;const{driver:t=vL,startTime:i}=this.options;this.driver||(this.driver=t(m=>this.tick(m))),(p=(h=this.options).onPlay)==null||p.call(h);const a=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=a):this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime||(this.startTime=i??a),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(vi.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,i;this.notifyFinished(),this.teardown(),this.state="finished",(i=(t=this.options).onComplete)==null||i.call(t)}cancel(){var t,i;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(i=(t=this.options).onCancel)==null||i.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var i;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(i=this.driver)==null||i.stop(),t.observe(this)}}function BL(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Fl=e=>e*180/Math.PI,m0=e=>{const t=Fl(Math.atan2(e[1],e[0]));return g0(t)},OL={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:m0,rotateZ:m0,skewX:e=>Fl(Math.atan(e[1])),skewY:e=>Fl(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},g0=e=>(e=e%360,e<0&&(e+=360),e),Y2=m0,J2=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Q2=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),VL={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:J2,scaleY:Q2,scale:e=>(J2(e)+Q2(e))/2,rotateX:e=>g0(Fl(Math.atan2(e[6],e[5]))),rotateY:e=>g0(Fl(Math.atan2(-e[2],e[0]))),rotateZ:Y2,rotate:Y2,skewX:e=>Fl(Math.atan(e[4])),skewY:e=>Fl(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function y0(e){return e.includes("scale")?1:0}function _0(e,t){if(!e||e==="none")return y0(t);const i=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let a,h;if(i)a=VL,h=i;else{const u=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);a=OL,h=u}if(!h)return y0(t);const p=a[t],m=h[1].split(",").map(jL);return typeof p=="function"?p(m):m[p]}const NL=(e,t)=>{const{transform:i="none"}=getComputedStyle(e);return _0(i,t)};function jL(e){return parseFloat(e.trim())}const Gc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],qc=new Set(Gc),eS=e=>e===Uc||e===Et,$L=new Set(["x","y","z"]),UL=Gc.filter(e=>!$L.has(e));function GL(e){const t=[];return UL.forEach(i=>{const a=e.getValue(i);a!==void 0&&(t.push([i,a.get()]),a.set(i.startsWith("scale")?1:0))}),t}const $l={width:({x:e},{paddingLeft:t="0",paddingRight:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),height:({y:e},{paddingTop:t="0",paddingBottom:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>_0(t,"x"),y:(e,{transform:t})=>_0(t,"y")};$l.translateX=$l.x;$l.translateY=$l.y;const Ul=new Set;let v0=!1,x0=!1,b0=!1;function DP(){if(x0){const e=Array.from(Ul).filter(a=>a.needsMeasurement),t=new Set(e.map(a=>a.element)),i=new Map;t.forEach(a=>{const h=GL(a);h.length&&(i.set(a,h),a.render())}),e.forEach(a=>a.measureInitialState()),t.forEach(a=>{a.render();const h=i.get(a);h&&h.forEach(([p,m])=>{var u;(u=a.getValue(p))==null||u.set(m)})}),e.forEach(a=>a.measureEndState()),e.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}x0=!1,v0=!1,Ul.forEach(e=>e.complete(b0)),Ul.clear()}function RP(){Ul.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(x0=!0)})}function qL(){b0=!0,RP(),DP(),b0=!1}class s1{constructor(t,i,a,h,p,m=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=i,this.name=a,this.motionValue=h,this.element=p,this.isAsync=m}scheduleResolve(){this.state="scheduled",this.isAsync?(Ul.add(this),v0||(v0=!0,kn.read(RP),kn.resolveKeyframes(DP))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:i,element:a,motionValue:h}=this;if(t[0]===null){const p=h==null?void 0:h.get(),m=t[t.length-1];if(p!==void 0)t[0]=p;else if(a&&i){const u=a.readValue(i,m);u!=null&&(t[0]=u)}t[0]===void 0&&(t[0]=m),h&&p===void 0&&h.set(t[0])}BL(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Ul.delete(this)}cancel(){this.state==="scheduled"&&(Ul.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const ZL=e=>e.startsWith("--");function WL(e,t,i){ZL(t)?e.style.setProperty(t,i):e.style[t]=i}const HL=Zx(()=>window.ScrollTimeline!==void 0),XL={};function KL(e,t){const i=Zx(e);return()=>XL[t]??i()}const LP=KL(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),_d=([e,t,i,a])=>`cubic-bezier(${e}, ${t}, ${i}, ${a})`,tS={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:_d([0,.65,.55,1]),circOut:_d([.55,0,1,.45]),backIn:_d([.31,.01,.66,-.59]),backOut:_d([.33,1.53,.69,.99])};function FP(e,t){if(e)return typeof e=="function"?LP()?MP(e,t):"ease-out":xP(e)?_d(e):Array.isArray(e)?e.map(i=>FP(i,t)||tS.easeOut):tS[e]}function YL(e,t,i,{delay:a=0,duration:h=300,repeat:p=0,repeatType:m="loop",ease:u="easeOut",times:C}={},E=void 0){const D={[t]:i};C&&(D.offset=C);const z=FP(u,h);Array.isArray(z)&&(D.easing=z);const A={delay:a,duration:h,easing:Array.isArray(z)?"linear":z,fill:"both",iterations:p+1,direction:m==="reverse"?"alternate":"normal"};return E&&(A.pseudoElement=E),e.animate(D,A)}function BP(e){return typeof e=="function"&&"applyToOptions"in e}function JL({type:e,...t}){return BP(e)&&LP()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class QL extends r1{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:i,name:a,keyframes:h,pseudoElement:p,allowFlatten:m=!1,finalKeyframe:u,onComplete:C}=t;this.isPseudoElement=!!p,this.allowFlatten=m,this.options=t,qx(typeof t.type!="string");const E=JL(t);this.animation=YL(i,a,h,E,p),E.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!p){const D=n1(h,this.options,u,this.speed);this.updateMotionValue?this.updateMotionValue(D):WL(i,a,D),this.animation.cancel()}C==null||C(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,i;(i=(t=this.animation).finish)==null||i.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,i;this.isPseudoElement||(i=(t=this.animation).commitStyles)==null||i.call(t)}get duration(){var i,a;const t=((a=(i=this.animation.effect)==null?void 0:i.getComputedTiming)==null?void 0:a.call(i).duration)||0;return ro(Number(t))}get time(){return ro(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=no(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:i}){var a;return this.allowFlatten&&((a=this.animation.effect)==null||a.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&HL()?(this.animation.timeline=t,ps):i(this)}}const OP={anticipate:gP,backInOut:mP,circInOut:_P};function e5(e){return e in OP}function t5(e){typeof e.ease=="string"&&e5(e.ease)&&(e.ease=OP[e.ease])}const nS=10;class n5 extends QL{constructor(t){t5(t),zP(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:i,onUpdate:a,onComplete:h,element:p,...m}=this.options;if(!i)return;if(t!==void 0){i.set(t);return}const u=new i1({...m,autoplay:!1}),C=no(this.finishedTime??this.time);i.setWithVelocity(u.sample(C-nS).value,u.sample(C).value,nS),u.stop()}}const rS=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Ga.test(e)||e==="0")&&!e.startsWith("url("));function r5(e){const t=e[0];if(e.length===1)return!0;for(let i=0;i<e.length;i++)if(e[i]!==t)return!0}function i5(e,t,i,a){const h=e[0];if(h===null)return!1;if(t==="display"||t==="visibility")return!0;const p=e[e.length-1],m=rS(h,t),u=rS(p,t);return!m||!u?!1:r5(e)||(i==="spring"||BP(i))&&a}function w0(e){e.duration=0,e.type}const s5=new Set(["opacity","clipPath","filter","transform"]),o5=Zx(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function a5(e){var D;const{motionValue:t,name:i,repeatDelay:a,repeatType:h,damping:p,type:m}=e;if(!(((D=t==null?void 0:t.owner)==null?void 0:D.current)instanceof HTMLElement))return!1;const{onUpdate:C,transformTemplate:E}=t.owner.getProps();return o5()&&i&&s5.has(i)&&(i!=="transform"||!E)&&!C&&!a&&h!=="mirror"&&p!==0&&m!=="inertia"}const l5=40;class u5 extends r1{constructor({autoplay:t=!0,delay:i=0,type:a="keyframes",repeat:h=0,repeatDelay:p=0,repeatType:m="loop",keyframes:u,name:C,motionValue:E,element:D,...z}){var Y;super(),this.stop=()=>{var te,pe;this._animation&&(this._animation.stop(),(te=this.stopTimeline)==null||te.call(this)),(pe=this.keyframeResolver)==null||pe.cancel()},this.createdAt=vi.now();const A={autoplay:t,delay:i,type:a,repeat:h,repeatDelay:p,repeatType:m,name:C,motionValue:E,element:D,...z},Z=(D==null?void 0:D.KeyframeResolver)||s1;this.keyframeResolver=new Z(u,(te,pe,U)=>this.onKeyframesResolved(te,pe,A,!U),C,E,D),(Y=this.keyframeResolver)==null||Y.scheduleResolve()}onKeyframesResolved(t,i,a,h){this.keyframeResolver=void 0;const{name:p,type:m,velocity:u,delay:C,isHandoff:E,onUpdate:D}=a;this.resolvedAt=vi.now(),i5(t,p,m,u)||((Vo.instantAnimations||!C)&&(D==null||D(n1(t,a,i))),t[0]=t[t.length-1],w0(a),a.repeat=0);const A={startTime:h?this.resolvedAt?this.resolvedAt-this.createdAt>l5?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:i,...a,keyframes:t},Z=!E&&a5(A)?new n5({...A,element:A.motionValue.owner.current}):new i1(A);Z.finished.then(()=>this.notifyFinished()).catch(ps),this.pendingTimeline&&(this.stopTimeline=Z.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=Z}get finished(){return this._animation?this.animation.finished:this._finished}then(t,i){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),qL()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const c5=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function h5(e){const t=c5.exec(e);if(!t)return[,];const[,i,a,h]=t;return[`--${i??a}`,h]}function VP(e,t,i=1){const[a,h]=h5(e);if(!a)return;const p=window.getComputedStyle(t).getPropertyValue(a);if(p){const m=p.trim();return aP(m)?parseFloat(m):m}return Yx(h)?VP(h,t,i+1):h}function o1(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const NP=new Set(["width","height","top","left","right","bottom",...Gc]),d5={test:e=>e==="auto",parse:e=>e},jP=e=>t=>t.test(e),$P=[Uc,Et,io,ka,rL,nL,d5],iS=e=>$P.find(jP(e));function f5(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||uP(e):!0}const p5=new Set(["brightness","contrast","saturate","opacity"]);function m5(e){const[t,i]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[a]=i.match(Jx)||[];if(!a)return e;const h=i.replace(a,"");let p=p5.has(t)?1:0;return a!==i&&(p*=100),t+"("+p+h+")"}const g5=/\b([a-z-]*)\(.*?\)/gu,S0={...Ga,getAnimatableNone:e=>{const t=e.match(g5);return t?t.map(m5).join(" "):e}},sS={...Uc,transform:Math.round},y5={rotate:ka,rotateX:ka,rotateY:ka,rotateZ:ka,scale:Xp,scaleX:Xp,scaleY:Xp,scaleZ:Xp,skew:ka,skewX:ka,skewY:ka,distance:Et,translateX:Et,translateY:Et,translateZ:Et,x:Et,y:Et,z:Et,perspective:Et,transformPerspective:Et,opacity:ef,originX:Z2,originY:Z2,originZ:Et},a1={borderWidth:Et,borderTopWidth:Et,borderRightWidth:Et,borderBottomWidth:Et,borderLeftWidth:Et,borderRadius:Et,radius:Et,borderTopLeftRadius:Et,borderTopRightRadius:Et,borderBottomRightRadius:Et,borderBottomLeftRadius:Et,width:Et,maxWidth:Et,height:Et,maxHeight:Et,top:Et,right:Et,bottom:Et,left:Et,padding:Et,paddingTop:Et,paddingRight:Et,paddingBottom:Et,paddingLeft:Et,margin:Et,marginTop:Et,marginRight:Et,marginBottom:Et,marginLeft:Et,backgroundPositionX:Et,backgroundPositionY:Et,...y5,zIndex:sS,fillOpacity:ef,strokeOpacity:ef,numOctaves:sS},_5={...a1,color:Kn,backgroundColor:Kn,outlineColor:Kn,fill:Kn,stroke:Kn,borderColor:Kn,borderTopColor:Kn,borderRightColor:Kn,borderBottomColor:Kn,borderLeftColor:Kn,filter:S0,WebkitFilter:S0},UP=e=>_5[e];function GP(e,t){let i=UP(e);return i!==S0&&(i=Ga),i.getAnimatableNone?i.getAnimatableNone(t):void 0}const v5=new Set(["auto","none","0"]);function x5(e,t,i){let a=0,h;for(;a<e.length&&!h;){const p=e[a];typeof p=="string"&&!v5.has(p)&&tf(p).values.length&&(h=e[a]),a++}if(h&&i)for(const p of t)e[p]=GP(i,h)}class b5 extends s1{constructor(t,i,a,h,p){super(t,i,a,h,p,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:i,name:a}=this;if(!i||!i.current)return;super.readKeyframes();for(let C=0;C<t.length;C++){let E=t[C];if(typeof E=="string"&&(E=E.trim(),Yx(E))){const D=VP(E,i.current);D!==void 0&&(t[C]=D),C===t.length-1&&(this.finalKeyframe=E)}}if(this.resolveNoneKeyframes(),!NP.has(a)||t.length!==2)return;const[h,p]=t,m=iS(h),u=iS(p);if(m!==u)if(eS(m)&&eS(u))for(let C=0;C<t.length;C++){const E=t[C];typeof E=="string"&&(t[C]=parseFloat(E))}else $l[a]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:i}=this,a=[];for(let h=0;h<t.length;h++)(t[h]===null||f5(t[h]))&&a.push(h);a.length&&x5(t,a,i)}measureInitialState(){const{element:t,unresolvedKeyframes:i,name:a}=this;if(!t||!t.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=$l[a](t.measureViewportBox(),window.getComputedStyle(t.current)),i[0]=this.measuredOrigin;const h=i[i.length-1];h!==void 0&&t.getValue(a,h).jump(h,!1)}measureEndState(){var u;const{element:t,name:i,unresolvedKeyframes:a}=this;if(!t||!t.current)return;const h=t.getValue(i);h&&h.jump(this.measuredOrigin,!1);const p=a.length-1,m=a[p];a[p]=$l[i](t.measureViewportBox(),window.getComputedStyle(t.current)),m!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=m),(u=this.removedTransforms)!=null&&u.length&&this.removedTransforms.forEach(([C,E])=>{t.getValue(C).set(E)}),this.resolveNoneKeyframes()}}function w5(e,t,i){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let a=document;const h=(i==null?void 0:i[e])??a.querySelectorAll(e);return h?Array.from(h):[]}return Array.from(e)}const qP=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function ZP(e){return lP(e)&&"offsetHeight"in e}const oS=30,S5=e=>!isNaN(parseFloat(e));class T5{constructor(t,i={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=a=>{var p;const h=vi.now();if(this.updatedAt!==h&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&((p=this.events.change)==null||p.notify(this.current),this.dependents))for(const m of this.dependents)m.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=i.owner}setCurrent(t){this.current=t,this.updatedAt=vi.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=S5(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,i){this.events[t]||(this.events[t]=new Wx);const a=this.events[t].add(i);return t==="change"?()=>{a(),kn.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,i){this.passiveEffect=t,this.stopPassiveEffect=i}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,i,a){this.set(i),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-a}jump(t,i=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,i&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=vi.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>oS)return 0;const i=Math.min(this.updatedAt-this.prevUpdatedAt,oS);return cP(parseFloat(this.current)-parseFloat(this.prevFrameValue),i)}start(t){return this.stop(),new Promise(i=>{this.hasAnimated=!0,this.animation=t(i),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,i;(t=this.dependents)==null||t.clear(),(i=this.events.destroy)==null||i.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Fc(e,t){return new T5(e,t)}const{schedule:l1}=bP(queueMicrotask,!1),Is={x:!1,y:!1};function WP(){return Is.x||Is.y}function C5(e){return e==="x"||e==="y"?Is[e]?null:(Is[e]=!0,()=>{Is[e]=!1}):Is.x||Is.y?null:(Is.x=Is.y=!0,()=>{Is.x=Is.y=!1})}function HP(e,t){const i=w5(e),a=new AbortController,h={passive:!0,...t,signal:a.signal};return[i,h,()=>a.abort()]}function aS(e){return!(e.pointerType==="touch"||WP())}function k5(e,t,i={}){const[a,h,p]=HP(e,i),m=u=>{if(!aS(u))return;const{target:C}=u,E=t(C,u);if(typeof E!="function"||!C)return;const D=z=>{aS(z)&&(E(z),C.removeEventListener("pointerleave",D))};C.addEventListener("pointerleave",D,h)};return a.forEach(u=>{u.addEventListener("pointerenter",m,h)}),p}const XP=(e,t)=>t?e===t?!0:XP(e,t.parentElement):!1,u1=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,P5=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function E5(e){return P5.has(e.tagName)||e.tabIndex!==-1}const pm=new WeakSet;function lS(e){return t=>{t.key==="Enter"&&e(t)}}function ev(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const I5=(e,t)=>{const i=e.currentTarget;if(!i)return;const a=lS(()=>{if(pm.has(i))return;ev(i,"down");const h=lS(()=>{ev(i,"up")}),p=()=>ev(i,"cancel");i.addEventListener("keyup",h,t),i.addEventListener("blur",p,t)});i.addEventListener("keydown",a,t),i.addEventListener("blur",()=>i.removeEventListener("keydown",a),t)};function uS(e){return u1(e)&&!WP()}function M5(e,t,i={}){const[a,h,p]=HP(e,i),m=u=>{const C=u.currentTarget;if(!uS(u))return;pm.add(C);const E=t(C,u),D=(Z,Y)=>{window.removeEventListener("pointerup",z),window.removeEventListener("pointercancel",A),pm.has(C)&&pm.delete(C),uS(Z)&&typeof E=="function"&&E(Z,{success:Y})},z=Z=>{D(Z,C===window||C===document||i.useGlobalTarget||XP(C,Z.target))},A=Z=>{D(Z,!1)};window.addEventListener("pointerup",z,h),window.addEventListener("pointercancel",A,h)};return a.forEach(u=>{(i.useGlobalTarget?window:u).addEventListener("pointerdown",m,h),ZP(u)&&(u.addEventListener("focus",E=>I5(E,h)),!E5(u)&&!u.hasAttribute("tabindex")&&(u.tabIndex=0))}),p}function KP(e){return lP(e)&&"ownerSVGElement"in e}function A5(e){return KP(e)&&e.tagName==="svg"}const jr=e=>!!(e&&e.getVelocity),z5=[...$P,Kn,Ga],D5=e=>z5.find(jP(e)),c1=le.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class R5 extends le.Component{getSnapshotBeforeUpdate(t){const i=this.props.childRef.current;if(i&&t.isPresent&&!this.props.isPresent){const a=i.offsetParent,h=ZP(a)&&a.offsetWidth||0,p=this.props.sizeRef.current;p.height=i.offsetHeight||0,p.width=i.offsetWidth||0,p.top=i.offsetTop,p.left=i.offsetLeft,p.right=h-p.width-p.left}return null}componentDidUpdate(){}render(){return this.props.children}}function L5({children:e,isPresent:t,anchorX:i,root:a}){const h=le.useId(),p=le.useRef(null),m=le.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=le.useContext(c1);return le.useInsertionEffect(()=>{const{width:C,height:E,top:D,left:z,right:A}=m.current;if(t||!p.current||!C||!E)return;const Z=i==="left"?`left: ${z}`:`right: ${A}`;p.current.dataset.motionPopId=h;const Y=document.createElement("style");u&&(Y.nonce=u);const te=a??document.head;return te.appendChild(Y),Y.sheet&&Y.sheet.insertRule(`
          [data-motion-pop-id="${h}"] {
            position: absolute !important;
            width: ${C}px !important;
            height: ${E}px !important;
            ${Z}px !important;
            top: ${D}px !important;
          }
        `),()=>{te.contains(Y)&&te.removeChild(Y)}},[t]),De.jsx(R5,{isPresent:t,childRef:p,sizeRef:m,children:le.cloneElement(e,{ref:p})})}const F5=({children:e,initial:t,isPresent:i,onExitComplete:a,custom:h,presenceAffectsLayout:p,mode:m,anchorX:u,root:C})=>{const E=jx(B5),D=le.useId();let z=!0,A=le.useMemo(()=>(z=!1,{id:D,initial:t,isPresent:i,custom:h,onExitComplete:Z=>{E.set(Z,!0);for(const Y of E.values())if(!Y)return;a&&a()},register:Z=>(E.set(Z,!1),()=>E.delete(Z))}),[i,E,a]);return p&&z&&(A={...A}),le.useMemo(()=>{E.forEach((Z,Y)=>E.set(Y,!1))},[i]),le.useEffect(()=>{!i&&!E.size&&a&&a()},[i]),m==="popLayout"&&(e=De.jsx(L5,{isPresent:i,anchorX:u,root:C,children:e})),De.jsx(bg.Provider,{value:A,children:e})};function B5(){return new Map}function YP(e=!0){const t=le.useContext(bg);if(t===null)return[!0,null];const{isPresent:i,onExitComplete:a,register:h}=t,p=le.useId();le.useEffect(()=>{if(e)return h(p)},[e]);const m=le.useCallback(()=>e&&a&&a(p),[p,a,e]);return!i&&a?[!1,m]:[!0]}const Kp=e=>e.key||"";function cS(e){const t=[];return le.Children.forEach(e,i=>{le.isValidElement(i)&&t.push(i)}),t}const JP=({children:e,custom:t,initial:i=!0,onExitComplete:a,presenceAffectsLayout:h=!0,mode:p="sync",propagate:m=!1,anchorX:u="left",root:C})=>{const[E,D]=YP(m),z=le.useMemo(()=>cS(e),[e]),A=m&&!E?[]:z.map(Kp),Z=le.useRef(!0),Y=le.useRef(z),te=jx(()=>new Map),[pe,U]=le.useState(z),[G,X]=le.useState(z);oP(()=>{Z.current=!1,Y.current=z;for(let ye=0;ye<G.length;ye++){const Se=Kp(G[ye]);A.includes(Se)?te.delete(Se):te.get(Se)!==!0&&te.set(Se,!1)}},[G,A.length,A.join("-")]);const ae=[];if(z!==pe){let ye=[...z];for(let Se=0;Se<G.length;Se++){const Ie=G[Se],Be=Kp(Ie);A.includes(Be)||(ye.splice(Se,0,Ie),ae.push(Ie))}return p==="wait"&&ae.length&&(ye=ae),X(cS(ye)),U(z),null}const{forceRender:_e}=le.useContext(Nx);return De.jsx(De.Fragment,{children:G.map(ye=>{const Se=Kp(ye),Ie=m&&!E?!1:z===G||A.includes(Se),Be=()=>{if(te.has(Se))te.set(Se,!0);else return;let Ue=!0;te.forEach(Ne=>{Ne||(Ue=!1)}),Ue&&(_e==null||_e(),X(Y.current),m&&(D==null||D()),a&&a())};return De.jsx(F5,{isPresent:Ie,initial:!Z.current||i?void 0:!1,custom:t,presenceAffectsLayout:h,mode:p,root:C,onExitComplete:Ie?void 0:Be,anchorX:u,children:ye},Se)})})},QP=le.createContext({strict:!1}),hS={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Bc={};for(const e in hS)Bc[e]={isEnabled:t=>hS[e].some(i=>!!t[i])};function O5(e){for(const t in e)Bc[t]={...Bc[t],...e[t]}}const V5=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Ym(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||V5.has(e)}let eE=e=>!Ym(e);function N5(e){typeof e=="function"&&(eE=t=>t.startsWith("on")?!Ym(t):e(t))}try{N5(require("@emotion/is-prop-valid").default)}catch{}function j5(e,t,i){const a={};for(const h in e)h==="values"&&typeof e.values=="object"||(eE(h)||i===!0&&Ym(h)||!t&&!Ym(h)||e.draggable&&h.startsWith("onDrag"))&&(a[h]=e[h]);return a}const wg=le.createContext({});function Sg(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function nf(e){return typeof e=="string"||Array.isArray(e)}const h1=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],d1=["initial",...h1];function Tg(e){return Sg(e.animate)||d1.some(t=>nf(e[t]))}function tE(e){return!!(Tg(e)||e.variants)}function $5(e,t){if(Tg(e)){const{initial:i,animate:a}=e;return{initial:i===!1||nf(i)?i:void 0,animate:nf(a)?a:void 0}}return e.inherit!==!1?t:{}}function U5(e){const{initial:t,animate:i}=$5(e,le.useContext(wg));return le.useMemo(()=>({initial:t,animate:i}),[dS(t),dS(i)])}function dS(e){return Array.isArray(e)?e.join(" "):e}const rf={};function G5(e){for(const t in e)rf[t]=e[t],Kx(t)&&(rf[t].isCSSVariable=!0)}function nE(e,{layout:t,layoutId:i}){return qc.has(e)||e.startsWith("origin")||(t||i!==void 0)&&(!!rf[e]||e==="opacity")}const q5={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Z5=Gc.length;function W5(e,t,i){let a="",h=!0;for(let p=0;p<Z5;p++){const m=Gc[p],u=e[m];if(u===void 0)continue;let C=!0;if(typeof u=="number"?C=u===(m.startsWith("scale")?1:0):C=parseFloat(u)===0,!C||i){const E=qP(u,a1[m]);if(!C){h=!1;const D=q5[m]||m;a+=`${D}(${E}) `}i&&(t[m]=E)}}return a=a.trim(),i?a=i(t,h?"":a):h&&(a="none"),a}function f1(e,t,i){const{style:a,vars:h,transformOrigin:p}=e;let m=!1,u=!1;for(const C in t){const E=t[C];if(qc.has(C)){m=!0;continue}else if(Kx(C)){h[C]=E;continue}else{const D=qP(E,a1[C]);C.startsWith("origin")?(u=!0,p[C]=D):a[C]=D}}if(t.transform||(m||i?a.transform=W5(t,e.transform,i):a.transform&&(a.transform="none")),u){const{originX:C="50%",originY:E="50%",originZ:D=0}=p;a.transformOrigin=`${C} ${E} ${D}`}}const p1=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function rE(e,t,i){for(const a in t)!jr(t[a])&&!nE(a,i)&&(e[a]=t[a])}function H5({transformTemplate:e},t){return le.useMemo(()=>{const i=p1();return f1(i,t,e),Object.assign({},i.vars,i.style)},[t])}function X5(e,t){const i=e.style||{},a={};return rE(a,i,e),Object.assign(a,H5(e,t)),a}function K5(e,t){const i={},a=X5(e,t);return e.drag&&e.dragListener!==!1&&(i.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(i.tabIndex=0),i.style=a,i}const Y5={offset:"stroke-dashoffset",array:"stroke-dasharray"},J5={offset:"strokeDashoffset",array:"strokeDasharray"};function Q5(e,t,i=1,a=0,h=!0){e.pathLength=1;const p=h?Y5:J5;e[p.offset]=Et.transform(-a);const m=Et.transform(t),u=Et.transform(i);e[p.array]=`${m} ${u}`}function iE(e,{attrX:t,attrY:i,attrScale:a,pathLength:h,pathSpacing:p=1,pathOffset:m=0,...u},C,E,D){if(f1(e,u,E),C){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:z,style:A}=e;z.transform&&(A.transform=z.transform,delete z.transform),(A.transform||z.transformOrigin)&&(A.transformOrigin=z.transformOrigin??"50% 50%",delete z.transformOrigin),A.transform&&(A.transformBox=(D==null?void 0:D.transformBox)??"fill-box",delete z.transformBox),t!==void 0&&(z.x=t),i!==void 0&&(z.y=i),a!==void 0&&(z.scale=a),h!==void 0&&Q5(z,h,p,m,!1)}const sE=()=>({...p1(),attrs:{}}),oE=e=>typeof e=="string"&&e.toLowerCase()==="svg";function e3(e,t,i,a){const h=le.useMemo(()=>{const p=sE();return iE(p,t,oE(a),e.transformTemplate,e.style),{...p.attrs,style:{...p.style}}},[t]);if(e.style){const p={};rE(p,e.style,e),h.style={...p,...h.style}}return h}const t3=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function m1(e){return typeof e!="string"||e.includes("-")?!1:!!(t3.indexOf(e)>-1||/[A-Z]/u.test(e))}function n3(e,t,i,{latestValues:a},h,p=!1){const u=(m1(e)?e3:K5)(t,a,h,e),C=j5(t,typeof e=="string",p),E=e!==le.Fragment?{...C,...u,ref:i}:{},{children:D}=t,z=le.useMemo(()=>jr(D)?D.get():D,[D]);return le.createElement(e,{...E,children:z})}function fS(e){const t=[{},{}];return e==null||e.values.forEach((i,a)=>{t[0][a]=i.get(),t[1][a]=i.getVelocity()}),t}function g1(e,t,i,a){if(typeof t=="function"){const[h,p]=fS(a);t=t(i!==void 0?i:e.custom,h,p)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[h,p]=fS(a);t=t(i!==void 0?i:e.custom,h,p)}return t}function mm(e){return jr(e)?e.get():e}function r3({scrapeMotionValuesFromProps:e,createRenderState:t},i,a,h){return{latestValues:i3(i,a,h,e),renderState:t()}}function i3(e,t,i,a){const h={},p=a(e,{});for(const A in p)h[A]=mm(p[A]);let{initial:m,animate:u}=e;const C=Tg(e),E=tE(e);t&&E&&!C&&e.inherit!==!1&&(m===void 0&&(m=t.initial),u===void 0&&(u=t.animate));let D=i?i.initial===!1:!1;D=D||m===!1;const z=D?u:m;if(z&&typeof z!="boolean"&&!Sg(z)){const A=Array.isArray(z)?z:[z];for(let Z=0;Z<A.length;Z++){const Y=g1(e,A[Z]);if(Y){const{transitionEnd:te,transition:pe,...U}=Y;for(const G in U){let X=U[G];if(Array.isArray(X)){const ae=D?X.length-1:0;X=X[ae]}X!==null&&(h[G]=X)}for(const G in te)h[G]=te[G]}}}return h}const aE=e=>(t,i)=>{const a=le.useContext(wg),h=le.useContext(bg),p=()=>r3(e,t,a,h);return i?p():jx(p)};function y1(e,t,i){var p;const{style:a}=e,h={};for(const m in a)(jr(a[m])||t.style&&jr(t.style[m])||nE(m,e)||((p=i==null?void 0:i.getValue(m))==null?void 0:p.liveStyle)!==void 0)&&(h[m]=a[m]);return h}const s3=aE({scrapeMotionValuesFromProps:y1,createRenderState:p1});function lE(e,t,i){const a=y1(e,t,i);for(const h in e)if(jr(e[h])||jr(t[h])){const p=Gc.indexOf(h)!==-1?"attr"+h.charAt(0).toUpperCase()+h.substring(1):h;a[p]=e[h]}return a}const o3=aE({scrapeMotionValuesFromProps:lE,createRenderState:sE}),a3=Symbol.for("motionComponentSymbol");function mc(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function l3(e,t,i){return le.useCallback(a=>{a&&e.onMount&&e.onMount(a),t&&(a?t.mount(a):t.unmount()),i&&(typeof i=="function"?i(a):mc(i)&&(i.current=a))},[t])}const _1=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),u3="framerAppearId",uE="data-"+_1(u3),cE=le.createContext({});function c3(e,t,i,a,h){var te,pe;const{visualElement:p}=le.useContext(wg),m=le.useContext(QP),u=le.useContext(bg),C=le.useContext(c1).reducedMotion,E=le.useRef(null);a=a||m.renderer,!E.current&&a&&(E.current=a(e,{visualState:t,parent:p,props:i,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:C}));const D=E.current,z=le.useContext(cE);D&&!D.projection&&h&&(D.type==="html"||D.type==="svg")&&h3(E.current,i,h,z);const A=le.useRef(!1);le.useInsertionEffect(()=>{D&&A.current&&D.update(i,u)});const Z=i[uE],Y=le.useRef(!!Z&&!((te=window.MotionHandoffIsComplete)!=null&&te.call(window,Z))&&((pe=window.MotionHasOptimisedAnimation)==null?void 0:pe.call(window,Z)));return oP(()=>{D&&(A.current=!0,window.MotionIsMounted=!0,D.updateFeatures(),D.scheduleRenderMicrotask(),Y.current&&D.animationState&&D.animationState.animateChanges())}),le.useEffect(()=>{D&&(!Y.current&&D.animationState&&D.animationState.animateChanges(),Y.current&&(queueMicrotask(()=>{var U;(U=window.MotionHandoffMarkAsComplete)==null||U.call(window,Z)}),Y.current=!1),D.enteringChildren=void 0)}),D}function h3(e,t,i,a){const{layoutId:h,layout:p,drag:m,dragConstraints:u,layoutScroll:C,layoutRoot:E,layoutCrossfade:D}=t;e.projection=new i(e.latestValues,t["data-framer-portal-id"]?void 0:hE(e.parent)),e.projection.setOptions({layoutId:h,layout:p,alwaysMeasureLayout:!!m||u&&mc(u),visualElement:e,animationType:typeof p=="string"?p:"both",initialPromotionConfig:a,crossfade:D,layoutScroll:C,layoutRoot:E})}function hE(e){if(e)return e.options.allowProjection!==!1?e.projection:hE(e.parent)}function tv(e,{forwardMotionProps:t=!1}={},i,a){i&&O5(i);const h=m1(e)?o3:s3;function p(u,C){let E;const D={...le.useContext(c1),...u,layoutId:d3(u)},{isStatic:z}=D,A=U5(u),Z=h(u,z);if(!z&&$x){f3();const Y=p3(D);E=Y.MeasureLayout,A.visualElement=c3(e,Z,D,a,Y.ProjectionNode)}return De.jsxs(wg.Provider,{value:A,children:[E&&A.visualElement?De.jsx(E,{visualElement:A.visualElement,...D}):null,n3(e,u,l3(Z,A.visualElement,C),Z,z,t)]})}p.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const m=le.forwardRef(p);return m[a3]=e,m}function d3({layoutId:e}){const t=le.useContext(Nx).id;return t&&e!==void 0?t+"-"+e:e}function f3(e,t){le.useContext(QP).strict}function p3(e){const{drag:t,layout:i}=Bc;if(!t&&!i)return{};const a={...t,...i};return{MeasureLayout:t!=null&&t.isEnabled(e)||i!=null&&i.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}function m3(e,t){if(typeof Proxy>"u")return tv;const i=new Map,a=(p,m)=>tv(p,m,e,t),h=(p,m)=>a(p,m);return new Proxy(h,{get:(p,m)=>m==="create"?a:(i.has(m)||i.set(m,tv(m,void 0,e,t)),i.get(m))})}function dE({top:e,left:t,right:i,bottom:a}){return{x:{min:t,max:i},y:{min:e,max:a}}}function g3({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function y3(e,t){if(!t)return e;const i=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:i.y,left:i.x,bottom:a.y,right:a.x}}function nv(e){return e===void 0||e===1}function T0({scale:e,scaleX:t,scaleY:i}){return!nv(e)||!nv(t)||!nv(i)}function Al(e){return T0(e)||fE(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function fE(e){return pS(e.x)||pS(e.y)}function pS(e){return e&&e!=="0%"}function Jm(e,t,i){const a=e-i,h=t*a;return i+h}function mS(e,t,i,a,h){return h!==void 0&&(e=Jm(e,h,a)),Jm(e,i,a)+t}function C0(e,t=0,i=1,a,h){e.min=mS(e.min,t,i,a,h),e.max=mS(e.max,t,i,a,h)}function pE(e,{x:t,y:i}){C0(e.x,t.translate,t.scale,t.originPoint),C0(e.y,i.translate,i.scale,i.originPoint)}const gS=.999999999999,yS=1.0000000000001;function _3(e,t,i,a=!1){const h=i.length;if(!h)return;t.x=t.y=1;let p,m;for(let u=0;u<h;u++){p=i[u],m=p.projectionDelta;const{visualElement:C}=p.options;C&&C.props.style&&C.props.style.display==="contents"||(a&&p.options.layoutScroll&&p.scroll&&p!==p.root&&yc(e,{x:-p.scroll.offset.x,y:-p.scroll.offset.y}),m&&(t.x*=m.x.scale,t.y*=m.y.scale,pE(e,m)),a&&Al(p.latestValues)&&yc(e,p.latestValues))}t.x<yS&&t.x>gS&&(t.x=1),t.y<yS&&t.y>gS&&(t.y=1)}function gc(e,t){e.min=e.min+t,e.max=e.max+t}function _S(e,t,i,a,h=.5){const p=Mn(e.min,e.max,h);C0(e,t,i,p,a)}function yc(e,t){_S(e.x,t.x,t.scaleX,t.scale,t.originX),_S(e.y,t.y,t.scaleY,t.scale,t.originY)}function mE(e,t){return dE(y3(e.getBoundingClientRect(),t))}function v3(e,t,i){const a=mE(e,i),{scroll:h}=t;return h&&(gc(a.x,h.offset.x),gc(a.y,h.offset.y)),a}const vS=()=>({translate:0,scale:1,origin:0,originPoint:0}),_c=()=>({x:vS(),y:vS()}),xS=()=>({min:0,max:0}),$n=()=>({x:xS(),y:xS()}),k0={current:null},gE={current:!1};function x3(){if(gE.current=!0,!!$x)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>k0.current=e.matches;e.addEventListener("change",t),t()}else k0.current=!1}const b3=new WeakMap;function w3(e,t,i){for(const a in t){const h=t[a],p=i[a];if(jr(h))e.addValue(a,h);else if(jr(p))e.addValue(a,Fc(h,{owner:e}));else if(p!==h)if(e.hasValue(a)){const m=e.getValue(a);m.liveStyle===!0?m.jump(h):m.hasAnimated||m.set(h)}else{const m=e.getStaticValue(a);e.addValue(a,Fc(m!==void 0?m:h,{owner:e}))}}for(const a in i)t[a]===void 0&&e.removeValue(a);return t}const bS=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class S3{scrapeMotionValuesFromProps(t,i,a){return{}}constructor({parent:t,props:i,presenceContext:a,reducedMotionConfig:h,blockInitialAnimation:p,visualState:m},u={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=s1,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const A=vi.now();this.renderScheduledAt<A&&(this.renderScheduledAt=A,kn.render(this.render,!1,!0))};const{latestValues:C,renderState:E}=m;this.latestValues=C,this.baseTarget={...C},this.initialValues=i.initial?{...C}:{},this.renderState=E,this.parent=t,this.props=i,this.presenceContext=a,this.depth=t?t.depth+1:0,this.reducedMotionConfig=h,this.options=u,this.blockInitialAnimation=!!p,this.isControllingVariants=Tg(i),this.isVariantNode=tE(i),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:D,...z}=this.scrapeMotionValuesFromProps(i,{},this);for(const A in z){const Z=z[A];C[A]!==void 0&&jr(Z)&&Z.set(C[A])}}mount(t){var i;this.current=t,b3.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,h)=>this.bindToMotionValue(h,a)),gE.current||x3(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:k0.current,(i=this.parent)==null||i.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),Ua(this.notifyUpdate),Ua(this.render),this.valueSubscriptions.forEach(i=>i()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const i in this.events)this.events[i].clear();for(const i in this.features){const a=this.features[i];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,i){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const a=qc.has(t);a&&this.onBindTransform&&this.onBindTransform();const h=i.on("change",m=>{this.latestValues[t]=m,this.props.onUpdate&&kn.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let p;window.MotionCheckAppearSync&&(p=window.MotionCheckAppearSync(this,t,i)),this.valueSubscriptions.set(t,()=>{h(),p&&p(),i.owner&&i.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Bc){const i=Bc[t];if(!i)continue;const{isEnabled:a,Feature:h}=i;if(!this.features[t]&&h&&a(this.props)&&(this.features[t]=new h(this)),this.features[t]){const p=this.features[t];p.isMounted?p.update():(p.mount(),p.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):$n()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,i){this.latestValues[t]=i}update(t,i){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=i;for(let a=0;a<bS.length;a++){const h=bS[a];this.propEventSubscriptions[h]&&(this.propEventSubscriptions[h](),delete this.propEventSubscriptions[h]);const p="on"+h,m=t[p];m&&(this.propEventSubscriptions[h]=this.on(h,m))}this.prevMotionValues=w3(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const i=this.getClosestVariantNode();if(i)return i.variantChildren&&i.variantChildren.add(t),()=>i.variantChildren.delete(t)}addValue(t,i){const a=this.values.get(t);i!==a&&(a&&this.removeValue(t),this.bindToMotionValue(t,i),this.values.set(t,i),this.latestValues[t]=i.get())}removeValue(t){this.values.delete(t);const i=this.valueSubscriptions.get(t);i&&(i(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,i){if(this.props.values&&this.props.values[t])return this.props.values[t];let a=this.values.get(t);return a===void 0&&i!==void 0&&(a=Fc(i===null?void 0:i,{owner:this}),this.addValue(t,a)),a}readValue(t,i){let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(aP(a)||uP(a))?a=parseFloat(a):!D5(a)&&Ga.test(i)&&(a=GP(t,i)),this.setBaseTarget(t,jr(a)?a.get():a)),jr(a)?a.get():a}setBaseTarget(t,i){this.baseTarget[t]=i}getBaseTarget(t){var p;const{initial:i}=this.props;let a;if(typeof i=="string"||typeof i=="object"){const m=g1(this.props,i,(p=this.presenceContext)==null?void 0:p.custom);m&&(a=m[t])}if(i&&a!==void 0)return a;const h=this.getBaseTargetFromProps(this.props,t);return h!==void 0&&!jr(h)?h:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,i){return this.events[t]||(this.events[t]=new Wx),this.events[t].add(i)}notify(t,...i){this.events[t]&&this.events[t].notify(...i)}scheduleRenderMicrotask(){l1.render(this.render)}}class yE extends S3{constructor(){super(...arguments),this.KeyframeResolver=b5}sortInstanceNodePosition(t,i){return t.compareDocumentPosition(i)&2?1:-1}getBaseTargetFromProps(t,i){return t.style?t.style[i]:void 0}removeValueFromRenderState(t,{vars:i,style:a}){delete i[t],delete a[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;jr(t)&&(this.childSubscription=t.on("change",i=>{this.current&&(this.current.textContent=`${i}`)}))}}function _E(e,{style:t,vars:i},a,h){const p=e.style;let m;for(m in t)p[m]=t[m];h==null||h.applyProjectionStyles(p,a);for(m in i)p.setProperty(m,i[m])}function T3(e){return window.getComputedStyle(e)}class C3 extends yE{constructor(){super(...arguments),this.type="html",this.renderInstance=_E}readValueFromInstance(t,i){var a;if(qc.has(i))return(a=this.projection)!=null&&a.isProjecting?y0(i):NL(t,i);{const h=T3(t),p=(Kx(i)?h.getPropertyValue(i):h[i])||0;return typeof p=="string"?p.trim():p}}measureInstanceViewportBox(t,{transformPagePoint:i}){return mE(t,i)}build(t,i,a){f1(t,i,a.transformTemplate)}scrapeMotionValuesFromProps(t,i,a){return y1(t,i,a)}}const vE=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function k3(e,t,i,a){_E(e,t,void 0,a);for(const h in t.attrs)e.setAttribute(vE.has(h)?h:_1(h),t.attrs[h])}class P3 extends yE{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=$n}getBaseTargetFromProps(t,i){return t[i]}readValueFromInstance(t,i){if(qc.has(i)){const a=UP(i);return a&&a.default||0}return i=vE.has(i)?i:_1(i),t.getAttribute(i)}scrapeMotionValuesFromProps(t,i,a){return lE(t,i,a)}build(t,i,a){iE(t,i,this.isSVGTag,a.transformTemplate,a.style)}renderInstance(t,i,a,h){k3(t,i,a,h)}mount(t){this.isSVGTag=oE(t.tagName),super.mount(t)}}const E3=(e,t)=>m1(e)?new P3(t):new C3(t,{allowProjection:e!==le.Fragment});function Cc(e,t,i){const a=e.getProps();return g1(a,t,i!==void 0?i:a.custom,e)}const P0=e=>Array.isArray(e);function I3(e,t,i){e.hasValue(t)?e.getValue(t).set(i):e.addValue(t,Fc(i))}function M3(e){return P0(e)?e[e.length-1]||0:e}function A3(e,t){const i=Cc(e,t);let{transitionEnd:a={},transition:h={},...p}=i||{};p={...p,...a};for(const m in p){const u=M3(p[m]);I3(e,m,u)}}function z3(e){return!!(jr(e)&&e.add)}function E0(e,t){const i=e.getValue("willChange");if(z3(i))return i.add(t);if(!i&&Vo.WillChange){const a=new Vo.WillChange("auto");e.addValue("willChange",a),a.add(t)}}function xE(e){return e.props[uE]}const D3=e=>e!==null;function R3(e,{repeat:t,repeatType:i="loop"},a){const h=e.filter(D3),p=t&&i!=="loop"&&t%2===1?0:h.length-1;return h[p]}const L3={type:"spring",stiffness:500,damping:25,restSpeed:10},F3=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),B3={type:"keyframes",duration:.8},O3={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},V3=(e,{keyframes:t})=>t.length>2?B3:qc.has(e)?e.startsWith("scale")?F3(t[1]):L3:O3;function N3({when:e,delay:t,delayChildren:i,staggerChildren:a,staggerDirection:h,repeat:p,repeatType:m,repeatDelay:u,from:C,elapsed:E,...D}){return!!Object.keys(D).length}const v1=(e,t,i,a={},h,p)=>m=>{const u=o1(a,e)||{},C=u.delay||a.delay||0;let{elapsed:E=0}=a;E=E-no(C);const D={keyframes:Array.isArray(i)?i:[null,i],ease:"easeOut",velocity:t.getVelocity(),...u,delay:-E,onUpdate:A=>{t.set(A),u.onUpdate&&u.onUpdate(A)},onComplete:()=>{m(),u.onComplete&&u.onComplete()},name:e,motionValue:t,element:p?void 0:h};N3(u)||Object.assign(D,V3(e,D)),D.duration&&(D.duration=no(D.duration)),D.repeatDelay&&(D.repeatDelay=no(D.repeatDelay)),D.from!==void 0&&(D.keyframes[0]=D.from);let z=!1;if((D.type===!1||D.duration===0&&!D.repeatDelay)&&(w0(D),D.delay===0&&(z=!0)),(Vo.instantAnimations||Vo.skipAnimations)&&(z=!0,w0(D),D.delay=0),D.allowFlatten=!u.type&&!u.ease,z&&!p&&t.get()!==void 0){const A=R3(D.keyframes,u);if(A!==void 0){kn.update(()=>{D.onUpdate(A),D.onComplete()});return}}return u.isSync?new i1(D):new u5(D)};function j3({protectedKeys:e,needsAnimating:t},i){const a=e.hasOwnProperty(i)&&t[i]!==!0;return t[i]=!1,a}function bE(e,t,{delay:i=0,transitionOverride:a,type:h}={}){let{transition:p=e.getDefaultTransition(),transitionEnd:m,...u}=t;a&&(p=a);const C=[],E=h&&e.animationState&&e.animationState.getState()[h];for(const D in u){const z=e.getValue(D,e.latestValues[D]??null),A=u[D];if(A===void 0||E&&j3(E,D))continue;const Z={delay:i,...o1(p||{},D)},Y=z.get();if(Y!==void 0&&!z.isAnimating&&!Array.isArray(A)&&A===Y&&!Z.velocity)continue;let te=!1;if(window.MotionHandoffAnimation){const U=xE(e);if(U){const G=window.MotionHandoffAnimation(U,D,kn);G!==null&&(Z.startTime=G,te=!0)}}E0(e,D),z.start(v1(D,z,A,e.shouldReduceMotion&&NP.has(D)?{type:!1}:Z,e,te));const pe=z.animation;pe&&C.push(pe)}return m&&Promise.all(C).then(()=>{kn.update(()=>{m&&A3(e,m)})}),C}function wE(e,t,i,a=0,h=1){const p=Array.from(e).sort((E,D)=>E.sortNodePosition(D)).indexOf(t),m=e.size,u=(m-1)*a;return typeof i=="function"?i(p,m):h===1?p*a:u-p*a}function I0(e,t,i={}){var C;const a=Cc(e,t,i.type==="exit"?(C=e.presenceContext)==null?void 0:C.custom:void 0);let{transition:h=e.getDefaultTransition()||{}}=a||{};i.transitionOverride&&(h=i.transitionOverride);const p=a?()=>Promise.all(bE(e,a,i)):()=>Promise.resolve(),m=e.variantChildren&&e.variantChildren.size?(E=0)=>{const{delayChildren:D=0,staggerChildren:z,staggerDirection:A}=h;return $3(e,t,E,D,z,A,i)}:()=>Promise.resolve(),{when:u}=h;if(u){const[E,D]=u==="beforeChildren"?[p,m]:[m,p];return E().then(()=>D())}else return Promise.all([p(),m(i.delay)])}function $3(e,t,i=0,a=0,h=0,p=1,m){const u=[];for(const C of e.variantChildren)C.notify("AnimationStart",t),u.push(I0(C,t,{...m,delay:i+(typeof a=="function"?0:a)+wE(e.variantChildren,C,a,h,p)}).then(()=>C.notify("AnimationComplete",t)));return Promise.all(u)}function U3(e,t,i={}){e.notify("AnimationStart",t);let a;if(Array.isArray(t)){const h=t.map(p=>I0(e,p,i));a=Promise.all(h)}else if(typeof t=="string")a=I0(e,t,i);else{const h=typeof t=="function"?Cc(e,t,i.custom):t;a=Promise.all(bE(e,h,i))}return a.then(()=>{e.notify("AnimationComplete",t)})}function SE(e,t){if(!Array.isArray(t))return!1;const i=t.length;if(i!==e.length)return!1;for(let a=0;a<i;a++)if(t[a]!==e[a])return!1;return!0}const G3=d1.length;function TE(e){if(!e)return;if(!e.isControllingVariants){const i=e.parent?TE(e.parent)||{}:{};return e.props.initial!==void 0&&(i.initial=e.props.initial),i}const t={};for(let i=0;i<G3;i++){const a=d1[i],h=e.props[a];(nf(h)||h===!1)&&(t[a]=h)}return t}const q3=[...h1].reverse(),Z3=h1.length;function W3(e){return t=>Promise.all(t.map(({animation:i,options:a})=>U3(e,i,a)))}function H3(e){let t=W3(e),i=wS(),a=!0;const h=C=>(E,D)=>{var A;const z=Cc(e,D,C==="exit"?(A=e.presenceContext)==null?void 0:A.custom:void 0);if(z){const{transition:Z,transitionEnd:Y,...te}=z;E={...E,...te,...Y}}return E};function p(C){t=C(e)}function m(C){const{props:E}=e,D=TE(e.parent)||{},z=[],A=new Set;let Z={},Y=1/0;for(let pe=0;pe<Z3;pe++){const U=q3[pe],G=i[U],X=E[U]!==void 0?E[U]:D[U],ae=nf(X),_e=U===C?G.isActive:null;_e===!1&&(Y=pe);let ye=X===D[U]&&X!==E[U]&&ae;if(ye&&a&&e.manuallyAnimateOnMount&&(ye=!1),G.protectedKeys={...Z},!G.isActive&&_e===null||!X&&!G.prevProp||Sg(X)||typeof X=="boolean")continue;const Se=X3(G.prevProp,X);let Ie=Se||U===C&&G.isActive&&!ye&&ae||pe>Y&&ae,Be=!1;const Ue=Array.isArray(X)?X:[X];let Ne=Ue.reduce(h(U),{});_e===!1&&(Ne={});const{prevResolvedValues:J={}}=G,je={...J,...Ne},Fe=bt=>{Ie=!0,A.has(bt)&&(Be=!0,A.delete(bt)),G.needsAnimating[bt]=!0;const Oe=e.getValue(bt);Oe&&(Oe.liveStyle=!1)};for(const bt in je){const Oe=Ne[bt],tt=J[bt];if(Z.hasOwnProperty(bt))continue;let gt=!1;P0(Oe)&&P0(tt)?gt=!SE(Oe,tt):gt=Oe!==tt,gt?Oe!=null?Fe(bt):A.add(bt):Oe!==void 0&&A.has(bt)?Fe(bt):G.protectedKeys[bt]=!0}G.prevProp=X,G.prevResolvedValues=Ne,G.isActive&&(Z={...Z,...Ne}),a&&e.blockInitialAnimation&&(Ie=!1);const ft=ye&&Se;Ie&&(!ft||Be)&&z.push(...Ue.map(bt=>{const Oe={type:U};if(typeof bt=="string"&&a&&!ft&&e.manuallyAnimateOnMount&&e.parent){const{parent:tt}=e,gt=Cc(tt,bt);if(tt.enteringChildren&&gt){const{delayChildren:Pt}=gt.transition||{};Oe.delay=wE(tt.enteringChildren,e,Pt)}}return{animation:bt,options:Oe}}))}if(A.size){const pe={};if(typeof E.initial!="boolean"){const U=Cc(e,Array.isArray(E.initial)?E.initial[0]:E.initial);U&&U.transition&&(pe.transition=U.transition)}A.forEach(U=>{const G=e.getBaseTarget(U),X=e.getValue(U);X&&(X.liveStyle=!0),pe[U]=G??null}),z.push({animation:pe})}let te=!!z.length;return a&&(E.initial===!1||E.initial===E.animate)&&!e.manuallyAnimateOnMount&&(te=!1),a=!1,te?t(z):Promise.resolve()}function u(C,E){var z;if(i[C].isActive===E)return Promise.resolve();(z=e.variantChildren)==null||z.forEach(A=>{var Z;return(Z=A.animationState)==null?void 0:Z.setActive(C,E)}),i[C].isActive=E;const D=m(C);for(const A in i)i[A].protectedKeys={};return D}return{animateChanges:m,setActive:u,setAnimateFunction:p,getState:()=>i,reset:()=>{i=wS(),a=!0}}}function X3(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!SE(t,e):!1}function Cl(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function wS(){return{animate:Cl(!0),whileInView:Cl(),whileHover:Cl(),whileTap:Cl(),whileDrag:Cl(),whileFocus:Cl(),exit:Cl()}}class Xa{constructor(t){this.isMounted=!1,this.node=t}update(){}}class K3 extends Xa{constructor(t){super(t),t.animationState||(t.animationState=H3(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Sg(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:i}=this.node.prevProps||{};t!==i&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let Y3=0;class J3 extends Xa{constructor(){super(...arguments),this.id=Y3++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:i}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const h=this.node.animationState.setActive("exit",!t);i&&!t&&h.then(()=>{i(this.id)})}mount(){const{register:t,onExitComplete:i}=this.node.presenceContext||{};i&&i(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const Q3={animation:{Feature:K3},exit:{Feature:J3}};function sf(e,t,i,a={passive:!0}){return e.addEventListener(t,i,a),()=>e.removeEventListener(t,i)}function bf(e){return{point:{x:e.pageX,y:e.pageY}}}const e4=e=>t=>u1(t)&&e(t,bf(t));function zd(e,t,i,a){return sf(e,t,e4(i),a)}const CE=1e-4,t4=1-CE,n4=1+CE,kE=.01,r4=0-kE,i4=0+kE;function ti(e){return e.max-e.min}function s4(e,t,i){return Math.abs(e-t)<=i}function SS(e,t,i,a=.5){e.origin=a,e.originPoint=Mn(t.min,t.max,e.origin),e.scale=ti(i)/ti(t),e.translate=Mn(i.min,i.max,e.origin)-e.originPoint,(e.scale>=t4&&e.scale<=n4||isNaN(e.scale))&&(e.scale=1),(e.translate>=r4&&e.translate<=i4||isNaN(e.translate))&&(e.translate=0)}function Dd(e,t,i,a){SS(e.x,t.x,i.x,a?a.originX:void 0),SS(e.y,t.y,i.y,a?a.originY:void 0)}function TS(e,t,i){e.min=i.min+t.min,e.max=e.min+ti(t)}function o4(e,t,i){TS(e.x,t.x,i.x),TS(e.y,t.y,i.y)}function CS(e,t,i){e.min=t.min-i.min,e.max=e.min+ti(t)}function Rd(e,t,i){CS(e.x,t.x,i.x),CS(e.y,t.y,i.y)}function as(e){return[e("x"),e("y")]}const PE=({current:e})=>e?e.ownerDocument.defaultView:null,kS=(e,t)=>Math.abs(e-t);function a4(e,t){const i=kS(e.x,t.x),a=kS(e.y,t.y);return Math.sqrt(i**2+a**2)}class EE{constructor(t,i,{transformPagePoint:a,contextWindow:h=window,dragSnapToOrigin:p=!1,distanceThreshold:m=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const A=iv(this.lastMoveEventInfo,this.history),Z=this.startEvent!==null,Y=a4(A.offset,{x:0,y:0})>=this.distanceThreshold;if(!Z&&!Y)return;const{point:te}=A,{timestamp:pe}=Tr;this.history.push({...te,timestamp:pe});const{onStart:U,onMove:G}=this.handlers;Z||(U&&U(this.lastMoveEvent,A),this.startEvent=this.lastMoveEvent),G&&G(this.lastMoveEvent,A)},this.handlePointerMove=(A,Z)=>{this.lastMoveEvent=A,this.lastMoveEventInfo=rv(Z,this.transformPagePoint),kn.update(this.updatePoint,!0)},this.handlePointerUp=(A,Z)=>{this.end();const{onEnd:Y,onSessionEnd:te,resumeAnimation:pe}=this.handlers;if(this.dragSnapToOrigin&&pe&&pe(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const U=iv(A.type==="pointercancel"?this.lastMoveEventInfo:rv(Z,this.transformPagePoint),this.history);this.startEvent&&Y&&Y(A,U),te&&te(A,U)},!u1(t))return;this.dragSnapToOrigin=p,this.handlers=i,this.transformPagePoint=a,this.distanceThreshold=m,this.contextWindow=h||window;const u=bf(t),C=rv(u,this.transformPagePoint),{point:E}=C,{timestamp:D}=Tr;this.history=[{...E,timestamp:D}];const{onSessionStart:z}=i;z&&z(t,iv(C,this.history)),this.removeListeners=_f(zd(this.contextWindow,"pointermove",this.handlePointerMove),zd(this.contextWindow,"pointerup",this.handlePointerUp),zd(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Ua(this.updatePoint)}}function rv(e,t){return t?{point:t(e.point)}:e}function PS(e,t){return{x:e.x-t.x,y:e.y-t.y}}function iv({point:e},t){return{point:e,delta:PS(e,IE(t)),offset:PS(e,l4(t)),velocity:u4(t,.1)}}function l4(e){return e[0]}function IE(e){return e[e.length-1]}function u4(e,t){if(e.length<2)return{x:0,y:0};let i=e.length-1,a=null;const h=IE(e);for(;i>=0&&(a=e[i],!(h.timestamp-a.timestamp>no(t)));)i--;if(!a)return{x:0,y:0};const p=ro(h.timestamp-a.timestamp);if(p===0)return{x:0,y:0};const m={x:(h.x-a.x)/p,y:(h.y-a.y)/p};return m.x===1/0&&(m.x=0),m.y===1/0&&(m.y=0),m}function c4(e,{min:t,max:i},a){return t!==void 0&&e<t?e=a?Mn(t,e,a.min):Math.max(e,t):i!==void 0&&e>i&&(e=a?Mn(i,e,a.max):Math.min(e,i)),e}function ES(e,t,i){return{min:t!==void 0?e.min+t:void 0,max:i!==void 0?e.max+i-(e.max-e.min):void 0}}function h4(e,{top:t,left:i,bottom:a,right:h}){return{x:ES(e.x,i,h),y:ES(e.y,t,a)}}function IS(e,t){let i=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([i,a]=[a,i]),{min:i,max:a}}function d4(e,t){return{x:IS(e.x,t.x),y:IS(e.y,t.y)}}function f4(e,t){let i=.5;const a=ti(e),h=ti(t);return h>a?i=Qd(t.min,t.max-a,e.min):a>h&&(i=Qd(e.min,e.max-h,t.min)),Oo(0,1,i)}function p4(e,t){const i={};return t.min!==void 0&&(i.min=t.min-e.min),t.max!==void 0&&(i.max=t.max-e.min),i}const M0=.35;function m4(e=M0){return e===!1?e=0:e===!0&&(e=M0),{x:MS(e,"left","right"),y:MS(e,"top","bottom")}}function MS(e,t,i){return{min:AS(e,t),max:AS(e,i)}}function AS(e,t){return typeof e=="number"?e:e[t]||0}const g4=new WeakMap;class y4{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=$n(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:i=!1,distanceThreshold:a}={}){const{presenceContext:h}=this.visualElement;if(h&&h.isPresent===!1)return;const p=z=>{const{dragSnapToOrigin:A}=this.getProps();A?this.pauseAnimation():this.stopAnimation(),i&&this.snapToCursor(bf(z).point)},m=(z,A)=>{const{drag:Z,dragPropagation:Y,onDragStart:te}=this.getProps();if(Z&&!Y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=C5(Z),!this.openDragLock))return;this.latestPointerEvent=z,this.latestPanInfo=A,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),as(U=>{let G=this.getAxisMotionValue(U).get()||0;if(io.test(G)){const{projection:X}=this.visualElement;if(X&&X.layout){const ae=X.layout.layoutBox[U];ae&&(G=ti(ae)*(parseFloat(G)/100))}}this.originPoint[U]=G}),te&&kn.postRender(()=>te(z,A)),E0(this.visualElement,"transform");const{animationState:pe}=this.visualElement;pe&&pe.setActive("whileDrag",!0)},u=(z,A)=>{this.latestPointerEvent=z,this.latestPanInfo=A;const{dragPropagation:Z,dragDirectionLock:Y,onDirectionLock:te,onDrag:pe}=this.getProps();if(!Z&&!this.openDragLock)return;const{offset:U}=A;if(Y&&this.currentDirection===null){this.currentDirection=_4(U),this.currentDirection!==null&&te&&te(this.currentDirection);return}this.updateAxis("x",A.point,U),this.updateAxis("y",A.point,U),this.visualElement.render(),pe&&pe(z,A)},C=(z,A)=>{this.latestPointerEvent=z,this.latestPanInfo=A,this.stop(z,A),this.latestPointerEvent=null,this.latestPanInfo=null},E=()=>as(z=>{var A;return this.getAnimationState(z)==="paused"&&((A=this.getAxisMotionValue(z).animation)==null?void 0:A.play())}),{dragSnapToOrigin:D}=this.getProps();this.panSession=new EE(t,{onSessionStart:p,onStart:m,onMove:u,onSessionEnd:C,resumeAnimation:E},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:D,distanceThreshold:a,contextWindow:PE(this.visualElement)})}stop(t,i){const a=t||this.latestPointerEvent,h=i||this.latestPanInfo,p=this.isDragging;if(this.cancel(),!p||!h||!a)return;const{velocity:m}=h;this.startAnimation(m);const{onDragEnd:u}=this.getProps();u&&kn.postRender(()=>u(a,h))}cancel(){this.isDragging=!1;const{projection:t,animationState:i}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),i&&i.setActive("whileDrag",!1)}updateAxis(t,i,a){const{drag:h}=this.getProps();if(!a||!Yp(t,h,this.currentDirection))return;const p=this.getAxisMotionValue(t);let m=this.originPoint[t]+a[t];this.constraints&&this.constraints[t]&&(m=c4(m,this.constraints[t],this.elastic[t])),p.set(m)}resolveConstraints(){var p;const{dragConstraints:t,dragElastic:i}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(p=this.visualElement.projection)==null?void 0:p.layout,h=this.constraints;t&&mc(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&a?this.constraints=h4(a.layoutBox,t):this.constraints=!1,this.elastic=m4(i),h!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&as(m=>{this.constraints!==!1&&this.getAxisMotionValue(m)&&(this.constraints[m]=p4(a.layoutBox[m],this.constraints[m]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:i}=this.getProps();if(!t||!mc(t))return!1;const a=t.current,{projection:h}=this.visualElement;if(!h||!h.layout)return!1;const p=v3(a,h.root,this.visualElement.getTransformPagePoint());let m=d4(h.layout.layoutBox,p);if(i){const u=i(g3(m));this.hasMutatedConstraints=!!u,u&&(m=dE(u))}return m}startAnimation(t){const{drag:i,dragMomentum:a,dragElastic:h,dragTransition:p,dragSnapToOrigin:m,onDragTransitionEnd:u}=this.getProps(),C=this.constraints||{},E=as(D=>{if(!Yp(D,i,this.currentDirection))return;let z=C&&C[D]||{};m&&(z={min:0,max:0});const A=h?200:1e6,Z=h?40:1e7,Y={type:"inertia",velocity:a?t[D]:0,bounceStiffness:A,bounceDamping:Z,timeConstant:750,restDelta:1,restSpeed:10,...p,...z};return this.startAxisValueAnimation(D,Y)});return Promise.all(E).then(u)}startAxisValueAnimation(t,i){const a=this.getAxisMotionValue(t);return E0(this.visualElement,t),a.start(v1(t,a,0,i,this.visualElement,!1))}stopAnimation(){as(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){as(t=>{var i;return(i=this.getAxisMotionValue(t).animation)==null?void 0:i.pause()})}getAnimationState(t){var i;return(i=this.getAxisMotionValue(t).animation)==null?void 0:i.state}getAxisMotionValue(t){const i=`_drag${t.toUpperCase()}`,a=this.visualElement.getProps(),h=a[i];return h||this.visualElement.getValue(t,(a.initial?a.initial[t]:void 0)||0)}snapToCursor(t){as(i=>{const{drag:a}=this.getProps();if(!Yp(i,a,this.currentDirection))return;const{projection:h}=this.visualElement,p=this.getAxisMotionValue(i);if(h&&h.layout){const{min:m,max:u}=h.layout.layoutBox[i];p.set(t[i]-Mn(m,u,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:i}=this.getProps(),{projection:a}=this.visualElement;if(!mc(i)||!a||!this.constraints)return;this.stopAnimation();const h={x:0,y:0};as(m=>{const u=this.getAxisMotionValue(m);if(u&&this.constraints!==!1){const C=u.get();h[m]=f4({min:C,max:C},this.constraints[m])}});const{transformTemplate:p}=this.visualElement.getProps();this.visualElement.current.style.transform=p?p({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),as(m=>{if(!Yp(m,t,null))return;const u=this.getAxisMotionValue(m),{min:C,max:E}=this.constraints[m];u.set(Mn(C,E,h[m]))})}addListeners(){if(!this.visualElement.current)return;g4.set(this.visualElement,this);const t=this.visualElement.current,i=zd(t,"pointerdown",C=>{const{drag:E,dragListener:D=!0}=this.getProps();E&&D&&this.start(C)}),a=()=>{const{dragConstraints:C}=this.getProps();mc(C)&&C.current&&(this.constraints=this.resolveRefConstraints())},{projection:h}=this.visualElement,p=h.addEventListener("measure",a);h&&!h.layout&&(h.root&&h.root.updateScroll(),h.updateLayout()),kn.read(a);const m=sf(window,"resize",()=>this.scalePositionWithinConstraints()),u=h.addEventListener("didUpdate",({delta:C,hasLayoutChanged:E})=>{this.isDragging&&E&&(as(D=>{const z=this.getAxisMotionValue(D);z&&(this.originPoint[D]+=C[D].translate,z.set(z.get()+C[D].translate))}),this.visualElement.render())});return()=>{m(),i(),p(),u&&u()}}getProps(){const t=this.visualElement.getProps(),{drag:i=!1,dragDirectionLock:a=!1,dragPropagation:h=!1,dragConstraints:p=!1,dragElastic:m=M0,dragMomentum:u=!0}=t;return{...t,drag:i,dragDirectionLock:a,dragPropagation:h,dragConstraints:p,dragElastic:m,dragMomentum:u}}}function Yp(e,t,i){return(t===!0||t===e)&&(i===null||i===e)}function _4(e,t=10){let i=null;return Math.abs(e.y)>t?i="y":Math.abs(e.x)>t&&(i="x"),i}class v4 extends Xa{constructor(t){super(t),this.removeGroupControls=ps,this.removeListeners=ps,this.controls=new y4(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ps}unmount(){this.removeGroupControls(),this.removeListeners()}}const zS=e=>(t,i)=>{e&&kn.postRender(()=>e(t,i))};class x4 extends Xa{constructor(){super(...arguments),this.removePointerDownListener=ps}onPointerDown(t){this.session=new EE(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:PE(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:i,onPan:a,onPanEnd:h}=this.node.getProps();return{onSessionStart:zS(t),onStart:zS(i),onMove:a,onEnd:(p,m)=>{delete this.session,h&&kn.postRender(()=>h(p,m))}}}mount(){this.removePointerDownListener=zd(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const gm={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function DS(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const cd={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Et.test(e))e=parseFloat(e);else return e;const i=DS(e,t.target.x),a=DS(e,t.target.y);return`${i}% ${a}%`}},b4={correct:(e,{treeScale:t,projectionDelta:i})=>{const a=e,h=Ga.parse(e);if(h.length>5)return a;const p=Ga.createTransformer(e),m=typeof h[0]!="number"?1:0,u=i.x.scale*t.x,C=i.y.scale*t.y;h[0+m]/=u,h[1+m]/=C;const E=Mn(u,C,.5);return typeof h[2+m]=="number"&&(h[2+m]/=E),typeof h[3+m]=="number"&&(h[3+m]/=E),p(h)}};let sv=!1;class w4 extends le.Component{componentDidMount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:a,layoutId:h}=this.props,{projection:p}=t;G5(S4),p&&(i.group&&i.group.add(p),a&&a.register&&h&&a.register(p),sv&&p.root.didUpdate(),p.addEventListener("animationComplete",()=>{this.safeToRemove()}),p.setOptions({...p.options,onExitComplete:()=>this.safeToRemove()})),gm.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:i,visualElement:a,drag:h,isPresent:p}=this.props,{projection:m}=a;return m&&(m.isPresent=p,sv=!0,h||t.layoutDependency!==i||i===void 0||t.isPresent!==p?m.willUpdate():this.safeToRemove(),t.isPresent!==p&&(p?m.promote():m.relegate()||kn.postRender(()=>{const u=m.getStack();(!u||!u.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),l1.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:a}=this.props,{projection:h}=t;sv=!0,h&&(h.scheduleCheckAfterUnmount(),i&&i.group&&i.group.remove(h),a&&a.deregister&&a.deregister(h))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function ME(e){const[t,i]=YP(),a=le.useContext(Nx);return De.jsx(w4,{...e,layoutGroup:a,switchLayoutGroup:le.useContext(cE),isPresent:t,safeToRemove:i})}const S4={borderRadius:{...cd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:cd,borderTopRightRadius:cd,borderBottomLeftRadius:cd,borderBottomRightRadius:cd,boxShadow:b4};function T4(e,t,i){const a=jr(e)?e:Fc(e);return a.start(v1("",a,t,i)),a.animation}const C4=(e,t)=>e.depth-t.depth;class k4{constructor(){this.children=[],this.isDirty=!1}add(t){Ux(this.children,t),this.isDirty=!0}remove(t){Gx(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(C4),this.isDirty=!1,this.children.forEach(t)}}function P4(e,t){const i=vi.now(),a=({timestamp:h})=>{const p=h-i;p>=t&&(Ua(a),e(p-t))};return kn.setup(a,!0),()=>Ua(a)}const AE=["TopLeft","TopRight","BottomLeft","BottomRight"],E4=AE.length,RS=e=>typeof e=="string"?parseFloat(e):e,LS=e=>typeof e=="number"||Et.test(e);function I4(e,t,i,a,h,p){h?(e.opacity=Mn(0,i.opacity??1,M4(a)),e.opacityExit=Mn(t.opacity??1,0,A4(a))):p&&(e.opacity=Mn(t.opacity??1,i.opacity??1,a));for(let m=0;m<E4;m++){const u=`border${AE[m]}Radius`;let C=FS(t,u),E=FS(i,u);if(C===void 0&&E===void 0)continue;C||(C=0),E||(E=0),C===0||E===0||LS(C)===LS(E)?(e[u]=Math.max(Mn(RS(C),RS(E),a),0),(io.test(E)||io.test(C))&&(e[u]+="%")):e[u]=E}(t.rotate||i.rotate)&&(e.rotate=Mn(t.rotate||0,i.rotate||0,a))}function FS(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const M4=zE(0,.5,yP),A4=zE(.5,.95,ps);function zE(e,t,i){return a=>a<e?0:a>t?1:i(Qd(e,t,a))}function BS(e,t){e.min=t.min,e.max=t.max}function os(e,t){BS(e.x,t.x),BS(e.y,t.y)}function OS(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function VS(e,t,i,a,h){return e-=t,e=Jm(e,1/i,a),h!==void 0&&(e=Jm(e,1/h,a)),e}function z4(e,t=0,i=1,a=.5,h,p=e,m=e){if(io.test(t)&&(t=parseFloat(t),t=Mn(m.min,m.max,t/100)-m.min),typeof t!="number")return;let u=Mn(p.min,p.max,a);e===p&&(u-=t),e.min=VS(e.min,t,i,u,h),e.max=VS(e.max,t,i,u,h)}function NS(e,t,[i,a,h],p,m){z4(e,t[i],t[a],t[h],t.scale,p,m)}const D4=["x","scaleX","originX"],R4=["y","scaleY","originY"];function jS(e,t,i,a){NS(e.x,t,D4,i?i.x:void 0,a?a.x:void 0),NS(e.y,t,R4,i?i.y:void 0,a?a.y:void 0)}function $S(e){return e.translate===0&&e.scale===1}function DE(e){return $S(e.x)&&$S(e.y)}function US(e,t){return e.min===t.min&&e.max===t.max}function L4(e,t){return US(e.x,t.x)&&US(e.y,t.y)}function GS(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function RE(e,t){return GS(e.x,t.x)&&GS(e.y,t.y)}function qS(e){return ti(e.x)/ti(e.y)}function ZS(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class F4{constructor(){this.members=[]}add(t){Ux(this.members,t),t.scheduleRender()}remove(t){if(Gx(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const i=this.members[this.members.length-1];i&&this.promote(i)}}relegate(t){const i=this.members.findIndex(h=>t===h);if(i===0)return!1;let a;for(let h=i;h>=0;h--){const p=this.members[h];if(p.isPresent!==!1){a=p;break}}return a?(this.promote(a),!0):!1}promote(t,i){const a=this.lead;if(t!==a&&(this.prevLead=a,this.lead=t,t.show(),a)){a.instance&&a.scheduleRender(),t.scheduleRender(),t.resumeFrom=a,i&&(t.resumeFrom.preserveOpacity=!0),a.snapshot&&(t.snapshot=a.snapshot,t.snapshot.latestValues=a.animationValues||a.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:h}=t.options;h===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:i,resumingFrom:a}=t;i.onExitComplete&&i.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function B4(e,t,i){let a="";const h=e.x.translate/t.x,p=e.y.translate/t.y,m=(i==null?void 0:i.z)||0;if((h||p||m)&&(a=`translate3d(${h}px, ${p}px, ${m}px) `),(t.x!==1||t.y!==1)&&(a+=`scale(${1/t.x}, ${1/t.y}) `),i){const{transformPerspective:E,rotate:D,rotateX:z,rotateY:A,skewX:Z,skewY:Y}=i;E&&(a=`perspective(${E}px) ${a}`),D&&(a+=`rotate(${D}deg) `),z&&(a+=`rotateX(${z}deg) `),A&&(a+=`rotateY(${A}deg) `),Z&&(a+=`skewX(${Z}deg) `),Y&&(a+=`skewY(${Y}deg) `)}const u=e.x.scale*t.x,C=e.y.scale*t.y;return(u!==1||C!==1)&&(a+=`scale(${u}, ${C})`),a||"none"}const ov=["","X","Y","Z"],O4=1e3;let V4=0;function av(e,t,i,a){const{latestValues:h}=t;h[e]&&(i[e]=h[e],t.setStaticValue(e,0),a&&(a[e]=0))}function LE(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const i=xE(t);if(window.MotionHasOptimisedAnimation(i,"transform")){const{layout:h,layoutId:p}=e.options;window.MotionCancelOptimisedAnimation(i,"transform",kn,!(h||p))}const{parent:a}=e;a&&!a.hasCheckedOptimisedAppear&&LE(a)}function FE({attachResizeListener:e,defaultParent:t,measureScroll:i,checkIsScrollRoot:a,resetTransform:h}){return class{constructor(m={},u=t==null?void 0:t()){this.id=V4++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach($4),this.nodes.forEach(Z4),this.nodes.forEach(W4),this.nodes.forEach(U4)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=m,this.root=u?u.root||u:this,this.path=u?[...u.path,u]:[],this.parent=u,this.depth=u?u.depth+1:0;for(let C=0;C<this.path.length;C++)this.path[C].shouldResetTransform=!0;this.root===this&&(this.nodes=new k4)}addEventListener(m,u){return this.eventHandlers.has(m)||this.eventHandlers.set(m,new Wx),this.eventHandlers.get(m).add(u)}notifyListeners(m,...u){const C=this.eventHandlers.get(m);C&&C.notify(...u)}hasListeners(m){return this.eventHandlers.has(m)}mount(m){if(this.instance)return;this.isSVG=KP(m)&&!A5(m),this.instance=m;const{layoutId:u,layout:C,visualElement:E}=this.options;if(E&&!E.current&&E.mount(m),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(C||u)&&(this.isLayoutDirty=!0),e){let D,z=0;const A=()=>this.root.updateBlockedByResize=!1;kn.read(()=>{z=window.innerWidth}),e(m,()=>{const Z=window.innerWidth;Z!==z&&(z=Z,this.root.updateBlockedByResize=!0,D&&D(),D=P4(A,250),gm.hasAnimatedSinceResize&&(gm.hasAnimatedSinceResize=!1,this.nodes.forEach(XS)))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&E&&(u||C)&&this.addEventListener("didUpdate",({delta:D,hasLayoutChanged:z,hasRelativeLayoutChanged:A,layout:Z})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const Y=this.options.transition||E.getDefaultTransition()||J4,{onLayoutAnimationStart:te,onLayoutAnimationComplete:pe}=E.getProps(),U=!this.targetLayout||!RE(this.targetLayout,Z),G=!z&&A;if(this.options.layoutRoot||this.resumeFrom||G||z&&(U||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const X={...o1(Y,"layout"),onPlay:te,onComplete:pe};(E.shouldReduceMotion||this.options.layoutRoot)&&(X.delay=0,X.type=!1),this.startAnimation(X),this.setAnimationOrigin(D,G)}else z||XS(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=Z})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const m=this.getStack();m&&m.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Ua(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(H4),this.animationId++)}getTransformTemplate(){const{visualElement:m}=this.options;return m&&m.getProps().transformTemplate}willUpdate(m=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&LE(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let D=0;D<this.path.length;D++){const z=this.path[D];z.shouldResetTransform=!0,z.updateScroll("snapshot"),z.options.layoutRoot&&z.willUpdate(!1)}const{layoutId:u,layout:C}=this.options;if(u===void 0&&!C)return;const E=this.getTransformTemplate();this.prevTransformTemplateValue=E?E(this.latestValues,""):void 0,this.updateSnapshot(),m&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(WS);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(HS);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(q4),this.nodes.forEach(N4),this.nodes.forEach(j4)):this.nodes.forEach(HS),this.clearAllSnapshots();const u=vi.now();Tr.delta=Oo(0,1e3/60,u-Tr.timestamp),Tr.timestamp=u,Tr.isProcessing=!0,X_.update.process(Tr),X_.preRender.process(Tr),X_.render.process(Tr),Tr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,l1.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(G4),this.sharedNodes.forEach(X4)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,kn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){kn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ti(this.snapshot.measuredBox.x)&&!ti(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let C=0;C<this.path.length;C++)this.path[C].updateScroll();const m=this.layout;this.layout=this.measure(!1),this.layoutCorrected=$n(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:u}=this.options;u&&u.notify("LayoutMeasure",this.layout.layoutBox,m?m.layoutBox:void 0)}updateScroll(m="measure"){let u=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===m&&(u=!1),u&&this.instance){const C=a(this.instance);this.scroll={animationId:this.root.animationId,phase:m,isRoot:C,offset:i(this.instance),wasRoot:this.scroll?this.scroll.isRoot:C}}}resetTransform(){if(!h)return;const m=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,u=this.projectionDelta&&!DE(this.projectionDelta),C=this.getTransformTemplate(),E=C?C(this.latestValues,""):void 0,D=E!==this.prevTransformTemplateValue;m&&this.instance&&(u||Al(this.latestValues)||D)&&(h(this.instance,E),this.shouldResetTransform=!1,this.scheduleRender())}measure(m=!0){const u=this.measurePageBox();let C=this.removeElementScroll(u);return m&&(C=this.removeTransform(C)),Q4(C),{animationId:this.root.animationId,measuredBox:u,layoutBox:C,latestValues:{},source:this.id}}measurePageBox(){var E;const{visualElement:m}=this.options;if(!m)return $n();const u=m.measureViewportBox();if(!(((E=this.scroll)==null?void 0:E.wasRoot)||this.path.some(eF))){const{scroll:D}=this.root;D&&(gc(u.x,D.offset.x),gc(u.y,D.offset.y))}return u}removeElementScroll(m){var C;const u=$n();if(os(u,m),(C=this.scroll)!=null&&C.wasRoot)return u;for(let E=0;E<this.path.length;E++){const D=this.path[E],{scroll:z,options:A}=D;D!==this.root&&z&&A.layoutScroll&&(z.wasRoot&&os(u,m),gc(u.x,z.offset.x),gc(u.y,z.offset.y))}return u}applyTransform(m,u=!1){const C=$n();os(C,m);for(let E=0;E<this.path.length;E++){const D=this.path[E];!u&&D.options.layoutScroll&&D.scroll&&D!==D.root&&yc(C,{x:-D.scroll.offset.x,y:-D.scroll.offset.y}),Al(D.latestValues)&&yc(C,D.latestValues)}return Al(this.latestValues)&&yc(C,this.latestValues),C}removeTransform(m){const u=$n();os(u,m);for(let C=0;C<this.path.length;C++){const E=this.path[C];if(!E.instance||!Al(E.latestValues))continue;T0(E.latestValues)&&E.updateSnapshot();const D=$n(),z=E.measurePageBox();os(D,z),jS(u,E.latestValues,E.snapshot?E.snapshot.layoutBox:void 0,D)}return Al(this.latestValues)&&jS(u,this.latestValues),u}setTargetDelta(m){this.targetDelta=m,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(m){this.options={...this.options,...m,crossfade:m.crossfade!==void 0?m.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Tr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(m=!1){var A;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const C=!!this.resumingFrom||this!==u;if(!(m||C&&this.isSharedProjectionDirty||this.isProjectionDirty||(A=this.parent)!=null&&A.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:D,layoutId:z}=this.options;if(!(!this.layout||!(D||z))){if(this.resolvedRelativeTargetAt=Tr.timestamp,!this.targetDelta&&!this.relativeTarget){const Z=this.getClosestProjectingParent();Z&&Z.layout&&this.animationProgress!==1?(this.relativeParent=Z,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$n(),this.relativeTargetOrigin=$n(),Rd(this.relativeTargetOrigin,this.layout.layoutBox,Z.layout.layoutBox),os(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=$n(),this.targetWithTransforms=$n()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),o4(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):os(this.target,this.layout.layoutBox),pE(this.target,this.targetDelta)):os(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const Z=this.getClosestProjectingParent();Z&&!!Z.resumingFrom==!!this.resumingFrom&&!Z.options.layoutScroll&&Z.target&&this.animationProgress!==1?(this.relativeParent=Z,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$n(),this.relativeTargetOrigin=$n(),Rd(this.relativeTargetOrigin,this.target,Z.target),os(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||T0(this.parent.latestValues)||fE(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var Y;const m=this.getLead(),u=!!this.resumingFrom||this!==m;let C=!0;if((this.isProjectionDirty||(Y=this.parent)!=null&&Y.isProjectionDirty)&&(C=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(C=!1),this.resolvedRelativeTargetAt===Tr.timestamp&&(C=!1),C)return;const{layout:E,layoutId:D}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(E||D))return;os(this.layoutCorrected,this.layout.layoutBox);const z=this.treeScale.x,A=this.treeScale.y;_3(this.layoutCorrected,this.treeScale,this.path,u),m.layout&&!m.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(m.target=m.layout.layoutBox,m.targetWithTransforms=$n());const{target:Z}=m;if(!Z){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(OS(this.prevProjectionDelta.x,this.projectionDelta.x),OS(this.prevProjectionDelta.y,this.projectionDelta.y)),Dd(this.projectionDelta,this.layoutCorrected,Z,this.latestValues),(this.treeScale.x!==z||this.treeScale.y!==A||!ZS(this.projectionDelta.x,this.prevProjectionDelta.x)||!ZS(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",Z))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(m=!0){var u;if((u=this.options.visualElement)==null||u.scheduleRender(),m){const C=this.getStack();C&&C.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=_c(),this.projectionDelta=_c(),this.projectionDeltaWithTransform=_c()}setAnimationOrigin(m,u=!1){const C=this.snapshot,E=C?C.latestValues:{},D={...this.latestValues},z=_c();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!u;const A=$n(),Z=C?C.source:void 0,Y=this.layout?this.layout.source:void 0,te=Z!==Y,pe=this.getStack(),U=!pe||pe.members.length<=1,G=!!(te&&!U&&this.options.crossfade===!0&&!this.path.some(Y4));this.animationProgress=0;let X;this.mixTargetDelta=ae=>{const _e=ae/1e3;KS(z.x,m.x,_e),KS(z.y,m.y,_e),this.setTargetDelta(z),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Rd(A,this.layout.layoutBox,this.relativeParent.layout.layoutBox),K4(this.relativeTarget,this.relativeTargetOrigin,A,_e),X&&L4(this.relativeTarget,X)&&(this.isProjectionDirty=!1),X||(X=$n()),os(X,this.relativeTarget)),te&&(this.animationValues=D,I4(D,E,this.latestValues,_e,G,U)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_e},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(m){var u,C,E;this.notifyListeners("animationStart"),(u=this.currentAnimation)==null||u.stop(),(E=(C=this.resumingFrom)==null?void 0:C.currentAnimation)==null||E.stop(),this.pendingAnimation&&(Ua(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=kn.update(()=>{gm.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Fc(0)),this.currentAnimation=T4(this.motionValue,[0,1e3],{...m,velocity:0,isSync:!0,onUpdate:D=>{this.mixTargetDelta(D),m.onUpdate&&m.onUpdate(D)},onStop:()=>{},onComplete:()=>{m.onComplete&&m.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const m=this.getStack();m&&m.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(O4),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const m=this.getLead();let{targetWithTransforms:u,target:C,layout:E,latestValues:D}=m;if(!(!u||!C||!E)){if(this!==m&&this.layout&&E&&BE(this.options.animationType,this.layout.layoutBox,E.layoutBox)){C=this.target||$n();const z=ti(this.layout.layoutBox.x);C.x.min=m.target.x.min,C.x.max=C.x.min+z;const A=ti(this.layout.layoutBox.y);C.y.min=m.target.y.min,C.y.max=C.y.min+A}os(u,C),yc(u,D),Dd(this.projectionDeltaWithTransform,this.layoutCorrected,u,D)}}registerSharedNode(m,u){this.sharedNodes.has(m)||this.sharedNodes.set(m,new F4),this.sharedNodes.get(m).add(u);const E=u.options.initialPromotionConfig;u.promote({transition:E?E.transition:void 0,preserveFollowOpacity:E&&E.shouldPreserveFollowOpacity?E.shouldPreserveFollowOpacity(u):void 0})}isLead(){const m=this.getStack();return m?m.lead===this:!0}getLead(){var u;const{layoutId:m}=this.options;return m?((u=this.getStack())==null?void 0:u.lead)||this:this}getPrevLead(){var u;const{layoutId:m}=this.options;return m?(u=this.getStack())==null?void 0:u.prevLead:void 0}getStack(){const{layoutId:m}=this.options;if(m)return this.root.sharedNodes.get(m)}promote({needsReset:m,transition:u,preserveFollowOpacity:C}={}){const E=this.getStack();E&&E.promote(this,C),m&&(this.projectionDelta=void 0,this.needsReset=!0),u&&this.setOptions({transition:u})}relegate(){const m=this.getStack();return m?m.relegate(this):!1}resetSkewAndRotation(){const{visualElement:m}=this.options;if(!m)return;let u=!1;const{latestValues:C}=m;if((C.z||C.rotate||C.rotateX||C.rotateY||C.rotateZ||C.skewX||C.skewY)&&(u=!0),!u)return;const E={};C.z&&av("z",m,E,this.animationValues);for(let D=0;D<ov.length;D++)av(`rotate${ov[D]}`,m,E,this.animationValues),av(`skew${ov[D]}`,m,E,this.animationValues);m.render();for(const D in E)m.setStaticValue(D,E[D]),this.animationValues&&(this.animationValues[D]=E[D]);m.scheduleRender()}applyProjectionStyles(m,u){if(!this.instance||this.isSVG)return;if(!this.isVisible){m.visibility="hidden";return}const C=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,m.visibility="",m.opacity="",m.pointerEvents=mm(u==null?void 0:u.pointerEvents)||"",m.transform=C?C(this.latestValues,""):"none";return}const E=this.getLead();if(!this.projectionDelta||!this.layout||!E.target){this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=mm(u==null?void 0:u.pointerEvents)||""),this.hasProjected&&!Al(this.latestValues)&&(m.transform=C?C({},""):"none",this.hasProjected=!1);return}m.visibility="";const D=E.animationValues||E.latestValues;this.applyTransformsToTarget();let z=B4(this.projectionDeltaWithTransform,this.treeScale,D);C&&(z=C(D,z)),m.transform=z;const{x:A,y:Z}=this.projectionDelta;m.transformOrigin=`${A.origin*100}% ${Z.origin*100}% 0`,E.animationValues?m.opacity=E===this?D.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:D.opacityExit:m.opacity=E===this?D.opacity!==void 0?D.opacity:"":D.opacityExit!==void 0?D.opacityExit:0;for(const Y in rf){if(D[Y]===void 0)continue;const{correct:te,applyTo:pe,isCSSVariable:U}=rf[Y],G=z==="none"?D[Y]:te(D[Y],E);if(pe){const X=pe.length;for(let ae=0;ae<X;ae++)m[pe[ae]]=G}else U?this.options.visualElement.renderState.vars[Y]=G:m[Y]=G}this.options.layoutId&&(m.pointerEvents=E===this?mm(u==null?void 0:u.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(m=>{var u;return(u=m.currentAnimation)==null?void 0:u.stop()}),this.root.nodes.forEach(WS),this.root.sharedNodes.clear()}}}function N4(e){e.updateLayout()}function j4(e){var i;const t=((i=e.resumeFrom)==null?void 0:i.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:h}=e.layout,{animationType:p}=e.options,m=t.source!==e.layout.source;p==="size"?as(z=>{const A=m?t.measuredBox[z]:t.layoutBox[z],Z=ti(A);A.min=a[z].min,A.max=A.min+Z}):BE(p,t.layoutBox,a)&&as(z=>{const A=m?t.measuredBox[z]:t.layoutBox[z],Z=ti(a[z]);A.max=A.min+Z,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[z].max=e.relativeTarget[z].min+Z)});const u=_c();Dd(u,a,t.layoutBox);const C=_c();m?Dd(C,e.applyTransform(h,!0),t.measuredBox):Dd(C,a,t.layoutBox);const E=!DE(u);let D=!1;if(!e.resumeFrom){const z=e.getClosestProjectingParent();if(z&&!z.resumeFrom){const{snapshot:A,layout:Z}=z;if(A&&Z){const Y=$n();Rd(Y,t.layoutBox,A.layoutBox);const te=$n();Rd(te,a,Z.layoutBox),RE(Y,te)||(D=!0),z.options.layoutRoot&&(e.relativeTarget=te,e.relativeTargetOrigin=Y,e.relativeParent=z)}}}e.notifyListeners("didUpdate",{layout:a,snapshot:t,delta:C,layoutDelta:u,hasLayoutChanged:E,hasRelativeLayoutChanged:D})}else if(e.isLead()){const{onExitComplete:a}=e.options;a&&a()}e.options.transition=void 0}function $4(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function U4(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function G4(e){e.clearSnapshot()}function WS(e){e.clearMeasurements()}function HS(e){e.isLayoutDirty=!1}function q4(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function XS(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Z4(e){e.resolveTargetDelta()}function W4(e){e.calcProjection()}function H4(e){e.resetSkewAndRotation()}function X4(e){e.removeLeadSnapshot()}function KS(e,t,i){e.translate=Mn(t.translate,0,i),e.scale=Mn(t.scale,1,i),e.origin=t.origin,e.originPoint=t.originPoint}function YS(e,t,i,a){e.min=Mn(t.min,i.min,a),e.max=Mn(t.max,i.max,a)}function K4(e,t,i,a){YS(e.x,t.x,i.x,a),YS(e.y,t.y,i.y,a)}function Y4(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const J4={duration:.45,ease:[.4,0,.1,1]},JS=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),QS=JS("applewebkit/")&&!JS("chrome/")?Math.round:ps;function eT(e){e.min=QS(e.min),e.max=QS(e.max)}function Q4(e){eT(e.x),eT(e.y)}function BE(e,t,i){return e==="position"||e==="preserve-aspect"&&!s4(qS(t),qS(i),.2)}function eF(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const tF=FE({attachResizeListener:(e,t)=>sf(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),lv={current:void 0},OE=FE({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!lv.current){const e=new tF({});e.mount(window),e.setOptions({layoutScroll:!0}),lv.current=e}return lv.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),nF={pan:{Feature:x4},drag:{Feature:v4,ProjectionNode:OE,MeasureLayout:ME}};function tT(e,t,i){const{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",i==="Start");const h="onHover"+i,p=a[h];p&&kn.postRender(()=>p(t,bf(t)))}class rF extends Xa{mount(){const{current:t}=this.node;t&&(this.unmount=k5(t,(i,a)=>(tT(this.node,a,"Start"),h=>tT(this.node,h,"End"))))}unmount(){}}class iF extends Xa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=_f(sf(this.node.current,"focus",()=>this.onFocus()),sf(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function nT(e,t,i){const{props:a}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap",i==="Start");const h="onTap"+(i==="End"?"":i),p=a[h];p&&kn.postRender(()=>p(t,bf(t)))}class sF extends Xa{mount(){const{current:t}=this.node;t&&(this.unmount=M5(t,(i,a)=>(nT(this.node,a,"Start"),(h,{success:p})=>nT(this.node,h,p?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const A0=new WeakMap,uv=new WeakMap,oF=e=>{const t=A0.get(e.target);t&&t(e)},aF=e=>{e.forEach(oF)};function lF({root:e,...t}){const i=e||document;uv.has(i)||uv.set(i,{});const a=uv.get(i),h=JSON.stringify(t);return a[h]||(a[h]=new IntersectionObserver(aF,{root:e,...t})),a[h]}function uF(e,t,i){const a=lF(t);return A0.set(e,i),a.observe(e),()=>{A0.delete(e),a.unobserve(e)}}const cF={some:0,all:1};class hF extends Xa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:i,margin:a,amount:h="some",once:p}=t,m={root:i?i.current:void 0,rootMargin:a,threshold:typeof h=="number"?h:cF[h]},u=C=>{const{isIntersecting:E}=C;if(this.isInView===E||(this.isInView=E,p&&!E&&this.hasEnteredView))return;E&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",E);const{onViewportEnter:D,onViewportLeave:z}=this.node.getProps(),A=E?D:z;A&&A(C)};return uF(this.node.current,m,u)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:i}=this.node;["amount","margin","root"].some(dF(t,i))&&this.startObserver()}unmount(){}}function dF({viewport:e={}},{viewport:t={}}={}){return i=>e[i]!==t[i]}const fF={inView:{Feature:hF},tap:{Feature:sF},focus:{Feature:iF},hover:{Feature:rF}},pF={layout:{ProjectionNode:OE,MeasureLayout:ME}},mF={...Q3,...fF,...nF,...pF},z0=m3(mF,E3),kl="polygon-region",hd="polygon-vertices",Xu="polygon-preview-line",rT="polygon-region-fill",iT="polygon-region-outline",sT="polygon-vertex-circles",oT="polygon-preview";function cv({active:e,disabled:t,title:i,onClick:a,children:h}){return De.jsx("button",{title:i,onClick:a,disabled:t,style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,borderRadius:7,border:"none",cursor:t?"default":"pointer",background:e?"#3b82f6":"#f1f5f9",color:t?"#cbd5e1":e?"#fff":"#64748b",fontSize:15,transition:"background 0.15s, color 0.15s"},children:h})}function gF({polygonCoords:e,polygonClosed:t,setPolygonCoords:i,setPolygonClosed:a}){var te;const h=gf(),p=(te=h==null?void 0:h.current)==null?void 0:te.getMap(),[m,u]=le.useState(0),[C,E]=le.useState(null),D=le.useRef(null),z=le.useRef(!1),A=le.useRef(0);if(le.useEffect(()=>{if(!p)return;const pe=()=>{p.getSource(kl)||(p.addSource(kl,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[]}}}),p.addLayer({id:rT,type:"fill",source:kl,paint:{"fill-color":"#3b82f6","fill-opacity":.15}}),p.addLayer({id:iT,type:"line",source:kl,paint:{"line-color":"#3b82f6","line-width":1.5}})),p.getSource(hd)||(p.addSource(hd,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),p.addLayer({id:sT,type:"circle",source:hd,paint:{"circle-radius":5,"circle-color":"#fff","circle-stroke-color":"#3b82f6","circle-stroke-width":2}})),p.getSource(Xu)||(p.addSource(Xu,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}}),p.addLayer({id:oT,type:"line",source:Xu,paint:{"line-color":"#3b82f6","line-width":1.5,"line-dasharray":[4,3],"line-opacity":.6}}))};return p.isStyleLoaded()?pe():p.once("styledata",pe),()=>{[oT,sT,iT,rT].forEach(U=>{p.getLayer(U)&&p.removeLayer(U)}),[Xu,hd,kl].forEach(U=>{p.getSource(U)&&p.removeSource(U)})}},[p]),le.useEffect(()=>{if(!p||!p.getSource(kl))return;const pe=t&&e.length>=3?[...e,e[0]]:[];p.getSource(kl).setData({type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:pe.length?[pe]:[]}}),p.getSource(hd).setData({type:"FeatureCollection",features:e.map(([U,G],X)=>({type:"Feature",properties:{index:X},geometry:{type:"Point",coordinates:[U,G]}}))})},[p,e,t]),le.useEffect(()=>{if(!p||!p.getSource(Xu))return;const pe=!t&&e.length>=1&&C!==null;p.getSource(Xu).setData({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:pe?[e[e.length-1],C]:[]}})},[p,C,e,t]),le.useEffect(()=>{if(!p)return;const pe=300,U=X=>{if(m!==1||t)return;const ae=Date.now();if(ae-A.current<pe){A.current=0;return}A.current=ae,i(_e=>[..._e,[X.lngLat.lng,X.lngLat.lat]])},G=X=>{m!==1||t||(X.preventDefault(),e.length>=3&&(a(!0),u(0),E(null),A.current=0))};return p.on("click",U),p.on("dblclick",G),()=>{p.off("click",U),p.off("dblclick",G)}},[p,m,t,e.length,i,a]),le.useEffect(()=>{if(!p)return;const pe=U=>{if(m===1&&!t){E([U.lngLat.lng,U.lngLat.lat]),p.getCanvas().style.cursor="crosshair";return}if(m===0&&t&&e.length>0){const G=p.project(U.lngLat),X=e.some(([ae,_e])=>{const ye=p.project({lng:ae,lat:_e});return(G.x-ye.x)**2+(G.y-ye.y)**2<100});p.getCanvas().style.cursor=X?"grab":""}else p.getCanvas().style.cursor=""};return p.on("mousemove",pe),()=>{p.off("mousemove",pe),z.current||(p.getCanvas().style.cursor="")}},[p,m,t,e]),le.useEffect(()=>{if(!p)return;const pe=X=>{if(m!==0||!t||e.length===0)return;const ae=p.project(X.lngLat);let _e=-1,ye=1/0;e.forEach(([Se,Ie],Be)=>{const Ue=p.project({lng:Se,lat:Ie}),Ne=(ae.x-Ue.x)**2+(ae.y-Ue.y)**2;Ne<100&&Ne<ye&&(ye=Ne,_e=Be)}),_e>=0&&(D.current=_e,z.current=!0,p.dragPan.disable(),p.getCanvas().style.cursor="grabbing",X.preventDefault())},U=X=>{if(!z.current||D.current===null)return;const ae=[X.lngLat.lng,X.lngLat.lat];i(_e=>{const ye=[..._e];return ye[D.current]=ae,ye})},G=()=>{z.current&&(z.current=!1,D.current=null,p.dragPan.enable(),p.getCanvas().style.cursor="grab")};return p.on("mousedown",pe),p.on("mousemove",U),p.on("mouseup",G),()=>{p.off("mousedown",pe),p.off("mousemove",U),p.off("mouseup",G),p.dragPan.enable()}},[p,m,t,e,i]),!p)return null;const Z=()=>{i([]),a(!1),E(null),u(0),p&&(p.getCanvas().style.cursor="")},Y=t?"Drag vertices to adjust":m===1?e.length===0?"Click to place points":e.length<3?`${e.length} point${e.length>1?"s":""}  need ${3-e.length} more`:"Double-click to close":"Draw a region to constrain routes";return De.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[De.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[De.jsx(cv,{title:"Mouse / Edit",active:m===0,onClick:()=>{u(0),E(null),p&&(p.getCanvas().style.cursor="")},children:De.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:De.jsx("path",{d:"M4 0l16 12-7 2-4 8z"})})}),De.jsx(cv,{title:t?"Reset to redraw":"Draw region",active:m===1,disabled:t,onClick:()=>u(1),children:De.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:De.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})}),e.length>0&&De.jsx(cv,{title:"Clear region",onClick:Z,children:De.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:De.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),De.jsx("div",{style:{fontSize:11,color:"#94a3b8"},children:Y})]})}function yF({value:e,onChange:t}){const[i,a]=le.useState(String(e)),h=p=>{const m=parseFloat(p);!isNaN(m)&&m>=mR&&m<=gR?(t(m),a(String(m))):a(String(e))};return De.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[De.jsx("span",{style:{fontSize:12,color:"#64748b"},children:"Distance"}),De.jsxs("div",{style:{position:"relative",width:90},children:[De.jsx("input",{value:i,onChange:p=>a(p.target.value),onBlur:p=>h(p.target.value),onKeyDown:p=>{p.key==="Enter"&&h(p.target.value)},inputMode:"decimal",style:{width:"100%",boxSizing:"border-box",background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:8,padding:"7px 28px 7px 10px",color:"#0f172a",fontSize:13,outline:"none",appearance:"none",MozAppearance:"textfield"}}),De.jsx("span",{style:{position:"absolute",right:9,top:"50%",transform:"translateY(-50%)",fontSize:11,color:"#94a3b8",pointerEvents:"none"},children:"mi"})]})]})}var VE={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */(function(e,t){(function(i,a){e.exports=a()})(bA,function(){var i={},a={};function h(m,u,C){if(a[m]=C,m==="index"){var E="var sharedModule = {}; ("+a.shared+")(sharedModule); ("+a.worker+")(sharedModule);",D={};return a.shared(D),a.index(i,D),typeof window<"u"&&i.setWorkerUrl(window.URL.createObjectURL(new Blob([E],{type:"text/javascript"}))),i}}h("shared",["exports"],function(m){function u(s,r,o,c){return new(o||(o=Promise))(function(g,v){function x(P){try{S(c.next(P))}catch(I){v(I)}}function b(P){try{S(c.throw(P))}catch(I){v(I)}}function S(P){var I;P.done?g(P.value):(I=P.value,I instanceof o?I:new o(function(R){R(I)})).then(x,b)}S((c=c.apply(s,r||[])).next())})}function C(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}typeof SuppressedError=="function"&&SuppressedError;var E=D;function D(s,r){this.x=s,this.y=r}D.prototype={clone:function(){return new D(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,r){return this.clone()._rotateAround(s,r)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var r=s.x-this.x,o=s.y-this.y;return r*r+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,r){return Math.atan2(this.x*r-this.y*s,this.x*s+this.y*r)},_matMult:function(s){var r=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=r,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var r=Math.cos(s),o=Math.sin(s),c=o*this.x+r*this.y;return this.x=r*this.x-o*this.y,this.y=c,this},_rotateAround:function(s,r){var o=Math.cos(s),c=Math.sin(s),g=r.y+c*(this.x-r.x)+o*(this.y-r.y);return this.x=r.x+o*(this.x-r.x)-c*(this.y-r.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},D.convert=function(s){return s instanceof D?s:Array.isArray(s)?new D(s[0],s[1]):s};var z=C(E),A=Z;function Z(s,r,o,c){this.cx=3*s,this.bx=3*(o-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(c-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=r,this.p2x=o,this.p2y=c}Z.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,r){if(r===void 0&&(r=1e-6),s<0)return 0;if(s>1)return 1;for(var o=s,c=0;c<8;c++){var g=this.sampleCurveX(o)-s;if(Math.abs(g)<r)return o;var v=this.sampleCurveDerivativeX(o);if(Math.abs(v)<1e-6)break;o-=g/v}var x=0,b=1;for(o=s,c=0;c<20&&(g=this.sampleCurveX(o),!(Math.abs(g-s)<r));c++)s>g?x=o:b=o,o=.5*(b-x)+x;return o},solve:function(s,r){return this.sampleCurveY(this.solveCurveX(s,r))}};var Y=C(A);let te,pe;function U(){return te==null&&(te=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),te}function G(){if(pe==null&&(pe=!1,U())){const r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let c=0;c<5*5;c++){const g=4*c;r.fillStyle=`rgb(${g},${g+1},${g+2})`,r.fillRect(c%5,Math.floor(c/5),1,1)}const o=r.getImageData(0,0,5,5).data;for(let c=0;c<5*5*4;c++)if(c%4!=3&&o[c]!==c){pe=!0;break}}}return pe||!1}function X(s,r,o,c){const g=new Y(s,r,o,c);return v=>g.solve(v)}const ae=X(.25,.1,.25,1);function _e(s,r,o){return Math.min(o,Math.max(r,s))}function ye(s,r,o){const c=o-r,g=((s-r)%c+c)%c+r;return g===r?o:g}function Se(s,...r){for(const o of r)for(const c in o)s[c]=o[c];return s}let Ie=1;function Be(s,r,o){const c={};for(const g in s)c[g]=r.call(this,s[g],g,s);return c}function Ue(s,r,o){const c={};for(const g in s)r.call(this,s[g],g,s)&&(c[g]=s[g]);return c}function Ne(s){return Array.isArray(s)?s.map(Ne):typeof s=="object"&&s?Be(s,Ne):s}const J={};function je(s){J[s]||(typeof console<"u"&&console.warn(s),J[s]=!0)}function Fe(s,r,o){return(o.y-s.y)*(r.x-s.x)>(r.y-s.y)*(o.x-s.x)}function ft(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let Ct=null;function bt(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const Oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function tt(s,r,o,c,g){return u(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const v=new VideoFrame(s,{timestamp:0});try{const x=v==null?void 0:v.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const b=x.startsWith("BGR"),S=new Uint8ClampedArray(c*g*4);if(yield v.copyTo(S,function(P,I,R,B,N){const $=4*Math.max(-I,0),q=(Math.max(0,R)-R)*B*4+$,ee=4*B,se=Math.max(0,I),we=Math.max(0,R);return{rect:{x:se,y:we,width:Math.min(P.width,I+B)-se,height:Math.min(P.height,R+N)-we},layout:[{offset:q,stride:ee}]}}(s,r,o,c,g)),b)for(let P=0;P<S.length;P+=4){const I=S[P];S[P]=S[P+2],S[P+2]=I}return S}finally{v.close()}})}let gt,Pt;const Bt="AbortError";function Gr(){return new Error(Bt)}const qn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ir(s){return qn.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const sr="global-dispatcher";class Dn extends Error{constructor(r,o,c,g){super(`AJAXError: ${o} (${r}): ${c}`),this.status=r,this.statusText=o,this.url=c,this.body=g}}const qr=()=>ft(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,vs=function(s,r){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const c=ir(s.url);if(c)return c(s,r);if(ft(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:sr},r)}if(!(/^file:/.test(o=s.url)||/^file:/.test(qr())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(c,g){return u(this,void 0,void 0,function*(){const v=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,cache:c.cache,referrer:qr(),signal:g.signal});c.type!=="json"||v.headers.has("Accept")||v.headers.set("Accept","application/json");const x=yield fetch(v);if(!x.ok){const P=yield x.blob();throw new Dn(x.status,x.statusText,c.url,P)}let b;b=c.type==="arrayBuffer"||c.type==="image"?x.arrayBuffer():c.type==="json"?x.json():x.text();const S=yield b;if(g.signal.aborted)throw Gr();return{data:S,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(s,r);if(ft(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:sr},r)}var o;return function(c,g){return new Promise((v,x)=>{var b;const S=new XMLHttpRequest;S.open(c.method||"GET",c.url,!0),c.type!=="arrayBuffer"&&c.type!=="image"||(S.responseType="arraybuffer");for(const P in c.headers)S.setRequestHeader(P,c.headers[P]);c.type==="json"&&(S.responseType="text",!((b=c.headers)===null||b===void 0)&&b.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=c.credentials==="include",S.onerror=()=>{x(new Error(S.statusText))},S.onload=()=>{if(!g.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let P=S.response;if(c.type==="json")try{P=JSON.parse(S.response)}catch(I){return void x(I)}v({data:P,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const P=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});x(new Dn(S.status,S.statusText,c.url,P))}},g.signal.addEventListener("abort",()=>{S.abort(),x(Gr())}),S.send(c.body)})}(s,r)};function xs(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const r=new URL(s),o=window.location;return r.protocol===o.protocol&&r.host===o.host}function oo(s,r,o){o[s]&&o[s].indexOf(r)!==-1||(o[s]=o[s]||[],o[s].push(r))}function Ti(s,r,o){if(o&&o[s]){const c=o[s].indexOf(r);c!==-1&&o[s].splice(c,1)}}class Xi{constructor(r,o={}){Se(this,o),this.type=r}}class si extends Xi{constructor(r,o={}){super("error",Se({error:r},o))}}class Fs{on(r,o){return this._listeners=this._listeners||{},oo(r,o,this._listeners),this}off(r,o){return Ti(r,o,this._listeners),Ti(r,o,this._oneTimeListeners),this}once(r,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},oo(r,o,this._oneTimeListeners),this):new Promise(c=>this.once(r,c))}fire(r,o){typeof r=="string"&&(r=new Xi(r,o||{}));const c=r.type;if(this.listens(c)){r.target=this;const g=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const b of g)b.call(this,r);const v=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const b of v)Ti(c,b,this._oneTimeListeners),b.call(this,r);const x=this._eventedParent;x&&(Se(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(r))}else r instanceof si&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,o){return this._eventedParent=r,this._eventedParentData=o,this}}var ke={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const oi=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ci(s,r){const o={};for(const c in s)c!=="ref"&&(o[c]=s[c]);return oi.forEach(c=>{c in r&&(o[c]=r[c])}),o}function Ot(s,r){if(Array.isArray(s)){if(!Array.isArray(r)||s.length!==r.length)return!1;for(let o=0;o<s.length;o++)if(!Ot(s[o],r[o]))return!1;return!0}if(typeof s=="object"&&s!==null&&r!==null){if(typeof r!="object"||Object.keys(s).length!==Object.keys(r).length)return!1;for(const o in s)if(!Ot(s[o],r[o]))return!1;return!0}return s===r}function ln(s,r){s.push(r)}function ao(s,r,o){ln(o,{command:"addSource",args:[s,r[s]]})}function St(s,r,o){ln(r,{command:"removeSource",args:[s]}),o[s]=!0}function bs(s,r,o,c){St(s,o,c),ao(s,r,o)}function Go(s,r,o){let c;for(c in s[o])if(Object.prototype.hasOwnProperty.call(s[o],c)&&c!=="data"&&!Ot(s[o][c],r[o][c]))return!1;for(c in r[o])if(Object.prototype.hasOwnProperty.call(r[o],c)&&c!=="data"&&!Ot(s[o][c],r[o][c]))return!1;return!0}function ai(s,r,o,c,g,v){s=s||{},r=r||{};for(const x in s)Object.prototype.hasOwnProperty.call(s,x)&&(Ot(s[x],r[x])||o.push({command:v,args:[c,x,r[x],g]}));for(const x in r)Object.prototype.hasOwnProperty.call(r,x)&&!Object.prototype.hasOwnProperty.call(s,x)&&(Ot(s[x],r[x])||o.push({command:v,args:[c,x,r[x],g]}))}function Ka(s){return s.id}function Ya(s,r){return s[r.id]=r,s}class $e{constructor(r,o,c,g){this.message=(r?`${r}: `:"")+c,g&&(this.identifier=g),o!=null&&o.__line__&&(this.line=o.__line__)}}function Ki(s,...r){for(const o of r)for(const c in o)s[c]=o[c];return s}class yr extends Error{constructor(r,o){super(o),this.message=o,this.key=r}}class Yi{constructor(r,o=[]){this.parent=r,this.bindings={};for(const[c,g]of o)this.bindings[c]=g}concat(r){return new Yi(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const Bs={kind:"null"},He={kind:"number"},Mt={kind:"string"},_t={kind:"boolean"},Er={kind:"color"},ki={kind:"object"},Tt={kind:"value"},Ji={kind:"collator"},ws={kind:"formatted"},Os={kind:"padding"},Qi={kind:"resolvedImage"},ie={kind:"variableAnchorOffsetCollection"};function V(s,r){return{kind:"array",itemType:s,N:r}}function O(s){if(s.kind==="array"){const r=O(s.itemType);return typeof s.N=="number"?`array<${r}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${r}>`}return s.kind}const W=[Bs,He,Mt,_t,Er,ws,ki,V(Tt),Os,Qi,ie];function ne(s,r){if(r.kind==="error")return null;if(s.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!ne(s.itemType,r.itemType))&&(typeof s.N!="number"||s.N===r.N))return null}else{if(s.kind===r.kind)return null;if(s.kind==="value"){for(const o of W)if(!ne(o,r))return null}}return`Expected ${O(s)} but found ${O(r)} instead.`}function fe(s,r){return r.some(o=>o.kind===s.kind)}function ge(s,r){return r.some(o=>o==="null"?s===null:o==="array"?Array.isArray(s):o==="object"?s&&!Array.isArray(s)&&typeof s=="object":o===typeof s)}function be(s,r){return s.kind==="array"&&r.kind==="array"?s.itemType.kind===r.itemType.kind&&typeof s.N=="number":s.kind===r.kind}const ce=.96422,Ee=.82521,Re=4/29,Ce=6/29,qe=3*Ce*Ce,ht=Ce*Ce*Ce,pt=Math.PI/180,Vt=180/Math.PI;function kt(s){return(s%=360)<0&&(s+=360),s}function Nt([s,r,o,c]){let g,v;const x=Rn((.2225045*(s=Dt(s))+.7168786*(r=Dt(r))+.0606169*(o=Dt(o)))/1);s===r&&r===o?g=v=x:(g=Rn((.4360747*s+.3850649*r+.1430804*o)/ce),v=Rn((.0139322*s+.0971045*r+.7141733*o)/Ee));const b=116*x-16;return[b<0?0:b,500*(g-x),200*(x-v),c]}function Dt(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Rn(s){return s>ht?Math.pow(s,1/3):s/qe+Re}function yn([s,r,o,c]){let g=(s+16)/116,v=isNaN(r)?g:g+r/500,x=isNaN(o)?g:g-o/200;return g=1*Wt(g),v=ce*Wt(v),x=Ee*Wt(x),[At(3.1338561*v-1.6168667*g-.4906146*x),At(-.9787684*v+1.9161415*g+.033454*x),At(.0719453*v-.2289914*g+1.4052427*x),c]}function At(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function Wt(s){return s>Ce?s*s*s:qe*(s-Re)}function pn(s){return parseInt(s.padEnd(2,s),16)/255}function Zn(s,r){return Qn(r?s/100:s,0,1)}function Qn(s,r,o){return Math.min(Math.max(r,s),o)}function _r(s){return!s.some(Number.isNaN)}const qo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ht{constructor(r,o,c,g=1,v=!0){this.r=r,this.g=o,this.b=c,this.a=g,v||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[r,o,c,g]))}static parse(r){if(r instanceof Ht)return r;if(typeof r!="string")return;const o=function(c){if((c=c.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=qo[c];if(g){const[x,b,S]=g;return[x/255,b/255,S/255,1]}if(c.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(c)){const x=c.length<6?1:2;let b=1;return[pn(c.slice(b,b+=x)),pn(c.slice(b,b+=x)),pn(c.slice(b,b+=x)),pn(c.slice(b,b+x)||"ff")]}if(c.startsWith("rgb")){const x=c.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[b,S,P,I,R,B,N,$,q,ee,se,we]=x,de=[I||" ",N||" ",ee].join("");if(de==="  "||de==="  /"||de===",,"||de===",,,"){const xe=[P,B,q].join(""),Pe=xe==="%%%"?100:xe===""?255:0;if(Pe){const Le=[Qn(+S/Pe,0,1),Qn(+R/Pe,0,1),Qn(+$/Pe,0,1),se?Zn(+se,we):1];if(_r(Le))return Le}}return}}const v=c.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[x,b,S,P,I,R,B,N,$]=v,q=[S||" ",I||" ",B].join("");if(q==="  "||q==="  /"||q===",,"||q===",,,"){const ee=[+b,Qn(+P,0,100),Qn(+R,0,100),N?Zn(+N,$):1];if(_r(ee))return function([se,we,de,xe]){function Pe(Le){const et=(Le+se/30)%12,mt=we*Math.min(de,1-de);return de-mt*Math.max(-1,Math.min(et-3,9-et,1))}return se=kt(se),we/=100,de/=100,[Pe(0),Pe(8),Pe(4),xe]}(ee)}}}(r);return o?new Ht(...o,!1):void 0}get rgb(){const{r,g:o,b:c,a:g}=this,v=g||1/0;return this.overwriteGetter("rgb",[r/v,o/v,c/v,g])}get hcl(){return this.overwriteGetter("hcl",function(r){const[o,c,g,v]=Nt(r),x=Math.sqrt(c*c+g*g);return[Math.round(1e4*x)?kt(Math.atan2(g,c)*Vt):NaN,x,o,v]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Nt(this.rgb))}overwriteGetter(r,o){return Object.defineProperty(this,r,{value:o}),o}toString(){const[r,o,c,g]=this.rgb;return`rgba(${[r,o,c].map(v=>Math.round(255*v)).join(",")},${g})`}}Ht.black=new Ht(0,0,0,1),Ht.white=new Ht(1,1,1,1),Ht.transparent=new Ht(0,0,0,0),Ht.red=new Ht(1,0,0,1);class Wc{constructor(r,o,c){this.sensitivity=r?o?"variant":"case":o?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,o){return this.collator.compare(r,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Hc{constructor(r,o,c,g,v){this.text=r,this.image=o,this.scale=c,this.fontStack=g,this.textColor=v}}class Zr{constructor(r){this.sections=r}static fromString(r){return new Zr([new Hc(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof Zr?r:Zr.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}}class Wr{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Wr)return r;if(typeof r=="number")return new Wr([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const o of r)if(typeof o!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new Wr(r)}}toString(){return JSON.stringify(this.values)}}const ly=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class li{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof li)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let o=0;o<r.length;o+=2){const c=r[o],g=r[o+1];if(typeof c!="string"||!ly.has(c)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new li(r)}}toString(){return JSON.stringify(this.values)}}class Hr{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new Hr({name:r,available:!1}):null}}function Zo(s,r,o,c){return typeof s=="number"&&s>=0&&s<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof o=="number"&&o>=0&&o<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[s,r,o,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[s,r,o,c]:[s,r,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function lo(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Ht||s instanceof Wc||s instanceof Zr||s instanceof Wr||s instanceof li||s instanceof Hr)return!0;if(Array.isArray(s)){for(const r of s)if(!lo(r))return!1;return!0}if(typeof s=="object"){for(const r in s)if(!lo(s[r]))return!1;return!0}return!1}function Ln(s){if(s===null)return Bs;if(typeof s=="string")return Mt;if(typeof s=="boolean")return _t;if(typeof s=="number")return He;if(s instanceof Ht)return Er;if(s instanceof Wc)return Ji;if(s instanceof Zr)return ws;if(s instanceof Wr)return Os;if(s instanceof li)return ie;if(s instanceof Hr)return Qi;if(Array.isArray(s)){const r=s.length;let o;for(const c of s){const g=Ln(c);if(o){if(o===g)continue;o=Tt;break}o=g}return V(o||Tt,r)}return ki}function Ja(s){const r=typeof s;return s===null?"":r==="string"||r==="number"||r==="boolean"?String(s):s instanceof Ht||s instanceof Zr||s instanceof Wr||s instanceof li||s instanceof Hr?s.toString():JSON.stringify(s)}class Pi{constructor(r,o){this.type=r,this.value=o}static parse(r,o){if(r.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!lo(r[1]))return o.error("invalid value");const c=r[1];let g=Ln(c);const v=o.expectedType;return g.kind!=="array"||g.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(g=v),new Pi(g,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Pn{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const eu={string:Mt,number:He,boolean:_t,object:ki};class Ei{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");let c,g=1;const v=r[0];if(v==="array"){let b,S;if(r.length>2){const P=r[1];if(typeof P!="string"||!(P in eu)||P==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=eu[P],g++}else b=Tt;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return o.error('The length argument to "array" must be a positive integer literal',2);S=r[2],g++}c=V(b,S)}else{if(!eu[v])throw new Error(`Types doesn't contain name = ${v}`);c=eu[v]}const x=[];for(;g<r.length;g++){const b=o.parse(r[g],g,Tt);if(!b)return null;x.push(b)}return new Ei(c,x)}evaluate(r){for(let o=0;o<this.args.length;o++){const c=this.args[o].evaluate(r);if(!ne(this.type,Ln(c)))return c;if(o===this.args.length-1)throw new Pn(`Expected value to be of type ${O(this.type)}, but found ${O(Ln(c))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const Xc={"to-boolean":_t,"to-color":Er,"to-number":He,"to-string":Mt};class Ii{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");const c=r[0];if(!Xc[c])throw new Error(`Can't parse ${c} as it is not part of the known types`);if((c==="to-boolean"||c==="to-string")&&r.length!==2)return o.error("Expected one argument.");const g=Xc[c],v=[];for(let x=1;x<r.length;x++){const b=o.parse(r[x],x,Tt);if(!b)return null;v.push(b)}return new Ii(g,v)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let o,c;for(const g of this.args){if(o=g.evaluate(r),c=null,o instanceof Ht)return o;if(typeof o=="string"){const v=r.parseColor(o);if(v)return v}else if(Array.isArray(o)&&(c=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Zo(o[0],o[1],o[2],o[3]),!c))return new Ht(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Pn(c||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const c of this.args){o=c.evaluate(r);const g=Wr.parse(o);if(g)return g}throw new Pn(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const c of this.args){o=c.evaluate(r);const g=li.parse(o);if(g)return g}throw new Pn(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const c of this.args){if(o=c.evaluate(r),o===null)return 0;const g=Number(o);if(!isNaN(g))return g}throw new Pn(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return Zr.fromString(Ja(this.args[0].evaluate(r)));case"resolvedImage":return Hr.fromString(Ja(this.args[0].evaluate(r)));default:return Ja(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const uy=["Unknown","Point","LineString","Polygon"];class tu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?uy[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let o=this._parseColorCache[r];return o||(o=this._parseColorCache[r]=Ht.parse(r)),o}}class uo{constructor(r,o,c=[],g,v=new Yi,x=[]){this.registry=r,this.path=c,this.key=c.map(b=>`[${b}]`).join(""),this.scope=v,this.errors=x,this.expectedType=g,this._isConstant=o}parse(r,o,c,g,v={}){return o?this.concat(o,c,g)._parse(r,v):this._parse(r,v)}_parse(r,o){function c(g,v,x){return x==="assert"?new Ei(v,[g]):x==="coerce"?new Ii(v,[g]):g}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=r[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[g];if(v){let x=v.parse(r,this);if(!x)return null;if(this.expectedType){const b=this.expectedType,S=x.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||S.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(b.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(b.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(b,S))return null}else x=c(x,b,o.typeAnnotation||"coerce");else x=c(x,b,o.typeAnnotation||"coerce");else x=c(x,b,o.typeAnnotation||"coerce");else x=c(x,b,o.typeAnnotation||"assert")}if(!(x instanceof Pi)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const b=new tu;try{x=new Pi(x.type,x.evaluate(b))}catch(S){return this.error(S.message),null}}return x}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,o,c){const g=typeof r=="number"?this.path.concat(r):this.path,v=c?this.scope.concat(c):this.scope;return new uo(this.registry,this._isConstant,g,o||null,v,this.errors)}error(r,...o){const c=`${this.key}${o.map(g=>`[${g}]`).join("")}`;this.errors.push(new yr(c,r))}checkSubtype(r,o){const c=ne(r,o);return c&&this.error(c),c}}class Vs{constructor(r,o){this.type=o.type,this.bindings=[].concat(r),this.result=o}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const o of this.bindings)r(o[1]);r(this.result)}static parse(r,o){if(r.length<4)return o.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const c=[];for(let v=1;v<r.length-1;v+=2){const x=r[v];if(typeof x!="string")return o.error(`Expected string, but found ${typeof x} instead.`,v);if(/[^a-zA-Z0-9_]/.test(x))return o.error("Variable names must contain only alphanumeric characters or '_'.",v);const b=o.parse(r[v+1],v+1);if(!b)return null;c.push([x,b])}const g=o.parse(r[r.length-1],r.length-1,o.expectedType,c);return g?new Vs(c,g):null}outputDefined(){return this.result.outputDefined()}}class Gt{constructor(r,o){this.type=o.type,this.name=r,this.boundExpression=o}static parse(r,o){if(r.length!==2||typeof r[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const c=r[1];return o.scope.has(c)?new Gt(c,o.scope.get(c)):o.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class Kc{constructor(r,o,c){this.type=r,this.index=o,this.input=c}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=o.parse(r[1],1,He),g=o.parse(r[2],2,V(o.expectedType||Tt));return c&&g?new Kc(g.type.itemType,c,g):null}evaluate(r){const o=this.index.evaluate(r),c=this.input.evaluate(r);if(o<0)throw new Pn(`Array index out of bounds: ${o} < 0.`);if(o>=c.length)throw new Pn(`Array index out of bounds: ${o} > ${c.length-1}.`);if(o!==Math.floor(o))throw new Pn(`Array index must be an integer, but found ${o} instead.`);return c[o]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class Yc{constructor(r,o){this.type=_t,this.needle=r,this.haystack=o}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=o.parse(r[1],1,Tt),g=o.parse(r[2],2,Tt);return c&&g?fe(c.type,[_t,Mt,He,Bs,Tt])?new Yc(c,g):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${O(c.type)} instead`):null}evaluate(r){const o=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(!c)return!1;if(!ge(o,["boolean","string","number","null"]))throw new Pn(`Expected first argument to be of type boolean, string, number or null, but found ${O(Ln(o))} instead.`);if(!ge(c,["string","array"]))throw new Pn(`Expected second argument to be of type array or string, but found ${O(Ln(c))} instead.`);return c.indexOf(o)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class Wo{constructor(r,o,c){this.type=He,this.needle=r,this.haystack=o,this.fromIndex=c}static parse(r,o){if(r.length<=2||r.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=o.parse(r[1],1,Tt),g=o.parse(r[2],2,Tt);if(!c||!g)return null;if(!fe(c.type,[_t,Mt,He,Bs,Tt]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${O(c.type)} instead`);if(r.length===4){const v=o.parse(r[3],3,He);return v?new Wo(c,g,v):null}return new Wo(c,g)}evaluate(r){const o=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(!ge(o,["boolean","string","number","null"]))throw new Pn(`Expected first argument to be of type boolean, string, number or null, but found ${O(Ln(o))} instead.`);let g;if(this.fromIndex&&(g=this.fromIndex.evaluate(r)),ge(c,["string"])){const v=c.indexOf(o,g);return v===-1?-1:[...c.slice(0,v)].length}if(ge(c,["array"]))return c.indexOf(o,g);throw new Pn(`Expected second argument to be of type array or string, but found ${O(Ln(c))} instead.`)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class Jc{constructor(r,o,c,g,v,x){this.inputType=r,this.type=o,this.input=c,this.cases=g,this.outputs=v,this.otherwise=x}static parse(r,o){if(r.length<5)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return o.error("Expected an even number of arguments.");let c,g;o.expectedType&&o.expectedType.kind!=="value"&&(g=o.expectedType);const v={},x=[];for(let P=2;P<r.length-1;P+=2){let I=r[P];const R=r[P+1];Array.isArray(I)||(I=[I]);const B=o.concat(P);if(I.length===0)return B.error("Expected at least one branch label.");for(const $ of I){if(typeof $!="number"&&typeof $!="string")return B.error("Branch labels must be numbers or strings.");if(typeof $=="number"&&Math.abs($)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $=="number"&&Math.floor($)!==$)return B.error("Numeric branch labels must be integer values.");if(c){if(B.checkSubtype(c,Ln($)))return null}else c=Ln($);if(v[String($)]!==void 0)return B.error("Branch labels must be unique.");v[String($)]=x.length}const N=o.parse(R,P,g);if(!N)return null;g=g||N.type,x.push(N)}const b=o.parse(r[1],1,Tt);if(!b)return null;const S=o.parse(r[r.length-1],r.length-1,g);return S?b.type.kind!=="value"&&o.concat(1).checkSubtype(c,b.type)?null:new Jc(c,g,b,v,x,S):null}evaluate(r){const o=this.input.evaluate(r);return(Ln(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}}class nu{constructor(r,o,c){this.type=r,this.branches=o,this.otherwise=c}static parse(r,o){if(r.length<4)return o.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return o.error("Expected an odd number of arguments.");let c;o.expectedType&&o.expectedType.kind!=="value"&&(c=o.expectedType);const g=[];for(let x=1;x<r.length-1;x+=2){const b=o.parse(r[x],x,_t);if(!b)return null;const S=o.parse(r[x+1],x+1,c);if(!S)return null;g.push([b,S]),c=c||S.type}const v=o.parse(r[r.length-1],r.length-1,c);if(!v)return null;if(!c)throw new Error("Can't infer output type");return new nu(c,g,v)}evaluate(r){for(const[o,c]of this.branches)if(o.evaluate(r))return c.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[o,c]of this.branches)r(o),r(c);r(this.otherwise)}outputDefined(){return this.branches.every(([r,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class Qa{constructor(r,o,c,g){this.type=r,this.input=o,this.beginIndex=c,this.endIndex=g}static parse(r,o){if(r.length<=2||r.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=o.parse(r[1],1,Tt),g=o.parse(r[2],2,He);if(!c||!g)return null;if(!fe(c.type,[V(Tt),Mt,Tt]))return o.error(`Expected first argument to be of type array or string, but found ${O(c.type)} instead`);if(r.length===4){const v=o.parse(r[3],3,He);return v?new Qa(c.type,c,g,v):null}return new Qa(c.type,c,g)}evaluate(r){const o=this.input.evaluate(r),c=this.beginIndex.evaluate(r);let g;if(this.endIndex&&(g=this.endIndex.evaluate(r)),ge(o,["string"]))return[...o].slice(c,g).join("");if(ge(o,["array"]))return o.slice(c,g);throw new Pn(`Expected first argument to be of type array or string, but found ${O(Ln(o))} instead.`)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function ru(s,r){const o=s.length-1;let c,g,v=0,x=o,b=0;for(;v<=x;)if(b=Math.floor((v+x)/2),c=s[b],g=s[b+1],c<=r){if(b===o||r<g)return b;v=b+1}else{if(!(c>r))throw new Pn("Input is not a number.");x=b-1}return 0}class Ho{constructor(r,o,c){this.type=r,this.input=o,this.labels=[],this.outputs=[];for(const[g,v]of c)this.labels.push(g),this.outputs.push(v)}static parse(r,o){if(r.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return o.error("Expected an even number of arguments.");const c=o.parse(r[1],1,He);if(!c)return null;const g=[];let v=null;o.expectedType&&o.expectedType.kind!=="value"&&(v=o.expectedType);for(let x=1;x<r.length;x+=2){const b=x===1?-1/0:r[x],S=r[x+1],P=x,I=x+1;if(typeof b!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(g.length&&g[g.length-1][0]>=b)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const R=o.parse(S,I,v);if(!R)return null;v=v||R.type,g.push([b,R])}return new Ho(v,c,g)}evaluate(r){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(r);const g=this.input.evaluate(r);if(g<=o[0])return c[0].evaluate(r);const v=o.length;return g>=o[v-1]?c[v-1].evaluate(r):c[ru(o,g)].evaluate(r)}eachChild(r){r(this.input);for(const o of this.outputs)r(o)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function If(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var cy=Mf;function Mf(s,r,o,c){this.cx=3*s,this.bx=3*(o-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(c-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=r,this.p2x=o,this.p2y=c}Mf.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,r){if(r===void 0&&(r=1e-6),s<0)return 0;if(s>1)return 1;for(var o=s,c=0;c<8;c++){var g=this.sampleCurveX(o)-s;if(Math.abs(g)<r)return o;var v=this.sampleCurveDerivativeX(o);if(Math.abs(v)<1e-6)break;o-=g/v}var x=0,b=1;for(o=s,c=0;c<20&&(g=this.sampleCurveX(o),!(Math.abs(g-s)<r));c++)s>g?x=o:b=o,o=.5*(b-x)+x;return o},solve:function(s,r){return this.sampleCurveY(this.solveCurveX(s,r))}};var hy=If(cy);function co(s,r,o){return s+o*(r-s)}function el(s,r,o){return s.map((c,g)=>co(c,r[g],o))}const Ir={number:co,color:function(s,r,o,c="rgb"){switch(c){case"rgb":{const[g,v,x,b]=el(s.rgb,r.rgb,o);return new Ht(g,v,x,b,!1)}case"hcl":{const[g,v,x,b]=s.hcl,[S,P,I,R]=r.hcl;let B,N;if(isNaN(g)||isNaN(S))isNaN(g)?isNaN(S)?B=NaN:(B=S,x!==1&&x!==0||(N=P)):(B=g,I!==1&&I!==0||(N=v));else{let we=S-g;S>g&&we>180?we-=360:S<g&&g-S>180&&(we+=360),B=g+o*we}const[$,q,ee,se]=function([we,de,xe,Pe]){return we=isNaN(we)?0:we*pt,yn([xe,Math.cos(we)*de,Math.sin(we)*de,Pe])}([B,N??co(v,P,o),co(x,I,o),co(b,R,o)]);return new Ht($,q,ee,se,!1)}case"lab":{const[g,v,x,b]=yn(el(s.lab,r.lab,o));return new Ht(g,v,x,b,!1)}}},array:el,padding:function(s,r,o){return new Wr(el(s.values,r.values,o))},variableAnchorOffsetCollection:function(s,r,o){const c=s.values,g=r.values;if(c.length!==g.length)throw new Pn(`Cannot interpolate values of different length. from: ${s.toString()}, to: ${r.toString()}`);const v=[];for(let x=0;x<c.length;x+=2){if(c[x]!==g[x])throw new Pn(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${c[x]}, to[${x}]: ${g[x]}`);v.push(c[x]);const[b,S]=c[x+1],[P,I]=g[x+1];v.push([co(b,P,o),co(S,I,o)])}return new li(v)}};class Mr{constructor(r,o,c,g,v){this.type=r,this.operator=o,this.interpolation=c,this.input=g,this.labels=[],this.outputs=[];for(const[x,b]of v)this.labels.push(x),this.outputs.push(b)}static interpolationFactor(r,o,c,g){let v=0;if(r.name==="exponential")v=iu(o,r.base,c,g);else if(r.name==="linear")v=iu(o,1,c,g);else if(r.name==="cubic-bezier"){const x=r.controlPoints;v=new hy(x[0],x[1],x[2],x[3]).solve(iu(o,1,c,g))}return v}static parse(r,o){let[c,g,v,...x]=r;if(!Array.isArray(g)||g.length===0)return o.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const P=g[1];if(typeof P!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:P}}else{if(g[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const P=g.slice(1);if(P.length!==4||P.some(I=>typeof I!="number"||I<0||I>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:P}}}if(r.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(v=o.parse(v,2,He),!v)return null;const b=[];let S=null;c==="interpolate-hcl"||c==="interpolate-lab"?S=Er:o.expectedType&&o.expectedType.kind!=="value"&&(S=o.expectedType);for(let P=0;P<x.length;P+=2){const I=x[P],R=x[P+1],B=P+3,N=P+4;if(typeof I!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(b.length&&b[b.length-1][0]>=I)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const $=o.parse(R,N,S);if(!$)return null;S=S||$.type,b.push([I,$])}return be(S,He)||be(S,Er)||be(S,Os)||be(S,ie)||be(S,V(He))?new Mr(S,c,g,v,b):o.error(`Type ${O(S)} is not interpolatable.`)}evaluate(r){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(r);const g=this.input.evaluate(r);if(g<=o[0])return c[0].evaluate(r);const v=o.length;if(g>=o[v-1])return c[v-1].evaluate(r);const x=ru(o,g),b=Mr.interpolationFactor(this.interpolation,g,o[x],o[x+1]),S=c[x].evaluate(r),P=c[x+1].evaluate(r);switch(this.operator){case"interpolate":return Ir[this.type.kind](S,P,b);case"interpolate-hcl":return Ir.color(S,P,b,"hcl");case"interpolate-lab":return Ir.color(S,P,b,"lab")}}eachChild(r){r(this.input);for(const o of this.outputs)r(o)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function iu(s,r,o,c){const g=c-o,v=s-o;return g===0?0:r===1?v/g:(Math.pow(r,v)-1)/(Math.pow(r,g)-1)}class su{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expectected at least one argument.");let c=null;const g=o.expectedType;g&&g.kind!=="value"&&(c=g);const v=[];for(const b of r.slice(1)){const S=o.parse(b,1+v.length,c,void 0,{typeAnnotation:"omit"});if(!S)return null;c=c||S.type,v.push(S)}if(!c)throw new Error("No output type");const x=g&&v.some(b=>ne(g,b.type));return new su(x?Tt:c,v)}evaluate(r){let o,c=null,g=0;for(const v of this.args)if(g++,c=v.evaluate(r),c&&c instanceof Hr&&!c.available&&(o||(o=c.name),c=null,g===this.args.length&&(c=o)),c!==null)break;return c}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}function ou(s,r){return s==="=="||s==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function Af(s,r,o,c){return c.compare(r,o)===0}function Xo(s,r,o){const c=s!=="=="&&s!=="!=";return class NE{constructor(v,x,b){this.type=_t,this.lhs=v,this.rhs=x,this.collator=b,this.hasUntypedArgument=v.type.kind==="value"||x.type.kind==="value"}static parse(v,x){if(v.length!==3&&v.length!==4)return x.error("Expected two or three arguments.");const b=v[0];let S=x.parse(v[1],1,Tt);if(!S)return null;if(!ou(b,S.type))return x.concat(1).error(`"${b}" comparisons are not supported for type '${O(S.type)}'.`);let P=x.parse(v[2],2,Tt);if(!P)return null;if(!ou(b,P.type))return x.concat(2).error(`"${b}" comparisons are not supported for type '${O(P.type)}'.`);if(S.type.kind!==P.type.kind&&S.type.kind!=="value"&&P.type.kind!=="value")return x.error(`Cannot compare types '${O(S.type)}' and '${O(P.type)}'.`);c&&(S.type.kind==="value"&&P.type.kind!=="value"?S=new Ei(P.type,[S]):S.type.kind!=="value"&&P.type.kind==="value"&&(P=new Ei(S.type,[P])));let I=null;if(v.length===4){if(S.type.kind!=="string"&&P.type.kind!=="string"&&S.type.kind!=="value"&&P.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(I=x.parse(v[3],3,Ji),!I)return null}return new NE(S,P,I)}evaluate(v){const x=this.lhs.evaluate(v),b=this.rhs.evaluate(v);if(c&&this.hasUntypedArgument){const S=Ln(x),P=Ln(b);if(S.kind!==P.kind||S.kind!=="string"&&S.kind!=="number")throw new Pn(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${S.kind}, ${P.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const S=Ln(x),P=Ln(b);if(S.kind!=="string"||P.kind!=="string")return r(v,x,b)}return this.collator?o(v,x,b,this.collator.evaluate(v)):r(v,x,b)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const dy=Xo("==",function(s,r,o){return r===o},Af),zf=Xo("!=",function(s,r,o){return r!==o},function(s,r,o,c){return!Af(0,r,o,c)}),Df=Xo("<",function(s,r,o){return r<o},function(s,r,o,c){return c.compare(r,o)<0}),fy=Xo(">",function(s,r,o){return r>o},function(s,r,o,c){return c.compare(r,o)>0}),py=Xo("<=",function(s,r,o){return r<=o},function(s,r,o,c){return c.compare(r,o)<=0}),Rf=Xo(">=",function(s,r,o){return r>=o},function(s,r,o,c){return c.compare(r,o)>=0});class tl{constructor(r,o,c){this.type=Ji,this.locale=c,this.caseSensitive=r,this.diacriticSensitive=o}static parse(r,o){if(r.length!==2)return o.error("Expected one argument.");const c=r[1];if(typeof c!="object"||Array.isArray(c))return o.error("Collator options argument must be an object.");const g=o.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,_t);if(!g)return null;const v=o.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,_t);if(!v)return null;let x=null;return c.locale&&(x=o.parse(c.locale,1,Mt),!x)?null:new tl(g,v,x)}evaluate(r){return new Wc(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class Qc{constructor(r,o,c,g,v){this.type=Mt,this.number=r,this.locale=o,this.currency=c,this.minFractionDigits=g,this.maxFractionDigits=v}static parse(r,o){if(r.length!==3)return o.error("Expected two arguments.");const c=o.parse(r[1],1,He);if(!c)return null;const g=r[2];if(typeof g!="object"||Array.isArray(g))return o.error("NumberFormat options argument must be an object.");let v=null;if(g.locale&&(v=o.parse(g.locale,1,Mt),!v))return null;let x=null;if(g.currency&&(x=o.parse(g.currency,1,Mt),!x))return null;let b=null;if(g["min-fraction-digits"]&&(b=o.parse(g["min-fraction-digits"],1,He),!b))return null;let S=null;return g["max-fraction-digits"]&&(S=o.parse(g["max-fraction-digits"],1,He),!S)?null:new Qc(c,v,x,b,S)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class au{constructor(r){this.type=ws,this.sections=r}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");const c=r[1];if(!Array.isArray(c)&&typeof c=="object")return o.error("First argument must be an image or text section.");const g=[];let v=!1;for(let x=1;x<=r.length-1;++x){const b=r[x];if(v&&typeof b=="object"&&!Array.isArray(b)){v=!1;let S=null;if(b["font-scale"]&&(S=o.parse(b["font-scale"],1,He),!S))return null;let P=null;if(b["text-font"]&&(P=o.parse(b["text-font"],1,V(Mt)),!P))return null;let I=null;if(b["text-color"]&&(I=o.parse(b["text-color"],1,Er),!I))return null;const R=g[g.length-1];R.scale=S,R.font=P,R.textColor=I}else{const S=o.parse(r[x],1,Tt);if(!S)return null;const P=S.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,g.push({content:S,scale:null,font:null,textColor:null})}}return new au(g)}evaluate(r){return new Zr(this.sections.map(o=>{const c=o.content.evaluate(r);return Ln(c)===Qi?new Hc("",c,null,null,null):new Hc(Ja(c),null,o.scale?o.scale.evaluate(r):null,o.font?o.font.evaluate(r).join(","):null,o.textColor?o.textColor.evaluate(r):null)}))}eachChild(r){for(const o of this.sections)r(o.content),o.scale&&r(o.scale),o.font&&r(o.font),o.textColor&&r(o.textColor)}outputDefined(){return!1}}class eh{constructor(r){this.type=Qi,this.input=r}static parse(r,o){if(r.length!==2)return o.error("Expected two arguments.");const c=o.parse(r[1],1,Mt);return c?new eh(c):o.error("No image name provided.")}evaluate(r){const o=this.input.evaluate(r),c=Hr.fromString(o);return c&&r.availableImages&&(c.available=r.availableImages.indexOf(o)>-1),c}eachChild(r){r(this.input)}outputDefined(){return!1}}class th{constructor(r){this.type=He,this.input=r}static parse(r,o){if(r.length!==2)return o.error(`Expected 1 argument, but found ${r.length-1} instead.`);const c=o.parse(r[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${O(c.type)} instead.`):new th(c):null}evaluate(r){const o=this.input.evaluate(r);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new Pn(`Expected value to be of type string or array, but found ${O(Ln(o))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const es=8192;function my(s,r){const o=(180+s[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,g=Math.pow(2,r.z);return[Math.round(o*g*es),Math.round(c*g*es)]}function nh(s,r){const o=Math.pow(2,r.z);return[(g=(s[0]/es+r.x)/o,360*g-180),(c=(s[1]/es+r.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90)];var c,g}function ho(s,r){s[0]=Math.min(s[0],r[0]),s[1]=Math.min(s[1],r[1]),s[2]=Math.max(s[2],r[0]),s[3]=Math.max(s[3],r[1])}function Ns(s,r){return!(s[0]<=r[0]||s[2]>=r[2]||s[1]<=r[1]||s[3]>=r[3])}function qt(s,r,o){const c=s[0]-r[0],g=s[1]-r[1],v=s[0]-o[0],x=s[1]-o[1];return c*x-v*g==0&&c*v<=0&&g*x<=0}function lu(s,r,o,c){return(g=[c[0]-o[0],c[1]-o[1]])[0]*(v=[r[0]-s[0],r[1]-s[1]])[1]-g[1]*v[0]!=0&&!(!Ff(s,r,o,c)||!Ff(o,c,s,r));var g,v}function gy(s,r,o){for(const c of o)for(let g=0;g<c.length-1;++g)if(lu(s,r,c[g],c[g+1]))return!0;return!1}function Ko(s,r,o=!1){let c=!1;for(const b of r)for(let S=0;S<b.length-1;S++){if(qt(s,b[S],b[S+1]))return o;(v=b[S])[1]>(g=s)[1]!=(x=b[S+1])[1]>g[1]&&g[0]<(x[0]-v[0])*(g[1]-v[1])/(x[1]-v[1])+v[0]&&(c=!c)}var g,v,x;return c}function yy(s,r){for(const o of r)if(Ko(s,o))return!0;return!1}function Lf(s,r){for(const o of s)if(!Ko(o,r))return!1;for(let o=0;o<s.length-1;++o)if(gy(s[o],s[o+1],r))return!1;return!0}function _y(s,r){for(const o of r)if(Lf(s,o))return!0;return!1}function Ff(s,r,o,c){const g=c[0]-o[0],v=c[1]-o[1],x=(s[0]-o[0])*v-g*(s[1]-o[1]),b=(r[0]-o[0])*v-g*(r[1]-o[1]);return x>0&&b<0||x<0&&b>0}function rh(s,r,o){const c=[];for(let g=0;g<s.length;g++){const v=[];for(let x=0;x<s[g].length;x++){const b=my(s[g][x],o);ho(r,b),v.push(b)}c.push(v)}return c}function Bf(s,r,o){const c=[];for(let g=0;g<s.length;g++){const v=rh(s[g],r,o);c.push(v)}return c}function Of(s,r,o,c){if(s[0]<o[0]||s[0]>o[2]){const g=.5*c;let v=s[0]-o[0]>g?-c:o[0]-s[0]>g?c:0;v===0&&(v=s[0]-o[2]>g?-c:o[2]-s[0]>g?c:0),s[0]+=v}ho(r,s)}function Vf(s,r,o,c){const g=Math.pow(2,c.z)*es,v=[c.x*es,c.y*es],x=[];for(const b of s)for(const S of b){const P=[S.x+v[0],S.y+v[1]];Of(P,r,o,g),x.push(P)}return x}function Nf(s,r,o,c){const g=Math.pow(2,c.z)*es,v=[c.x*es,c.y*es],x=[];for(const S of s){const P=[];for(const I of S){const R=[I.x+v[0],I.y+v[1]];ho(r,R),P.push(R)}x.push(P)}if(r[2]-r[0]<=g/2){(b=r)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const S of x)for(const P of S)Of(P,r,o,g)}var b;return x}class fo{constructor(r,o){this.type=_t,this.geojson=r,this.geometries=o}static parse(r,o){if(r.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(lo(r[1])){const c=r[1];if(c.type==="FeatureCollection"){const g=[];for(const v of c.features){const{type:x,coordinates:b}=v.geometry;x==="Polygon"&&g.push(b),x==="MultiPolygon"&&g.push(...b)}if(g.length)return new fo(c,{type:"MultiPolygon",coordinates:g})}else if(c.type==="Feature"){const g=c.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new fo(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new fo(c,c)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(o,c){const g=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(c.type==="Polygon"){const b=rh(c.coordinates,v,x),S=Vf(o.geometry(),g,v,x);if(!Ns(g,v))return!1;for(const P of S)if(!Ko(P,b))return!1}if(c.type==="MultiPolygon"){const b=Bf(c.coordinates,v,x),S=Vf(o.geometry(),g,v,x);if(!Ns(g,v))return!1;for(const P of S)if(!yy(P,b))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(o,c){const g=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(c.type==="Polygon"){const b=rh(c.coordinates,v,x),S=Nf(o.geometry(),g,v,x);if(!Ns(g,v))return!1;for(const P of S)if(!Lf(P,b))return!1}if(c.type==="MultiPolygon"){const b=Bf(c.coordinates,v,x),S=Nf(o.geometry(),g,v,x);if(!Ns(g,v))return!1;for(const P of S)if(!_y(P,b))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let jf=class{constructor(s=[],r=(o,c)=>o<c?-1:o>c?1:0){if(this.data=s,this.length=this.data.length,this.compare=r,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:r,compare:o}=this,c=r[s];for(;s>0;){const g=s-1>>1,v=r[g];if(o(c,v)>=0)break;r[s]=v,s=g}r[s]=c}_down(s){const{data:r,compare:o}=this,c=this.length>>1,g=r[s];for(;s<c;){let v=1+(s<<1);const x=v+1;if(x<this.length&&o(r[x],r[v])<0&&(v=x),o(r[v],g)>=0)break;r[s]=r[v],s=v}r[s]=g}};function vy(s,r,o,c,g){$f(s,r,o,c||s.length-1,g||xy)}function $f(s,r,o,c,g){for(;c>o;){if(c-o>600){var v=c-o+1,x=r-o+1,b=Math.log(v),S=.5*Math.exp(2*b/3),P=.5*Math.sqrt(b*S*(v-S)/v)*(x-v/2<0?-1:1);$f(s,r,Math.max(o,Math.floor(r-x*S/v+P)),Math.min(c,Math.floor(r+(v-x)*S/v+P)),g)}var I=s[r],R=o,B=c;for(nl(s,o,r),g(s[c],I)>0&&nl(s,o,c);R<B;){for(nl(s,R,B),R++,B--;g(s[R],I)<0;)R++;for(;g(s[B],I)>0;)B--}g(s[o],I)===0?nl(s,o,B):nl(s,++B,c),B<=r&&(o=B+1),r<=B&&(c=B-1)}}function nl(s,r,o){var c=s[r];s[r]=s[o],s[o]=c}function xy(s,r){return s<r?-1:s>r?1:0}function uu(s,r){if(s.length<=1)return[s];const o=[];let c,g;for(const v of s){const x=wy(v);x!==0&&(v.area=Math.abs(x),g===void 0&&(g=x<0),g===x<0?(c&&o.push(c),c=[v]):c.push(v))}if(c&&o.push(c),r>1)for(let v=0;v<o.length;v++)o[v].length<=r||(vy(o[v],r,1,o[v].length-1,by),o[v]=o[v].slice(0,r));return o}function by(s,r){return r.area-s.area}function wy(s){let r=0;for(let o,c,g=0,v=s.length,x=v-1;g<v;x=g++)o=s[g],c=s[x],r+=(c.x-o.x)*(o.y+c.y);return r}const Uf=1/298.257223563,Gf=Uf*(2-Uf),qf=Math.PI/180;class ih{constructor(r){const o=6378.137*qf*1e3,c=Math.cos(r*qf),g=1/(1-Gf*(1-c*c)),v=Math.sqrt(g);this.kx=o*v*c,this.ky=o*v*g*(1-Gf)}distance(r,o){const c=this.wrap(r[0]-o[0])*this.kx,g=(r[1]-o[1])*this.ky;return Math.sqrt(c*c+g*g)}pointOnLine(r,o){let c,g,v,x,b=1/0;for(let S=0;S<r.length-1;S++){let P=r[S][0],I=r[S][1],R=this.wrap(r[S+1][0]-P)*this.kx,B=(r[S+1][1]-I)*this.ky,N=0;R===0&&B===0||(N=(this.wrap(o[0]-P)*this.kx*R+(o[1]-I)*this.ky*B)/(R*R+B*B),N>1?(P=r[S+1][0],I=r[S+1][1]):N>0&&(P+=R/this.kx*N,I+=B/this.ky*N)),R=this.wrap(o[0]-P)*this.kx,B=(o[1]-I)*this.ky;const $=R*R+B*B;$<b&&(b=$,c=P,g=I,v=S,x=N)}return{point:[c,g],index:v,t:Math.max(0,Math.min(1,x))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function Zf(s,r){return r[0]-s[0]}function cu(s){return s[1]-s[0]+1}function Ss(s,r){return s[1]>=s[0]&&s[1]<r}function sh(s,r){if(s[0]>s[1])return[null,null];const o=cu(s);if(r){if(o===2)return[s,null];const g=Math.floor(o/2);return[[s[0],s[0]+g],[s[0]+g,s[1]]]}if(o===1)return[s,null];const c=Math.floor(o/2)-1;return[[s[0],s[0]+c],[s[0]+c+1,s[1]]]}function oh(s,r){if(!Ss(r,s.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let c=r[0];c<=r[1];++c)ho(o,s[c]);return o}function ah(s){const r=[1/0,1/0,-1/0,-1/0];for(const o of s)for(const c of o)ho(r,c);return r}function hu(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function lh(s,r,o){if(!hu(s)||!hu(r))return NaN;let c=0,g=0;return s[2]<r[0]&&(c=r[0]-s[2]),s[0]>r[2]&&(c=s[0]-r[2]),s[1]>r[3]&&(g=s[1]-r[3]),s[3]<r[1]&&(g=r[1]-s[3]),o.distance([0,0],[c,g])}function po(s,r,o){const c=o.pointOnLine(r,s);return o.distance(s,c.point)}function uh(s,r,o,c,g){const v=Math.min(po(s,[o,c],g),po(r,[o,c],g)),x=Math.min(po(o,[s,r],g),po(c,[s,r],g));return Math.min(v,x)}function Sy(s,r,o,c,g){if(!Ss(r,s.length)||!Ss(c,o.length))return 1/0;let v=1/0;for(let x=r[0];x<r[1];++x){const b=s[x],S=s[x+1];for(let P=c[0];P<c[1];++P){const I=o[P],R=o[P+1];if(lu(b,S,I,R))return 0;v=Math.min(v,uh(b,S,I,R,g))}}return v}function bn(s,r,o,c,g){if(!Ss(r,s.length)||!Ss(c,o.length))return NaN;let v=1/0;for(let x=r[0];x<=r[1];++x)for(let b=c[0];b<=c[1];++b)if(v=Math.min(v,g.distance(s[x],o[b])),v===0)return v;return v}function Ty(s,r,o){if(Ko(s,r,!0))return 0;let c=1/0;for(const g of r){const v=g[0],x=g[g.length-1];if(v!==x&&(c=Math.min(c,po(s,[x,v],o)),c===0))return c;const b=o.pointOnLine(g,s);if(c=Math.min(c,o.distance(s,b.point)),c===0)return c}return c}function zt(s,r,o,c){if(!Ss(r,s.length))return NaN;for(let v=r[0];v<=r[1];++v)if(Ko(s[v],o,!0))return 0;let g=1/0;for(let v=r[0];v<r[1];++v){const x=s[v],b=s[v+1];for(const S of o)for(let P=0,I=S.length,R=I-1;P<I;R=P++){const B=S[R],N=S[P];if(lu(x,b,B,N))return 0;g=Math.min(g,uh(x,b,B,N,c))}}return g}function du(s,r){for(const o of s)for(const c of o)if(Ko(c,r,!0))return!0;return!1}function tn(s,r,o,c=1/0){const g=ah(s),v=ah(r);if(c!==1/0&&lh(g,v,o)>=c)return c;if(Ns(g,v)){if(du(s,r))return 0}else if(du(r,s))return 0;let x=1/0;for(const b of s)for(let S=0,P=b.length,I=P-1;S<P;I=S++){const R=b[I],B=b[S];for(const N of r)for(let $=0,q=N.length,ee=q-1;$<q;ee=$++){const se=N[ee],we=N[$];if(lu(R,B,se,we))return 0;x=Math.min(x,uh(R,B,se,we,o))}}return x}function Xt(s,r,o,c,g,v){if(!v)return;const x=lh(oh(c,v),g,o);x<r&&s.push([x,v,[0,0]])}function mo(s,r,o,c,g,v,x){if(!v||!x)return;const b=lh(oh(c,v),oh(g,x),o);b<r&&s.push([b,v,x])}function rl(s,r,o,c,g=1/0){let v=Math.min(c.distance(s[0],o[0][0]),g);if(v===0)return v;const x=new jf([[0,[0,s.length-1],[0,0]]],Zf),b=ah(o);for(;x.length>0;){const S=x.pop();if(S[0]>=v)continue;const P=S[1],I=r?50:100;if(cu(P)<=I){if(!Ss(P,s.length))return NaN;if(r){const R=zt(s,P,o,c);if(isNaN(R)||R===0)return R;v=Math.min(v,R)}else for(let R=P[0];R<=P[1];++R){const B=Ty(s[R],o,c);if(v=Math.min(v,B),v===0)return 0}}else{const R=sh(P,r);Xt(x,v,c,s,b,R[0]),Xt(x,v,c,s,b,R[1])}}return v}function il(s,r,o,c,g,v=1/0){let x=Math.min(v,g.distance(s[0],o[0]));if(x===0)return x;const b=new jf([[0,[0,s.length-1],[0,o.length-1]]],Zf);for(;b.length>0;){const S=b.pop();if(S[0]>=x)continue;const P=S[1],I=S[2],R=r?50:100,B=c?50:100;if(cu(P)<=R&&cu(I)<=B){if(!Ss(P,s.length)&&Ss(I,o.length))return NaN;let N;if(r&&c)N=Sy(s,P,o,I,g),x=Math.min(x,N);else if(r&&!c){const $=s.slice(P[0],P[1]+1);for(let q=I[0];q<=I[1];++q)if(N=po(o[q],$,g),x=Math.min(x,N),x===0)return x}else if(!r&&c){const $=o.slice(I[0],I[1]+1);for(let q=P[0];q<=P[1];++q)if(N=po(s[q],$,g),x=Math.min(x,N),x===0)return x}else N=bn(s,P,o,I,g),x=Math.min(x,N)}else{const N=sh(P,r),$=sh(I,c);mo(b,x,g,s,o,N[0],$[0]),mo(b,x,g,s,o,N[0],$[1]),mo(b,x,g,s,o,N[1],$[0]),mo(b,x,g,s,o,N[1],$[1])}}return x}function ch(s){return s.type==="MultiPolygon"?s.coordinates.map(r=>({type:"Polygon",coordinates:r})):s.type==="MultiLineString"?s.coordinates.map(r=>({type:"LineString",coordinates:r})):s.type==="MultiPoint"?s.coordinates.map(r=>({type:"Point",coordinates:r})):[s]}class go{constructor(r,o){this.type=He,this.geojson=r,this.geometries=o}static parse(r,o){if(r.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(lo(r[1])){const c=r[1];if(c.type==="FeatureCollection")return new go(c,c.features.map(g=>ch(g.geometry)).flat());if(c.type==="Feature")return new go(c,ch(c.geometry));if("type"in c&&"coordinates"in c)return new go(c,ch(c))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(o,c){const g=o.geometry(),v=g.flat().map(S=>nh([S.x,S.y],o.canonical));if(g.length===0)return NaN;const x=new ih(v[0][1]);let b=1/0;for(const S of c){switch(S.type){case"Point":b=Math.min(b,il(v,!1,[S.coordinates],!1,x,b));break;case"LineString":b=Math.min(b,il(v,!1,S.coordinates,!0,x,b));break;case"Polygon":b=Math.min(b,rl(v,!1,S.coordinates,x,b))}if(b===0)return b}return b}(r,this.geometries);if(r.geometryType()==="LineString")return function(o,c){const g=o.geometry(),v=g.flat().map(S=>nh([S.x,S.y],o.canonical));if(g.length===0)return NaN;const x=new ih(v[0][1]);let b=1/0;for(const S of c){switch(S.type){case"Point":b=Math.min(b,il(v,!0,[S.coordinates],!1,x,b));break;case"LineString":b=Math.min(b,il(v,!0,S.coordinates,!0,x,b));break;case"Polygon":b=Math.min(b,rl(v,!0,S.coordinates,x,b))}if(b===0)return b}return b}(r,this.geometries);if(r.geometryType()==="Polygon")return function(o,c){const g=o.geometry();if(g.length===0||g[0].length===0)return NaN;const v=uu(g,0).map(S=>S.map(P=>P.map(I=>nh([I.x,I.y],o.canonical)))),x=new ih(v[0][0][0][1]);let b=1/0;for(const S of c)for(const P of v){switch(S.type){case"Point":b=Math.min(b,rl([S.coordinates],!1,P,x,b));break;case"LineString":b=Math.min(b,rl(S.coordinates,!0,P,x,b));break;case"Polygon":b=Math.min(b,tn(P,S.coordinates,x,b))}if(b===0)return b}return b}(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Yo={"==":dy,"!=":zf,">":fy,"<":Df,">=":Rf,"<=":py,array:Ei,at:Kc,boolean:Ei,case:nu,coalesce:su,collator:tl,format:au,image:eh,in:Yc,"index-of":Wo,interpolate:Mr,"interpolate-hcl":Mr,"interpolate-lab":Mr,length:th,let:Vs,literal:Pi,match:Jc,number:Ei,"number-format":Qc,object:Ei,slice:Qa,step:Ho,string:Ei,"to-boolean":Ii,"to-color":Ii,"to-number":Ii,"to-string":Ii,var:Gt,within:fo,distance:go};class ui{constructor(r,o,c,g){this.name=r,this.type=o,this._evaluate=c,this.args=g}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,o){const c=r[0],g=ui.definitions[c];if(!g)return o.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(g)?g[0]:g.type,x=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,b=x.filter(([P])=>!Array.isArray(P)||P.length===r.length-1);let S=null;for(const[P,I]of b){S=new uo(o.registry,sl,o.path,null,o.scope);const R=[];let B=!1;for(let N=1;N<r.length;N++){const $=r[N],q=Array.isArray(P)?P[N-1]:P.type,ee=S.parse($,1+R.length,q);if(!ee){B=!0;break}R.push(ee)}if(!B)if(Array.isArray(P)&&P.length!==R.length)S.error(`Expected ${P.length} arguments, but found ${R.length} instead.`);else{for(let N=0;N<R.length;N++){const $=Array.isArray(P)?P[N]:P.type,q=R[N];S.concat(N+1).checkSubtype($,q.type)}if(S.errors.length===0)return new ui(c,v,I,R)}}if(b.length===1)o.errors.push(...S.errors);else{const P=(b.length?b:x).map(([R])=>{return B=R,Array.isArray(B)?`(${B.map(O).join(", ")})`:`(${O(B.type)}...)`;var B}).join(" | "),I=[];for(let R=1;R<r.length;R++){const B=o.parse(r[R],1+I.length);if(!B)return null;I.push(O(B.type))}o.error(`Expected arguments of type ${P}, but found (${I.join(", ")}) instead.`)}return null}static register(r,o){ui.definitions=o;for(const c in o)r[c]=ui}}function hh(s,[r,o,c,g]){r=r.evaluate(s),o=o.evaluate(s),c=c.evaluate(s);const v=g?g.evaluate(s):1,x=Zo(r,o,c,v);if(x)throw new Pn(x);return new Ht(r/255,o/255,c/255,v,!1)}function dh(s,r){return s in r}function fh(s,r){const o=r[s];return o===void 0?null:o}function yo(s){return{type:s}}function sl(s){if(s instanceof Gt)return sl(s.boundExpression);if(s instanceof ui&&s.name==="error"||s instanceof tl||s instanceof fo||s instanceof go)return!1;const r=s instanceof Ii||s instanceof Ei;let o=!0;return s.eachChild(c=>{o=r?o&&sl(c):o&&c instanceof Pi}),!!o&&ol(s)&&al(s,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function ol(s){if(s instanceof ui&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof fo||s instanceof go)return!1;let r=!0;return s.eachChild(o=>{r&&!ol(o)&&(r=!1)}),r}function Jo(s){if(s instanceof ui&&s.name==="feature-state")return!1;let r=!0;return s.eachChild(o=>{r&&!Jo(o)&&(r=!1)}),r}function al(s,r){if(s instanceof ui&&r.indexOf(s.name)>=0)return!1;let o=!0;return s.eachChild(c=>{o&&!al(c,r)&&(o=!1)}),o}function fu(s){return{result:"success",value:s}}function Qo(s){return{result:"error",value:s}}function ea(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function Wf(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function ph(s){return!!s.expression&&s.expression.interpolated}function $t(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function pu(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function Cy(s){return s}function Hf(s,r){const o=r.type==="color",c=s.stops&&typeof s.stops[0][0]=="object",g=c||!(c||s.property!==void 0),v=s.type||(ph(r)?"exponential":"interval");if(o||r.type==="padding"){const I=o?Ht.parse:Wr.parse;(s=Ki({},s)).stops&&(s.stops=s.stops.map(R=>[R[0],I(R[1])])),s.default=I(s.default?s.default:r.default)}if(s.colorSpace&&(x=s.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var x;let b,S,P;if(v==="exponential")b=Kf;else if(v==="interval")b=mu;else if(v==="categorical"){b=Xf,S=Object.create(null);for(const I of s.stops)S[I[0]]=I[1];P=typeof s.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);b=Yf}if(c){const I={},R=[];for(let $=0;$<s.stops.length;$++){const q=s.stops[$],ee=q[0].zoom;I[ee]===void 0&&(I[ee]={zoom:ee,type:s.type,property:s.property,default:s.default,stops:[]},R.push(ee)),I[ee].stops.push([q[0].value,q[1]])}const B=[];for(const $ of R)B.push([I[$].zoom,Hf(I[$],r)]);const N={name:"linear"};return{kind:"composite",interpolationType:N,interpolationFactor:Mr.interpolationFactor.bind(void 0,N),zoomStops:B.map($=>$[0]),evaluate:({zoom:$},q)=>Kf({stops:B,base:s.base},r,$).evaluate($,q)}}if(g){const I=v==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:Mr.interpolationFactor.bind(void 0,I),zoomStops:s.stops.map(R=>R[0]),evaluate:({zoom:R})=>b(s,r,R,S,P)}}return{kind:"source",evaluate(I,R){const B=R&&R.properties?R.properties[s.property]:void 0;return B===void 0?ta(s.default,r.default):b(s,r,B,S,P)}}}function ta(s,r,o){return s!==void 0?s:r!==void 0?r:o!==void 0?o:void 0}function Xf(s,r,o,c,g){return ta(typeof o===g?c[o]:void 0,s.default,r.default)}function mu(s,r,o){if($t(o)!=="number")return ta(s.default,r.default);const c=s.stops.length;if(c===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[c-1][0])return s.stops[c-1][1];const g=ru(s.stops.map(v=>v[0]),o);return s.stops[g][1]}function Kf(s,r,o){const c=s.base!==void 0?s.base:1;if($t(o)!=="number")return ta(s.default,r.default);const g=s.stops.length;if(g===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[g-1][0])return s.stops[g-1][1];const v=ru(s.stops.map(I=>I[0]),o),x=function(I,R,B,N){const $=N-B,q=I-B;return $===0?0:R===1?q/$:(Math.pow(R,q)-1)/(Math.pow(R,$)-1)}(o,c,s.stops[v][0],s.stops[v+1][0]),b=s.stops[v][1],S=s.stops[v+1][1],P=Ir[r.type]||Cy;return typeof b.evaluate=="function"?{evaluate(...I){const R=b.evaluate.apply(void 0,I),B=S.evaluate.apply(void 0,I);if(R!==void 0&&B!==void 0)return P(R,B,x,s.colorSpace)}}:P(b,S,x,s.colorSpace)}function Yf(s,r,o){switch(r.type){case"color":o=Ht.parse(o);break;case"formatted":o=Zr.fromString(o.toString());break;case"resolvedImage":o=Hr.fromString(o.toString());break;case"padding":o=Wr.parse(o);break;default:$t(o)===r.type||r.type==="enum"&&r.values[o]||(o=void 0)}return ta(o,s.default,r.default)}ui.register(Yo,{error:[{kind:"error"},[Mt],(s,[r])=>{throw new Pn(r.evaluate(s))}],typeof:[Mt,[Tt],(s,[r])=>O(Ln(r.evaluate(s)))],"to-rgba":[V(He,4),[Er],(s,[r])=>{const[o,c,g,v]=r.evaluate(s).rgb;return[255*o,255*c,255*g,v]}],rgb:[Er,[He,He,He],hh],rgba:[Er,[He,He,He,He],hh],has:{type:_t,overloads:[[[Mt],(s,[r])=>dh(r.evaluate(s),s.properties())],[[Mt,ki],(s,[r,o])=>dh(r.evaluate(s),o.evaluate(s))]]},get:{type:Tt,overloads:[[[Mt],(s,[r])=>fh(r.evaluate(s),s.properties())],[[Mt,ki],(s,[r,o])=>fh(r.evaluate(s),o.evaluate(s))]]},"feature-state":[Tt,[Mt],(s,[r])=>fh(r.evaluate(s),s.featureState||{})],properties:[ki,[],s=>s.properties()],"geometry-type":[Mt,[],s=>s.geometryType()],id:[Tt,[],s=>s.id()],zoom:[He,[],s=>s.globals.zoom],"heatmap-density":[He,[],s=>s.globals.heatmapDensity||0],"line-progress":[He,[],s=>s.globals.lineProgress||0],accumulated:[Tt,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[He,yo(He),(s,r)=>{let o=0;for(const c of r)o+=c.evaluate(s);return o}],"*":[He,yo(He),(s,r)=>{let o=1;for(const c of r)o*=c.evaluate(s);return o}],"-":{type:He,overloads:[[[He,He],(s,[r,o])=>r.evaluate(s)-o.evaluate(s)],[[He],(s,[r])=>-r.evaluate(s)]]},"/":[He,[He,He],(s,[r,o])=>r.evaluate(s)/o.evaluate(s)],"%":[He,[He,He],(s,[r,o])=>r.evaluate(s)%o.evaluate(s)],ln2:[He,[],()=>Math.LN2],pi:[He,[],()=>Math.PI],e:[He,[],()=>Math.E],"^":[He,[He,He],(s,[r,o])=>Math.pow(r.evaluate(s),o.evaluate(s))],sqrt:[He,[He],(s,[r])=>Math.sqrt(r.evaluate(s))],log10:[He,[He],(s,[r])=>Math.log(r.evaluate(s))/Math.LN10],ln:[He,[He],(s,[r])=>Math.log(r.evaluate(s))],log2:[He,[He],(s,[r])=>Math.log(r.evaluate(s))/Math.LN2],sin:[He,[He],(s,[r])=>Math.sin(r.evaluate(s))],cos:[He,[He],(s,[r])=>Math.cos(r.evaluate(s))],tan:[He,[He],(s,[r])=>Math.tan(r.evaluate(s))],asin:[He,[He],(s,[r])=>Math.asin(r.evaluate(s))],acos:[He,[He],(s,[r])=>Math.acos(r.evaluate(s))],atan:[He,[He],(s,[r])=>Math.atan(r.evaluate(s))],min:[He,yo(He),(s,r)=>Math.min(...r.map(o=>o.evaluate(s)))],max:[He,yo(He),(s,r)=>Math.max(...r.map(o=>o.evaluate(s)))],abs:[He,[He],(s,[r])=>Math.abs(r.evaluate(s))],round:[He,[He],(s,[r])=>{const o=r.evaluate(s);return o<0?-Math.round(-o):Math.round(o)}],floor:[He,[He],(s,[r])=>Math.floor(r.evaluate(s))],ceil:[He,[He],(s,[r])=>Math.ceil(r.evaluate(s))],"filter-==":[_t,[Mt,Tt],(s,[r,o])=>s.properties()[r.value]===o.value],"filter-id-==":[_t,[Tt],(s,[r])=>s.id()===r.value],"filter-type-==":[_t,[Mt],(s,[r])=>s.geometryType()===r.value],"filter-<":[_t,[Mt,Tt],(s,[r,o])=>{const c=s.properties()[r.value],g=o.value;return typeof c==typeof g&&c<g}],"filter-id-<":[_t,[Tt],(s,[r])=>{const o=s.id(),c=r.value;return typeof o==typeof c&&o<c}],"filter->":[_t,[Mt,Tt],(s,[r,o])=>{const c=s.properties()[r.value],g=o.value;return typeof c==typeof g&&c>g}],"filter-id->":[_t,[Tt],(s,[r])=>{const o=s.id(),c=r.value;return typeof o==typeof c&&o>c}],"filter-<=":[_t,[Mt,Tt],(s,[r,o])=>{const c=s.properties()[r.value],g=o.value;return typeof c==typeof g&&c<=g}],"filter-id-<=":[_t,[Tt],(s,[r])=>{const o=s.id(),c=r.value;return typeof o==typeof c&&o<=c}],"filter->=":[_t,[Mt,Tt],(s,[r,o])=>{const c=s.properties()[r.value],g=o.value;return typeof c==typeof g&&c>=g}],"filter-id->=":[_t,[Tt],(s,[r])=>{const o=s.id(),c=r.value;return typeof o==typeof c&&o>=c}],"filter-has":[_t,[Tt],(s,[r])=>r.value in s.properties()],"filter-has-id":[_t,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[_t,[V(Mt)],(s,[r])=>r.value.indexOf(s.geometryType())>=0],"filter-id-in":[_t,[V(Tt)],(s,[r])=>r.value.indexOf(s.id())>=0],"filter-in-small":[_t,[Mt,V(Tt)],(s,[r,o])=>o.value.indexOf(s.properties()[r.value])>=0],"filter-in-large":[_t,[Mt,V(Tt)],(s,[r,o])=>function(c,g,v,x){for(;v<=x;){const b=v+x>>1;if(g[b]===c)return!0;g[b]>c?x=b-1:v=b+1}return!1}(s.properties()[r.value],o.value,0,o.value.length-1)],all:{type:_t,overloads:[[[_t,_t],(s,[r,o])=>r.evaluate(s)&&o.evaluate(s)],[yo(_t),(s,r)=>{for(const o of r)if(!o.evaluate(s))return!1;return!0}]]},any:{type:_t,overloads:[[[_t,_t],(s,[r,o])=>r.evaluate(s)||o.evaluate(s)],[yo(_t),(s,r)=>{for(const o of r)if(o.evaluate(s))return!0;return!1}]]},"!":[_t,[_t],(s,[r])=>!r.evaluate(s)],"is-supported-script":[_t,[Mt],(s,[r])=>{const o=s.globals&&s.globals.isSupportedScript;return!o||o(r.evaluate(s))}],upcase:[Mt,[Mt],(s,[r])=>r.evaluate(s).toUpperCase()],downcase:[Mt,[Mt],(s,[r])=>r.evaluate(s).toLowerCase()],concat:[Mt,yo(Tt),(s,r)=>r.map(o=>Ja(o.evaluate(s))).join("")],"resolved-locale":[Mt,[Ji],(s,[r])=>r.evaluate(s).resolvedLocale()]});class gu{constructor(r,o){var c;this.expression=r,this._warningHistory={},this._evaluator=new tu,this._defaultValue=o?(c=o).type==="color"&&pu(c.default)?new Ht(0,0,0,0):c.type==="color"?Ht.parse(c.default)||null:c.type==="padding"?Wr.parse(c.default)||null:c.type==="variableAnchorOffsetCollection"?li.parse(c.default)||null:c.default===void 0?null:c.default:null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(r,o,c,g,v,x){return this._evaluator.globals=r,this._evaluator.feature=o,this._evaluator.featureState=c,this._evaluator.canonical=g,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(r,o,c,g,v,x){this._evaluator.globals=r,this._evaluator.feature=o||null,this._evaluator.featureState=c||null,this._evaluator.canonical=g,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Pn(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function yu(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in Yo}function na(s,r){const o=new uo(Yo,sl,[],r?function(g){const v={color:Er,string:Mt,number:He,enum:Mt,boolean:_t,formatted:ws,padding:Os,resolvedImage:Qi,variableAnchorOffsetCollection:ie};return g.type==="array"?V(v[g.value]||Tt,g.length):v[g.type]}(r):void 0),c=o.parse(s,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?fu(new gu(c,r)):Qo(o.errors)}class ra{constructor(r,o){this.kind=r,this._styleExpression=o,this.isStateDependent=r!=="constant"&&!Jo(o.expression)}evaluateWithoutErrorHandling(r,o,c,g,v,x){return this._styleExpression.evaluateWithoutErrorHandling(r,o,c,g,v,x)}evaluate(r,o,c,g,v,x){return this._styleExpression.evaluate(r,o,c,g,v,x)}}class ia{constructor(r,o,c,g){this.kind=r,this.zoomStops=c,this._styleExpression=o,this.isStateDependent=r!=="camera"&&!Jo(o.expression),this.interpolationType=g}evaluateWithoutErrorHandling(r,o,c,g,v,x){return this._styleExpression.evaluateWithoutErrorHandling(r,o,c,g,v,x)}evaluate(r,o,c,g,v,x){return this._styleExpression.evaluate(r,o,c,g,v,x)}interpolationFactor(r,o,c){return this.interpolationType?Mr.interpolationFactor(this.interpolationType,r,o,c):0}}function mh(s,r){const o=na(s,r);if(o.result==="error")return o;const c=o.value.expression,g=ol(c);if(!g&&!ea(r))return Qo([new yr("","data expressions not supported")]);const v=al(c,["zoom"]);if(!v&&!Wf(r))return Qo([new yr("","zoom expressions not supported")]);const x=ll(c);return x||v?x instanceof yr?Qo([x]):x instanceof Mr&&!ph(r)?Qo([new yr("",'"interpolate" expressions cannot be used with this property')]):fu(x?new ia(g?"camera":"composite",o.value,x.labels,x instanceof Mr?x.interpolation:void 0):new ra(g?"constant":"source",o.value)):Qo([new yr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class sa{constructor(r,o){this._parameters=r,this._specification=o,Ki(this,Hf(this._parameters,this._specification))}static deserialize(r){return new sa(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function ll(s){let r=null;if(s instanceof Vs)r=ll(s.result);else if(s instanceof su){for(const o of s.args)if(r=ll(o),r)break}else(s instanceof Ho||s instanceof Mr)&&s.input instanceof ui&&s.input.name==="zoom"&&(r=s);return r instanceof yr||s.eachChild(o=>{const c=ll(o);c instanceof yr?r=c:!r&&c?r=new yr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&c&&r!==c&&(r=new yr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function _u(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const r of s.slice(1))if(!_u(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const vu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function gh(s){if(s==null)return{filter:()=>!0,needGeometry:!1};_u(s)||(s=xu(s));const r=na(s,vu);if(r.result==="error")throw new Error(r.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,c,g)=>r.value.evaluate(o,c,{},g),needGeometry:Jf(s)}}function ky(s,r){return s<r?-1:s>r?1:0}function Jf(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let r=1;r<s.length;r++)if(Jf(s[r]))return!0;return!1}function xu(s){if(!s)return!0;const r=s[0];return s.length<=1?r!=="any":r==="=="?yh(s[1],s[2],"=="):r==="!="?or(yh(s[1],s[2],"==")):r==="<"||r===">"||r==="<="||r===">="?yh(s[1],s[2],r):r==="any"?(o=s.slice(1),["any"].concat(o.map(xu))):r==="all"?["all"].concat(s.slice(1).map(xu)):r==="none"?["all"].concat(s.slice(1).map(xu).map(or)):r==="in"?ul(s[1],s.slice(2)):r==="!in"?or(ul(s[1],s.slice(2))):r==="has"?cl(s[1]):r!=="!has"||or(cl(s[1]));var o}function yh(s,r,o){switch(s){case"$type":return[`filter-type-${o}`,r];case"$id":return[`filter-id-${o}`,r];default:return[`filter-${o}`,s,r]}}function ul(s,r){if(r.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(o=>typeof o!=typeof r[0])?["filter-in-large",s,["literal",r.sort(ky)]]:["filter-in-small",s,["literal",r]]}}function cl(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function or(s){return["!",s]}function _o(s){const r=typeof s;if(r==="number"||r==="boolean"||r==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let g="[";for(const v of s)g+=`${_o(v)},`;return`${g}]`}const o=Object.keys(s).sort();let c="{";for(let g=0;g<o.length;g++)c+=`${JSON.stringify(o[g])}:${_o(s[o[g]])},`;return`${c}}`}function Qf(s){let r="";for(const o of oi)r+=`/${_o(s[o])}`;return r}function ep(s){const r=s.value;return r?[new $e(s.key,r,"constants have been deprecated as of v8")]:[]}function wn(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Mi(s){if(Array.isArray(s))return s.map(Mi);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const r={};for(const o in s)r[o]=Mi(s[o]);return r}return wn(s)}function Xr(s){const r=s.key,o=s.value,c=s.valueSpec||{},g=s.objectElementValidators||{},v=s.style,x=s.styleSpec,b=s.validateSpec;let S=[];const P=$t(o);if(P!=="object")return[new $e(r,o,`object expected, ${P} found`)];for(const I in o){const R=I.split(".")[0],B=c[R]||c["*"];let N;if(g[R])N=g[R];else if(c[R])N=b;else if(g["*"])N=g["*"];else{if(!c["*"]){S.push(new $e(r,o[I],`unknown property "${I}"`));continue}N=b}S=S.concat(N({key:(r&&`${r}.`)+I,value:o[I],valueSpec:B,style:v,styleSpec:x,object:o,objectKey:I,validateSpec:b},o))}for(const I in c)g[I]||c[I].required&&c[I].default===void 0&&o[I]===void 0&&S.push(new $e(r,o,`missing required property "${I}"`));return S}function hl(s){const r=s.value,o=s.valueSpec,c=s.style,g=s.styleSpec,v=s.key,x=s.arrayElementValidator||s.validateSpec;if($t(r)!=="array")return[new $e(v,r,`array expected, ${$t(r)} found`)];if(o.length&&r.length!==o.length)return[new $e(v,r,`array length ${o.length} expected, length ${r.length} found`)];if(o["min-length"]&&r.length<o["min-length"])return[new $e(v,r,`array length at least ${o["min-length"]} expected, length ${r.length} found`)];let b={type:o.value,values:o.values};g.$version<7&&(b.function=o.function),$t(o.value)==="object"&&(b=o.value);let S=[];for(let P=0;P<r.length;P++)S=S.concat(x({array:r,arrayIndex:P,value:r[P],valueSpec:b,validateSpec:s.validateSpec,style:c,styleSpec:g,key:`${v}[${P}]`}));return S}function _h(s){const r=s.key,o=s.value,c=s.valueSpec;let g=$t(o);return g==="number"&&o!=o&&(g="NaN"),g!=="number"?[new $e(r,o,`number expected, ${g} found`)]:"minimum"in c&&o<c.minimum?[new $e(r,o,`${o} is less than the minimum value ${c.minimum}`)]:"maximum"in c&&o>c.maximum?[new $e(r,o,`${o} is greater than the maximum value ${c.maximum}`)]:[]}function bu(s){const r=s.valueSpec,o=wn(s.value.type);let c,g,v,x={};const b=o!=="categorical"&&s.value.property===void 0,S=!b,P=$t(s.value.stops)==="array"&&$t(s.value.stops[0])==="array"&&$t(s.value.stops[0][0])==="object",I=Xr({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(N){if(o==="identity")return[new $e(N.key,N.value,'identity function may not have a "stops" property')];let $=[];const q=N.value;return $=$.concat(hl({key:N.key,value:q,valueSpec:N.valueSpec,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec,arrayElementValidator:R})),$t(q)==="array"&&q.length===0&&$.push(new $e(N.key,q,"array must have at least one stop")),$},default:function(N){return N.validateSpec({key:N.key,value:N.value,valueSpec:r,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec})}}});return o==="identity"&&b&&I.push(new $e(s.key,s.value,'missing required property "property"')),o==="identity"||s.value.stops||I.push(new $e(s.key,s.value,'missing required property "stops"')),o==="exponential"&&s.valueSpec.expression&&!ph(s.valueSpec)&&I.push(new $e(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(S&&!ea(s.valueSpec)?I.push(new $e(s.key,s.value,"property functions not supported")):b&&!Wf(s.valueSpec)&&I.push(new $e(s.key,s.value,"zoom functions not supported"))),o!=="categorical"&&!P||s.value.property!==void 0||I.push(new $e(s.key,s.value,'"property" property is required')),I;function R(N){let $=[];const q=N.value,ee=N.key;if($t(q)!=="array")return[new $e(ee,q,`array expected, ${$t(q)} found`)];if(q.length!==2)return[new $e(ee,q,`array length 2 expected, length ${q.length} found`)];if(P){if($t(q[0])!=="object")return[new $e(ee,q,`object expected, ${$t(q[0])} found`)];if(q[0].zoom===void 0)return[new $e(ee,q,"object stop key must have zoom")];if(q[0].value===void 0)return[new $e(ee,q,"object stop key must have value")];if(v&&v>wn(q[0].zoom))return[new $e(ee,q[0].zoom,"stop zoom values must appear in ascending order")];wn(q[0].zoom)!==v&&(v=wn(q[0].zoom),g=void 0,x={}),$=$.concat(Xr({key:`${ee}[0]`,value:q[0],valueSpec:{zoom:{}},validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec,objectElementValidators:{zoom:_h,value:B}}))}else $=$.concat(B({key:`${ee}[0]`,value:q[0],validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec},q));return yu(Mi(q[1]))?$.concat([new $e(`${ee}[1]`,q[1],"expressions are not allowed in function stops.")]):$.concat(N.validateSpec({key:`${ee}[1]`,value:q[1],valueSpec:r,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec}))}function B(N,$){const q=$t(N.value),ee=wn(N.value),se=N.value!==null?N.value:$;if(c){if(q!==c)return[new $e(N.key,se,`${q} stop domain type must match previous stop domain type ${c}`)]}else c=q;if(q!=="number"&&q!=="string"&&q!=="boolean")return[new $e(N.key,se,"stop domain value must be a number, string, or boolean")];if(q!=="number"&&o!=="categorical"){let we=`number expected, ${q} found`;return ea(r)&&o===void 0&&(we+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $e(N.key,se,we)]}return o!=="categorical"||q!=="number"||isFinite(ee)&&Math.floor(ee)===ee?o!=="categorical"&&q==="number"&&g!==void 0&&ee<g?[new $e(N.key,se,"stop domain values must appear in ascending order")]:(g=ee,o==="categorical"&&ee in x?[new $e(N.key,se,"stop domain values must be unique")]:(x[ee]=!0,[])):[new $e(N.key,se,`integer expected, found ${ee}`)]}}function oa(s){const r=(s.expressionContext==="property"?mh:na)(Mi(s.value),s.valueSpec);if(r.result==="error")return r.value.map(c=>new $e(`${s.key}${c.key}`,s.value,c.message));const o=r.value.expression||r.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!o.outputDefined())return[new $e(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!Jo(o))return[new $e(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!Jo(o))return[new $e(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!al(o,["zoom","feature-state"]))return[new $e(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!ol(o))return[new $e(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ts(s){const r=s.key,o=s.value,c=s.valueSpec,g=[];return Array.isArray(c.values)?c.values.indexOf(wn(o))===-1&&g.push(new $e(r,o,`expected one of [${c.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(c.values).indexOf(wn(o))===-1&&g.push(new $e(r,o,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(o)} found`)),g}function vh(s){return _u(Mi(s.value))?oa(Ki({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):wu(s)}function wu(s){const r=s.value,o=s.key;if($t(r)!=="array")return[new $e(o,r,`array expected, ${$t(r)} found`)];const c=s.styleSpec;let g,v=[];if(r.length<1)return[new $e(o,r,"filter array must have at least 1 element")];switch(v=v.concat(Ts({key:`${o}[0]`,value:r[0],valueSpec:c.filter_operator,style:s.style,styleSpec:s.styleSpec})),wn(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&wn(r[1])==="$type"&&v.push(new $e(o,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&v.push(new $e(o,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(g=$t(r[1]),g!=="string"&&v.push(new $e(`${o}[1]`,r[1],`string expected, ${g} found`)));for(let x=2;x<r.length;x++)g=$t(r[x]),wn(r[1])==="$type"?v=v.concat(Ts({key:`${o}[${x}]`,value:r[x],valueSpec:c.geometry_type,style:s.style,styleSpec:s.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&v.push(new $e(`${o}[${x}]`,r[x],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let x=1;x<r.length;x++)v=v.concat(wu({key:`${o}[${x}]`,value:r[x],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":g=$t(r[1]),r.length!==2?v.push(new $e(o,r,`filter array for "${r[0]}" operator must have 2 elements`)):g!=="string"&&v.push(new $e(`${o}[1]`,r[1],`string expected, ${g} found`))}return v}function xh(s,r){const o=s.key,c=s.validateSpec,g=s.style,v=s.styleSpec,x=s.value,b=s.objectKey,S=v[`${r}_${s.layerType}`];if(!S)return[];const P=b.match(/^(.*)-transition$/);if(r==="paint"&&P&&S[P[1]]&&S[P[1]].transition)return c({key:o,value:x,valueSpec:v.transition,style:g,styleSpec:v});const I=s.valueSpec||S[b];if(!I)return[new $e(o,x,`unknown property "${b}"`)];let R;if($t(x)==="string"&&ea(I)&&!I.tokens&&(R=/^{([^}]+)}$/.exec(x)))return[new $e(o,x,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const B=[];return s.layerType==="symbol"&&(b==="text-field"&&g&&!g.glyphs&&B.push(new $e(o,x,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&pu(Mi(x))&&wn(x.type)==="identity"&&B.push(new $e(o,x,'"text-font" does not support identity functions'))),B.concat(c({key:s.key,value:x,valueSpec:I,style:g,styleSpec:v,expressionContext:"property",propertyType:r,propertyKey:b}))}function Su(s){return xh(s,"paint")}function bh(s){return xh(s,"layout")}function wh(s){let r=[];const o=s.value,c=s.key,g=s.style,v=s.styleSpec;o.type||o.ref||r.push(new $e(c,o,'either "type" or "ref" is required'));let x=wn(o.type);const b=wn(o.ref);if(o.id){const S=wn(o.id);for(let P=0;P<s.arrayIndex;P++){const I=g.layers[P];wn(I.id)===S&&r.push(new $e(c,o.id,`duplicate layer id "${o.id}", previously used at line ${I.id.__line__}`))}}if("ref"in o){let S;["type","source","source-layer","filter","layout"].forEach(P=>{P in o&&r.push(new $e(c,o[P],`"${P}" is prohibited for ref layers`))}),g.layers.forEach(P=>{wn(P.id)===b&&(S=P)}),S?S.ref?r.push(new $e(c,o.ref,"ref cannot reference another ref layer")):x=wn(S.type):r.push(new $e(c,o.ref,`ref layer "${b}" not found`))}else if(x!=="background")if(o.source){const S=g.sources&&g.sources[o.source],P=S&&wn(S.type);S?P==="vector"&&x==="raster"?r.push(new $e(c,o.source,`layer "${o.id}" requires a raster source`)):P!=="raster-dem"&&x==="hillshade"?r.push(new $e(c,o.source,`layer "${o.id}" requires a raster-dem source`)):P==="raster"&&x!=="raster"?r.push(new $e(c,o.source,`layer "${o.id}" requires a vector source`)):P!=="vector"||o["source-layer"]?P==="raster-dem"&&x!=="hillshade"?r.push(new $e(c,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!o.paint||!o.paint["line-gradient"]||P==="geojson"&&S.lineMetrics||r.push(new $e(c,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new $e(c,o,`layer "${o.id}" must specify a "source-layer"`)):r.push(new $e(c,o.source,`source "${o.source}" not found`))}else r.push(new $e(c,o,'missing required property "source"'));return r=r.concat(Xr({key:c,value:o,valueSpec:v.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${c}.type`,value:o.type,valueSpec:v.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:o,objectKey:"type"}),filter:vh,layout:S=>Xr({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":P=>bh(Ki({layerType:x},P))}}),paint:S=>Xr({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":P=>Su(Ki({layerType:x},P))}})}})),r}function vo(s){const r=s.value,o=s.key,c=$t(r);return c!=="string"?[new $e(o,r,`string expected, ${c} found`)]:[]}const Tu={promoteId:function({key:s,value:r}){if($t(r)==="string")return vo({key:s,value:r});{const o=[];for(const c in r)o.push(...vo({key:`${s}.${c}`,value:r[c]}));return o}}};function dl(s){const r=s.value,o=s.key,c=s.styleSpec,g=s.style,v=s.validateSpec;if(!r.type)return[new $e(o,r,'"type" is required')];const x=wn(r.type);let b;switch(x){case"vector":case"raster":return b=Xr({key:o,value:r,valueSpec:c[`source_${x.replace("-","_")}`],style:s.style,styleSpec:c,objectElementValidators:Tu,validateSpec:v}),b;case"raster-dem":return b=function(S){var P;const I=(P=S.sourceName)!==null&&P!==void 0?P:"",R=S.value,B=S.styleSpec,N=B.source_raster_dem,$=S.style;let q=[];const ee=$t(R);if(R===void 0)return q;if(ee!=="object")return q.push(new $e("source_raster_dem",R,`object expected, ${ee} found`)),q;const se=wn(R.encoding)==="custom",we=["redFactor","greenFactor","blueFactor","baseShift"],de=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const xe in R)!se&&we.includes(xe)?q.push(new $e(xe,R[xe],`In "${I}": "${xe}" is only valid when "encoding" is set to "custom". ${de} encoding found`)):N[xe]?q=q.concat(S.validateSpec({key:xe,value:R[xe],valueSpec:N[xe],validateSpec:S.validateSpec,style:$,styleSpec:B})):q.push(new $e(xe,R[xe],`unknown property "${xe}"`));return q}({sourceName:o,value:r,style:s.style,styleSpec:c,validateSpec:v}),b;case"geojson":if(b=Xr({key:o,value:r,valueSpec:c.source_geojson,style:g,styleSpec:c,validateSpec:v,objectElementValidators:Tu}),r.cluster)for(const S in r.clusterProperties){const[P,I]=r.clusterProperties[S],R=typeof P=="string"?[P,["accumulated"],["get",S]]:P;b.push(...oa({key:`${o}.${S}.map`,value:I,expressionContext:"cluster-map"})),b.push(...oa({key:`${o}.${S}.reduce`,value:R,expressionContext:"cluster-reduce"}))}return b;case"video":return Xr({key:o,value:r,valueSpec:c.source_video,style:g,validateSpec:v,styleSpec:c});case"image":return Xr({key:o,value:r,valueSpec:c.source_image,style:g,validateSpec:v,styleSpec:c});case"canvas":return[new $e(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ts({key:`${o}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Sh(s){const r=s.value,o=s.styleSpec,c=o.light,g=s.style;let v=[];const x=$t(r);if(r===void 0)return v;if(x!=="object")return v=v.concat([new $e("light",r,`object expected, ${x} found`)]),v;for(const b in r){const S=b.match(/^(.*)-transition$/);v=v.concat(S&&c[S[1]]&&c[S[1]].transition?s.validateSpec({key:b,value:r[b],valueSpec:o.transition,validateSpec:s.validateSpec,style:g,styleSpec:o}):c[b]?s.validateSpec({key:b,value:r[b],valueSpec:c[b],validateSpec:s.validateSpec,style:g,styleSpec:o}):[new $e(b,r[b],`unknown property "${b}"`)])}return v}function Th(s){const r=s.value,o=s.styleSpec,c=o.sky,g=s.style,v=$t(r);if(r===void 0)return[];if(v!=="object")return[new $e("sky",r,`object expected, ${v} found`)];let x=[];for(const b in r)x=x.concat(c[b]?s.validateSpec({key:b,value:r[b],valueSpec:c[b],style:g,styleSpec:o}):[new $e(b,r[b],`unknown property "${b}"`)]);return x}function Ch(s){const r=s.value,o=s.styleSpec,c=o.terrain,g=s.style;let v=[];const x=$t(r);if(r===void 0)return v;if(x!=="object")return v=v.concat([new $e("terrain",r,`object expected, ${x} found`)]),v;for(const b in r)v=v.concat(c[b]?s.validateSpec({key:b,value:r[b],valueSpec:c[b],validateSpec:s.validateSpec,style:g,styleSpec:o}):[new $e(b,r[b],`unknown property "${b}"`)]);return v}function kh(s){let r=[];const o=s.value,c=s.key;if(Array.isArray(o)){const g=[],v=[];for(const x in o)o[x].id&&g.includes(o[x].id)&&r.push(new $e(c,o,`all the sprites' ids must be unique, but ${o[x].id} is duplicated`)),g.push(o[x].id),o[x].url&&v.includes(o[x].url)&&r.push(new $e(c,o,`all the sprites' URLs must be unique, but ${o[x].url} is duplicated`)),v.push(o[x].url),r=r.concat(Xr({key:`${c}[${x}]`,value:o[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return r}return vo({key:c,value:o})}const Cu={"*":()=>[],array:hl,boolean:function(s){const r=s.value,o=s.key,c=$t(r);return c!=="boolean"?[new $e(o,r,`boolean expected, ${c} found`)]:[]},number:_h,color:function(s){const r=s.key,o=s.value,c=$t(o);return c!=="string"?[new $e(r,o,`color expected, ${c} found`)]:Ht.parse(String(o))?[]:[new $e(r,o,`color expected, "${o}" found`)]},constants:ep,enum:Ts,filter:vh,function:bu,layer:wh,object:Xr,source:dl,light:Sh,sky:Th,terrain:Ch,projection:function(s){const r=s.value,o=s.styleSpec,c=o.projection,g=s.style,v=$t(r);if(r===void 0)return[];if(v!=="object")return[new $e("projection",r,`object expected, ${v} found`)];let x=[];for(const b in r)x=x.concat(c[b]?s.validateSpec({key:b,value:r[b],valueSpec:c[b],style:g,styleSpec:o}):[new $e(b,r[b],`unknown property "${b}"`)]);return x},string:vo,formatted:function(s){return vo(s).length===0?[]:oa(s)},resolvedImage:function(s){return vo(s).length===0?[]:oa(s)},padding:function(s){const r=s.key,o=s.value;if($t(o)==="array"){if(o.length<1||o.length>4)return[new $e(r,o,`padding requires 1 to 4 values; ${o.length} values found`)];const c={type:"number"};let g=[];for(let v=0;v<o.length;v++)g=g.concat(s.validateSpec({key:`${r}[${v}]`,value:o[v],validateSpec:s.validateSpec,valueSpec:c}));return g}return _h({key:r,value:o,valueSpec:{}})},variableAnchorOffsetCollection:function(s){const r=s.key,o=s.value,c=$t(o),g=s.styleSpec;if(c!=="array"||o.length<1||o.length%2!=0)return[new $e(r,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let v=[];for(let x=0;x<o.length;x+=2)v=v.concat(Ts({key:`${r}[${x}]`,value:o[x],valueSpec:g.layout_symbol["text-anchor"]})),v=v.concat(hl({key:`${r}[${x+1}]`,value:o[x+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:g}));return v},sprite:kh};function fl(s){const r=s.value,o=s.valueSpec,c=s.styleSpec;return s.validateSpec=fl,o.expression&&pu(wn(r))?bu(s):o.expression&&yu(Mi(r))?oa(s):o.type&&Cu[o.type]?Cu[o.type](s):Xr(Ki({},s,{valueSpec:o.type?c[o.type]:o}))}function tp(s){const r=s.value,o=s.key,c=vo(s);return c.length||(r.indexOf("{fontstack}")===-1&&c.push(new $e(o,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&c.push(new $e(o,r,'"glyphs" url must include a "{range}" token'))),c}function ci(s,r=ke){let o=[];return o=o.concat(fl({key:"",value:s,valueSpec:r.$root,styleSpec:r,style:s,validateSpec:fl,objectElementValidators:{glyphs:tp,"*":()=>[]}})),s.constants&&(o=o.concat(ep({key:"constants",value:s.constants}))),Ph(o)}function ts(s){return function(r){return s({...r,validateSpec:fl})}}function Ph(s){return[].concat(s).sort((r,o)=>r.line-o.line)}function Ai(s){return function(...r){return Ph(s.apply(this,r))}}ci.source=Ai(ts(dl)),ci.sprite=Ai(ts(kh)),ci.glyphs=Ai(ts(tp)),ci.light=Ai(ts(Sh)),ci.sky=Ai(ts(Th)),ci.terrain=Ai(ts(Ch)),ci.layer=Ai(ts(wh)),ci.filter=Ai(ts(vh)),ci.paintProperty=Ai(ts(Su)),ci.layoutProperty=Ai(ts(bh));const xo=ci,Py=xo.light,Ey=xo.sky,np=xo.paintProperty,rp=xo.layoutProperty;function Eh(s,r){let o=!1;if(r&&r.length)for(const c of r)s.fire(new si(new Error(c.message))),o=!0;return o}class aa{constructor(r,o,c){const g=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const x=new Int32Array(this.arrayBuffer);r=x[0],this.d=(o=x[1])+2*(c=x[2]);for(let S=0;S<this.d*this.d;S++){const P=x[3+S],I=x[3+S+1];g.push(P===I?null:x.subarray(P,I))}const b=x[3+g.length+1];this.keys=x.subarray(x[3+g.length],b),this.bboxes=x.subarray(b),this.insert=this._insertReadonly}else{this.d=o+2*c;for(let x=0;x<this.d*this.d;x++)g.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=r,this.padding=c,this.scale=o/r,this.uid=0;const v=c/o*r;this.min=-v,this.max=r+v}insert(r,o,c,g,v){this._forEachCell(o,c,g,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(g),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,o,c,g,v,x){this.cells[v].push(x)}query(r,o,c,g,v){const x=this.min,b=this.max;if(r<=x&&o<=x&&b<=c&&b<=g&&!v)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(r,o,c,g,this._queryCell,S,{},v),S}}_queryCell(r,o,c,g,v,x,b,S){const P=this.cells[v];if(P!==null){const I=this.keys,R=this.bboxes;for(let B=0;B<P.length;B++){const N=P[B];if(b[N]===void 0){const $=4*N;(S?S(R[$+0],R[$+1],R[$+2],R[$+3]):r<=R[$+2]&&o<=R[$+3]&&c>=R[$+0]&&g>=R[$+1])?(b[N]=!0,x.push(I[N])):b[N]=!1}}}}_forEachCell(r,o,c,g,v,x,b,S){const P=this._convertToCellCoord(r),I=this._convertToCellCoord(o),R=this._convertToCellCoord(c),B=this._convertToCellCoord(g);for(let N=P;N<=R;N++)for(let $=I;$<=B;$++){const q=this.d*$+N;if((!S||S(this._convertFromCellCoord(N),this._convertFromCellCoord($),this._convertFromCellCoord(N+1),this._convertFromCellCoord($+1)))&&v.call(this,r,o,c,g,q,x,b,S))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,o=3+this.cells.length+1+1;let c=0;for(let x=0;x<this.cells.length;x++)c+=this.cells[x].length;const g=new Int32Array(o+c+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let v=o;for(let x=0;x<r.length;x++){const b=r[x];g[3+x]=v,g.set(b,v),v+=b.length}return g[3+r.length]=v,g.set(this.keys,v),v+=this.keys.length,g[3+r.length+1]=v,g.set(this.bboxes,v),v+=this.bboxes.length,g.buffer}static serialize(r,o){const c=r.toArrayBuffer();return o&&o.push(c),{buffer:c}}static deserialize(r){return new aa(r.buffer)}}const hi={};function it(s,r,o={}){if(hi[s])throw new Error(`${s} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:s,writeable:!1}),hi[s]={klass:r,omit:o.omit||[],shallow:o.shallow||[]}}it("Object",Object),it("TransferableGridIndex",aa),it("Color",Ht),it("Error",Error),it("AJAXError",Dn),it("ResolvedImage",Hr),it("StylePropertyFunction",sa),it("StyleExpression",gu,{omit:["_evaluator"]}),it("ZoomDependentExpression",ia),it("ZoomConstantExpression",ra),it("CompoundExpression",ui,{omit:["_evaluate"]});for(const s in Yo)Yo[s]._classRegistryKey||it(`Expression_${s}`,Yo[s]);function ku(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function Ih(s){return s.$name||s.constructor._classRegistryKey}function ip(s){return!function(r){if(r===null||typeof r!="object")return!1;const o=Ih(r);return!(!o||o==="Object")}(s)&&(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||ku(s)||bt(s)||ArrayBuffer.isView(s)||s instanceof ImageData)}function la(s,r){if(ip(s))return(ku(s)||bt(s))&&r&&r.push(s),ArrayBuffer.isView(s)&&r&&r.push(s.buffer),s instanceof ImageData&&r&&r.push(s.data.buffer),s;if(Array.isArray(s)){const v=[];for(const x of s)v.push(la(x,r));return v}if(typeof s!="object")throw new Error("can't serialize object of type "+typeof s);const o=Ih(s);if(!o)throw new Error(`can't serialize object of unregistered class ${s.constructor.name}`);if(!hi[o])throw new Error(`${o} is not registered.`);const{klass:c}=hi[o],g=c.serialize?c.serialize(s,r):{};if(c.serialize){if(r&&g===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in s){if(!s.hasOwnProperty(v)||hi[o].omit.indexOf(v)>=0)continue;const x=s[v];g[v]=hi[o].shallow.indexOf(v)>=0?x:la(x,r)}s instanceof Error&&(g.message=s.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(g.$name=o),g}function ua(s){if(ip(s))return s;if(Array.isArray(s))return s.map(ua);if(typeof s!="object")throw new Error("can't deserialize object of type "+typeof s);const r=Ih(s)||"Object";if(!hi[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:o}=hi[r];if(!o)throw new Error(`can't deserialize unregistered class ${r}`);if(o.deserialize)return o.deserialize(s);const c=Object.create(o.prototype);for(const g of Object.keys(s)){if(g==="$name")continue;const v=s[g];c[g]=hi[r].shallow.indexOf(g)>=0?v:ua(v)}return c}class Mh{constructor(){this.first=!0}update(r,o){const c=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=o),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=c,!0))}}const Lt={"Latin-1 Supplement":s=>s>=128&&s<=255,"Hangul Jamo":s=>s>=4352&&s<=4607,Khmer:s=>s>=6016&&s<=6143,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Katakana:s=>s>=12448&&s<=12543,Kanbun:s=>s>=12688&&s<=12703,"CJK Strokes":s=>s>=12736&&s<=12783,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"Private Use Area":s=>s>=57344&&s<=63743,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function Ah(s){for(const r of s)if(Dh(r.charCodeAt(0)))return!0;return!1}function Iy(s){for(const r of s)if(!ca(r.charCodeAt(0)))return!1;return!0}function zh(s){const r=s.map(o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}}).filter(o=>o);return new RegExp(r.join("|"),"u")}const My=zh(["Arab","Dupl","Mong","Ougr","Syrc"]);function ca(s){return!My.test(String.fromCodePoint(s))}const sp=zh(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Dh(s){return!(s!==746&&s!==747&&(s<4352||!(Lt["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||Lt["CJK Compatibility"](s)||Lt["CJK Strokes"](s)||!(!Lt["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||Lt["Enclosed CJK Letters and Months"](s)||Lt["Ideographic Description Characters"](s)||Lt.Kanbun(s)||Lt.Katakana(s)&&s!==12540||!(!Lt["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!Lt["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||Lt["Vertical Forms"](s)||Lt["Yijing Hexagram Symbols"](s)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(s))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(s))||sp.test(String.fromCodePoint(s)))))}function op(s){return!(Dh(s)||function(r){return!!(Lt["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||Lt["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||Lt["Letterlike Symbols"](r)||Lt["Number Forms"](r)||Lt["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||Lt["Control Pictures"](r)&&r!==9251||Lt["Optical Character Recognition"](r)||Lt["Enclosed Alphanumerics"](r)||Lt["Geometric Shapes"](r)||Lt["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||Lt["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Lt["CJK Symbols and Punctuation"](r)||Lt.Katakana(r)||Lt["Private Use Area"](r)||Lt["CJK Compatibility Forms"](r)||Lt["Small Form Variants"](r)||Lt["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(s))}const Ay=zh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Rh(s){return Ay.test(String.fromCodePoint(s))}function zy(s,r){return!(!r&&Rh(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||Lt.Khmer(s))}function Dy(s){for(const r of s)if(Rh(r.charCodeAt(0)))return!0;return!1}const Kr=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class un{constructor(r,o){this.zoom=r,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Mh,this.transition={})}isSupportedScript(r){return function(o,c){for(const g of o)if(!zy(g.charCodeAt(0),c))return!1;return!0}(r,Kr.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,o=r-Math.floor(r),c=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*o}}}class ha{constructor(r,o){this.property=r,this.value=o,this.expression=function(c,g){if(pu(c))return new sa(c,g);if(yu(c)){const v=mh(c,g);if(v.result==="error")throw new Error(v.value.map(x=>`${x.key}: ${x.message}`).join(", "));return v.value}{let v=c;return g.type==="color"&&typeof c=="string"?v=Ht.parse(c):g.type!=="padding"||typeof c!="number"&&!Array.isArray(c)?g.type==="variableAnchorOffsetCollection"&&Array.isArray(c)&&(v=li.parse(c)):v=Wr.parse(c),{kind:"constant",evaluate:()=>v}}}(o===void 0?r.specification.default:o,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,o,c){return this.property.possiblyEvaluate(this,r,o,c)}}class Pu{constructor(r){this.property=r,this.value=new ha(r,void 0)}transitioned(r,o){return new ap(this.property,this.value,o,Se({},r.transition,this.transition),r.now)}untransitioned(){return new ap(this.property,this.value,null,{},0)}}class Eu{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return Ne(this._values[r].value.value)}setValue(r,o){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new Pu(this._values[r].property)),this._values[r].value=new ha(this._values[r].property,o===null?void 0:Ne(o))}getTransition(r){return Ne(this._values[r].transition)}setTransition(r,o){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new Pu(this._values[r].property)),this._values[r].transition=Ne(o)||void 0}serialize(){const r={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(r[o]=c);const g=this.getTransition(o);g!==void 0&&(r[`${o}-transition`]=g)}return r}transitioned(r,o){const c=new pl(this._properties);for(const g of Object.keys(this._values))c._values[g]=this._values[g].transitioned(r,o._values[g]);return c}untransitioned(){const r=new pl(this._properties);for(const o of Object.keys(this._values))r._values[o]=this._values[o].untransitioned();return r}}class ap{constructor(r,o,c,g,v){this.property=r,this.value=o,this.begin=v+g.delay||0,this.end=this.begin+g.duration||0,r.specification.transition&&(g.delay||g.duration)&&(this.prior=c)}possiblyEvaluate(r,o,c){const g=r.now||0,v=this.value.possiblyEvaluate(r,o,c),x=this.prior;if(x){if(g>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(g<this.begin)return x.possiblyEvaluate(r,o,c);{const b=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(r,o,c),v,function(S){if(S<=0)return 0;if(S>=1)return 1;const P=S*S,I=P*S;return 4*(S<.5?I:3*(S-P)+I-.75)}(b))}}return v}}class pl{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,o,c){const g=new gl(this._properties);for(const v of Object.keys(this._values))g._values[v]=this._values[v].possiblyEvaluate(r,o,c);return g}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class ml{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}hasValue(r){return this._values[r].value!==void 0}getValue(r){return Ne(this._values[r].value)}setValue(r,o){this._values[r]=new ha(this._values[r].property,o===null?void 0:Ne(o))}serialize(){const r={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(r[o]=c)}return r}possiblyEvaluate(r,o,c){const g=new gl(this._properties);for(const v of Object.keys(this._values))g._values[v]=this._values[v].possiblyEvaluate(r,o,c);return g}}class ns{constructor(r,o,c){this.property=r,this.value=o,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,o,c,g){return this.property.evaluate(this.value,this.parameters,r,o,c,g)}}class gl{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class ot{constructor(r){this.specification=r}possiblyEvaluate(r,o){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(o)}interpolate(r,o,c){const g=Ir[this.specification.type];return g?g(r,o,c):r}}class yt{constructor(r,o){this.specification=r,this.overrides=o}possiblyEvaluate(r,o,c,g){return new ns(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(o,null,{},c,g)}:r.expression,o)}interpolate(r,o,c){if(r.value.kind!=="constant"||o.value.kind!=="constant")return r;if(r.value.value===void 0||o.value.value===void 0)return new ns(this,{kind:"constant",value:void 0},r.parameters);const g=Ir[this.specification.type];if(g){const v=g(r.value.value,o.value.value,c);return new ns(this,{kind:"constant",value:v},r.parameters)}return r}evaluate(r,o,c,g,v,x){return r.kind==="constant"?r.value:r.evaluate(o,c,g,v,x)}}class Iu extends yt{possiblyEvaluate(r,o,c,g){if(r.value===void 0)return new ns(this,{kind:"constant",value:void 0},o);if(r.expression.kind==="constant"){const v=r.expression.evaluate(o,null,{},c,g),x=r.property.specification.type==="resolvedImage"&&typeof v!="string"?v.name:v,b=this._calculate(x,x,x,o);return new ns(this,{kind:"constant",value:b},o)}if(r.expression.kind==="camera"){const v=this._calculate(r.expression.evaluate({zoom:o.zoom-1}),r.expression.evaluate({zoom:o.zoom}),r.expression.evaluate({zoom:o.zoom+1}),o);return new ns(this,{kind:"constant",value:v},o)}return new ns(this,r.expression,o)}evaluate(r,o,c,g,v,x){if(r.kind==="source"){const b=r.evaluate(o,c,g,v,x);return this._calculate(b,b,b,o)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(o.zoom)-1},c,g),r.evaluate({zoom:Math.floor(o.zoom)},c,g),r.evaluate({zoom:Math.floor(o.zoom)+1},c,g),o):r.value}_calculate(r,o,c,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:o}:{from:c,to:o}}interpolate(r){return r}}class Mu{constructor(r){this.specification=r}possiblyEvaluate(r,o,c,g){if(r.value!==void 0){if(r.expression.kind==="constant"){const v=r.expression.evaluate(o,null,{},c,g);return this._calculate(v,v,v,o)}return this._calculate(r.expression.evaluate(new un(Math.floor(o.zoom-1),o)),r.expression.evaluate(new un(Math.floor(o.zoom),o)),r.expression.evaluate(new un(Math.floor(o.zoom+1),o)),o)}}_calculate(r,o,c,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:o}:{from:c,to:o}}interpolate(r){return r}}class Lh{constructor(r){this.specification=r}possiblyEvaluate(r,o,c,g){return!!r.expression.evaluate(o,null,{},c,g)}interpolate(){return!1}}class _{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in r){const c=r[o];c.specification.overridable&&this.overridableProperties.push(o);const g=this.defaultPropertyValues[o]=new ha(c,void 0),v=this.defaultTransitionablePropertyValues[o]=new Pu(c);this.defaultTransitioningPropertyValues[o]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=g.possiblyEvaluate({})}}}it("DataDrivenProperty",yt),it("DataConstantProperty",ot),it("CrossFadedDataDrivenProperty",Iu),it("CrossFadedProperty",Mu),it("ColorRampProperty",Lh);const n="-transition";class l extends Fs{constructor(r,o){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),o.layout&&(this._unevaluatedLayout=new ml(o.layout)),o.paint)){this._transitionablePaint=new Eu(o.paint);for(const c in r.paint)this.setPaintProperty(c,r.paint[c],{validate:!1});for(const c in r.layout)this.setLayoutProperty(c,r.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new gl(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,o,c={}){o!=null&&this._validate(rp,`layers.${this.id}.layout.${r}`,r,o,c)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,o):this.visibility=o)}getPaintProperty(r){return r.endsWith(n)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,o,c={}){if(o!=null&&this._validate(np,`layers.${this.id}.paint.${r}`,r,o,c))return!1;if(r.endsWith(n))return this._transitionablePaint.setTransition(r.slice(0,-11),o||void 0),!1;{const g=this._transitionablePaint._values[r],v=g.property.specification["property-type"]==="cross-faded-data-driven",x=g.value.isDataDriven(),b=g.value;this._transitionablePaint.setValue(r,o),this._handleSpecialPaintPropertyUpdate(r);const S=this._transitionablePaint._values[r].value;return S.isDataDriven()||x||v||this._handleOverridablePaintPropertyUpdate(r,b,S)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,o,c){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,o){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,o)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Ue(r,(o,c)=>!(o===void 0||c==="layout"&&!Object.keys(o).length||c==="paint"&&!Object.keys(o).length))}_validate(r,o,c,g,v={}){return(!v||v.validate!==!1)&&Eh(this,r.call(xo,{key:o,layerType:this.type,objectKey:c,value:g,styleSpec:ke,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const o=this.paint.get(r);if(o instanceof ns&&ea(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const d={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class f{constructor(r,o){this._structArray=r,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class y{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,o){return r._trim(),o&&(r.isTransferred=!0,o.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const o=Object.create(this.prototype);return o.arrayBuffer=r.arrayBuffer,o.length=r.length,o.capacity=r.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function w(s,r=1){let o=0,c=0;return{members:s.map(g=>{const v=d[g.type].BYTES_PER_ELEMENT,x=o=T(o,Math.max(r,v)),b=g.components||1;return c=Math.max(c,v),o+=v*b,{name:g.name,type:g.type,components:b,offset:x}}),size:T(o,Math.max(c,r)),alignment:r}}function T(s,r){return Math.ceil(s/r)*r}class k extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o){const c=this.length;return this.resize(c+1),this.emplace(c,r,o)}emplace(r,o,c){const g=2*r;return this.int16[g+0]=o,this.int16[g+1]=c,r}}k.prototype.bytesPerElement=4,it("StructArrayLayout2i4",k);class M extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,c)}emplace(r,o,c,g){const v=3*r;return this.int16[v+0]=o,this.int16[v+1]=c,this.int16[v+2]=g,r}}M.prototype.bytesPerElement=6,it("StructArrayLayout3i6",M);class L extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,o,c,g)}emplace(r,o,c,g,v){const x=4*r;return this.int16[x+0]=o,this.int16[x+1]=c,this.int16[x+2]=g,this.int16[x+3]=v,r}}L.prototype.bytesPerElement=8,it("StructArrayLayout4i8",L);class F extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,c,g,v,x)}emplace(r,o,c,g,v,x,b){const S=6*r;return this.int16[S+0]=o,this.int16[S+1]=c,this.int16[S+2]=g,this.int16[S+3]=v,this.int16[S+4]=x,this.int16[S+5]=b,r}}F.prototype.bytesPerElement=12,it("StructArrayLayout2i4i12",F);class j extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,c,g,v,x)}emplace(r,o,c,g,v,x,b){const S=4*r,P=8*r;return this.int16[S+0]=o,this.int16[S+1]=c,this.uint8[P+4]=g,this.uint8[P+5]=v,this.uint8[P+6]=x,this.uint8[P+7]=b,r}}j.prototype.bytesPerElement=8,it("StructArrayLayout2i4ub8",j);class H extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o){const c=this.length;return this.resize(c+1),this.emplace(c,r,o)}emplace(r,o,c){const g=2*r;return this.float32[g+0]=o,this.float32[g+1]=c,r}}H.prototype.bytesPerElement=8,it("StructArrayLayout2f8",H);class K extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x,b,S,P,I){const R=this.length;return this.resize(R+1),this.emplace(R,r,o,c,g,v,x,b,S,P,I)}emplace(r,o,c,g,v,x,b,S,P,I,R){const B=10*r;return this.uint16[B+0]=o,this.uint16[B+1]=c,this.uint16[B+2]=g,this.uint16[B+3]=v,this.uint16[B+4]=x,this.uint16[B+5]=b,this.uint16[B+6]=S,this.uint16[B+7]=P,this.uint16[B+8]=I,this.uint16[B+9]=R,r}}K.prototype.bytesPerElement=20,it("StructArrayLayout10ui20",K);class re extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x,b,S,P,I,R,B){const N=this.length;return this.resize(N+1),this.emplace(N,r,o,c,g,v,x,b,S,P,I,R,B)}emplace(r,o,c,g,v,x,b,S,P,I,R,B,N){const $=12*r;return this.int16[$+0]=o,this.int16[$+1]=c,this.int16[$+2]=g,this.int16[$+3]=v,this.uint16[$+4]=x,this.uint16[$+5]=b,this.uint16[$+6]=S,this.uint16[$+7]=P,this.int16[$+8]=I,this.int16[$+9]=R,this.int16[$+10]=B,this.int16[$+11]=N,r}}re.prototype.bytesPerElement=24,it("StructArrayLayout4i4ui4i24",re);class oe extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,c)}emplace(r,o,c,g){const v=3*r;return this.float32[v+0]=o,this.float32[v+1]=c,this.float32[v+2]=g,r}}oe.prototype.bytesPerElement=12,it("StructArrayLayout3f12",oe);class ue extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.uint32[1*r+0]=o,r}}ue.prototype.bytesPerElement=4,it("StructArrayLayout1ul4",ue);class he extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x,b,S,P){const I=this.length;return this.resize(I+1),this.emplace(I,r,o,c,g,v,x,b,S,P)}emplace(r,o,c,g,v,x,b,S,P,I){const R=10*r,B=5*r;return this.int16[R+0]=o,this.int16[R+1]=c,this.int16[R+2]=g,this.int16[R+3]=v,this.int16[R+4]=x,this.int16[R+5]=b,this.uint32[B+3]=S,this.uint16[R+8]=P,this.uint16[R+9]=I,r}}he.prototype.bytesPerElement=20,it("StructArrayLayout6i1ul2ui20",he);class Q extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,c,g,v,x)}emplace(r,o,c,g,v,x,b){const S=6*r;return this.int16[S+0]=o,this.int16[S+1]=c,this.int16[S+2]=g,this.int16[S+3]=v,this.int16[S+4]=x,this.int16[S+5]=b,r}}Q.prototype.bytesPerElement=12,it("StructArrayLayout2i2i2i12",Q);class me extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v){const x=this.length;return this.resize(x+1),this.emplace(x,r,o,c,g,v)}emplace(r,o,c,g,v,x){const b=4*r,S=8*r;return this.float32[b+0]=o,this.float32[b+1]=c,this.float32[b+2]=g,this.int16[S+6]=v,this.int16[S+7]=x,r}}me.prototype.bytesPerElement=16,it("StructArrayLayout2f1f2i16",me);class ve extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,c,g,v,x)}emplace(r,o,c,g,v,x,b){const S=16*r,P=4*r,I=8*r;return this.uint8[S+0]=o,this.uint8[S+1]=c,this.float32[P+1]=g,this.float32[P+2]=v,this.int16[I+6]=x,this.int16[I+7]=b,r}}ve.prototype.bytesPerElement=16,it("StructArrayLayout2ub2f2i16",ve);class Te extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,c)}emplace(r,o,c,g){const v=3*r;return this.uint16[v+0]=o,this.uint16[v+1]=c,this.uint16[v+2]=g,r}}Te.prototype.bytesPerElement=6,it("StructArrayLayout3ui6",Te);class ze extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x,b,S,P,I,R,B,N,$,q,ee,se){const we=this.length;return this.resize(we+1),this.emplace(we,r,o,c,g,v,x,b,S,P,I,R,B,N,$,q,ee,se)}emplace(r,o,c,g,v,x,b,S,P,I,R,B,N,$,q,ee,se,we){const de=24*r,xe=12*r,Pe=48*r;return this.int16[de+0]=o,this.int16[de+1]=c,this.uint16[de+2]=g,this.uint16[de+3]=v,this.uint32[xe+2]=x,this.uint32[xe+3]=b,this.uint32[xe+4]=S,this.uint16[de+10]=P,this.uint16[de+11]=I,this.uint16[de+12]=R,this.float32[xe+7]=B,this.float32[xe+8]=N,this.uint8[Pe+36]=$,this.uint8[Pe+37]=q,this.uint8[Pe+38]=ee,this.uint32[xe+10]=se,this.int16[de+22]=we,r}}ze.prototype.bytesPerElement=48,it("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ze);class Ve extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c,g,v,x,b,S,P,I,R,B,N,$,q,ee,se,we,de,xe,Pe,Le,et,mt,Je,Ke,ut,st){const rt=this.length;return this.resize(rt+1),this.emplace(rt,r,o,c,g,v,x,b,S,P,I,R,B,N,$,q,ee,se,we,de,xe,Pe,Le,et,mt,Je,Ke,ut,st)}emplace(r,o,c,g,v,x,b,S,P,I,R,B,N,$,q,ee,se,we,de,xe,Pe,Le,et,mt,Je,Ke,ut,st,rt){const Me=32*r,ct=16*r;return this.int16[Me+0]=o,this.int16[Me+1]=c,this.int16[Me+2]=g,this.int16[Me+3]=v,this.int16[Me+4]=x,this.int16[Me+5]=b,this.int16[Me+6]=S,this.int16[Me+7]=P,this.uint16[Me+8]=I,this.uint16[Me+9]=R,this.uint16[Me+10]=B,this.uint16[Me+11]=N,this.uint16[Me+12]=$,this.uint16[Me+13]=q,this.uint16[Me+14]=ee,this.uint16[Me+15]=se,this.uint16[Me+16]=we,this.uint16[Me+17]=de,this.uint16[Me+18]=xe,this.uint16[Me+19]=Pe,this.uint16[Me+20]=Le,this.uint16[Me+21]=et,this.uint16[Me+22]=mt,this.uint32[ct+12]=Je,this.float32[ct+13]=Ke,this.float32[ct+14]=ut,this.uint16[Me+30]=st,this.uint16[Me+31]=rt,r}}Ve.prototype.bytesPerElement=64,it("StructArrayLayout8i15ui1ul2f2ui64",Ve);class Ye extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.float32[1*r+0]=o,r}}Ye.prototype.bytesPerElement=4,it("StructArrayLayout1f4",Ye);class nt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,c)}emplace(r,o,c,g){const v=3*r;return this.uint16[6*r+0]=o,this.float32[v+1]=c,this.float32[v+2]=g,r}}nt.prototype.bytesPerElement=12,it("StructArrayLayout1ui2f12",nt);class We extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,c)}emplace(r,o,c,g){const v=4*r;return this.uint32[2*r+0]=o,this.uint16[v+2]=c,this.uint16[v+3]=g,r}}We.prototype.bytesPerElement=8,it("StructArrayLayout1ul2ui8",We);class Ze extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o){const c=this.length;return this.resize(c+1),this.emplace(c,r,o)}emplace(r,o,c){const g=2*r;return this.uint16[g+0]=o,this.uint16[g+1]=c,r}}Ze.prototype.bytesPerElement=4,it("StructArrayLayout2ui4",Ze);class at extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.uint16[1*r+0]=o,r}}at.prototype.bytesPerElement=2,it("StructArrayLayout1ui2",at);class wt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,o,c,g)}emplace(r,o,c,g,v){const x=4*r;return this.float32[x+0]=o,this.float32[x+1]=c,this.float32[x+2]=g,this.float32[x+3]=v,r}}wt.prototype.bytesPerElement=16,it("StructArrayLayout4f16",wt);class Xe extends f{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new z(this.anchorPointX,this.anchorPointY)}}Xe.prototype.size=20;class Qe extends he{get(r){return new Xe(this,r)}}it("CollisionBoxArray",Qe);class vt extends f{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}vt.prototype.size=48;class cn extends ze{get(r){return new vt(this,r)}}it("PlacedSymbolArray",cn);class It extends f{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}It.prototype.size=64;class Rt extends Ve{get(r){return new It(this,r)}}it("SymbolInstanceArray",Rt);class hn extends Ye{getoffsetX(r){return this.float32[1*r+0]}}it("GlyphOffsetArray",hn);class ar extends M{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}it("SymbolLineVertexArray",ar);class zi extends f{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}zi.prototype.size=12;class dn extends nt{get(r){return new zi(this,r)}}it("TextAnchorOffsetArray",dn);class Ar extends f{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ar.prototype.size=8;class vr extends We{get(r){return new Ar(this,r)}}it("FeatureIndexArray",vr);class lr extends k{}class xr extends k{}class rs extends k{}class da extends F{}class Au extends j{}class fa extends H{}class di extends K{}class zu extends re{}class Fh extends oe{}class fi extends ue{}class pi extends Q{}class js extends ve{}class Di extends Te{}class er extends Ze{}const ur=w([{name:"a_pos",components:2,type:"Int16"}],4),{members:Yr}=ur;class Ft{constructor(r=[]){this.segments=r}prepareSegment(r,o,c,g){let v=this.segments[this.segments.length-1];return r>Ft.MAX_VERTEX_ARRAY_LENGTH&&je(`Max vertices per segment is ${Ft.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!v||v.vertexLength+r>Ft.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==g)&&(v={vertexOffset:o.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},g!==void 0&&(v.sortKey=g),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const r of this.segments)for(const o in r.vaos)r.vaos[o].destroy()}static simpleSegment(r,o,c,g){return new Ft([{vertexOffset:r,primitiveOffset:o,vertexLength:c,primitiveLength:g,vaos:{},sortKey:0}])}}function bo(s,r){return 256*(s=_e(Math.floor(s),0,255))+_e(Math.floor(r),0,255)}Ft.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,it("SegmentVector",Ft);const pa=w([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ma={exports:{}},lp={exports:{}};lp.exports=function(s,r){var o,c,g,v,x,b,S,P;for(c=s.length-(o=3&s.length),g=r,x=3432918353,b=461845907,P=0;P<c;)S=255&s.charCodeAt(P)|(255&s.charCodeAt(++P))<<8|(255&s.charCodeAt(++P))<<16|(255&s.charCodeAt(++P))<<24,++P,g=27492+(65535&(v=5*(65535&(g=(g^=S=(65535&(S=(S=(65535&S)*x+(((S>>>16)*x&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(S=0,o){case 3:S^=(255&s.charCodeAt(P+2))<<16;case 2:S^=(255&s.charCodeAt(P+1))<<8;case 1:g^=S=(65535&(S=(S=(65535&(S^=255&s.charCodeAt(P)))*x+(((S>>>16)*x&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295}return g^=s.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var Ry=lp.exports,up={exports:{}};up.exports=function(s,r){for(var o,c=s.length,g=r^c,v=0;c>=4;)o=1540483477*(65535&(o=255&s.charCodeAt(v)|(255&s.charCodeAt(++v))<<8|(255&s.charCodeAt(++v))<<16|(255&s.charCodeAt(++v))<<24))+((1540483477*(o>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),c-=4,++v;switch(c){case 3:g^=(255&s.charCodeAt(v+2))<<16;case 2:g^=(255&s.charCodeAt(v+1))<<8;case 1:g=1540483477*(65535&(g^=255&s.charCodeAt(v)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var $s=Ry,cp=up.exports;ma.exports=$s,ma.exports.murmur3=$s,ma.exports.murmur2=cp;var Du=C(ma.exports);class yl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,o,c,g){this.ids.push(Ru(r)),this.positions.push(o,c,g)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=Ru(r);let c=0,g=this.ids.length-1;for(;c<g;){const x=c+g>>1;this.ids[x]>=o?g=x:c=x+1}const v=[];for(;this.ids[c]===o;)v.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return v}static serialize(r,o){const c=new Float64Array(r.ids),g=new Uint32Array(r.positions);return Lu(c,g,0,c.length-1),o&&o.push(c.buffer,g.buffer),{ids:c,positions:g}}static deserialize(r){const o=new yl;return o.ids=r.ids,o.positions=r.positions,o.indexed=!0,o}}function Ru(s){const r=+s;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:Du(String(s))}function Lu(s,r,o,c){for(;o<c;){const g=s[o+c>>1];let v=o-1,x=c+1;for(;;){do v++;while(s[v]<g);do x--;while(s[x]>g);if(v>=x)break;ga(s,v,x),ga(r,3*v,3*x),ga(r,3*v+1,3*x+1),ga(r,3*v+2,3*x+2)}x-o<c-x?(Lu(s,r,o,x),o=x+1):(Lu(s,r,x+1,c),c=x)}}function ga(s,r,o){const c=s[r];s[r]=s[o],s[o]=c}it("FeaturePositionMap",yl);class _l{constructor(r,o){this.gl=r.gl,this.location=o}}class hp extends _l{constructor(r,o){super(r,o),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class j1 extends _l{constructor(r,o){super(r,o),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class $1 extends _l{constructor(r,o){super(r,o),this.current=Ht.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const PI=new Float32Array(16);function Ly(s){return[bo(255*s.r,255*s.g),bo(255*s.b,255*s.a)]}class Bh{constructor(r,o,c){this.value=r,this.uniformNames=o.map(g=>`u_${g}`),this.type=c}setUniform(r,o,c){r.set(c.constantOr(this.value))}getBinding(r,o,c){return this.type==="color"?new $1(r,o):new hp(r,o)}}class Fu{constructor(r,o){this.uniformNames=o.map(c=>`u_${c}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=r.tlbr}setUniform(r,o,c,g){const v=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;v&&r.set(v)}getBinding(r,o,c){return c.substr(0,9)==="u_pattern"?new j1(r,o):new hp(r,o)}}class wo{constructor(r,o,c,g){this.expression=r,this.type=c,this.maxValue=0,this.paintVertexAttributes=o.map(v=>({name:`a_${v}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(r,o,c,g,v){const x=this.paintVertexArray.length,b=this.expression.evaluate(new un(0),o,{},g,[],v);this.paintVertexArray.resize(r),this._setPaintValue(x,r,b)}updatePaintArray(r,o,c,g){const v=this.expression.evaluate({zoom:0},c,g);this._setPaintValue(r,o,v)}_setPaintValue(r,o,c){if(this.type==="color"){const g=Ly(c);for(let v=r;v<o;v++)this.paintVertexArray.emplace(v,g[0],g[1])}else{for(let g=r;g<o;g++)this.paintVertexArray.emplace(g,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Cs{constructor(r,o,c,g,v,x){this.expression=r,this.uniformNames=o.map(b=>`u_${b}_t`),this.type=c,this.useIntegerZoom=g,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=o.map(b=>({name:`a_${b}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(r,o,c,g,v){const x=this.expression.evaluate(new un(this.zoom),o,{},g,[],v),b=this.expression.evaluate(new un(this.zoom+1),o,{},g,[],v),S=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(S,r,x,b)}updatePaintArray(r,o,c,g){const v=this.expression.evaluate({zoom:this.zoom},c,g),x=this.expression.evaluate({zoom:this.zoom+1},c,g);this._setPaintValue(r,o,v,x)}_setPaintValue(r,o,c,g){if(this.type==="color"){const v=Ly(c),x=Ly(g);for(let b=r;b<o;b++)this.paintVertexArray.emplace(b,v[0],v[1],x[0],x[1])}else{for(let v=r;v<o;v++)this.paintVertexArray.emplace(v,c,g);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(g))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,o){const c=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,g=_e(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);r.set(g)}getBinding(r,o,c){return new hp(r,o)}}class ya{constructor(r,o,c,g,v,x){this.expression=r,this.type=o,this.useIntegerZoom=c,this.zoom=g,this.layerId=x,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(r,o,c){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(g,r,o.patterns&&o.patterns[this.layerId],c)}updatePaintArray(r,o,c,g,v){this._setPaintValues(r,o,c.patterns&&c.patterns[this.layerId],v)}_setPaintValues(r,o,c,g){if(!g||!c)return;const{min:v,mid:x,max:b}=c,S=g[v],P=g[x],I=g[b];if(S&&P&&I)for(let R=r;R<o;R++)this.zoomInPaintVertexArray.emplace(R,P.tl[0],P.tl[1],P.br[0],P.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],P.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(R,P.tl[0],P.tl[1],P.br[0],P.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],P.pixelRatio,I.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,pa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,pa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class U1{constructor(r,o,c){this.binders={},this._buffers=[];const g=[];for(const v in r.paint._values){if(!c(v))continue;const x=r.paint.get(v);if(!(x instanceof ns&&ea(x.property.specification)))continue;const b=EI(v,r.type),S=x.value,P=x.property.specification.type,I=x.property.useIntegerZoom,R=x.property.specification["property-type"],B=R==="cross-faded"||R==="cross-faded-data-driven";if(S.kind==="constant")this.binders[v]=B?new Fu(S.value,b):new Bh(S.value,b,P),g.push(`/u_${v}`);else if(S.kind==="source"||B){const N=G1(v,P,"source");this.binders[v]=B?new ya(S,P,I,o,N,r.id):new wo(S,b,P,N),g.push(`/a_${v}`)}else{const N=G1(v,P,"composite");this.binders[v]=new Cs(S,b,P,I,o,N),g.push(`/z_${v}`)}}this.cacheKey=g.sort().join("")}getMaxValue(r){const o=this.binders[r];return o instanceof wo||o instanceof Cs?o.maxValue:0}populatePaintArrays(r,o,c,g,v){for(const x in this.binders){const b=this.binders[x];(b instanceof wo||b instanceof Cs||b instanceof ya)&&b.populatePaintArray(r,o,c,g,v)}}setConstantPatternPositions(r,o){for(const c in this.binders){const g=this.binders[c];g instanceof Fu&&g.setConstantPatternPositions(r,o)}}updatePaintArrays(r,o,c,g,v){let x=!1;for(const b in r){const S=o.getPositions(b);for(const P of S){const I=c.feature(P.index);for(const R in this.binders){const B=this.binders[R];if((B instanceof wo||B instanceof Cs||B instanceof ya)&&B.expression.isStateDependent===!0){const N=g.paint.get(R);B.expression=N.value,B.updatePaintArray(P.start,P.end,I,r[b],v),x=!0}}}}return x}defines(){const r=[];for(const o in this.binders){const c=this.binders[o];(c instanceof Bh||c instanceof Fu)&&r.push(...c.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return r}getBinderAttributes(){const r=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof wo||c instanceof Cs)for(let g=0;g<c.paintVertexAttributes.length;g++)r.push(c.paintVertexAttributes[g].name);else if(c instanceof ya)for(let g=0;g<pa.members.length;g++)r.push(pa.members[g].name)}return r}getBinderUniforms(){const r=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof Bh||c instanceof Fu||c instanceof Cs)for(const g of c.uniformNames)r.push(g)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,o){const c=[];for(const g in this.binders){const v=this.binders[g];if(v instanceof Bh||v instanceof Fu||v instanceof Cs){for(const x of v.uniformNames)if(o[x]){const b=v.getBinding(r,o[x],x);c.push({name:x,property:g,binding:b})}}}return c}setUniforms(r,o,c,g){for(const{name:v,property:x,binding:b}of o)this.binders[x].setUniform(b,g,c.get(x),v)}updatePaintBuffers(r){this._buffers=[];for(const o in this.binders){const c=this.binders[o];if(r&&c instanceof ya){const g=r.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(c instanceof wo||c instanceof Cs)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(r){for(const o in this.binders){const c=this.binders[o];(c instanceof wo||c instanceof Cs||c instanceof ya)&&c.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const o=this.binders[r];(o instanceof wo||o instanceof Cs||o instanceof ya)&&o.destroy()}}}class vl{constructor(r,o,c=()=>!0){this.programConfigurations={};for(const g of r)this.programConfigurations[g.id]=new U1(g,o,c);this.needsUpload=!1,this._featureMap=new yl,this._bufferOffset=0}populatePaintArrays(r,o,c,g,v,x){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(r,o,g,v,x);o.id!==void 0&&this._featureMap.add(o.id,c,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,o,c,g){for(const v of c)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(r,this._featureMap,o,v,g)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function EI(s,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${r}-`,"").replace(/-/g,"_")]}function G1(s,r,o){const c={color:{source:H,composite:wt},number:{source:Ye,composite:H}},g=function(v){return{"line-pattern":{source:di,composite:di},"fill-pattern":{source:di,composite:di},"fill-extrusion-pattern":{source:di,composite:di}}[v]}(s);return g&&g[o]||c[r][o]}it("ConstantBinder",Bh),it("CrossFadedConstantBinder",Fu),it("SourceExpressionBinder",wo),it("CrossFadedCompositeBinder",ya),it("CompositeExpressionBinder",Cs),it("ProgramConfiguration",U1,{omit:["_buffers"]}),it("ProgramConfigurationSet",vl);const Fn=8192,Fy=Math.pow(2,14)-1,q1=-Fy-1;function xl(s){const r=Fn/s.extent,o=s.loadGeometry();for(let c=0;c<o.length;c++){const g=o[c];for(let v=0;v<g.length;v++){const x=g[v],b=Math.round(x.x*r),S=Math.round(x.y*r);x.x=_e(b,q1,Fy),x.y=_e(S,q1,Fy),(b<x.x||b>x.x+1||S<x.y||S>x.y+1)&&je("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function bl(s,r){return{type:s.type,id:s.id,properties:s.properties,geometry:r?xl(s):[]}}function dp(s,r,o,c,g){s.emplaceBack(2*r+(c+1)/2,2*o+(g+1)/2)}class By{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new xr,this.indexArray=new Di,this.segments=new Ft,this.programConfigurations=new vl(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,c){const g=this.layers[0],v=[];let x=null,b=!1;g.type==="circle"&&(x=g.layout.get("circle-sort-key"),b=!x.isConstant());for(const{feature:S,id:P,index:I,sourceLayerIndex:R}of r){const B=this.layers[0]._featureFilter.needGeometry,N=bl(S,B);if(!this.layers[0]._featureFilter.filter(new un(this.zoom),N,c))continue;const $=b?x.evaluate(N,{},c):void 0,q={id:P,properties:S.properties,type:S.type,sourceLayerIndex:R,index:I,geometry:B?N.geometry:xl(S),patterns:{},sortKey:$};v.push(q)}b&&v.sort((S,P)=>S.sortKey-P.sortKey);for(const S of v){const{geometry:P,index:I,sourceLayerIndex:R}=S,B=r[I].feature;this.addFeature(S,P,I,c),o.featureIndex.insert(B,P,I,R,this.index)}}update(r,o,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Yr),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,o,c,g){for(const v of o)for(const x of v){const b=x.x,S=x.y;if(b<0||b>=Fn||S<0||S>=Fn)continue;const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),I=P.vertexLength;dp(this.layoutVertexArray,b,S,-1,-1),dp(this.layoutVertexArray,b,S,1,-1),dp(this.layoutVertexArray,b,S,1,1),dp(this.layoutVertexArray,b,S,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+3,I+2),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,{},g)}}function Z1(s,r){for(let o=0;o<s.length;o++)if(Bu(r,s[o]))return!0;for(let o=0;o<r.length;o++)if(Bu(s,r[o]))return!0;return!!Oy(s,r)}function II(s,r,o){return!!Bu(s,r)||!!Vy(r,s,o)}function W1(s,r){if(s.length===1)return X1(r,s[0]);for(let o=0;o<r.length;o++){const c=r[o];for(let g=0;g<c.length;g++)if(Bu(s,c[g]))return!0}for(let o=0;o<s.length;o++)if(X1(r,s[o]))return!0;for(let o=0;o<r.length;o++)if(Oy(s,r[o]))return!0;return!1}function MI(s,r,o){if(s.length>1){if(Oy(s,r))return!0;for(let c=0;c<r.length;c++)if(Vy(r[c],s,o))return!0}for(let c=0;c<s.length;c++)if(Vy(s[c],r,o))return!0;return!1}function Oy(s,r){if(s.length===0||r.length===0)return!1;for(let o=0;o<s.length-1;o++){const c=s[o],g=s[o+1];for(let v=0;v<r.length-1;v++)if(AI(c,g,r[v],r[v+1]))return!0}return!1}function AI(s,r,o,c){return Fe(s,o,c)!==Fe(r,o,c)&&Fe(s,r,o)!==Fe(s,r,c)}function Vy(s,r,o){const c=o*o;if(r.length===1)return s.distSqr(r[0])<c;for(let g=1;g<r.length;g++)if(H1(s,r[g-1],r[g])<c)return!0;return!1}function H1(s,r,o){const c=r.distSqr(o);if(c===0)return s.distSqr(r);const g=((s.x-r.x)*(o.x-r.x)+(s.y-r.y)*(o.y-r.y))/c;return s.distSqr(g<0?r:g>1?o:o.sub(r)._mult(g)._add(r))}function X1(s,r){let o,c,g,v=!1;for(let x=0;x<s.length;x++){o=s[x];for(let b=0,S=o.length-1;b<o.length;S=b++)c=o[b],g=o[S],c.y>r.y!=g.y>r.y&&r.x<(g.x-c.x)*(r.y-c.y)/(g.y-c.y)+c.x&&(v=!v)}return v}function Bu(s,r){let o=!1;for(let c=0,g=s.length-1;c<s.length;g=c++){const v=s[c],x=s[g];v.y>r.y!=x.y>r.y&&r.x<(x.x-v.x)*(r.y-v.y)/(x.y-v.y)+v.x&&(o=!o)}return o}function zI(s,r,o){const c=o[0],g=o[2];if(s.x<c.x&&r.x<c.x||s.x>g.x&&r.x>g.x||s.y<c.y&&r.y<c.y||s.y>g.y&&r.y>g.y)return!1;const v=Fe(s,r,o[0]);return v!==Fe(s,r,o[1])||v!==Fe(s,r,o[2])||v!==Fe(s,r,o[3])}function Oh(s,r,o){const c=r.paint.get(s).value;return c.kind==="constant"?c.value:o.programConfigurations.get(r.id).getMaxValue(s)}function fp(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function pp(s,r,o,c,g){if(!r[0]&&!r[1])return s;const v=z.convert(r)._mult(g);o==="viewport"&&v._rotate(-c);const x=[];for(let b=0;b<s.length;b++)x.push(s[b].sub(v));return x}let K1,Y1;it("CircleBucket",By,{omit:["layers"]});var DI={get paint(){return Y1=Y1||new _({"circle-radius":new yt(ke.paint_circle["circle-radius"]),"circle-color":new yt(ke.paint_circle["circle-color"]),"circle-blur":new yt(ke.paint_circle["circle-blur"]),"circle-opacity":new yt(ke.paint_circle["circle-opacity"]),"circle-translate":new ot(ke.paint_circle["circle-translate"]),"circle-translate-anchor":new ot(ke.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ot(ke.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ot(ke.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new yt(ke.paint_circle["circle-stroke-width"]),"circle-stroke-color":new yt(ke.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new yt(ke.paint_circle["circle-stroke-opacity"])})},get layout(){return K1=K1||new _({"circle-sort-key":new yt(ke.layout_circle["circle-sort-key"])})}},zr=1e-6,Ou=typeof Float32Array<"u"?Float32Array:Array;function Ny(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function J1(s,r,o){var c=r[0],g=r[1],v=r[2],x=r[3],b=r[4],S=r[5],P=r[6],I=r[7],R=r[8],B=r[9],N=r[10],$=r[11],q=r[12],ee=r[13],se=r[14],we=r[15],de=o[0],xe=o[1],Pe=o[2],Le=o[3];return s[0]=de*c+xe*b+Pe*R+Le*q,s[1]=de*g+xe*S+Pe*B+Le*ee,s[2]=de*v+xe*P+Pe*N+Le*se,s[3]=de*x+xe*I+Pe*$+Le*we,s[4]=(de=o[4])*c+(xe=o[5])*b+(Pe=o[6])*R+(Le=o[7])*q,s[5]=de*g+xe*S+Pe*B+Le*ee,s[6]=de*v+xe*P+Pe*N+Le*se,s[7]=de*x+xe*I+Pe*$+Le*we,s[8]=(de=o[8])*c+(xe=o[9])*b+(Pe=o[10])*R+(Le=o[11])*q,s[9]=de*g+xe*S+Pe*B+Le*ee,s[10]=de*v+xe*P+Pe*N+Le*se,s[11]=de*x+xe*I+Pe*$+Le*we,s[12]=(de=o[12])*c+(xe=o[13])*b+(Pe=o[14])*R+(Le=o[15])*q,s[13]=de*g+xe*S+Pe*B+Le*ee,s[14]=de*v+xe*P+Pe*N+Le*se,s[15]=de*x+xe*I+Pe*$+Le*we,s}Math.hypot||(Math.hypot=function(){for(var s=0,r=arguments.length;r--;)s+=arguments[r]*arguments[r];return Math.sqrt(s)});var Vh,RI=J1;function mp(s,r,o){var c=r[0],g=r[1],v=r[2],x=r[3];return s[0]=o[0]*c+o[4]*g+o[8]*v+o[12]*x,s[1]=o[1]*c+o[5]*g+o[9]*v+o[13]*x,s[2]=o[2]*c+o[6]*g+o[10]*v+o[14]*x,s[3]=o[3]*c+o[7]*g+o[11]*v+o[15]*x,s}Vh=new Ou(4),Ou!=Float32Array&&(Vh[0]=0,Vh[1]=0,Vh[2]=0,Vh[3]=0);class LI extends l{constructor(r){super(r,DI)}createBucket(r){return new By(r)}queryRadius(r){const o=r;return Oh("circle-radius",this,o)+Oh("circle-stroke-width",this,o)+fp(this.paint.get("circle-translate"))}queryIntersectsFeature(r,o,c,g,v,x,b,S){const P=pp(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,b),I=this.paint.get("circle-radius").evaluate(o,c)+this.paint.get("circle-stroke-width").evaluate(o,c),R=this.paint.get("circle-pitch-alignment")==="map",B=R?P:function($,q){return $.map(ee=>Q1(ee,q))}(P,S),N=R?I*b:I;for(const $ of g)for(const q of $){const ee=R?q:Q1(q,S);let se=N;const we=mp([],[q.x,q.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?se*=we[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(se*=x.cameraToCenterDistance/we[3]),II(B,ee,se))return!0}return!1}}function Q1(s,r){const o=mp([],[s.x,s.y,0,1],r);return new z(o[0]/o[3],o[1]/o[3])}class eb extends By{}let tb;it("HeatmapBucket",eb,{omit:["layers"]});var FI={get paint(){return tb=tb||new _({"heatmap-radius":new yt(ke.paint_heatmap["heatmap-radius"]),"heatmap-weight":new yt(ke.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ot(ke.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Lh(ke.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ot(ke.paint_heatmap["heatmap-opacity"])})}};function jy(s,{width:r,height:o},c,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==r*o*c)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${r*o*c}`)}else g=new Uint8Array(r*o*c);return s.width=r,s.height=o,s.data=g,s}function nb(s,{width:r,height:o},c){if(r===s.width&&o===s.height)return;const g=jy({},{width:r,height:o},c);$y(s,g,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,r),height:Math.min(s.height,o)},c),s.width=r,s.height=o,s.data=g.data}function $y(s,r,o,c,g,v){if(g.width===0||g.height===0)return r;if(g.width>s.width||g.height>s.height||o.x>s.width-g.width||o.y>s.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>r.width||g.height>r.height||c.x>r.width-g.width||c.y>r.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const x=s.data,b=r.data;if(x===b)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<g.height;S++){const P=((o.y+S)*s.width+o.x)*v,I=((c.y+S)*r.width+c.x)*v;for(let R=0;R<g.width*v;R++)b[I+R]=x[P+R]}return r}class Nh{constructor(r,o){jy(this,r,1,o)}resize(r){nb(this,r,1)}clone(){return new Nh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,o,c,g,v){$y(r,o,c,g,v,1)}}class Ri{constructor(r,o){jy(this,r,4,o)}resize(r){nb(this,r,4)}replace(r,o){o?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Ri({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,o,c,g,v){$y(r,o,c,g,v,4)}}function rb(s){const r={},o=s.resolution||256,c=s.clips?s.clips.length:1,g=s.image||new Ri({width:o,height:c});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const v=(x,b,S)=>{r[s.evaluationKey]=S;const P=s.expression.evaluate(r);g.data[x+b+0]=Math.floor(255*P.r/P.a),g.data[x+b+1]=Math.floor(255*P.g/P.a),g.data[x+b+2]=Math.floor(255*P.b/P.a),g.data[x+b+3]=Math.floor(255*P.a)};if(s.clips)for(let x=0,b=0;x<c;++x,b+=4*o)for(let S=0,P=0;S<o;S++,P+=4){const I=S/(o-1),{start:R,end:B}=s.clips[x];v(b,P,R*(1-I)+B*I)}else for(let x=0,b=0;x<o;x++,b+=4)v(0,b,x/(o-1));return g}it("AlphaImage",Nh),it("RGBAImage",Ri);const Uy="big-fb";class BI extends l{createBucket(r){return new eb(r)}constructor(r){super(r,FI),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=rb({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Uy)&&this.heatmapFbos.delete(Uy)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let ib;var OI={get paint(){return ib=ib||new _({"hillshade-illumination-direction":new ot(ke.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ot(ke.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ot(ke.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ot(ke.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ot(ke.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ot(ke.paint_hillshade["hillshade-accent-color"])})}};class VI extends l{constructor(r){super(r,OI)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const NI=w([{name:"a_pos",components:2,type:"Int16"}],4),{members:jI}=NI;function sb(s,r,o=2){const c=r&&r.length,g=c?r[0]*o:s.length;let v=ob(s,0,g,o,!0);const x=[];if(!v||v.next===v.prev)return x;let b,S,P;if(c&&(v=function(I,R,B,N){const $=[];for(let q=0,ee=R.length;q<ee;q++){const se=ob(I,R[q]*N,q<ee-1?R[q+1]*N:I.length,N,!1);se===se.next&&(se.steiner=!0),$.push(XI(se))}$.sort(ZI);for(let q=0;q<$.length;q++)B=WI($[q],B);return B}(s,r,v,o)),s.length>80*o){b=1/0,S=1/0;let I=-1/0,R=-1/0;for(let B=o;B<g;B+=o){const N=s[B],$=s[B+1];N<b&&(b=N),$<S&&(S=$),N>I&&(I=N),$>R&&(R=$)}P=Math.max(I-b,R-S),P=P!==0?32767/P:0}return jh(v,x,o,b,S,P,0),x}function ob(s,r,o,c,g){let v;if(g===function(x,b,S,P){let I=0;for(let R=b,B=S-P;R<S;R+=P)I+=(x[B]-x[R])*(x[R+1]+x[B+1]),B=R;return I}(s,r,o,c)>0)for(let x=r;x<o;x+=c)v=ub(x/c|0,s[x],s[x+1],v);else for(let x=o-c;x>=r;x-=c)v=ub(x/c|0,s[x],s[x+1],v);return v&&gp(v,v.next)&&(Uh(v),v=v.next),v}function wl(s,r){if(!s)return s;r||(r=s);let o,c=s;do if(o=!1,c.steiner||!gp(c,c.next)&&En(c.prev,c,c.next)!==0)c=c.next;else{if(Uh(c),c=r=c.prev,c===c.next)break;o=!0}while(o||c!==r);return r}function jh(s,r,o,c,g,v,x){if(!s)return;!x&&v&&function(S,P,I,R){let B=S;do B.z===0&&(B.z=Gy(B.x,B.y,P,I,R)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==S);B.prevZ.nextZ=null,B.prevZ=null,function(N){let $,q=1;do{let ee,se=N;N=null;let we=null;for($=0;se;){$++;let de=se,xe=0;for(let Le=0;Le<q&&(xe++,de=de.nextZ,de);Le++);let Pe=q;for(;xe>0||Pe>0&&de;)xe!==0&&(Pe===0||!de||se.z<=de.z)?(ee=se,se=se.nextZ,xe--):(ee=de,de=de.nextZ,Pe--),we?we.nextZ=ee:N=ee,ee.prevZ=we,we=ee;se=de}we.nextZ=null,q*=2}while($>1)}(B)}(s,c,g,v);let b=s;for(;s.prev!==s.next;){const S=s.prev,P=s.next;if(v?UI(s,c,g,v):$I(s))r.push(S.i,s.i,P.i),Uh(s),s=P.next,b=P.next;else if((s=P)===b){x?x===1?jh(s=GI(wl(s),r),r,o,c,g,v,2):x===2&&qI(s,r,o,c,g,v):jh(wl(s),r,o,c,g,v,1);break}}}function $I(s){const r=s.prev,o=s,c=s.next;if(En(r,o,c)>=0)return!1;const g=r.x,v=o.x,x=c.x,b=r.y,S=o.y,P=c.y,I=g<v?g<x?g:x:v<x?v:x,R=b<S?b<P?b:P:S<P?S:P,B=g>v?g>x?g:x:v>x?v:x,N=b>S?b>P?b:P:S>P?S:P;let $=c.next;for(;$!==r;){if($.x>=I&&$.x<=B&&$.y>=R&&$.y<=N&&Vu(g,b,v,S,x,P,$.x,$.y)&&En($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function UI(s,r,o,c){const g=s.prev,v=s,x=s.next;if(En(g,v,x)>=0)return!1;const b=g.x,S=v.x,P=x.x,I=g.y,R=v.y,B=x.y,N=b<S?b<P?b:P:S<P?S:P,$=I<R?I<B?I:B:R<B?R:B,q=b>S?b>P?b:P:S>P?S:P,ee=I>R?I>B?I:B:R>B?R:B,se=Gy(N,$,r,o,c),we=Gy(q,ee,r,o,c);let de=s.prevZ,xe=s.nextZ;for(;de&&de.z>=se&&xe&&xe.z<=we;){if(de.x>=N&&de.x<=q&&de.y>=$&&de.y<=ee&&de!==g&&de!==x&&Vu(b,I,S,R,P,B,de.x,de.y)&&En(de.prev,de,de.next)>=0||(de=de.prevZ,xe.x>=N&&xe.x<=q&&xe.y>=$&&xe.y<=ee&&xe!==g&&xe!==x&&Vu(b,I,S,R,P,B,xe.x,xe.y)&&En(xe.prev,xe,xe.next)>=0))return!1;xe=xe.nextZ}for(;de&&de.z>=se;){if(de.x>=N&&de.x<=q&&de.y>=$&&de.y<=ee&&de!==g&&de!==x&&Vu(b,I,S,R,P,B,de.x,de.y)&&En(de.prev,de,de.next)>=0)return!1;de=de.prevZ}for(;xe&&xe.z<=we;){if(xe.x>=N&&xe.x<=q&&xe.y>=$&&xe.y<=ee&&xe!==g&&xe!==x&&Vu(b,I,S,R,P,B,xe.x,xe.y)&&En(xe.prev,xe,xe.next)>=0)return!1;xe=xe.nextZ}return!0}function GI(s,r){let o=s;do{const c=o.prev,g=o.next.next;!gp(c,g)&&ab(c,o,o.next,g)&&$h(c,g)&&$h(g,c)&&(r.push(c.i,o.i,g.i),Uh(o),Uh(o.next),o=s=g),o=o.next}while(o!==s);return wl(o)}function qI(s,r,o,c,g,v){let x=s;do{let b=x.next.next;for(;b!==x.prev;){if(x.i!==b.i&&KI(x,b)){let S=lb(x,b);return x=wl(x,x.next),S=wl(S,S.next),jh(x,r,o,c,g,v,0),void jh(S,r,o,c,g,v,0)}b=b.next}x=x.next}while(x!==s)}function ZI(s,r){return s.x-r.x}function WI(s,r){const o=function(g,v){let x=v;const b=g.x,S=g.y;let P,I=-1/0;do{if(S<=x.y&&S>=x.next.y&&x.next.y!==x.y){const q=x.x+(S-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(q<=b&&q>I&&(I=q,P=x.x<x.next.x?x:x.next,q===b))return P}x=x.next}while(x!==v);if(!P)return null;const R=P,B=P.x,N=P.y;let $=1/0;x=P;do{if(b>=x.x&&x.x>=B&&b!==x.x&&Vu(S<N?b:I,S,B,N,S<N?I:b,S,x.x,x.y)){const q=Math.abs(S-x.y)/(b-x.x);$h(x,g)&&(q<$||q===$&&(x.x>P.x||x.x===P.x&&HI(P,x)))&&(P=x,$=q)}x=x.next}while(x!==R);return P}(s,r);if(!o)return r;const c=lb(o,s);return wl(c,c.next),wl(o,o.next)}function HI(s,r){return En(s.prev,s,r.prev)<0&&En(r.next,s,s.next)<0}function Gy(s,r,o,c,g){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-o)*g|0)|s<<8))|s<<4))|s<<2))|s<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-c)*g|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function XI(s){let r=s,o=s;do(r.x<o.x||r.x===o.x&&r.y<o.y)&&(o=r),r=r.next;while(r!==s);return o}function Vu(s,r,o,c,g,v,x,b){return(g-x)*(r-b)>=(s-x)*(v-b)&&(s-x)*(c-b)>=(o-x)*(r-b)&&(o-x)*(v-b)>=(g-x)*(c-b)}function KI(s,r){return s.next.i!==r.i&&s.prev.i!==r.i&&!function(o,c){let g=o;do{if(g.i!==o.i&&g.next.i!==o.i&&g.i!==c.i&&g.next.i!==c.i&&ab(g,g.next,o,c))return!0;g=g.next}while(g!==o);return!1}(s,r)&&($h(s,r)&&$h(r,s)&&function(o,c){let g=o,v=!1;const x=(o.x+c.x)/2,b=(o.y+c.y)/2;do g.y>b!=g.next.y>b&&g.next.y!==g.y&&x<(g.next.x-g.x)*(b-g.y)/(g.next.y-g.y)+g.x&&(v=!v),g=g.next;while(g!==o);return v}(s,r)&&(En(s.prev,s,r.prev)||En(s,r.prev,r))||gp(s,r)&&En(s.prev,s,s.next)>0&&En(r.prev,r,r.next)>0)}function En(s,r,o){return(r.y-s.y)*(o.x-r.x)-(r.x-s.x)*(o.y-r.y)}function gp(s,r){return s.x===r.x&&s.y===r.y}function ab(s,r,o,c){const g=_p(En(s,r,o)),v=_p(En(s,r,c)),x=_p(En(o,c,s)),b=_p(En(o,c,r));return g!==v&&x!==b||!(g!==0||!yp(s,o,r))||!(v!==0||!yp(s,c,r))||!(x!==0||!yp(o,s,c))||!(b!==0||!yp(o,r,c))}function yp(s,r,o){return r.x<=Math.max(s.x,o.x)&&r.x>=Math.min(s.x,o.x)&&r.y<=Math.max(s.y,o.y)&&r.y>=Math.min(s.y,o.y)}function _p(s){return s>0?1:s<0?-1:0}function $h(s,r){return En(s.prev,s,s.next)<0?En(s,r,s.next)>=0&&En(s,s.prev,r)>=0:En(s,r,s.prev)<0||En(s,s.next,r)<0}function lb(s,r){const o=qy(s.i,s.x,s.y),c=qy(r.i,r.x,r.y),g=s.next,v=r.prev;return s.next=r,r.prev=s,o.next=g,g.prev=o,c.next=o,o.prev=c,v.next=c,c.prev=v,c}function ub(s,r,o,c){const g=qy(s,r,o);return c?(g.next=c.next,g.prev=c,c.next.prev=g,c.next=g):(g.prev=g,g.next=g),g}function Uh(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function qy(s,r,o){return{i:s,x:r,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Zy(s,r,o){const c=o.patternDependencies;let g=!1;for(const v of r){const x=v.paint.get(`${s}-pattern`);x.isConstant()||(g=!0);const b=x.constantOr(null);b&&(g=!0,c[b.to]=!0,c[b.from]=!0)}return g}function Wy(s,r,o,c,g){const v=g.patternDependencies;for(const x of r){const b=x.paint.get(`${s}-pattern`).value;if(b.kind!=="constant"){let S=b.evaluate({zoom:c-1},o,{},g.availableImages),P=b.evaluate({zoom:c},o,{},g.availableImages),I=b.evaluate({zoom:c+1},o,{},g.availableImages);S=S&&S.name?S.name:S,P=P&&P.name?P.name:P,I=I&&I.name?I.name:I,v[S]=!0,v[P]=!0,v[I]=!0,o.patterns[x.id]={min:S,mid:P,max:I}}}return o}class Hy{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new rs,this.indexArray=new Di,this.indexArray2=new er,this.programConfigurations=new vl(r.layers,r.zoom),this.segments=new Ft,this.segments2=new Ft,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,c){this.hasPattern=Zy("fill",this.layers,o);const g=this.layers[0].layout.get("fill-sort-key"),v=!g.isConstant(),x=[];for(const{feature:b,id:S,index:P,sourceLayerIndex:I}of r){const R=this.layers[0]._featureFilter.needGeometry,B=bl(b,R);if(!this.layers[0]._featureFilter.filter(new un(this.zoom),B,c))continue;const N=v?g.evaluate(B,{},c,o.availableImages):void 0,$={id:S,properties:b.properties,type:b.type,sourceLayerIndex:I,index:P,geometry:R?B.geometry:xl(b),patterns:{},sortKey:N};x.push($)}v&&x.sort((b,S)=>b.sortKey-S.sortKey);for(const b of x){const{geometry:S,index:P,sourceLayerIndex:I}=b;if(this.hasPattern){const R=Wy("fill",this.layers,b,this.zoom,o);this.patternFeatures.push(R)}else this.addFeature(b,S,P,c,{});o.featureIndex.insert(r[P].feature,S,P,I,this.index)}}update(r,o,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,c)}addFeatures(r,o,c){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,o,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,jI),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,o,c,g,v){for(const x of uu(o,500)){let b=0;for(const N of x)b+=N.length;const S=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),P=S.vertexLength,I=[],R=[];for(const N of x){if(N.length===0)continue;N!==x[0]&&R.push(I.length/2);const $=this.segments2.prepareSegment(N.length,this.layoutVertexArray,this.indexArray2),q=$.vertexLength;this.layoutVertexArray.emplaceBack(N[0].x,N[0].y),this.indexArray2.emplaceBack(q+N.length-1,q),I.push(N[0].x),I.push(N[0].y);for(let ee=1;ee<N.length;ee++)this.layoutVertexArray.emplaceBack(N[ee].x,N[ee].y),this.indexArray2.emplaceBack(q+ee-1,q+ee),I.push(N[ee].x),I.push(N[ee].y);$.vertexLength+=N.length,$.primitiveLength+=N.length}const B=sb(I,R);for(let N=0;N<B.length;N+=3)this.indexArray.emplaceBack(P+B[N],P+B[N+1],P+B[N+2]);S.vertexLength+=b,S.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,v,g)}}let cb,hb;it("FillBucket",Hy,{omit:["layers","patternFeatures"]});var YI={get paint(){return hb=hb||new _({"fill-antialias":new ot(ke.paint_fill["fill-antialias"]),"fill-opacity":new yt(ke.paint_fill["fill-opacity"]),"fill-color":new yt(ke.paint_fill["fill-color"]),"fill-outline-color":new yt(ke.paint_fill["fill-outline-color"]),"fill-translate":new ot(ke.paint_fill["fill-translate"]),"fill-translate-anchor":new ot(ke.paint_fill["fill-translate-anchor"]),"fill-pattern":new Iu(ke.paint_fill["fill-pattern"])})},get layout(){return cb=cb||new _({"fill-sort-key":new yt(ke.layout_fill["fill-sort-key"])})}};class JI extends l{constructor(r){super(r,YI)}recalculate(r,o){super.recalculate(r,o);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Hy(r)}queryRadius(){return fp(this.paint.get("fill-translate"))}queryIntersectsFeature(r,o,c,g,v,x,b){return W1(pp(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,b),g)}isTileClipped(){return!0}}const QI=w([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),eM=w([{name:"a_centroid",components:2,type:"Int16"}],4),{members:tM}=QI;var _a={},nM=E,db=Nu;function Nu(s,r,o,c,g){this.properties={},this.extent=o,this.type=0,this._pbf=s,this._geometry=-1,this._keys=c,this._values=g,s.readFields(rM,this,r)}function rM(s,r,o){s==1?r.id=o.readVarint():s==2?function(c,g){for(var v=c.readVarint()+c.pos;c.pos<v;){var x=g._keys[c.readVarint()],b=g._values[c.readVarint()];g.properties[x]=b}}(o,r):s==3?r.type=o.readVarint():s==4&&(r._geometry=o.pos)}function iM(s){for(var r,o,c=0,g=0,v=s.length,x=v-1;g<v;x=g++)c+=((o=s[x]).x-(r=s[g]).x)*(r.y+o.y);return c}Nu.types=["Unknown","Point","LineString","Polygon"],Nu.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var r,o=s.readVarint()+s.pos,c=1,g=0,v=0,x=0,b=[];s.pos<o;){if(g<=0){var S=s.readVarint();c=7&S,g=S>>3}if(g--,c===1||c===2)v+=s.readSVarint(),x+=s.readSVarint(),c===1&&(r&&b.push(r),r=[]),r.push(new nM(v,x));else{if(c!==7)throw new Error("unknown command "+c);r&&r.push(r[0].clone())}}return r&&b.push(r),b},Nu.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var r=s.readVarint()+s.pos,o=1,c=0,g=0,v=0,x=1/0,b=-1/0,S=1/0,P=-1/0;s.pos<r;){if(c<=0){var I=s.readVarint();o=7&I,c=I>>3}if(c--,o===1||o===2)(g+=s.readSVarint())<x&&(x=g),g>b&&(b=g),(v+=s.readSVarint())<S&&(S=v),v>P&&(P=v);else if(o!==7)throw new Error("unknown command "+o)}return[x,S,b,P]},Nu.prototype.toGeoJSON=function(s,r,o){var c,g,v=this.extent*Math.pow(2,o),x=this.extent*s,b=this.extent*r,S=this.loadGeometry(),P=Nu.types[this.type];function I(N){for(var $=0;$<N.length;$++){var q=N[$];N[$]=[360*(q.x+x)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(q.y+b)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(c=0;c<S.length;c++)R[c]=S[c][0];I(S=R);break;case 2:for(c=0;c<S.length;c++)I(S[c]);break;case 3:for(S=function(N){var $=N.length;if($<=1)return[N];for(var q,ee,se=[],we=0;we<$;we++){var de=iM(N[we]);de!==0&&(ee===void 0&&(ee=de<0),ee===de<0?(q&&se.push(q),q=[N[we]]):q.push(N[we]))}return q&&se.push(q),se}(S),c=0;c<S.length;c++)for(g=0;g<S[c].length;g++)I(S[c][g])}S.length===1?S=S[0]:P="Multi"+P;var B={type:"Feature",geometry:{type:P,coordinates:S},properties:this.properties};return"id"in this&&(B.id=this.id),B};var sM=db,fb=pb;function pb(s,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(oM,this,r),this.length=this._features.length}function oM(s,r,o){s===15?r.version=o.readVarint():s===1?r.name=o.readString():s===5?r.extent=o.readVarint():s===2?r._features.push(o.pos):s===3?r._keys.push(o.readString()):s===4&&r._values.push(function(c){for(var g=null,v=c.readVarint()+c.pos;c.pos<v;){var x=c.readVarint()>>3;g=x===1?c.readString():x===2?c.readFloat():x===3?c.readDouble():x===4?c.readVarint64():x===5?c.readVarint():x===6?c.readSVarint():x===7?c.readBoolean():null}return g}(o))}pb.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var r=this._pbf.readVarint()+this._pbf.pos;return new sM(this._pbf,r,this.extent,this._keys,this._values)};var aM=fb;function lM(s,r,o){if(s===3){var c=new aM(o,o.readVarint()+o.pos);c.length&&(r[c.name]=c)}}_a.VectorTile=function(s,r){this.layers=s.readFields(lM,{},r)},_a.VectorTileFeature=db,_a.VectorTileLayer=fb;const uM=_a.VectorTileFeature.types,Xy=Math.pow(2,13);function Gh(s,r,o,c,g,v,x,b){s.emplaceBack(r,o,2*Math.floor(c*Xy)+x,g*Xy*2,v*Xy*2,Math.round(b))}class Ky{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new da,this.centroidVertexArray=new lr,this.indexArray=new Di,this.programConfigurations=new vl(r.layers,r.zoom),this.segments=new Ft,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,c){this.features=[],this.hasPattern=Zy("fill-extrusion",this.layers,o);for(const{feature:g,id:v,index:x,sourceLayerIndex:b}of r){const S=this.layers[0]._featureFilter.needGeometry,P=bl(g,S);if(!this.layers[0]._featureFilter.filter(new un(this.zoom),P,c))continue;const I={id:v,sourceLayerIndex:b,index:x,geometry:S?P.geometry:xl(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(Wy("fill-extrusion",this.layers,I,this.zoom,o)):this.addFeature(I,I.geometry,x,c,{}),o.featureIndex.insert(g,I.geometry,x,b,this.index,!0)}}addFeatures(r,o,c){for(const g of this.features){const{geometry:v}=g;this.addFeature(g,v,g.index,o,c)}}update(r,o,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,tM),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,eM.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,o,c,g,v){for(const x of uu(o,500)){const b={x:0,y:0,vertexCount:0};let S=0;for(const $ of x)S+=$.length;let P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const $ of x){if($.length===0||hM($))continue;let q=0;for(let ee=0;ee<$.length;ee++){const se=$[ee];if(ee>=1){const we=$[ee-1];if(!cM(se,we)){P.vertexLength+4>Ft.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const de=se.sub(we)._perp()._unit(),xe=we.dist(se);q+xe>32768&&(q=0),Gh(this.layoutVertexArray,se.x,se.y,de.x,de.y,0,0,q),Gh(this.layoutVertexArray,se.x,se.y,de.x,de.y,0,1,q),b.x+=2*se.x,b.y+=2*se.y,b.vertexCount+=2,q+=xe,Gh(this.layoutVertexArray,we.x,we.y,de.x,de.y,0,0,q),Gh(this.layoutVertexArray,we.x,we.y,de.x,de.y,0,1,q),b.x+=2*we.x,b.y+=2*we.y,b.vertexCount+=2;const Pe=P.vertexLength;this.indexArray.emplaceBack(Pe,Pe+2,Pe+1),this.indexArray.emplaceBack(Pe+1,Pe+2,Pe+3),P.vertexLength+=4,P.primitiveLength+=2}}}}if(P.vertexLength+S>Ft.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),uM[r.type]!=="Polygon")continue;const I=[],R=[],B=P.vertexLength;for(const $ of x)if($.length!==0){$!==x[0]&&R.push(I.length/2);for(let q=0;q<$.length;q++){const ee=$[q];Gh(this.layoutVertexArray,ee.x,ee.y,0,0,1,1,0),b.x+=ee.x,b.y+=ee.y,b.vertexCount+=1,I.push(ee.x),I.push(ee.y)}}const N=sb(I,R);for(let $=0;$<N.length;$+=3)this.indexArray.emplaceBack(B+N[$],B+N[$+2],B+N[$+1]);P.primitiveLength+=N.length/3,P.vertexLength+=S;for(let $=0;$<b.vertexCount;$++){const q=Math.floor(b.x/b.vertexCount),ee=Math.floor(b.y/b.vertexCount);this.centroidVertexArray.emplaceBack(q,ee)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,v,g)}}function cM(s,r){return s.x===r.x&&(s.x<0||s.x>Fn)||s.y===r.y&&(s.y<0||s.y>Fn)}function hM(s){return s.every(r=>r.x<0)||s.every(r=>r.x>Fn)||s.every(r=>r.y<0)||s.every(r=>r.y>Fn)}let mb;it("FillExtrusionBucket",Ky,{omit:["layers","features"]});var dM={get paint(){return mb=mb||new _({"fill-extrusion-opacity":new ot(ke["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new yt(ke["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ot(ke["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ot(ke["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Iu(ke["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new yt(ke["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new yt(ke["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ot(ke["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class fM extends l{constructor(r){super(r,dM)}createBucket(r){return new Ky(r)}queryRadius(){return fp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,o,c,g,v,x,b,S){const P=pp(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,b),I=this.paint.get("fill-extrusion-height").evaluate(o,c),R=this.paint.get("fill-extrusion-base").evaluate(o,c),B=function($,q,ee,se){const we=[];for(const de of $){const xe=[de.x,de.y,0,1];mp(xe,xe,q),we.push(new z(xe[0]/xe[3],xe[1]/xe[3]))}return we}(P,S),N=function($,q,ee,se){const we=[],de=[],xe=se[8]*q,Pe=se[9]*q,Le=se[10]*q,et=se[11]*q,mt=se[8]*ee,Je=se[9]*ee,Ke=se[10]*ee,ut=se[11]*ee;for(const st of $){const rt=[],Me=[];for(const ct of st){const lt=ct.x,xt=ct.y,en=se[0]*lt+se[4]*xt+se[12],Yt=se[1]*lt+se[5]*xt+se[13],Wn=se[2]*lt+se[6]*xt+se[14],is=se[3]*lt+se[7]*xt+se[15],hr=Wn+Le,Hn=is+et,Dr=en+mt,Rr=Yt+Je,Lr=Wn+Ke,Sn=is+ut,Xn=new z((en+xe)/Hn,(Yt+Pe)/Hn);Xn.z=hr/Hn,rt.push(Xn);const br=new z(Dr/Sn,Rr/Sn);br.z=Lr/Sn,Me.push(br)}we.push(rt),de.push(Me)}return[we,de]}(g,R,I,S);return function($,q,ee){let se=1/0;W1(ee,q)&&(se=gb(ee,q[0]));for(let we=0;we<q.length;we++){const de=q[we],xe=$[we];for(let Pe=0;Pe<de.length-1;Pe++){const Le=de[Pe],et=[Le,de[Pe+1],xe[Pe+1],xe[Pe],Le];Z1(ee,et)&&(se=Math.min(se,gb(ee,et)))}}return se!==1/0&&se}(N[0],N[1],B)}}function qh(s,r){return s.x*r.x+s.y*r.y}function gb(s,r){if(s.length===1){let o=0;const c=r[o++];let g;for(;!g||c.equals(g);)if(g=r[o++],!g)return 1/0;for(;o<r.length;o++){const v=r[o],x=s[0],b=g.sub(c),S=v.sub(c),P=x.sub(c),I=qh(b,b),R=qh(b,S),B=qh(S,S),N=qh(P,b),$=qh(P,S),q=I*B-R*R,ee=(B*N-R*$)/q,se=(I*$-R*N)/q,we=c.z*(1-ee-se)+g.z*ee+v.z*se;if(isFinite(we))return we}return 1/0}{let o=1/0;for(const c of r)o=Math.min(o,c.z);return o}}const pM=w([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:mM}=pM,gM=w([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:yM}=gM,_M=_a.VectorTileFeature.types,vM=Math.cos(Math.PI/180*37.5),yb=Math.pow(2,14)/.5;class Yy{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new Au,this.layoutVertexArray2=new fa,this.indexArray=new Di,this.programConfigurations=new vl(r.layers,r.zoom),this.segments=new Ft,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,c){this.hasPattern=Zy("line",this.layers,o);const g=this.layers[0].layout.get("line-sort-key"),v=!g.isConstant(),x=[];for(const{feature:b,id:S,index:P,sourceLayerIndex:I}of r){const R=this.layers[0]._featureFilter.needGeometry,B=bl(b,R);if(!this.layers[0]._featureFilter.filter(new un(this.zoom),B,c))continue;const N=v?g.evaluate(B,{},c):void 0,$={id:S,properties:b.properties,type:b.type,sourceLayerIndex:I,index:P,geometry:R?B.geometry:xl(b),patterns:{},sortKey:N};x.push($)}v&&x.sort((b,S)=>b.sortKey-S.sortKey);for(const b of x){const{geometry:S,index:P,sourceLayerIndex:I}=b;if(this.hasPattern){const R=Wy("line",this.layers,b,this.zoom,o);this.patternFeatures.push(R)}else this.addFeature(b,S,P,c,{});o.featureIndex.insert(r[P].feature,S,P,I,this.index)}}update(r,o,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,c)}addFeatures(r,o,c){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,o,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,yM)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,mM),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,o,c,g,v){const x=this.layers[0].layout,b=x.get("line-join").evaluate(r,{}),S=x.get("line-cap"),P=x.get("line-miter-limit"),I=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const R of o)this.addLine(R,r,b,S,P,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,v,g)}addLine(r,o,c,g,v,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let se=0;se<r.length-1;se++)this.totalDistance+=r[se].dist(r[se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=_M[o.type]==="Polygon";let S=r.length;for(;S>=2&&r[S-1].equals(r[S-2]);)S--;let P=0;for(;P<S-1&&r[P].equals(r[P+1]);)P++;if(S<(b?3:2))return;c==="bevel"&&(v=1.05);const I=this.overscaling<=16?15*Fn/(512*this.overscaling):0,R=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let B,N,$,q,ee;this.e1=this.e2=-1,b&&(B=r[S-2],ee=r[P].sub(B)._unit()._perp());for(let se=P;se<S;se++){if($=se===S-1?b?r[P+1]:void 0:r[se+1],$&&r[se].equals($))continue;ee&&(q=ee),B&&(N=B),B=r[se],ee=$?$.sub(B)._unit()._perp():q,q=q||ee;let we=q.add(ee);we.x===0&&we.y===0||we._unit();const de=q.x*ee.x+q.y*ee.y,xe=we.x*ee.x+we.y*ee.y,Pe=xe!==0?1/xe:1/0,Le=2*Math.sqrt(2-2*xe),et=xe<vM&&N&&$,mt=q.x*ee.y-q.y*ee.x>0;if(et&&se>P){const ut=B.dist(N);if(ut>2*I){const st=B.sub(B.sub(N)._mult(I/ut)._round());this.updateDistance(N,st),this.addCurrentVertex(st,q,0,0,R),N=st}}const Je=N&&$;let Ke=Je?c:b?"butt":g;if(Je&&Ke==="round"&&(Pe<x?Ke="miter":Pe<=2&&(Ke="fakeround")),Ke==="miter"&&Pe>v&&(Ke="bevel"),Ke==="bevel"&&(Pe>2&&(Ke="flipbevel"),Pe<v&&(Ke="miter")),N&&this.updateDistance(N,B),Ke==="miter")we._mult(Pe),this.addCurrentVertex(B,we,0,0,R);else if(Ke==="flipbevel"){if(Pe>100)we=ee.mult(-1);else{const ut=Pe*q.add(ee).mag()/q.sub(ee).mag();we._perp()._mult(ut*(mt?-1:1))}this.addCurrentVertex(B,we,0,0,R),this.addCurrentVertex(B,we.mult(-1),0,0,R)}else if(Ke==="bevel"||Ke==="fakeround"){const ut=-Math.sqrt(Pe*Pe-1),st=mt?ut:0,rt=mt?0:ut;if(N&&this.addCurrentVertex(B,q,st,rt,R),Ke==="fakeround"){const Me=Math.round(180*Le/Math.PI/20);for(let ct=1;ct<Me;ct++){let lt=ct/Me;if(lt!==.5){const en=lt-.5;lt+=lt*en*(lt-1)*((1.0904+de*(de*(3.55645-1.43519*de)-3.2452))*en*en+(.848013+de*(.215638*de-1.06021)))}const xt=ee.sub(q)._mult(lt)._add(q)._unit()._mult(mt?-1:1);this.addHalfVertex(B,xt.x,xt.y,!1,mt,0,R)}}$&&this.addCurrentVertex(B,ee,-st,-rt,R)}else if(Ke==="butt")this.addCurrentVertex(B,we,0,0,R);else if(Ke==="square"){const ut=N?1:-1;this.addCurrentVertex(B,we,ut,ut,R)}else Ke==="round"&&(N&&(this.addCurrentVertex(B,q,0,0,R),this.addCurrentVertex(B,q,1,1,R,!0)),$&&(this.addCurrentVertex(B,ee,-1,-1,R,!0),this.addCurrentVertex(B,ee,0,0,R)));if(et&&se<S-1){const ut=B.dist($);if(ut>2*I){const st=B.add($.sub(B)._mult(I/ut)._round());this.updateDistance(B,st),this.addCurrentVertex(st,ee,0,0,R),B=st}}}}addCurrentVertex(r,o,c,g,v,x=!1){const b=o.y*g-o.x,S=-o.y-o.x*g;this.addHalfVertex(r,o.x+o.y*c,o.y-o.x*c,x,!1,c,v),this.addHalfVertex(r,b,S,x,!0,-g,v),this.distance>yb/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,o,c,g,v,x))}addHalfVertex({x:r,y:o},c,g,v,x,b,S){const P=.5*(this.lineClips?this.scaledDistance*(yb-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(v?1:0),(o<<1)+(x?1:0),Math.round(63*c)+128,Math.round(63*g)+128,1+(b===0?0:b<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const I=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),S.primitiveLength++),x?this.e2=I:this.e1=I}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,o){this.distance+=r.dist(o),this.updateScaledDistance()}}let _b,vb;it("LineBucket",Yy,{omit:["layers","patternFeatures"]});var xb={get paint(){return vb=vb||new _({"line-opacity":new yt(ke.paint_line["line-opacity"]),"line-color":new yt(ke.paint_line["line-color"]),"line-translate":new ot(ke.paint_line["line-translate"]),"line-translate-anchor":new ot(ke.paint_line["line-translate-anchor"]),"line-width":new yt(ke.paint_line["line-width"]),"line-gap-width":new yt(ke.paint_line["line-gap-width"]),"line-offset":new yt(ke.paint_line["line-offset"]),"line-blur":new yt(ke.paint_line["line-blur"]),"line-dasharray":new Mu(ke.paint_line["line-dasharray"]),"line-pattern":new Iu(ke.paint_line["line-pattern"]),"line-gradient":new Lh(ke.paint_line["line-gradient"])})},get layout(){return _b=_b||new _({"line-cap":new ot(ke.layout_line["line-cap"]),"line-join":new yt(ke.layout_line["line-join"]),"line-miter-limit":new ot(ke.layout_line["line-miter-limit"]),"line-round-limit":new ot(ke.layout_line["line-round-limit"]),"line-sort-key":new yt(ke.layout_line["line-sort-key"])})}};class xM extends yt{possiblyEvaluate(r,o){return o=new un(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(r,o)}evaluate(r,o,c,g){return o=Se({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(r,o,c,g)}}let vp;class bM extends l{constructor(r){super(r,xb),this.gradientVersion=0,vp||(vp=new xM(xb.paint.properties["line-width"].specification),vp.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(c){return c._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof Ho,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,o){super.recalculate(r,o),this.paint._values["line-floorwidth"]=vp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Yy(r)}queryRadius(r){const o=r,c=bb(Oh("line-width",this,o),Oh("line-gap-width",this,o)),g=Oh("line-offset",this,o);return c/2+Math.abs(g)+fp(this.paint.get("line-translate"))}queryIntersectsFeature(r,o,c,g,v,x,b){const S=pp(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,b),P=b/2*bb(this.paint.get("line-width").evaluate(o,c),this.paint.get("line-gap-width").evaluate(o,c)),I=this.paint.get("line-offset").evaluate(o,c);return I&&(g=function(R,B){const N=[];for(let $=0;$<R.length;$++){const q=R[$],ee=[];for(let se=0;se<q.length;se++){const we=q[se-1],de=q[se],xe=q[se+1],Pe=se===0?new z(0,0):de.sub(we)._unit()._perp(),Le=se===q.length-1?new z(0,0):xe.sub(de)._unit()._perp(),et=Pe._add(Le)._unit(),mt=et.x*Le.x+et.y*Le.y;mt!==0&&et._mult(1/mt),ee.push(et._mult(B)._add(de))}N.push(ee)}return N}(g,I*b)),function(R,B,N){for(let $=0;$<B.length;$++){const q=B[$];if(R.length>=3){for(let ee=0;ee<q.length;ee++)if(Bu(R,q[ee]))return!0}if(MI(R,q,N))return!0}return!1}(S,g,P)}isTileClipped(){return!0}}function bb(s,r){return r>0?r+2*s:s}const wM=w([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),SM=w([{name:"a_projected_pos",components:3,type:"Float32"}],4);w([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const TM=w([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);w([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const wb=w([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),CM=w([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function kM(s,r,o){return s.sections.forEach(c=>{c.text=function(g,v,x){const b=v.layout.get("text-transform").evaluate(x,{});return b==="uppercase"?g=g.toLocaleUpperCase():b==="lowercase"&&(g=g.toLocaleLowerCase()),Kr.applyArabicShaping&&(g=Kr.applyArabicShaping(g)),g}(c.text,r,o)}),s}w([{name:"triangle",components:3,type:"Uint16"}]),w([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),w([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),w([{type:"Float32",name:"offsetX"}]),w([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),w([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Zh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var jn=24,Sb=Kt,Tb=function(s,r,o,c,g){var v,x,b=8*g-c-1,S=(1<<b)-1,P=S>>1,I=-7,R=g-1,B=-1,N=s[r+R];for(R+=B,v=N&(1<<-I)-1,N>>=-I,I+=b;I>0;v=256*v+s[r+R],R+=B,I-=8);for(x=v&(1<<-I)-1,v>>=-I,I+=c;I>0;x=256*x+s[r+R],R+=B,I-=8);if(v===0)v=1-P;else{if(v===S)return x?NaN:1/0*(N?-1:1);x+=Math.pow(2,c),v-=P}return(N?-1:1)*x*Math.pow(2,v-c)},Cb=function(s,r,o,c,g,v){var x,b,S,P=8*v-g-1,I=(1<<P)-1,R=I>>1,B=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=0,$=1,q=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(b=isNaN(r)?1:0,x=I):(x=Math.floor(Math.log(r)/Math.LN2),r*(S=Math.pow(2,-x))<1&&(x--,S*=2),(r+=x+R>=1?B/S:B*Math.pow(2,1-R))*S>=2&&(x++,S/=2),x+R>=I?(b=0,x=I):x+R>=1?(b=(r*S-1)*Math.pow(2,g),x+=R):(b=r*Math.pow(2,R-1)*Math.pow(2,g),x=0));g>=8;s[o+N]=255&b,N+=$,b/=256,g-=8);for(x=x<<g|b,P+=g;P>0;s[o+N]=255&x,N+=$,x/=256,P-=8);s[o+N-$]|=128*q};function Kt(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}Kt.Varint=0,Kt.Fixed64=1,Kt.Bytes=2,Kt.Fixed32=5;var Jy=4294967296,kb=1/Jy,Pb=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function So(s){return s.type===Kt.Bytes?s.readVarint()+s.pos:s.pos+1}function ju(s,r,o){return o?4294967296*r+(s>>>0):4294967296*(r>>>0)+(s>>>0)}function Eb(s,r,o){var c=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));o.realloc(c);for(var g=o.pos-1;g>=s;g--)o.buf[g+c]=o.buf[g]}function PM(s,r){for(var o=0;o<s.length;o++)r.writeVarint(s[o])}function EM(s,r){for(var o=0;o<s.length;o++)r.writeSVarint(s[o])}function IM(s,r){for(var o=0;o<s.length;o++)r.writeFloat(s[o])}function MM(s,r){for(var o=0;o<s.length;o++)r.writeDouble(s[o])}function AM(s,r){for(var o=0;o<s.length;o++)r.writeBoolean(s[o])}function zM(s,r){for(var o=0;o<s.length;o++)r.writeFixed32(s[o])}function DM(s,r){for(var o=0;o<s.length;o++)r.writeSFixed32(s[o])}function RM(s,r){for(var o=0;o<s.length;o++)r.writeFixed64(s[o])}function LM(s,r){for(var o=0;o<s.length;o++)r.writeSFixed64(s[o])}function xp(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+16777216*s[r+3]}function $u(s,r,o){s[o]=r,s[o+1]=r>>>8,s[o+2]=r>>>16,s[o+3]=r>>>24}function Ib(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+(s[r+3]<<24)}Kt.prototype={destroy:function(){this.buf=null},readFields:function(s,r,o){for(o=o||this.length;this.pos<o;){var c=this.readVarint(),g=c>>3,v=this.pos;this.type=7&c,s(g,r,this),this.pos===v&&this.skip(c)}return r},readMessage:function(s,r){return this.readFields(s,r,this.readVarint()+this.pos)},readFixed32:function(){var s=xp(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=Ib(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=xp(this.buf,this.pos)+xp(this.buf,this.pos+4)*Jy;return this.pos+=8,s},readSFixed64:function(){var s=xp(this.buf,this.pos)+Ib(this.buf,this.pos+4)*Jy;return this.pos+=8,s},readFloat:function(){var s=Tb(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=Tb(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var r,o,c=this.buf;return r=127&(o=c[this.pos++]),o<128?r:(r|=(127&(o=c[this.pos++]))<<7,o<128?r:(r|=(127&(o=c[this.pos++]))<<14,o<128?r:(r|=(127&(o=c[this.pos++]))<<21,o<128?r:function(g,v,x){var b,S,P=x.buf;if(b=(112&(S=P[x.pos++]))>>4,S<128||(b|=(127&(S=P[x.pos++]))<<3,S<128)||(b|=(127&(S=P[x.pos++]))<<10,S<128)||(b|=(127&(S=P[x.pos++]))<<17,S<128)||(b|=(127&(S=P[x.pos++]))<<24,S<128)||(b|=(1&(S=P[x.pos++]))<<31,S<128))return ju(g,b,v);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(o=c[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,r=this.pos;return this.pos=s,s-r>=12&&Pb?function(o,c,g){return Pb.decode(o.subarray(c,g))}(this.buf,r,s):function(o,c,g){for(var v="",x=c;x<g;){var b,S,P,I=o[x],R=null,B=I>239?4:I>223?3:I>191?2:1;if(x+B>g)break;B===1?I<128&&(R=I):B===2?(192&(b=o[x+1]))==128&&(R=(31&I)<<6|63&b)<=127&&(R=null):B===3?(S=o[x+2],(192&(b=o[x+1]))==128&&(192&S)==128&&((R=(15&I)<<12|(63&b)<<6|63&S)<=2047||R>=55296&&R<=57343)&&(R=null)):B===4&&(S=o[x+2],P=o[x+3],(192&(b=o[x+1]))==128&&(192&S)==128&&(192&P)==128&&((R=(15&I)<<18|(63&b)<<12|(63&S)<<6|63&P)<=65535||R>=1114112)&&(R=null)),R===null?(R=65533,B=1):R>65535&&(R-=65536,v+=String.fromCharCode(R>>>10&1023|55296),R=56320|1023&R),v+=String.fromCharCode(R),x+=B}return v}(this.buf,r,s)},readBytes:function(){var s=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,s);return this.pos=s,r},readPackedVarint:function(s,r){if(this.type!==Kt.Bytes)return s.push(this.readVarint(r));var o=So(this);for(s=s||[];this.pos<o;)s.push(this.readVarint(r));return s},readPackedSVarint:function(s){if(this.type!==Kt.Bytes)return s.push(this.readSVarint());var r=So(this);for(s=s||[];this.pos<r;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==Kt.Bytes)return s.push(this.readBoolean());var r=So(this);for(s=s||[];this.pos<r;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==Kt.Bytes)return s.push(this.readFloat());var r=So(this);for(s=s||[];this.pos<r;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==Kt.Bytes)return s.push(this.readDouble());var r=So(this);for(s=s||[];this.pos<r;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==Kt.Bytes)return s.push(this.readFixed32());var r=So(this);for(s=s||[];this.pos<r;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==Kt.Bytes)return s.push(this.readSFixed32());var r=So(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==Kt.Bytes)return s.push(this.readFixed64());var r=So(this);for(s=s||[];this.pos<r;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==Kt.Bytes)return s.push(this.readSFixed64());var r=So(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed64());return s},skip:function(s){var r=7&s;if(r===Kt.Varint)for(;this.buf[this.pos++]>127;);else if(r===Kt.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Kt.Fixed32)this.pos+=4;else{if(r!==Kt.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(s,r){this.writeVarint(s<<3|r)},realloc:function(s){for(var r=this.length||16;r<this.pos+s;)r*=2;if(r!==this.length){var o=new Uint8Array(r);o.set(this.buf),this.buf=o,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),$u(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),$u(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),$u(this.buf,-1&s,this.pos),$u(this.buf,Math.floor(s*kb),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),$u(this.buf,-1&s,this.pos),$u(this.buf,Math.floor(s*kb),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(r,o){var c,g;if(r>=0?(c=r%4294967296|0,g=r/4294967296|0):(g=~(-r/4294967296),4294967295^(c=~(-r%4294967296))?c=c+1|0:(c=0,g=g+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(v,x,b){b.buf[b.pos++]=127&v|128,v>>>=7,b.buf[b.pos++]=127&v|128,v>>>=7,b.buf[b.pos++]=127&v|128,v>>>=7,b.buf[b.pos++]=127&v|128,b.buf[b.pos]=127&(v>>>=7)}(c,0,o),function(v,x){var b=(7&v)<<4;x.buf[x.pos++]|=b|((v>>>=3)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v)))))}(g,o)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var r=this.pos;this.pos=function(c,g,v){for(var x,b,S=0;S<g.length;S++){if((x=g.charCodeAt(S))>55295&&x<57344){if(!b){x>56319||S+1===g.length?(c[v++]=239,c[v++]=191,c[v++]=189):b=x;continue}if(x<56320){c[v++]=239,c[v++]=191,c[v++]=189,b=x;continue}x=b-55296<<10|x-56320|65536,b=null}else b&&(c[v++]=239,c[v++]=191,c[v++]=189,b=null);x<128?c[v++]=x:(x<2048?c[v++]=x>>6|192:(x<65536?c[v++]=x>>12|224:(c[v++]=x>>18|240,c[v++]=x>>12&63|128),c[v++]=x>>6&63|128),c[v++]=63&x|128)}return v}(this.buf,s,this.pos);var o=this.pos-r;o>=128&&Eb(r,o,this),this.pos=r-1,this.writeVarint(o),this.pos+=o},writeFloat:function(s){this.realloc(4),Cb(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),Cb(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var r=s.length;this.writeVarint(r),this.realloc(r);for(var o=0;o<r;o++)this.buf[this.pos++]=s[o]},writeRawMessage:function(s,r){this.pos++;var o=this.pos;s(r,this);var c=this.pos-o;c>=128&&Eb(o,c,this),this.pos=o-1,this.writeVarint(c),this.pos+=c},writeMessage:function(s,r,o){this.writeTag(s,Kt.Bytes),this.writeRawMessage(r,o)},writePackedVarint:function(s,r){r.length&&this.writeMessage(s,PM,r)},writePackedSVarint:function(s,r){r.length&&this.writeMessage(s,EM,r)},writePackedBoolean:function(s,r){r.length&&this.writeMessage(s,AM,r)},writePackedFloat:function(s,r){r.length&&this.writeMessage(s,IM,r)},writePackedDouble:function(s,r){r.length&&this.writeMessage(s,MM,r)},writePackedFixed32:function(s,r){r.length&&this.writeMessage(s,zM,r)},writePackedSFixed32:function(s,r){r.length&&this.writeMessage(s,DM,r)},writePackedFixed64:function(s,r){r.length&&this.writeMessage(s,RM,r)},writePackedSFixed64:function(s,r){r.length&&this.writeMessage(s,LM,r)},writeBytesField:function(s,r){this.writeTag(s,Kt.Bytes),this.writeBytes(r)},writeFixed32Field:function(s,r){this.writeTag(s,Kt.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(s,r){this.writeTag(s,Kt.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(s,r){this.writeTag(s,Kt.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(s,r){this.writeTag(s,Kt.Fixed64),this.writeSFixed64(r)},writeVarintField:function(s,r){this.writeTag(s,Kt.Varint),this.writeVarint(r)},writeSVarintField:function(s,r){this.writeTag(s,Kt.Varint),this.writeSVarint(r)},writeStringField:function(s,r){this.writeTag(s,Kt.Bytes),this.writeString(r)},writeFloatField:function(s,r){this.writeTag(s,Kt.Fixed32),this.writeFloat(r)},writeDoubleField:function(s,r){this.writeTag(s,Kt.Fixed64),this.writeDouble(r)},writeBooleanField:function(s,r){this.writeVarintField(s,!!r)}};var Qy=C(Sb);const e_=3;function FM(s,r,o){s===1&&o.readMessage(BM,r)}function BM(s,r,o){if(s===3){const{id:c,bitmap:g,width:v,height:x,left:b,top:S,advance:P}=o.readMessage(OM,{});r.push({id:c,bitmap:new Nh({width:v+2*e_,height:x+2*e_},g),metrics:{width:v,height:x,left:b,top:S,advance:P}})}}function OM(s,r,o){s===1?r.id=o.readVarint():s===2?r.bitmap=o.readBytes():s===3?r.width=o.readVarint():s===4?r.height=o.readVarint():s===5?r.left=o.readSVarint():s===6?r.top=o.readSVarint():s===7&&(r.advance=o.readVarint())}const Mb=e_;function Ab(s){let r=0,o=0;for(const x of s)r+=x.w*x.h,o=Math.max(o,x.w);s.sort((x,b)=>b.h-x.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),o),h:1/0}];let g=0,v=0;for(const x of s)for(let b=c.length-1;b>=0;b--){const S=c[b];if(!(x.w>S.w||x.h>S.h)){if(x.x=S.x,x.y=S.y,v=Math.max(v,x.y+x.h),g=Math.max(g,x.x+x.w),x.w===S.w&&x.h===S.h){const P=c.pop();b<c.length&&(c[b]=P)}else x.h===S.h?(S.x+=x.w,S.w-=x.w):x.w===S.w?(S.y+=x.h,S.h-=x.h):(c.push({x:S.x+x.w,y:S.y,w:S.w-x.w,h:x.h}),S.y+=x.h,S.h-=x.h);break}}return{w:g,h:v,fill:r/(g*v)||0}}const Jr=1;class t_{constructor(r,{pixelRatio:o,version:c,stretchX:g,stretchY:v,content:x,textFitWidth:b,textFitHeight:S}){this.paddedRect=r,this.pixelRatio=o,this.stretchX=g,this.stretchY=v,this.content=x,this.version=c,this.textFitWidth=b,this.textFitHeight=S}get tl(){return[this.paddedRect.x+Jr,this.paddedRect.y+Jr]}get br(){return[this.paddedRect.x+this.paddedRect.w-Jr,this.paddedRect.y+this.paddedRect.h-Jr]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Jr)/this.pixelRatio,(this.paddedRect.h-2*Jr)/this.pixelRatio]}}class zb{constructor(r,o){const c={},g={};this.haveRenderCallbacks=[];const v=[];this.addImages(r,c,v),this.addImages(o,g,v);const{w:x,h:b}=Ab(v),S=new Ri({width:x||1,height:b||1});for(const P in r){const I=r[P],R=c[P].paddedRect;Ri.copy(I.data,S,{x:0,y:0},{x:R.x+Jr,y:R.y+Jr},I.data)}for(const P in o){const I=o[P],R=g[P].paddedRect,B=R.x+Jr,N=R.y+Jr,$=I.data.width,q=I.data.height;Ri.copy(I.data,S,{x:0,y:0},{x:B,y:N},I.data),Ri.copy(I.data,S,{x:0,y:q-1},{x:B,y:N-1},{width:$,height:1}),Ri.copy(I.data,S,{x:0,y:0},{x:B,y:N+q},{width:$,height:1}),Ri.copy(I.data,S,{x:$-1,y:0},{x:B-1,y:N},{width:1,height:q}),Ri.copy(I.data,S,{x:0,y:0},{x:B+$,y:N},{width:1,height:q})}this.image=S,this.iconPositions=c,this.patternPositions=g}addImages(r,o,c){for(const g in r){const v=r[g],x={x:0,y:0,w:v.data.width+2*Jr,h:v.data.height+2*Jr};c.push(x),o[g]=new t_(x,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(r,o){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in r.updatedImages)this.patchUpdatedImage(this.iconPositions[c],r.getImage(c),o),this.patchUpdatedImage(this.patternPositions[c],r.getImage(c),o)}patchUpdatedImage(r,o,c){if(!r||!o||r.version===o.version)return;r.version=o.version;const[g,v]=r.tl;c.update(o.data,void 0,{x:g,y:v})}}var va;it("ImagePosition",t_),it("ImageAtlas",zb),m.ah=void 0,(va=m.ah||(m.ah={}))[va.none=0]="none",va[va.horizontal=1]="horizontal",va[va.vertical=2]="vertical",va[va.horizontalOnly=3]="horizontalOnly";const Wh=-17;class Hh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,o){const c=new Hh;return c.scale=r||1,c.fontStack=o,c}static forImage(r){const o=new Hh;return o.imageName=r,o}}class Uu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,o){const c=new Uu;for(let g=0;g<r.sections.length;g++){const v=r.sections[g];v.image?c.addImageSection(v):c.addTextSection(v,o)}return c}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=function(r){let o="";for(let c=0;c<r.length;c++){const g=r.charCodeAt(c+1)||null,v=r.charCodeAt(c-1)||null;o+=g&&op(g)&&!Zh[r[c+1]]||v&&op(v)&&!Zh[r[c-1]]||!Zh[r[c]]?r[c]:Zh[r[c]]}return o}(this.text)}trim(){let r=0;for(let c=0;c<this.text.length&&wp[this.text.charCodeAt(c)];c++)r++;let o=this.text.length;for(let c=this.text.length-1;c>=0&&c>=r&&wp[this.text.charCodeAt(c)];c--)o--;this.text=this.text.substring(r,o),this.sectionIndex=this.sectionIndex.slice(r,o)}substring(r,o){const c=new Uu;return c.text=this.text.substring(r,o),c.sectionIndex=this.sectionIndex.slice(r,o),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,o)=>Math.max(r,this.sections[o].scale),0)}addTextSection(r,o){this.text+=r.text,this.sections.push(Hh.forText(r.scale,r.fontStack||o));const c=this.sections.length-1;for(let g=0;g<r.text.length;++g)this.sectionIndex.push(c)}addImageSection(r){const o=r.image?r.image.name:"";if(o.length===0)return void je("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Hh.forImage(o)),this.sectionIndex.push(this.sections.length-1)):je("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function bp(s,r,o,c,g,v,x,b,S,P,I,R,B,N,$){const q=Uu.fromFeature(s,g);let ee;R===m.ah.vertical&&q.verticalizePunctuation();const{processBidirectionalText:se,processStyledBidirectionalText:we}=Kr;if(se&&q.sections.length===1){ee=[];const Pe=se(q.toString(),n_(q,P,v,r,c,N));for(const Le of Pe){const et=new Uu;et.text=Le,et.sections=q.sections;for(let mt=0;mt<Le.length;mt++)et.sectionIndex.push(0);ee.push(et)}}else if(we){ee=[];const Pe=we(q.text,q.sectionIndex,n_(q,P,v,r,c,N));for(const Le of Pe){const et=new Uu;et.text=Le[0],et.sectionIndex=Le[1],et.sections=q.sections,ee.push(et)}}else ee=function(Pe,Le){const et=[],mt=Pe.text;let Je=0;for(const Ke of Le)et.push(Pe.substring(Je,Ke)),Je=Ke;return Je<mt.length&&et.push(Pe.substring(Je,mt.length)),et}(q,n_(q,P,v,r,c,N));const de=[],xe={positionedLines:de,text:q.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:R,iconsInText:!1,verticalizable:!1};return function(Pe,Le,et,mt,Je,Ke,ut,st,rt,Me,ct,lt){let xt=0,en=Wh,Yt=0,Wn=0;const is=st==="right"?1:st==="left"?0:.5;let hr=0;for(const Sn of Je){Sn.trim();const Xn=Sn.getMaxScale(),br=(Xn-1)*jn,dr={positionedGlyphs:[],lineOffset:0};Pe.positionedLines[hr]=dr;const Fr=dr.positionedGlyphs;let fr=0;if(!Sn.length()){en+=Ke,++hr;continue}for(let Qr=0;Qr<Sn.length();Qr++){const Ut=Sn.getSection(Qr),nn=Sn.getSectionIndex(Qr),fn=Sn.getCharCode(Qr);let mi=0,_n=null,Wu=null,Gs=null,qs=jn;const ss=!(rt===m.ah.horizontal||!ct&&!Dh(fn)||ct&&(wp[fn]||(Hn=fn,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Hn)))));if(Ut.imageName){const Bi=mt[Ut.imageName];if(!Bi)continue;Gs=Ut.imageName,Pe.iconsInText=Pe.iconsInText||!0,Wu=Bi.paddedRect;const tr=Bi.displaySize;Ut.scale=Ut.scale*jn/lt,_n={width:tr[0],height:tr[1],left:Jr,top:-Mb,advance:ss?tr[1]:tr[0]},mi=br+(jn-tr[1]*Ut.scale),qs=_n.advance;const To=ss?tr[0]*Ut.scale-jn*Xn:tr[1]*Ut.scale-jn*Xn;To>0&&To>fr&&(fr=To)}else{const Bi=et[Ut.fontStack],tr=Bi&&Bi[fn];if(tr&&tr.rect)Wu=tr.rect,_n=tr.metrics;else{const To=Le[Ut.fontStack],ed=To&&To[fn];if(!ed)continue;_n=ed.metrics}mi=(Xn-Ut.scale)*jn}ss?(Pe.verticalizable=!0,Fr.push({glyph:fn,imageName:Gs,x:xt,y:en+mi,vertical:ss,scale:Ut.scale,fontStack:Ut.fontStack,sectionIndex:nn,metrics:_n,rect:Wu}),xt+=qs*Ut.scale+Me):(Fr.push({glyph:fn,imageName:Gs,x:xt,y:en+mi,vertical:ss,scale:Ut.scale,fontStack:Ut.fontStack,sectionIndex:nn,metrics:_n,rect:Wu}),xt+=_n.advance*Ut.scale+Me)}Fr.length!==0&&(Yt=Math.max(xt-Me,Yt),$M(Fr,0,Fr.length-1,is,fr)),xt=0;const Fi=Ke*Xn+fr;dr.lineOffset=Math.max(fr,br),en+=Fi,Wn=Math.max(Fi,Wn),++hr}var Hn;const Dr=en-Wh,{horizontalAlign:Rr,verticalAlign:Lr}=r_(ut);(function(Sn,Xn,br,dr,Fr,fr,Fi,Qr,Ut){const nn=(Xn-br)*Fr;let fn=0;fn=fr!==Fi?-Qr*dr-Wh:(-dr*Ut+.5)*Fi;for(const mi of Sn)for(const _n of mi.positionedGlyphs)_n.x+=nn,_n.y+=fn})(Pe.positionedLines,is,Rr,Lr,Yt,Wn,Ke,Dr,Je.length),Pe.top+=-Lr*Dr,Pe.bottom=Pe.top+Dr,Pe.left+=-Rr*Yt,Pe.right=Pe.left+Yt}(xe,r,o,c,ee,x,b,S,R,P,B,$),!function(Pe){for(const Le of Pe)if(Le.positionedGlyphs.length!==0)return!1;return!0}(de)&&xe}const wp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},VM={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},NM={40:!0};function Db(s,r,o,c,g,v){if(r.imageName){const x=c[r.imageName];return x?x.displaySize[0]*r.scale*jn/v+g:0}{const x=o[r.fontStack],b=x&&x[s];return b?b.metrics.advance*r.scale+g:0}}function Rb(s,r,o,c){const g=Math.pow(s-r,2);return c?s<r?g/2:2*g:g+Math.abs(o)*o}function jM(s,r,o){let c=0;return s===10&&(c-=1e4),o&&(c+=150),s!==40&&s!==65288||(c+=50),r!==41&&r!==65289||(c+=50),c}function Lb(s,r,o,c,g,v){let x=null,b=Rb(r,o,g,v);for(const S of c){const P=Rb(r-S.x,o,g,v)+S.badness;P<=b&&(x=S,b=P)}return{index:s,x:r,priorBreak:x,badness:b}}function Fb(s){return s?Fb(s.priorBreak).concat(s.index):[]}function n_(s,r,o,c,g,v){if(!s)return[];const x=[],b=function(R,B,N,$,q,ee){let se=0;for(let we=0;we<R.length();we++){const de=R.getSection(we);se+=Db(R.getCharCode(we),de,$,q,B,ee)}return se/Math.max(1,Math.ceil(se/N))}(s,r,o,c,g,v),S=s.text.indexOf("")>=0;let P=0;for(let R=0;R<s.length();R++){const B=s.getSection(R),N=s.getCharCode(R);if(wp[N]||(P+=Db(N,B,c,g,r,v)),R<s.length()-1){const $=!((I=N)<11904)&&(!!Lt["CJK Compatibility Forms"](I)||!!Lt["CJK Compatibility"](I)||!!Lt["CJK Strokes"](I)||!!Lt["CJK Symbols and Punctuation"](I)||!!Lt["Enclosed CJK Letters and Months"](I)||!!Lt["Halfwidth and Fullwidth Forms"](I)||!!Lt["Ideographic Description Characters"](I)||!!Lt["Vertical Forms"](I)||sp.test(String.fromCodePoint(I)));(VM[N]||$||B.imageName||R!==s.length()-2&&NM[s.getCharCode(R+1)])&&x.push(Lb(R+1,P,b,x,jM(N,s.getCharCode(R+1),$&&S),!1))}}var I;return Fb(Lb(s.length(),P,b,x,0,!0))}function r_(s){let r=.5,o=.5;switch(s){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:r,verticalAlign:o}}function $M(s,r,o,c,g){if(!c&&!g)return;const v=s[o],x=(s[o].x+v.metrics.advance*v.scale)*c;for(let b=r;b<=o;b++)s[b].x-=x,s[b].y+=g}function UM(s,r,o){const{horizontalAlign:c,verticalAlign:g}=r_(o),v=r[0]-s.displaySize[0]*c,x=r[1]-s.displaySize[1]*g;return{image:s,top:x,bottom:x+s.displaySize[1],left:v,right:v+s.displaySize[0]}}function Bb(s){var r,o;let c=s.left,g=s.top,v=s.right-c,x=s.bottom-g;const b=(r=s.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",S=(o=s.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",P=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(S==="proportional"){if(b==="stretchOnly"&&v/x<P||b==="proportional"){const I=Math.ceil(x*P);c*=I/v,v=I}}else if(b==="proportional"&&S==="stretchOnly"&&P!==0&&v/x>P){const I=Math.ceil(v/P);g*=I/x,x=I}return{x1:c,y1:g,x2:c+v,y2:g+x}}function Ob(s,r,o,c,g,v){const x=s.image;let b;if(x.content){const ee=x.content,se=x.pixelRatio||1;b=[ee[0]/se,ee[1]/se,x.displaySize[0]-ee[2]/se,x.displaySize[1]-ee[3]/se]}const S=r.left*v,P=r.right*v;let I,R,B,N;o==="width"||o==="both"?(N=g[0]+S-c[3],R=g[0]+P+c[1]):(N=g[0]+(S+P-x.displaySize[0])/2,R=N+x.displaySize[0]);const $=r.top*v,q=r.bottom*v;return o==="height"||o==="both"?(I=g[1]+$-c[0],B=g[1]+q+c[2]):(I=g[1]+($+q-x.displaySize[1])/2,B=I+x.displaySize[1]),{image:x,top:I,right:R,bottom:B,left:N,collisionPadding:b}}const Xh=255,Us=128,xa=Xh*Us;function Vb(s,r){const{expression:o}=r;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new un(s+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:g}=o;let v=0;for(;v<c.length&&c[v]<=s;)v++;v=Math.max(0,v-1);let x=v;for(;x<c.length&&c[x]<s+1;)x++;x=Math.min(c.length-1,x);const b=c[v],S=c[x];return o.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:S,interpolationType:g}:{kind:"camera",minZoom:b,maxZoom:S,minSize:o.evaluate(new un(b)),maxSize:o.evaluate(new un(S)),interpolationType:g}}}function i_(s,r,o){let c="never";const g=s.get(r);return g?c=g:s.get(o)&&(c="always"),c}const GM=_a.VectorTileFeature.types,qM=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Sp(s,r,o,c,g,v,x,b,S,P,I,R,B){const N=b?Math.min(xa,Math.round(b[0])):0,$=b?Math.min(xa,Math.round(b[1])):0;s.emplaceBack(r,o,Math.round(32*c),Math.round(32*g),v,x,(N<<1)+(S?1:0),$,16*P,16*I,256*R,256*B)}function s_(s,r,o){s.emplaceBack(r.x,r.y,o),s.emplaceBack(r.x,r.y,o),s.emplaceBack(r.x,r.y,o),s.emplaceBack(r.x,r.y,o)}function ZM(s){for(const r of s.sections)if(Dy(r.text))return!0;return!1}class o_{constructor(r){this.layoutVertexArray=new zu,this.indexArray=new Di,this.programConfigurations=r,this.segments=new Ft,this.dynamicLayoutVertexArray=new Fh,this.opacityVertexArray=new fi,this.hasVisibleVertices=!1,this.placedSymbolArray=new cn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,o,c,g){this.isEmpty()||(c&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,wM.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,SM.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,qM,!0),this.opacityVertexBuffer.itemSize=1),(c||g)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}it("SymbolBuffers",o_);class a_{constructor(r,o,c){this.layoutVertexArray=new r,this.layoutAttributes=o,this.indexArray=new c,this.segments=new Ft,this.collisionVertexArray=new js}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,TM.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}it("CollisionBuffers",a_);class Gu{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(x=>x.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ny([]),this.placementViewportMatrix=Ny([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Vb(this.zoom,o["text-size"]),this.iconSizeData=Vb(this.zoom,o["icon-size"]);const c=this.layers[0].layout,g=c.get("symbol-sort-key"),v=c.get("symbol-z-order");this.canOverlap=i_(c,"text-overlap","text-allow-overlap")!=="never"||i_(c,"icon-overlap","icon-allow-overlap")!=="never"||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,c.get("symbol-placement")==="point"&&(this.writingModes=c.get("text-writing-mode").map(x=>m.ah[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=r.sourceID}createArrays(){this.text=new o_(new vl(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new o_(new vl(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new hn,this.lineVertexArray=new ar,this.symbolInstances=new Rt,this.textAnchorOffsets=new dn}calculateGlyphDependencies(r,o,c,g,v){for(let x=0;x<r.length;x++)if(o[r.charCodeAt(x)]=!0,(c||g)&&v){const b=Zh[r.charAt(x)];b&&(o[b.charCodeAt(0)]=!0)}}populate(r,o,c){const g=this.layers[0],v=g.layout,x=v.get("text-font"),b=v.get("text-field"),S=v.get("icon-image"),P=(b.value.kind!=="constant"||b.value.value instanceof Zr&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),I=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,R=v.get("symbol-sort-key");if(this.features=[],!P&&!I)return;const B=o.iconDependencies,N=o.glyphDependencies,$=o.availableImages,q=new un(this.zoom);for(const{feature:ee,id:se,index:we,sourceLayerIndex:de}of r){const xe=g._featureFilter.needGeometry,Pe=bl(ee,xe);if(!g._featureFilter.filter(q,Pe,c))continue;let Le,et;if(xe||(Pe.geometry=xl(ee)),P){const Je=g.getValueAndResolveTokens("text-field",Pe,c,$),Ke=Zr.factory(Je),ut=this.hasRTLText=this.hasRTLText||ZM(Ke);(!ut||Kr.getRTLTextPluginStatus()==="unavailable"||ut&&Kr.isParsed())&&(Le=kM(Ke,g,Pe))}if(I){const Je=g.getValueAndResolveTokens("icon-image",Pe,c,$);et=Je instanceof Hr?Je:Hr.fromString(Je)}if(!Le&&!et)continue;const mt=this.sortFeaturesByKey?R.evaluate(Pe,{},c):void 0;if(this.features.push({id:se,text:Le,icon:et,index:we,sourceLayerIndex:de,geometry:Pe.geometry,properties:ee.properties,type:GM[ee.type],sortKey:mt}),et&&(B[et.name]=!0),Le){const Je=x.evaluate(Pe,{},c).join(","),Ke=v.get("text-rotation-alignment")!=="viewport"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(m.ah.vertical)>=0;for(const ut of Le.sections)if(ut.image)B[ut.image.name]=!0;else{const st=Ah(Le.toString()),rt=ut.fontStack||Je,Me=N[rt]=N[rt]||{};this.calculateGlyphDependencies(ut.text,Me,Ke,this.allowVerticalPlacement,st)}}}v.get("symbol-placement")==="line"&&(this.features=function(ee){const se={},we={},de=[];let xe=0;function Pe(Je){de.push(ee[Je]),xe++}function Le(Je,Ke,ut){const st=we[Je];return delete we[Je],we[Ke]=st,de[st].geometry[0].pop(),de[st].geometry[0]=de[st].geometry[0].concat(ut[0]),st}function et(Je,Ke,ut){const st=se[Ke];return delete se[Ke],se[Je]=st,de[st].geometry[0].shift(),de[st].geometry[0]=ut[0].concat(de[st].geometry[0]),st}function mt(Je,Ke,ut){const st=ut?Ke[0][Ke[0].length-1]:Ke[0][0];return`${Je}:${st.x}:${st.y}`}for(let Je=0;Je<ee.length;Je++){const Ke=ee[Je],ut=Ke.geometry,st=Ke.text?Ke.text.toString():null;if(!st){Pe(Je);continue}const rt=mt(st,ut),Me=mt(st,ut,!0);if(rt in we&&Me in se&&we[rt]!==se[Me]){const ct=et(rt,Me,ut),lt=Le(rt,Me,de[ct].geometry);delete se[rt],delete we[Me],we[mt(st,de[lt].geometry,!0)]=lt,de[ct].geometry=null}else rt in we?Le(rt,Me,ut):Me in se?et(rt,Me,ut):(Pe(Je),se[rt]=xe-1,we[Me]=xe-1)}return de.filter(Je=>Je.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ee,se)=>ee.sortKey-se.sortKey)}update(r,o,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,o,this.layers,c),this.icon.programConfigurations.updatePaintArrays(r,o,this.layers,c))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,o){const c=this.lineVertexArray.length;if(r.segment!==void 0){let g=r.dist(o[r.segment+1]),v=r.dist(o[r.segment]);const x={};for(let b=r.segment+1;b<o.length;b++)x[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:g},b<o.length-1&&(g+=o[b+1].dist(o[b]));for(let b=r.segment||0;b>=0;b--)x[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:v},b>0&&(v+=o[b-1].dist(o[b]));for(let b=0;b<o.length;b++){const S=x[b];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(r,o,c,g,v,x,b,S,P,I,R,B){const N=r.indexArray,$=r.layoutVertexArray,q=r.segments.prepareSegment(4*o.length,$,N,this.canOverlap?x.sortKey:void 0),ee=this.glyphOffsetArray.length,se=q.vertexLength,we=this.allowVerticalPlacement&&b===m.ah.vertical?Math.PI/2:0,de=x.text&&x.text.sections;for(let xe=0;xe<o.length;xe++){const{tl:Pe,tr:Le,bl:et,br:mt,tex:Je,pixelOffsetTL:Ke,pixelOffsetBR:ut,minFontScaleX:st,minFontScaleY:rt,glyphOffset:Me,isSDF:ct,sectionIndex:lt}=o[xe],xt=q.vertexLength,en=Me[1];Sp($,S.x,S.y,Pe.x,en+Pe.y,Je.x,Je.y,c,ct,Ke.x,Ke.y,st,rt),Sp($,S.x,S.y,Le.x,en+Le.y,Je.x+Je.w,Je.y,c,ct,ut.x,Ke.y,st,rt),Sp($,S.x,S.y,et.x,en+et.y,Je.x,Je.y+Je.h,c,ct,Ke.x,ut.y,st,rt),Sp($,S.x,S.y,mt.x,en+mt.y,Je.x+Je.w,Je.y+Je.h,c,ct,ut.x,ut.y,st,rt),s_(r.dynamicLayoutVertexArray,S,we),N.emplaceBack(xt,xt+1,xt+2),N.emplaceBack(xt+1,xt+2,xt+3),q.vertexLength+=4,q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Me[0]),xe!==o.length-1&&lt===o[xe+1].sectionIndex||r.programConfigurations.populatePaintArrays($.length,x,x.index,{},B,de&&de[lt])}r.placedSymbolArray.emplaceBack(S.x,S.y,ee,this.glyphOffsetArray.length-ee,se,P,I,S.segment,c?c[0]:0,c?c[1]:0,g[0],g[1],b,0,!1,0,R)}_addCollisionDebugVertex(r,o,c,g,v,x){return o.emplaceBack(0,0),r.emplaceBack(c.x,c.y,g,v,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(r,o,c,g,v,x,b){const S=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),P=S.vertexLength,I=v.layoutVertexArray,R=v.collisionVertexArray,B=b.anchorX,N=b.anchorY;this._addCollisionDebugVertex(I,R,x,B,N,new z(r,o)),this._addCollisionDebugVertex(I,R,x,B,N,new z(c,o)),this._addCollisionDebugVertex(I,R,x,B,N,new z(c,g)),this._addCollisionDebugVertex(I,R,x,B,N,new z(r,g)),S.vertexLength+=4;const $=v.indexArray;$.emplaceBack(P,P+1),$.emplaceBack(P+1,P+2),$.emplaceBack(P+2,P+3),$.emplaceBack(P+3,P),S.primitiveLength+=4}addDebugCollisionBoxes(r,o,c,g){for(let v=r;v<o;v++){const x=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,g?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,c)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new a_(pi,wb.members,er),this.iconCollisionBox=new a_(pi,wb.members,er);for(let r=0;r<this.symbolInstances.length;r++){const o=this.symbolInstances.get(r);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(r,o,c,g,v,x,b,S,P){const I={};for(let R=o;R<c;R++){const B=r.get(R);I.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},I.textFeatureIndex=B.featureIndex;break}for(let R=g;R<v;R++){const B=r.get(R);I.verticalTextBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},I.verticalTextFeatureIndex=B.featureIndex;break}for(let R=x;R<b;R++){const B=r.get(R);I.iconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},I.iconFeatureIndex=B.featureIndex;break}for(let R=S;R<P;R++){const B=r.get(R);I.verticalIconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},I.verticalIconFeatureIndex=B.featureIndex;break}return I}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const c=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,o){const c=r.placedSymbolArray.get(o),g=c.vertexStartIndex+4*c.numGlyphs;for(let v=c.vertexStartIndex;v<g;v+=4)r.indexArray.emplaceBack(v,v+1,v+2),r.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(r),c=Math.cos(r),g=[],v=[],x=[];for(let b=0;b<this.symbolInstances.length;++b){x.push(b);const S=this.symbolInstances.get(b);g.push(0|Math.round(o*S.anchorX+c*S.anchorY)),v.push(S.featureIndex)}return x.sort((b,S)=>g[b]-g[S]||v[S]-v[b]),x}addToSortKeyRanges(r,o){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===o?c.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const c=this.symbolInstances.get(o);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach((g,v,x)=>{g>=0&&x.indexOf(g)===v&&this.addIndicesForPlacedSymbol(this.text,g)}),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Nb,jb;it("SymbolBucket",Gu,{omit:["layers","collisionBoxArray","features","compareText"]}),Gu.MAX_GLYPHS=65535,Gu.addDynamicAttributes=s_;var l_={get paint(){return jb=jb||new _({"icon-opacity":new yt(ke.paint_symbol["icon-opacity"]),"icon-color":new yt(ke.paint_symbol["icon-color"]),"icon-halo-color":new yt(ke.paint_symbol["icon-halo-color"]),"icon-halo-width":new yt(ke.paint_symbol["icon-halo-width"]),"icon-halo-blur":new yt(ke.paint_symbol["icon-halo-blur"]),"icon-translate":new ot(ke.paint_symbol["icon-translate"]),"icon-translate-anchor":new ot(ke.paint_symbol["icon-translate-anchor"]),"text-opacity":new yt(ke.paint_symbol["text-opacity"]),"text-color":new yt(ke.paint_symbol["text-color"],{runtimeType:Er,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new yt(ke.paint_symbol["text-halo-color"]),"text-halo-width":new yt(ke.paint_symbol["text-halo-width"]),"text-halo-blur":new yt(ke.paint_symbol["text-halo-blur"]),"text-translate":new ot(ke.paint_symbol["text-translate"]),"text-translate-anchor":new ot(ke.paint_symbol["text-translate-anchor"])})},get layout(){return Nb=Nb||new _({"symbol-placement":new ot(ke.layout_symbol["symbol-placement"]),"symbol-spacing":new ot(ke.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ot(ke.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new yt(ke.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ot(ke.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ot(ke.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ot(ke.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ot(ke.layout_symbol["icon-ignore-placement"]),"icon-optional":new ot(ke.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ot(ke.layout_symbol["icon-rotation-alignment"]),"icon-size":new yt(ke.layout_symbol["icon-size"]),"icon-text-fit":new ot(ke.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ot(ke.layout_symbol["icon-text-fit-padding"]),"icon-image":new yt(ke.layout_symbol["icon-image"]),"icon-rotate":new yt(ke.layout_symbol["icon-rotate"]),"icon-padding":new yt(ke.layout_symbol["icon-padding"]),"icon-keep-upright":new ot(ke.layout_symbol["icon-keep-upright"]),"icon-offset":new yt(ke.layout_symbol["icon-offset"]),"icon-anchor":new yt(ke.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ot(ke.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ot(ke.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ot(ke.layout_symbol["text-rotation-alignment"]),"text-field":new yt(ke.layout_symbol["text-field"]),"text-font":new yt(ke.layout_symbol["text-font"]),"text-size":new yt(ke.layout_symbol["text-size"]),"text-max-width":new yt(ke.layout_symbol["text-max-width"]),"text-line-height":new ot(ke.layout_symbol["text-line-height"]),"text-letter-spacing":new yt(ke.layout_symbol["text-letter-spacing"]),"text-justify":new yt(ke.layout_symbol["text-justify"]),"text-radial-offset":new yt(ke.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ot(ke.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new yt(ke.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new yt(ke.layout_symbol["text-anchor"]),"text-max-angle":new ot(ke.layout_symbol["text-max-angle"]),"text-writing-mode":new ot(ke.layout_symbol["text-writing-mode"]),"text-rotate":new yt(ke.layout_symbol["text-rotate"]),"text-padding":new ot(ke.layout_symbol["text-padding"]),"text-keep-upright":new ot(ke.layout_symbol["text-keep-upright"]),"text-transform":new yt(ke.layout_symbol["text-transform"]),"text-offset":new yt(ke.layout_symbol["text-offset"]),"text-allow-overlap":new ot(ke.layout_symbol["text-allow-overlap"]),"text-overlap":new ot(ke.layout_symbol["text-overlap"]),"text-ignore-placement":new ot(ke.layout_symbol["text-ignore-placement"]),"text-optional":new ot(ke.layout_symbol["text-optional"])})}};class $b{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:Bs,this.defaultValue=r}evaluate(r){if(r.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(r.formattedSection))return o.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}it("FormatSectionOverride",$b,{omit:["defaultValue"]});class Tp extends l{constructor(r){super(r,l_)}recalculate(r,o){if(super.recalculate(r,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const c=this.layout.get("text-writing-mode");if(c){const g=[];for(const v of c)g.indexOf(v)<0&&g.push(v);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,o,c,g){const v=this.layout.get(r).evaluate(o,{},c,g),x=this._unevaluatedLayout._values[r];return x.isDataDriven()||yu(x.value)||!v?v:function(b,S){return S.replace(/{([^{}]+)}/g,(P,I)=>b&&I in b?String(b[I]):"")}(o.properties,v)}createBucket(r){return new Gu(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of l_.paint.overridableProperties){if(!Tp.hasPaintOverride(this.layout,r))continue;const o=this.paint.get(r),c=new $b(o),g=new gu(c,o.property.specification);let v=null;v=o.value.kind==="constant"||o.value.kind==="source"?new ra("source",g):new ia("composite",g,o.value.zoomStops),this.paint._values[r]=new ns(o.property,v,o.parameters)}}_handleOverridablePaintPropertyUpdate(r,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven())&&Tp.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,o){const c=r.get("text-field"),g=l_.paint.properties[o];let v=!1;const x=b=>{for(const S of b)if(g.overrides&&g.overrides.hasOverride(S))return void(v=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Zr)x(c.value.value.sections);else if(c.value.kind==="source"){const b=P=>{v||(P instanceof Pi&&Ln(P.value)===ws?x(P.value.sections):P instanceof au?x(P.sections):P.eachChild(b))},S=c.value;S._styleExpression&&b(S._styleExpression.expression)}return v}}let Ub;var WM={get paint(){return Ub=Ub||new _({"background-color":new ot(ke.paint_background["background-color"]),"background-pattern":new Mu(ke.paint_background["background-pattern"]),"background-opacity":new ot(ke.paint_background["background-opacity"])})}};class HM extends l{constructor(r){super(r,WM)}}let Gb;var XM={get paint(){return Gb=Gb||new _({"raster-opacity":new ot(ke.paint_raster["raster-opacity"]),"raster-hue-rotate":new ot(ke.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ot(ke.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ot(ke.paint_raster["raster-brightness-max"]),"raster-saturation":new ot(ke.paint_raster["raster-saturation"]),"raster-contrast":new ot(ke.paint_raster["raster-contrast"]),"raster-resampling":new ot(ke.paint_raster["raster-resampling"]),"raster-fade-duration":new ot(ke.paint_raster["raster-fade-duration"])})}};class KM extends l{constructor(r){super(r,XM)}}class YM extends l{constructor(r){super(r,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class JM{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const u_=63710088e-1;class ba{constructor(r,o){if(isNaN(r)||isNaN(o))throw new Error(`Invalid LngLat object: (${r}, ${o})`);if(this.lng=+r,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ba(ye(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const o=Math.PI/180,c=this.lat*o,g=r.lat*o,v=Math.sin(c)*Math.sin(g)+Math.cos(c)*Math.cos(g)*Math.cos((r.lng-this.lng)*o);return u_*Math.acos(Math.min(v,1))}static convert(r){if(r instanceof ba)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new ba(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new ba(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const qb=2*Math.PI*u_;function Zb(s){return qb*Math.cos(s*Math.PI/180)}function Wb(s){return(180+s)/360}function Hb(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function Xb(s,r){return s/Zb(r)}function c_(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}class Kh{constructor(r,o,c=0){this.x=+r,this.y=+o,this.z=+c}static fromLngLat(r,o=0){const c=ba.convert(r);return new Kh(Wb(c.lng),Hb(c.lat),Xb(o,c.lat))}toLngLat(){return new ba(360*this.x-180,c_(this.y))}toAltitude(){return this.z*Zb(c_(this.y))}meterInMercatorCoordinateUnits(){return 1/qb*(r=c_(this.y),1/Math.cos(r*Math.PI/180));var r}}function Kb(s,r,o){var c=2*Math.PI*6378137/256/Math.pow(2,o);return[s*c-2*Math.PI*6378137/2,r*c-2*Math.PI*6378137/2]}class h_{constructor(r,o,c){if(!function(g,v,x){return!(g<0||g>25||x<0||x>=Math.pow(2,g)||v<0||v>=Math.pow(2,g))}(r,o,c))throw new Error(`x=${o}, y=${c}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=o,this.y=c,this.key=Yh(0,r,r,o,c)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,o,c){const g=(x=this.y,b=this.z,S=Kb(256*(v=this.x),256*(x=Math.pow(2,b)-x-1),b),P=Kb(256*(v+1),256*(x+1),b),S[0]+","+S[1]+","+P[0]+","+P[1]);var v,x,b,S,P;const I=function(R,B,N){let $,q="";for(let ee=R;ee>0;ee--)$=1<<ee-1,q+=(B&$?1:0)+(N&$?2:0);return q}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,I).replace(/{bbox-epsg-3857}/g,g)}isChildOf(r){const o=this.z-r.z;return o>0&&r.x===this.x>>o&&r.y===this.y>>o}getTilePoint(r){const o=Math.pow(2,this.z);return new z((r.x*o-this.x)*Fn,(r.y*o-this.y)*Fn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Yb{constructor(r,o){this.wrap=r,this.canonical=o,this.key=Yh(r,o.z,o.z,o.x,o.y)}}class Li{constructor(r,o,c,g,v){if(r<c)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${c}`);this.overscaledZ=r,this.wrap=o,this.canonical=new h_(c,+g,+v),this.key=Yh(o,r,c,g,v)}clone(){return new Li(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-r;return r>this.canonical.z?new Li(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Li(r,this.wrap,r,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(r,o){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-r;return r>this.canonical.z?Yh(this.wrap*+o,r,this.canonical.z,this.canonical.x,this.canonical.y):Yh(this.wrap*+o,r,r,this.canonical.x>>c,this.canonical.y>>c)}isChildOf(r){if(r.wrap!==this.wrap)return!1;const o=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>o&&r.canonical.y===this.canonical.y>>o}children(r){if(this.overscaledZ>=r)return[new Li(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,c=2*this.canonical.x,g=2*this.canonical.y;return[new Li(o,this.wrap,o,c,g),new Li(o,this.wrap,o,c+1,g),new Li(o,this.wrap,o,c,g+1),new Li(o,this.wrap,o,c+1,g+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Li(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Li(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Yb(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new Kh(r.x-this.wrap,r.y))}}function Yh(s,r,o,c,g){(s*=2)<0&&(s=-1*s-1);const v=1<<o;return(v*v*s+v*g+c).toString(36)+o.toString(36)+r.toString(36)}it("CanonicalTileID",h_),it("OverscaledTileID",Li,{omit:["posMatrix"]});class Jb{constructor(r,o,c,g=1,v=1,x=1,b=0){if(this.uid=r,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(c&&!["mapbox","terrarium","custom"].includes(c))return void je(`"${c}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const S=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),c){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=v,this.blueFactor=x,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let P=0;P<S;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(S,P)]=this.data[this._idx(S-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,S)]=this.data[this._idx(P,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let P=0;P<S;P++)for(let I=0;I<S;I++){const R=this.get(P,I);R>this.max&&(this.max=R),R<this.min&&(this.min=R)}}get(r,o){const c=new Uint8Array(this.data.buffer),g=4*this._idx(r,o);return this.unpack(c[g],c[g+1],c[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,o){if(r<-1||r>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(r+1)}unpack(r,o,c){return r*this.redFactor+o*this.greenFactor+c*this.blueFactor-this.baseShift}getPixels(){return new Ri({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,o,c){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let g=o*this.dim,v=o*this.dim+this.dim,x=c*this.dim,b=c*this.dim+this.dim;switch(o){case-1:g=v-1;break;case 1:v=g+1}switch(c){case-1:x=b-1;break;case 1:b=x+1}const S=-o*this.dim,P=-c*this.dim;for(let I=x;I<b;I++)for(let R=g;R<v;R++)this.data[this._idx(R,I)]=r.data[this._idx(R+S,I+P)]}}it("DEMData",Jb);class Qb{constructor(r){this._stringToNumber={},this._numberToString=[];for(let o=0;o<r.length;o++){const c=r[o];this._stringToNumber[c]=o,this._numberToString[o]=c}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class ew{constructor(r,o,c,g,v){this.type="Feature",this._vectorTileFeature=r,r._z=o,r._x=c,r._y=g,this.properties=r.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(r[o]=this[o]);return r}}class tw{constructor(r,o){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new aa(Fn,16,0),this.grid3D=new aa(Fn,16,0),this.featureIndexArray=new vr,this.promoteId=o}insert(r,o,c,g,v,x){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,g,v);const S=x?this.grid3D:this.grid;for(let P=0;P<o.length;P++){const I=o[P],R=[1/0,1/0,-1/0,-1/0];for(let B=0;B<I.length;B++){const N=I[B];R[0]=Math.min(R[0],N.x),R[1]=Math.min(R[1],N.y),R[2]=Math.max(R[2],N.x),R[3]=Math.max(R[3],N.y)}R[0]<Fn&&R[1]<Fn&&R[2]>=0&&R[3]>=0&&S.insert(b,R[0],R[1],R[2],R[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new _a.VectorTile(new Qy(this.rawTileData)).layers,this.sourceLayerCoder=new Qb(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,o,c,g){this.loadVTLayers();const v=r.params||{},x=Fn/r.tileSize/r.scale,b=gh(v.filter),S=r.queryGeometry,P=r.queryPadding*x,I=rw(S),R=this.grid.query(I.minX-P,I.minY-P,I.maxX+P,I.maxY+P),B=rw(r.cameraQueryGeometry),N=this.grid3D.query(B.minX-P,B.minY-P,B.maxX+P,B.maxY+P,(ee,se,we,de)=>function(xe,Pe,Le,et,mt){for(const Ke of xe)if(Pe<=Ke.x&&Le<=Ke.y&&et>=Ke.x&&mt>=Ke.y)return!0;const Je=[new z(Pe,Le),new z(Pe,mt),new z(et,mt),new z(et,Le)];if(xe.length>2){for(const Ke of Je)if(Bu(xe,Ke))return!0}for(let Ke=0;Ke<xe.length-1;Ke++)if(zI(xe[Ke],xe[Ke+1],Je))return!0;return!1}(r.cameraQueryGeometry,ee-P,se-P,we+P,de+P));for(const ee of N)R.push(ee);R.sort(QM);const $={};let q;for(let ee=0;ee<R.length;ee++){const se=R[ee];if(se===q)continue;q=se;const we=this.featureIndexArray.get(se);let de=null;this.loadMatchingFeature($,we.bucketIndex,we.sourceLayerIndex,we.featureIndex,b,v.layers,v.availableImages,o,c,g,(xe,Pe,Le)=>(de||(de=xl(xe)),Pe.queryIntersectsFeature(S,xe,Le,de,this.z,r.transform,x,r.pixelPosMatrix)))}return $}loadMatchingFeature(r,o,c,g,v,x,b,S,P,I,R){const B=this.bucketLayerIDs[o];if(x&&!function(ee,se){for(let we=0;we<ee.length;we++)if(se.indexOf(ee[we])>=0)return!0;return!1}(x,B))return;const N=this.sourceLayerCoder.decode(c),$=this.vtLayers[N].feature(g);if(v.needGeometry){const ee=bl($,!0);if(!v.filter(new un(this.tileID.overscaledZ),ee,this.tileID.canonical))return}else if(!v.filter(new un(this.tileID.overscaledZ),$))return;const q=this.getId($,N);for(let ee=0;ee<B.length;ee++){const se=B[ee];if(x&&x.indexOf(se)<0)continue;const we=S[se];if(!we)continue;let de={};q&&I&&(de=I.getState(we.sourceLayer||"_geojsonTileLayer",q));const xe=Se({},P[se]);xe.paint=nw(xe.paint,we.paint,$,de,b),xe.layout=nw(xe.layout,we.layout,$,de,b);const Pe=!R||R($,we,de);if(!Pe)continue;const Le=new ew($,this.z,this.x,this.y,q);Le.layer=xe;let et=r[se];et===void 0&&(et=r[se]=[]),et.push({featureIndex:g,feature:Le,intersectionZ:Pe})}}lookupSymbolFeatures(r,o,c,g,v,x,b,S){const P={};this.loadVTLayers();const I=gh(v);for(const R of r)this.loadMatchingFeature(P,c,g,R,I,x,b,S,o);return P}hasLayer(r){for(const o of this.bucketLayerIDs)for(const c of o)if(r===c)return!0;return!1}getId(r,o){let c=r.id;return this.promoteId&&(c=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof c=="boolean"&&(c=Number(c))),c}}function nw(s,r,o,c,g){return Be(s,(v,x)=>{const b=r instanceof gl?r.get(x):null;return b&&b.evaluate?b.evaluate(o,c,g):b})}function rw(s){let r=1/0,o=1/0,c=-1/0,g=-1/0;for(const v of s)r=Math.min(r,v.x),o=Math.min(o,v.y),c=Math.max(c,v.x),g=Math.max(g,v.y);return{minX:r,minY:o,maxX:c,maxY:g}}function QM(s,r){return r-s}function iw(s,r,o,c,g){const v=[];for(let x=0;x<s.length;x++){const b=s[x];let S;for(let P=0;P<b.length-1;P++){let I=b[P],R=b[P+1];I.x<r&&R.x<r||(I.x<r?I=new z(r,I.y+(r-I.x)/(R.x-I.x)*(R.y-I.y))._round():R.x<r&&(R=new z(r,I.y+(r-I.x)/(R.x-I.x)*(R.y-I.y))._round()),I.y<o&&R.y<o||(I.y<o?I=new z(I.x+(o-I.y)/(R.y-I.y)*(R.x-I.x),o)._round():R.y<o&&(R=new z(I.x+(o-I.y)/(R.y-I.y)*(R.x-I.x),o)._round()),I.x>=c&&R.x>=c||(I.x>=c?I=new z(c,I.y+(c-I.x)/(R.x-I.x)*(R.y-I.y))._round():R.x>=c&&(R=new z(c,I.y+(c-I.x)/(R.x-I.x)*(R.y-I.y))._round()),I.y>=g&&R.y>=g||(I.y>=g?I=new z(I.x+(g-I.y)/(R.y-I.y)*(R.x-I.x),g)._round():R.y>=g&&(R=new z(I.x+(g-I.y)/(R.y-I.y)*(R.x-I.x),g)._round()),S&&I.equals(S[S.length-1])||(S=[I],v.push(S)),S.push(R)))))}}return v}it("FeatureIndex",tw,{omit:["rawTileData","sourceLayerCoder"]});class wa extends z{constructor(r,o,c,g){super(r,o),this.angle=c,g!==void 0&&(this.segment=g)}clone(){return new wa(this.x,this.y,this.angle,this.segment)}}function sw(s,r,o,c,g){if(r.segment===void 0||o===0)return!0;let v=r,x=r.segment+1,b=0;for(;b>-o/2;){if(x--,x<0)return!1;b-=s[x].dist(v),v=s[x]}b+=s[x].dist(s[x+1]),x++;const S=[];let P=0;for(;b<o/2;){const I=s[x],R=s[x+1];if(!R)return!1;let B=s[x-1].angleTo(I)-I.angleTo(R);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:b,angleDelta:B}),P+=B;b-S[0].distance>c;)P-=S.shift().angleDelta;if(P>g)return!1;x++,b+=I.dist(R)}return!0}function ow(s){let r=0;for(let o=0;o<s.length-1;o++)r+=s[o].dist(s[o+1]);return r}function aw(s,r,o){return s?.6*r*o:0}function lw(s,r){return Math.max(s?s.right-s.left:0,r?r.right-r.left:0)}function eA(s,r,o,c,g,v){const x=aw(o,g,v),b=lw(o,c)*v;let S=0;const P=ow(s)/2;for(let I=0;I<s.length-1;I++){const R=s[I],B=s[I+1],N=R.dist(B);if(S+N>P){const $=(P-S)/N,q=Ir.number(R.x,B.x,$),ee=Ir.number(R.y,B.y,$),se=new wa(q,ee,B.angleTo(R),I);return se._round(),!x||sw(s,se,b,x,r)?se:void 0}S+=N}}function tA(s,r,o,c,g,v,x,b,S){const P=aw(c,v,x),I=lw(c,g),R=I*x,B=s[0].x===0||s[0].x===S||s[0].y===0||s[0].y===S;return r-R<r/4&&(r=R+r/4),uw(s,B?r/2*b%r:(I/2+2*v)*x*b%r,r,P,o,R,B,!1,S)}function uw(s,r,o,c,g,v,x,b,S){const P=v/2,I=ow(s);let R=0,B=r-o,N=[];for(let $=0;$<s.length-1;$++){const q=s[$],ee=s[$+1],se=q.dist(ee),we=ee.angleTo(q);for(;B+o<R+se;){B+=o;const de=(B-R)/se,xe=Ir.number(q.x,ee.x,de),Pe=Ir.number(q.y,ee.y,de);if(xe>=0&&xe<S&&Pe>=0&&Pe<S&&B-P>=0&&B+P<=I){const Le=new wa(xe,Pe,we,$);Le._round(),c&&!sw(s,Le,v,c,g)||N.push(Le)}}R+=se}return b||N.length||x||(N=uw(s,R/2,o,c,g,v,x,!0,S)),N}it("Anchor",wa);const qu=Jr;function cw(s,r,o,c){const g=[],v=s.image,x=v.pixelRatio,b=v.paddedRect.w-2*qu,S=v.paddedRect.h-2*qu;let P={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const I=v.stretchX||[[0,b]],R=v.stretchY||[[0,S]],B=(Me,ct)=>Me+ct[1]-ct[0],N=I.reduce(B,0),$=R.reduce(B,0),q=b-N,ee=S-$;let se=0,we=N,de=0,xe=$,Pe=0,Le=q,et=0,mt=ee;if(v.content&&c){const Me=v.content,ct=Me[2]-Me[0],lt=Me[3]-Me[1];(v.textFitWidth||v.textFitHeight)&&(P=Bb(s)),se=Cp(I,0,Me[0]),de=Cp(R,0,Me[1]),we=Cp(I,Me[0],Me[2]),xe=Cp(R,Me[1],Me[3]),Pe=Me[0]-se,et=Me[1]-de,Le=ct-we,mt=lt-xe}const Je=P.x1,Ke=P.y1,ut=P.x2-Je,st=P.y2-Ke,rt=(Me,ct,lt,xt)=>{const en=kp(Me.stretch-se,we,ut,Je),Yt=Pp(Me.fixed-Pe,Le,Me.stretch,N),Wn=kp(ct.stretch-de,xe,st,Ke),is=Pp(ct.fixed-et,mt,ct.stretch,$),hr=kp(lt.stretch-se,we,ut,Je),Hn=Pp(lt.fixed-Pe,Le,lt.stretch,N),Dr=kp(xt.stretch-de,xe,st,Ke),Rr=Pp(xt.fixed-et,mt,xt.stretch,$),Lr=new z(en,Wn),Sn=new z(hr,Wn),Xn=new z(hr,Dr),br=new z(en,Dr),dr=new z(Yt/x,is/x),Fr=new z(Hn/x,Rr/x),fr=r*Math.PI/180;if(fr){const Ut=Math.sin(fr),nn=Math.cos(fr),fn=[nn,-Ut,Ut,nn];Lr._matMult(fn),Sn._matMult(fn),br._matMult(fn),Xn._matMult(fn)}const Fi=Me.stretch+Me.fixed,Qr=ct.stretch+ct.fixed;return{tl:Lr,tr:Sn,bl:br,br:Xn,tex:{x:v.paddedRect.x+qu+Fi,y:v.paddedRect.y+qu+Qr,w:lt.stretch+lt.fixed-Fi,h:xt.stretch+xt.fixed-Qr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:dr,pixelOffsetBR:Fr,minFontScaleX:Le/x/ut,minFontScaleY:mt/x/st,isSDF:o}};if(c&&(v.stretchX||v.stretchY)){const Me=hw(I,q,N),ct=hw(R,ee,$);for(let lt=0;lt<Me.length-1;lt++){const xt=Me[lt],en=Me[lt+1];for(let Yt=0;Yt<ct.length-1;Yt++)g.push(rt(xt,ct[Yt],en,ct[Yt+1]))}}else g.push(rt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:S+1}));return g}function Cp(s,r,o){let c=0;for(const g of s)c+=Math.max(r,Math.min(o,g[1]))-Math.max(r,Math.min(o,g[0]));return c}function hw(s,r,o){const c=[{fixed:-qu,stretch:0}];for(const[g,v]of s){const x=c[c.length-1];c.push({fixed:g-x.stretch,stretch:x.stretch}),c.push({fixed:g-x.stretch,stretch:x.stretch+(v-g)})}return c.push({fixed:r+qu,stretch:o}),c}function kp(s,r,o,c){return s/r*o+c}function Pp(s,r,o,c){return s-r*o/c}class Ep{constructor(r,o,c,g,v,x,b,S,P,I){var R;if(this.boxStartIndex=r.length,P){let B=x.top,N=x.bottom;const $=x.collisionPadding;$&&(B-=$[1],N+=$[3]);let q=N-B;q>0&&(q=Math.max(10,q),this.circleDiameter=q)}else{const B=!((R=x.image)===null||R===void 0)&&R.content&&(x.image.textFitWidth||x.image.textFitHeight)?Bb(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};B.y1=B.y1*b-S[0],B.y2=B.y2*b+S[2],B.x1=B.x1*b-S[3],B.x2=B.x2*b+S[1];const N=x.collisionPadding;if(N&&(B.x1-=N[0]*b,B.y1-=N[1]*b,B.x2+=N[2]*b,B.y2+=N[3]*b),I){const $=new z(B.x1,B.y1),q=new z(B.x2,B.y1),ee=new z(B.x1,B.y2),se=new z(B.x2,B.y2),we=I*Math.PI/180;$._rotate(we),q._rotate(we),ee._rotate(we),se._rotate(we),B.x1=Math.min($.x,q.x,ee.x,se.x),B.x2=Math.max($.x,q.x,ee.x,se.x),B.y1=Math.min($.y,q.y,ee.y,se.y),B.y2=Math.max($.y,q.y,ee.y,se.y)}r.emplaceBack(o.x,o.y,B.x1,B.y1,B.x2,B.y2,c,g,v)}this.boxEndIndex=r.length}}class nA{constructor(r=[],o=(c,g)=>c<g?-1:c>g?1:0){if(this.data=r,this.length=this.data.length,this.compare=o,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:o,compare:c}=this,g=o[r];for(;r>0;){const v=r-1>>1,x=o[v];if(c(g,x)>=0)break;o[r]=x,r=v}o[r]=g}_down(r){const{data:o,compare:c}=this,g=this.length>>1,v=o[r];for(;r<g;){let x=1+(r<<1);const b=x+1;if(b<this.length&&c(o[b],o[x])<0&&(x=b),c(o[x],v)>=0)break;o[r]=o[x],r=x}o[r]=v}}function rA(s,r=1,o=!1){let c=1/0,g=1/0,v=-1/0,x=-1/0;const b=s[0];for(let N=0;N<b.length;N++){const $=b[N];(!N||$.x<c)&&(c=$.x),(!N||$.y<g)&&(g=$.y),(!N||$.x>v)&&(v=$.x),(!N||$.y>x)&&(x=$.y)}const S=Math.min(v-c,x-g);let P=S/2;const I=new nA([],iA);if(S===0)return new z(c,g);for(let N=c;N<v;N+=S)for(let $=g;$<x;$+=S)I.push(new Zu(N+P,$+P,P,s));let R=function(N){let $=0,q=0,ee=0;const se=N[0];for(let we=0,de=se.length,xe=de-1;we<de;xe=we++){const Pe=se[we],Le=se[xe],et=Pe.x*Le.y-Le.x*Pe.y;q+=(Pe.x+Le.x)*et,ee+=(Pe.y+Le.y)*et,$+=3*et}return new Zu(q/$,ee/$,0,N)}(s),B=I.length;for(;I.length;){const N=I.pop();(N.d>R.d||!R.d)&&(R=N,o&&console.log("found best %d after %d probes",Math.round(1e4*N.d)/1e4,B)),N.max-R.d<=r||(P=N.h/2,I.push(new Zu(N.p.x-P,N.p.y-P,P,s)),I.push(new Zu(N.p.x+P,N.p.y-P,P,s)),I.push(new Zu(N.p.x-P,N.p.y+P,P,s)),I.push(new Zu(N.p.x+P,N.p.y+P,P,s)),B+=4)}return o&&(console.log(`num probes: ${B}`),console.log(`best distance: ${R.d}`)),R.p}function iA(s,r){return r.max-s.max}function Zu(s,r,o,c){this.p=new z(s,r),this.h=o,this.d=function(g,v){let x=!1,b=1/0;for(let S=0;S<v.length;S++){const P=v[S];for(let I=0,R=P.length,B=R-1;I<R;B=I++){const N=P[I],$=P[B];N.y>g.y!=$.y>g.y&&g.x<($.x-N.x)*(g.y-N.y)/($.y-N.y)+N.x&&(x=!x),b=Math.min(b,H1(g,N,$))}}return(x?1:-1)*Math.sqrt(b)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}var cr;m.aq=void 0,(cr=m.aq||(m.aq={}))[cr.center=1]="center",cr[cr.left=2]="left",cr[cr.right=3]="right",cr[cr.top=4]="top",cr[cr.bottom=5]="bottom",cr[cr["top-left"]=6]="top-left",cr[cr["top-right"]=7]="top-right",cr[cr["bottom-left"]=8]="bottom-left",cr[cr["bottom-right"]=9]="bottom-right";const Sa=7,d_=Number.POSITIVE_INFINITY;function dw(s,r){return r[1]!==d_?function(o,c,g){let v=0,x=0;switch(c=Math.abs(c),g=Math.abs(g),o){case"top-right":case"top-left":case"top":x=g-Sa;break;case"bottom-right":case"bottom-left":case"bottom":x=-g+Sa}switch(o){case"top-right":case"bottom-right":case"right":v=-c;break;case"top-left":case"bottom-left":case"left":v=c}return[v,x]}(s,r[0],r[1]):function(o,c){let g=0,v=0;c<0&&(c=0);const x=c/Math.SQRT2;switch(o){case"top-right":case"top-left":v=x-Sa;break;case"bottom-right":case"bottom-left":v=-x+Sa;break;case"bottom":v=-c+Sa;break;case"top":v=c-Sa}switch(o){case"top-right":case"bottom-right":g=-x;break;case"top-left":case"bottom-left":g=x;break;case"left":g=c;break;case"right":g=-c}return[g,v]}(s,r[0])}function fw(s,r,o){var c;const g=s.layout,v=(c=g.get("text-variable-anchor-offset"))===null||c===void 0?void 0:c.evaluate(r,{},o);if(v){const b=v.values,S=[];for(let P=0;P<b.length;P+=2){const I=S[P]=b[P],R=b[P+1].map(B=>B*jn);I.startsWith("top")?R[1]-=Sa:I.startsWith("bottom")&&(R[1]+=Sa),S[P+1]=R}return new li(S)}const x=g.get("text-variable-anchor");if(x){let b;b=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(r,{},o)*jn,d_]:g.get("text-offset").evaluate(r,{},o).map(P=>P*jn);const S=[];for(const P of x)S.push(P,dw(P,b));return new li(S)}return null}function f_(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function sA(s,r,o,c,g,v,x,b,S,P,I){let R=v.textMaxSize.evaluate(r,{});R===void 0&&(R=x);const B=s.layers[0].layout,N=B.get("icon-offset").evaluate(r,{},I),$=mw(o.horizontal),q=x/24,ee=s.tilePixelRatio*q,se=s.tilePixelRatio*R/24,we=s.tilePixelRatio*b,de=s.tilePixelRatio*B.get("symbol-spacing"),xe=B.get("text-padding")*s.tilePixelRatio,Pe=function(Me,ct,lt,xt=1){const en=Me.get("icon-padding").evaluate(ct,{},lt),Yt=en&&en.values;return[Yt[0]*xt,Yt[1]*xt,Yt[2]*xt,Yt[3]*xt]}(B,r,I,s.tilePixelRatio),Le=B.get("text-max-angle")/180*Math.PI,et=B.get("text-rotation-alignment")!=="viewport"&&B.get("symbol-placement")!=="point",mt=B.get("icon-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",Je=B.get("symbol-placement"),Ke=de/2,ut=B.get("icon-text-fit");let st;c&&ut!=="none"&&(s.allowVerticalPlacement&&o.vertical&&(st=Ob(c,o.vertical,ut,B.get("icon-text-fit-padding"),N,q)),$&&(c=Ob(c,$,ut,B.get("icon-text-fit-padding"),N,q)));const rt=(Me,ct)=>{ct.x<0||ct.x>=Fn||ct.y<0||ct.y>=Fn||function(lt,xt,en,Yt,Wn,is,hr,Hn,Dr,Rr,Lr,Sn,Xn,br,dr,Fr,fr,Fi,Qr,Ut,nn,fn,mi,_n,Wu){const Gs=lt.addToLineVertexArray(xt,en);let qs,ss,Bi,tr,To=0,ed=0,vw=0,xw=0,b_=-1,w_=-1;const Co={};let bw=Du("");if(lt.allowVerticalPlacement&&Yt.vertical){const wr=Hn.layout.get("text-rotate").evaluate(nn,{},_n)+90;Bi=new Ep(Dr,xt,Rr,Lr,Sn,Yt.vertical,Xn,br,dr,wr),hr&&(tr=new Ep(Dr,xt,Rr,Lr,Sn,hr,fr,Fi,dr,wr))}if(Wn){const wr=Hn.layout.get("icon-rotate").evaluate(nn,{}),Oi=Hn.layout.get("icon-text-fit")!=="none",Sl=cw(Wn,wr,mi,Oi),Ps=hr?cw(hr,wr,mi,Oi):void 0;ss=new Ep(Dr,xt,Rr,Lr,Sn,Wn,fr,Fi,!1,wr),To=4*Sl.length;const Tl=lt.iconSizeData;let Zs=null;Tl.kind==="source"?(Zs=[Us*Hn.layout.get("icon-size").evaluate(nn,{})],Zs[0]>xa&&je(`${lt.layerIds[0]}: Value for "icon-size" is >= ${Xh}. Reduce your "icon-size".`)):Tl.kind==="composite"&&(Zs=[Us*fn.compositeIconSizes[0].evaluate(nn,{},_n),Us*fn.compositeIconSizes[1].evaluate(nn,{},_n)],(Zs[0]>xa||Zs[1]>xa)&&je(`${lt.layerIds[0]}: Value for "icon-size" is >= ${Xh}. Reduce your "icon-size".`)),lt.addSymbols(lt.icon,Sl,Zs,Ut,Qr,nn,m.ah.none,xt,Gs.lineStartIndex,Gs.lineLength,-1,_n),b_=lt.icon.placedSymbolArray.length-1,Ps&&(ed=4*Ps.length,lt.addSymbols(lt.icon,Ps,Zs,Ut,Qr,nn,m.ah.vertical,xt,Gs.lineStartIndex,Gs.lineLength,-1,_n),w_=lt.icon.placedSymbolArray.length-1)}const ww=Object.keys(Yt.horizontal);for(const wr of ww){const Oi=Yt.horizontal[wr];if(!qs){bw=Du(Oi.text);const Ps=Hn.layout.get("text-rotate").evaluate(nn,{},_n);qs=new Ep(Dr,xt,Rr,Lr,Sn,Oi,Xn,br,dr,Ps)}const Sl=Oi.positionedLines.length===1;if(vw+=pw(lt,xt,Oi,is,Hn,dr,nn,Fr,Gs,Yt.vertical?m.ah.horizontal:m.ah.horizontalOnly,Sl?ww:[wr],Co,b_,fn,_n),Sl)break}Yt.vertical&&(xw+=pw(lt,xt,Yt.vertical,is,Hn,dr,nn,Fr,Gs,m.ah.vertical,["vertical"],Co,w_,fn,_n));const lA=qs?qs.boxStartIndex:lt.collisionBoxArray.length,uA=qs?qs.boxEndIndex:lt.collisionBoxArray.length,cA=Bi?Bi.boxStartIndex:lt.collisionBoxArray.length,hA=Bi?Bi.boxEndIndex:lt.collisionBoxArray.length,dA=ss?ss.boxStartIndex:lt.collisionBoxArray.length,fA=ss?ss.boxEndIndex:lt.collisionBoxArray.length,pA=tr?tr.boxStartIndex:lt.collisionBoxArray.length,mA=tr?tr.boxEndIndex:lt.collisionBoxArray.length;let ks=-1;const Mp=(wr,Oi)=>wr&&wr.circleDiameter?Math.max(wr.circleDiameter,Oi):Oi;ks=Mp(qs,ks),ks=Mp(Bi,ks),ks=Mp(ss,ks),ks=Mp(tr,ks);const Sw=ks>-1?1:0;Sw&&(ks*=Wu/jn),lt.glyphOffsetArray.length>=Gu.MAX_GLYPHS&&je("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),nn.sortKey!==void 0&&lt.addToSortKeyRanges(lt.symbolInstances.length,nn.sortKey);const gA=fw(Hn,nn,_n),[yA,_A]=function(wr,Oi){const Sl=wr.length,Ps=Oi==null?void 0:Oi.values;if((Ps==null?void 0:Ps.length)>0)for(let Tl=0;Tl<Ps.length;Tl+=2){const Zs=Ps[Tl+1];wr.emplaceBack(m.aq[Ps[Tl]],Zs[0],Zs[1])}return[Sl,wr.length]}(lt.textAnchorOffsets,gA);lt.symbolInstances.emplaceBack(xt.x,xt.y,Co.right>=0?Co.right:-1,Co.center>=0?Co.center:-1,Co.left>=0?Co.left:-1,Co.vertical||-1,b_,w_,bw,lA,uA,cA,hA,dA,fA,pA,mA,Rr,vw,xw,To,ed,Sw,0,Xn,ks,yA,_A)}(s,ct,Me,o,c,g,st,s.layers[0],s.collisionBoxArray,r.index,r.sourceLayerIndex,s.index,ee,[xe,xe,xe,xe],et,S,we,Pe,mt,N,r,v,P,I,x)};if(Je==="line")for(const Me of iw(r.geometry,0,0,Fn,Fn)){const ct=tA(Me,de,Le,o.vertical||$,c,24,se,s.overscaling,Fn);for(const lt of ct)$&&oA(s,$.text,Ke,lt)||rt(Me,lt)}else if(Je==="line-center"){for(const Me of r.geometry)if(Me.length>1){const ct=eA(Me,Le,o.vertical||$,c,24,se);ct&&rt(Me,ct)}}else if(r.type==="Polygon")for(const Me of uu(r.geometry,0)){const ct=rA(Me,16);rt(Me[0],new wa(ct.x,ct.y,0))}else if(r.type==="LineString")for(const Me of r.geometry)rt(Me,new wa(Me[0].x,Me[0].y,0));else if(r.type==="Point")for(const Me of r.geometry)for(const ct of Me)rt([ct],new wa(ct.x,ct.y,0))}function pw(s,r,o,c,g,v,x,b,S,P,I,R,B,N,$){const q=function(we,de,xe,Pe,Le,et,mt,Je){const Ke=Pe.layout.get("text-rotate").evaluate(et,{})*Math.PI/180,ut=[];for(const st of de.positionedLines)for(const rt of st.positionedGlyphs){if(!rt.rect)continue;const Me=rt.rect||{};let ct=Mb+1,lt=!0,xt=1,en=0;const Yt=(Le||Je)&&rt.vertical,Wn=rt.metrics.advance*rt.scale/2;if(Je&&de.verticalizable&&(en=st.lineOffset/2-(rt.imageName?-(jn-rt.metrics.width*rt.scale)/2:(rt.scale-1)*jn)),rt.imageName){const Ut=mt[rt.imageName];lt=Ut.sdf,xt=Ut.pixelRatio,ct=Jr/xt}const is=Le?[rt.x+Wn,rt.y]:[0,0];let hr=Le?[0,0]:[rt.x+Wn+xe[0],rt.y+xe[1]-en],Hn=[0,0];Yt&&(Hn=hr,hr=[0,0]);const Dr=rt.metrics.isDoubleResolution?2:1,Rr=(rt.metrics.left-ct)*rt.scale-Wn+hr[0],Lr=(-rt.metrics.top-ct)*rt.scale+hr[1],Sn=Rr+Me.w/Dr*rt.scale/xt,Xn=Lr+Me.h/Dr*rt.scale/xt,br=new z(Rr,Lr),dr=new z(Sn,Lr),Fr=new z(Rr,Xn),fr=new z(Sn,Xn);if(Yt){const Ut=new z(-Wn,Wn-Wh),nn=-Math.PI/2,fn=jn/2-Wn,mi=new z(5-Wh-fn,-(rt.imageName?fn:0)),_n=new z(...Hn);br._rotateAround(nn,Ut)._add(mi)._add(_n),dr._rotateAround(nn,Ut)._add(mi)._add(_n),Fr._rotateAround(nn,Ut)._add(mi)._add(_n),fr._rotateAround(nn,Ut)._add(mi)._add(_n)}if(Ke){const Ut=Math.sin(Ke),nn=Math.cos(Ke),fn=[nn,-Ut,Ut,nn];br._matMult(fn),dr._matMult(fn),Fr._matMult(fn),fr._matMult(fn)}const Fi=new z(0,0),Qr=new z(0,0);ut.push({tl:br,tr:dr,bl:Fr,br:fr,tex:Me,writingMode:de.writingMode,glyphOffset:is,sectionIndex:rt.sectionIndex,isSDF:lt,pixelOffsetTL:Fi,pixelOffsetBR:Qr,minFontScaleX:0,minFontScaleY:0})}return ut}(0,o,b,g,v,x,c,s.allowVerticalPlacement),ee=s.textSizeData;let se=null;ee.kind==="source"?(se=[Us*g.layout.get("text-size").evaluate(x,{})],se[0]>xa&&je(`${s.layerIds[0]}: Value for "text-size" is >= ${Xh}. Reduce your "text-size".`)):ee.kind==="composite"&&(se=[Us*N.compositeTextSizes[0].evaluate(x,{},$),Us*N.compositeTextSizes[1].evaluate(x,{},$)],(se[0]>xa||se[1]>xa)&&je(`${s.layerIds[0]}: Value for "text-size" is >= ${Xh}. Reduce your "text-size".`)),s.addSymbols(s.text,q,se,b,v,x,P,r,S.lineStartIndex,S.lineLength,B,$);for(const we of I)R[we]=s.text.placedSymbolArray.length-1;return 4*q.length}function mw(s){for(const r in s)return s[r];return null}function oA(s,r,o,c){const g=s.compareText;if(r in g){const v=g[r];for(let x=v.length-1;x>=0;x--)if(c.dist(v[x])<o)return!0}else g[r]=[];return g[r].push(c),!1}const gw=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class p_{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,c]=new Uint8Array(r,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=c>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const v=gw[15&c];if(!v)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(r,2,1),[b]=new Uint32Array(r,4,1);return new p_(b,x,v,r)}constructor(r,o=64,c=Float64Array,g){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=c,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const v=gw.indexOf(this.ArrayType),x=2*r*this.ArrayType.BYTES_PER_ELEMENT,b=r*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-b%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${c}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+S,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+x+b+S),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+S,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=r)}add(r,o){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=r,this.coords[this._pos++]=o,c}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return m_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,o,c,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:x,nodeSize:b}=this,S=[0,v.length-1,0],P=[];for(;S.length;){const I=S.pop()||0,R=S.pop()||0,B=S.pop()||0;if(R-B<=b){for(let ee=B;ee<=R;ee++){const se=x[2*ee],we=x[2*ee+1];se>=r&&se<=c&&we>=o&&we<=g&&P.push(v[ee])}continue}const N=B+R>>1,$=x[2*N],q=x[2*N+1];$>=r&&$<=c&&q>=o&&q<=g&&P.push(v[N]),(I===0?r<=$:o<=q)&&(S.push(B),S.push(N-1),S.push(1-I)),(I===0?c>=$:g>=q)&&(S.push(N+1),S.push(R),S.push(1-I))}return P}within(r,o,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:v,nodeSize:x}=this,b=[0,g.length-1,0],S=[],P=c*c;for(;b.length;){const I=b.pop()||0,R=b.pop()||0,B=b.pop()||0;if(R-B<=x){for(let ee=B;ee<=R;ee++)_w(v[2*ee],v[2*ee+1],r,o)<=P&&S.push(g[ee]);continue}const N=B+R>>1,$=v[2*N],q=v[2*N+1];_w($,q,r,o)<=P&&S.push(g[N]),(I===0?r-c<=$:o-c<=q)&&(b.push(B),b.push(N-1),b.push(1-I)),(I===0?r+c>=$:o+c>=q)&&(b.push(N+1),b.push(R),b.push(1-I))}return S}}function m_(s,r,o,c,g,v){if(g-c<=o)return;const x=c+g>>1;yw(s,r,x,c,g,v),m_(s,r,o,c,x-1,1-v),m_(s,r,o,x+1,g,1-v)}function yw(s,r,o,c,g,v){for(;g>c;){if(g-c>600){const P=g-c+1,I=o-c+1,R=Math.log(P),B=.5*Math.exp(2*R/3),N=.5*Math.sqrt(R*B*(P-B)/P)*(I-P/2<0?-1:1);yw(s,r,o,Math.max(c,Math.floor(o-I*B/P+N)),Math.min(g,Math.floor(o+(P-I)*B/P+N)),v)}const x=r[2*o+v];let b=c,S=g;for(Jh(s,r,c,o),r[2*g+v]>x&&Jh(s,r,c,g);b<S;){for(Jh(s,r,b,S),b++,S--;r[2*b+v]<x;)b++;for(;r[2*S+v]>x;)S--}r[2*c+v]===x?Jh(s,r,c,S):(S++,Jh(s,r,S,g)),S<=o&&(c=S+1),o<=S&&(g=S-1)}}function Jh(s,r,o,c){g_(s,o,c),g_(r,2*o,2*c),g_(r,2*o+1,2*c+1)}function g_(s,r,o){const c=s[r];s[r]=s[o],s[o]=c}function _w(s,r,o,c){const g=s-o,v=r-c;return g*g+v*v}var y_;m.bg=void 0,(y_=m.bg||(m.bg={})).create="create",y_.load="load",y_.fullLoad="fullLoad";let Ip=null,Qh=[];const __=1e3/60,v_="loadTime",x_="fullLoadTime",aA={mark(s){performance.mark(s)},frame(s){const r=s;Ip!=null&&Qh.push(r-Ip),Ip=r},clearMetrics(){Ip=null,Qh=[],performance.clearMeasures(v_),performance.clearMeasures(x_);for(const s in m.bg)performance.clearMarks(m.bg[s])},getPerformanceMetrics(){performance.measure(v_,m.bg.create,m.bg.load),performance.measure(x_,m.bg.create,m.bg.fullLoad);const s=performance.getEntriesByName(v_)[0].duration,r=performance.getEntriesByName(x_)[0].duration,o=Qh.length,c=1/(Qh.reduce((v,x)=>v+x,0)/o/1e3),g=Qh.filter(v=>v>__).reduce((v,x)=>v+(x-__)/__,0);return{loadTime:s,fullLoadTime:r,fps:c,percentDroppedFrames:g/(o+g)*100,totalFrames:o}}};m.$=class extends L{},m.A=Ou,m.B=Ey,m.C=function(s){if(Ct==null){const r=s.navigator?s.navigator.userAgent:null;Ct=!!s.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return Ct},m.D=ot,m.E=Fs,m.F=class{constructor(s,r){this.target=s,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new JM(()=>this.process()),this.subscription=function(o,c,g,v){return o.addEventListener(c,g,!1),{unsubscribe:()=>{o.removeEventListener(c,g,!1)}}}(this.target,"message",o=>this.receive(o)),this.globalScope=ft(self)?s:window}registerMessageHandler(s,r){this.messageHandlers[s]=r}sendAsync(s,r){return new Promise((o,c)=>{const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[g]={resolve:o,reject:c},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[g];const b={id:g,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(b)},{once:!0});const v=[],x=Object.assign(Object.assign({},s),{id:g,sourceMapId:this.mapId,origin:location.origin,data:la(s.data,v)});this.target.postMessage(x,{transfer:v})})}receive(s){const r=s.data,o=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!=="resource://android"&&location.origin!=="resource://android"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[o];const c=this.abortControllers[o];return delete this.abortControllers[o],void(c&&c.abort())}if(ft(self)||r.mustQueue)return this.tasks[o]=r,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,r)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),r=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(s,r)}processTask(s,r){return u(this,void 0,void 0,function*(){if(r.type==="<response>"){const g=this.resolveRejects[s];return delete this.resolveRejects[s],g?void(r.error?g.reject(ua(r.error)):g.resolve(ua(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=ua(r.data),c=new AbortController;this.abortControllers[s]=c;try{const g=yield this.messageHandlers[r.type](r.sourceMapId,o,c);this.completeTask(s,null,g)}catch(g){this.completeTask(s,g)}})}completeTask(s,r,o){const c=[];delete this.abortControllers[s];const g={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?la(r):null,data:la(o,c)};this.target.postMessage(g,{transfer:c})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},m.G=sr,m.H=function(){var s=new Ou(16);return Ou!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},m.I=t_,m.J=function(s,r,o){var c,g,v,x,b,S,P,I,R,B,N,$,q=o[0],ee=o[1],se=o[2];return r===s?(s[12]=r[0]*q+r[4]*ee+r[8]*se+r[12],s[13]=r[1]*q+r[5]*ee+r[9]*se+r[13],s[14]=r[2]*q+r[6]*ee+r[10]*se+r[14],s[15]=r[3]*q+r[7]*ee+r[11]*se+r[15]):(g=r[1],v=r[2],x=r[3],b=r[4],S=r[5],P=r[6],I=r[7],R=r[8],B=r[9],N=r[10],$=r[11],s[0]=c=r[0],s[1]=g,s[2]=v,s[3]=x,s[4]=b,s[5]=S,s[6]=P,s[7]=I,s[8]=R,s[9]=B,s[10]=N,s[11]=$,s[12]=c*q+b*ee+R*se+r[12],s[13]=g*q+S*ee+B*se+r[13],s[14]=v*q+P*ee+N*se+r[14],s[15]=x*q+I*ee+$*se+r[15]),s},m.K=function(s,r,o){var c=o[0],g=o[1],v=o[2];return s[0]=r[0]*c,s[1]=r[1]*c,s[2]=r[2]*c,s[3]=r[3]*c,s[4]=r[4]*g,s[5]=r[5]*g,s[6]=r[6]*g,s[7]=r[7]*g,s[8]=r[8]*v,s[9]=r[9]*v,s[10]=r[10]*v,s[11]=r[11]*v,s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},m.L=J1,m.M=function(s,r){const o={};for(let c=0;c<r.length;c++){const g=r[c];g in s&&(o[g]=s[g])}return o},m.N=ba,m.O=Wb,m.P=z,m.Q=Hb,m.R=Ri,m.S=Li,m.T=Eu,m.U=U,m.V=G,m.W=tt,m.X=Fn,m.Y=w,m.Z=Kh,m._=u,m.a=qn,m.a$=function(s,r){var o=s[0],c=s[1],g=s[2],v=s[3],x=s[4],b=s[5],S=s[6],P=s[7],I=s[8],R=s[9],B=s[10],N=s[11],$=s[12],q=s[13],ee=s[14],se=s[15],we=r[0],de=r[1],xe=r[2],Pe=r[3],Le=r[4],et=r[5],mt=r[6],Je=r[7],Ke=r[8],ut=r[9],st=r[10],rt=r[11],Me=r[12],ct=r[13],lt=r[14],xt=r[15];return Math.abs(o-we)<=zr*Math.max(1,Math.abs(o),Math.abs(we))&&Math.abs(c-de)<=zr*Math.max(1,Math.abs(c),Math.abs(de))&&Math.abs(g-xe)<=zr*Math.max(1,Math.abs(g),Math.abs(xe))&&Math.abs(v-Pe)<=zr*Math.max(1,Math.abs(v),Math.abs(Pe))&&Math.abs(x-Le)<=zr*Math.max(1,Math.abs(x),Math.abs(Le))&&Math.abs(b-et)<=zr*Math.max(1,Math.abs(b),Math.abs(et))&&Math.abs(S-mt)<=zr*Math.max(1,Math.abs(S),Math.abs(mt))&&Math.abs(P-Je)<=zr*Math.max(1,Math.abs(P),Math.abs(Je))&&Math.abs(I-Ke)<=zr*Math.max(1,Math.abs(I),Math.abs(Ke))&&Math.abs(R-ut)<=zr*Math.max(1,Math.abs(R),Math.abs(ut))&&Math.abs(B-st)<=zr*Math.max(1,Math.abs(B),Math.abs(st))&&Math.abs(N-rt)<=zr*Math.max(1,Math.abs(N),Math.abs(rt))&&Math.abs($-Me)<=zr*Math.max(1,Math.abs($),Math.abs(Me))&&Math.abs(q-ct)<=zr*Math.max(1,Math.abs(q),Math.abs(ct))&&Math.abs(ee-lt)<=zr*Math.max(1,Math.abs(ee),Math.abs(lt))&&Math.abs(se-xt)<=zr*Math.max(1,Math.abs(se),Math.abs(xt))},m.a0=Ft,m.a1=h_,m.a2=$e,m.a3=s=>{const r=window.document.createElement("video");return r.muted=!0,new Promise(o=>{r.onloadstart=()=>{o(r)};for(const c of s){const g=window.document.createElement("source");xs(c)||(r.crossOrigin="Anonymous"),g.src=c,r.appendChild(g)}})},m.a4=function(){return Ie++},m.a5=Qe,m.a6=Gu,m.a7=gh,m.a8=bl,m.a9=ew,m.aA=function(s){if(s.type==="custom")return new YM(s);switch(s.type){case"background":return new HM(s);case"circle":return new LI(s);case"fill":return new JI(s);case"fill-extrusion":return new fM(s);case"heatmap":return new BI(s);case"hillshade":return new VI(s);case"line":return new bM(s);case"raster":return new KM(s);case"symbol":return new Tp(s)}},m.aB=Ne,m.aC=function(s,r){if(!s)return[{command:"setStyle",args:[r]}];let o=[];try{if(!Ot(s.version,r.version))return[{command:"setStyle",args:[r]}];Ot(s.center,r.center)||o.push({command:"setCenter",args:[r.center]}),Ot(s.zoom,r.zoom)||o.push({command:"setZoom",args:[r.zoom]}),Ot(s.bearing,r.bearing)||o.push({command:"setBearing",args:[r.bearing]}),Ot(s.pitch,r.pitch)||o.push({command:"setPitch",args:[r.pitch]}),Ot(s.sprite,r.sprite)||o.push({command:"setSprite",args:[r.sprite]}),Ot(s.glyphs,r.glyphs)||o.push({command:"setGlyphs",args:[r.glyphs]}),Ot(s.transition,r.transition)||o.push({command:"setTransition",args:[r.transition]}),Ot(s.light,r.light)||o.push({command:"setLight",args:[r.light]}),Ot(s.terrain,r.terrain)||o.push({command:"setTerrain",args:[r.terrain]}),Ot(s.sky,r.sky)||o.push({command:"setSky",args:[r.sky]}),Ot(s.projection,r.projection)||o.push({command:"setProjection",args:[r.projection]});const c={},g=[];(function(x,b,S,P){let I;for(I in b=b||{},x=x||{})Object.prototype.hasOwnProperty.call(x,I)&&(Object.prototype.hasOwnProperty.call(b,I)||St(I,S,P));for(I in b)Object.prototype.hasOwnProperty.call(b,I)&&(Object.prototype.hasOwnProperty.call(x,I)?Ot(x[I],b[I])||(x[I].type==="geojson"&&b[I].type==="geojson"&&Go(x,b,I)?ln(S,{command:"setGeoJSONSourceData",args:[I,b[I].data]}):bs(I,b,S,P)):ao(I,b,S))})(s.sources,r.sources,g,c);const v=[];s.layers&&s.layers.forEach(x=>{"source"in x&&c[x.source]?o.push({command:"removeLayer",args:[x.id]}):v.push(x)}),o=o.concat(g),function(x,b,S){b=b||[];const P=(x=x||[]).map(Ka),I=b.map(Ka),R=x.reduce(Ya,{}),B=b.reduce(Ya,{}),N=P.slice(),$=Object.create(null);let q,ee,se,we,de;for(let xe=0,Pe=0;xe<P.length;xe++)q=P[xe],Object.prototype.hasOwnProperty.call(B,q)?Pe++:(ln(S,{command:"removeLayer",args:[q]}),N.splice(N.indexOf(q,Pe),1));for(let xe=0,Pe=0;xe<I.length;xe++)q=I[I.length-1-xe],N[N.length-1-xe]!==q&&(Object.prototype.hasOwnProperty.call(R,q)?(ln(S,{command:"removeLayer",args:[q]}),N.splice(N.lastIndexOf(q,N.length-Pe),1)):Pe++,we=N[N.length-xe],ln(S,{command:"addLayer",args:[B[q],we]}),N.splice(N.length-xe,0,q),$[q]=!0);for(let xe=0;xe<I.length;xe++)if(q=I[xe],ee=R[q],se=B[q],!$[q]&&!Ot(ee,se))if(Ot(ee.source,se.source)&&Ot(ee["source-layer"],se["source-layer"])&&Ot(ee.type,se.type)){for(de in ai(ee.layout,se.layout,S,q,null,"setLayoutProperty"),ai(ee.paint,se.paint,S,q,null,"setPaintProperty"),Ot(ee.filter,se.filter)||ln(S,{command:"setFilter",args:[q,se.filter]}),Ot(ee.minzoom,se.minzoom)&&Ot(ee.maxzoom,se.maxzoom)||ln(S,{command:"setLayerZoomRange",args:[q,se.minzoom,se.maxzoom]}),ee)Object.prototype.hasOwnProperty.call(ee,de)&&de!=="layout"&&de!=="paint"&&de!=="filter"&&de!=="metadata"&&de!=="minzoom"&&de!=="maxzoom"&&(de.indexOf("paint.")===0?ai(ee[de],se[de],S,q,de.slice(6),"setPaintProperty"):Ot(ee[de],se[de])||ln(S,{command:"setLayerProperty",args:[q,de,se[de]]}));for(de in se)Object.prototype.hasOwnProperty.call(se,de)&&!Object.prototype.hasOwnProperty.call(ee,de)&&de!=="layout"&&de!=="paint"&&de!=="filter"&&de!=="metadata"&&de!=="minzoom"&&de!=="maxzoom"&&(de.indexOf("paint.")===0?ai(ee[de],se[de],S,q,de.slice(6),"setPaintProperty"):Ot(ee[de],se[de])||ln(S,{command:"setLayerProperty",args:[q,de,se[de]]}))}else ln(S,{command:"removeLayer",args:[q]}),we=N[N.lastIndexOf(q)+1],ln(S,{command:"addLayer",args:[se,we]})}(v,r.layers,o)}catch(c){console.warn("Unable to compute style diff:",c),o=[{command:"setStyle",args:[r]}]}return o},m.aD=function(s){const r=[],o=s.id;return o===void 0&&r.push({message:`layers.${o}: missing required property "id"`}),s.render===void 0&&r.push({message:`layers.${o}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&r.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),r},m.aE=function s(r,o){if(Array.isArray(r)){if(!Array.isArray(o)||r.length!==o.length)return!1;for(let c=0;c<r.length;c++)if(!s(r[c],o[c]))return!1;return!0}if(typeof r=="object"&&r!==null&&o!==null){if(typeof o!="object"||Object.keys(r).length!==Object.keys(o).length)return!1;for(const c in r)if(!s(r[c],o[c]))return!1;return!0}return r===o},m.aF=Be,m.aG=Ue,m.aH=class extends _l{constructor(s,r){super(s,r),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},m.aI=hp,m.aJ=class extends _l{constructor(s,r){super(s,r),this.current=PI}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let r=1;r<16;r++)if(s[r]!==this.current[r]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},m.aK=j1,m.aL=$1,m.aM=Ht,m.aN=class extends _l{constructor(s,r){super(s,r),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},m.aO=class extends _l{constructor(s,r){super(s,r),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},m.aP=function(s,r,o,c,g,v,x){var b=1/(r-o),S=1/(c-g),P=1/(v-x);return s[0]=-2*b,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*S,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*P,s[11]=0,s[12]=(r+o)*b,s[13]=(g+c)*S,s[14]=(x+v)*P,s[15]=1,s},m.aQ=RI,m.aR=class extends me{},m.aS=CM,m.aT=class extends Te{},m.aU=Uy,m.aV=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},m.aW=rb,m.aX=lr,m.aY=Di,m.aZ=class extends at{},m.a_=function(s,r){return s[0]===r[0]&&s[1]===r[1]&&s[2]===r[2]&&s[3]===r[3]&&s[4]===r[4]&&s[5]===r[5]&&s[6]===r[6]&&s[7]===r[7]&&s[8]===r[8]&&s[9]===r[9]&&s[10]===r[10]&&s[11]===r[11]&&s[12]===r[12]&&s[13]===r[13]&&s[14]===r[14]&&s[15]===r[15]},m.aa=function(s){const r={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,c,g,v)=>{const x=g||v;return r[c]=!x||x.toLowerCase(),""}),r["max-age"]){const o=parseInt(r["max-age"],10);isNaN(o)?delete r["max-age"]:r["max-age"]=o}return r},m.ab=function(s,r){const o=[];for(const c in s)c in r||o.push(c);return o},m.ac=_e,m.ad=function(s,r,o){var c=Math.sin(o),g=Math.cos(o),v=r[0],x=r[1],b=r[2],S=r[3],P=r[4],I=r[5],R=r[6],B=r[7];return r!==s&&(s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[0]=v*g+P*c,s[1]=x*g+I*c,s[2]=b*g+R*c,s[3]=S*g+B*c,s[4]=P*g-v*c,s[5]=I*g-x*c,s[6]=R*g-b*c,s[7]=B*g-S*c,s},m.ae=function(s){var r=new Ou(16);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],r[4]=s[4],r[5]=s[5],r[6]=s[6],r[7]=s[7],r[8]=s[8],r[9]=s[9],r[10]=s[10],r[11]=s[11],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15],r},m.af=mp,m.ag=function(s,r){let o=0,c=0;if(s.kind==="constant")c=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:g,minZoom:v,maxZoom:x}=s,b=g?_e(Mr.interpolationFactor(g,r,v,x),0,1):0;s.kind==="camera"?c=Ir.number(s.minSize,s.maxSize,b):o=b}return{uSizeT:o,uSize:c}},m.ai=function(s,{uSize:r,uSizeT:o},{lowerSize:c,upperSize:g}){return s.kind==="source"?c/Us:s.kind==="composite"?Ir.number(c/Us,g/Us,o):r},m.aj=s_,m.ak=function(s,r,o,c){const g=r.y-s.y,v=r.x-s.x,x=c.y-o.y,b=c.x-o.x,S=x*v-b*g;if(S===0)return null;const P=(b*(s.y-o.y)-x*(s.x-o.x))/S;return new z(s.x+P*v,s.y+P*g)},m.al=iw,m.am=Z1,m.an=Ny,m.ao=function(s){let r=1/0,o=1/0,c=-1/0,g=-1/0;for(const v of s)r=Math.min(r,v.x),o=Math.min(o,v.y),c=Math.max(c,v.x),g=Math.max(g,v.y);return[r,o,c,g]},m.ap=jn,m.ar=i_,m.as=function(s,r){var o=r[0],c=r[1],g=r[2],v=r[3],x=r[4],b=r[5],S=r[6],P=r[7],I=r[8],R=r[9],B=r[10],N=r[11],$=r[12],q=r[13],ee=r[14],se=r[15],we=o*b-c*x,de=o*S-g*x,xe=o*P-v*x,Pe=c*S-g*b,Le=c*P-v*b,et=g*P-v*S,mt=I*q-R*$,Je=I*ee-B*$,Ke=I*se-N*$,ut=R*ee-B*q,st=R*se-N*q,rt=B*se-N*ee,Me=we*rt-de*st+xe*ut+Pe*Ke-Le*Je+et*mt;return Me?(s[0]=(b*rt-S*st+P*ut)*(Me=1/Me),s[1]=(g*st-c*rt-v*ut)*Me,s[2]=(q*et-ee*Le+se*Pe)*Me,s[3]=(B*Le-R*et-N*Pe)*Me,s[4]=(S*Ke-x*rt-P*Je)*Me,s[5]=(o*rt-g*Ke+v*Je)*Me,s[6]=(ee*xe-$*et-se*de)*Me,s[7]=(I*et-B*xe+N*de)*Me,s[8]=(x*st-b*Ke+P*mt)*Me,s[9]=(c*Ke-o*st-v*mt)*Me,s[10]=($*Le-q*xe+se*we)*Me,s[11]=(R*xe-I*Le-N*we)*Me,s[12]=(b*Je-x*ut-S*mt)*Me,s[13]=(o*ut-c*Je+g*mt)*Me,s[14]=(q*de-$*Pe-ee*we)*Me,s[15]=(I*Pe-R*de+B*we)*Me,s):null},m.at=f_,m.au=r_,m.av=p_,m.aw=function(){const s={},r=ke.$version;for(const o in ke.$root){const c=ke.$root[o];if(c.required){let g=null;g=o==="version"?r:c.type==="array"?[]:{},g!=null&&(s[o]=g)}}return s},m.ax=Mh,m.ay=qr,m.az=function(s){s=s.slice();const r=Object.create(null);for(let o=0;o<s.length;o++)r[s[o].id]=s[o];for(let o=0;o<s.length;o++)"ref"in s[o]&&(s[o]=Ci(s[o],r[s[o].ref]));return s},m.b=bt,m.b0=function(s,r){return s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[4]=r[4],s[5]=r[5],s[6]=r[6],s[7]=r[7],s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},m.b1=function(s,r,o){return s[0]=r[0]*o[0],s[1]=r[1]*o[1],s[2]=r[2]*o[2],s[3]=r[3]*o[3],s},m.b2=function(s,r){return s[0]*r[0]+s[1]*r[1]+s[2]*r[2]+s[3]*r[3]},m.b3=ye,m.b4=Yb,m.b5=Xb,m.b6=function(s,r,o,c,g){var v,x=1/Math.tan(r/2);return s[0]=x/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=x,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,g!=null&&g!==1/0?(s[10]=(g+c)*(v=1/(c-g)),s[14]=2*g*c*v):(s[10]=-1,s[14]=-2*c),s},m.b7=function(s,r,o){var c=Math.sin(o),g=Math.cos(o),v=r[4],x=r[5],b=r[6],S=r[7],P=r[8],I=r[9],R=r[10],B=r[11];return r!==s&&(s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[4]=v*g+P*c,s[5]=x*g+I*c,s[6]=b*g+R*c,s[7]=S*g+B*c,s[8]=P*g-v*c,s[9]=I*g-x*c,s[10]=R*g-b*c,s[11]=B*g-S*c,s},m.b8=X,m.b9=ae,m.bA=Sb,m.bB=function(s){return s.message===Bt},m.bC=na,m.bD=Kr,m.ba=function(s){return s*Math.PI/180},m.bb=function(s,r){const{x:o,y:c}=Kh.fromLngLat(r);return!(s<0||s>25||c<0||c>=1||o<0||o>=1)},m.bc=function(s,r){return s[0]=r[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=r[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=r[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},m.bd=class extends M{},m.be=u_,m.bf=aA,m.bh=Dn,m.bi=function(s,r){qn.REGISTERED_PROTOCOLS[s]=r},m.bj=function(s){delete qn.REGISTERED_PROTOCOLS[s]},m.bk=function(s,r){const o={};for(let g=0;g<s.length;g++){const v=r&&r[s[g].id]||Qf(s[g]);r&&(r[s[g].id]=v);let x=o[v];x||(x=o[v]=[]),x.push(s[g])}const c=[];for(const g in o)c.push(o[g]);return c},m.bl=it,m.bm=Qb,m.bn=tw,m.bo=zb,m.bp=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=Fn/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const r=s.bucket.layers[0],o=r.layout,c=r._unevaluatedLayout._values,g={layoutIconSize:c["icon-size"].possiblyEvaluate(new un(s.bucket.zoom+1),s.canonical),layoutTextSize:c["text-size"].possiblyEvaluate(new un(s.bucket.zoom+1),s.canonical),textMaxSize:c["text-size"].possiblyEvaluate(new un(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:I}=s.bucket.textSizeData;g.compositeTextSizes=[c["text-size"].possiblyEvaluate(new un(P),s.canonical),c["text-size"].possiblyEvaluate(new un(I),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:I}=s.bucket.iconSizeData;g.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new un(P),s.canonical),c["icon-size"].possiblyEvaluate(new un(I),s.canonical)]}const v=o.get("text-line-height")*jn,x=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",b=o.get("text-keep-upright"),S=o.get("text-size");for(const P of s.bucket.features){const I=o.get("text-font").evaluate(P,{},s.canonical).join(","),R=S.evaluate(P,{},s.canonical),B=g.layoutTextSize.evaluate(P,{},s.canonical),N=g.layoutIconSize.evaluate(P,{},s.canonical),$={horizontal:{},vertical:void 0},q=P.text;let ee,se=[0,0];if(q){const xe=q.toString(),Pe=o.get("text-letter-spacing").evaluate(P,{},s.canonical)*jn,Le=Iy(xe)?Pe:0,et=o.get("text-anchor").evaluate(P,{},s.canonical),mt=fw(r,P,s.canonical);if(!mt){const st=o.get("text-radial-offset").evaluate(P,{},s.canonical);se=st?dw(et,[st*jn,d_]):o.get("text-offset").evaluate(P,{},s.canonical).map(rt=>rt*jn)}let Je=x?"center":o.get("text-justify").evaluate(P,{},s.canonical);const Ke=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(P,{},s.canonical)*jn:1/0,ut=()=>{s.bucket.allowVerticalPlacement&&Ah(xe)&&($.vertical=bp(q,s.glyphMap,s.glyphPositions,s.imagePositions,I,Ke,v,et,"left",Le,se,m.ah.vertical,!0,B,R))};if(!x&&mt){const st=new Set;if(Je==="auto")for(let Me=0;Me<mt.values.length;Me+=2)st.add(f_(mt.values[Me]));else st.add(Je);let rt=!1;for(const Me of st)if(!$.horizontal[Me])if(rt)$.horizontal[Me]=$.horizontal[0];else{const ct=bp(q,s.glyphMap,s.glyphPositions,s.imagePositions,I,Ke,v,"center",Me,Le,se,m.ah.horizontal,!1,B,R);ct&&($.horizontal[Me]=ct,rt=ct.positionedLines.length===1)}ut()}else{Je==="auto"&&(Je=f_(et));const st=bp(q,s.glyphMap,s.glyphPositions,s.imagePositions,I,Ke,v,et,Je,Le,se,m.ah.horizontal,!1,B,R);st&&($.horizontal[Je]=st),ut(),Ah(xe)&&x&&b&&($.vertical=bp(q,s.glyphMap,s.glyphPositions,s.imagePositions,I,Ke,v,et,Je,Le,se,m.ah.vertical,!1,B,R))}}let we=!1;if(P.icon&&P.icon.name){const xe=s.imageMap[P.icon.name];xe&&(ee=UM(s.imagePositions[P.icon.name],o.get("icon-offset").evaluate(P,{},s.canonical),o.get("icon-anchor").evaluate(P,{},s.canonical)),we=!!xe.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=we:s.bucket.sdfIcons!==we&&je("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(xe.pixelRatio!==s.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const de=mw($.horizontal)||$.vertical;s.bucket.iconsInText=!!de&&de.iconsInText,(de||ee)&&sA(s.bucket,P,$,ee,s.imageMap,g,B,N,se,we,s.canonical)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},m.bq=Yy,m.br=Hy,m.bs=Ky,m.bt=_a,m.bu=Qy,m.bv=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},m.bw=function(s,r,o,c,g){return u(this,void 0,void 0,function*(){if(G())try{return yield tt(s,r,o,c,g)}catch{}return function(v,x,b,S,P){const I=v.width,R=v.height;gt&&Pt||(gt=new OffscreenCanvas(I,R),Pt=gt.getContext("2d",{willReadFrequently:!0})),gt.width=I,gt.height=R,Pt.drawImage(v,0,0,I,R);const B=Pt.getImageData(x,b,S,P);return Pt.clearRect(0,0,I,R),B.data}(s,r,o,c,g)})},m.bx=Jb,m.by=C,m.bz=E,m.c=Gr,m.d=s=>u(void 0,void 0,void 0,function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(r)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),m.e=Se,m.f=s=>new Promise((r,o)=>{const c=new Image;c.onload=()=>{r(c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame(()=>{c.src=Oe})},c.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const g=new Blob([new Uint8Array(s)],{type:"image/png"});c.src=s.byteLength?URL.createObjectURL(g):Oe}),m.g=ir,m.h=(s,r)=>vs(Se(s,{type:"json"}),r),m.i=ft,m.j=si,m.k=Xi,m.l=(s,r)=>vs(Se(s,{type:"arrayBuffer"}),r),m.m=vs,m.n=function(s){return new Qy(s).readFields(FM,[])},m.o=Nh,m.p=Ab,m.q=_,m.r=Py,m.s=xs,m.t=Eh,m.u=xo,m.v=ke,m.w=je,m.x=function([s,r,o]){return r+=90,r*=Math.PI/180,o*=Math.PI/180,{x:s*Math.cos(r)*Math.sin(o),y:s*Math.sin(r)*Math.sin(o),z:s*Math.cos(o)}},m.y=Ir,m.z=un}),h("worker",["./shared"],function(m){class u{constructor(V){this.keyCache={},V&&this.replace(V)}replace(V){this._layerConfigs={},this._layers={},this.update(V,[])}update(V,O){for(const ne of V){this._layerConfigs[ne.id]=ne;const fe=this._layers[ne.id]=m.aA(ne);fe._featureFilter=m.a7(fe.filter),this.keyCache[ne.id]&&delete this.keyCache[ne.id]}for(const ne of O)delete this.keyCache[ne],delete this._layerConfigs[ne],delete this._layers[ne];this.familiesBySource={};const W=m.bk(Object.values(this._layerConfigs),this.keyCache);for(const ne of W){const fe=ne.map(Ce=>this._layers[Ce.id]),ge=fe[0];if(ge.visibility==="none")continue;const be=ge.source||"";let ce=this.familiesBySource[be];ce||(ce=this.familiesBySource[be]={});const Ee=ge.sourceLayer||"_geojsonTileLayer";let Re=ce[Ee];Re||(Re=ce[Ee]=[]),Re.push(fe)}}}class C{constructor(V){const O={},W=[];for(const be in V){const ce=V[be],Ee=O[be]={};for(const Re in ce){const Ce=ce[+Re];if(!Ce||Ce.bitmap.width===0||Ce.bitmap.height===0)continue;const qe={x:0,y:0,w:Ce.bitmap.width+2,h:Ce.bitmap.height+2};W.push(qe),Ee[Re]={rect:qe,metrics:Ce.metrics}}}const{w:ne,h:fe}=m.p(W),ge=new m.o({width:ne||1,height:fe||1});for(const be in V){const ce=V[be];for(const Ee in ce){const Re=ce[+Ee];if(!Re||Re.bitmap.width===0||Re.bitmap.height===0)continue;const Ce=O[be][Ee].rect;m.o.copy(Re.bitmap,ge,{x:0,y:0},{x:Ce.x+1,y:Ce.y+1},Re.bitmap)}}this.image=ge,this.positions=O}}m.bl("GlyphAtlas",C);class E{constructor(V){this.tileID=new m.S(V.tileID.overscaledZ,V.tileID.wrap,V.tileID.canonical.z,V.tileID.canonical.x,V.tileID.canonical.y),this.uid=V.uid,this.zoom=V.zoom,this.pixelRatio=V.pixelRatio,this.tileSize=V.tileSize,this.source=V.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=V.showCollisionBoxes,this.collectResourceTiming=!!V.collectResourceTiming,this.returnDependencies=!!V.returnDependencies,this.promoteId=V.promoteId,this.inFlightDependencies=[]}parse(V,O,W,ne){return m._(this,void 0,void 0,function*(){this.status="parsing",this.data=V,this.collisionBoxArray=new m.a5;const fe=new m.bm(Object.keys(V.layers).sort()),ge=new m.bn(this.tileID,this.promoteId);ge.bucketLayerIDs=[];const be={},ce={featureIndex:ge,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:W},Ee=O.familiesBySource[this.source];for(const At in Ee){const Wt=V.layers[At];if(!Wt)continue;Wt.version===1&&m.w(`Vector tile source "${this.source}" layer "${At}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const pn=fe.encode(At),Zn=[];for(let Qn=0;Qn<Wt.length;Qn++){const _r=Wt.feature(Qn),qo=ge.getId(_r,At);Zn.push({feature:_r,id:qo,index:Qn,sourceLayerIndex:pn})}for(const Qn of Ee[At]){const _r=Qn[0];_r.source!==this.source&&m.w(`layer.source = ${_r.source} does not equal this.source = ${this.source}`),_r.minzoom&&this.zoom<Math.floor(_r.minzoom)||_r.maxzoom&&this.zoom>=_r.maxzoom||_r.visibility!=="none"&&(D(Qn,this.zoom,W),(be[_r.id]=_r.createBucket({index:ge.bucketLayerIDs.length,layers:Qn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:pn,sourceID:this.source})).populate(Zn,ce,this.tileID.canonical),ge.bucketLayerIDs.push(Qn.map(qo=>qo.id)))}}const Re=m.aF(ce.glyphDependencies,At=>Object.keys(At).map(Number));this.inFlightDependencies.forEach(At=>At==null?void 0:At.abort()),this.inFlightDependencies=[];let Ce=Promise.resolve({});if(Object.keys(Re).length){const At=new AbortController;this.inFlightDependencies.push(At),Ce=ne.sendAsync({type:"GG",data:{stacks:Re,source:this.source,tileID:this.tileID,type:"glyphs"}},At)}const qe=Object.keys(ce.iconDependencies);let ht=Promise.resolve({});if(qe.length){const At=new AbortController;this.inFlightDependencies.push(At),ht=ne.sendAsync({type:"GI",data:{icons:qe,source:this.source,tileID:this.tileID,type:"icons"}},At)}const pt=Object.keys(ce.patternDependencies);let Vt=Promise.resolve({});if(pt.length){const At=new AbortController;this.inFlightDependencies.push(At),Vt=ne.sendAsync({type:"GI",data:{icons:pt,source:this.source,tileID:this.tileID,type:"patterns"}},At)}const[kt,Nt,Dt]=yield Promise.all([Ce,ht,Vt]),Rn=new C(kt),yn=new m.bo(Nt,Dt);for(const At in be){const Wt=be[At];Wt instanceof m.a6?(D(Wt.layers,this.zoom,W),m.bp({bucket:Wt,glyphMap:kt,glyphPositions:Rn.positions,imageMap:Nt,imagePositions:yn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Wt.hasPattern&&(Wt instanceof m.bq||Wt instanceof m.br||Wt instanceof m.bs)&&(D(Wt.layers,this.zoom,W),Wt.addFeatures(ce,this.tileID.canonical,yn.patternPositions))}return this.status="done",{buckets:Object.values(be).filter(At=>!At.isEmpty()),featureIndex:ge,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Rn.image,imageAtlas:yn,glyphMap:this.returnDependencies?kt:null,iconMap:this.returnDependencies?Nt:null,glyphPositions:this.returnDependencies?Rn.positions:null}})}}function D(ie,V,O){const W=new m.z(V);for(const ne of ie)ne.recalculate(W,O)}class z{constructor(V,O,W){this.actor=V,this.layerIndex=O,this.availableImages=W,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(V,O){return m._(this,void 0,void 0,function*(){const W=yield m.l(V.request,O);try{return{vectorTile:new m.bt.VectorTile(new m.bu(W.data)),rawData:W.data,cacheControl:W.cacheControl,expires:W.expires}}catch(ne){const fe=new Uint8Array(W.data);let ge=`Unable to parse the tile at ${V.request.url}, `;throw ge+=fe[0]===31&&fe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ne.message}`,new Error(ge)}})}loadTile(V){return m._(this,void 0,void 0,function*(){const O=V.uid,W=!!(V&&V.request&&V.request.collectResourceTiming)&&new m.bv(V.request),ne=new E(V);this.loading[O]=ne;const fe=new AbortController;ne.abort=fe;try{const ge=yield this.loadVectorTile(V,fe);if(delete this.loading[O],!ge)return null;const be=ge.rawData,ce={};ge.expires&&(ce.expires=ge.expires),ge.cacheControl&&(ce.cacheControl=ge.cacheControl);const Ee={};if(W){const Ce=W.finish();Ce&&(Ee.resourceTiming=JSON.parse(JSON.stringify(Ce)))}ne.vectorTile=ge.vectorTile;const Re=ne.parse(ge.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[O]=ne,this.fetching[O]={rawTileData:be,cacheControl:ce,resourceTiming:Ee};try{const Ce=yield Re;return m.e({rawTileData:be.slice(0)},Ce,ce,Ee)}finally{delete this.fetching[O]}}catch(ge){throw delete this.loading[O],ne.status="done",this.loaded[O]=ne,ge}})}reloadTile(V){return m._(this,void 0,void 0,function*(){const O=V.uid;if(!this.loaded||!this.loaded[O])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const W=this.loaded[O];if(W.showCollisionBoxes=V.showCollisionBoxes,W.status==="parsing"){const ne=yield W.parse(W.vectorTile,this.layerIndex,this.availableImages,this.actor);let fe;if(this.fetching[O]){const{rawTileData:ge,cacheControl:be,resourceTiming:ce}=this.fetching[O];delete this.fetching[O],fe=m.e({rawTileData:ge.slice(0)},ne,be,ce)}else fe=ne;return fe}if(W.status==="done"&&W.vectorTile)return W.parse(W.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(V){return m._(this,void 0,void 0,function*(){const O=this.loading,W=V.uid;O&&O[W]&&O[W].abort&&(O[W].abort.abort(),delete O[W])})}removeTile(V){return m._(this,void 0,void 0,function*(){this.loaded&&this.loaded[V.uid]&&delete this.loaded[V.uid]})}}class A{constructor(){this.loaded={}}loadTile(V){return m._(this,void 0,void 0,function*(){const{uid:O,encoding:W,rawImageData:ne,redFactor:fe,greenFactor:ge,blueFactor:be,baseShift:ce}=V,Ee=ne.width+2,Re=ne.height+2,Ce=m.b(ne)?new m.R({width:Ee,height:Re},yield m.bw(ne,-1,-1,Ee,Re)):ne,qe=new m.bx(O,Ce,W,fe,ge,be,ce);return this.loaded=this.loaded||{},this.loaded[O]=qe,qe})}removeTile(V){const O=this.loaded,W=V.uid;O&&O[W]&&delete O[W]}}function Z(ie,V){if(ie.length!==0){Y(ie[0],V);for(var O=1;O<ie.length;O++)Y(ie[O],!V)}}function Y(ie,V){for(var O=0,W=0,ne=0,fe=ie.length,ge=fe-1;ne<fe;ge=ne++){var be=(ie[ne][0]-ie[ge][0])*(ie[ge][1]+ie[ne][1]),ce=O+be;W+=Math.abs(O)>=Math.abs(be)?O-ce+be:be-ce+O,O=ce}O+W>=0!=!!V&&ie.reverse()}var te=m.by(function ie(V,O){var W,ne=V&&V.type;if(ne==="FeatureCollection")for(W=0;W<V.features.length;W++)ie(V.features[W],O);else if(ne==="GeometryCollection")for(W=0;W<V.geometries.length;W++)ie(V.geometries[W],O);else if(ne==="Feature")ie(V.geometry,O);else if(ne==="Polygon")Z(V.coordinates,O);else if(ne==="MultiPolygon")for(W=0;W<V.coordinates.length;W++)Z(V.coordinates[W],O);return V});const pe=m.bt.VectorTileFeature.prototype.toGeoJSON;var U={exports:{}},G=m.bz,X=m.bt.VectorTileFeature,ae=_e;function _e(ie,V){this.options=V||{},this.features=ie,this.length=ie.length}function ye(ie,V){this.id=typeof ie.id=="number"?ie.id:void 0,this.type=ie.type,this.rawGeometry=ie.type===1?[ie.geometry]:ie.geometry,this.properties=ie.tags,this.extent=V||4096}_e.prototype.feature=function(ie){return new ye(this.features[ie],this.options.extent)},ye.prototype.loadGeometry=function(){var ie=this.rawGeometry;this.geometry=[];for(var V=0;V<ie.length;V++){for(var O=ie[V],W=[],ne=0;ne<O.length;ne++)W.push(new G(O[ne][0],O[ne][1]));this.geometry.push(W)}return this.geometry},ye.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ie=this.geometry,V=1/0,O=-1/0,W=1/0,ne=-1/0,fe=0;fe<ie.length;fe++)for(var ge=ie[fe],be=0;be<ge.length;be++){var ce=ge[be];V=Math.min(V,ce.x),O=Math.max(O,ce.x),W=Math.min(W,ce.y),ne=Math.max(ne,ce.y)}return[V,W,O,ne]},ye.prototype.toGeoJSON=X.prototype.toGeoJSON;var Se=m.bA,Ie=ae;function Be(ie){var V=new Se;return function(O,W){for(var ne in O.layers)W.writeMessage(3,Ue,O.layers[ne])}(ie,V),V.finish()}function Ue(ie,V){var O;V.writeVarintField(15,ie.version||1),V.writeStringField(1,ie.name||""),V.writeVarintField(5,ie.extent||4096);var W={keys:[],values:[],keycache:{},valuecache:{}};for(O=0;O<ie.length;O++)W.feature=ie.feature(O),V.writeMessage(2,Ne,W);var ne=W.keys;for(O=0;O<ne.length;O++)V.writeStringField(3,ne[O]);var fe=W.values;for(O=0;O<fe.length;O++)V.writeMessage(4,Ct,fe[O])}function Ne(ie,V){var O=ie.feature;O.id!==void 0&&V.writeVarintField(1,O.id),V.writeMessage(2,J,ie),V.writeVarintField(3,O.type),V.writeMessage(4,ft,O)}function J(ie,V){var O=ie.feature,W=ie.keys,ne=ie.values,fe=ie.keycache,ge=ie.valuecache;for(var be in O.properties){var ce=O.properties[be],Ee=fe[be];if(ce!==null){Ee===void 0&&(W.push(be),fe[be]=Ee=W.length-1),V.writeVarint(Ee);var Re=typeof ce;Re!=="string"&&Re!=="boolean"&&Re!=="number"&&(ce=JSON.stringify(ce));var Ce=Re+":"+ce,qe=ge[Ce];qe===void 0&&(ne.push(ce),ge[Ce]=qe=ne.length-1),V.writeVarint(qe)}}}function je(ie,V){return(V<<3)+(7&ie)}function Fe(ie){return ie<<1^ie>>31}function ft(ie,V){for(var O=ie.loadGeometry(),W=ie.type,ne=0,fe=0,ge=O.length,be=0;be<ge;be++){var ce=O[be],Ee=1;W===1&&(Ee=ce.length),V.writeVarint(je(1,Ee));for(var Re=W===3?ce.length-1:ce.length,Ce=0;Ce<Re;Ce++){Ce===1&&W!==1&&V.writeVarint(je(2,Re-1));var qe=ce[Ce].x-ne,ht=ce[Ce].y-fe;V.writeVarint(Fe(qe)),V.writeVarint(Fe(ht)),ne+=qe,fe+=ht}W===3&&V.writeVarint(je(7,1))}}function Ct(ie,V){var O=typeof ie;O==="string"?V.writeStringField(1,ie):O==="boolean"?V.writeBooleanField(7,ie):O==="number"&&(ie%1!=0?V.writeDoubleField(3,ie):ie<0?V.writeSVarintField(6,ie):V.writeVarintField(5,ie))}U.exports=Be,U.exports.fromVectorTileJs=Be,U.exports.fromGeojsonVt=function(ie,V){V=V||{};var O={};for(var W in ie)O[W]=new Ie(ie[W].features,V),O[W].name=W,O[W].version=V.version,O[W].extent=V.extent;return Be({layers:O})},U.exports.GeoJSONWrapper=Ie;var bt=m.by(U.exports);const Oe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ie=>ie},tt=Math.fround||(gt=new Float32Array(1),ie=>(gt[0]=+ie,gt[0]));var gt;const Pt=3,Bt=5,Gr=6;class qn{constructor(V){this.options=Object.assign(Object.create(Oe),V),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(V){const{log:O,minZoom:W,maxZoom:ne}=this.options;O&&console.time("total time");const fe=`prepare ${V.length} points`;O&&console.time(fe),this.points=V;const ge=[];for(let ce=0;ce<V.length;ce++){const Ee=V[ce];if(!Ee.geometry)continue;const[Re,Ce]=Ee.geometry.coordinates,qe=tt(Dn(Re)),ht=tt(qr(Ce));ge.push(qe,ht,1/0,ce,-1,1),this.options.reduce&&ge.push(0)}let be=this.trees[ne+1]=this._createTree(ge);O&&console.timeEnd(fe);for(let ce=ne;ce>=W;ce--){const Ee=+Date.now();be=this.trees[ce]=this._createTree(this._cluster(be,ce)),O&&console.log("z%d: %d clusters in %dms",ce,be.numItems,+Date.now()-Ee)}return O&&console.timeEnd("total time"),this}getClusters(V,O){let W=((V[0]+180)%360+360)%360-180;const ne=Math.max(-90,Math.min(90,V[1]));let fe=V[2]===180?180:((V[2]+180)%360+360)%360-180;const ge=Math.max(-90,Math.min(90,V[3]));if(V[2]-V[0]>=360)W=-180,fe=180;else if(W>fe){const Ce=this.getClusters([W,ne,180,ge],O),qe=this.getClusters([-180,ne,fe,ge],O);return Ce.concat(qe)}const be=this.trees[this._limitZoom(O)],ce=be.range(Dn(W),qr(ge),Dn(fe),qr(ne)),Ee=be.data,Re=[];for(const Ce of ce){const qe=this.stride*Ce;Re.push(Ee[qe+Bt]>1?ir(Ee,qe,this.clusterProps):this.points[Ee[qe+Pt]])}return Re}getChildren(V){const O=this._getOriginId(V),W=this._getOriginZoom(V),ne="No cluster with the specified id.",fe=this.trees[W];if(!fe)throw new Error(ne);const ge=fe.data;if(O*this.stride>=ge.length)throw new Error(ne);const be=this.options.radius/(this.options.extent*Math.pow(2,W-1)),ce=fe.within(ge[O*this.stride],ge[O*this.stride+1],be),Ee=[];for(const Re of ce){const Ce=Re*this.stride;ge[Ce+4]===V&&Ee.push(ge[Ce+Bt]>1?ir(ge,Ce,this.clusterProps):this.points[ge[Ce+Pt]])}if(Ee.length===0)throw new Error(ne);return Ee}getLeaves(V,O,W){const ne=[];return this._appendLeaves(ne,V,O=O||10,W=W||0,0),ne}getTile(V,O,W){const ne=this.trees[this._limitZoom(V)],fe=Math.pow(2,V),{extent:ge,radius:be}=this.options,ce=be/ge,Ee=(W-ce)/fe,Re=(W+1+ce)/fe,Ce={features:[]};return this._addTileFeatures(ne.range((O-ce)/fe,Ee,(O+1+ce)/fe,Re),ne.data,O,W,fe,Ce),O===0&&this._addTileFeatures(ne.range(1-ce/fe,Ee,1,Re),ne.data,fe,W,fe,Ce),O===fe-1&&this._addTileFeatures(ne.range(0,Ee,ce/fe,Re),ne.data,-1,W,fe,Ce),Ce.features.length?Ce:null}getClusterExpansionZoom(V){let O=this._getOriginZoom(V)-1;for(;O<=this.options.maxZoom;){const W=this.getChildren(V);if(O++,W.length!==1)break;V=W[0].properties.cluster_id}return O}_appendLeaves(V,O,W,ne,fe){const ge=this.getChildren(O);for(const be of ge){const ce=be.properties;if(ce&&ce.cluster?fe+ce.point_count<=ne?fe+=ce.point_count:fe=this._appendLeaves(V,ce.cluster_id,W,ne,fe):fe<ne?fe++:V.push(be),V.length===W)break}return fe}_createTree(V){const O=new m.av(V.length/this.stride|0,this.options.nodeSize,Float32Array);for(let W=0;W<V.length;W+=this.stride)O.add(V[W],V[W+1]);return O.finish(),O.data=V,O}_addTileFeatures(V,O,W,ne,fe,ge){for(const be of V){const ce=be*this.stride,Ee=O[ce+Bt]>1;let Re,Ce,qe;if(Ee)Re=sr(O,ce,this.clusterProps),Ce=O[ce],qe=O[ce+1];else{const Vt=this.points[O[ce+Pt]];Re=Vt.properties;const[kt,Nt]=Vt.geometry.coordinates;Ce=Dn(kt),qe=qr(Nt)}const ht={type:1,geometry:[[Math.round(this.options.extent*(Ce*fe-W)),Math.round(this.options.extent*(qe*fe-ne))]],tags:Re};let pt;pt=Ee||this.options.generateId?O[ce+Pt]:this.points[O[ce+Pt]].id,pt!==void 0&&(ht.id=pt),ge.features.push(ht)}}_limitZoom(V){return Math.max(this.options.minZoom,Math.min(Math.floor(+V),this.options.maxZoom+1))}_cluster(V,O){const{radius:W,extent:ne,reduce:fe,minPoints:ge}=this.options,be=W/(ne*Math.pow(2,O)),ce=V.data,Ee=[],Re=this.stride;for(let Ce=0;Ce<ce.length;Ce+=Re){if(ce[Ce+2]<=O)continue;ce[Ce+2]=O;const qe=ce[Ce],ht=ce[Ce+1],pt=V.within(ce[Ce],ce[Ce+1],be),Vt=ce[Ce+Bt];let kt=Vt;for(const Nt of pt){const Dt=Nt*Re;ce[Dt+2]>O&&(kt+=ce[Dt+Bt])}if(kt>Vt&&kt>=ge){let Nt,Dt=qe*Vt,Rn=ht*Vt,yn=-1;const At=((Ce/Re|0)<<5)+(O+1)+this.points.length;for(const Wt of pt){const pn=Wt*Re;if(ce[pn+2]<=O)continue;ce[pn+2]=O;const Zn=ce[pn+Bt];Dt+=ce[pn]*Zn,Rn+=ce[pn+1]*Zn,ce[pn+4]=At,fe&&(Nt||(Nt=this._map(ce,Ce,!0),yn=this.clusterProps.length,this.clusterProps.push(Nt)),fe(Nt,this._map(ce,pn)))}ce[Ce+4]=At,Ee.push(Dt/kt,Rn/kt,1/0,At,-1,kt),fe&&Ee.push(yn)}else{for(let Nt=0;Nt<Re;Nt++)Ee.push(ce[Ce+Nt]);if(kt>1)for(const Nt of pt){const Dt=Nt*Re;if(!(ce[Dt+2]<=O)){ce[Dt+2]=O;for(let Rn=0;Rn<Re;Rn++)Ee.push(ce[Dt+Rn])}}}}return Ee}_getOriginId(V){return V-this.points.length>>5}_getOriginZoom(V){return(V-this.points.length)%32}_map(V,O,W){if(V[O+Bt]>1){const ge=this.clusterProps[V[O+Gr]];return W?Object.assign({},ge):ge}const ne=this.points[V[O+Pt]].properties,fe=this.options.map(ne);return W&&fe===ne?Object.assign({},fe):fe}}function ir(ie,V,O){return{type:"Feature",id:ie[V+Pt],properties:sr(ie,V,O),geometry:{type:"Point",coordinates:[(W=ie[V],360*(W-.5)),vs(ie[V+1])]}};var W}function sr(ie,V,O){const W=ie[V+Bt],ne=W>=1e4?`${Math.round(W/1e3)}k`:W>=1e3?Math.round(W/100)/10+"k":W,fe=ie[V+Gr],ge=fe===-1?{}:Object.assign({},O[fe]);return Object.assign(ge,{cluster:!0,cluster_id:ie[V+Pt],point_count:W,point_count_abbreviated:ne})}function Dn(ie){return ie/360+.5}function qr(ie){const V=Math.sin(ie*Math.PI/180),O=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return O<0?0:O>1?1:O}function vs(ie){const V=(180-360*ie)*Math.PI/180;return 360*Math.atan(Math.exp(V))/Math.PI-90}function xs(ie,V,O,W){let ne=W;const fe=V+(O-V>>1);let ge,be=O-V;const ce=ie[V],Ee=ie[V+1],Re=ie[O],Ce=ie[O+1];for(let qe=V+3;qe<O;qe+=3){const ht=oo(ie[qe],ie[qe+1],ce,Ee,Re,Ce);if(ht>ne)ge=qe,ne=ht;else if(ht===ne){const pt=Math.abs(qe-fe);pt<be&&(ge=qe,be=pt)}}ne>W&&(ge-V>3&&xs(ie,V,ge,W),ie[ge+2]=ne,O-ge>3&&xs(ie,ge,O,W))}function oo(ie,V,O,W,ne,fe){let ge=ne-O,be=fe-W;if(ge!==0||be!==0){const ce=((ie-O)*ge+(V-W)*be)/(ge*ge+be*be);ce>1?(O=ne,W=fe):ce>0&&(O+=ge*ce,W+=be*ce)}return ge=ie-O,be=V-W,ge*ge+be*be}function Ti(ie,V,O,W){const ne={id:ie??null,type:V,geometry:O,tags:W,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(V==="Point"||V==="MultiPoint"||V==="LineString")Xi(ne,O);else if(V==="Polygon")Xi(ne,O[0]);else if(V==="MultiLineString")for(const fe of O)Xi(ne,fe);else if(V==="MultiPolygon")for(const fe of O)Xi(ne,fe[0]);return ne}function Xi(ie,V){for(let O=0;O<V.length;O+=3)ie.minX=Math.min(ie.minX,V[O]),ie.minY=Math.min(ie.minY,V[O+1]),ie.maxX=Math.max(ie.maxX,V[O]),ie.maxY=Math.max(ie.maxY,V[O+1])}function si(ie,V,O,W){if(!V.geometry)return;const ne=V.geometry.coordinates;if(ne&&ne.length===0)return;const fe=V.geometry.type,ge=Math.pow(O.tolerance/((1<<O.maxZoom)*O.extent),2);let be=[],ce=V.id;if(O.promoteId?ce=V.properties[O.promoteId]:O.generateId&&(ce=W||0),fe==="Point")Fs(ne,be);else if(fe==="MultiPoint")for(const Ee of ne)Fs(Ee,be);else if(fe==="LineString")ke(ne,be,ge,!1);else if(fe==="MultiLineString"){if(O.lineMetrics){for(const Ee of ne)be=[],ke(Ee,be,ge,!1),ie.push(Ti(ce,"LineString",be,V.properties));return}oi(ne,be,ge,!1)}else if(fe==="Polygon")oi(ne,be,ge,!0);else{if(fe!=="MultiPolygon"){if(fe==="GeometryCollection"){for(const Ee of V.geometry.geometries)si(ie,{id:ce,geometry:Ee,properties:V.properties},O,W);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ee of ne){const Re=[];oi(Ee,Re,ge,!0),be.push(Re)}}ie.push(Ti(ce,fe,be,V.properties))}function Fs(ie,V){V.push(Ci(ie[0]),Ot(ie[1]),0)}function ke(ie,V,O,W){let ne,fe,ge=0;for(let ce=0;ce<ie.length;ce++){const Ee=Ci(ie[ce][0]),Re=Ot(ie[ce][1]);V.push(Ee,Re,0),ce>0&&(ge+=W?(ne*Re-Ee*fe)/2:Math.sqrt(Math.pow(Ee-ne,2)+Math.pow(Re-fe,2))),ne=Ee,fe=Re}const be=V.length-3;V[2]=1,xs(V,0,be,O),V[be+2]=1,V.size=Math.abs(ge),V.start=0,V.end=V.size}function oi(ie,V,O,W){for(let ne=0;ne<ie.length;ne++){const fe=[];ke(ie[ne],fe,O,W),V.push(fe)}}function Ci(ie){return ie/360+.5}function Ot(ie){const V=Math.sin(ie*Math.PI/180),O=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return O<0?0:O>1?1:O}function ln(ie,V,O,W,ne,fe,ge,be){if(W/=V,fe>=(O/=V)&&ge<W)return ie;if(ge<O||fe>=W)return null;const ce=[];for(const Ee of ie){const Re=Ee.geometry;let Ce=Ee.type;const qe=ne===0?Ee.minX:Ee.minY,ht=ne===0?Ee.maxX:Ee.maxY;if(qe>=O&&ht<W){ce.push(Ee);continue}if(ht<O||qe>=W)continue;let pt=[];if(Ce==="Point"||Ce==="MultiPoint")ao(Re,pt,O,W,ne);else if(Ce==="LineString")St(Re,pt,O,W,ne,!1,be.lineMetrics);else if(Ce==="MultiLineString")Go(Re,pt,O,W,ne,!1);else if(Ce==="Polygon")Go(Re,pt,O,W,ne,!0);else if(Ce==="MultiPolygon")for(const Vt of Re){const kt=[];Go(Vt,kt,O,W,ne,!0),kt.length&&pt.push(kt)}if(pt.length){if(be.lineMetrics&&Ce==="LineString"){for(const Vt of pt)ce.push(Ti(Ee.id,Ce,Vt,Ee.tags));continue}Ce!=="LineString"&&Ce!=="MultiLineString"||(pt.length===1?(Ce="LineString",pt=pt[0]):Ce="MultiLineString"),Ce!=="Point"&&Ce!=="MultiPoint"||(Ce=pt.length===3?"Point":"MultiPoint"),ce.push(Ti(Ee.id,Ce,pt,Ee.tags))}}return ce.length?ce:null}function ao(ie,V,O,W,ne){for(let fe=0;fe<ie.length;fe+=3){const ge=ie[fe+ne];ge>=O&&ge<=W&&ai(V,ie[fe],ie[fe+1],ie[fe+2])}}function St(ie,V,O,W,ne,fe,ge){let be=bs(ie);const ce=ne===0?Ka:Ya;let Ee,Re,Ce=ie.start;for(let kt=0;kt<ie.length-3;kt+=3){const Nt=ie[kt],Dt=ie[kt+1],Rn=ie[kt+2],yn=ie[kt+3],At=ie[kt+4],Wt=ne===0?Nt:Dt,pn=ne===0?yn:At;let Zn=!1;ge&&(Ee=Math.sqrt(Math.pow(Nt-yn,2)+Math.pow(Dt-At,2))),Wt<O?pn>O&&(Re=ce(be,Nt,Dt,yn,At,O),ge&&(be.start=Ce+Ee*Re)):Wt>W?pn<W&&(Re=ce(be,Nt,Dt,yn,At,W),ge&&(be.start=Ce+Ee*Re)):ai(be,Nt,Dt,Rn),pn<O&&Wt>=O&&(Re=ce(be,Nt,Dt,yn,At,O),Zn=!0),pn>W&&Wt<=W&&(Re=ce(be,Nt,Dt,yn,At,W),Zn=!0),!fe&&Zn&&(ge&&(be.end=Ce+Ee*Re),V.push(be),be=bs(ie)),ge&&(Ce+=Ee)}let qe=ie.length-3;const ht=ie[qe],pt=ie[qe+1],Vt=ne===0?ht:pt;Vt>=O&&Vt<=W&&ai(be,ht,pt,ie[qe+2]),qe=be.length-3,fe&&qe>=3&&(be[qe]!==be[0]||be[qe+1]!==be[1])&&ai(be,be[0],be[1],be[2]),be.length&&V.push(be)}function bs(ie){const V=[];return V.size=ie.size,V.start=ie.start,V.end=ie.end,V}function Go(ie,V,O,W,ne,fe){for(const ge of ie)St(ge,V,O,W,ne,fe,!1)}function ai(ie,V,O,W){ie.push(V,O,W)}function Ka(ie,V,O,W,ne,fe){const ge=(fe-V)/(W-V);return ai(ie,fe,O+(ne-O)*ge,1),ge}function Ya(ie,V,O,W,ne,fe){const ge=(fe-O)/(ne-O);return ai(ie,V+(W-V)*ge,fe,1),ge}function $e(ie,V){const O=[];for(let W=0;W<ie.length;W++){const ne=ie[W],fe=ne.type;let ge;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")ge=Ki(ne.geometry,V);else if(fe==="MultiLineString"||fe==="Polygon"){ge=[];for(const be of ne.geometry)ge.push(Ki(be,V))}else if(fe==="MultiPolygon"){ge=[];for(const be of ne.geometry){const ce=[];for(const Ee of be)ce.push(Ki(Ee,V));ge.push(ce)}}O.push(Ti(ne.id,fe,ge,ne.tags))}return O}function Ki(ie,V){const O=[];O.size=ie.size,ie.start!==void 0&&(O.start=ie.start,O.end=ie.end);for(let W=0;W<ie.length;W+=3)O.push(ie[W]+V,ie[W+1],ie[W+2]);return O}function yr(ie,V){if(ie.transformed)return ie;const O=1<<ie.z,W=ie.x,ne=ie.y;for(const fe of ie.features){const ge=fe.geometry,be=fe.type;if(fe.geometry=[],be===1)for(let ce=0;ce<ge.length;ce+=2)fe.geometry.push(Yi(ge[ce],ge[ce+1],V,O,W,ne));else for(let ce=0;ce<ge.length;ce++){const Ee=[];for(let Re=0;Re<ge[ce].length;Re+=2)Ee.push(Yi(ge[ce][Re],ge[ce][Re+1],V,O,W,ne));fe.geometry.push(Ee)}}return ie.transformed=!0,ie}function Yi(ie,V,O,W,ne,fe){return[Math.round(O*(ie*W-ne)),Math.round(O*(V*W-fe))]}function Bs(ie,V,O,W,ne){const fe=V===ne.maxZoom?0:ne.tolerance/((1<<V)*ne.extent),ge={features:[],numPoints:0,numSimplified:0,numFeatures:ie.length,source:null,x:O,y:W,z:V,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const be of ie)He(ge,be,fe,ne);return ge}function He(ie,V,O,W){const ne=V.geometry,fe=V.type,ge=[];if(ie.minX=Math.min(ie.minX,V.minX),ie.minY=Math.min(ie.minY,V.minY),ie.maxX=Math.max(ie.maxX,V.maxX),ie.maxY=Math.max(ie.maxY,V.maxY),fe==="Point"||fe==="MultiPoint")for(let be=0;be<ne.length;be+=3)ge.push(ne[be],ne[be+1]),ie.numPoints++,ie.numSimplified++;else if(fe==="LineString")Mt(ge,ne,ie,O,!1,!1);else if(fe==="MultiLineString"||fe==="Polygon")for(let be=0;be<ne.length;be++)Mt(ge,ne[be],ie,O,fe==="Polygon",be===0);else if(fe==="MultiPolygon")for(let be=0;be<ne.length;be++){const ce=ne[be];for(let Ee=0;Ee<ce.length;Ee++)Mt(ge,ce[Ee],ie,O,!0,Ee===0)}if(ge.length){let be=V.tags||null;if(fe==="LineString"&&W.lineMetrics){be={};for(const Ee in V.tags)be[Ee]=V.tags[Ee];be.mapbox_clip_start=ne.start/ne.size,be.mapbox_clip_end=ne.end/ne.size}const ce={geometry:ge,type:fe==="Polygon"||fe==="MultiPolygon"?3:fe==="LineString"||fe==="MultiLineString"?2:1,tags:be};V.id!==null&&(ce.id=V.id),ie.features.push(ce)}}function Mt(ie,V,O,W,ne,fe){const ge=W*W;if(W>0&&V.size<(ne?ge:W))return void(O.numPoints+=V.length/3);const be=[];for(let ce=0;ce<V.length;ce+=3)(W===0||V[ce+2]>ge)&&(O.numSimplified++,be.push(V[ce],V[ce+1])),O.numPoints++;ne&&function(ce,Ee){let Re=0;for(let Ce=0,qe=ce.length,ht=qe-2;Ce<qe;ht=Ce,Ce+=2)Re+=(ce[Ce]-ce[ht])*(ce[Ce+1]+ce[ht+1]);if(Re>0===Ee)for(let Ce=0,qe=ce.length;Ce<qe/2;Ce+=2){const ht=ce[Ce],pt=ce[Ce+1];ce[Ce]=ce[qe-2-Ce],ce[Ce+1]=ce[qe-1-Ce],ce[qe-2-Ce]=ht,ce[qe-1-Ce]=pt}}(be,fe),ie.push(be)}const _t={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Er{constructor(V,O){const W=(O=this.options=function(fe,ge){for(const be in ge)fe[be]=ge[be];return fe}(Object.create(_t),O)).debug;if(W&&console.time("preprocess data"),O.maxZoom<0||O.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(O.promoteId&&O.generateId)throw new Error("promoteId and generateId cannot be used together.");let ne=function(fe,ge){const be=[];if(fe.type==="FeatureCollection")for(let ce=0;ce<fe.features.length;ce++)si(be,fe.features[ce],ge,ce);else si(be,fe.type==="Feature"?fe:{geometry:fe},ge);return be}(V,O);this.tiles={},this.tileCoords=[],W&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",O.indexMaxZoom,O.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ne=function(fe,ge){const be=ge.buffer/ge.extent;let ce=fe;const Ee=ln(fe,1,-1-be,be,0,-1,2,ge),Re=ln(fe,1,1-be,2+be,0,-1,2,ge);return(Ee||Re)&&(ce=ln(fe,1,-be,1+be,0,-1,2,ge)||[],Ee&&(ce=$e(Ee,1).concat(ce)),Re&&(ce=ce.concat($e(Re,-1)))),ce}(ne,O),ne.length&&this.splitTile(ne,0,0,0),W&&(ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(V,O,W,ne,fe,ge,be){const ce=[V,O,W,ne],Ee=this.options,Re=Ee.debug;for(;ce.length;){ne=ce.pop(),W=ce.pop(),O=ce.pop(),V=ce.pop();const Ce=1<<O,qe=ki(O,W,ne);let ht=this.tiles[qe];if(!ht&&(Re>1&&console.time("creation"),ht=this.tiles[qe]=Bs(V,O,W,ne,Ee),this.tileCoords.push({z:O,x:W,y:ne}),Re)){Re>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",O,W,ne,ht.numFeatures,ht.numPoints,ht.numSimplified),console.timeEnd("creation"));const Zn=`z${O}`;this.stats[Zn]=(this.stats[Zn]||0)+1,this.total++}if(ht.source=V,fe==null){if(O===Ee.indexMaxZoom||ht.numPoints<=Ee.indexMaxPoints)continue}else{if(O===Ee.maxZoom||O===fe)continue;if(fe!=null){const Zn=fe-O;if(W!==ge>>Zn||ne!==be>>Zn)continue}}if(ht.source=null,V.length===0)continue;Re>1&&console.time("clipping");const pt=.5*Ee.buffer/Ee.extent,Vt=.5-pt,kt=.5+pt,Nt=1+pt;let Dt=null,Rn=null,yn=null,At=null,Wt=ln(V,Ce,W-pt,W+kt,0,ht.minX,ht.maxX,Ee),pn=ln(V,Ce,W+Vt,W+Nt,0,ht.minX,ht.maxX,Ee);V=null,Wt&&(Dt=ln(Wt,Ce,ne-pt,ne+kt,1,ht.minY,ht.maxY,Ee),Rn=ln(Wt,Ce,ne+Vt,ne+Nt,1,ht.minY,ht.maxY,Ee),Wt=null),pn&&(yn=ln(pn,Ce,ne-pt,ne+kt,1,ht.minY,ht.maxY,Ee),At=ln(pn,Ce,ne+Vt,ne+Nt,1,ht.minY,ht.maxY,Ee),pn=null),Re>1&&console.timeEnd("clipping"),ce.push(Dt||[],O+1,2*W,2*ne),ce.push(Rn||[],O+1,2*W,2*ne+1),ce.push(yn||[],O+1,2*W+1,2*ne),ce.push(At||[],O+1,2*W+1,2*ne+1)}}getTile(V,O,W){V=+V,O=+O,W=+W;const ne=this.options,{extent:fe,debug:ge}=ne;if(V<0||V>24)return null;const be=1<<V,ce=ki(V,O=O+be&be-1,W);if(this.tiles[ce])return yr(this.tiles[ce],fe);ge>1&&console.log("drilling down to z%d-%d-%d",V,O,W);let Ee,Re=V,Ce=O,qe=W;for(;!Ee&&Re>0;)Re--,Ce>>=1,qe>>=1,Ee=this.tiles[ki(Re,Ce,qe)];return Ee&&Ee.source?(ge>1&&(console.log("found parent tile z%d-%d-%d",Re,Ce,qe),console.time("drilling down")),this.splitTile(Ee.source,Re,Ce,qe,V,O,W),ge>1&&console.timeEnd("drilling down"),this.tiles[ce]?yr(this.tiles[ce],fe):null):null}}function ki(ie,V,O){return 32*((1<<ie)*O+V)+ie}function Tt(ie,V){return V?ie.properties[V]:ie.id}function Ji(ie,V){if(ie==null)return!0;if(ie.type==="Feature")return Tt(ie,V)!=null;if(ie.type==="FeatureCollection"){const O=new Set;for(const W of ie.features){const ne=Tt(W,V);if(ne==null||O.has(ne))return!1;O.add(ne)}return!0}return!1}function ws(ie,V){const O=new Map;if(ie!=null)if(ie.type==="Feature")O.set(Tt(ie,V),ie);else for(const W of ie.features)O.set(Tt(W,V),W);return O}class Os extends z{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(V,O){return m._(this,void 0,void 0,function*(){const W=V.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ne=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!ne)return null;const fe=new class{constructor(be){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=m.X,this.length=be.length,this._features=be}feature(be){return new class{constructor(ce){this._feature=ce,this.extent=m.X,this.type=ce.type,this.properties=ce.tags,"id"in ce&&!isNaN(ce.id)&&(this.id=parseInt(ce.id,10))}loadGeometry(){if(this._feature.type===1){const ce=[];for(const Ee of this._feature.geometry)ce.push([new m.P(Ee[0],Ee[1])]);return ce}{const ce=[];for(const Ee of this._feature.geometry){const Re=[];for(const Ce of Ee)Re.push(new m.P(Ce[0],Ce[1]));ce.push(Re)}return ce}}toGeoJSON(ce,Ee,Re){return pe.call(this,ce,Ee,Re)}}(this._features[be])}}(ne.features);let ge=bt(fe);return ge.byteOffset===0&&ge.byteLength===ge.buffer.byteLength||(ge=new Uint8Array(ge)),{vectorTile:fe,rawData:ge.buffer}})}loadData(V){return m._(this,void 0,void 0,function*(){var O;(O=this._pendingRequest)===null||O===void 0||O.abort();const W=!!(V&&V.request&&V.request.collectResourceTiming)&&new m.bv(V.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(V,this._pendingRequest),this._geoJSONIndex=V.cluster?new qn(function({superclusterOptions:ge,clusterProperties:be}){if(!be||!ge)return ge;const ce={},Ee={},Re={accumulated:null,zoom:0},Ce={properties:null},qe=Object.keys(be);for(const ht of qe){const[pt,Vt]=be[ht],kt=m.bC(Vt),Nt=m.bC(typeof pt=="string"?[pt,["accumulated"],["get",ht]]:pt);ce[ht]=kt.value,Ee[ht]=Nt.value}return ge.map=ht=>{Ce.properties=ht;const pt={};for(const Vt of qe)pt[Vt]=ce[Vt].evaluate(Re,Ce);return pt},ge.reduce=(ht,pt)=>{Ce.properties=pt;for(const Vt of qe)Re.accumulated=ht[Vt],ht[Vt]=Ee[Vt].evaluate(Re,Ce)},ge}(V)).load((yield this._pendingData).features):(ne=yield this._pendingData,new Er(ne,V.geojsonVtOptions)),this.loaded={};const fe={};if(W){const ge=W.finish();ge&&(fe.resourceTiming={},fe.resourceTiming[V.source]=JSON.parse(JSON.stringify(ge)))}return fe}catch(fe){if(delete this._pendingRequest,m.bB(fe))return{abandoned:!0};throw fe}var ne})}getData(){return m._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(V){const O=this.loaded;return O&&O[V.uid]?super.reloadTile(V):this.loadTile(V)}loadAndProcessGeoJSON(V,O){return m._(this,void 0,void 0,function*(){let W=yield this.loadGeoJSON(V,O);if(delete this._pendingRequest,typeof W!="object")throw new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`);if(te(W,!0),V.filter){const ne=m.bC(V.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ne.result==="error")throw new Error(ne.value.map(ge=>`${ge.key}: ${ge.message}`).join(", "));W={type:"FeatureCollection",features:W.features.filter(ge=>ne.value.evaluate({zoom:0},ge))}}return W})}loadGeoJSON(V,O){return m._(this,void 0,void 0,function*(){const{promoteId:W}=V;if(V.request){const ne=yield m.h(V.request,O);return this._dataUpdateable=Ji(ne.data,W)?ws(ne.data,W):void 0,ne.data}if(typeof V.data=="string")try{const ne=JSON.parse(V.data);return this._dataUpdateable=Ji(ne,W)?ws(ne,W):void 0,ne}catch{throw new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`)}if(!V.dataDiff)throw new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${V.source}`);return function(ne,fe,ge){var be,ce,Ee,Re;if(fe.removeAll&&ne.clear(),fe.remove)for(const Ce of fe.remove)ne.delete(Ce);if(fe.add)for(const Ce of fe.add){const qe=Tt(Ce,ge);qe!=null&&ne.set(qe,Ce)}if(fe.update)for(const Ce of fe.update){let qe=ne.get(Ce.id);if(qe==null)continue;const ht=!Ce.removeAllProperties&&(((be=Ce.removeProperties)===null||be===void 0?void 0:be.length)>0||((ce=Ce.addOrUpdateProperties)===null||ce===void 0?void 0:ce.length)>0);if((Ce.newGeometry||Ce.removeAllProperties||ht)&&(qe=Object.assign({},qe),ne.set(Ce.id,qe),ht&&(qe.properties=Object.assign({},qe.properties))),Ce.newGeometry&&(qe.geometry=Ce.newGeometry),Ce.removeAllProperties)qe.properties={};else if(((Ee=Ce.removeProperties)===null||Ee===void 0?void 0:Ee.length)>0)for(const pt of Ce.removeProperties)Object.prototype.hasOwnProperty.call(qe.properties,pt)&&delete qe.properties[pt];if(((Re=Ce.addOrUpdateProperties)===null||Re===void 0?void 0:Re.length)>0)for(const{key:pt,value:Vt}of Ce.addOrUpdateProperties)qe.properties[pt]=Vt}}(this._dataUpdateable,V.dataDiff,W),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(V){return m._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(V){return this._geoJSONIndex.getClusterExpansionZoom(V.clusterId)}getClusterChildren(V){return this._geoJSONIndex.getChildren(V.clusterId)}getClusterLeaves(V){return this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset)}}class Qi{constructor(V){this.self=V,this.actor=new m.F(V),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(O,W)=>{if(this.externalWorkerSourceTypes[O])throw new Error(`Worker source with name "${O}" already registered.`);this.externalWorkerSourceTypes[O]=W},this.self.addProtocol=m.bi,this.self.removeProtocol=m.bj,this.self.registerRTLTextPlugin=O=>{if(m.bD.isParsed())throw new Error("RTL text plugin already registered.");m.bD.setMethods(O)},this.actor.registerMessageHandler("LDT",(O,W)=>this._getDEMWorkerSource(O,W.source).loadTile(W)),this.actor.registerMessageHandler("RDT",(O,W)=>m._(this,void 0,void 0,function*(){this._getDEMWorkerSource(O,W.source).removeTile(W)})),this.actor.registerMessageHandler("GCEZ",(O,W)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(O,W.type,W.source).getClusterExpansionZoom(W)})),this.actor.registerMessageHandler("GCC",(O,W)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(O,W.type,W.source).getClusterChildren(W)})),this.actor.registerMessageHandler("GCL",(O,W)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(O,W.type,W.source).getClusterLeaves(W)})),this.actor.registerMessageHandler("LD",(O,W)=>this._getWorkerSource(O,W.type,W.source).loadData(W)),this.actor.registerMessageHandler("GD",(O,W)=>this._getWorkerSource(O,W.type,W.source).getData()),this.actor.registerMessageHandler("LT",(O,W)=>this._getWorkerSource(O,W.type,W.source).loadTile(W)),this.actor.registerMessageHandler("RT",(O,W)=>this._getWorkerSource(O,W.type,W.source).reloadTile(W)),this.actor.registerMessageHandler("AT",(O,W)=>this._getWorkerSource(O,W.type,W.source).abortTile(W)),this.actor.registerMessageHandler("RMT",(O,W)=>this._getWorkerSource(O,W.type,W.source).removeTile(W)),this.actor.registerMessageHandler("RS",(O,W)=>m._(this,void 0,void 0,function*(){if(!this.workerSources[O]||!this.workerSources[O][W.type]||!this.workerSources[O][W.type][W.source])return;const ne=this.workerSources[O][W.type][W.source];delete this.workerSources[O][W.type][W.source],ne.removeSource!==void 0&&ne.removeSource(W)})),this.actor.registerMessageHandler("RM",O=>m._(this,void 0,void 0,function*(){delete this.layerIndexes[O],delete this.availableImages[O],delete this.workerSources[O],delete this.demWorkerSources[O]})),this.actor.registerMessageHandler("SR",(O,W)=>m._(this,void 0,void 0,function*(){this.referrer=W})),this.actor.registerMessageHandler("SRPS",(O,W)=>this._syncRTLPluginState(O,W)),this.actor.registerMessageHandler("IS",(O,W)=>m._(this,void 0,void 0,function*(){this.self.importScripts(W)})),this.actor.registerMessageHandler("SI",(O,W)=>this._setImages(O,W)),this.actor.registerMessageHandler("UL",(O,W)=>m._(this,void 0,void 0,function*(){this._getLayerIndex(O).update(W.layers,W.removedIds)})),this.actor.registerMessageHandler("SL",(O,W)=>m._(this,void 0,void 0,function*(){this._getLayerIndex(O).replace(W)}))}_setImages(V,O){return m._(this,void 0,void 0,function*(){this.availableImages[V]=O;for(const W in this.workerSources[V]){const ne=this.workerSources[V][W];for(const fe in ne)ne[fe].availableImages=O}})}_syncRTLPluginState(V,O){return m._(this,void 0,void 0,function*(){if(m.bD.isParsed())return m.bD.getState();if(O.pluginStatus!=="loading")return m.bD.setState(O),O;const W=O.pluginURL;if(this.self.importScripts(W),m.bD.isParsed()){const ne={pluginStatus:"loaded",pluginURL:W};return m.bD.setState(ne),ne}throw m.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${W}`)})}_getAvailableImages(V){let O=this.availableImages[V];return O||(O=[]),O}_getLayerIndex(V){let O=this.layerIndexes[V];return O||(O=this.layerIndexes[V]=new u),O}_getWorkerSource(V,O,W){if(this.workerSources[V]||(this.workerSources[V]={}),this.workerSources[V][O]||(this.workerSources[V][O]={}),!this.workerSources[V][O][W]){const ne={sendAsync:(fe,ge)=>(fe.targetMapId=V,this.actor.sendAsync(fe,ge))};switch(O){case"vector":this.workerSources[V][O][W]=new z(ne,this._getLayerIndex(V),this._getAvailableImages(V));break;case"geojson":this.workerSources[V][O][W]=new Os(ne,this._getLayerIndex(V),this._getAvailableImages(V));break;default:this.workerSources[V][O][W]=new this.externalWorkerSourceTypes[O](ne,this._getLayerIndex(V),this._getAvailableImages(V))}}return this.workerSources[V][O][W]}_getDEMWorkerSource(V,O){return this.demWorkerSources[V]||(this.demWorkerSources[V]={}),this.demWorkerSources[V][O]||(this.demWorkerSources[V][O]=new A),this.demWorkerSources[V][O]}}return m.i(self)&&(self.worker=new Qi(self)),Qi}),h("index",["exports","./shared"],function(m,u){var C="4.7.1";let E,D;const z={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:_=>new Promise((n,l)=>{const d=requestAnimationFrame(n);_.signal.addEventListener("abort",()=>{cancelAnimationFrame(d),l(u.c())})}),getImageData(_,n=0){return this.getImageCanvasContext(_).getImageData(-n,-n,_.width+2*n,_.height+2*n)},getImageCanvasContext(_){const n=window.document.createElement("canvas"),l=n.getContext("2d",{willReadFrequently:!0});if(!l)throw new Error("failed to create canvas 2d context");return n.width=_.width,n.height=_.height,l.drawImage(_,0,0,_.width,_.height),l},resolveURL:_=>(E||(E=document.createElement("a")),E.href=_,E.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(D==null&&(D=matchMedia("(prefers-reduced-motion: reduce)")),D.matches)}};class A{static testProp(n){if(!A.docStyle)return n[0];for(let l=0;l<n.length;l++)if(n[l]in A.docStyle)return n[l];return n[0]}static create(n,l,d){const f=window.document.createElement(n);return l!==void 0&&(f.className=l),d&&d.appendChild(f),f}static createNS(n,l){return window.document.createElementNS(n,l)}static disableDrag(){A.docStyle&&A.selectProp&&(A.userSelect=A.docStyle[A.selectProp],A.docStyle[A.selectProp]="none")}static enableDrag(){A.docStyle&&A.selectProp&&(A.docStyle[A.selectProp]=A.userSelect)}static setTransform(n,l){n.style[A.transformProp]=l}static addEventListener(n,l,d,f={}){n.addEventListener(l,d,"passive"in f?f:f.capture)}static removeEventListener(n,l,d,f={}){n.removeEventListener(l,d,"passive"in f?f:f.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",A.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",A.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",A.suppressClickInternal,!0)},0)}static getScale(n){const l=n.getBoundingClientRect();return{x:l.width/n.offsetWidth||1,y:l.height/n.offsetHeight||1,boundingClientRect:l}}static getPoint(n,l,d){const f=l.boundingClientRect;return new u.P((d.clientX-f.left)/l.x-n.clientLeft,(d.clientY-f.top)/l.y-n.clientTop)}static mousePos(n,l){const d=A.getScale(n);return A.getPoint(n,d,l)}static touchPos(n,l){const d=[],f=A.getScale(n);for(let y=0;y<l.length;y++)d.push(A.getPoint(n,f,l[y]));return d}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}}A.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,A.selectProp=A.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),A.transformProp=A.testProp(["transform","WebkitTransform"]);const Z={supported:!1,testSupport:function(_){!pe&&te&&(U?G(_):Y=_)}};let Y,te,pe=!1,U=!1;function G(_){const n=_.createTexture();_.bindTexture(_.TEXTURE_2D,n);try{if(_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,te),_.isContextLost())return;Z.supported=!0}catch{}_.deleteTexture(n),pe=!0}var X;typeof document<"u"&&(te=document.createElement("img"),te.onload=()=>{Y&&G(Y),Y=null,U=!0},te.onerror=()=>{pe=!0,Y=null},te.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(_){let n,l,d,f;_.resetRequestQueue=()=>{n=[],l=0,d=0,f={}},_.addThrottleControl=k=>{const M=d++;return f[M]=k,M},_.removeThrottleControl=k=>{delete f[k],w()},_.getImage=(k,M,L=!0)=>new Promise((F,j)=>{Z.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*"),u.e(k,{type:"image"}),n.push({abortController:M,requestParameters:k,supportImageRefresh:L,state:"queued",onError:H=>{j(H)},onSuccess:H=>{F(H)}}),w()});const y=k=>u._(this,void 0,void 0,function*(){k.state="running";const{requestParameters:M,supportImageRefresh:L,onError:F,onSuccess:j,abortController:H}=k,K=L===!1&&!u.i(self)&&!u.g(M.url)&&(!M.headers||Object.keys(M.headers).reduce((ue,he)=>ue&&he==="accept",!0));l++;const re=K?T(M,H):u.m(M,H);try{const ue=yield re;delete k.abortController,k.state="completed",ue.data instanceof HTMLImageElement||u.b(ue.data)?j(ue):ue.data&&j({data:yield(oe=ue.data,typeof createImageBitmap=="function"?u.d(oe):u.f(oe)),cacheControl:ue.cacheControl,expires:ue.expires})}catch(ue){delete k.abortController,F(ue)}finally{l--,w()}var oe}),w=()=>{const k=(()=>{for(const M of Object.keys(f))if(f[M]())return!0;return!1})()?u.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let M=l;M<k&&n.length>0;M++){const L=n.shift();L.abortController.signal.aborted?M--:y(L)}},T=(k,M)=>new Promise((L,F)=>{const j=new Image,H=k.url,K=k.credentials;K&&K==="include"?j.crossOrigin="use-credentials":(K&&K==="same-origin"||!u.s(H))&&(j.crossOrigin="anonymous"),M.signal.addEventListener("abort",()=>{j.src="",F(u.c())}),j.fetchPriority="high",j.onload=()=>{j.onerror=j.onload=null,L({data:j})},j.onerror=()=>{j.onerror=j.onload=null,M.signal.aborted||F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},j.src=H})}(X||(X={})),X.resetRequestQueue();class ae{constructor(n){this._transformRequestFn=n}transformRequest(n,l){return this._transformRequestFn&&this._transformRequestFn(n,l)||{url:n}}setTransformRequest(n){this._transformRequestFn=n}}function _e(_){var n=new u.A(3);return n[0]=_[0],n[1]=_[1],n[2]=_[2],n}var ye,Se=function(_,n,l){return _[0]=n[0]-l[0],_[1]=n[1]-l[1],_[2]=n[2]-l[2],_};ye=new u.A(3),u.A!=Float32Array&&(ye[0]=0,ye[1]=0,ye[2]=0);var Ie=function(_){var n=_[0],l=_[1];return n*n+l*l};function Be(_){const n=[];if(typeof _=="string")n.push({id:"default",url:_});else if(_&&_.length>0){const l=[];for(const{id:d,url:f}of _){const y=`${d}${f}`;l.indexOf(y)===-1&&(l.push(y),n.push({id:d,url:f}))}}return n}function Ue(_,n,l){const d=_.split("?");return d[0]+=`${n}${l}`,d.join("?")}(function(){var _=new u.A(2);u.A!=Float32Array&&(_[0]=0,_[1]=0)})();class Ne{constructor(n,l,d,f){this.context=n,this.format=d,this.texture=n.gl.createTexture(),this.update(l,f)}update(n,l,d){const{width:f,height:y}=n,w=!(this.size&&this.size[0]===f&&this.size[1]===y||d),{context:T}=this,{gl:k}=T;if(this.useMipmap=!!(l&&l.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!l||l.premultiply!==!1)),w)this.size=[f,y],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||u.b(n)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,n):k.texImage2D(k.TEXTURE_2D,0,this.format,f,y,0,this.format,k.UNSIGNED_BYTE,n.data);else{const{x:M,y:L}=d||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||u.b(n)?k.texSubImage2D(k.TEXTURE_2D,0,M,L,k.RGBA,k.UNSIGNED_BYTE,n):k.texSubImage2D(k.TEXTURE_2D,0,M,L,f,y,k.RGBA,k.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(n,l,d){const{context:f}=this,{gl:y}=f;y.bindTexture(y.TEXTURE_2D,this.texture),d!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=y.LINEAR),n!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,n),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,d||n),this.filter=n),l!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,l),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}function J(_){const{userImage:n}=_;return!!(n&&n.render&&n.render())&&(_.data.replace(new Uint8Array(n.data.buffer)),!0)}class je extends u.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:l,promiseResolve:d}of this.requestors)d(this._getImagesForIds(l));this.requestors=[]}}getImage(n){const l=this.images[n];if(l&&!l.data&&l.spriteData){const d=l.spriteData;l.data=new u.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),l.spriteData=null}return l}addImage(n,l){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,l)&&(this.images[n]=l)}_validate(n,l){let d=!0;const f=l.data||l.spriteData;return this._validateStretch(l.stretchX,f&&f.width)||(this.fire(new u.j(new Error(`Image "${n}" has invalid "stretchX" value`))),d=!1),this._validateStretch(l.stretchY,f&&f.height)||(this.fire(new u.j(new Error(`Image "${n}" has invalid "stretchY" value`))),d=!1),this._validateContent(l.content,l)||(this.fire(new u.j(new Error(`Image "${n}" has invalid "content" value`))),d=!1),d}_validateStretch(n,l){if(!n)return!0;let d=0;for(const f of n){if(f[0]<d||f[1]<f[0]||l<f[1])return!1;d=f[1]}return!0}_validateContent(n,l){if(!n)return!0;if(n.length!==4)return!1;const d=l.spriteData,f=d&&d.width||l.data.width,y=d&&d.height||l.data.height;return!(n[0]<0||f<n[0]||n[1]<0||y<n[1]||n[2]<0||f<n[2]||n[3]<0||y<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,l,d=!0){const f=this.getImage(n);if(d&&(f.data.width!==l.data.width||f.data.height!==l.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${l.data.width}x${l.data.height}).`);l.version=f.version+1,this.images[n]=l,this.updatedImages[n]=!0}removeImage(n){const l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise((l,d)=>{let f=!0;if(!this.isLoaded())for(const y of n)this.images[y]||(f=!1);this.isLoaded()||f?l(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:l})})}_getImagesForIds(n){const l={};for(const d of n){let f=this.getImage(d);f||(this.fire(new u.k("styleimagemissing",{id:d})),f=this.getImage(d)),f?l[d]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:u.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return l}getPixelSize(){const{width:n,height:l}=this.atlasImage;return{width:n,height:l}}getPattern(n){const l=this.patterns[n],d=this.getImage(n);if(!d)return null;if(l&&l.position.version===d.version)return l.position;if(l)l.position.version=d.version;else{const f={w:d.data.width+2,h:d.data.height+2,x:0,y:0},y=new u.I(f,d);this.patterns[n]={bin:f,position:y}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ne(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const y in this.patterns)n.push(this.patterns[y].bin);const{w:l,h:d}=u.p(n),f=this.atlasImage;f.resize({width:l||1,height:d||1});for(const y in this.patterns){const{bin:w}=this.patterns[y],T=w.x+1,k=w.y+1,M=this.getImage(y).data,L=M.width,F=M.height;u.R.copy(M,f,{x:0,y:0},{x:T,y:k},{width:L,height:F}),u.R.copy(M,f,{x:0,y:F-1},{x:T,y:k-1},{width:L,height:1}),u.R.copy(M,f,{x:0,y:0},{x:T,y:k+F},{width:L,height:1}),u.R.copy(M,f,{x:L-1,y:0},{x:T-1,y:k},{width:1,height:F}),u.R.copy(M,f,{x:0,y:0},{x:T+L,y:k},{width:1,height:F})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const l of n){if(this.callbackDispatchedThisFrame[l])continue;this.callbackDispatchedThisFrame[l]=!0;const d=this.getImage(l);d||u.w(`Image with ID: "${l}" was not found`),J(d)&&this.updateImage(l,d)}}}const Fe=1e20;function ft(_,n,l,d,f,y,w,T,k){for(let M=n;M<n+d;M++)Ct(_,l*y+M,y,f,w,T,k);for(let M=l;M<l+f;M++)Ct(_,M*y+n,1,d,w,T,k)}function Ct(_,n,l,d,f,y,w){y[0]=0,w[0]=-Fe,w[1]=Fe,f[0]=_[n];for(let T=1,k=0,M=0;T<d;T++){f[T]=_[n+T*l];const L=T*T;do{const F=y[k];M=(f[T]-f[F]+L-F*F)/(T-F)/2}while(M<=w[k]&&--k>-1);k++,y[k]=T,w[k]=M,w[k+1]=Fe}for(let T=0,k=0;T<d;T++){for(;w[k+1]<T;)k++;const M=y[k],L=T-M;_[n+T*l]=f[M]+L*L}}class bt{constructor(n,l){this.requestManager=n,this.localIdeographFontFamily=l,this.entries={}}setURL(n){this.url=n}getGlyphs(n){return u._(this,void 0,void 0,function*(){const l=[];for(const y in n)for(const w of n[y])l.push(this._getAndCacheGlyphsPromise(y,w));const d=yield Promise.all(l),f={};for(const{stack:y,id:w,glyph:T}of d)f[y]||(f[y]={}),f[y][w]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics};return f})}_getAndCacheGlyphsPromise(n,l){return u._(this,void 0,void 0,function*(){let d=this.entries[n];d||(d=this.entries[n]={glyphs:{},requests:{},ranges:{}});let f=d.glyphs[l];if(f!==void 0)return{stack:n,id:l,glyph:f};if(f=this._tinySDF(d,n,l),f)return d.glyphs[l]=f,{stack:n,id:l,glyph:f};const y=Math.floor(l/256);if(256*y>65535)throw new Error("glyphs > 65535 not supported");if(d.ranges[y])return{stack:n,id:l,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!d.requests[y]){const T=bt.loadGlyphRange(n,y,this.url,this.requestManager);d.requests[y]=T}const w=yield d.requests[y];for(const T in w)this._doesCharSupportLocalGlyph(+T)||(d.glyphs[+T]=w[+T]);return d.ranges[y]=!0,{stack:n,id:l,glyph:w[l]||null}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(n))}_tinySDF(n,l,d){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(d))return;let y=n.tinySDF;if(!y){let T="400";/bold/i.test(l)?T="900":/medium/i.test(l)?T="500":/light/i.test(l)&&(T="200"),y=n.tinySDF=new bt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:T})}const w=y.draw(String.fromCharCode(d));return{id:d,bitmap:new u.o({width:w.width||60,height:w.height||60},w.data),metrics:{width:w.glyphWidth/2||24,height:w.glyphHeight/2||24,left:w.glyphLeft/2+.5||0,top:w.glyphTop/2-27.5||-8,advance:w.glyphAdvance/2||24,isDoubleResolution:!0}}}}bt.loadGlyphRange=function(_,n,l,d){return u._(this,void 0,void 0,function*(){const f=256*n,y=f+255,w=d.transformRequest(l.replace("{fontstack}",_).replace("{range}",`${f}-${y}`),"Glyphs"),T=yield u.l(w,new AbortController);if(!T||!T.data)throw new Error(`Could not load glyph range. range: ${n}, ${f}-${y}`);const k={};for(const M of u.n(T.data))k[M.id]=M;return k})},bt.TinySDF=class{constructor({fontSize:_=24,buffer:n=3,radius:l=8,cutoff:d=.25,fontFamily:f="sans-serif",fontWeight:y="normal",fontStyle:w="normal"}={}){this.buffer=n,this.cutoff=d,this.radius=l;const T=this.size=_+4*n,k=this._createCanvas(T),M=this.ctx=k.getContext("2d",{willReadFrequently:!0});M.font=`${w} ${y} ${_}px ${f}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(_){const n=document.createElement("canvas");return n.width=n.height=_,n}draw(_){const{width:n,actualBoundingBoxAscent:l,actualBoundingBoxDescent:d,actualBoundingBoxLeft:f,actualBoundingBoxRight:y}=this.ctx.measureText(_),w=Math.ceil(l),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-f))),k=Math.min(this.size-this.buffer,w+Math.ceil(d)),M=T+2*this.buffer,L=k+2*this.buffer,F=Math.max(M*L,0),j=new Uint8ClampedArray(F),H={data:j,width:M,height:L,glyphWidth:T,glyphHeight:k,glyphTop:w,glyphLeft:0,glyphAdvance:n};if(T===0||k===0)return H;const{ctx:K,buffer:re,gridInner:oe,gridOuter:ue}=this;K.clearRect(re,re,T,k),K.fillText(_,re,re+w);const he=K.getImageData(re,re,T,k);ue.fill(Fe,0,F),oe.fill(0,0,F);for(let Q=0;Q<k;Q++)for(let me=0;me<T;me++){const ve=he.data[4*(Q*T+me)+3]/255;if(ve===0)continue;const Te=(Q+re)*M+me+re;if(ve===1)ue[Te]=0,oe[Te]=Fe;else{const ze=.5-ve;ue[Te]=ze>0?ze*ze:0,oe[Te]=ze<0?ze*ze:0}}ft(ue,0,0,M,L,M,this.f,this.v,this.z),ft(oe,re,re,T,k,M,this.f,this.v,this.z);for(let Q=0;Q<F;Q++){const me=Math.sqrt(ue[Q])-Math.sqrt(oe[Q]);j[Q]=Math.round(255-255*(me/this.radius+this.cutoff))}return H}};class Oe{constructor(){this.specification=u.v.light.position}possiblyEvaluate(n,l){return u.x(n.expression.evaluate(l))}interpolate(n,l,d){return{x:u.y.number(n.x,l.x,d),y:u.y.number(n.y,l.y,d),z:u.y.number(n.z,l.z,d)}}}let tt;class gt extends u.E{constructor(n){super(),tt=tt||new u.q({anchor:new u.D(u.v.light.anchor),position:new Oe,color:new u.D(u.v.light.color),intensity:new u.D(u.v.light.intensity)}),this._transitionable=new u.T(tt),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,l={}){if(!this._validate(u.r,n,l))for(const d in n){const f=n[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),f):this._transitionable.setValue(d,f)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,d){return(!d||d.validate!==!1)&&u.t(this,n.call(u.u,{value:l,style:{glyphs:!0,sprite:!0},styleSpec:u.v}))}}const Pt=new u.q({"sky-color":new u.D(u.v.sky["sky-color"]),"horizon-color":new u.D(u.v.sky["horizon-color"]),"fog-color":new u.D(u.v.sky["fog-color"]),"fog-ground-blend":new u.D(u.v.sky["fog-ground-blend"]),"horizon-fog-blend":new u.D(u.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new u.D(u.v.sky["sky-horizon-blend"]),"atmosphere-blend":new u.D(u.v.sky["atmosphere-blend"])});class Bt extends u.E{constructor(n){super(),this._transitionable=new u.T(Pt),this.setSky(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.z(0))}setSky(n,l={}){if(!this._validate(u.B,n,l)){n||(n={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const d in n){const f=n[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),f):this._transitionable.setValue(d,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,d={}){return(d==null?void 0:d.validate)!==!1&&u.t(this,n.call(u.u,u.e({value:l,style:{glyphs:!0,sprite:!0},styleSpec:u.v})))}calculateFogBlendOpacity(n){return n<60?0:n<70?(n-60)/10:1}}class Gr{constructor(n,l){this.width=n,this.height=l,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,l){const d=n.join(",")+String(l);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(n,l)),this.dashEntry[d]}getDashRanges(n,l,d){const f=[];let y=n.length%2==1?-n[n.length-1]*d:0,w=n[0]*d,T=!0;f.push({left:y,right:w,isDash:T,zeroLength:n[0]===0});let k=n[0];for(let M=1;M<n.length;M++){T=!T;const L=n[M];y=k*d,k+=L,w=k*d,f.push({left:y,right:w,isDash:T,zeroLength:L===0})}return f}addRoundDash(n,l,d){const f=l/2;for(let y=-d;y<=d;y++){const w=this.width*(this.nextRow+d+y);let T=0,k=n[T];for(let M=0;M<this.width;M++){M/k.right>1&&(k=n[++T]);const L=Math.abs(M-k.left),F=Math.abs(M-k.right),j=Math.min(L,F);let H;const K=y/d*(f+1);if(k.isDash){const re=f-Math.abs(K);H=Math.sqrt(j*j+re*re)}else H=f-Math.sqrt(j*j+K*K);this.data[w+M]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(n){for(let T=n.length-1;T>=0;--T){const k=n[T],M=n[T+1];k.zeroLength?n.splice(T,1):M&&M.isDash===k.isDash&&(M.left=k.left,n.splice(T,1))}const l=n[0],d=n[n.length-1];l.isDash===d.isDash&&(l.left=d.left-this.width,d.right=l.right+this.width);const f=this.width*this.nextRow;let y=0,w=n[y];for(let T=0;T<this.width;T++){T/w.right>1&&(w=n[++y]);const k=Math.abs(T-w.left),M=Math.abs(T-w.right),L=Math.min(k,M);this.data[f+T]=Math.max(0,Math.min(255,(w.isDash?L:-L)+128))}}addDash(n,l){const d=l?7:0,f=2*d+1;if(this.nextRow+f>this.height)return u.w("LineAtlas out of space"),null;let y=0;for(let T=0;T<n.length;T++)y+=n[T];if(y!==0){const T=this.width/y,k=this.getDashRanges(n,this.width,T);l?this.addRoundDash(k,T,d):this.addRegularDash(k)}const w={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:y};return this.nextRow+=f,this.dirty=!0,w}bind(n){const l=n.gl;this.texture?(l.bindTexture(l.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,l.texSubImage2D(l.TEXTURE_2D,0,0,0,this.width,this.height,l.ALPHA,l.UNSIGNED_BYTE,this.data))):(this.texture=l.createTexture(),l.bindTexture(l.TEXTURE_2D,this.texture),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texImage2D(l.TEXTURE_2D,0,l.ALPHA,this.width,this.height,0,l.ALPHA,l.UNSIGNED_BYTE,this.data))}}const qn="maplibre_preloaded_worker_pool";class ir{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<ir.workerCount;)this.workers.push(new Worker(u.a.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[qn]}numActive(){return Object.keys(this.active).length}}const sr=Math.floor(z.hardwareConcurrency/2);let Dn,qr;function vs(){return Dn||(Dn=new ir),Dn}ir.workerCount=u.C(globalThis)?Math.max(Math.min(sr,3),1):1;class xs{constructor(n,l){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=l;const d=this.workerPool.acquire(l);for(let f=0;f<d.length;f++){const y=new u.F(d[f],l);y.name=`Worker ${f}`,this.actors.push(y)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,l){const d=[];for(const f of this.actors)d.push(f.sendAsync({type:n,data:l}));return Promise.all(d)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach(l=>{l.remove()}),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,l){for(const d of this.actors)d.registerMessageHandler(n,l)}}function oo(){return qr||(qr=new xs(vs(),u.G),qr.registerMessageHandler("GR",(_,n,l)=>u.m(n,l))),qr}function Ti(_,n){const l=u.H();return u.J(l,l,[1,1,0]),u.K(l,l,[.5*_.width,.5*_.height,1]),u.L(l,l,_.calculatePosMatrix(n.toUnwrapped()))}function Xi(_,n,l,d,f,y){const w=function(F,j,H){if(F)for(const K of F){const re=j[K];if(re&&re.source===H&&re.type==="fill-extrusion")return!0}else for(const K in j){const re=j[K];if(re.source===H&&re.type==="fill-extrusion")return!0}return!1}(f&&f.layers,n,_.id),T=y.maxPitchScaleFactor(),k=_.tilesIn(d,T,w);k.sort(si);const M=[];for(const F of k)M.push({wrappedTileID:F.tileID.wrapped().key,queryResults:F.tile.queryRenderedFeatures(n,l,_._state,F.queryGeometry,F.cameraQueryGeometry,F.scale,f,y,T,Ti(_.transform,F.tileID))});const L=function(F){const j={},H={};for(const K of F){const re=K.queryResults,oe=K.wrappedTileID,ue=H[oe]=H[oe]||{};for(const he in re){const Q=re[he],me=ue[he]=ue[he]||{},ve=j[he]=j[he]||[];for(const Te of Q)me[Te.featureIndex]||(me[Te.featureIndex]=!0,ve.push(Te))}}return j}(M);for(const F in L)L[F].forEach(j=>{const H=j.feature,K=_.getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=K});return L}function si(_,n){const l=_.tileID,d=n.tileID;return l.overscaledZ-d.overscaledZ||l.canonical.y-d.canonical.y||l.wrap-d.wrap||l.canonical.x-d.canonical.x}function Fs(_,n,l){return u._(this,void 0,void 0,function*(){let d=_;if(_.url?d=(yield u.h(n.transformRequest(_.url,"Source"),l)).data:yield z.frameAsync(l),!d)return null;const f=u.M(u.e(d,_),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in d&&d.vector_layers&&(f.vectorLayerIds=d.vector_layers.map(y=>y.id)),f})}class ke{constructor(n,l){n&&(l?this.setSouthWest(n).setNorthEast(l):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof u.N?new u.N(n.lng,n.lat):u.N.convert(n),this}setSouthWest(n){return this._sw=n instanceof u.N?new u.N(n.lng,n.lat):u.N.convert(n),this}extend(n){const l=this._sw,d=this._ne;let f,y;if(n instanceof u.N)f=n,y=n;else{if(!(n instanceof ke))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(ke.convert(n)):this.extend(u.N.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(u.N.convert(n)):this;if(f=n._sw,y=n._ne,!f||!y)return this}return l||d?(l.lng=Math.min(f.lng,l.lng),l.lat=Math.min(f.lat,l.lat),d.lng=Math.max(y.lng,d.lng),d.lat=Math.max(y.lat,d.lat)):(this._sw=new u.N(f.lng,f.lat),this._ne=new u.N(y.lng,y.lat)),this}getCenter(){return new u.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.N(this.getWest(),this.getNorth())}getSouthEast(){return new u.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:l,lat:d}=u.N.convert(n);let f=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&f}static convert(n){return n instanceof ke?n:n&&new ke(n)}static fromLngLat(n,l=0){const d=360*l/40075017,f=d/Math.cos(Math.PI/180*n.lat);return new ke(new u.N(n.lng-f,n.lat-d),new u.N(n.lng+f,n.lat+d))}adjustAntiMeridian(){const n=new u.N(this._sw.lng,this._sw.lat),l=new u.N(this._ne.lng,this._ne.lat);return new ke(n,n.lng>l.lng?new u.N(l.lng+360,l.lat):l)}}class oi{constructor(n,l,d){this.bounds=ke.convert(this.validateBounds(n)),this.minzoom=l||0,this.maxzoom=d||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const l=Math.pow(2,n.z),d=Math.floor(u.O(this.bounds.getWest())*l),f=Math.floor(u.Q(this.bounds.getNorth())*l),y=Math.ceil(u.O(this.bounds.getEast())*l),w=Math.ceil(u.Q(this.bounds.getSouth())*l);return n.x>=d&&n.x<y&&n.y>=f&&n.y<w}}class Ci extends u.E{constructor(n,l,d,f){if(super(),this.id=n,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.e(this,u.M(l,["url","scheme","tileSize","promoteId"])),this._options=u.e({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield Fs(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n&&(u.e(this,n),n.bounds&&(this.tileBounds=new oi(n.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new u.j(n))}})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return u.e({},this._options)}loadTile(n){return u._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(l,"Tile"),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};d.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise((y,w)=>{n.reloadPromise={resolve:y,reject:w}})}else n.actor=this.dispatcher.getActor(),f="LT";n.abortController=new AbortController;try{const y=yield n.actor.sendAsync({type:f,data:d},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,y)}catch(y){if(delete n.abortController,n.aborted)return;if(y&&y.status!==404)throw y;this._afterTileLoadWorkerResponse(n,null)}})}_afterTileLoadWorkerResponse(n,l){if(l&&l.resourceTiming&&(n.resourceTiming=l.resourceTiming),l&&this.map._refreshExpiredTiles&&n.setExpiryData(l),n.loadVectorData(l,this.map.painter),n.reloadPromise){const d=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(d.resolve).catch(d.reject)}}abortTile(n){return u._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"AT",data:{uid:n.uid,type:this.type,source:this.id}}))})}unloadTile(n){return u._(this,void 0,void 0,function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ot extends u.E{constructor(n,l,d,f){super(),this.id=n,this.dispatcher=d,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.e({type:"raster"},l),u.e(this,u.M(l,["url","scheme","tileSize"]))}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield Fs(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(u.e(this,n),n.bounds&&(this.tileBounds=new oi(n.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new u.j(n))}})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}serialize(){return u.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return u._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{const d=yield X.getImage(this.map._requestManager.transformRequest(l,"Tile"),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(d&&d.data){this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&n.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const f=this.map.painter.context,y=f.gl,w=d.data;n.texture=this.map.painter.getTileTexture(w.width),n.texture?n.texture.update(w,{useMipmap:!0}):(n.texture=new Ne(f,w,y.RGBA,{useMipmap:!0}),n.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST)),n.state="loaded"}}catch(d){if(delete n.abortController,n.aborted)n.state="unloaded";else if(d)throw n.state="errored",d}})}abortTile(n){return u._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)})}unloadTile(n){return u._(this,void 0,void 0,function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)})}hasTransition(){return!1}}class ln extends Ot{constructor(n,l,d,f){super(n,l,d,f),this.type="raster-dem",this.maxzoom=22,this._options=u.e({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox",this.redFactor=l.redFactor,this.greenFactor=l.greenFactor,this.blueFactor=l.blueFactor,this.baseShift=l.baseShift}loadTile(n){return u._(this,void 0,void 0,function*(){const l=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(l,"Tile");n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{const f=yield X.getImage(d,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(f&&f.data){const y=f.data;this.map._refreshExpiredTiles&&f.cacheControl&&f.expires&&n.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const w=u.b(y)&&u.U()?y:yield this.readImageNow(y),T={type:this.type,uid:n.uid,source:this.id,rawImageData:w,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();const k=yield n.actor.sendAsync({type:"LDT",data:T});n.dem=k,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(f){if(delete n.abortController,n.aborted)n.state="unloaded";else if(f)throw n.state="errored",f}})}readImageNow(n){return u._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&u.V()){const l=n.width+2,d=n.height+2;try{return new u.R({width:l,height:d},yield u.W(n,-1,-1,l,d))}catch{}}return z.getImageData(n,1)})}_getNeighboringTiles(n){const l=n.canonical,d=Math.pow(2,l.z),f=(l.x-1+d)%d,y=l.x===0?n.wrap-1:n.wrap,w=(l.x+1+d)%d,T=l.x+1===d?n.wrap+1:n.wrap,k={};return k[new u.S(n.overscaledZ,y,l.z,f,l.y).key]={backfilled:!1},k[new u.S(n.overscaledZ,T,l.z,w,l.y).key]={backfilled:!1},l.y>0&&(k[new u.S(n.overscaledZ,y,l.z,f,l.y-1).key]={backfilled:!1},k[new u.S(n.overscaledZ,n.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},k[new u.S(n.overscaledZ,T,l.z,w,l.y-1).key]={backfilled:!1}),l.y+1<d&&(k[new u.S(n.overscaledZ,y,l.z,f,l.y+1).key]={backfilled:!1},k[new u.S(n.overscaledZ,n.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},k[new u.S(n.overscaledZ,T,l.z,w,l.y+1).key]={backfilled:!1}),k}unloadTile(n){return u._(this,void 0,void 0,function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"RDT",data:{type:this.type,uid:n.uid,source:this.id}}))})}}class ao extends u.E{constructor(n,l,d,f){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=d.getActor(),this.setEventedParent(f),this._data=l.data,this._options=u.e({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const y=u.X/this.tileSize;l.clusterMaxZoom!==void 0&&this.maxzoom<=l.clusterMaxZoom&&u.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${l.clusterMaxZoom}".`),this.workerOptions=u.e({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*y,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*y,extent:u.X,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:u.X,radius:(l.clusterRadius||50)*y,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return u._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData(),this}updateData(n){return this._updateWorkerData(n),this}getData(){return u._(this,void 0,void 0,function*(){const n=u.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:n})})}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=n.clusterRadius),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=n.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,l,d){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:n,limit:l,offset:d}})}_updateWorkerData(n){return u._(this,void 0,void 0,function*(){const l=u.e({type:this.type},this.workerOptions);n?l.dataDiff=n:typeof this._data=="string"?(l.request=this.map._requestManager.transformRequest(z.resolveURL(this._data),"Source"),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new u.k("dataloading",{dataType:"source"}));try{const d=yield this.actor.sendAsync({type:"LD",data:l});if(this._pendingLoads--,this._removed||d.abandoned)return void this.fire(new u.k("dataabort",{dataType:"source"}));let f=null;d.resourceTiming&&d.resourceTiming[this.id]&&(f=d.resourceTiming[this.id].slice(0));const y={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&u.e(y,{resourceTiming:f}),this.fire(new u.k("data",Object.assign(Object.assign({},y),{sourceDataType:"metadata"}))),this.fire(new u.k("data",Object.assign(Object.assign({},y),{sourceDataType:"content"})))}catch(d){if(this._pendingLoads--,this._removed)return void this.fire(new u.k("dataabort",{dataType:"source"}));this.fire(new u.j(d))}})}loaded(){return this._pendingLoads===0}loadTile(n){return u._(this,void 0,void 0,function*(){const l=n.actor?"RT":"LT";n.actor=this.actor;const d={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.abortController=new AbortController;const f=yield this.actor.sendAsync({type:l,data:d},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(f,this.map.painter,l==="RT")})}abortTile(n){return u._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0})}unloadTile(n){return u._(this,void 0,void 0,function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return u.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var St=u.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class bs extends u.E{constructor(n,l,d,f){super(),this.id=n,this.dispatcher=d,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=l}load(n){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const l=yield X.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,l&&l.data&&(this.image=l.data,n&&(this.coordinates=n),this._finishLoading())}catch(l){this._request=null,this._loaded=!0,this.fire(new u.j(l))}})}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;const l=n.map(u.Z.fromLngLat);this.tileID=function(f){let y=1/0,w=1/0,T=-1/0,k=-1/0;for(const j of f)y=Math.min(y,j.x),w=Math.min(w,j.y),T=Math.max(T,j.x),k=Math.max(k,j.y);const M=Math.max(T-y,k-w),L=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),F=Math.pow(2,L);return new u.a1(L,Math.floor((y+T)/2*F),Math.floor((w+k)/2*F))}(l),this.minzoom=this.maxzoom=this.tileID.z;const d=l.map(f=>this.tileID.getTilePoint(f)._round());return this._boundsArray=new u.$,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,u.X,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,u.X),this._boundsArray.emplaceBack(d[2].x,d[2].y,u.X,u.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,l=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,St.members)),this.boundsSegments||(this.boundsSegments=u.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ne(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let d=!1;for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,d=!0)}d&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return u._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Go extends bs{constructor(n,l,d,f){super(n,l,d,f),this.roundZoom=!0,this.type="video",this.options=l}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1;const n=this.options;this.urls=[];for(const l of n.urls)this.urls.push(this.map._requestManager.transformRequest(l,"Source").url);try{const l=yield u.a3(this.urls);if(this._loaded=!0,!l)return;this.video=l,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(l){this.fire(new u.j(l))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const l=this.video.seekable;n<l.start(0)||n>l.end(0)?this.fire(new u.j(new u.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,l=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,St.members)),this.boundsSegments||(this.boundsSegments=u.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new Ne(n,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let d=!1;for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,d=!0)}d&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ai extends bs{constructor(n,l,d,f){super(n,l,d,f),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(w=>typeof w!="number"))||this.fire(new u.j(new u.a2(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.j(new u.a2(`sources.${n}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new u.j(new u.a2(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof HTMLCanvasElement||this.fire(new u.j(new u.a2(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.j(new u.a2(`sources.${n}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}load(){return u._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const l=this.map.painter.context,d=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,St.members)),this.boundsSegments||(this.boundsSegments=u.a0.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ne(l,this.canvas,d.RGBA,{premultiply:!0});let f=!1;for(const y in this.tiles){const w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,f=!0)}f&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const Ka={},Ya=_=>{switch(_){case"geojson":return ao;case"image":return bs;case"raster":return Ot;case"raster-dem":return ln;case"vector":return Ci;case"video":return Go;case"canvas":return ai}return Ka[_]},$e="RTLPluginLoaded";class Ki extends u.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=oo()}_syncState(n){return this.status=n,this.dispatcher.broadcast("SRPS",{pluginStatus:n,pluginURL:this.url}).catch(l=>{throw this.status="error",l})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return u._(this,arguments,void 0,function*(l,d=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=z.resolveURL(l),!this.url)throw new Error(`requested url ${l} is invalid`);if(this.status==="unavailable"){if(!d)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return u._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new u.k($e))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let yr=null;function Yi(){return yr||(yr=new Ki),yr}class Bs{constructor(n,l){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=u.a4(),this.uses=0,this.tileSize=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const l=n+this.timeAdded;l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,l,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(f,y){const w={};if(!y)return w;for(const T of f){const k=T.layerIds.map(M=>y.getLayer(M)).filter(Boolean);if(k.length!==0){T.layers=k,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(M=>k.filter(L=>L.id===M)[0]));for(const M of k)w[M.id]=T}}return w}(n.buckets,l.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const y=this.buckets[f];if(y instanceof u.a6){if(this.hasSymbolBuckets=!0,!d)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const y=this.buckets[f];if(y instanceof u.a6&&y.hasRTLText){this.hasRTLText=!0,Yi().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const y=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(f).queryRadius(y))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new u.a5}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const d in this.buckets){const f=this.buckets[d];f.uploadPending()&&f.upload(n)}const l=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ne(n,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ne(n,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,l,d,f,y,w,T,k,M,L){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:y,scale:w,tileSize:this.tileSize,pixelPosMatrix:L,transform:k,params:T,queryPadding:this.queryPadding*M},n,l,d):{}}querySourceFeatures(n,l){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const f=d.loadVTLayers(),y=l&&l.sourceLayer?l.sourceLayer:"",w=f._geojsonTileLayer||f[y];if(!w)return;const T=u.a7(l&&l.filter),{z:k,x:M,y:L}=this.tileID.canonical,F={z:k,x:M,y:L};for(let j=0;j<w.length;j++){const H=w.feature(j);if(T.needGeometry){const oe=u.a8(H,!0);if(!T.filter(new u.z(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!T.filter(new u.z(this.tileID.overscaledZ),H))continue;const K=d.getId(H,y),re=new u.a9(H,k,M,L,K);re.tile=F,n.push(re)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const l=this.expirationTime;if(n.cacheControl){const d=u.aa(n.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const d=Date.now();let f=!1;if(this.expirationTime>d)f=!1;else if(l)if(this.expirationTime<l)f=!0;else{const y=this.expirationTime-l;y?this.expirationTime=d+Math.max(y,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!l.style.hasLayer(f))continue;const y=this.buckets[f],w=y.layers[0].sourceLayer||"_geojsonTileLayer",T=d[w],k=n[w];if(!T||!k||Object.keys(k).length===0)continue;y.update(k,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const M=l&&l.style&&l.style.getLayer(f);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<z.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=z.now()+n}setDependencies(n,l){const d={};for(const f of l)d[f]=!0;this.dependencies[n]=d}hasDependency(n,l){for(const d of n){const f=this.dependencies[d];if(f){for(const y of l)if(f[y])return!0}}return!1}}class He{constructor(n,l){this.max=n,this.onRemove=l,this.reset()}reset(){for(const n in this.data)for(const l of this.data[n])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(n,l,d){const f=n.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const y={value:l,timeout:void 0};if(d!==void 0&&(y.timeout=setTimeout(()=>{this.remove(n,y)},d)),this.data[f].push(y),this.order.push(f),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const l=this.data[n].shift();return l.timeout&&clearTimeout(l.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),l.value}getByKey(n){const l=this.data[n];return l?l[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,l){if(!this.has(n))return this;const d=n.wrapped().key,f=l===void 0?0:this.data[d].indexOf(l),y=this.data[d][f];return this.data[d].splice(f,1),y.timeout&&clearTimeout(y.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(y.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(n){const l=[];for(const d in this.data)for(const f of this.data[d])n(f.value)||l.push(f);for(const d of l)this.remove(d.value.tileID,d)}}class Mt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,l,d){const f=String(l);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][f]=this.stateChanges[n][f]||{},u.e(this.stateChanges[n][f],d),this.deletedStates[n]===null){this.deletedStates[n]={};for(const y in this.state[n])y!==f&&(this.deletedStates[n][y]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][f]===null){this.deletedStates[n][f]={};for(const y in this.state[n][f])d[y]||(this.deletedStates[n][f][y]=null)}else for(const y in d)this.deletedStates[n]&&this.deletedStates[n][f]&&this.deletedStates[n][f][y]===null&&delete this.deletedStates[n][f][y]}removeFeatureState(n,l,d){if(this.deletedStates[n]===null)return;const f=String(l);if(this.deletedStates[n]=this.deletedStates[n]||{},d&&l!==void 0)this.deletedStates[n][f]!==null&&(this.deletedStates[n][f]=this.deletedStates[n][f]||{},this.deletedStates[n][f][d]=null);else if(l!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][f])for(d in this.deletedStates[n][f]={},this.stateChanges[n][f])this.deletedStates[n][f][d]=null;else this.deletedStates[n][f]=null;else this.deletedStates[n]=null}getState(n,l){const d=String(l),f=u.e({},(this.state[n]||{})[d],(this.stateChanges[n]||{})[d]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const y=this.deletedStates[n][l];if(y===null)return{};for(const w in y)delete f[w]}return f}initializeTileState(n,l){n.setFeatureState(this.state,l)}coalesceChanges(n,l){const d={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const y={};for(const w in this.stateChanges[f])this.state[f][w]||(this.state[f][w]={}),u.e(this.state[f][w],this.stateChanges[f][w]),y[w]=this.state[f][w];d[f]=y}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const y={};if(this.deletedStates[f]===null)for(const w in this.state[f])y[w]={},this.state[f][w]={};else for(const w in this.deletedStates[f]){if(this.deletedStates[f][w]===null)this.state[f][w]={};else for(const T of Object.keys(this.deletedStates[f][w]))delete this.state[f][w][T];y[w]=this.state[f][w]}d[f]=d[f]||{},u.e(d[f],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const f in n)n[f].setFeatureState(d,l)}}class _t extends u.E{constructor(n,l,d){super(),this.id=n,this.dispatcher=d,this.on("data",f=>this._dataHandler(f)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,y,w,T)=>{const k=new(Ya(y.type))(f,y,w,T);if(k.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${k.id}`);return k})(n,l,d,this),this._tiles={},this._cache=new He(0,f=>this._unloadTile(f)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Mt,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,l,d){return u._(this,void 0,void 0,function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,l,d)}catch(f){n.state="errored",f.status!==404?this._source.fire(new u.j(f,{tile:n})):this.update(this.transform,this.terrain)}})}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new u.k("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const d=this._tiles[l];d.upload(n),d.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(Er).map(n=>n.key)}getRenderableIds(n){const l=[];for(const d in this._tiles)this._isIdRenderable(d,n)&&l.push(this._tiles[d]);return n?l.sort((d,f)=>{const y=d.tileID,w=f.tileID,T=new u.P(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),k=new u.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-w.overscaledZ||k.y-T.y||k.x-T.x}).map(d=>d.tileID.key):l.map(d=>d.tileID).sort(Er).map(d=>d.key)}hasRenderableParent(n){const l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")}}_reloadTile(n,l){return u._(this,void 0,void 0,function*(){const d=this._tiles[n];d&&(d.state!=="loading"&&(d.state=l),yield this._loadTile(d,n,l))})}_tileLoaded(n,l,d){n.timeAdded=z.now(),d==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new u.k("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const l=this.getRenderableIds();for(let f=0;f<l.length;f++){const y=l[f];if(n.neighboringTiles&&n.neighboringTiles[y]){const w=this.getTileByID(y);d(n,w),d(w,n)}}function d(f,y){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let w=y.tileID.canonical.x-f.tileID.canonical.x;const T=y.tileID.canonical.y-f.tileID.canonical.y,k=Math.pow(2,f.tileID.canonical.z),M=y.tileID.key;w===0&&T===0||Math.abs(T)>1||(Math.abs(w)>1&&(Math.abs(w+k)===1?w+=k:Math.abs(w-k)===1&&(w-=k)),y.dem&&f.dem&&(f.dem.backfillBorder(y.dem,w,T),f.neighboringTiles&&f.neighboringTiles[M]&&(f.neighboringTiles[M].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,l,d,f){for(const y in this._tiles){let w=this._tiles[y];if(f[y]||!w.hasData()||w.tileID.overscaledZ<=l||w.tileID.overscaledZ>d)continue;let T=w.tileID;for(;w&&w.tileID.overscaledZ>l+1;){const M=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[M.key],w&&w.hasData()&&(T=M)}let k=T;for(;k.overscaledZ>l;)if(k=k.scaledTo(k.overscaledZ-1),n[k.key]){f[T.key]=T;break}}}findLoadedParent(n,l){if(n.key in this._loadedParentTiles){const d=this._loadedParentTiles[n.key];return d&&d.tileID.overscaledZ>=l?d:null}for(let d=n.overscaledZ-1;d>=l;d--){const f=n.scaledTo(d),y=this._getLoadedTile(f);if(y)return y}}findLoadedSibling(n){return this._getLoadedTile(n)}_getLoadedTile(n){const l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const l=Math.ceil(n.width/this._source.tileSize)+1,d=Math.ceil(n.height/this._source.tileSize)+1,f=Math.floor(l*d*(this._maxTileCacheZoomLevels===null?u.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(y)}handleWrapJump(n){const l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){const d={};for(const f in this._tiles){const y=this._tiles[f];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+l),d[y.tileID.key]=y}this._tiles=d;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}_updateCoveredAndRetainedTiles(n,l,d,f,y,w){const T={},k={},M=Object.keys(n),L=z.now();for(const F of M){const j=n[F],H=this._tiles[F];if(!H||H.fadeEndTime!==0&&H.fadeEndTime<=L)continue;const K=this.findLoadedParent(j,l),re=this.findLoadedSibling(j),oe=K||re||null;oe&&(this._addTile(oe.tileID),T[oe.tileID.key]=oe.tileID),k[F]=j}this._retainLoadedChildren(k,f,d,n);for(const F in T)n[F]||(this._coveredTiles[F]=!0,n[F]=T[F]);if(w){const F={},j={};for(const H of y)this._tiles[H.key].hasData()?F[H.key]=H:j[H.key]=H;for(const H in j){const K=j[H].children(this._source.maxzoom);this._tiles[K[0].key]&&this._tiles[K[1].key]&&this._tiles[K[2].key]&&this._tiles[K[3].key]&&(F[K[0].key]=n[K[0].key]=K[0],F[K[1].key]=n[K[1].key]=K[1],F[K[2].key]=n[K[2].key]=K[2],F[K[3].key]=n[K[3].key]=K[3],delete j[H])}for(const H in j){const K=j[H],re=this.findLoadedParent(K,this._source.minzoom),oe=this.findLoadedSibling(K),ue=re||oe||null;if(ue){F[ue.tileID.key]=n[ue.tileID.key]=ue.tileID;for(const he in F)F[he].isChildOf(ue.tileID)&&delete F[he]}}for(const H in this._tiles)F[H]||(this._coveredTiles[H]=!0)}}update(n,l){if(!this._sourceLoaded||this._paused)return;let d;this.transform=n,this.terrain=l,this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(L=>new u.S(L.canonical.z,L.wrap,L.canonical.z,L.canonical.x,L.canonical.y)):(d=n.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:l}),this._source.hasTile&&(d=d.filter(L=>this._source.hasTile(L)))):d=[];const f=n.coveringZoomLevel(this._source),y=Math.max(f-_t.maxOverzooming,this._source.minzoom),w=Math.max(f+_t.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const L={};for(const F of d)if(F.canonical.z>this._source.minzoom){const j=F.scaledTo(F.canonical.z-1);L[j.key]=j;const H=F.scaledTo(Math.max(this._source.minzoom,Math.min(F.canonical.z,5)));L[H.key]=H}d=d.concat(Object.values(L))}const T=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,T&&this.fire(new u.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const k=this._updateRetainedTiles(d,f);ki(this._source.type)&&this._updateCoveredAndRetainedTiles(k,y,w,f,d,l);for(const L in k)this._tiles[L].clearFadeHold();const M=u.ab(this._tiles,k);for(const L of M){const F=this._tiles[L];F.hasSymbolBuckets&&!F.holdingForFade()?F.setHoldDuration(this.map._fadeDuration):F.hasSymbolBuckets&&!F.symbolFadeFinished()||this._removeTile(L)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,l){var d;const f={},y={},w=Math.max(l-_t.maxOverzooming,this._source.minzoom),T=Math.max(l+_t.maxUnderzooming,this._source.minzoom),k={};for(const M of n){const L=this._addTile(M);f[M.key]=M,L.hasData()||l<this._source.maxzoom&&(k[M.key]=M)}this._retainLoadedChildren(k,l,T,f);for(const M of n){let L=this._tiles[M.key];if(L.hasData())continue;if(l+1>this._source.maxzoom){const j=M.children(this._source.maxzoom)[0],H=this.getTile(j);if(H&&H.hasData()){f[j.key]=j;continue}}else{const j=M.children(this._source.maxzoom);if(f[j[0].key]&&f[j[1].key]&&f[j[2].key]&&f[j[3].key])continue}let F=L.wasRequested();for(let j=M.overscaledZ-1;j>=w;--j){const H=M.scaledTo(j);if(y[H.key])break;if(y[H.key]=!0,L=this.getTile(H),!L&&F&&(L=this._addTile(H)),L){const K=L.hasData();if((K||!(!((d=this.map)===null||d===void 0)&&d.cancelPendingTileRequestsWhileZooming)||F)&&(f[H.key]=H),F=L.wasRequested(),K)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const l=[];let d,f=this._tiles[n].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){d=this._loadedParentTiles[f.key];break}l.push(f.key);const y=f.scaledTo(f.overscaledZ-1);if(d=this._getLoadedTile(y),d)break;f=y}for(const y of l)this._loadedParentTiles[y]=d}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const n in this._tiles){const l=this._tiles[n].tileID,d=this._getLoadedTile(l);this._loadedSiblingTiles[l.key]=d}}_addTile(n){let l=this._tiles[n.key];if(l)return l;l=this._cache.getAndRemove(n),l&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));const d=l;return l||(l=new Bs(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(l,n.key,l.state)),l.uses++,this._tiles[n.key]=l,d||this._source.fire(new u.k("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l}_setTileReloadTimer(n,l){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const d=l.getExpiryTimeout();d&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},d))}_removeTile(n){const l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}_dataHandler(n){const l=n.sourceDataType;n.dataType==="source"&&l==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&n.dataType==="source"&&l==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,l,d){const f=[],y=this.transform;if(!y)return f;const w=d?y.getCameraQueryGeometry(n):n,T=n.map(K=>y.pointCoordinate(K,this.terrain)),k=w.map(K=>y.pointCoordinate(K,this.terrain)),M=this.getIds();let L=1/0,F=1/0,j=-1/0,H=-1/0;for(const K of k)L=Math.min(L,K.x),F=Math.min(F,K.y),j=Math.max(j,K.x),H=Math.max(H,K.y);for(let K=0;K<M.length;K++){const re=this._tiles[M[K]];if(re.holdingForFade())continue;const oe=re.tileID,ue=Math.pow(2,y.zoom-re.tileID.overscaledZ),he=l*re.queryPadding*u.X/re.tileSize/ue,Q=[oe.getTilePoint(new u.Z(L,F)),oe.getTilePoint(new u.Z(j,H))];if(Q[0].x-he<u.X&&Q[0].y-he<u.X&&Q[1].x+he>=0&&Q[1].y+he>=0){const me=T.map(Te=>oe.getTilePoint(Te)),ve=k.map(Te=>oe.getTilePoint(Te));f.push({tile:re,tileID:oe,queryGeometry:me,cameraQueryGeometry:ve,scale:ue})}}return f}getVisibleCoordinates(n){const l=this.getRenderableIds(n).map(d=>this._tiles[d].tileID);for(const d of l)d.posMatrix=this.transform.calculatePosMatrix(d.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(ki(this._source.type)){const n=z.now();for(const l in this._tiles)if(this._tiles[l].fadeEndTime>=n)return!0}return!1}setFeatureState(n,l,d){this._state.updateState(n=n||"_geojsonTileLayer",l,d)}removeFeatureState(n,l,d){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,d)}getFeatureState(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)}setDependencies(n,l,d){const f=this._tiles[n];f&&f.setDependencies(l,d)}reloadTilesForDependencies(n,l){for(const d in this._tiles)this._tiles[d].hasDependency(n,l)&&this._reloadTile(d,"reloading");this._cache.filter(d=>!d.hasDependency(n,l))}}function Er(_,n){const l=Math.abs(2*_.wrap)-+(_.wrap<0),d=Math.abs(2*n.wrap)-+(n.wrap<0);return _.overscaledZ-n.overscaledZ||d-l||n.canonical.y-_.canonical.y||n.canonical.x-_.canonical.x}function ki(_){return _==="raster"||_==="image"||_==="video"}_t.maxOverzooming=10,_t.maxUnderzooming=3;class Tt{constructor(n,l){this.reset(n,l)}reset(n,l){this.points=n||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=u.ac(n,0,1);let l=1,d=this._distances[l];const f=n*this.paddedLength+this.padding;for(;d<f&&l<this._distances.length;)d=this._distances[++l];const y=l-1,w=this._distances[y],T=d-w,k=T>0?(f-w)/T:0;return this.points[y].mult(1-k).add(this.points[l].mult(k))}}function Ji(_,n){let l=!0;return _==="always"||_!=="never"&&n!=="never"||(l=!1),l}class ws{constructor(n,l,d){const f=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(n/d),this.yCellCount=Math.ceil(l/d);for(let w=0;w<this.xCellCount*this.yCellCount;w++)f.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=l,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,l,d,f,y){this._forEachCell(l,d,f,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(f),this.bboxes.push(y)}insertCircle(n,l,d,f){this._forEachCell(l-f,d-f,l+f,d+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(l),this.circles.push(d),this.circles.push(f)}_insertBoxCell(n,l,d,f,y,w){this.boxCells[y].push(w)}_insertCircleCell(n,l,d,f,y,w){this.circleCells[y].push(w)}_query(n,l,d,f,y,w,T){if(d<0||n>this.width||f<0||l>this.height)return[];const k=[];if(n<=0&&l<=0&&this.width<=d&&this.height<=f){if(y)return[{key:null,x1:n,y1:l,x2:d,y2:f}];for(let M=0;M<this.boxKeys.length;M++)k.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const L=this.circles[3*M],F=this.circles[3*M+1],j=this.circles[3*M+2];k.push({key:this.circleKeys[M],x1:L-j,y1:F-j,x2:L+j,y2:F+j})}}else this._forEachCell(n,l,d,f,this._queryCell,k,{hitTest:y,overlapMode:w,seenUids:{box:{},circle:{}}},T);return k}query(n,l,d,f){return this._query(n,l,d,f,!1,null)}hitTest(n,l,d,f,y,w){return this._query(n,l,d,f,!0,y,w).length>0}hitTestCircle(n,l,d,f,y){const w=n-d,T=n+d,k=l-d,M=l+d;if(T<0||w>this.width||M<0||k>this.height)return!1;const L=[];return this._forEachCell(w,k,T,M,this._queryCellCircle,L,{hitTest:!0,overlapMode:f,circle:{x:n,y:l,radius:d},seenUids:{box:{},circle:{}}},y),L.length>0}_queryCell(n,l,d,f,y,w,T,k){const{seenUids:M,hitTest:L,overlapMode:F}=T,j=this.boxCells[y];if(j!==null){const K=this.bboxes;for(const re of j)if(!M.box[re]){M.box[re]=!0;const oe=4*re,ue=this.boxKeys[re];if(n<=K[oe+2]&&l<=K[oe+3]&&d>=K[oe+0]&&f>=K[oe+1]&&(!k||k(ue))&&(!L||!Ji(F,ue.overlapMode))&&(w.push({key:ue,x1:K[oe],y1:K[oe+1],x2:K[oe+2],y2:K[oe+3]}),L))return!0}}const H=this.circleCells[y];if(H!==null){const K=this.circles;for(const re of H)if(!M.circle[re]){M.circle[re]=!0;const oe=3*re,ue=this.circleKeys[re];if(this._circleAndRectCollide(K[oe],K[oe+1],K[oe+2],n,l,d,f)&&(!k||k(ue))&&(!L||!Ji(F,ue.overlapMode))){const he=K[oe],Q=K[oe+1],me=K[oe+2];if(w.push({key:ue,x1:he-me,y1:Q-me,x2:he+me,y2:Q+me}),L)return!0}}}return!1}_queryCellCircle(n,l,d,f,y,w,T,k){const{circle:M,seenUids:L,overlapMode:F}=T,j=this.boxCells[y];if(j!==null){const K=this.bboxes;for(const re of j)if(!L.box[re]){L.box[re]=!0;const oe=4*re,ue=this.boxKeys[re];if(this._circleAndRectCollide(M.x,M.y,M.radius,K[oe+0],K[oe+1],K[oe+2],K[oe+3])&&(!k||k(ue))&&!Ji(F,ue.overlapMode))return w.push(!0),!0}}const H=this.circleCells[y];if(H!==null){const K=this.circles;for(const re of H)if(!L.circle[re]){L.circle[re]=!0;const oe=3*re,ue=this.circleKeys[re];if(this._circlesCollide(K[oe],K[oe+1],K[oe+2],M.x,M.y,M.radius)&&(!k||k(ue))&&!Ji(F,ue.overlapMode))return w.push(!0),!0}}}_forEachCell(n,l,d,f,y,w,T,k){const M=this._convertToXCellCoord(n),L=this._convertToYCellCoord(l),F=this._convertToXCellCoord(d),j=this._convertToYCellCoord(f);for(let H=M;H<=F;H++)for(let K=L;K<=j;K++)if(y.call(this,n,l,d,f,this.xCellCount*K+H,w,T,k))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,l,d,f,y,w){const T=f-n,k=y-l,M=d+w;return M*M>T*T+k*k}_circleAndRectCollide(n,l,d,f,y,w,T){const k=(w-f)/2,M=Math.abs(n-(f+k));if(M>k+d)return!1;const L=(T-y)/2,F=Math.abs(l-(y+L));if(F>L+d)return!1;if(M<=k||F<=L)return!0;const j=M-k,H=F-L;return j*j+H*H<=d*d}}function Os(_,n,l,d,f){const y=u.H();return n?(u.K(y,y,[1/f,1/f,1]),l||u.ad(y,y,d.angle)):u.L(y,d.labelPlaneMatrix,_),y}function Qi(_,n,l,d,f){if(n){const y=u.ae(_);return u.K(y,y,[f,f,1]),l||u.ad(y,y,-d.angle),y}return d.glCoordMatrix}function ie(_,n,l,d){let f;d?(f=[_,n,d(_,n),1],u.af(f,f,l)):(f=[_,n,0,1],Vt(f,f,l));const y=f[3];return{point:new u.P(f[0]/y,f[1]/y),signedDistanceFromCamera:y,isOccluded:!1}}function V(_,n){return .5+_/n*.5}function O(_,n){return _.x>=-n[0]&&_.x<=n[0]&&_.y>=-n[1]&&_.y<=n[1]}function W(_,n,l,d,f,y,w,T,k,M,L,F,j,H,K){const re=d?_.textSizeData:_.iconSizeData,oe=u.ag(re,l.transform.zoom),ue=[256/l.width*2+1,256/l.height*2+1],he=d?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;he.clear();const Q=_.lineVertexArray,me=d?_.text.placedSymbolArray:_.icon.placedSymbolArray,ve=l.transform.width/l.transform.height;let Te=!1;for(let ze=0;ze<me.length;ze++){const Ve=me.get(ze);if(Ve.hidden||Ve.writingMode===u.ah.vertical&&!Te){pt(Ve.numGlyphs,he);continue}Te=!1;const Ye=ie(Ve.anchorX,Ve.anchorY,n,K);if(!O(Ye.point,ue)){pt(Ve.numGlyphs,he);continue}const nt=V(l.transform.cameraToCenterDistance,Ye.signedDistanceFromCamera),We=u.ai(re,oe,Ve),Ze=w?We/nt:We*nt,at={getElevation:K,labelPlaneMatrix:f,lineVertexArray:Q,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:M,tileAnchorPoint:new u.P(Ve.anchorX,Ve.anchorY),unwrappedTileID:L,width:F,height:j,translation:H},wt=ge(at,Ve,Ze,!1,T,n,y,_.glyphOffsetArray,he,ve,k);Te=wt.useVertical,(wt.notEnoughRoom||Te||wt.needsFlipping&&ge(at,Ve,Ze,!0,T,n,y,_.glyphOffsetArray,he,ve,k).notEnoughRoom)&&pt(Ve.numGlyphs,he)}d?_.text.dynamicLayoutVertexBuffer.updateData(he):_.icon.dynamicLayoutVertexBuffer.updateData(he)}function ne(_,n,l,d,f,y,w,T){const k=y.glyphStartIndex+y.numGlyphs,M=y.lineStartIndex,L=y.lineStartIndex+y.lineLength,F=n.getoffsetX(y.glyphStartIndex),j=n.getoffsetX(k-1),H=qe(_*F,l,d,f,y.segment,M,L,T,w);if(!H)return null;const K=qe(_*j,l,d,f,y.segment,M,L,T,w);return K?T.projectionCache.anyProjectionOccluded?null:{first:H,last:K}:null}function fe(_,n,l,d){return _===u.ah.horizontal&&Math.abs(l.y-n.y)>Math.abs(l.x-n.x)*d?{useVertical:!0}:(_===u.ah.vertical?n.y<l.y:n.x>l.x)?{needsFlipping:!0}:null}function ge(_,n,l,d,f,y,w,T,k,M,L){const F=l/24,j=n.lineOffsetX*F,H=n.lineOffsetY*F;let K;if(n.numGlyphs>1){const re=n.glyphStartIndex+n.numGlyphs,oe=n.lineStartIndex,ue=n.lineStartIndex+n.lineLength,he=ne(F,T,j,H,d,n,L,_);if(!he)return{notEnoughRoom:!0};const Q=ie(he.first.point.x,he.first.point.y,w,_.getElevation).point,me=ie(he.last.point.x,he.last.point.y,w,_.getElevation).point;if(f&&!d){const ve=fe(n.writingMode,Q,me,M);if(ve)return ve}K=[he.first];for(let ve=n.glyphStartIndex+1;ve<re-1;ve++)K.push(qe(F*T.getoffsetX(ve),j,H,d,n.segment,oe,ue,_,L));K.push(he.last)}else{if(f&&!d){const oe=ie(_.tileAnchorPoint.x,_.tileAnchorPoint.y,y,_.getElevation).point,ue=n.lineStartIndex+n.segment+1,he=new u.P(_.lineVertexArray.getx(ue),_.lineVertexArray.gety(ue)),Q=ie(he.x,he.y,y,_.getElevation),me=Q.signedDistanceFromCamera>0?Q.point:function(Te,ze,Ve,Ye,nt,We){return be(Te,ze,Ve,1,nt,We)}(_.tileAnchorPoint,he,oe,0,y,_),ve=fe(n.writingMode,oe,me,M);if(ve)return ve}const re=qe(F*T.getoffsetX(n.glyphStartIndex),j,H,d,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,_,L);if(!re||_.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};K=[re]}for(const re of K)u.aj(k,re.point,re.angle);return{}}function be(_,n,l,d,f,y){const w=_.add(_.sub(n)._unit()),T=f!==void 0?ie(w.x,w.y,f,y.getElevation).point:Ee(w.x,w.y,y).point,k=l.sub(T);return l.add(k._mult(d/k.mag()))}function ce(_,n,l){const d=n.projectionCache;if(d.projections[_])return d.projections[_];const f=new u.P(n.lineVertexArray.getx(_),n.lineVertexArray.gety(_)),y=Ee(f.x,f.y,n);if(y.signedDistanceFromCamera>0)return d.projections[_]=y.point,d.anyProjectionOccluded=d.anyProjectionOccluded||y.isOccluded,y.point;const w=_-l.direction;return function(T,k,M,L,F){return be(T,k,M,L,void 0,F)}(l.distanceFromAnchor===0?n.tileAnchorPoint:new u.P(n.lineVertexArray.getx(w),n.lineVertexArray.gety(w)),f,l.previousVertex,l.absOffsetX-l.distanceFromAnchor+1,n)}function Ee(_,n,l){const d=_+l.translation[0],f=n+l.translation[1];let y;return!l.pitchWithMap&&l.projection.useSpecialProjectionForSymbols?(y=l.projection.projectTileCoordinates(d,f,l.unwrappedTileID,l.getElevation),y.point.x=(.5*y.point.x+.5)*l.width,y.point.y=(.5*-y.point.y+.5)*l.height):(y=ie(d,f,l.labelPlaneMatrix,l.getElevation),y.isOccluded=!1),y}function Re(_,n,l){return _._unit()._perp()._mult(n*l)}function Ce(_,n,l,d,f,y,w,T,k){if(T.projectionCache.offsets[_])return T.projectionCache.offsets[_];const M=l.add(n);if(_+k.direction<d||_+k.direction>=f)return T.projectionCache.offsets[_]=M,M;const L=ce(_+k.direction,T,k),F=Re(L.sub(l),w,k.direction),j=l.add(F),H=L.add(F);return T.projectionCache.offsets[_]=u.ak(y,M,j,H)||M,T.projectionCache.offsets[_]}function qe(_,n,l,d,f,y,w,T,k){const M=d?_-n:_+n;let L=M>0?1:-1,F=0;d&&(L*=-1,F=Math.PI),L<0&&(F+=Math.PI);let j,H=L>0?y+f:y+f+1;T.projectionCache.cachedAnchorPoint?j=T.projectionCache.cachedAnchorPoint:(j=Ee(T.tileAnchorPoint.x,T.tileAnchorPoint.y,T).point,T.projectionCache.cachedAnchorPoint=j);let K,re,oe=j,ue=j,he=0,Q=0;const me=Math.abs(M),ve=[];let Te;for(;he+Q<=me;){if(H+=L,H<y||H>=w)return null;he+=Q,ue=oe,re=K;const Ye={absOffsetX:me,direction:L,distanceFromAnchor:he,previousVertex:ue};if(oe=ce(H,T,Ye),l===0)ve.push(ue),Te=oe.sub(ue);else{let nt;const We=oe.sub(ue);nt=We.mag()===0?Re(ce(H+L,T,Ye).sub(oe),l,L):Re(We,l,L),re||(re=ue.add(nt)),K=Ce(H,nt,oe,y,w,re,l,T,Ye),ve.push(re),Te=K.sub(re)}Q=Te.mag()}const ze=Te._mult((me-he)/Q)._add(re||ue),Ve=F+Math.atan2(oe.y-ue.y,oe.x-ue.x);return ve.push(ze),{point:ze,angle:k?Ve:0,path:ve}}const ht=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function pt(_,n){for(let l=0;l<_;l++){const d=n.length;n.resize(d+4),n.float32.set(ht,3*d)}}function Vt(_,n,l){const d=n[0],f=n[1];return _[0]=l[0]*d+l[4]*f+l[12],_[1]=l[1]*d+l[5]*f+l[13],_[3]=l[3]*d+l[7]*f+l[15],_}const kt=100;class Nt{constructor(n,l,d=new ws(n.width+200,n.height+200,25),f=new ws(n.width+200,n.height+200,25)){this.transform=n,this.mapProjection=l,this.grid=d,this.ignoredGrid=f,this.pitchFactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+kt,this.screenBottomBoundary=n.height+kt,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,l,d,f,y,w,T,k,M,L,F){const j=n.anchorPointX+k[0],H=n.anchorPointY+k[1],K=this.projectAndGetPerspectiveRatio(f,j,H,y,L),re=d*K.perspectiveRatio;let oe;if(w||T)oe=this._projectCollisionBox(n,re,f,y,w,T,k,K,L,F);else{const ve=K.point.x+(F?F.x*re:0),Te=K.point.y+(F?F.y*re:0);oe={allPointsOccluded:!1,box:[ve+n.x1*re,Te+n.y1*re,ve+n.x2*re,Te+n.y2*re]}}const[ue,he,Q,me]=oe.box;return this.mapProjection.useSpecialProjectionForSymbols&&(w?oe.allPointsOccluded:this.mapProjection.isOccluded(j,H,y))||K.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(ue,he,Q,me)||l!=="always"&&this.grid.hitTest(ue,he,Q,me,l,M)?{box:[ue,he,Q,me],placeable:!1,offscreen:!1}:{box:[ue,he,Q,me],placeable:!0,offscreen:this.isOffscreen(ue,he,Q,me)}}placeCollisionCircles(n,l,d,f,y,w,T,k,M,L,F,j,H,K,re,oe){const ue=[],he=new u.P(l.anchorX,l.anchorY),Q=this.getPerspectiveRatio(w,he.x,he.y,T,oe),me=(F?y/Q:y*Q)/u.ap,ve={getElevation:oe,labelPlaneMatrix:k,lineVertexArray:d,pitchWithMap:F,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:he,unwrappedTileID:T,width:this.transform.width,height:this.transform.height,translation:re},Te=ne(me,f,l.lineOffsetX*me,l.lineOffsetY*me,!1,l,!1,ve);let ze=!1,Ve=!1,Ye=!0;if(Te){const nt=.5*H*Q+K,We=new u.P(-100,-100),Ze=new u.P(this.screenRightBoundary,this.screenBottomBoundary),at=new Tt,wt=Te.first,Xe=Te.last;let Qe=[];for(let It=wt.path.length-1;It>=1;It--)Qe.push(wt.path[It]);for(let It=1;It<Xe.path.length;It++)Qe.push(Xe.path[It]);const vt=2.5*nt;if(M){const It=this.projectPathToScreenSpace(Qe,ve,M);Qe=It.some(Rt=>Rt.signedDistanceFromCamera<=0)?[]:It.map(Rt=>Rt.point)}let cn=[];if(Qe.length>0){const It=Qe[0].clone(),Rt=Qe[0].clone();for(let hn=1;hn<Qe.length;hn++)It.x=Math.min(It.x,Qe[hn].x),It.y=Math.min(It.y,Qe[hn].y),Rt.x=Math.max(Rt.x,Qe[hn].x),Rt.y=Math.max(Rt.y,Qe[hn].y);cn=It.x>=We.x&&Rt.x<=Ze.x&&It.y>=We.y&&Rt.y<=Ze.y?[Qe]:Rt.x<We.x||It.x>Ze.x||Rt.y<We.y||It.y>Ze.y?[]:u.al([Qe],We.x,We.y,Ze.x,Ze.y)}for(const It of cn){at.reset(It,.25*nt);let Rt=0;Rt=at.length<=.5*nt?1:Math.ceil(at.paddedLength/vt)+1;for(let hn=0;hn<Rt;hn++){const ar=hn/Math.max(Rt-1,1),zi=at.lerp(ar),dn=zi.x+kt,Ar=zi.y+kt;ue.push(dn,Ar,nt,0);const vr=dn-nt,lr=Ar-nt,xr=dn+nt,rs=Ar+nt;if(Ye=Ye&&this.isOffscreen(vr,lr,xr,rs),Ve=Ve||this.isInsideGrid(vr,lr,xr,rs),n!=="always"&&this.grid.hitTestCircle(dn,Ar,nt,n,j)&&(ze=!0,!L))return{circles:[],offscreen:!1,collisionDetected:ze}}}}return{circles:!L&&ze||!Ve||Q<this.perspectiveRatioCutoff?[]:ue,offscreen:Ye,collisionDetected:ze}}projectPathToScreenSpace(n,l,d){return n.map(f=>ie(f.x,f.y,d,l.getElevation))}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let d=1/0,f=1/0,y=-1/0,w=-1/0;for(const L of n){const F=new u.P(L.x+kt,L.y+kt);d=Math.min(d,F.x),f=Math.min(f,F.y),y=Math.max(y,F.x),w=Math.max(w,F.y),l.push(F)}const T=this.grid.query(d,f,y,w).concat(this.ignoredGrid.query(d,f,y,w)),k={},M={};for(const L of T){const F=L.key;if(k[F.bucketInstanceId]===void 0&&(k[F.bucketInstanceId]={}),k[F.bucketInstanceId][F.featureIndex])continue;const j=[new u.P(L.x1,L.y1),new u.P(L.x2,L.y1),new u.P(L.x2,L.y2),new u.P(L.x1,L.y2)];u.am(l,j)&&(k[F.bucketInstanceId][F.featureIndex]=!0,M[F.bucketInstanceId]===void 0&&(M[F.bucketInstanceId]=[]),M[F.bucketInstanceId].push(F.featureIndex))}return M}insertCollisionBox(n,l,d,f,y,w){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:y,collisionGroupID:w,overlapMode:l},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,l,d,f,y,w){const T=d?this.ignoredGrid:this.grid,k={bucketInstanceId:f,featureIndex:y,collisionGroupID:w,overlapMode:l};for(let M=0;M<n.length;M+=4)T.insertCircle(k,n[M],n[M+1],n[M+2])}projectAndGetPerspectiveRatio(n,l,d,f,y){let w;y?(w=[l,d,y(l,d),1],u.af(w,w,n)):(w=[l,d,0,1],Vt(w,w,n));const T=w[3];return{point:new u.P((w[0]/T+1)/2*this.transform.width+kt,(-w[1]/T+1)/2*this.transform.height+kt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/T*.5,isOccluded:!1,signedDistanceFromCamera:T}}getPerspectiveRatio(n,l,d,f,y){const w=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(l,d,f,y):ie(l,d,n,y);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(n,l,d,f){return d<kt||n>=this.screenRightBoundary||f<kt||l>this.screenBottomBoundary}isInsideGrid(n,l,d,f){return d>=0&&n<this.gridRightBoundary&&f>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const n=u.an([]);return u.J(n,n,[-100,-100,0]),n}_projectCollisionBox(n,l,d,f,y,w,T,k,M,L){let F=new u.P(1,0),j=new u.P(0,1);const H=new u.P(n.anchorPointX+T[0],n.anchorPointY+T[1]);if(w&&!y){const Ye=this.projectAndGetPerspectiveRatio(d,H.x+1,H.y,f,M).point.sub(k.point).unit(),nt=Math.atan(Ye.y/Ye.x)+(Ye.x<0?Math.PI:0),We=Math.sin(nt),Ze=Math.cos(nt);F=new u.P(Ze,We),j=new u.P(-We,Ze)}else if(!w&&y){const Ye=-this.transform.angle,nt=Math.sin(Ye),We=Math.cos(Ye);F=new u.P(We,nt),j=new u.P(-nt,We)}let K=k.point,re=l;if(y){K=H;const Ye=this.transform.zoom-Math.floor(this.transform.zoom);re=Math.pow(2,-Ye),re*=this.mapProjection.getPitchedTextCorrection(this.transform,H,f),L||(re*=u.ac(.5+k.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}L&&(K=K.add(F.mult(L.x*re)).add(j.mult(L.y*re)));const oe=n.x1*re,ue=n.x2*re,he=(oe+ue)/2,Q=n.y1*re,me=n.y2*re,ve=(Q+me)/2,Te=[{offsetX:oe,offsetY:Q},{offsetX:he,offsetY:Q},{offsetX:ue,offsetY:Q},{offsetX:ue,offsetY:ve},{offsetX:ue,offsetY:me},{offsetX:he,offsetY:me},{offsetX:oe,offsetY:me},{offsetX:oe,offsetY:ve}];let ze=[];for(const{offsetX:Ye,offsetY:nt}of Te)ze.push(new u.P(K.x+F.x*Ye+j.x*nt,K.y+F.y*Ye+j.y*nt));let Ve=!1;if(y){const Ye=ze.map(nt=>this.projectAndGetPerspectiveRatio(d,nt.x,nt.y,f,M));Ve=Ye.some(nt=>!nt.isOccluded),ze=Ye.map(nt=>nt.point)}else Ve=!0;return{box:u.ao(ze),allPointsOccluded:!Ve}}}function Dt(_,n,l){return n*(u.X/(_.tileSize*Math.pow(2,l-_.tileID.overscaledZ)))}class Rn{constructor(n,l,d,f){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?l:-l))):f&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class yn{constructor(n,l,d,f,y){this.text=new Rn(n?n.text:null,l,d,y),this.icon=new Rn(n?n.icon:null,l,f,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class At{constructor(n,l,d){this.text=n,this.icon=l,this.skipFade=d}}class Wt{constructor(){this.invProjMatrix=u.H(),this.viewportMatrix=u.H(),this.circles=[]}}class pn{constructor(n,l,d,f,y){this.bucketInstanceId=n,this.featureIndex=l,this.sourceLayerIndex=d,this.bucketIndex=f,this.tileID=y}}class Zn{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const l=++this.maxGroupID;this.collisionGroups[n]={ID:l,predicate:d=>d.collisionGroupID===l}}return this.collisionGroups[n]}}function Qn(_,n,l,d,f){const{horizontalAlign:y,verticalAlign:w}=u.au(_);return new u.P(-(y-.5)*n+d[0]*f,-(w-.5)*l+d[1]*f)}class _r{constructor(n,l,d,f,y,w){this.transform=n.clone(),this.terrain=d,this.collisionIndex=new Nt(this.transform,l),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Zn(y),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(n){const l=this.terrain;return l?(d,f)=>l.getElevation(n,d,f):null}getBucketParts(n,l,d,f){const y=d.getBucket(l),w=d.latestFeatureIndex;if(!y||!w||l.id!==y.layerIds[0])return;const T=d.collisionBoxArray,k=y.layers[0].layout,M=y.layers[0].paint,L=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),F=d.tileSize/u.X,j=d.tileID.toUnwrapped(),H=this.transform.calculatePosMatrix(j),K=k.get("text-pitch-alignment")==="map",re=k.get("text-rotation-alignment")==="map",oe=Dt(d,1,this.transform.zoom),ue=this.collisionIndex.mapProjection.translatePosition(this.transform,d,M.get("text-translate"),M.get("text-translate-anchor")),he=this.collisionIndex.mapProjection.translatePosition(this.transform,d,M.get("icon-translate"),M.get("icon-translate-anchor")),Q=Os(H,K,re,this.transform,oe);let me=null;if(K){const Te=Qi(H,K,re,this.transform,oe);me=u.L([],this.transform.labelPlaneMatrix,Te)}this.retainedQueryData[y.bucketInstanceId]=new pn(y.bucketInstanceId,w,y.sourceLayerIndex,y.index,d.tileID);const ve={bucket:y,layout:k,translationText:ue,translationIcon:he,posMatrix:H,unwrappedTileID:j,textLabelPlaneMatrix:Q,labelToScreenMatrix:me,scale:L,textPixelRatio:F,holdingForFade:d.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:u.ag(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(f)for(const Te of y.sortKeyRanges){const{sortKey:ze,symbolInstanceStart:Ve,symbolInstanceEnd:Ye}=Te;n.push({sortKey:ze,symbolInstanceStart:Ve,symbolInstanceEnd:Ye,parameters:ve})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:ve})}attemptAnchorPlacement(n,l,d,f,y,w,T,k,M,L,F,j,H,K,re,oe,ue,he,Q){const me=u.aq[n.textAnchor],ve=[n.textOffset0,n.textOffset1],Te=Qn(me,d,f,ve,y),ze=this.collisionIndex.placeCollisionBox(l,j,k,M,L,T,w,oe,F.predicate,Q,Te);if((!he||this.collisionIndex.placeCollisionBox(he,j,k,M,L,T,w,ue,F.predicate,Q,Te).placeable)&&ze.placeable){let Ve;if(this.prevPlacement&&this.prevPlacement.variableOffsets[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID].text&&(Ve=this.prevPlacement.variableOffsets[H.crossTileID].anchor),H.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[H.crossTileID]={textOffset:ve,width:d,height:f,anchor:me,textBoxScale:y,prevAnchor:Ve},this.markUsedJustification(K,me,H,re),K.allowVerticalPlacement&&(this.markUsedOrientation(K,re,H),this.placedOrientations[H.crossTileID]=re),{shift:Te,placedGlyphBoxes:ze}}}placeLayerBucketPart(n,l,d){const{bucket:f,layout:y,translationText:w,translationIcon:T,posMatrix:k,unwrappedTileID:M,textLabelPlaneMatrix:L,labelToScreenMatrix:F,textPixelRatio:j,holdingForFade:H,collisionBoxArray:K,partiallyEvaluatedTextSize:re,collisionGroup:oe}=n.parameters,ue=y.get("text-optional"),he=y.get("icon-optional"),Q=u.ar(y,"text-overlap","text-allow-overlap"),me=Q==="always",ve=u.ar(y,"icon-overlap","icon-allow-overlap"),Te=ve==="always",ze=y.get("text-rotation-alignment")==="map",Ve=y.get("text-pitch-alignment")==="map",Ye=y.get("icon-text-fit")!=="none",nt=y.get("symbol-z-order")==="viewport-y",We=me&&(Te||!f.hasIconData()||he),Ze=Te&&(me||!f.hasTextData()||ue);!f.collisionArrays&&K&&f.deserializeCollisionBoxes(K);const at=this._getTerrainElevationFunc(this.retainedQueryData[f.bucketInstanceId].tileID),wt=(Xe,Qe,vt)=>{var cn,It;if(l[Xe.crossTileID])return;if(H)return void(this.placements[Xe.crossTileID]=new At(!1,!1,!1));let Rt=!1,hn=!1,ar=!0,zi=null,dn={box:null,placeable:!1,offscreen:null},Ar={placeable:!1},vr=null,lr=null,xr=null,rs=0,da=0,Au=0;Qe.textFeatureIndex?rs=Qe.textFeatureIndex:Xe.useRuntimeCollisionCircles&&(rs=Xe.featureIndex),Qe.verticalTextFeatureIndex&&(da=Qe.verticalTextFeatureIndex);const fa=Qe.textBox;if(fa){const fi=er=>{let ur=u.ah.horizontal;if(f.allowVerticalPlacement&&!er&&this.prevPlacement){const Yr=this.prevPlacement.placedOrientations[Xe.crossTileID];Yr&&(this.placedOrientations[Xe.crossTileID]=Yr,ur=Yr,this.markUsedOrientation(f,ur,Xe))}return ur},pi=(er,ur)=>{if(f.allowVerticalPlacement&&Xe.numVerticalGlyphVertices>0&&Qe.verticalTextBox){for(const Yr of f.writingModes)if(Yr===u.ah.vertical?(dn=ur(),Ar=dn):dn=er(),dn&&dn.placeable)break}else dn=er()},js=Xe.textAnchorOffsetStartIndex,Di=Xe.textAnchorOffsetEndIndex;if(Di===js){const er=(ur,Yr)=>{const Ft=this.collisionIndex.placeCollisionBox(ur,Q,j,k,M,Ve,ze,w,oe.predicate,at);return Ft&&Ft.placeable&&(this.markUsedOrientation(f,Yr,Xe),this.placedOrientations[Xe.crossTileID]=Yr),Ft};pi(()=>er(fa,u.ah.horizontal),()=>{const ur=Qe.verticalTextBox;return f.allowVerticalPlacement&&Xe.numVerticalGlyphVertices>0&&ur?er(ur,u.ah.vertical):{box:null,offscreen:null}}),fi(dn&&dn.placeable)}else{let er=u.aq[(It=(cn=this.prevPlacement)===null||cn===void 0?void 0:cn.variableOffsets[Xe.crossTileID])===null||It===void 0?void 0:It.anchor];const ur=(Ft,bo,pa)=>{const ma=Ft.x2-Ft.x1,lp=Ft.y2-Ft.y1,Ry=Xe.textBoxScale,up=Ye&&ve==="never"?bo:null;let $s=null,cp=Q==="never"?1:2,Du="never";er&&cp++;for(let yl=0;yl<cp;yl++){for(let Ru=js;Ru<Di;Ru++){const Lu=f.textAnchorOffsets.get(Ru);if(er&&Lu.textAnchor!==er)continue;const ga=this.attemptAnchorPlacement(Lu,Ft,ma,lp,Ry,ze,Ve,j,k,M,oe,Du,Xe,f,pa,w,T,up,at);if(ga&&($s=ga.placedGlyphBoxes,$s&&$s.placeable))return Rt=!0,zi=ga.shift,$s}er?er=null:Du=Q}return d&&!$s&&($s={box:this.collisionIndex.placeCollisionBox(fa,"always",j,k,M,Ve,ze,w,oe.predicate,at,new u.P(0,0)).box,offscreen:!1,placeable:!1}),$s};pi(()=>ur(fa,Qe.iconBox,u.ah.horizontal),()=>{const Ft=Qe.verticalTextBox;return f.allowVerticalPlacement&&(!dn||!dn.placeable)&&Xe.numVerticalGlyphVertices>0&&Ft?ur(Ft,Qe.verticalIconBox,u.ah.vertical):{box:null,occluded:!0,offscreen:null}}),dn&&(Rt=dn.placeable,ar=dn.offscreen);const Yr=fi(dn&&dn.placeable);if(!Rt&&this.prevPlacement){const Ft=this.prevPlacement.variableOffsets[Xe.crossTileID];Ft&&(this.variableOffsets[Xe.crossTileID]=Ft,this.markUsedJustification(f,Ft.anchor,Xe,Yr))}}}if(vr=dn,Rt=vr&&vr.placeable,ar=vr&&vr.offscreen,Xe.useRuntimeCollisionCircles){const fi=f.text.placedSymbolArray.get(Xe.centerJustifiedTextSymbolIndex),pi=u.ai(f.textSizeData,re,fi),js=y.get("text-padding");lr=this.collisionIndex.placeCollisionCircles(Q,fi,f.lineVertexArray,f.glyphOffsetArray,pi,k,M,L,F,d,Ve,oe.predicate,Xe.collisionCircleDiameter,js,w,at),lr.circles.length&&lr.collisionDetected&&!d&&u.w("Collisions detected, but collision boxes are not shown"),Rt=me||lr.circles.length>0&&!lr.collisionDetected,ar=ar&&lr.offscreen}if(Qe.iconFeatureIndex&&(Au=Qe.iconFeatureIndex),Qe.iconBox){const fi=pi=>this.collisionIndex.placeCollisionBox(pi,ve,j,k,M,Ve,ze,T,oe.predicate,at,Ye&&zi?zi:void 0);Ar&&Ar.placeable&&Qe.verticalIconBox?(xr=fi(Qe.verticalIconBox),hn=xr.placeable):(xr=fi(Qe.iconBox),hn=xr.placeable),ar=ar&&xr.offscreen}const di=ue||Xe.numHorizontalGlyphVertices===0&&Xe.numVerticalGlyphVertices===0,zu=he||Xe.numIconVertices===0;di||zu?zu?di||(hn=hn&&Rt):Rt=hn&&Rt:hn=Rt=hn&&Rt;const Fh=hn&&xr.placeable;if(Rt&&vr.placeable&&this.collisionIndex.insertCollisionBox(vr.box,Q,y.get("text-ignore-placement"),f.bucketInstanceId,Ar&&Ar.placeable&&da?da:rs,oe.ID),Fh&&this.collisionIndex.insertCollisionBox(xr.box,ve,y.get("icon-ignore-placement"),f.bucketInstanceId,Au,oe.ID),lr&&Rt&&this.collisionIndex.insertCollisionCircles(lr.circles,Q,y.get("text-ignore-placement"),f.bucketInstanceId,rs,oe.ID),d&&this.storeCollisionData(f.bucketInstanceId,vt,Qe,vr,xr,lr),Xe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Xe.crossTileID]=new At(Rt||We,hn||Ze,ar||f.justReloaded),l[Xe.crossTileID]=!0};if(nt){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Xe=f.getSortedSymbolIndexes(this.transform.angle);for(let Qe=Xe.length-1;Qe>=0;--Qe){const vt=Xe[Qe];wt(f.symbolInstances.get(vt),f.collisionArrays[vt],vt)}}else for(let Xe=n.symbolInstanceStart;Xe<n.symbolInstanceEnd;Xe++)wt(f.symbolInstances.get(Xe),f.collisionArrays[Xe],Xe);if(d&&f.bucketInstanceId in this.collisionCircleArrays){const Xe=this.collisionCircleArrays[f.bucketInstanceId];u.as(Xe.invProjMatrix,k),Xe.viewportMatrix=this.collisionIndex.getViewportMatrix()}f.justReloaded=!1}storeCollisionData(n,l,d,f,y,w){if(d.textBox||d.iconBox){let T,k;this.collisionBoxArrays.has(n)?T=this.collisionBoxArrays.get(n):(T=new Map,this.collisionBoxArrays.set(n,T)),T.has(l)?k=T.get(l):(k={text:null,icon:null},T.set(l,k)),d.textBox&&(k.text=f.box),d.iconBox&&(k.icon=y.box)}if(w){let T=this.collisionCircleArrays[n];T===void 0&&(T=this.collisionCircleArrays[n]=new Wt);for(let k=0;k<w.circles.length;k+=4)T.circles.push(w.circles[k+0]),T.circles.push(w.circles[k+1]),T.circles.push(w.circles[k+2]),T.circles.push(w.collisionDetected?1:0)}}markUsedJustification(n,l,d,f){let y;y=f===u.ah.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[u.at(l)];const w=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const T of w)T>=0&&(n.text.placedSymbolArray.get(T).crossTileID=y>=0&&T!==y?0:d.crossTileID)}markUsedOrientation(n,l,d){const f=l===u.ah.horizontal||l===u.ah.horizontalOnly?l:0,y=l===u.ah.vertical?l:0,w=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const T of w)n.text.placedSymbolArray.get(T).placedOrientation=f;d.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let d=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const f=l?l.symbolFadeChange(n):1,y=l?l.opacities:{},w=l?l.variableOffsets:{},T=l?l.placedOrientations:{};for(const k in this.placements){const M=this.placements[k],L=y[k];L?(this.opacities[k]=new yn(L,f,M.text,M.icon),d=d||M.text!==L.text.placed||M.icon!==L.icon.placed):(this.opacities[k]=new yn(null,f,M.text,M.icon,M.skipFade),d=d||M.text||M.icon)}for(const k in y){const M=y[k];if(!this.opacities[k]){const L=new yn(M,f,!1,!1);L.isHidden()||(this.opacities[k]=L,d=d||M.text.placed||M.icon.placed)}}for(const k in w)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=w[k]);for(const k in T)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=T[k]);if(l&&l.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:n)}updateLayerOpacities(n,l){const d={};for(const f of l){const y=f.getBucket(n);y&&f.latestFeatureIndex&&n.id===y.layerIds[0]&&this.updateBucketOpacities(y,f.tileID,d,f.collisionBoxArray)}}updateBucketOpacities(n,l,d,f){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const y=n.layers[0],w=y.layout,T=new yn(null,0,!1,!1,!0),k=w.get("text-allow-overlap"),M=w.get("icon-allow-overlap"),L=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),F=w.get("text-rotation-alignment")==="map",j=w.get("text-pitch-alignment")==="map",H=w.get("icon-text-fit")!=="none",K=new yn(null,0,k&&(M||!n.hasIconData()||w.get("icon-optional")),M&&(k||!n.hasTextData()||w.get("text-optional")),!0);!n.collisionArrays&&f&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(f);const re=(ue,he,Q)=>{for(let me=0;me<he/4;me++)ue.opacityVertexArray.emplaceBack(Q);ue.hasVisibleVertices=ue.hasVisibleVertices||Q!==Zo},oe=this.collisionBoxArrays.get(n.bucketInstanceId);for(let ue=0;ue<n.symbolInstances.length;ue++){const he=n.symbolInstances.get(ue),{numHorizontalGlyphVertices:Q,numVerticalGlyphVertices:me,crossTileID:ve}=he;let Te=this.opacities[ve];d[ve]?Te=T:Te||(Te=K,this.opacities[ve]=Te),d[ve]=!0;const ze=he.numIconVertices>0,Ve=this.placedOrientations[he.crossTileID],Ye=Ve===u.ah.vertical,nt=Ve===u.ah.horizontal||Ve===u.ah.horizontalOnly;if(Q>0||me>0){const Ze=Hr(Te.text);re(n.text,Q,Ye?Zo:Ze),re(n.text,me,nt?Zo:Ze);const at=Te.text.isHidden();[he.rightJustifiedTextSymbolIndex,he.centerJustifiedTextSymbolIndex,he.leftJustifiedTextSymbolIndex].forEach(Qe=>{Qe>=0&&(n.text.placedSymbolArray.get(Qe).hidden=at||Ye?1:0)}),he.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(he.verticalPlacedTextSymbolIndex).hidden=at||nt?1:0);const wt=this.variableOffsets[he.crossTileID];wt&&this.markUsedJustification(n,wt.anchor,he,Ve);const Xe=this.placedOrientations[he.crossTileID];Xe&&(this.markUsedJustification(n,"left",he,Xe),this.markUsedOrientation(n,Xe,he))}if(ze){const Ze=Hr(Te.icon),at=!(H&&he.verticalPlacedIconSymbolIndex&&Ye);he.placedIconSymbolIndex>=0&&(re(n.icon,he.numIconVertices,at?Ze:Zo),n.icon.placedSymbolArray.get(he.placedIconSymbolIndex).hidden=Te.icon.isHidden()),he.verticalPlacedIconSymbolIndex>=0&&(re(n.icon,he.numVerticalIconVertices,at?Zo:Ze),n.icon.placedSymbolArray.get(he.verticalPlacedIconSymbolIndex).hidden=Te.icon.isHidden())}const We=oe&&oe.has(ue)?oe.get(ue):{text:null,icon:null};if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Ze=n.collisionArrays[ue];if(Ze){let at=new u.P(0,0);if(Ze.textBox||Ze.verticalTextBox){let wt=!0;if(L){const Xe=this.variableOffsets[ve];Xe?(at=Qn(Xe.anchor,Xe.width,Xe.height,Xe.textOffset,Xe.textBoxScale),F&&at._rotate(j?this.transform.angle:-this.transform.angle)):wt=!1}if(Ze.textBox||Ze.verticalTextBox){let Xe;Ze.textBox&&(Xe=Ye),Ze.verticalTextBox&&(Xe=nt),qo(n.textCollisionBox.collisionVertexArray,Te.text.placed,!wt||Xe,We.text,at.x,at.y)}}if(Ze.iconBox||Ze.verticalIconBox){const wt=!!(!nt&&Ze.verticalIconBox);let Xe;Ze.iconBox&&(Xe=wt),Ze.verticalIconBox&&(Xe=!wt),qo(n.iconCollisionBox.collisionVertexArray,Te.icon.placed,Xe,We.icon,H?at.x:0,H?at.y:0)}}}}if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);if(n.bucketInstanceId in this.collisionCircleArrays){const ue=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=ue.invProjMatrix,n.placementViewportMatrix=ue.viewportMatrix,n.collisionCircleArray=ue.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,l){const d=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*d>n}setStale(){this.stale=!0}}function qo(_,n,l,d,f,y){d&&d.length!==0||(d=[0,0,0,0]);const w=d[0]-kt,T=d[1]-kt,k=d[2]-kt,M=d[3]-kt;_.emplaceBack(n?1:0,l?1:0,f||0,y||0,w,T),_.emplaceBack(n?1:0,l?1:0,f||0,y||0,k,T),_.emplaceBack(n?1:0,l?1:0,f||0,y||0,k,M),_.emplaceBack(n?1:0,l?1:0,f||0,y||0,w,M)}const Ht=Math.pow(2,25),Wc=Math.pow(2,24),Hc=Math.pow(2,17),Zr=Math.pow(2,16),Wr=Math.pow(2,9),ly=Math.pow(2,8),li=Math.pow(2,1);function Hr(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const n=_.placed?1:0,l=Math.floor(127*_.opacity);return l*Ht+n*Wc+l*Hc+n*Zr+l*Wr+n*ly+l*li+n}const Zo=0;function lo(){return{isOccluded:(_,n,l)=>!1,getPitchedTextCorrection:(_,n,l)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(_,n,l,d){throw new Error("Not implemented.")},translatePosition:(_,n,l,d)=>function(f,y,w,T,k=!1){if(!w[0]&&!w[1])return[0,0];const M=k?T==="map"?f.angle:0:T==="viewport"?-f.angle:0;if(M){const L=Math.sin(M),F=Math.cos(M);w=[w[0]*F-w[1]*L,w[0]*L+w[1]*F]}return[k?w[0]:Dt(y,w[0],f.zoom),k?w[1]:Dt(y,w[1],f.zoom)]}(_,n,l,d),getCircleRadiusCorrection:_=>1}}class Ln{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,l,d,f,y){const w=this._bucketParts;for(;this._currentTileIndex<n.length;)if(l.getBucketParts(w,f,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((T,k)=>T.sortKey-k.sortKey));this._currentPartIndex<w.length;)if(l.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,y())return!0;return!1}}class Ja{constructor(n,l,d,f,y,w,T,k){this.placement=new _r(n,lo(),l,w,T,k),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(n,l,d){const f=z.now(),y=()=>!this._forceFullPlacement&&z.now()-f>2;for(;this._currentPlacementIndex>=0;){const w=l[n[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=T)&&(!w.maxzoom||w.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new Ln(w)),this._inProgressLayer.continuePlacement(d[w.source],this.placement,this._showCollisionBoxes,w,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Pi=512/u.X/2;class Pn{constructor(n,l,d){this.tileID=n,this.bucketInstanceId=d,this._symbolsByKey={};const f=new Map;for(let y=0;y<l.length;y++){const w=l.get(y),T=w.key,k=f.get(T);k?k.push(w):f.set(T,[w])}for(const[y,w]of f){const T={positions:w.map(k=>({x:Math.floor(k.anchorX*Pi),y:Math.floor(k.anchorY*Pi)})),crossTileIDs:w.map(k=>k.crossTileID)};if(T.positions.length>128){const k=new u.av(T.positions.length,16,Uint16Array);for(const{x:M,y:L}of T.positions)k.add(M,L);k.finish(),delete T.positions,T.index=k}this._symbolsByKey[y]=T}}getScaledCoordinates(n,l){const{x:d,y:f,z:y}=this.tileID.canonical,{x:w,y:T,z:k}=l.canonical,M=Pi/Math.pow(2,k-y),L=(T*u.X+n.anchorY)*M,F=f*u.X*Pi;return{x:Math.floor((w*u.X+n.anchorX)*M-d*u.X*Pi),y:Math.floor(L-F)}}findMatches(n,l,d){const f=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z);for(let y=0;y<n.length;y++){const w=n.get(y);if(w.crossTileID)continue;const T=this._symbolsByKey[w.key];if(!T)continue;const k=this.getScaledCoordinates(w,l);if(T.index){const M=T.index.range(k.x-f,k.y-f,k.x+f,k.y+f).sort();for(const L of M){const F=T.crossTileIDs[L];if(!d[F]){d[F]=!0,w.crossTileID=F;break}}}else if(T.positions)for(let M=0;M<T.positions.length;M++){const L=T.positions[M],F=T.crossTileIDs[M];if(Math.abs(L.x-k.x)<=f&&Math.abs(L.y-k.y)<=f&&!d[F]){d[F]=!0,w.crossTileID=F;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:n})=>n)}}class eu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ei{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const l=Math.round((n-this.lng)/360);if(l!==0)for(const d in this.indexes){const f=this.indexes[d],y={};for(const w in f){const T=f[w];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+l),y[T.tileID.key]=T}this.indexes[d]=y}this.lng=n}addBucket(n,l,d){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let y=0;y<l.symbolInstances.length;y++)l.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const f=this.usedCrossTileIDs[n.overscaledZ];for(const y in this.indexes){const w=this.indexes[y];if(Number(y)>n.overscaledZ)for(const T in w){const k=w[T];k.tileID.isChildOf(n)&&k.findMatches(l.symbolInstances,n,f)}else{const T=w[n.scaledTo(Number(y)).key];T&&T.findMatches(l.symbolInstances,n,f)}}for(let y=0;y<l.symbolInstances.length;y++){const w=l.symbolInstances.get(y);w.crossTileID||(w.crossTileID=d.generate(),f[w.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Pn(n,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(n,l){for(const d of l.getCrossTileIDsLists())for(const f of d)delete this.usedCrossTileIDs[n][f]}removeStaleBuckets(n){let l=!1;for(const d in this.indexes){const f=this.indexes[d];for(const y in f)n[f[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,f[y]),delete f[y],l=!0)}return l}}class Xc{constructor(){this.layerIndexes={},this.crossTileIDs=new eu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,l,d){let f=this.layerIndexes[n.id];f===void 0&&(f=this.layerIndexes[n.id]=new Ei);let y=!1;const w={};f.handleWrapJump(d);for(const T of l){const k=T.getBucket(n);k&&n.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(T.tileID,k,this.crossTileIDs)&&(y=!0),w[k.bucketInstanceId]=!0)}return f.removeStaleBuckets(w)&&(y=!0),y}pruneUnusedLayers(n){const l={};n.forEach(d=>{l[d]=!0});for(const d in this.layerIndexes)l[d]||delete this.layerIndexes[d]}}const Ii=(_,n)=>u.t(_,n&&n.filter(l=>l.identifier!=="source.canvas")),uy=u.aw();class tu extends u.E{constructor(n,l={}){super(),this._rtlPluginLoaded=()=>{for(const d in this.sourceCaches){const f=this.sourceCaches[d].getSource().type;f!=="vector"&&f!=="geojson"||this.sourceCaches[d].reload()}},this.map=n,this.dispatcher=new xs(vs(),n._getMapId()),this.dispatcher.registerMessageHandler("GG",(d,f)=>this.getGlyphs(d,f)),this.dispatcher.registerMessageHandler("GI",(d,f)=>this.getImages(d,f)),this.imageManager=new je,this.imageManager.setEventedParent(this),this.glyphManager=new bt(n._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Gr(256,512),this.crossTileSymbolIndex=new Xc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",u.ay()),Yi().on($e,this._rtlPluginLoaded),this.on("data",d=>{if(d.dataType!=="source"||d.sourceDataType!=="metadata")return;const f=this.sourceCaches[d.sourceId];if(!f)return;const y=f.getSource();if(y&&y.vectorLayerIds)for(const w in this._layers){const T=this._layers[w];T.source===y.id&&this._validateLayer(T)}})}loadURL(n,l={},d){this.fire(new u.k("dataloading",{dataType:"style"})),l.validate=typeof l.validate!="boolean"||l.validate;const f=this.map._requestManager.transformRequest(n,"Style");this._loadStyleRequest=new AbortController;const y=this._loadStyleRequest;u.h(f,this._loadStyleRequest).then(w=>{this._loadStyleRequest=null,this._load(w.data,l,d)}).catch(w=>{this._loadStyleRequest=null,w&&!y.signal.aborted&&this.fire(new u.j(w))})}loadJSON(n,l={},d){this.fire(new u.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,z.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,l.validate=l.validate!==!1,this._load(n,l,d)}).catch(()=>{})}loadEmpty(){this.fire(new u.k("dataloading",{dataType:"style"})),this._load(uy,{validate:!1})}_load(n,l,d){var f;const y=l.transformStyle?l.transformStyle(d,n):n;if(!l.validate||!Ii(this,u.u(y))){this._loaded=!0,this.stylesheet=y;for(const w in y.sources)this.addSource(w,y.sources[w],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new gt(this.stylesheet.light),this.sky=new Bt(this.stylesheet.sky),this.map.setTerrain((f=this.stylesheet.terrain)!==null&&f!==void 0?f:null),this.fire(new u.k("data",{dataType:"style"})),this.fire(new u.k("style.load"))}}_createLayers(){const n=u.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",n),this._order=n.map(l=>l.id),this._layers={},this._serializedLayers=null;for(const l of n){const d=u.aA(l);d.setEventedParent(this,{layer:{id:l.id}}),this._layers[l.id]=d}}_loadSprite(n,l=!1,d=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(y,w,T,k){return u._(this,void 0,void 0,function*(){const M=Be(y),L=T>1?"@2x":"",F={},j={};for(const{id:H,url:K}of M){const re=w.transformRequest(Ue(K,L,".json"),"SpriteJSON");F[H]=u.h(re,k);const oe=w.transformRequest(Ue(K,L,".png"),"SpriteImage");j[H]=X.getImage(oe,k)}return yield Promise.all([...Object.values(F),...Object.values(j)]),function(H,K){return u._(this,void 0,void 0,function*(){const re={};for(const oe in H){re[oe]={};const ue=z.getImageCanvasContext((yield K[oe]).data),he=(yield H[oe]).data;for(const Q in he){const{width:me,height:ve,x:Te,y:ze,sdf:Ve,pixelRatio:Ye,stretchX:nt,stretchY:We,content:Ze,textFitWidth:at,textFitHeight:wt}=he[Q];re[oe][Q]={data:null,pixelRatio:Ye,sdf:Ve,stretchX:nt,stretchY:We,content:Ze,textFitWidth:at,textFitHeight:wt,spriteData:{width:me,height:ve,x:Te,y:ze,context:ue}}}}return re})}(F,j)})}(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(y=>{if(this._spriteRequest=null,y)for(const w in y){this._spritesImagesIds[w]=[];const T=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter(k=>!(k in y)):[];for(const k of T)this.imageManager.removeImage(k),this._changedImages[k]=!0;for(const k in y[w]){const M=w==="default"?k:`${w}:${k}`;this._spritesImagesIds[w].push(M),M in this.imageManager.images?this.imageManager.updateImage(M,y[w][k],!1):this.imageManager.addImage(M,y[w][k]),l&&(this._changedImages[M]=!0)}}}).catch(y=>{this._spriteRequest=null,f=y,this.fire(new u.j(f))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),l&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"})),d&&d(f)})}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}_validateLayer(n){const l=this.sourceCaches[n.source];if(!l)return;const d=n.sourceLayer;if(!d)return;const f=l.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(d)===-1)&&this.fire(new u.j(new Error(`Source layer "${d}" does not exist on source "${f.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n,l=!1){const d=this._serializedAllLayers();if(!n||n.length===0)return Object.values(l?u.aB(d):d);const f=[];for(const y of n)if(d[y]){const w=l?u.aB(d[y]):d[y];f.push(w)}return f}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const l=Object.keys(this._layers);for(const d of l){const f=this._layers[d];f.type!=="custom"&&(n[d]=f.serialize())}return n}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const l=this._changed;if(l){const f=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(f.length||y.length)&&this._updateWorkerLayers(f,y);for(const w in this._updatedSources){const T=this._updatedSources[w];if(T==="reload")this._reloadSource(w);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(n);this.light.updateTransitions(n),this.sky.updateTransitions(n),this._resetUpdates()}const d={};for(const f in this.sourceCaches){const y=this.sourceCaches[f];d[f]=y.used,y.used=!1}for(const f of this._order){const y=this._layers[f];y.recalculate(n,this._availableImages),!y.isHidden(n.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const f in d){const y=this.sourceCaches[f];!!d[f]!=!!y.used&&y.fire(new u.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(n),this.sky.recalculate(n),this.z=n.zoom,l&&this.fire(new u.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,l){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(n,!1),removedIds:l})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,l={}){var d;this._checkLoaded();const f=this.serialize();if(n=l.transformStyle?l.transformStyle(f,n):n,((d=l.validate)===null||d===void 0||d)&&Ii(this,u.u(n)))return!1;(n=u.aB(n)).layers=u.az(n.layers);const y=u.aC(f,n),w=this._getOperationsToPerform(y);if(w.unimplemented.length>0)throw new Error(`Unimplemented: ${w.unimplemented.join(", ")}.`);if(w.operations.length===0)return!1;for(const T of w.operations)T();return this.stylesheet=n,this._serializedLayers=null,!0}_getOperationsToPerform(n){const l=[],d=[];for(const f of n)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":l.push(()=>this.addLayer.apply(this,f.args));break;case"removeLayer":l.push(()=>this.removeLayer.apply(this,f.args));break;case"setPaintProperty":l.push(()=>this.setPaintProperty.apply(this,f.args));break;case"setLayoutProperty":l.push(()=>this.setLayoutProperty.apply(this,f.args));break;case"setFilter":l.push(()=>this.setFilter.apply(this,f.args));break;case"addSource":l.push(()=>this.addSource.apply(this,f.args));break;case"removeSource":l.push(()=>this.removeSource.apply(this,f.args));break;case"setLayerZoomRange":l.push(()=>this.setLayerZoomRange.apply(this,f.args));break;case"setLight":l.push(()=>this.setLight.apply(this,f.args));break;case"setGeoJSONSourceData":l.push(()=>this.setGeoJSONSourceData.apply(this,f.args));break;case"setGlyphs":l.push(()=>this.setGlyphs.apply(this,f.args));break;case"setSprite":l.push(()=>this.setSprite.apply(this,f.args));break;case"setSky":l.push(()=>this.setSky.apply(this,f.args));break;case"setTerrain":l.push(()=>this.map.setTerrain.apply(this,f.args));break;case"setTransition":l.push(()=>{});break;default:d.push(f.command)}return{operations:l,unimplemented:d}}addImage(n,l){if(this.getImage(n))return this.fire(new u.j(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,l),this._afterImageUpdated(n)}updateImage(n,l){this.imageManager.updateImage(n,l)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new u.j(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,l,d={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(u.u.source,`sources.${n}`,l,null,d))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const f=this.sourceCaches[n]=new _t(n,l,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:n})),f.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===n)return this.fire(new u.j(new Error(`Source "${n}" cannot be removed while layer "${d}" is using it.`)));const l=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],l.fire(new u.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),l.setEventedParent(null),l.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,l){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const d=this.sourceCaches[n].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(l),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,l,d={}){this._checkLoaded();const f=n.id;if(this.getLayer(f))return void this.fire(new u.j(new Error(`Layer "${f}" already exists on this map.`)));let y;if(n.type==="custom"){if(Ii(this,u.aD(n)))return;y=u.aA(n)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(f,n.source),n=u.aB(n),n=u.e(n,{source:f})),this._validate(u.u.layer,`layers.${f}`,n,{arrayIndex:-1},d))return;y=u.aA(n),this._validateLayer(y),y.setEventedParent(this,{layer:{id:f}})}const w=l?this._order.indexOf(l):this._order.length;if(l&&w===-1)this.fire(new u.j(new Error(`Cannot add layer "${f}" before non-existing layer "${l}".`)));else{if(this._order.splice(w,0,f),this._layerOrderChanged=!0,this._layers[f]=y,this._removedLayers[f]&&y.source&&y.type!=="custom"){const T=this._removedLayers[f];delete this._removedLayers[f],T.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(n,l){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new u.j(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===l)return;const d=this._order.indexOf(n);this._order.splice(d,1);const f=l?this._order.indexOf(l):this._order.length;l&&f===-1?this.fire(new u.j(new Error(`Cannot move layer "${n}" before non-existing layer "${l}".`))):(this._order.splice(f,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const l=this._layers[n];if(!l)return void this.fire(new u.j(new Error(`Cannot remove non-existing layer "${n}".`)));l.setEventedParent(null);const d=this._order.indexOf(n);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,l,d){this._checkLoaded();const f=this.getLayer(n);f?f.minzoom===l&&f.maxzoom===d||(l!=null&&(f.minzoom=l),d!=null&&(f.maxzoom=d),this._updateLayer(f)):this.fire(new u.j(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,l,d={}){this._checkLoaded();const f=this.getLayer(n);if(f){if(!u.aE(f.filter,l))return l==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(u.u.filter,`layers.${f.id}.filter`,l,null,d)||(f.filter=u.aB(l),this._updateLayer(f)))}else this.fire(new u.j(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return u.aB(this.getLayer(n).filter)}setLayoutProperty(n,l,d,f={}){this._checkLoaded();const y=this.getLayer(n);y?u.aE(y.getLayoutProperty(l),d)||(y.setLayoutProperty(l,d,f),this._updateLayer(y)):this.fire(new u.j(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,l){const d=this.getLayer(n);if(d)return d.getLayoutProperty(l);this.fire(new u.j(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,l,d,f={}){this._checkLoaded();const y=this.getLayer(n);y?u.aE(y.getPaintProperty(l),d)||(y.setPaintProperty(l,d,f)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[n]=!0,this._serializedLayers=null):this.fire(new u.j(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,l){return this.getLayer(n).getPaintProperty(l)}setFeatureState(n,l){this._checkLoaded();const d=n.source,f=n.sourceLayer,y=this.sourceCaches[d];if(y===void 0)return void this.fire(new u.j(new Error(`The source '${d}' does not exist in the map's style.`)));const w=y.getSource().type;w==="geojson"&&f?this.fire(new u.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||f?(n.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),y.setFeatureState(f,n.id,l)):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,l){this._checkLoaded();const d=n.source,f=this.sourceCaches[d];if(f===void 0)return void this.fire(new u.j(new Error(`The source '${d}' does not exist in the map's style.`)));const y=f.getSource().type,w=y==="vector"?n.sourceLayer:void 0;y!=="vector"||w?l&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new u.j(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(w,n.id,l):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const l=n.source,d=n.sourceLayer,f=this.sourceCaches[l];if(f!==void 0)return f.getSource().type!=="vector"||d?(n.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),f.getFeatureState(d,n.id)):void this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.j(new Error(`The source '${l}' does not exist in the map's style.`)))}getTransition(){return u.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=u.aF(this.sourceCaches,y=>y.serialize()),l=this._serializeByIds(this._order,!0),d=this.map.getTerrain()||void 0,f=this.stylesheet;return u.aG({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,sources:n,layers:l,terrain:d},y=>y!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const l=w=>this._layers[w].type==="fill-extrusion",d={},f=[];for(let w=this._order.length-1;w>=0;w--){const T=this._order[w];if(l(T)){d[T]=w;for(const k of n){const M=k[T];if(M)for(const L of M)f.push(L)}}}f.sort((w,T)=>T.intersectionZ-w.intersectionZ);const y=[];for(let w=this._order.length-1;w>=0;w--){const T=this._order[w];if(l(T))for(let k=f.length-1;k>=0;k--){const M=f[k].feature;if(d[M.layer.id]<w)break;y.push(M),f.pop()}else for(const k of n){const M=k[T];if(M)for(const L of M)y.push(L.feature)}}return y}queryRenderedFeatures(n,l,d){l&&l.filter&&this._validate(u.u.filter,"queryRenderedFeatures.filter",l.filter,null,l);const f={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new u.j(new Error("parameters.layers must be an Array."))),[];for(const T of l.layers){const k=this._layers[T];if(!k)return this.fire(new u.j(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];f[k.source]=!0}}const y=[];l.availableImages=this._availableImages;const w=this._serializedAllLayers();for(const T in this.sourceCaches)l.layers&&!f[T]||y.push(Xi(this.sourceCaches[T],this._layers,w,n,l,d));return this.placement&&y.push(function(T,k,M,L,F,j,H){const K={},re=j.queryRenderedSymbols(L),oe=[];for(const ue of Object.keys(re).map(Number))oe.push(H[ue]);oe.sort(si);for(const ue of oe){const he=ue.featureIndex.lookupSymbolFeatures(re[ue.bucketInstanceId],k,ue.bucketIndex,ue.sourceLayerIndex,F.filter,F.layers,F.availableImages,T);for(const Q in he){const me=K[Q]=K[Q]||[],ve=he[Q];ve.sort((Te,ze)=>{const Ve=ue.featureSortOrder;if(Ve){const Ye=Ve.indexOf(Te.featureIndex);return Ve.indexOf(ze.featureIndex)-Ye}return ze.featureIndex-Te.featureIndex});for(const Te of ve)me.push(Te)}}for(const ue in K)K[ue].forEach(he=>{const Q=he.feature,me=M[T[ue].source].getFeatureState(Q.layer["source-layer"],Q.id);Q.source=Q.layer.source,Q.layer["source-layer"]&&(Q.sourceLayer=Q.layer["source-layer"]),Q.state=me});return K}(this._layers,w,this.sourceCaches,n,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(n,l){l&&l.filter&&this._validate(u.u.filter,"querySourceFeatures.filter",l.filter,null,l);const d=this.sourceCaches[n];return d?function(f,y){const w=f.getRenderableIds().map(M=>f.getTileByID(M)),T=[],k={};for(let M=0;M<w.length;M++){const L=w[M],F=L.tileID.canonical.key;k[F]||(k[F]=!0,L.querySourceFeatures(T,y))}return T}(d,l):[]}getLight(){return this.light.getLight()}setLight(n,l={}){this._checkLoaded();const d=this.light.getLight();let f=!1;for(const w in n)if(!u.aE(n[w],d[w])){f=!0;break}if(!f)return;const y={now:z.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(y)}getSky(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.sky}setSky(n,l={}){const d=this.getSky();let f=!1;if(!n&&!d)return;if(n&&!d)f=!0;else if(!n&&d)f=!0;else for(const w in n)if(!u.aE(n[w],d[w])){f=!0;break}if(!f)return;const y={now:z.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=n,this.sky.setSky(n,l),this.sky.updateTransitions(y)}_validate(n,l,d,f,y={}){return(!y||y.validate!==!1)&&Ii(this,n.call(u.u,u.e({key:l,style:this.serialize(),value:d,styleSpec:u.v},f)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Yi().off($e,this._rtlPluginLoaded);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this.sourceCaches){const d=this.sourceCaches[l];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const l in this.sourceCaches)this.sourceCaches[l].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,l,d,f,y=!1){let w=!1,T=!1;const k={};for(const M of this._order){const L=this._layers[M];if(L.type!=="symbol")continue;if(!k[L.source]){const j=this.sourceCaches[L.source];k[L.source]=j.getRenderableIds(!0).map(H=>j.getTileByID(H)).sort((H,K)=>K.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(K.tileID)?-1:1))}const F=this.crossTileSymbolIndex.addLayer(L,k[L.source],n.center.lng);w=w||F}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(z.now(),n.zoom))&&(this.pauseablePlacement=new Ja(n,this.map.terrain,this._order,y,l,d,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(z.now()),T=!0),w&&this.pauseablePlacement.placement.setStale()),T||w)for(const M of this._order){const L=this._layers[M];L.type==="symbol"&&this.placement.updateLayerOpacities(L,k[L.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(z.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,l){return u._(this,void 0,void 0,function*(){const d=yield this.imageManager.getImages(l.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[l.source];return f&&f.setDependencies(l.tileID.key,l.type,l.icons),d})}getGlyphs(n,l){return u._(this,void 0,void 0,function*(){const d=yield this.glyphManager.getGlyphs(l.stacks),f=this.sourceCaches[l.source];return f&&f.setDependencies(l.tileID.key,l.type,[""]),d})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,l={}){this._checkLoaded(),n&&this._validate(u.u.glyphs,"glyphs",n,null,l)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,l,d={},f){this._checkLoaded();const y=[{id:n,url:l}],w=[...Be(this.stylesheet.sprite),...y];this._validate(u.u.sprite,"sprite",w,null,d)||(this.stylesheet.sprite=w,this._loadSprite(y,!0,f))}removeSprite(n){this._checkLoaded();const l=Be(this.stylesheet.sprite);if(l.find(d=>d.id===n)){if(this._spritesImagesIds[n])for(const d of this._spritesImagesIds[n])this.imageManager.removeImage(d),this._changedImages[d]=!0;l.splice(l.findIndex(d=>d.id===n),1),this.stylesheet.sprite=l.length>0?l:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}else this.fire(new u.j(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return Be(this.stylesheet.sprite)}setSprite(n,l={},d){this._checkLoaded(),n&&this._validate(u.u.sprite,"sprite",n,null,l)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,d):(this._unloadSprite(),d&&d(null)))}}var uo=u.Y([{name:"a_pos",type:"Int16",components:2}]);const Vs={prelude:Gt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Gt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Gt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Gt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Gt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Gt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:Gt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Gt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Gt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Gt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Gt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Gt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Gt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Gt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Gt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Gt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Gt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Gt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Gt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Gt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Gt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Gt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Gt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Gt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Gt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Gt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Gt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Gt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Gt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:Gt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Gt(_,n){const l=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=n.match(/attribute ([\w]+) ([\w]+)/g),f=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=y?y.concat(f):f,T={};return{fragmentSource:_=_.replace(l,(k,M,L,F,j)=>(T[j]=!0,M==="define"?`
#ifndef HAS_UNIFORM_u_${j}
varying ${L} ${F} ${j};
#else
uniform ${L} ${F} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${L} ${F} ${j} = u_${j};
#endif
`)),vertexSource:n=n.replace(l,(k,M,L,F,j)=>{const H=F==="float"?"vec2":"vec4",K=j.match(/color/)?"color":H;return T[j]?M==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
attribute ${L} ${H} a_${j};
varying ${L} ${F} ${j};
#else
uniform ${L} ${F} u_${j};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${L} ${F} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${K}(a_${j}, u_${j}_t);
#else
    ${L} ${F} ${j} = u_${j};
#endif
`:M==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
attribute ${L} ${H} a_${j};
#else
uniform ${L} ${F} u_${j};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${L} ${F} ${j} = a_${j};
#else
    ${L} ${F} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${L} ${F} ${j} = unpack_mix_${K}(a_${j}, u_${j}_t);
#else
    ${L} ${F} ${j} = u_${j};
#endif
`}),staticAttributes:d,staticUniforms:w}}class Kc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,l,d,f,y,w,T,k,M){this.context=n;let L=this.boundPaintVertexBuffers.length!==f.length;for(let F=0;!L&&F<f.length;F++)this.boundPaintVertexBuffers[F]!==f[F]&&(L=!0);!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==d||L||this.boundIndexBuffer!==y||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==k||this.boundDynamicVertexBuffer3!==M?this.freshBind(l,d,f,y,w,T,k,M):(n.bindVertexArray.set(this.vao),T&&T.bind(),y&&y.dynamicDraw&&y.bind(),k&&k.bind(),M&&M.bind())}freshBind(n,l,d,f,y,w,T,k){const M=n.numAttributes,L=this.context,F=L.gl;this.vao&&this.destroy(),this.vao=L.createVertexArray(),L.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=f,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=k,l.enableAttributes(F,n);for(const j of d)j.enableAttributes(F,n);w&&w.enableAttributes(F,n),T&&T.enableAttributes(F,n),k&&k.enableAttributes(F,n),l.bind(),l.setVertexAttribPointers(F,n,y);for(const j of d)j.bind(),j.setVertexAttribPointers(F,n,y);w&&(w.bind(),w.setVertexAttribPointers(F,n,y)),f&&f.bind(),T&&(T.bind(),T.setVertexAttribPointers(F,n,y)),k&&(k.bind(),k.setVertexAttribPointers(F,n,y)),L.currentNumAttributes=M}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Yc=(_,n,l,d,f)=>({u_matrix:_,u_texture:0,u_ele_delta:n,u_fog_matrix:l,u_fog_color:d?d.properties.get("fog-color"):u.aM.white,u_fog_ground_blend:d?d.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:d?d.calculateFogBlendOpacity(f):0,u_horizon_color:d?d.properties.get("horizon-color"):u.aM.white,u_horizon_fog_blend:d?d.properties.get("horizon-fog-blend"):1});function Wo(_){const n=[];for(let l=0;l<_.length;l++){if(_[l]===null)continue;const d=_[l].split(" ");n.push(d.pop())}return n}class Jc{constructor(n,l,d,f,y,w){const T=n.gl;this.program=T.createProgram();const k=Wo(l.staticAttributes),M=d?d.getBinderAttributes():[],L=k.concat(M),F=Vs.prelude.staticUniforms?Wo(Vs.prelude.staticUniforms):[],j=l.staticUniforms?Wo(l.staticUniforms):[],H=d?d.getBinderUniforms():[],K=F.concat(j).concat(H),re=[];for(const Te of K)re.indexOf(Te)<0&&re.push(Te);const oe=d?d.defines():[];y&&oe.push("#define OVERDRAW_INSPECTOR;"),w&&oe.push("#define TERRAIN3D;");const ue=oe.concat(Vs.prelude.fragmentSource,l.fragmentSource).join(`
`),he=oe.concat(Vs.prelude.vertexSource,l.vertexSource).join(`
`),Q=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(Q,ue),T.compileShader(Q),!T.getShaderParameter(Q,T.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${T.getShaderInfoLog(Q)}`);T.attachShader(this.program,Q);const me=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(me,he),T.compileShader(me),!T.getShaderParameter(me,T.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${T.getShaderInfoLog(me)}`);T.attachShader(this.program,me),this.attributes={};const ve={};this.numAttributes=L.length;for(let Te=0;Te<this.numAttributes;Te++)L[Te]&&(T.bindAttribLocation(this.program,Te,L[Te]),this.attributes[L[Te]]=Te);if(T.linkProgram(this.program),!T.getProgramParameter(this.program,T.LINK_STATUS))throw new Error(`Program failed to link: ${T.getProgramInfoLog(this.program)}`);T.deleteShader(me),T.deleteShader(Q);for(let Te=0;Te<re.length;Te++){const ze=re[Te];if(ze&&!ve[ze]){const Ve=T.getUniformLocation(this.program,ze);Ve&&(ve[ze]=Ve)}}this.fixedUniforms=f(n,ve),this.terrainUniforms=((Te,ze)=>({u_depth:new u.aH(Te,ze.u_depth),u_terrain:new u.aH(Te,ze.u_terrain),u_terrain_dim:new u.aI(Te,ze.u_terrain_dim),u_terrain_matrix:new u.aJ(Te,ze.u_terrain_matrix),u_terrain_unpack:new u.aK(Te,ze.u_terrain_unpack),u_terrain_exaggeration:new u.aI(Te,ze.u_terrain_exaggeration)}))(n,ve),this.binderUniforms=d?d.getUniforms(n,ve):[]}draw(n,l,d,f,y,w,T,k,M,L,F,j,H,K,re,oe,ue,he){const Q=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(d),n.setStencilMode(f),n.setColorMode(y),n.setCullFace(w),k){n.activeTexture.set(Q.TEXTURE2),Q.bindTexture(Q.TEXTURE_2D,k.depthTexture),n.activeTexture.set(Q.TEXTURE3),Q.bindTexture(Q.TEXTURE_2D,k.texture);for(const ve in this.terrainUniforms)this.terrainUniforms[ve].set(k[ve])}for(const ve in this.fixedUniforms)this.fixedUniforms[ve].set(T[ve]);re&&re.setUniforms(n,this.binderUniforms,H,{zoom:K});let me=0;switch(l){case Q.LINES:me=2;break;case Q.TRIANGLES:me=3;break;case Q.LINE_STRIP:me=1}for(const ve of j.get()){const Te=ve.vaos||(ve.vaos={});(Te[M]||(Te[M]=new Kc)).bind(n,this,L,re?re.getPaintVertexBuffers():[],F,ve.vertexOffset,oe,ue,he),Q.drawElements(l,ve.primitiveLength*me,Q.UNSIGNED_SHORT,ve.primitiveOffset*me*2)}}}function nu(_,n,l){const d=1/Dt(l,1,n.transform.tileZoom),f=Math.pow(2,l.tileID.overscaledZ),y=l.tileSize*Math.pow(2,n.transform.tileZoom)/f,w=y*(l.tileID.canonical.x+l.tileID.wrap*f),T=y*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[d,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[w>>16,T>>16],u_pixel_coord_lower:[65535&w,65535&T]}}const Qa=(_,n,l,d)=>{const f=n.style.light,y=f.properties.get("position"),w=[y.x,y.y,y.z],T=function(){var M=new u.A(9);return u.A!=Float32Array&&(M[1]=0,M[2]=0,M[3]=0,M[5]=0,M[6]=0,M[7]=0),M[0]=1,M[4]=1,M[8]=1,M}();f.properties.get("anchor")==="viewport"&&function(M,L){var F=Math.sin(L),j=Math.cos(L);M[0]=j,M[1]=F,M[2]=0,M[3]=-F,M[4]=j,M[5]=0,M[6]=0,M[7]=0,M[8]=1}(T,-n.transform.angle),function(M,L,F){var j=L[0],H=L[1],K=L[2];M[0]=j*F[0]+H*F[3]+K*F[6],M[1]=j*F[1]+H*F[4]+K*F[7],M[2]=j*F[2]+H*F[5]+K*F[8]}(w,w,T);const k=f.properties.get("color");return{u_matrix:_,u_lightpos:w,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+l,u_opacity:d}},ru=(_,n,l,d,f,y,w)=>u.e(Qa(_,n,l,d),nu(y,n,w),{u_height_factor:-Math.pow(2,f.overscaledZ)/w.tileSize/8}),Ho=_=>({u_matrix:_}),If=(_,n,l,d)=>u.e(Ho(_),nu(l,n,d)),cy=(_,n)=>({u_matrix:_,u_world:n}),Mf=(_,n,l,d,f)=>u.e(If(_,n,l,d),{u_world:f}),hy=(_,n,l,d)=>{const f=_.transform;let y,w;if(d.paint.get("circle-pitch-alignment")==="map"){const T=Dt(l,1,f.zoom);y=!0,w=[T,T]}else y=!1,w=f.pixelsToGLUnits;return{u_camera_to_center_distance:f.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:_.translatePosMatrix(n.posMatrix,l,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:_.pixelRatio,u_extrude_scale:w}},co=(_,n,l)=>({u_matrix:_,u_inv_matrix:n,u_camera_to_center_distance:l.cameraToCenterDistance,u_viewport_size:[l.width,l.height]}),el=(_,n,l=1)=>({u_matrix:_,u_color:n,u_overlay:0,u_overlay_scale:l}),Ir=_=>({u_matrix:_}),Mr=(_,n,l,d)=>({u_matrix:_,u_extrude_scale:Dt(n,1,l),u_intensity:d}),iu=(_,n,l,d)=>{const f=u.H();u.aP(f,0,_.width,_.height,0,0,1);const y=_.context.gl;return{u_matrix:f,u_world:[y.drawingBufferWidth,y.drawingBufferHeight],u_image:l,u_color_ramp:d,u_opacity:n.paint.get("heatmap-opacity")}};function su(_,n){const l=Math.pow(2,n.canonical.z),d=n.canonical.y;return[new u.Z(0,d/l).toLngLat().lat,new u.Z(0,(d+1)/l).toLngLat().lat]}const ou=(_,n,l,d)=>{const f=_.transform;return{u_matrix:Df(_,n,l,d),u_ratio:1/Dt(n,1,f.zoom),u_device_pixel_ratio:_.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},Af=(_,n,l,d,f)=>u.e(ou(_,n,l,f),{u_image:0,u_image_height:d}),Xo=(_,n,l,d,f)=>{const y=_.transform,w=zf(n,y);return{u_matrix:Df(_,n,l,f),u_texsize:n.imageAtlasTexture.size,u_ratio:1/Dt(n,1,y.zoom),u_device_pixel_ratio:_.pixelRatio,u_image:0,u_scale:[w,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},dy=(_,n,l,d,f,y)=>{const w=_.lineAtlas,T=zf(n,_.transform),k=l.layout.get("line-cap")==="round",M=w.getDash(d.from,k),L=w.getDash(d.to,k),F=M.width*f.fromScale,j=L.width*f.toScale;return u.e(ou(_,n,l,y),{u_patternscale_a:[T/F,-M.height/2],u_patternscale_b:[T/j,-L.height/2],u_sdfgamma:w.width/(256*Math.min(F,j)*_.pixelRatio)/2,u_image:0,u_tex_y_a:M.y,u_tex_y_b:L.y,u_mix:f.t})};function zf(_,n){return 1/Dt(_,1,n.tileZoom)}function Df(_,n,l,d){return _.translatePosMatrix(d?d.posMatrix:n.tileID.posMatrix,n,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const fy=(_,n,l,d,f)=>{return{u_matrix:_,u_tl_parent:n,u_scale_parent:l,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(w=f.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(y=f.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:py(f.paint.get("raster-hue-rotate"))};var y,w};function py(_){_*=Math.PI/180;const n=Math.sin(_),l=Math.cos(_);return[(2*l+1)/3,(-Math.sqrt(3)*n-l+1)/3,(Math.sqrt(3)*n-l+1)/3]}const Rf=(_,n,l,d,f,y,w,T,k,M,L,F,j,H)=>{const K=w.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:K.cameraToCenterDistance,u_pitch:K.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:K.width/K.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:k,u_coord_matrix:M,u_is_text:+F,u_pitch_with_map:+d,u_is_along_line:f,u_is_variable_anchor:y,u_texsize:j,u_texture:0,u_translation:L,u_pitched_scale:H}},tl=(_,n,l,d,f,y,w,T,k,M,L,F,j,H,K)=>{const re=w.transform;return u.e(Rf(_,n,l,d,f,y,w,T,k,M,L,F,j,K),{u_gamma_scale:d?Math.cos(re._pitch)*re.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:1})},Qc=(_,n,l,d,f,y,w,T,k,M,L,F,j,H)=>u.e(tl(_,n,l,d,f,y,w,T,k,M,L,!0,F,!0,H),{u_texsize_icon:j,u_texture_icon:1}),au=(_,n,l)=>({u_matrix:_,u_opacity:n,u_color:l}),eh=(_,n,l,d,f,y)=>u.e(function(w,T,k,M){const L=k.imageManager.getPattern(w.from.toString()),F=k.imageManager.getPattern(w.to.toString()),{width:j,height:H}=k.imageManager.getPixelSize(),K=Math.pow(2,M.tileID.overscaledZ),re=M.tileSize*Math.pow(2,k.transform.tileZoom)/K,oe=re*(M.tileID.canonical.x+M.tileID.wrap*K),ue=re*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:L.tl,u_pattern_br_a:L.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[j,H],u_mix:T.t,u_pattern_size_a:L.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/Dt(M,1,k.transform.tileZoom),u_pixel_coord_upper:[oe>>16,ue>>16],u_pixel_coord_lower:[65535&oe,65535&ue]}}(d,y,l,f),{u_matrix:_,u_opacity:n}),th={fillExtrusion:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_lightpos:new u.aN(_,n.u_lightpos),u_lightintensity:new u.aI(_,n.u_lightintensity),u_lightcolor:new u.aN(_,n.u_lightcolor),u_vertical_gradient:new u.aI(_,n.u_vertical_gradient),u_opacity:new u.aI(_,n.u_opacity)}),fillExtrusionPattern:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_lightpos:new u.aN(_,n.u_lightpos),u_lightintensity:new u.aI(_,n.u_lightintensity),u_lightcolor:new u.aN(_,n.u_lightcolor),u_vertical_gradient:new u.aI(_,n.u_vertical_gradient),u_height_factor:new u.aI(_,n.u_height_factor),u_image:new u.aH(_,n.u_image),u_texsize:new u.aO(_,n.u_texsize),u_pixel_coord_upper:new u.aO(_,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(_,n.u_pixel_coord_lower),u_scale:new u.aN(_,n.u_scale),u_fade:new u.aI(_,n.u_fade),u_opacity:new u.aI(_,n.u_opacity)}),fill:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix)}),fillPattern:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_image:new u.aH(_,n.u_image),u_texsize:new u.aO(_,n.u_texsize),u_pixel_coord_upper:new u.aO(_,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(_,n.u_pixel_coord_lower),u_scale:new u.aN(_,n.u_scale),u_fade:new u.aI(_,n.u_fade)}),fillOutline:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_world:new u.aO(_,n.u_world)}),fillOutlinePattern:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_world:new u.aO(_,n.u_world),u_image:new u.aH(_,n.u_image),u_texsize:new u.aO(_,n.u_texsize),u_pixel_coord_upper:new u.aO(_,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(_,n.u_pixel_coord_lower),u_scale:new u.aN(_,n.u_scale),u_fade:new u.aI(_,n.u_fade)}),circle:(_,n)=>({u_camera_to_center_distance:new u.aI(_,n.u_camera_to_center_distance),u_scale_with_map:new u.aH(_,n.u_scale_with_map),u_pitch_with_map:new u.aH(_,n.u_pitch_with_map),u_extrude_scale:new u.aO(_,n.u_extrude_scale),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_matrix:new u.aJ(_,n.u_matrix)}),collisionBox:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_pixel_extrude_scale:new u.aO(_,n.u_pixel_extrude_scale)}),collisionCircle:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_inv_matrix:new u.aJ(_,n.u_inv_matrix),u_camera_to_center_distance:new u.aI(_,n.u_camera_to_center_distance),u_viewport_size:new u.aO(_,n.u_viewport_size)}),debug:(_,n)=>({u_color:new u.aL(_,n.u_color),u_matrix:new u.aJ(_,n.u_matrix),u_overlay:new u.aH(_,n.u_overlay),u_overlay_scale:new u.aI(_,n.u_overlay_scale)}),clippingMask:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix)}),heatmap:(_,n)=>({u_extrude_scale:new u.aI(_,n.u_extrude_scale),u_intensity:new u.aI(_,n.u_intensity),u_matrix:new u.aJ(_,n.u_matrix)}),heatmapTexture:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_world:new u.aO(_,n.u_world),u_image:new u.aH(_,n.u_image),u_color_ramp:new u.aH(_,n.u_color_ramp),u_opacity:new u.aI(_,n.u_opacity)}),hillshade:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_image:new u.aH(_,n.u_image),u_latrange:new u.aO(_,n.u_latrange),u_light:new u.aO(_,n.u_light),u_shadow:new u.aL(_,n.u_shadow),u_highlight:new u.aL(_,n.u_highlight),u_accent:new u.aL(_,n.u_accent)}),hillshadePrepare:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_image:new u.aH(_,n.u_image),u_dimension:new u.aO(_,n.u_dimension),u_zoom:new u.aI(_,n.u_zoom),u_unpack:new u.aK(_,n.u_unpack)}),line:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_ratio:new u.aI(_,n.u_ratio),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_units_to_pixels:new u.aO(_,n.u_units_to_pixels)}),lineGradient:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_ratio:new u.aI(_,n.u_ratio),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_units_to_pixels:new u.aO(_,n.u_units_to_pixels),u_image:new u.aH(_,n.u_image),u_image_height:new u.aI(_,n.u_image_height)}),linePattern:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_texsize:new u.aO(_,n.u_texsize),u_ratio:new u.aI(_,n.u_ratio),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_image:new u.aH(_,n.u_image),u_units_to_pixels:new u.aO(_,n.u_units_to_pixels),u_scale:new u.aN(_,n.u_scale),u_fade:new u.aI(_,n.u_fade)}),lineSDF:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_ratio:new u.aI(_,n.u_ratio),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_units_to_pixels:new u.aO(_,n.u_units_to_pixels),u_patternscale_a:new u.aO(_,n.u_patternscale_a),u_patternscale_b:new u.aO(_,n.u_patternscale_b),u_sdfgamma:new u.aI(_,n.u_sdfgamma),u_image:new u.aH(_,n.u_image),u_tex_y_a:new u.aI(_,n.u_tex_y_a),u_tex_y_b:new u.aI(_,n.u_tex_y_b),u_mix:new u.aI(_,n.u_mix)}),raster:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_tl_parent:new u.aO(_,n.u_tl_parent),u_scale_parent:new u.aI(_,n.u_scale_parent),u_buffer_scale:new u.aI(_,n.u_buffer_scale),u_fade_t:new u.aI(_,n.u_fade_t),u_opacity:new u.aI(_,n.u_opacity),u_image0:new u.aH(_,n.u_image0),u_image1:new u.aH(_,n.u_image1),u_brightness_low:new u.aI(_,n.u_brightness_low),u_brightness_high:new u.aI(_,n.u_brightness_high),u_saturation_factor:new u.aI(_,n.u_saturation_factor),u_contrast_factor:new u.aI(_,n.u_contrast_factor),u_spin_weights:new u.aN(_,n.u_spin_weights)}),symbolIcon:(_,n)=>({u_is_size_zoom_constant:new u.aH(_,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aH(_,n.u_is_size_feature_constant),u_size_t:new u.aI(_,n.u_size_t),u_size:new u.aI(_,n.u_size),u_camera_to_center_distance:new u.aI(_,n.u_camera_to_center_distance),u_pitch:new u.aI(_,n.u_pitch),u_rotate_symbol:new u.aH(_,n.u_rotate_symbol),u_aspect_ratio:new u.aI(_,n.u_aspect_ratio),u_fade_change:new u.aI(_,n.u_fade_change),u_matrix:new u.aJ(_,n.u_matrix),u_label_plane_matrix:new u.aJ(_,n.u_label_plane_matrix),u_coord_matrix:new u.aJ(_,n.u_coord_matrix),u_is_text:new u.aH(_,n.u_is_text),u_pitch_with_map:new u.aH(_,n.u_pitch_with_map),u_is_along_line:new u.aH(_,n.u_is_along_line),u_is_variable_anchor:new u.aH(_,n.u_is_variable_anchor),u_texsize:new u.aO(_,n.u_texsize),u_texture:new u.aH(_,n.u_texture),u_translation:new u.aO(_,n.u_translation),u_pitched_scale:new u.aI(_,n.u_pitched_scale)}),symbolSDF:(_,n)=>({u_is_size_zoom_constant:new u.aH(_,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aH(_,n.u_is_size_feature_constant),u_size_t:new u.aI(_,n.u_size_t),u_size:new u.aI(_,n.u_size),u_camera_to_center_distance:new u.aI(_,n.u_camera_to_center_distance),u_pitch:new u.aI(_,n.u_pitch),u_rotate_symbol:new u.aH(_,n.u_rotate_symbol),u_aspect_ratio:new u.aI(_,n.u_aspect_ratio),u_fade_change:new u.aI(_,n.u_fade_change),u_matrix:new u.aJ(_,n.u_matrix),u_label_plane_matrix:new u.aJ(_,n.u_label_plane_matrix),u_coord_matrix:new u.aJ(_,n.u_coord_matrix),u_is_text:new u.aH(_,n.u_is_text),u_pitch_with_map:new u.aH(_,n.u_pitch_with_map),u_is_along_line:new u.aH(_,n.u_is_along_line),u_is_variable_anchor:new u.aH(_,n.u_is_variable_anchor),u_texsize:new u.aO(_,n.u_texsize),u_texture:new u.aH(_,n.u_texture),u_gamma_scale:new u.aI(_,n.u_gamma_scale),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_is_halo:new u.aH(_,n.u_is_halo),u_translation:new u.aO(_,n.u_translation),u_pitched_scale:new u.aI(_,n.u_pitched_scale)}),symbolTextAndIcon:(_,n)=>({u_is_size_zoom_constant:new u.aH(_,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aH(_,n.u_is_size_feature_constant),u_size_t:new u.aI(_,n.u_size_t),u_size:new u.aI(_,n.u_size),u_camera_to_center_distance:new u.aI(_,n.u_camera_to_center_distance),u_pitch:new u.aI(_,n.u_pitch),u_rotate_symbol:new u.aH(_,n.u_rotate_symbol),u_aspect_ratio:new u.aI(_,n.u_aspect_ratio),u_fade_change:new u.aI(_,n.u_fade_change),u_matrix:new u.aJ(_,n.u_matrix),u_label_plane_matrix:new u.aJ(_,n.u_label_plane_matrix),u_coord_matrix:new u.aJ(_,n.u_coord_matrix),u_is_text:new u.aH(_,n.u_is_text),u_pitch_with_map:new u.aH(_,n.u_pitch_with_map),u_is_along_line:new u.aH(_,n.u_is_along_line),u_is_variable_anchor:new u.aH(_,n.u_is_variable_anchor),u_texsize:new u.aO(_,n.u_texsize),u_texsize_icon:new u.aO(_,n.u_texsize_icon),u_texture:new u.aH(_,n.u_texture),u_texture_icon:new u.aH(_,n.u_texture_icon),u_gamma_scale:new u.aI(_,n.u_gamma_scale),u_device_pixel_ratio:new u.aI(_,n.u_device_pixel_ratio),u_is_halo:new u.aH(_,n.u_is_halo),u_translation:new u.aO(_,n.u_translation),u_pitched_scale:new u.aI(_,n.u_pitched_scale)}),background:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_opacity:new u.aI(_,n.u_opacity),u_color:new u.aL(_,n.u_color)}),backgroundPattern:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_opacity:new u.aI(_,n.u_opacity),u_image:new u.aH(_,n.u_image),u_pattern_tl_a:new u.aO(_,n.u_pattern_tl_a),u_pattern_br_a:new u.aO(_,n.u_pattern_br_a),u_pattern_tl_b:new u.aO(_,n.u_pattern_tl_b),u_pattern_br_b:new u.aO(_,n.u_pattern_br_b),u_texsize:new u.aO(_,n.u_texsize),u_mix:new u.aI(_,n.u_mix),u_pattern_size_a:new u.aO(_,n.u_pattern_size_a),u_pattern_size_b:new u.aO(_,n.u_pattern_size_b),u_scale_a:new u.aI(_,n.u_scale_a),u_scale_b:new u.aI(_,n.u_scale_b),u_pixel_coord_upper:new u.aO(_,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(_,n.u_pixel_coord_lower),u_tile_units_to_pixels:new u.aI(_,n.u_tile_units_to_pixels)}),terrain:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_texture:new u.aH(_,n.u_texture),u_ele_delta:new u.aI(_,n.u_ele_delta),u_fog_matrix:new u.aJ(_,n.u_fog_matrix),u_fog_color:new u.aL(_,n.u_fog_color),u_fog_ground_blend:new u.aI(_,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new u.aI(_,n.u_fog_ground_blend_opacity),u_horizon_color:new u.aL(_,n.u_horizon_color),u_horizon_fog_blend:new u.aI(_,n.u_horizon_fog_blend)}),terrainDepth:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_ele_delta:new u.aI(_,n.u_ele_delta)}),terrainCoords:(_,n)=>({u_matrix:new u.aJ(_,n.u_matrix),u_texture:new u.aH(_,n.u_texture),u_terrain_coords_id:new u.aI(_,n.u_terrain_coords_id),u_ele_delta:new u.aI(_,n.u_ele_delta)}),sky:(_,n)=>({u_sky_color:new u.aL(_,n.u_sky_color),u_horizon_color:new u.aL(_,n.u_horizon_color),u_horizon:new u.aI(_,n.u_horizon),u_sky_horizon_blend:new u.aI(_,n.u_sky_horizon_blend)})};class es{constructor(n,l,d){this.context=n;const f=n.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const l=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const my={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class nh{constructor(n,l,d,f){this.length=l.length,this.attributes=d,this.itemSize=l.bytesPerElement,this.dynamicDraw=f,this.context=n;const y=n.gl;this.buffer=y.createBuffer(),n.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete l.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,l){for(let d=0;d<this.attributes.length;d++){const f=l.attributes[this.attributes[d].name];f!==void 0&&n.enableVertexAttribArray(f)}}setVertexAttribPointers(n,l,d){for(let f=0;f<this.attributes.length;f++){const y=this.attributes[f],w=l.attributes[y.name];w!==void 0&&n.vertexAttribPointer(w,y.components,n[my[y.type]],!1,this.itemSize,y.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ho=new WeakMap;function Ns(_){var n;if(ho.has(_))return ho.get(_);{const l=(n=_.getParameter(_.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return ho.set(_,l),l}}class qt{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class lu extends qt{getDefault(){return u.aM.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class gy extends qt{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Ko extends qt{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class yy extends qt{getDefault(){return[!0,!0,!0,!0]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Lf extends qt{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class _y extends qt{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class Ff extends qt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class rh extends qt{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Bf extends qt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}}class Of extends qt{getDefault(){return[0,1]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Vf extends qt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}}class Nf extends qt{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class fo extends qt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}}class jf extends qt{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class vy extends qt{getDefault(){return u.aM.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class $f extends qt{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class nl extends qt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}}class xy extends qt{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class uu extends qt{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class by extends qt{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class wy extends qt{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Uf extends qt{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Gf extends qt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class qf extends qt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class ih extends qt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Zf extends qt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class cu extends qt{getDefault(){return null}set(n){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Ss extends qt{getDefault(){return null}set(n){var l;if(n===this.current&&!this.dirty)return;const d=this.gl;Ns(d)?d.bindVertexArray(n):(l=d.getExtension("OES_vertex_array_object"))===null||l===void 0||l.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class sh extends qt{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class oh extends qt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class ah extends qt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class hu extends qt{constructor(n,l){super(n),this.context=n,this.parent=l}getDefault(){return null}}class lh extends hu{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class po extends hu{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class uh extends hu{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Sy{constructor(n,l,d,f,y){this.context=n,this.width=l,this.height=d;const w=n.gl,T=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new lh(n,T),f)this.depthAttachment=y?new uh(n,T):new po(n,T);else if(y)throw new Error("Stencil cannot be set without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const n=this.context.gl,l=this.colorAttachment.get();if(l&&n.deleteTexture(l),this.depthAttachment){const d=this.depthAttachment.get();d&&n.deleteRenderbuffer(d)}n.deleteFramebuffer(this.framebuffer)}}class bn{constructor(n,l,d){this.blendFunction=n,this.blendColor=l,this.mask=d}}bn.Replace=[1,0],bn.disabled=new bn(bn.Replace,u.aM.transparent,[!1,!1,!1,!1]),bn.unblended=new bn(bn.Replace,u.aM.transparent,[!0,!0,!0,!0]),bn.alphaBlended=new bn([1,771],u.aM.transparent,[!0,!0,!0,!0]);class Ty{constructor(n){var l,d;if(this.gl=n,this.clearColor=new lu(this),this.clearDepth=new gy(this),this.clearStencil=new Ko(this),this.colorMask=new yy(this),this.depthMask=new Lf(this),this.stencilMask=new _y(this),this.stencilFunc=new Ff(this),this.stencilOp=new rh(this),this.stencilTest=new Bf(this),this.depthRange=new Of(this),this.depthTest=new Vf(this),this.depthFunc=new Nf(this),this.blend=new fo(this),this.blendFunc=new jf(this),this.blendColor=new vy(this),this.blendEquation=new $f(this),this.cullFace=new nl(this),this.cullFaceSide=new xy(this),this.frontFace=new uu(this),this.program=new by(this),this.activeTexture=new wy(this),this.viewport=new Uf(this),this.bindFramebuffer=new Gf(this),this.bindRenderbuffer=new qf(this),this.bindTexture=new ih(this),this.bindVertexBuffer=new Zf(this),this.bindElementBuffer=new cu(this),this.bindVertexArray=new Ss(this),this.pixelStoreUnpack=new sh(this),this.pixelStoreUnpackPremultiplyAlpha=new oh(this),this.pixelStoreUnpackFlipY=new ah(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),Ns(n)){this.HALF_FLOAT=n.HALF_FLOAT;const f=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(l=n.RGBA16F)!==null&&l!==void 0?l:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(d=n.RGB16F)!==null&&d!==void 0?d:f==null?void 0:f.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const f=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,l){return new es(this,n,l)}createVertexBuffer(n,l,d){return new nh(this,n,l,d)}createRenderbuffer(n,l,d){const f=this.gl,y=f.createRenderbuffer();return this.bindRenderbuffer.set(y),f.renderbufferStorage(f.RENDERBUFFER,n,l,d),this.bindRenderbuffer.set(null),y}createFramebuffer(n,l,d,f){return new Sy(this,n,l,d,f)}clear({color:n,depth:l,stencil:d}){const f=this.gl;let y=0;n&&(y|=f.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),l!==void 0&&(y|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),d!==void 0&&(y|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),f.clear(y)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){u.aE(n.blendFunction,bn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return Ns(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var l;return Ns(this.gl)?this.gl.deleteVertexArray(n):(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}class zt{constructor(n,l,d){this.func=n,this.mask=l,this.range=d}}zt.ReadOnly=!1,zt.ReadWrite=!0,zt.disabled=new zt(519,zt.ReadOnly,[0,1]);const du=7680;class tn{constructor(n,l,d,f,y,w){this.test=n,this.ref=l,this.mask=d,this.fail=f,this.depthFail=y,this.pass=w}}tn.disabled=new tn({func:519,mask:0},0,0,du,du,du);class Xt{constructor(n,l,d){this.enable=n,this.mode=l,this.frontFace=d}}let mo;function rl(_,n,l,d,f){const y=_.context,w=y.gl,T=_.useProgram("collisionBox"),k=[];let M=0,L=0;for(let ue=0;ue<d.length;ue++){const he=d[ue],Q=n.getTile(he).getBucket(l);if(!Q)continue;const me=f?Q.textCollisionBox:Q.iconCollisionBox,ve=Q.collisionCircleArray;if(ve.length>0){const Te=u.H();u.aQ(Te,Q.placementInvProjMatrix,_.transform.glCoordMatrix),u.aQ(Te,Te,Q.placementViewportMatrix),k.push({circleArray:ve,circleOffset:L,transform:he.posMatrix,invTransform:Te,coord:he}),M+=ve.length/4,L=M}me&&T.draw(y,w.LINES,zt.disabled,tn.disabled,_.colorModeForRenderPass(),Xt.disabled,{u_matrix:he.posMatrix,u_pixel_extrude_scale:[1/(F=_.transform).width,1/F.height]},_.style.map.terrain&&_.style.map.terrain.getTerrainData(he),l.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,null,_.transform.zoom,null,null,me.collisionVertexBuffer)}var F;if(!f||!k.length)return;const j=_.useProgram("collisionCircle"),H=new u.aR;H.resize(4*M),H._trim();let K=0;for(const ue of k)for(let he=0;he<ue.circleArray.length/4;he++){const Q=4*he,me=ue.circleArray[Q+0],ve=ue.circleArray[Q+1],Te=ue.circleArray[Q+2],ze=ue.circleArray[Q+3];H.emplace(K++,me,ve,Te,ze,0),H.emplace(K++,me,ve,Te,ze,1),H.emplace(K++,me,ve,Te,ze,2),H.emplace(K++,me,ve,Te,ze,3)}(!mo||mo.length<2*M)&&(mo=function(ue){const he=2*ue,Q=new u.aT;Q.resize(he),Q._trim();for(let me=0;me<he;me++){const ve=6*me;Q.uint16[ve+0]=4*me+0,Q.uint16[ve+1]=4*me+1,Q.uint16[ve+2]=4*me+2,Q.uint16[ve+3]=4*me+2,Q.uint16[ve+4]=4*me+3,Q.uint16[ve+5]=4*me+0}return Q}(M));const re=y.createIndexBuffer(mo,!0),oe=y.createVertexBuffer(H,u.aS.members,!0);for(const ue of k){const he=co(ue.transform,ue.invTransform,_.transform);j.draw(y,w.TRIANGLES,zt.disabled,tn.disabled,_.colorModeForRenderPass(),Xt.disabled,he,_.style.map.terrain&&_.style.map.terrain.getTerrainData(ue.coord),l.id,oe,re,u.a0.simpleSegment(0,2*ue.circleOffset,ue.circleArray.length,ue.circleArray.length/2),null,_.transform.zoom,null,null,null)}oe.destroy(),re.destroy()}Xt.disabled=new Xt(!1,1029,2305),Xt.backCCW=new Xt(!0,1029,2305);const il=u.an(new Float32Array(16));function ch(_,n,l,d,f,y){const{horizontalAlign:w,verticalAlign:T}=u.au(_);return new u.P((-(w-.5)*n/f+d[0])*y,(-(T-.5)*l/f+d[1])*y)}function go(_,n,l,d,f,y){const w=n.tileAnchorPoint.add(new u.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let T=d.mult(y);l||(T=T.rotate(-f));const k=w.add(T);return ie(k.x,k.y,n.labelPlaneMatrix,n.getElevation).point}if(l){const T=Ee(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(_),k=Math.atan(T.y/T.x)+(T.x<0?Math.PI:0);return _.add(d.rotate(k))}return _.add(d)}function Yo(_,n,l,d,f,y,w,T,k,M,L,F,j,H){const K=_.text.placedSymbolArray,re=_.text.dynamicLayoutVertexArray,oe=_.icon.dynamicLayoutVertexArray,ue={};re.clear();for(let he=0;he<K.length;he++){const Q=K.get(he),me=Q.hidden||!Q.crossTileID||_.allowVerticalPlacement&&!Q.placedOrientation?null:d[Q.crossTileID];if(me){const ve=new u.P(Q.anchorX,Q.anchorY),Te={getElevation:H,width:f.width,height:f.height,labelPlaneMatrix:y,pitchWithMap:l,projection:L,tileAnchorPoint:ve,translation:F,unwrappedTileID:j},ze=l?ie(ve.x,ve.y,w,H):Ee(ve.x,ve.y,Te),Ve=V(f.cameraToCenterDistance,ze.signedDistanceFromCamera);let Ye=u.ai(_.textSizeData,k,Q)*Ve/u.ap;l&&(Ye*=_.tilePixelRatio/T);const{width:nt,height:We,anchor:Ze,textOffset:at,textBoxScale:wt}=me,Xe=ch(Ze,nt,We,at,wt,Ye),Qe=L.getPitchedTextCorrection(f,ve.add(new u.P(F[0],F[1])),j),vt=go(ze.point,Te,n,Xe,f.angle,Qe),cn=_.allowVerticalPlacement&&Q.placedOrientation===u.ah.vertical?Math.PI/2:0;for(let It=0;It<Q.numGlyphs;It++)u.aj(re,vt,cn);M&&Q.associatedIconIndex>=0&&(ue[Q.associatedIconIndex]={shiftedAnchor:vt,angle:cn})}else pt(Q.numGlyphs,re)}if(M){oe.clear();const he=_.icon.placedSymbolArray;for(let Q=0;Q<he.length;Q++){const me=he.get(Q);if(me.hidden)pt(me.numGlyphs,oe);else{const ve=ue[Q];if(ve)for(let Te=0;Te<me.numGlyphs;Te++)u.aj(oe,ve.shiftedAnchor,ve.angle);else pt(me.numGlyphs,oe)}}_.icon.dynamicLayoutVertexBuffer.updateData(oe)}_.text.dynamicLayoutVertexBuffer.updateData(re)}function ui(_,n,l){return l.iconsInText&&n?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function hh(_,n,l,d,f,y,w,T,k,M,L,F){const j=_.context,H=j.gl,K=_.transform,re=lo(),oe=T==="map",ue=k==="map",he=T!=="viewport"&&l.layout.get("symbol-placement")!=="point",Q=oe&&!ue&&!he,me=!ue&&he,ve=!l.layout.get("symbol-sort-key").isConstant();let Te=!1;const ze=_.depthModeForSublayer(0,zt.ReadOnly),Ve=l._unevaluatedLayout.hasValue("text-variable-anchor")||l._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ye=[],nt=re.getCircleRadiusCorrection(K);for(const We of d){const Ze=n.getTile(We),at=Ze.getBucket(l);if(!at)continue;const wt=f?at.text:at.icon;if(!wt||!wt.segments.get().length||!wt.hasVisibleVertices)continue;const Xe=wt.programConfigurations.get(l.id),Qe=f||at.sdfIcons,vt=f?at.textSizeData:at.iconSizeData,cn=ue||K.pitch!==0,It=_.useProgram(ui(Qe,f,at),Xe),Rt=u.ag(vt,K.zoom),hn=_.style.map.terrain&&_.style.map.terrain.getTerrainData(We);let ar,zi,dn,Ar,vr=[0,0],lr=null;if(f)zi=Ze.glyphAtlasTexture,dn=H.LINEAR,ar=Ze.glyphAtlasTexture.size,at.iconsInText&&(vr=Ze.imageAtlasTexture.size,lr=Ze.imageAtlasTexture,Ar=cn||_.options.rotating||_.options.zooming||vt.kind==="composite"||vt.kind==="camera"?H.LINEAR:H.NEAREST);else{const Ft=l.layout.get("icon-size").constantOr(0)!==1||at.iconsNeedLinear;zi=Ze.imageAtlasTexture,dn=Qe||_.options.rotating||_.options.zooming||Ft||cn?H.LINEAR:H.NEAREST,ar=Ze.imageAtlasTexture.size}const xr=Dt(Ze,1,_.transform.zoom),rs=me?We.posMatrix:il,da=Os(rs,ue,oe,_.transform,xr),Au=Qi(rs,ue,oe,_.transform,xr),fa=Qi(We.posMatrix,ue,oe,_.transform,xr),di=re.translatePosition(_.transform,Ze,y,w),zu=Ve&&at.hasTextData(),Fh=l.layout.get("icon-text-fit")!=="none"&&zu&&at.hasIconData();if(he){const Ft=_.style.map.terrain?(pa,ma)=>_.style.map.terrain.getElevation(We,pa,ma):null,bo=l.layout.get("text-rotation-alignment")==="map";W(at,We.posMatrix,_,f,da,fa,ue,M,bo,re,We.toUnwrapped(),K.width,K.height,di,Ft)}const fi=We.posMatrix,pi=f&&Ve||Fh,js=he||pi?il:da,Di=Au,er=Qe&&l.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ur;ur=Qe?at.iconsInText?Qc(vt.kind,Rt,Q,ue,he,pi,_,fi,js,Di,di,ar,vr,nt):tl(vt.kind,Rt,Q,ue,he,pi,_,fi,js,Di,di,f,ar,!0,nt):Rf(vt.kind,Rt,Q,ue,he,pi,_,fi,js,Di,di,f,ar,nt);const Yr={program:It,buffers:wt,uniformValues:ur,atlasTexture:zi,atlasTextureIcon:lr,atlasInterpolation:dn,atlasInterpolationIcon:Ar,isSDF:Qe,hasHalo:er};if(ve&&at.canOverlap){Te=!0;const Ft=wt.segments.get();for(const bo of Ft)Ye.push({segments:new u.a0([bo]),sortKey:bo.sortKey,state:Yr,terrainData:hn})}else Ye.push({segments:wt.segments,sortKey:0,state:Yr,terrainData:hn})}Te&&Ye.sort((We,Ze)=>We.sortKey-Ze.sortKey);for(const We of Ye){const Ze=We.state;if(j.activeTexture.set(H.TEXTURE0),Ze.atlasTexture.bind(Ze.atlasInterpolation,H.CLAMP_TO_EDGE),Ze.atlasTextureIcon&&(j.activeTexture.set(H.TEXTURE1),Ze.atlasTextureIcon&&Ze.atlasTextureIcon.bind(Ze.atlasInterpolationIcon,H.CLAMP_TO_EDGE)),Ze.isSDF){const at=Ze.uniformValues;Ze.hasHalo&&(at.u_is_halo=1,dh(Ze.buffers,We.segments,l,_,Ze.program,ze,L,F,at,We.terrainData)),at.u_is_halo=0}dh(Ze.buffers,We.segments,l,_,Ze.program,ze,L,F,Ze.uniformValues,We.terrainData)}}function dh(_,n,l,d,f,y,w,T,k,M){const L=d.context;f.draw(L,L.gl.TRIANGLES,y,w,T,Xt.disabled,k,M,l.id,_.layoutVertexBuffer,_.indexBuffer,n,l.paint,d.transform.zoom,_.programConfigurations.get(l.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function fh(_,n,l,d){const f=_.context,y=f.gl,w=tn.disabled,T=new bn([y.ONE,y.ONE],u.aM.transparent,[!0,!0,!0,!0]),k=n.getBucket(l);if(!k)return;const M=d.key;let L=l.heatmapFbos.get(M);L||(L=sl(f,n.tileSize,n.tileSize),l.heatmapFbos.set(M,L)),f.bindFramebuffer.set(L.framebuffer),f.viewport.set([0,0,n.tileSize,n.tileSize]),f.clear({color:u.aM.transparent});const F=k.programConfigurations.get(l.id),j=_.useProgram("heatmap",F),H=_.style.map.terrain.getTerrainData(d);j.draw(f,y.TRIANGLES,zt.disabled,w,T,Xt.disabled,Mr(d.posMatrix,n,_.transform.zoom,l.paint.get("heatmap-intensity")),H,l.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,l.paint,_.transform.zoom,F)}function yo(_,n,l){const d=_.context,f=d.gl;d.setColorMode(_.colorModeForRenderPass());const y=ol(d,n),w=l.key,T=n.heatmapFbos.get(w);T&&(d.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,T.colorAttachment.get()),d.activeTexture.set(f.TEXTURE1),y.bind(f.LINEAR,f.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(d,f.TRIANGLES,zt.disabled,tn.disabled,_.colorModeForRenderPass(),Xt.disabled,iu(_,n,0,1),null,n.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments,n.paint,_.transform.zoom),T.destroy(),n.heatmapFbos.delete(w))}function sl(_,n,l){var d,f;const y=_.gl,w=y.createTexture();y.bindTexture(y.TEXTURE_2D,w),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR);const T=(d=_.HALF_FLOAT)!==null&&d!==void 0?d:y.UNSIGNED_BYTE,k=(f=_.RGBA16F)!==null&&f!==void 0?f:y.RGBA;y.texImage2D(y.TEXTURE_2D,0,k,n,l,0,y.RGBA,T,null);const M=_.createFramebuffer(n,l,!1,!1);return M.colorAttachment.set(w),M}function ol(_,n){return n.colorRampTexture||(n.colorRampTexture=new Ne(_,n.colorRamp,_.gl.RGBA)),n.colorRampTexture}function Jo(_,n,l,d,f){if(!l||!d||!d.imageAtlas)return;const y=d.imageAtlas.patternPositions;let w=y[l.to.toString()],T=y[l.from.toString()];if(!w&&T&&(w=T),!T&&w&&(T=w),!w||!T){const k=f.getPaintProperty(n);w=y[k],T=y[k]}w&&T&&_.setConstantPatternPositions(w,T)}function al(_,n,l,d,f,y,w){const T=_.context.gl,k="fill-pattern",M=l.paint.get(k),L=M&&M.constantOr(1),F=l.getCrossfadeParameters();let j,H,K,re,oe;w?(H=L&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=T.LINES):(H=L?"fillPattern":"fill",j=T.TRIANGLES);const ue=M.constantOr(null);for(const he of d){const Q=n.getTile(he);if(L&&!Q.patternsLoaded())continue;const me=Q.getBucket(l);if(!me)continue;const ve=me.programConfigurations.get(l.id),Te=_.useProgram(H,ve),ze=_.style.map.terrain&&_.style.map.terrain.getTerrainData(he);L&&(_.context.activeTexture.set(T.TEXTURE0),Q.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),ve.updatePaintBuffers(F)),Jo(ve,k,ue,Q,l);const Ve=ze?he:null,Ye=_.translatePosMatrix(Ve?Ve.posMatrix:he.posMatrix,Q,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));if(w){re=me.indexBuffer2,oe=me.segments2;const nt=[T.drawingBufferWidth,T.drawingBufferHeight];K=H==="fillOutlinePattern"&&L?Mf(Ye,_,F,Q,nt):cy(Ye,nt)}else re=me.indexBuffer,oe=me.segments,K=L?If(Ye,_,F,Q):Ho(Ye);Te.draw(_.context,j,f,_.stencilModeForClipping(he),y,Xt.disabled,K,ze,l.id,me.layoutVertexBuffer,re,oe,l.paint,_.transform.zoom,ve)}}function fu(_,n,l,d,f,y,w){const T=_.context,k=T.gl,M="fill-extrusion-pattern",L=l.paint.get(M),F=L.constantOr(1),j=l.getCrossfadeParameters(),H=l.paint.get("fill-extrusion-opacity"),K=L.constantOr(null);for(const re of d){const oe=n.getTile(re),ue=oe.getBucket(l);if(!ue)continue;const he=_.style.map.terrain&&_.style.map.terrain.getTerrainData(re),Q=ue.programConfigurations.get(l.id),me=_.useProgram(F?"fillExtrusionPattern":"fillExtrusion",Q);F&&(_.context.activeTexture.set(k.TEXTURE0),oe.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),Q.updatePaintBuffers(j)),Jo(Q,M,K,oe,l);const ve=_.translatePosMatrix(re.posMatrix,oe,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Te=l.paint.get("fill-extrusion-vertical-gradient"),ze=F?ru(ve,_,Te,H,re,j,oe):Qa(ve,_,Te,H);me.draw(T,T.gl.TRIANGLES,f,y,w,Xt.backCCW,ze,he,l.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,l.paint,_.transform.zoom,Q,_.style.map.terrain&&ue.centroidVertexBuffer)}}function Qo(_,n,l,d,f,y,w){const T=_.context,k=T.gl,M=l.fbo;if(!M)return;const L=_.useProgram("hillshade"),F=_.style.map.terrain&&_.style.map.terrain.getTerrainData(n);T.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,M.colorAttachment.get()),L.draw(T,k.TRIANGLES,f,y,w,Xt.disabled,((j,H,K,re)=>{const oe=K.paint.get("hillshade-shadow-color"),ue=K.paint.get("hillshade-highlight-color"),he=K.paint.get("hillshade-accent-color");let Q=K.paint.get("hillshade-illumination-direction")*(Math.PI/180);K.paint.get("hillshade-illumination-anchor")==="viewport"&&(Q-=j.transform.angle);const me=!j.options.moving;return{u_matrix:re?re.posMatrix:j.transform.calculatePosMatrix(H.tileID.toUnwrapped(),me),u_image:0,u_latrange:su(0,H.tileID),u_light:[K.paint.get("hillshade-exaggeration"),Q],u_shadow:oe,u_highlight:ue,u_accent:he}})(_,l,d,F?n:null),F,d.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}function ea(_,n,l,d,f,y){const w=_.context,T=w.gl,k=n.dem;if(k&&k.data){const M=k.dim,L=k.stride,F=k.getPixels();if(w.activeTexture.set(T.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||_.getTileTexture(L),n.demTexture){const H=n.demTexture;H.update(F,{premultiply:!1}),H.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else n.demTexture=new Ne(w,F,T.RGBA,{premultiply:!1}),n.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);w.activeTexture.set(T.TEXTURE0);let j=n.fbo;if(!j){const H=new Ne(w,{width:M,height:M,data:null},T.RGBA);H.bind(T.LINEAR,T.CLAMP_TO_EDGE),j=n.fbo=w.createFramebuffer(M,M,!0,!1),j.colorAttachment.set(H.texture)}w.bindFramebuffer.set(j.framebuffer),w.viewport.set([0,0,M,M]),_.useProgram("hillshadePrepare").draw(w,T.TRIANGLES,d,f,y,Xt.disabled,((H,K)=>{const re=K.stride,oe=u.H();return u.aP(oe,0,u.X,-u.X,0,0,1),u.J(oe,oe,[0,-u.X,0]),{u_matrix:oe,u_image:1,u_dimension:[re,re],u_zoom:H.overscaledZ,u_unpack:K.getUnpackVector()}})(n.tileID,k),null,l.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function Wf(_,n,l,d,f,y){const w=d.paint.get("raster-fade-duration");if(!y&&w>0){const T=z.now(),k=(T-_.timeAdded)/w,M=n?(T-n.timeAdded)/w:-1,L=l.getSource(),F=f.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),j=!n||Math.abs(n.tileID.overscaledZ-F)>Math.abs(_.tileID.overscaledZ-F),H=j&&_.refreshedUponExpiration?1:u.ac(j?k:1-M,0,1);return _.refreshedUponExpiration&&k>=1&&(_.refreshedUponExpiration=!1),n?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}const ph=new u.aM(1,0,0,1),$t=new u.aM(0,1,0,1),pu=new u.aM(0,0,1,1),Cy=new u.aM(1,0,1,1),Hf=new u.aM(0,1,1,1);function ta(_,n,l,d){mu(_,0,n+l/2,_.transform.width,l,d)}function Xf(_,n,l,d){mu(_,n-l/2,0,l,_.transform.height,d)}function mu(_,n,l,d,f,y){const w=_.context,T=w.gl;T.enable(T.SCISSOR_TEST),T.scissor(n*_.pixelRatio,l*_.pixelRatio,d*_.pixelRatio,f*_.pixelRatio),w.clear({color:y}),T.disable(T.SCISSOR_TEST)}function Kf(_,n,l){const d=_.context,f=d.gl,y=l.posMatrix,w=_.useProgram("debug"),T=zt.disabled,k=tn.disabled,M=_.colorModeForRenderPass(),L="$debug",F=_.style.map.terrain&&_.style.map.terrain.getTerrainData(l);d.activeTexture.set(f.TEXTURE0);const j=n.getTileByID(l.key).latestRawTileData,H=Math.floor((j&&j.byteLength||0)/1024),K=n.getTile(l).tileSize,re=512/Math.min(K,512)*(l.overscaledZ/_.transform.zoom)*.5;let oe=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(oe+=` => ${l.overscaledZ}`),function(ue,he){ue.initDebugOverlayCanvas();const Q=ue.debugOverlayCanvas,me=ue.context.gl,ve=ue.debugOverlayCanvas.getContext("2d");ve.clearRect(0,0,Q.width,Q.height),ve.shadowColor="white",ve.shadowBlur=2,ve.lineWidth=1.5,ve.strokeStyle="white",ve.textBaseline="top",ve.font="bold 36px Open Sans, sans-serif",ve.fillText(he,5,5),ve.strokeText(he,5,5),ue.debugOverlayTexture.update(Q),ue.debugOverlayTexture.bind(me.LINEAR,me.CLAMP_TO_EDGE)}(_,`${oe} ${H}kB`),w.draw(d,f.TRIANGLES,T,k,bn.alphaBlended,Xt.disabled,el(y,u.aM.transparent,re),null,L,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments),w.draw(d,f.LINE_STRIP,T,k,M,Xt.disabled,el(y,u.aM.red),F,L,_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments)}function Yf(_,n,l){const d=_.context,f=d.gl,y=_.colorModeForRenderPass(),w=new zt(f.LEQUAL,zt.ReadWrite,_.depthRangeFor3D),T=_.useProgram("terrain"),k=n.getTerrainMesh();d.bindFramebuffer.set(null),d.viewport.set([0,0,_.width,_.height]);for(const M of l){const L=_.renderToTexture.getTexture(M),F=n.getTerrainData(M.tileID);d.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,L.texture);const j=_.transform.calculatePosMatrix(M.tileID.toUnwrapped()),H=n.getMeshFrameDelta(_.transform.zoom),K=_.transform.calculateFogMatrix(M.tileID.toUnwrapped()),re=Yc(j,H,K,_.style.sky,_.transform.pitch);T.draw(d,f.TRIANGLES,w,tn.disabled,y,Xt.backCCW,re,F,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}class gu{constructor(n,l,d){this.vertexBuffer=n,this.indexBuffer=l,this.segments=d}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class yu{constructor(n,l){this.context=new Ty(n),this.transform=l,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=_t.maxUnderzooming+_t.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Xc}resize(n,l,d){if(this.width=Math.floor(n*d),this.height=Math.floor(l*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const n=this.context,l=new u.aX;l.emplaceBack(0,0),l.emplaceBack(u.X,0),l.emplaceBack(0,u.X),l.emplaceBack(u.X,u.X),this.tileExtentBuffer=n.createVertexBuffer(l,uo.members),this.tileExtentSegments=u.a0.simpleSegment(0,0,4,2);const d=new u.aX;d.emplaceBack(0,0),d.emplaceBack(u.X,0),d.emplaceBack(0,u.X),d.emplaceBack(u.X,u.X),this.debugBuffer=n.createVertexBuffer(d,uo.members),this.debugSegments=u.a0.simpleSegment(0,0,4,5);const f=new u.$;f.emplaceBack(0,0,0,0),f.emplaceBack(u.X,0,u.X,0),f.emplaceBack(0,u.X,0,u.X),f.emplaceBack(u.X,u.X,u.X,u.X),this.rasterBoundsBuffer=n.createVertexBuffer(f,St.members),this.rasterBoundsSegments=u.a0.simpleSegment(0,0,4,2);const y=new u.aX;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(y,uo.members),this.viewportSegments=u.a0.simpleSegment(0,0,4,2);const w=new u.aZ;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);const T=new u.aY;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(T);const k=this.context.gl;this.stencilClearMode=new tn({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){const n=this.context,l=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=u.H();u.aP(d,0,this.width,this.height,0,0,1),u.K(d,d,[l.drawingBufferWidth,l.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,l.TRIANGLES,zt.disabled,this.stencilClearMode,bn.disabled,Xt.disabled,Ir(d),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,l){if(this.currentStencilSource===n.source||!n.isTileClipped()||!l||!l.length)return;this.currentStencilSource=n.source;const d=this.context,f=d.gl;this.nextStencilID+l.length>256&&this.clearStencil(),d.setColorMode(bn.disabled),d.setDepthMode(zt.disabled);const y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of l){const T=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(w);y.draw(d,f.TRIANGLES,zt.disabled,new tn({func:f.ALWAYS,mask:0},T,255,f.KEEP,f.KEEP,f.REPLACE),bn.disabled,Xt.disabled,Ir(w.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,l=this.context.gl;return new tn({func:l.NOTEQUAL,mask:255},n,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(n){const l=this.context.gl;return new tn({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(n){const l=this.context.gl,d=n.sort((w,T)=>T.overscaledZ-w.overscaledZ),f=d[d.length-1].overscaledZ,y=d[0].overscaledZ-f+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const w={};for(let T=0;T<y;T++)w[T+f]=new tn({func:l.GEQUAL,mask:255},T+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=y,[w,d]}return[{[f]:tn.disabled},d]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new bn([n.CONSTANT_COLOR,n.ONE],new u.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?bn.unblended:bn.alphaBlended}depthModeForSublayer(n,l,d){if(!this.opaquePassEnabledForLayer())return zt.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new zt(d||this.context.gl.LEQUAL,l,[f,f])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,l){this.style=n,this.options=l,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(z.now()),this.imageManager.beginFrame();const d=this.style._order,f=this.style.sourceCaches,y={},w={},T={};for(const k in f){const M=f[k];M.used&&M.prepare(this.context),y[k]=M.getVisibleCoordinates(),w[k]=y[k].slice().reverse(),T[k]=M.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<d.length;k++)if(this.style._layers[d[k]].is3D()){this.opaquePassCutoff=k;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const k of d){const M=this.style._layers[k];if(!M.hasOffscreenPass()||M.isHidden(this.transform.zoom))continue;const L=w[M.source];(M.type==="custom"||L.length)&&this.renderLayer(this,f[M.source],M,L)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:l.showOverdrawInspector?u.aM.black:u.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(k,M){const L=k.context,F=L.gl,j=((ue,he,Q)=>({u_sky_color:ue.properties.get("sky-color"),u_horizon_color:ue.properties.get("horizon-color"),u_horizon:(he.height/2+he.getHorizon())*Q,u_sky_horizon_blend:ue.properties.get("sky-horizon-blend")*he.height/2*Q}))(M,k.style.map.transform,k.pixelRatio),H=new zt(F.LEQUAL,zt.ReadWrite,[0,1]),K=tn.disabled,re=k.colorModeForRenderPass(),oe=k.useProgram("sky");if(!M.mesh){const ue=new u.aX;ue.emplaceBack(-1,-1),ue.emplaceBack(1,-1),ue.emplaceBack(1,1),ue.emplaceBack(-1,1);const he=new u.aY;he.emplaceBack(0,1,2),he.emplaceBack(0,2,3),M.mesh=new gu(L.createVertexBuffer(ue,uo.members),L.createIndexBuffer(he),u.a0.simpleSegment(0,0,ue.length,he.length))}oe.draw(L,F.TRIANGLES,H,K,re,Xt.disabled,j,void 0,"sky",M.mesh.vertexBuffer,M.mesh.indexBuffer,M.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=l.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[d[this.currentLayer]],M=f[k.source],L=y[k.source];this._renderTileClippingMasks(k,L),this.renderLayer(this,M,k,L)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){const k=this.style._layers[d[this.currentLayer]],M=f[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k))continue;const L=(k.type==="symbol"?T:w)[k.source];this._renderTileClippingMasks(k,y[k.source]),this.renderLayer(this,M,k,L)}if(this.options.showTileBoundaries){const k=function(M,L){let F=null;const j=Object.values(M._layers).flatMap(oe=>oe.source&&!oe.isHidden(L)?[M.sourceCaches[oe.source]]:[]),H=j.filter(oe=>oe.getSource().type==="vector"),K=j.filter(oe=>oe.getSource().type!=="vector"),re=oe=>{(!F||F.getSource().maxzoom<oe.getSource().maxzoom)&&(F=oe)};return H.forEach(oe=>re(oe)),F||K.forEach(oe=>re(oe)),F}(this.style,this.transform.zoom);k&&function(M,L,F){for(let j=0;j<F.length;j++)Kf(M,L,F[j])}(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const M=k.transform.padding;ta(k,k.transform.height-(M.top||0),3,ph),ta(k,M.bottom||0,3,$t),Xf(k,M.left||0,3,pu),Xf(k,k.transform.width-(M.right||0),3,Cy);const L=k.transform.centerPoint;(function(F,j,H,K){mu(F,j-1,H-10,2,20,K),mu(F,j-10,H-1,20,2,K)})(k,L.x,k.transform.height-L.y,Hf)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;const l=this.terrainFacilitator.matrix,d=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=n?!u.a_(l,d):!u.a$(l,d)),f||(f=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),f&&(u.b0(l,d),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(y,w){const T=y.context,k=T.gl,M=bn.unblended,L=new zt(k.LEQUAL,zt.ReadWrite,[0,1]),F=w.getTerrainMesh(),j=w.sourceCache.getRenderableTiles(),H=y.useProgram("terrainDepth");T.bindFramebuffer.set(w.getFramebuffer("depth").framebuffer),T.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),T.clear({color:u.aM.transparent,depth:1});for(const K of j){const re=w.getTerrainData(K.tileID),oe={u_matrix:y.transform.calculatePosMatrix(K.tileID.toUnwrapped()),u_ele_delta:w.getMeshFrameDelta(y.transform.zoom)};H.draw(T,k.TRIANGLES,L,tn.disabled,M,Xt.backCCW,oe,re,"terrain",F.vertexBuffer,F.indexBuffer,F.segments)}T.bindFramebuffer.set(null),T.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain),function(y,w){const T=y.context,k=T.gl,M=bn.unblended,L=new zt(k.LEQUAL,zt.ReadWrite,[0,1]),F=w.getTerrainMesh(),j=w.getCoordsTexture(),H=w.sourceCache.getRenderableTiles(),K=y.useProgram("terrainCoords");T.bindFramebuffer.set(w.getFramebuffer("coords").framebuffer),T.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),T.clear({color:u.aM.transparent,depth:1}),w.coordsIndex=[];for(const re of H){const oe=w.getTerrainData(re.tileID);T.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,j.texture);const ue={u_matrix:y.transform.calculatePosMatrix(re.tileID.toUnwrapped()),u_terrain_coords_id:(255-w.coordsIndex.length)/255,u_texture:0,u_ele_delta:w.getMeshFrameDelta(y.transform.zoom)};K.draw(T,k.TRIANGLES,L,tn.disabled,M,Xt.backCCW,ue,oe,"terrain",F.vertexBuffer,F.indexBuffer,F.segments),w.coordsIndex.push(re.tileID.key)}T.bindFramebuffer.set(null),T.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain))}renderLayer(n,l,d,f){if(!d.isHidden(this.transform.zoom)&&(d.type==="background"||d.type==="custom"||(f||[]).length))switch(this.id=d.id,d.type){case"symbol":(function(y,w,T,k,M){if(y.renderPass!=="translucent")return;const L=tn.disabled,F=y.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(j,H,K,re,oe,ue,he,Q,me){const ve=H.transform,Te=lo(),ze=oe==="map",Ve=ue==="map";for(const Ye of j){const nt=re.getTile(Ye),We=nt.getBucket(K);if(!We||!We.text||!We.text.segments.get().length)continue;const Ze=u.ag(We.textSizeData,ve.zoom),at=Dt(nt,1,H.transform.zoom),wt=Os(Ye.posMatrix,Ve,ze,H.transform,at),Xe=K.layout.get("icon-text-fit")!=="none"&&We.hasIconData();if(Ze){const Qe=Math.pow(2,ve.zoom-nt.tileID.overscaledZ),vt=H.style.map.terrain?(It,Rt)=>H.style.map.terrain.getElevation(Ye,It,Rt):null,cn=Te.translatePosition(ve,nt,he,Q);Yo(We,ze,Ve,me,ve,wt,Ye.posMatrix,Qe,Ze,Xe,Te,cn,Ye.toUnwrapped(),vt)}}}(k,y,T,w,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),M),T.paint.get("icon-opacity").constantOr(1)!==0&&hh(y,w,T,k,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),L,F),T.paint.get("text-opacity").constantOr(1)!==0&&hh(y,w,T,k,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),L,F),w.map.showCollisionBoxes&&(rl(y,w,T,k,!0),rl(y,w,T,k,!1))})(n,l,d,f,this.style.placement.variableOffsets);break;case"circle":(function(y,w,T,k){if(y.renderPass!=="translucent")return;const M=T.paint.get("circle-opacity"),L=T.paint.get("circle-stroke-width"),F=T.paint.get("circle-stroke-opacity"),j=!T.layout.get("circle-sort-key").isConstant();if(M.constantOr(1)===0&&(L.constantOr(1)===0||F.constantOr(1)===0))return;const H=y.context,K=H.gl,re=y.depthModeForSublayer(0,zt.ReadOnly),oe=tn.disabled,ue=y.colorModeForRenderPass(),he=[];for(let Q=0;Q<k.length;Q++){const me=k[Q],ve=w.getTile(me),Te=ve.getBucket(T);if(!Te)continue;const ze=Te.programConfigurations.get(T.id),Ve=y.useProgram("circle",ze),Ye=Te.layoutVertexBuffer,nt=Te.indexBuffer,We=y.style.map.terrain&&y.style.map.terrain.getTerrainData(me),Ze={programConfiguration:ze,program:Ve,layoutVertexBuffer:Ye,indexBuffer:nt,uniformValues:hy(y,me,ve,T),terrainData:We};if(j){const at=Te.segments.get();for(const wt of at)he.push({segments:new u.a0([wt]),sortKey:wt.sortKey,state:Ze})}else he.push({segments:Te.segments,sortKey:0,state:Ze})}j&&he.sort((Q,me)=>Q.sortKey-me.sortKey);for(const Q of he){const{programConfiguration:me,program:ve,layoutVertexBuffer:Te,indexBuffer:ze,uniformValues:Ve,terrainData:Ye}=Q.state;ve.draw(H,K.TRIANGLES,re,oe,ue,Xt.disabled,Ve,Ye,T.id,Te,ze,Q.segments,T.paint,y.transform.zoom,me)}})(n,l,d,f);break;case"heatmap":(function(y,w,T,k){if(T.paint.get("heatmap-opacity")===0)return;const M=y.context;if(y.style.map.terrain){for(const L of k){const F=w.getTile(L);w.hasRenderableParent(L)||(y.renderPass==="offscreen"?fh(y,F,T,L):y.renderPass==="translucent"&&yo(y,T,L))}M.viewport.set([0,0,y.width,y.height])}else y.renderPass==="offscreen"?function(L,F,j,H){const K=L.context,re=K.gl,oe=tn.disabled,ue=new bn([re.ONE,re.ONE],u.aM.transparent,[!0,!0,!0,!0]);(function(he,Q,me){const ve=he.gl;he.activeTexture.set(ve.TEXTURE1),he.viewport.set([0,0,Q.width/4,Q.height/4]);let Te=me.heatmapFbos.get(u.aU);Te?(ve.bindTexture(ve.TEXTURE_2D,Te.colorAttachment.get()),he.bindFramebuffer.set(Te.framebuffer)):(Te=sl(he,Q.width/4,Q.height/4),me.heatmapFbos.set(u.aU,Te))})(K,L,j),K.clear({color:u.aM.transparent});for(let he=0;he<H.length;he++){const Q=H[he];if(F.hasRenderableParent(Q))continue;const me=F.getTile(Q),ve=me.getBucket(j);if(!ve)continue;const Te=ve.programConfigurations.get(j.id),ze=L.useProgram("heatmap",Te),{zoom:Ve}=L.transform;ze.draw(K,re.TRIANGLES,zt.disabled,oe,ue,Xt.disabled,Mr(Q.posMatrix,me,Ve,j.paint.get("heatmap-intensity")),null,j.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,j.paint,L.transform.zoom,Te)}K.viewport.set([0,0,L.width,L.height])}(y,w,T,k):y.renderPass==="translucent"&&function(L,F){const j=L.context,H=j.gl;j.setColorMode(L.colorModeForRenderPass());const K=F.heatmapFbos.get(u.aU);K&&(j.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,K.colorAttachment.get()),j.activeTexture.set(H.TEXTURE1),ol(j,F).bind(H.LINEAR,H.CLAMP_TO_EDGE),L.useProgram("heatmapTexture").draw(j,H.TRIANGLES,zt.disabled,tn.disabled,L.colorModeForRenderPass(),Xt.disabled,iu(L,F,0,1),null,F.id,L.viewportBuffer,L.quadTriangleIndexBuffer,L.viewportSegments,F.paint,L.transform.zoom))}(y,T)})(n,l,d,f);break;case"line":(function(y,w,T,k){if(y.renderPass!=="translucent")return;const M=T.paint.get("line-opacity"),L=T.paint.get("line-width");if(M.constantOr(1)===0||L.constantOr(1)===0)return;const F=y.depthModeForSublayer(0,zt.ReadOnly),j=y.colorModeForRenderPass(),H=T.paint.get("line-dasharray"),K=T.paint.get("line-pattern"),re=K.constantOr(1),oe=T.paint.get("line-gradient"),ue=T.getCrossfadeParameters(),he=re?"linePattern":H?"lineSDF":oe?"lineGradient":"line",Q=y.context,me=Q.gl;let ve=!0;for(const Te of k){const ze=w.getTile(Te);if(re&&!ze.patternsLoaded())continue;const Ve=ze.getBucket(T);if(!Ve)continue;const Ye=Ve.programConfigurations.get(T.id),nt=y.context.program.get(),We=y.useProgram(he,Ye),Ze=ve||We.program!==nt,at=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Te),wt=K.constantOr(null);if(wt&&ze.imageAtlas){const vt=ze.imageAtlas,cn=vt.patternPositions[wt.to.toString()],It=vt.patternPositions[wt.from.toString()];cn&&It&&Ye.setConstantPatternPositions(cn,It)}const Xe=at?Te:null,Qe=re?Xo(y,ze,T,ue,Xe):H?dy(y,ze,T,H,ue,Xe):oe?Af(y,ze,T,Ve.lineClipsArray.length,Xe):ou(y,ze,T,Xe);if(re)Q.activeTexture.set(me.TEXTURE0),ze.imageAtlasTexture.bind(me.LINEAR,me.CLAMP_TO_EDGE),Ye.updatePaintBuffers(ue);else if(H&&(Ze||y.lineAtlas.dirty))Q.activeTexture.set(me.TEXTURE0),y.lineAtlas.bind(Q);else if(oe){const vt=Ve.gradients[T.id];let cn=vt.texture;if(T.gradientVersion!==vt.version){let It=256;if(T.stepInterpolant){const Rt=w.getSource().maxzoom,hn=Te.canonical.z===Rt?Math.ceil(1<<y.transform.maxZoom-Te.canonical.z):1;It=u.ac(u.aV(Ve.maxLineLength/u.X*1024*hn),256,Q.maxTextureSize)}vt.gradient=u.aW({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:It,image:vt.gradient||void 0,clips:Ve.lineClipsArray}),vt.texture?vt.texture.update(vt.gradient):vt.texture=new Ne(Q,vt.gradient,me.RGBA),vt.version=T.gradientVersion,cn=vt.texture}Q.activeTexture.set(me.TEXTURE0),cn.bind(T.stepInterpolant?me.NEAREST:me.LINEAR,me.CLAMP_TO_EDGE)}We.draw(Q,me.TRIANGLES,F,y.stencilModeForClipping(Te),j,Xt.disabled,Qe,at,T.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ve.segments,T.paint,y.transform.zoom,Ye,Ve.layoutVertexBuffer2),ve=!1}})(n,l,d,f);break;case"fill":(function(y,w,T,k){const M=T.paint.get("fill-color"),L=T.paint.get("fill-opacity");if(L.constantOr(1)===0)return;const F=y.colorModeForRenderPass(),j=T.paint.get("fill-pattern"),H=y.opaquePassEnabledForLayer()&&!j.constantOr(1)&&M.constantOr(u.aM.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===H){const K=y.depthModeForSublayer(1,y.renderPass==="opaque"?zt.ReadWrite:zt.ReadOnly);al(y,w,T,k,K,F,!1)}if(y.renderPass==="translucent"&&T.paint.get("fill-antialias")){const K=y.depthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,zt.ReadOnly);al(y,w,T,k,K,F,!0)}})(n,l,d,f);break;case"fill-extrusion":(function(y,w,T,k){const M=T.paint.get("fill-extrusion-opacity");if(M!==0&&y.renderPass==="translucent"){const L=new zt(y.context.gl.LEQUAL,zt.ReadWrite,y.depthRangeFor3D);if(M!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))fu(y,w,T,k,L,tn.disabled,bn.disabled),fu(y,w,T,k,L,y.stencilModeFor3D(),y.colorModeForRenderPass());else{const F=y.colorModeForRenderPass();fu(y,w,T,k,L,tn.disabled,F)}}})(n,l,d,f);break;case"hillshade":(function(y,w,T,k){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const M=y.context,L=y.depthModeForSublayer(0,zt.ReadOnly),F=y.colorModeForRenderPass(),[j,H]=y.renderPass==="translucent"?y.stencilConfigForOverlap(k):[{},k];for(const K of H){const re=w.getTile(K);re.needsHillshadePrepare!==void 0&&re.needsHillshadePrepare&&y.renderPass==="offscreen"?ea(y,re,T,L,tn.disabled,F):y.renderPass==="translucent"&&Qo(y,K,re,T,L,j[K.overscaledZ],F)}M.viewport.set([0,0,y.width,y.height])})(n,l,d,f);break;case"raster":(function(y,w,T,k){if(y.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!k.length)return;const M=y.context,L=M.gl,F=w.getSource(),j=y.useProgram("raster"),H=y.colorModeForRenderPass(),[K,re]=F instanceof bs?[{},k]:y.stencilConfigForOverlap(k),oe=re[re.length-1].overscaledZ,ue=!y.options.moving;for(const he of re){const Q=y.depthModeForSublayer(he.overscaledZ-oe,T.paint.get("raster-opacity")===1?zt.ReadWrite:zt.ReadOnly,L.LESS),me=w.getTile(he);me.registerFadeDuration(T.paint.get("raster-fade-duration"));const ve=w.findLoadedParent(he,0),Te=w.findLoadedSibling(he),ze=Wf(me,ve||Te||null,w,T,y.transform,y.style.map.terrain);let Ve,Ye;const nt=T.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;M.activeTexture.set(L.TEXTURE0),me.texture.bind(nt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),M.activeTexture.set(L.TEXTURE1),ve?(ve.texture.bind(nt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),Ve=Math.pow(2,ve.tileID.overscaledZ-me.tileID.overscaledZ),Ye=[me.tileID.canonical.x*Ve%1,me.tileID.canonical.y*Ve%1]):me.texture.bind(nt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),me.texture.useMipmap&&M.extTextureFilterAnisotropic&&y.transform.pitch>20&&L.texParameterf(L.TEXTURE_2D,M.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,M.extTextureFilterAnisotropicMax);const We=y.style.map.terrain&&y.style.map.terrain.getTerrainData(he),Ze=We?he:null,at=Ze?Ze.posMatrix:y.transform.calculatePosMatrix(he.toUnwrapped(),ue),wt=fy(at,Ye||[0,0],Ve||1,ze,T);F instanceof bs?j.draw(M,L.TRIANGLES,Q,tn.disabled,H,Xt.disabled,wt,We,T.id,F.boundsBuffer,y.quadTriangleIndexBuffer,F.boundsSegments):j.draw(M,L.TRIANGLES,Q,K[he.overscaledZ],H,Xt.disabled,wt,We,T.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}})(n,l,d,f);break;case"background":(function(y,w,T,k){const M=T.paint.get("background-color"),L=T.paint.get("background-opacity");if(L===0)return;const F=y.context,j=F.gl,H=y.transform,K=H.tileSize,re=T.paint.get("background-pattern");if(y.isPatternMissing(re))return;const oe=!re&&M.a===1&&L===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==oe)return;const ue=tn.disabled,he=y.depthModeForSublayer(0,oe==="opaque"?zt.ReadWrite:zt.ReadOnly),Q=y.colorModeForRenderPass(),me=y.useProgram(re?"backgroundPattern":"background"),ve=k||H.coveringTiles({tileSize:K,terrain:y.style.map.terrain});re&&(F.activeTexture.set(j.TEXTURE0),y.imageManager.bind(y.context));const Te=T.getCrossfadeParameters();for(const ze of ve){const Ve=k?ze.posMatrix:y.transform.calculatePosMatrix(ze.toUnwrapped()),Ye=re?eh(Ve,L,y,re,{tileID:ze,tileSize:K},Te):au(Ve,L,M),nt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ze);me.draw(F,j.TRIANGLES,he,ue,Q,Xt.disabled,Ye,nt,T.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}})(n,0,d,f);break;case"custom":(function(y,w,T){const k=y.context,M=T.implementation;if(y.renderPass==="offscreen"){const L=M.prerender;L&&(y.setCustomLayerDefaults(),k.setColorMode(y.colorModeForRenderPass()),L.call(M,k.gl,y.transform.customLayerMatrix()),k.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),k.setColorMode(y.colorModeForRenderPass()),k.setStencilMode(tn.disabled);const L=M.renderingMode==="3d"?new zt(y.context.gl.LEQUAL,zt.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,zt.ReadOnly);k.setDepthMode(L),M.render(k.gl,y.transform.customLayerMatrix(),{farZ:y.transform.farZ,nearZ:y.transform.nearZ,fov:y.transform._fov,modelViewProjectionMatrix:y.transform.modelViewProjectionMatrix,projectionMatrix:y.transform.projectionMatrix}),k.setDirty(),y.setBaseState(),k.bindFramebuffer.set(null)}})(n,0,d)}}translatePosMatrix(n,l,d,f,y){if(!d[0]&&!d[1])return n;const w=y?f==="map"?this.transform.angle:0:f==="viewport"?-this.transform.angle:0;if(w){const M=Math.sin(w),L=Math.cos(w);d=[d[0]*L-d[1]*M,d[0]*M+d[1]*L]}const T=[y?d[0]:Dt(l,d[0],this.transform.zoom),y?d[1]:Dt(l,d[1],this.transform.zoom),0],k=new Float32Array(16);return u.J(k,n,T),k}saveTileTexture(n){const l=this._tileTextures[n.size[0]];l?l.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const l=this._tileTextures[n];return l&&l.length>0?l.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const l=this.imageManager.getPattern(n.from.toString()),d=this.imageManager.getPattern(n.to.toString());return!l||!d}useProgram(n,l){this.cache=this.cache||{};const d=n+(l?l.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[d]||(this.cache[d]=new Jc(this.context,Vs[n],l,th[n],this._showOverdrawInspector,this.style.map.terrain)),this.cache[d]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ne(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:l}=this.context.gl;return this.width!==n||this.height!==l}}class na{constructor(n,l){this.points=n,this.planes=l}static fromInvProjectionMatrix(n,l,d){const f=Math.pow(2,d),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const k=1/(T=u.af([],T,n))[3]/l*f;return u.b1(T,T,[k,k,1/T[3],k])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const k=function(j,H){var K=H[0],re=H[1],oe=H[2],ue=K*K+re*re+oe*oe;return ue>0&&(ue=1/Math.sqrt(ue)),j[0]=H[0]*ue,j[1]=H[1]*ue,j[2]=H[2]*ue,j}([],function(j,H,K){var re=H[0],oe=H[1],ue=H[2],he=K[0],Q=K[1],me=K[2];return j[0]=oe*me-ue*Q,j[1]=ue*he-re*me,j[2]=re*Q-oe*he,j}([],Se([],y[T[0]],y[T[1]]),Se([],y[T[2]],y[T[1]]))),M=-((L=k)[0]*(F=y[T[1]])[0]+L[1]*F[1]+L[2]*F[2]);var L,F;return k.concat(M)});return new na(y,w)}}class ra{constructor(n,l){this.min=n,this.max=l,this.center=function(d,f,y){return d[0]=.5*f[0],d[1]=.5*f[1],d[2]=.5*f[2],d}([],function(d,f,y){return d[0]=f[0]+y[0],d[1]=f[1]+y[1],d[2]=f[2]+y[2],d}([],this.min,this.max))}quadrant(n){const l=[n%2==0,n<2],d=_e(this.min),f=_e(this.max);for(let y=0;y<l.length;y++)d[y]=l[y]?this.min[y]:this.center[y],f[y]=l[y]?this.center[y]:this.max[y];return f[2]=this.max[2],new ra(d,f)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersects(n){const l=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let d=!0;for(let f=0;f<n.planes.length;f++){const y=n.planes[f];let w=0;for(let T=0;T<l.length;T++)u.b2(y,l[T])>=0&&w++;if(w===0)return 0;w!==l.length&&(d=!1)}if(d)return 2;for(let f=0;f<3;f++){let y=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let T=0;T<n.points.length;T++){const k=n.points[T][f]-this.min[f];y=Math.min(y,k),w=Math.max(w,k)}if(w<0||y>this.max[f]-this.min[f])return 0}return 1}}class ia{constructor(n=0,l=0,d=0,f=0){if(isNaN(n)||n<0||isNaN(l)||l<0||isNaN(d)||d<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=l,this.left=d,this.right=f}interpolate(n,l,d){return l.top!=null&&n.top!=null&&(this.top=u.y.number(n.top,l.top,d)),l.bottom!=null&&n.bottom!=null&&(this.bottom=u.y.number(n.bottom,l.bottom,d)),l.left!=null&&n.left!=null&&(this.left=u.y.number(n.left,l.left,d)),l.right!=null&&n.right!=null&&(this.right=u.y.number(n.right,l.right,d)),this}getCenter(n,l){const d=u.ac((this.left+n-this.right)/2,0,n),f=u.ac((this.top+l-this.bottom)/2,0,l);return new u.P(d,f)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new ia(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const mh=85.051129;class sa{constructor(n,l,d,f,y){this.tileSize=512,this._renderWorldCopies=y===void 0||!!y,this._minZoom=n||0,this._maxZoom=l||22,this._minPitch=d??0,this._maxPitch=f??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ia,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const n=new sa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.apply(this),n}apply(n){this.tileSize=n.tileSize,this.latRange=n.latRange,this.lngRange=n.lngRange,this.width=n.width,this.height=n.height,this._center=n._center,this._elevation=n._elevation,this.minElevationForCurrentTile=n.minElevationForCurrentTile,this.zoom=n.zoom,this.angle=n.angle,this._fov=n._fov,this._pitch=n._pitch,this._unmodified=n._unmodified,this._edgeInsets=n._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(n){const l=-u.b3(n,-180,180)*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=function(){var d=new u.A(4);return u.A!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d}(),function(d,f,y){var w=f[0],T=f[1],k=f[2],M=f[3],L=Math.sin(y),F=Math.cos(y);d[0]=w*F+k*L,d[1]=T*F+M*L,d[2]=w*-L+k*F,d[3]=T*-L+M*F}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const l=u.ac(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(n){const l=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._zoom=l,this.tileZoom=Math.max(0,Math.floor(l)),this.scale=this.zoomScale(l),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,l,d){this._unmodified=!1,this._edgeInsets.interpolate(n,l,d),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const l=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(n){const l=[new u.b4(0,n)];if(this._renderWorldCopies){const d=this.pointCoordinate(new u.P(0,0)),f=this.pointCoordinate(new u.P(this.width,0)),y=this.pointCoordinate(new u.P(this.width,this.height)),w=this.pointCoordinate(new u.P(0,this.height)),T=Math.floor(Math.min(d.x,f.x,y.x,w.x)),k=Math.floor(Math.max(d.x,f.x,y.x,w.x)),M=1;for(let L=T-M;L<=k+M;L++)L!==0&&l.push(new u.b4(L,n))}return l}coveringTiles(n){var l,d;let f=this.coveringZoomLevel(n);const y=f;if(n.minzoom!==void 0&&f<n.minzoom)return[];n.maxzoom!==void 0&&f>n.maxzoom&&(f=n.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),T=u.Z.fromLngLat(this.center),k=Math.pow(2,f),M=[k*w.x,k*w.y,0],L=[k*T.x,k*T.y,0],F=na.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,f);let j=n.minzoom||0;!n.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(j=f);const H=n.terrain?2/Math.min(this.tileSize,n.tileSize)*this.tileSize:3,K=Q=>({aabb:new ra([Q*k,0,0],[(Q+1)*k,k,0]),zoom:0,x:0,y:0,wrap:Q,fullyVisible:!1}),re=[],oe=[],ue=f,he=n.reparseOverscaled?y:f;if(this._renderWorldCopies)for(let Q=1;Q<=3;Q++)re.push(K(-Q)),re.push(K(Q));for(re.push(K(0));re.length>0;){const Q=re.pop(),me=Q.x,ve=Q.y;let Te=Q.fullyVisible;if(!Te){const We=Q.aabb.intersects(F);if(We===0)continue;Te=We===2}const ze=n.terrain?M:L,Ve=Q.aabb.distanceX(ze),Ye=Q.aabb.distanceY(ze),nt=Math.max(Math.abs(Ve),Math.abs(Ye));if(Q.zoom===ue||nt>H+(1<<ue-Q.zoom)-2&&Q.zoom>=j){const We=ue-Q.zoom,Ze=M[0]-.5-(me<<We),at=M[1]-.5-(ve<<We);oe.push({tileID:new u.S(Q.zoom===ue?he:Q.zoom,Q.wrap,Q.zoom,me,ve),distanceSq:Ie([L[0]-.5-me,L[1]-.5-ve]),tileDistanceToCamera:Math.sqrt(Ze*Ze+at*at)})}else for(let We=0;We<4;We++){const Ze=(me<<1)+We%2,at=(ve<<1)+(We>>1),wt=Q.zoom+1;let Xe=Q.aabb.quadrant(We);if(n.terrain){const Qe=new u.S(wt,Q.wrap,wt,Ze,at),vt=n.terrain.getMinMaxElevation(Qe),cn=(l=vt.minElevation)!==null&&l!==void 0?l:this.elevation,It=(d=vt.maxElevation)!==null&&d!==void 0?d:this.elevation;Xe=new ra([Xe.min[0],Xe.min[1],cn],[Xe.max[0],Xe.max[1],It])}re.push({aabb:Xe,zoom:wt,x:Ze,y:at,wrap:Q.wrap,fullyVisible:Te})}}return oe.sort((Q,me)=>Q.distanceSq-me.distanceSq).map(Q=>Q.tileID)}resize(n,l){this.width=n,this.height=l,this.pixelsToGLUnits=[2/n,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const l=u.ac(n.lat,-85.051129,mh);return new u.P(u.O(n.lng)*this.worldSize,u.Q(l)*this.worldSize)}unproject(n){return new u.Z(n.x/this.worldSize,n.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(n){const l=this.elevation,d=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,f=this.pointLocation(this.centerPoint,n),y=n.getElevationForLngLatZoom(f,this.tileZoom);if(!(this.elevation-y))return;const w=d+l-y,T=Math.cos(this._pitch)*this.cameraToCenterDistance/w/u.b5(1,f.lat),k=this.scaleZoom(T/this.tileSize);this._elevation=y,this._center=f,this.zoom=k}setLocationAtPoint(n,l){const d=this.pointCoordinate(l),f=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(n),w=new u.Z(y.x-(d.x-f.x),y.y-(d.y-f.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(n,l){return l?this.coordinatePoint(this.locationCoordinate(n),l.getElevationForLngLatZoom(n,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(n))}pointLocation(n,l){return this.coordinateLocation(this.pointCoordinate(n,l))}locationCoordinate(n){return u.Z.fromLngLat(n)}coordinateLocation(n){return n&&n.toLngLat()}pointCoordinate(n,l){if(l){const j=l.pointCoordinate(n);if(j!=null)return j}const d=[n.x,n.y,0,1],f=[n.x,n.y,1,1];u.af(d,d,this.pixelMatrixInverse),u.af(f,f,this.pixelMatrixInverse);const y=d[3],w=f[3],T=d[1]/y,k=f[1]/w,M=d[2]/y,L=f[2]/w,F=M===L?0:(0-M)/(L-M);return new u.Z(u.y.number(d[0]/y,f[0]/w,F)/this.worldSize,u.y.number(T,k,F)/this.worldSize)}coordinatePoint(n,l=0,d=this.pixelMatrix){const f=[n.x*this.worldSize,n.y*this.worldSize,l,1];return u.af(f,f,d),new u.P(f[0]/f[3],f[1]/f[3])}getBounds(){const n=Math.max(0,this.height/2-this.getHorizon());return new ke().extend(this.pointLocation(new u.P(0,n))).extend(this.pointLocation(new u.P(this.width,n))).extend(this.pointLocation(new u.P(this.width,this.height))).extend(this.pointLocation(new u.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ke([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,mh])}calculateTileMatrix(n){const l=n.canonical,d=this.worldSize/this.zoomScale(l.z),f=l.x+Math.pow(2,l.z)*n.wrap,y=u.an(new Float64Array(16));return u.J(y,y,[f*d,l.y*d,0]),u.K(y,y,[d/u.X,d/u.X,1]),y}calculatePosMatrix(n,l=!1){const d=n.key,f=l?this._alignedPosMatrixCache:this._posMatrixCache;if(f[d])return f[d];const y=this.calculateTileMatrix(n);return u.L(y,l?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,y),f[d]=new Float32Array(y),f[d]}calculateFogMatrix(n){const l=n.key,d=this._fogMatrixCache;if(d[l])return d[l];const f=this.calculateTileMatrix(n);return u.L(f,this.fogMatrix,f),d[l]=new Float32Array(f),d[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(n,l){l=u.ac(+l,this.minZoom,this.maxZoom);const d={center:new u.N(n.lng,n.lat),zoom:l};let f=this.lngRange;if(!this._renderWorldCopies&&f===null){const Q=179.9999999999;f=[-Q,Q]}const y=this.tileSize*this.zoomScale(d.zoom);let w=0,T=y,k=0,M=y,L=0,F=0;const{x:j,y:H}=this.size;if(this.latRange){const Q=this.latRange;w=u.Q(Q[1])*y,T=u.Q(Q[0])*y,T-w<H&&(L=H/(T-w))}f&&(k=u.b3(u.O(f[0])*y,0,y),M=u.b3(u.O(f[1])*y,0,y),M<k&&(M+=y),M-k<j&&(F=j/(M-k)));const{x:K,y:re}=this.project.call({worldSize:y},n);let oe,ue;const he=Math.max(F||0,L||0);if(he){const Q=new u.P(F?(M+k)/2:K,L?(T+w)/2:re);return d.center=this.unproject.call({worldSize:y},Q).wrap(),d.zoom+=this.scaleZoom(he),d}if(this.latRange){const Q=H/2;re-Q<w&&(ue=w+Q),re+Q>T&&(ue=T-Q)}if(f){const Q=(k+M)/2;let me=K;this._renderWorldCopies&&(me=u.b3(K,Q-y/2,Q+y/2));const ve=j/2;me-ve<k&&(oe=k+ve),me+ve>M&&(oe=M-ve)}if(oe!==void 0||ue!==void 0){const Q=new u.P(oe??K,ue??re);d.center=this.unproject.call({worldSize:y},Q).wrap()}return d}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this._unmodified,{center:l,zoom:d}=this.getConstrained(this.center,this.zoom);this.center=l,this.zoom=d,this._unmodified=n,this._constraining=!1}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,l=this.point.x,d=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=u.b5(1,this.center.lat)*this.worldSize;let f=u.an(new Float64Array(16));u.K(f,f,[this.width/2,-this.height/2,1]),u.J(f,f,[1,-1,0]),this.labelPlaneMatrix=f,f=u.an(new Float64Array(16)),u.K(f,f,[1,-1,1]),u.J(f,f,[-1,-1,0]),u.K(f,f,[2/this.width,2/this.height,1]),this.glCoordMatrix=f;const y=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),w=Math.min(this.elevation,this.minElevationForCurrentTile),T=y-w*this._pixelPerMeter/Math.cos(this._pitch),k=w<0?T:y,M=Math.PI/2+this._pitch,L=this._fov*(.5+n.y/this.height),F=Math.sin(L)*k/Math.sin(u.ac(Math.PI-M-L,.01,Math.PI-.01)),j=this.getHorizon(),H=2*Math.atan(j/this.cameraToCenterDistance)*(.5+n.y/(2*j)),K=Math.sin(H)*k/Math.sin(u.ac(Math.PI-M-H,.01,Math.PI-.01)),re=Math.min(F,K);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*re+k),this.nearZ=this.height/50,f=new Float64Array(16),u.b6(f,this._fov,this.width/this.height,this.nearZ,this.farZ),f[8]=2*-n.x/this.width,f[9]=2*n.y/this.height,this.projectionMatrix=u.ae(f),u.K(f,f,[1,-1,1]),u.J(f,f,[0,0,-this.cameraToCenterDistance]),u.b7(f,f,this._pitch),u.ad(f,f,this.angle),u.J(f,f,[-l,-d,0]),this.mercatorMatrix=u.K([],f,[this.worldSize,this.worldSize,this.worldSize]),u.K(f,f,[1,1,this._pixelPerMeter]),this.pixelMatrix=u.L(new Float64Array(16),this.labelPlaneMatrix,f),u.J(f,f,[0,0,-this.elevation]),this.modelViewProjectionMatrix=f,this.invModelViewProjectionMatrix=u.as([],f),this.fogMatrix=new Float64Array(16),u.b6(this.fogMatrix,this._fov,this.width/this.height,y,this.farZ),this.fogMatrix[8]=2*-n.x/this.width,this.fogMatrix[9]=2*n.y/this.height,u.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),u.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),u.b7(this.fogMatrix,this.fogMatrix,this._pitch),u.ad(this.fogMatrix,this.fogMatrix,this.angle),u.J(this.fogMatrix,this.fogMatrix,[-l,-d,0]),u.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),u.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=u.L(new Float64Array(16),this.labelPlaneMatrix,f);const oe=this.width%2/2,ue=this.height%2/2,he=Math.cos(this.angle),Q=Math.sin(this.angle),me=l-Math.round(l)+he*oe+Q*ue,ve=d-Math.round(d)+he*ue+Q*oe,Te=new Float64Array(f);if(u.J(Te,Te,[me>.5?me-1:me,ve>.5?ve-1:ve,0]),this.alignedModelViewProjectionMatrix=Te,f=u.as(new Float64Array(16),this.pixelMatrix),!f)throw new Error("failed to invert matrix");this.pixelMatrixInverse=f,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const n=this.pointCoordinate(new u.P(0,0)),l=[n.x*this.worldSize,n.y*this.worldSize,0,1];return u.af(l,l,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.P(0,n))}getCameraQueryGeometry(n){const l=this.getCameraPoint();if(n.length===1)return[n[0],l];{let d=l.x,f=l.y,y=l.x,w=l.y;for(const T of n)d=Math.min(d,T.x),f=Math.min(f,T.y),y=Math.max(y,T.x),w=Math.max(w,T.y);return[new u.P(d,f),new u.P(y,f),new u.P(y,w),new u.P(d,w),new u.P(d,f)]}}lngLatToCameraDepth(n,l){const d=this.locationCoordinate(n),f=[d.x*this.worldSize,d.y*this.worldSize,l,1];return u.af(f,f,this.modelViewProjectionMatrix),f[2]/f[3]}}function ll(_,n){let l,d=!1,f=null,y=null;const w=()=>{f=null,d&&(_.apply(y,l),f=setTimeout(w,n),d=!1)};return(...T)=>(d=!0,y=this,l=T,f||w(),f)}class _u{constructor(n){this._getCurrentHash=()=>{const l=window.location.hash.replace("#","");if(this._hashName){let d;return l.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(d=f)}),(d&&d[1]||"").split("/")}return l.split("/")},this._onHashChange=()=>{const l=this._getCurrentHash();if(l.length>=3&&!l.some(d=>isNaN(d))){const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:d,pitch:+(l[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const l=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,l)},this._removeHash=()=>{const l=this._getCurrentHash();if(l.length===0)return;const d=l.join("/");let f=d;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${d}`);let y=window.location.hash.replace(f,"");y.startsWith("#&")?y=y.slice(0,1)+y.slice(2):y==="#"&&(y="");let w=window.location.href.replace(/(#.+)?$/,y);w=w.replace("&&","&"),window.history.replaceState(window.history.state,null,w)},this._updateHash=ll(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(n){const l=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,f=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,f),w=Math.round(l.lng*y)/y,T=Math.round(l.lat*y)/y,k=this._map.getBearing(),M=this._map.getPitch();let L="";if(L+=n?`/${w}/${T}/${d}`:`${d}/${T}/${w}`,(k||M)&&(L+="/"+Math.round(10*k)/10),M&&(L+=`/${Math.round(M)}`),this._hashName){const F=this._hashName;let j=!1;const H=window.location.hash.slice(1).split("&").map(K=>{const re=K.split("=")[0];return re===F?(j=!0,`${re}=${L}`):K}).filter(K=>K);return j||H.push(`${F}=${L}`),`#${H.join("&")}`}return`#${L}`}}const vu={linearity:.3,easing:u.b8(0,0,.3,1)},gh=u.e({deceleration:2500,maxSpeed:1400},vu),ky=u.e({deceleration:20,maxSpeed:1400},vu),Jf=u.e({deceleration:1e3,maxSpeed:360},vu),xu=u.e({deceleration:1e3,maxSpeed:90},vu);class yh{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:z.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,l=z.now();for(;n.length>0&&l-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const l={zoom:0,bearing:0,pitch:0,pan:new u.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)l.zoom+=y.zoomDelta||0,l.bearing+=y.bearingDelta||0,l.pitch+=y.pitchDelta||0,y.panDelta&&l.pan._add(y.panDelta),y.around&&(l.around=y.around),y.pinchAround&&(l.pinchAround=y.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(l.pan.mag()){const y=cl(l.pan.mag(),d,u.e({},gh,n||{}));f.offset=l.pan.mult(y.amount/l.pan.mag()),f.center=this._map.transform.center,ul(f,y)}if(l.zoom){const y=cl(l.zoom,d,ky);f.zoom=this._map.transform.zoom+y.amount,ul(f,y)}if(l.bearing){const y=cl(l.bearing,d,Jf);f.bearing=this._map.transform.bearing+u.ac(y.amount,-179,179),ul(f,y)}if(l.pitch){const y=cl(l.pitch,d,xu);f.pitch=this._map.transform.pitch+y.amount,ul(f,y)}if(f.zoom||f.bearing){const y=l.pinchAround===void 0?l.around:l.pinchAround;f.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),u.e(f,{noMoveStart:!0})}}function ul(_,n){(!_.duration||_.duration<n.duration)&&(_.duration=n.duration,_.easing=n.easing)}function cl(_,n,l){const{maxSpeed:d,linearity:f,deceleration:y}=l,w=u.ac(_*f/(n/1e3),-d,d),T=Math.abs(w)/(y*f);return{easing:l.easing,duration:1e3*T,amount:w*(T/2)}}class or extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,d,f={}){const y=A.mousePos(l.getCanvas(),d),w=l.unproject(y);super(n,u.e({point:y,lngLat:w,originalEvent:d},f)),this._defaultPrevented=!1,this.target=l}}class _o extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,d){const f=n==="touchend"?d.changedTouches:d.touches,y=A.touchPos(l.getCanvasContainer(),f),w=y.map(k=>l.unproject(k)),T=y.reduce((k,M,L,F)=>k.add(M.div(F.length)),new u.P(0,0));super(n,{points:y,point:T,lngLats:w,lngLat:l.unproject(T),originalEvent:d}),this._defaultPrevented=!1}}class Qf extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,d){super(n,{originalEvent:d}),this._defaultPrevented=!1}}class ep{constructor(n,l){this._map=n,this._clickTolerance=l.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new Qf(n.type,this._map,n))}mousedown(n,l){return this._mousedownPos=l,this._firePreventable(new or(n.type,this._map,n))}mouseup(n){this._map.fire(new or(n.type,this._map,n))}click(n,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||this._map.fire(new or(n.type,this._map,n))}dblclick(n){return this._firePreventable(new or(n.type,this._map,n))}mouseover(n){this._map.fire(new or(n.type,this._map,n))}mouseout(n){this._map.fire(new or(n.type,this._map,n))}touchstart(n){return this._firePreventable(new _o(n.type,this._map,n))}touchmove(n){this._map.fire(new _o(n.type,this._map,n))}touchend(n){this._map.fire(new _o(n.type,this._map,n))}touchcancel(n){this._map.fire(new _o(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wn{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new or(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new or("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new or(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Mi{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.pointLocation(u.P.convert(n),this._map.terrain)}}class Xr{constructor(n,l){this._map=n,this._tr=new Mi(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,l){this.isEnabled()&&n.shiftKey&&n.button===0&&(A.disableDrag(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(n,l){if(!this._active)return;const d=l;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=d,this._box||(this._box=A.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const y=Math.min(f.x,d.x),w=Math.max(f.x,d.x),T=Math.min(f.y,d.y),k=Math.max(f.y,d.y);A.setTransform(this._box,`translate(${y}px,${T}px)`),this._box.style.width=w-y+"px",this._box.style.height=k-T+"px"}mouseupWindow(n,l){if(!this._active||n.button!==0)return;const d=this._startPos,f=l;if(this.reset(),A.suppressClick(),d.x!==f.x||d.y!==f.y)return this._map.fire(new u.k("boxzoomend",{originalEvent:n})),{cameraAnimation:y=>y.fitScreenCoordinates(d,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,l){return this._map.fire(new u.k(n,{originalEvent:l}))}}function hl(_,n){if(_.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${_.length}, points ${n.length}`);const l={};for(let d=0;d<_.length;d++)l[_[d].identifier]=n[d];return l}class _h{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,l,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),d.length===this.numTouches&&(this.centroid=function(f){const y=new u.P(0,0);for(const w of f)y._add(w);return y.div(f.length)}(l),this.touches=hl(d,l)))}touchmove(n,l,d){if(this.aborted||!this.centroid)return;const f=hl(d,l);for(const y in this.touches){const w=f[y];(!w||w.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(n,l,d){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class bu{constructor(n){this.singleTap=new _h(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,l,d){this.singleTap.touchstart(n,l,d)}touchmove(n,l,d){this.singleTap.touchmove(n,l,d)}touchend(n,l,d){const f=this.singleTap.touchend(n,l,d);if(f){const y=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(f)<30;if(y&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class oa{constructor(n){this._tr=new Mi(n),this._zoomIn=new bu({numTouches:1,numTaps:2}),this._zoomOut=new bu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,l,d){this._zoomIn.touchstart(n,l,d),this._zoomOut.touchstart(n,l,d)}touchmove(n,l,d){this._zoomIn.touchmove(n,l,d),this._zoomOut.touchmove(n,l,d)}touchend(n,l,d){const f=this._zoomIn.touchend(n,l,d),y=this._zoomOut.touchend(n,l,d),w=this._tr;return f?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(f)},{originalEvent:n})}):y?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(y)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ts{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const l=this._moveFunction(...n);if(l.bearingDelta||l.pitchDelta||l.around||l.panDelta)return this._active=!0,l}dragStart(n,l){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=l.length?l[0]:l,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,l){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const f=l.length?l[0]:l;return!this._moved&&f.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(d,f))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&A.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const vh={0:1,2:2};class wu{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const l=A.mouseButton(n);this._eventButton=l}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!function(l,d){const f=vh[d];return l.buttons===void 0||(l.buttons&f)!==f}(n,this._eventButton)}isValidEndEvent(n){return A.mouseButton(n)===this._eventButton}}class xh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}const Su=_=>{_.mousedown=_.dragStart,_.mousemoveWindow=_.dragMove,_.mouseup=_.dragEnd,_.contextmenu=n=>{n.preventDefault()}},bh=({enable:_,clickTolerance:n,bearingDegreesPerPixelMoved:l=.8})=>{const d=new wu({checkCorrectEvent:f=>A.mouseButton(f)===0&&f.ctrlKey||A.mouseButton(f)===2});return new Ts({clickTolerance:n,move:(f,y)=>({bearingDelta:(y.x-f.x)*l}),moveStateManager:d,enable:_,assignEvents:Su})},wh=({enable:_,clickTolerance:n,pitchDegreesPerPixelMoved:l=-.5})=>{const d=new wu({checkCorrectEvent:f=>A.mouseButton(f)===0&&f.ctrlKey||A.mouseButton(f)===2});return new Ts({clickTolerance:n,move:(f,y)=>({pitchDelta:(y.y-f.y)*l}),moveStateManager:d,enable:_,assignEvents:Su})};class vo{constructor(n,l){this._clickTolerance=n.clickTolerance||1,this._map=l,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.P(0,0)}_shouldBePrevented(n){return n<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(n,l,d){return this._calculateTransform(n,l,d)}touchmove(n,l,d){if(this._active){if(!this._shouldBePrevented(d.length))return n.preventDefault(),this._calculateTransform(n,l,d);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",n)}}touchend(n,l,d){this._calculateTransform(n,l,d),this._active&&this._shouldBePrevented(d.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,l,d){d.length>0&&(this._active=!0);const f=hl(d,l),y=new u.P(0,0),w=new u.P(0,0);let T=0;for(const M in f){const L=f[M],F=this._touches[M];F&&(y._add(L),w._add(L.sub(F)),T++,f[M]=L)}if(this._touches=f,this._shouldBePrevented(T)||!w.mag())return;const k=w.div(T);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(T),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Tu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,l,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([l[0],l[1]]))}touchmove(n,l,d){if(!this._firstTwoTouches)return;n.preventDefault();const[f,y]=this._firstTwoTouches,w=dl(d,l,f),T=dl(d,l,y);if(!w||!T)return;const k=this._aroundCenter?null:w.add(T).div(2);return this._move([w,T],k,n)}touchend(n,l,d){if(!this._firstTwoTouches)return;const[f,y]=this._firstTwoTouches,w=dl(d,l,f),T=dl(d,l,y);w&&T||(this._active&&A.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function dl(_,n,l){for(let d=0;d<_.length;d++)if(_[d].identifier===l)return n[d]}function Sh(_,n){return Math.log(_/n)/Math.LN2}class Th extends Tu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,l){const d=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(Sh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Sh(this._distance,d),pinchAround:l}}}function Ch(_,n){return 180*_.angleWith(n)/Math.PI}class kh extends Tu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,l,d){const f=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ch(this._vector,f),pinchAround:l}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const l=25/(Math.PI*this._minDiameter)*360,d=Ch(n,this._startVector);return Math.abs(d)<l}}function Cu(_){return Math.abs(_.y)>Math.abs(_.x)}class fl extends Tu{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,l,d){super.touchstart(n,l,d),this._currentTouchCount=d.length}_start(n){this._lastPoints=n,Cu(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,l,d){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=n[0].sub(this._lastPoints[0]),y=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,y,d.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(f.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(n,l,d){if(this._valid!==void 0)return this._valid;const f=n.mag()>=2,y=l.mag()>=2;if(!f&&!y)return;if(!f||!y)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const w=n.y>0==l.y>0;return Cu(n)&&Cu(l)&&w}}const tp={panStep:100,bearingStep:15,pitchStep:10};class ci{constructor(n){this._tr=new Mi(n);const l=tp;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let l=0,d=0,f=0,y=0,w=0;switch(n.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:n.shiftKey?d=-1:(n.preventDefault(),y=-1);break;case 39:n.shiftKey?d=1:(n.preventDefault(),y=1);break;case 38:n.shiftKey?f=1:(n.preventDefault(),w=-1);break;case 40:n.shiftKey?f=-1:(n.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(d=0,f=0),{cameraAnimation:T=>{const k=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:ts,zoom:l?Math.round(k.zoom)+l*(n.shiftKey?2:1):k.zoom,bearing:k.bearing+d*this._bearingStep,pitch:k.pitch+f*this._pitchStep,offset:[-y*this._panStep,-w*this._panStep],center:k.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ts(_){return _*(2-_)}const Ph=4.000244140625;class Ai{constructor(n,l){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=n,this._tr=new Mi(n),this._triggerRenderFrame=l,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(n){return!!this._map.cooperativeGestures.isEnabled()&&!(n.ctrlKey||this._map.cooperativeGestures.isBypassed(n))}wheel(n){if(!this.isEnabled())return;if(this._shouldBePrevented(n))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",n);let l=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const d=z.now(),f=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,l!==0&&l%Ph==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=l,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(f*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),n.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=n,this._delta-=l,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=A.mousePos(this._map.getCanvas(),n),d=this._tr;this._around=l.y>d.transform.height/2-d.transform.getHorizon()?u.N.convert(this._aroundCenter?d.center:d.unproject(l)):u.N.convert(d.center),this._aroundPoint=d.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>Ph?this._wheelZoomRate:this._defaultZoomRate;let M=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&M!==0&&(M=1/M);const L=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(L*M))),this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const l=typeof this._targetZoom=="number"?this._targetZoom:n.zoom,d=this._startZoom,f=this._easing;let y,w=!1;const T=z.now()-this._lastWheelEventTime;if(this._type==="wheel"&&d&&f&&T){const k=Math.min(T/200,1),M=f(k);y=u.y.number(d,l,M),k<1?this._frameId||(this._frameId=!0):w=!0}else y=l,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:y-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let l=u.b9;if(this._prevEase){const d=this._prevEase,f=(z.now()-d.start)/d.duration,y=d.easing(f+.01)-d.easing(f),w=.27/Math.sqrt(y*y+1e-4)*.01,T=Math.sqrt(.0729-w*w);l=u.b8(w,T,.25,1)}return this._prevEase={start:z.now(),duration:n,easing:l},l}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class xo{constructor(n,l){this._clickZoom=n,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Py{constructor(n){this._tr=new Mi(n),this.reset()}reset(){this._active=!1}dblclick(n,l){return n.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(l)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ey{constructor(){this._tap=new bu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,l,d){if(!this._swipePoint)if(this._tapTime){const f=l[0],y=n.timeStamp-this._tapTime<500,w=this._tapPoint.dist(f)<30;y&&w?d.length>0&&(this._swipePoint=f,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(n,l,d)}touchmove(n,l,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const f=l[0],y=f.y-this._swipePoint.y;return this._swipePoint=f,n.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(n,l,d)}touchend(n,l,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const f=this._tap.touchend(n,l,d);f&&(this._tapTime=n.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class np{constructor(n,l,d){this._el=n,this._mousePan=l,this._touchPan=d}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class rp{constructor(n,l,d){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=l,this._mousePitch=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Eh{constructor(n,l,d,f){this._el=n,this._touchZoom=l,this._touchRotate=d,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class aa{constructor(n,l){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=l,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=A.create("div","maplibregl-cooperative-gesture-screen",n);let l=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(l=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const d=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=l,this._container.appendChild(f);const y=document.createElement("div");y.className="maplibregl-mobile-message",y.textContent=d,this._container.appendChild(y),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(A.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(n){return n[this._bypassKey]}notifyGestureBlocked(n,l){this._enabled&&(this._map.fire(new u.k("cooperativegestureprevented",{gestureType:n,originalEvent:l})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const hi=_=>_.zoom||_.drag||_.pitch||_.rotate;class it extends u.k{}function ku(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class Ih{constructor(n,l){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,y)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=f.type==="renderFrame"?void 0:f,T={needsRenderFrame:!1},k={},M={},L=f.touches,F=L?this._getMapTouches(L):void 0,j=F?A.touchPos(this._map.getCanvas(),F):A.mousePos(this._map.getCanvas(),f);for(const{handlerName:re,handler:oe,allowed:ue}of this._handlers){if(!oe.isEnabled())continue;let he;this._blockedByActive(M,ue,re)?oe.reset():oe[y||f.type]&&(he=oe[y||f.type](f,j,F),this.mergeHandlerResult(T,k,he,re,w),he&&he.needsRenderFrame&&this._triggerRenderFrame()),(he||oe.isActive())&&(M[re]=oe)}const H={};for(const re in this._previousActiveHandlers)M[re]||(H[re]=w);this._previousActiveHandlers=M,(Object.keys(H).length||ku(T))&&(this._changes.push([T,k,H]),this._triggerRenderFrame()),(Object.keys(M).length||ku(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:K}=T;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new yh(n),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(l);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,y,w]of this._listeners)A.addEventListener(f,y,f===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[n,l,d]of this._listeners)A.removeEventListener(n,l,n===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(n){const l=this._map,d=l.getCanvasContainer();this._add("mapEvent",new ep(l,n));const f=l.boxZoom=new Xr(l,n);this._add("boxZoom",f),n.interactive&&n.boxZoom&&f.enable();const y=l.cooperativeGestures=new aa(l,n.cooperativeGestures);this._add("cooperativeGestures",y),n.cooperativeGestures&&y.enable();const w=new oa(l),T=new Py(l);l.doubleClickZoom=new xo(T,w),this._add("tapZoom",w),this._add("clickZoom",T),n.interactive&&n.doubleClickZoom&&l.doubleClickZoom.enable();const k=new Ey;this._add("tapDragZoom",k);const M=l.touchPitch=new fl(l);this._add("touchPitch",M),n.interactive&&n.touchPitch&&l.touchPitch.enable(n.touchPitch);const L=bh(n),F=wh(n);l.dragRotate=new rp(n,L,F),this._add("mouseRotate",L,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]),n.interactive&&n.dragRotate&&l.dragRotate.enable();const j=(({enable:he,clickTolerance:Q})=>{const me=new wu({checkCorrectEvent:ve=>A.mouseButton(ve)===0&&!ve.ctrlKey});return new Ts({clickTolerance:Q,move:(ve,Te)=>({around:Te,panDelta:Te.sub(ve)}),activateOnStart:!0,moveStateManager:me,enable:he,assignEvents:Su})})(n),H=new vo(n,l);l.dragPan=new np(d,j,H),this._add("mousePan",j),this._add("touchPan",H,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&l.dragPan.enable(n.dragPan);const K=new kh,re=new Th;l.touchZoomRotate=new Eh(d,re,K,k),this._add("touchRotate",K,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&l.touchZoomRotate.enable(n.touchZoomRotate);const oe=l.scrollZoom=new Ai(l,()=>this._triggerRenderFrame());this._add("scrollZoom",oe,["mousePan"]),n.interactive&&n.scrollZoom&&l.scrollZoom.enable(n.scrollZoom);const ue=l.keyboard=new ci(l);this._add("keyboard",ue),n.interactive&&n.keyboard&&l.keyboard.enable(),this._add("blockableMapEvent",new wn(l))}_add(n,l,d){this._handlers.push({handlerName:n,handler:l,allowed:d}),this._handlersById[n]=l}stop(n){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!hi(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,l,d){for(const f in n)if(f!==d&&(!l||l.indexOf(f)<0))return!0;return!1}_getMapTouches(n){const l=[];for(const d of n)this._el.contains(d.target)&&l.push(d);return l}mergeHandlerResult(n,l,d,f,y){if(!d)return;u.e(n,d);const w={handlerName:f,originalEvent:d.originalEvent||y};d.zoomDelta!==void 0&&(l.zoom=w),d.panDelta!==void 0&&(l.drag=w),d.pitchDelta!==void 0&&(l.pitch=w),d.bearingDelta!==void 0&&(l.rotate=w)}_applyChanges(){const n={},l={},d={};for(const[f,y,w]of this._changes)f.panDelta&&(n.panDelta=(n.panDelta||new u.P(0,0))._add(f.panDelta)),f.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+f.pitchDelta),f.around!==void 0&&(n.around=f.around),f.pinchAround!==void 0&&(n.pinchAround=f.pinchAround),f.noInertia&&(n.noInertia=f.noInertia),u.e(l,y),u.e(d,w);this._updateMapTransform(n,l,d),this._changes=[]}_updateMapTransform(n,l,d){const f=this._map,y=f._getTransformForUpdate(),w=f.terrain;if(!(ku(n)||w&&this._terrainMovement))return this._fireEvents(l,d,!0);let{panDelta:T,zoomDelta:k,bearingDelta:M,pitchDelta:L,around:F,pinchAround:j}=n;j!==void 0&&(F=j),f._stop(!0),F=F||f.transform.centerPoint;const H=y.pointLocation(T?F.sub(T):F);M&&(y.bearing+=M),L&&(y.pitch+=L),k&&(y.zoom+=k),w?this._terrainMovement||!l.drag&&!l.zoom?l.drag&&this._terrainMovement?y.center=y.pointLocation(y.centerPoint.sub(T)):y.setLocationAtPoint(H,F):(this._terrainMovement=!0,this._map._elevationFreeze=!0,y.setLocationAtPoint(H,F)):y.setLocationAtPoint(H,F),f._applyUpdatedTransform(y),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(l,d,!0)}_fireEvents(n,l,d){const f=hi(this._eventsInProgress),y=hi(n),w={};for(const F in n){const{originalEvent:j}=n[F];this._eventsInProgress[F]||(w[`${F}start`]=j),this._eventsInProgress[F]=n[F]}!f&&y&&this._fireEvent("movestart",y.originalEvent);for(const F in w)this._fireEvent(F,w[F]);y&&this._fireEvent("move",y.originalEvent);for(const F in n){const{originalEvent:j}=n[F];this._fireEvent(F,j)}const T={};let k;for(const F in this._eventsInProgress){const{handlerName:j,originalEvent:H}=this._eventsInProgress[F];this._handlersById[j].isActive()||(delete this._eventsInProgress[F],k=l[j]||H,T[`${F}end`]=k)}for(const F in T)this._fireEvent(F,T[F]);const M=hi(this._eventsInProgress),L=(f||y)&&!M;if(L&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const F=this._map._getTransformForUpdate();F.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(F)}if(d&&L){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=H=>H!==0&&-this._bearingSnap<H&&H<this._bearingSnap;!F||!F.essential&&z.prefersReducedMotion?(this._map.fire(new u.k("moveend",{originalEvent:k})),j(this._map.getBearing())&&this._map.resetNorth()):(j(F.bearing||this._map.getBearing())&&(F.bearing=0),F.freezeElevation=!0,this._map.easeTo(F,{originalEvent:k})),this._updatingCamera=!1}}_fireEvent(n,l){this._map.fire(new u.k(n,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new it("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class ip extends u.E{constructor(n,l){super(),this._renderFrameCallback=()=>{const d=Math.min((z.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new u.N(this.transform.center.lng,this.transform.center.lat)}setCenter(n,l){return this.jumpTo({center:n},l)}panBy(n,l,d){return n=u.P.convert(n).mult(-1),this.panTo(this.transform.center,u.e({offset:n},l),d)}panTo(n,l,d){return this.easeTo(u.e({center:n},l),d)}getZoom(){return this.transform.zoom}setZoom(n,l){return this.jumpTo({zoom:n},l),this}zoomTo(n,l,d){return this.easeTo(u.e({zoom:n},l),d)}zoomIn(n,l){return this.zoomTo(this.getZoom()+1,n,l),this}zoomOut(n,l){return this.zoomTo(this.getZoom()-1,n,l),this}getBearing(){return this.transform.bearing}setBearing(n,l){return this.jumpTo({bearing:n},l),this}getPadding(){return this.transform.padding}setPadding(n,l){return this.jumpTo({padding:n},l),this}rotateTo(n,l,d){return this.easeTo(u.e({bearing:n},l),d)}resetNorth(n,l){return this.rotateTo(0,u.e({duration:1e3},n),l),this}resetNorthPitch(n,l){return this.easeTo(u.e({bearing:0,pitch:0,duration:1e3},n),l),this}snapToNorth(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this}getPitch(){return this.transform.pitch}setPitch(n,l){return this.jumpTo({pitch:n},l),this}cameraForBounds(n,l){n=ke.convert(n).adjustAntiMeridian();const d=l&&l.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),d,l)}_cameraForBoxAndBearing(n,l,d,f){const y={top:0,bottom:0,right:0,left:0};if(typeof(f=u.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const We=f.padding;f.padding={top:We,bottom:We,right:We,left:We}}f.padding=u.e(y,f.padding);const w=this.transform,T=w.padding,k=new ke(n,l),M=w.project(k.getNorthWest()),L=w.project(k.getNorthEast()),F=w.project(k.getSouthEast()),j=w.project(k.getSouthWest()),H=u.ba(-d),K=M.rotate(H),re=L.rotate(H),oe=F.rotate(H),ue=j.rotate(H),he=new u.P(Math.max(K.x,re.x,ue.x,oe.x),Math.max(K.y,re.y,ue.y,oe.y)),Q=new u.P(Math.min(K.x,re.x,ue.x,oe.x),Math.min(K.y,re.y,ue.y,oe.y)),me=he.sub(Q),ve=(w.width-(T.left+T.right+f.padding.left+f.padding.right))/me.x,Te=(w.height-(T.top+T.bottom+f.padding.top+f.padding.bottom))/me.y;if(Te<0||ve<0)return void u.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ze=Math.min(w.scaleZoom(w.scale*Math.min(ve,Te)),f.maxZoom),Ve=u.P.convert(f.offset),Ye=new u.P((f.padding.left-f.padding.right)/2,(f.padding.top-f.padding.bottom)/2).rotate(u.ba(d)),nt=Ve.add(Ye).mult(w.scale/w.zoomScale(ze));return{center:w.unproject(M.add(F).div(2).sub(nt)),zoom:ze,bearing:d}}fitBounds(n,l,d){return this._fitInternal(this.cameraForBounds(n,l),l,d)}fitScreenCoordinates(n,l,d,f,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.P.convert(n)),this.transform.pointLocation(u.P.convert(l)),d,f),f,y)}_fitInternal(n,l,d){return n?(delete(l=u.e(n,l)).padding,l.linear?this.easeTo(l,d):this.flyTo(l,d)):this}jumpTo(n,l){this.stop();const d=this._getTransformForUpdate();let f=!1,y=!1,w=!1;return"zoom"in n&&d.zoom!==+n.zoom&&(f=!0,d.zoom=+n.zoom),n.center!==void 0&&(d.center=u.N.convert(n.center)),"bearing"in n&&d.bearing!==+n.bearing&&(y=!0,d.bearing=+n.bearing),"pitch"in n&&d.pitch!==+n.pitch&&(w=!0,d.pitch=+n.pitch),n.padding==null||d.isPaddingEqual(n.padding)||(d.padding=n.padding),this._applyUpdatedTransform(d),this.fire(new u.k("movestart",l)).fire(new u.k("move",l)),f&&this.fire(new u.k("zoomstart",l)).fire(new u.k("zoom",l)).fire(new u.k("zoomend",l)),y&&this.fire(new u.k("rotatestart",l)).fire(new u.k("rotate",l)).fire(new u.k("rotateend",l)),w&&this.fire(new u.k("pitchstart",l)).fire(new u.k("pitch",l)).fire(new u.k("pitchend",l)),this.fire(new u.k("moveend",l))}calculateCameraOptionsFromTo(n,l,d,f=0){const y=u.Z.fromLngLat(n,l),w=u.Z.fromLngLat(d,f),T=w.x-y.x,k=w.y-y.y,M=w.z-y.z,L=Math.hypot(T,k,M);if(L===0)throw new Error("Can't calculate camera options with same From and To");const F=Math.hypot(T,k),j=this.transform.scaleZoom(this.transform.cameraToCenterDistance/L/this.transform.tileSize),H=180*Math.atan2(T,-k)/Math.PI;let K=180*Math.acos(F/L)/Math.PI;return K=M<0?90-K:90+K,{center:w.toLngLat(),zoom:j,pitch:K,bearing:H}}easeTo(n,l){var d;this._stop(!1,n.easeId),((n=u.e({offset:[0,0],duration:500,easing:u.b9},n)).animate===!1||!n.essential&&z.prefersReducedMotion)&&(n.duration=0);const f=this._getTransformForUpdate(),y=f.zoom,w=f.bearing,T=f.pitch,k=f.padding,M="bearing"in n?this._normalizeBearing(n.bearing,w):w,L="pitch"in n?+n.pitch:T,F="padding"in n?n.padding:f.padding,j=u.P.convert(n.offset);let H=f.centerPoint.add(j);const K=f.pointLocation(H),{center:re,zoom:oe}=f.getConstrained(u.N.convert(n.center||K),(d=n.zoom)!==null&&d!==void 0?d:y);this._normalizeCenter(re,f);const ue=f.project(K),he=f.project(re).sub(ue),Q=f.zoomScale(oe-y);let me,ve;n.around&&(me=u.N.convert(n.around),ve=f.locationPoint(me));const Te={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||oe!==y,this._rotating=this._rotating||w!==M,this._pitching=this._pitching||L!==T,this._padding=!f.isPaddingEqual(F),this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,Te),this.terrain&&this._prepareElevation(re),this._ease(ze=>{if(this._zooming&&(f.zoom=u.y.number(y,oe,ze)),this._rotating&&(f.bearing=u.y.number(w,M,ze)),this._pitching&&(f.pitch=u.y.number(T,L,ze)),this._padding&&(f.interpolatePadding(k,F,ze),H=f.centerPoint.add(j)),this.terrain&&!n.freezeElevation&&this._updateElevation(ze),me)f.setLocationAtPoint(me,ve);else{const Ve=f.zoomScale(f.zoom-y),Ye=oe>y?Math.min(2,Q):Math.max(.5,Q),nt=Math.pow(Ye,1-ze),We=f.unproject(ue.add(he.mult(ze*nt)).mult(Ve));f.setLocationAtPoint(f.renderWorldCopies?We.wrap():We,H)}this._applyUpdatedTransform(f),this._fireMoveEvents(l)},ze=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(l,ze)},n),this}_prepareEase(n,l,d={}){this._moving=!0,l||d.moving||this.fire(new u.k("movestart",n)),this._zooming&&!d.zooming&&this.fire(new u.k("zoomstart",n)),this._rotating&&!d.rotating&&this.fire(new u.k("rotatestart",n)),this._pitching&&!d.pitching&&this.fire(new u.k("pitchstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const l=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&l!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(d-(l-(d*n+this._elevationStart))/(1-n)),this._elevationTarget=l}this.transform.elevation=u.y.number(this._elevationStart,this._elevationTarget,n)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(n){const l=n.getCameraPosition(),d=this.terrain.getElevationForLngLatZoom(l.lngLat,n.zoom);if(l.altitude<d){const f=this.calculateCameraOptionsFromTo(l.lngLat,d,n.center,n.elevation);return{pitch:f.pitch,zoom:f.zoom}}return{}}_applyUpdatedTransform(n){const l=[];if(this.terrain&&l.push(f=>this._elevateCameraIfInsideTerrain(f)),this.transformCameraUpdate&&l.push(f=>this.transformCameraUpdate(f)),!l.length)return;const d=n.clone();for(const f of l){const y=d.clone(),{center:w,zoom:T,pitch:k,bearing:M,elevation:L}=f(y);w&&(y.center=w),T!==void 0&&(y.zoom=T),k!==void 0&&(y.pitch=k),M!==void 0&&(y.bearing=M),L!==void 0&&(y.elevation=L),d.apply(y)}this.transform.apply(d)}_fireMoveEvents(n){this.fire(new u.k("move",n)),this._zooming&&this.fire(new u.k("zoom",n)),this._rotating&&this.fire(new u.k("rotate",n)),this._pitching&&this.fire(new u.k("pitch",n))}_afterEase(n,l){if(this._easeId&&l&&this._easeId===l)return;delete this._easeId;const d=this._zooming,f=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new u.k("zoomend",n)),f&&this.fire(new u.k("rotateend",n)),y&&this.fire(new u.k("pitchend",n)),this.fire(new u.k("moveend",n))}flyTo(n,l){var d;if(!n.essential&&z.prefersReducedMotion){const Qe=u.M(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Qe,l)}this.stop(),n=u.e({offset:[0,0],speed:1.2,curve:1.42,easing:u.b9},n);const f=this._getTransformForUpdate(),y=f.zoom,w=f.bearing,T=f.pitch,k=f.padding,M="bearing"in n?this._normalizeBearing(n.bearing,w):w,L="pitch"in n?+n.pitch:T,F="padding"in n?n.padding:f.padding,j=u.P.convert(n.offset);let H=f.centerPoint.add(j);const K=f.pointLocation(H),{center:re,zoom:oe}=f.getConstrained(u.N.convert(n.center||K),(d=n.zoom)!==null&&d!==void 0?d:y);this._normalizeCenter(re,f);const ue=f.zoomScale(oe-y),he=f.project(K),Q=f.project(re).sub(he);let me=n.curve;const ve=Math.max(f.width,f.height),Te=ve/ue,ze=Q.mag();if("minZoom"in n){const Qe=u.ac(Math.min(n.minZoom,y,oe),f.minZoom,f.maxZoom),vt=ve/f.zoomScale(Qe-y);me=Math.sqrt(vt/ze*2)}const Ve=me*me;function Ye(Qe){const vt=(Te*Te-ve*ve+(Qe?-1:1)*Ve*Ve*ze*ze)/(2*(Qe?Te:ve)*Ve*ze);return Math.log(Math.sqrt(vt*vt+1)-vt)}function nt(Qe){return(Math.exp(Qe)-Math.exp(-Qe))/2}function We(Qe){return(Math.exp(Qe)+Math.exp(-Qe))/2}const Ze=Ye(!1);let at=function(Qe){return We(Ze)/We(Ze+me*Qe)},wt=function(Qe){return ve*((We(Ze)*(nt(vt=Ze+me*Qe)/We(vt))-nt(Ze))/Ve)/ze;var vt},Xe=(Ye(!0)-Ze)/me;if(Math.abs(ze)<1e-6||!isFinite(Xe)){if(Math.abs(ve-Te)<1e-6)return this.easeTo(n,l);const Qe=Te<ve?-1:1;Xe=Math.abs(Math.log(Te/ve))/me,wt=()=>0,at=vt=>Math.exp(Qe*me*vt)}return n.duration="duration"in n?+n.duration:1e3*Xe/("screenSpeed"in n?+n.screenSpeed/me:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=w!==M,this._pitching=L!==T,this._padding=!f.isPaddingEqual(F),this._prepareEase(l,!1),this.terrain&&this._prepareElevation(re),this._ease(Qe=>{const vt=Qe*Xe,cn=1/at(vt);f.zoom=Qe===1?oe:y+f.scaleZoom(cn),this._rotating&&(f.bearing=u.y.number(w,M,Qe)),this._pitching&&(f.pitch=u.y.number(T,L,Qe)),this._padding&&(f.interpolatePadding(k,F,Qe),H=f.centerPoint.add(j)),this.terrain&&!n.freezeElevation&&this._updateElevation(Qe);const It=Qe===1?re:f.unproject(he.add(Q.mult(wt(vt))).mult(cn));f.setLocationAtPoint(f.renderWorldCopies?It.wrap():It,H),this._applyUpdatedTransform(f),this._fireMoveEvents(l)},()=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(l)},n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,l){var d;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,l)}return n||(d=this.handlers)===null||d===void 0||d.stop(!1),this}_ease(n,l,d){d.animate===!1||d.duration===0?(n(1),l()):(this._easeStart=z.now(),this._easeOptions=d,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,l){n=u.b3(n,-180,180);const d=Math.abs(n-l);return Math.abs(n-360-l)<d&&(n-=360),Math.abs(n+360-l)<d&&(n+=360),n}_normalizeCenter(n,l){if(!l.renderWorldCopies||l.lngRange)return;const d=n.lng-l.center.lng;n.lng+=d>180?-360:d<-180?360:0}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLatZoom(u.N.convert(n),this.transform.tileZoom)-this.transform.elevation:null}}const la={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class ua{constructor(n=la){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=l=>{!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"&&l.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=A.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=A.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,l){const d=this._map._getUIString(`AttributionControl.${l}`);n.title=d,n.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const l=this._map.style.sourceCaches;for(const f in l){const y=l[f];if(y.used||y.usedForTerrain){const w=y.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n=n.filter(f=>String(f).trim()),n.sort((f,y)=>f.length-y.length),n=n.filter((f,y)=>{for(let w=y+1;w<n.length;w++)if(n[w].indexOf(f)>=0)return!1;return!0});const d=n.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,n.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Mh{constructor(n={}){this._updateCompact=()=>{const l=this._container.children;if(l.length){const d=l[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=A.create("div","maplibregl-ctrl");const l=A.create("a","maplibregl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://maplibre.org/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){A.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Lt{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const l=++this._id;return this._queue.push({callback:n,id:l,cancelled:!1}),l}remove(n){const l=this._currentlyRunning,d=l?this._queue.concat(l):this._queue;for(const f of d)if(f.id===n)return void(f.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const l=this._currentlyRunning=this._queue;this._queue=[];for(const d of l)if(!d.cancelled&&(d.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ah=u.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Iy extends u.E{constructor(n){super(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,n.usedForTerrain=!0,n.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,l){this.sourceCache.update(n,l),this._renderableTilesKeys=[];const d={};for(const f of n.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:l}))d[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.posMatrix=new Float64Array(16),u.aP(f.posMatrix,0,u.X,0,u.X,0,1),this._tiles[f.key]=new Bs(f,this.tileSize));for(const f in this._tiles)d[f]||delete this._tiles[f]}freeRtt(n){for(const l in this._tiles){const d=this._tiles[l];(!n||d.tileID.equals(n)||d.tileID.isChildOf(n)||n.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n){const l={};for(const d of this._renderableTilesKeys){const f=this._tiles[d].tileID;if(f.canonical.equals(n.canonical)){const y=n.clone();y.posMatrix=new Float64Array(16),u.aP(y.posMatrix,0,u.X,0,u.X,0,1),l[d]=y}else if(f.canonical.isChildOf(n.canonical)){const y=n.clone();y.posMatrix=new Float64Array(16);const w=f.canonical.z-n.canonical.z,T=f.canonical.x-(f.canonical.x>>w<<w),k=f.canonical.y-(f.canonical.y>>w<<w),M=u.X>>w;u.aP(y.posMatrix,0,M,0,M,0,1),u.J(y.posMatrix,y.posMatrix,[-T*M,-k*M,0]),l[d]=y}else if(n.canonical.isChildOf(f.canonical)){const y=n.clone();y.posMatrix=new Float64Array(16);const w=n.canonical.z-f.canonical.z,T=n.canonical.x-(n.canonical.x>>w<<w),k=n.canonical.y-(n.canonical.y>>w<<w),M=u.X>>w;u.aP(y.posMatrix,0,u.X,0,u.X,0,1),u.J(y.posMatrix,y.posMatrix,[T*M,k*M,0]),u.K(y.posMatrix,y.posMatrix,[1/2**w,1/2**w,0]),l[d]=y}}return l}getSourceTile(n,l){const d=this.sourceCache._source;let f=n.overscaledZ-this.deltaZoom;if(f>d.maxzoom&&(f=d.maxzoom),f<d.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(f).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!y||!y.dem)&&l)for(;f>=d.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(n.scaledTo(f--).key);return y}tilesAfterTime(n=Date.now()){return Object.values(this._tiles).filter(l=>l.timeAdded>=n)}}class zh{constructor(n,l,d){this.painter=n,this.sourceCache=new Iy(l),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,l,d,f=u.X){var y;if(!(l>=0&&l<f&&d>=0&&d<f))return 0;const w=this.getTerrainData(n),T=(y=w.tile)===null||y===void 0?void 0:y.dem;if(!T)return 0;const k=function(K,re,oe){var ue=re[0],he=re[1];return K[0]=oe[0]*ue+oe[4]*he+oe[12],K[1]=oe[1]*ue+oe[5]*he+oe[13],K}([],[l/f*u.X,d/f*u.X],w.u_terrain_matrix),M=[k[0]*T.dim,k[1]*T.dim],L=Math.floor(M[0]),F=Math.floor(M[1]),j=M[0]-L,H=M[1]-F;return T.get(L,F)*(1-j)*(1-H)+T.get(L+1,F)*j*(1-H)+T.get(L,F+1)*(1-j)*H+T.get(L+1,F+1)*j*H}getElevationForLngLatZoom(n,l){if(!u.bb(l,n.wrap()))return 0;const{tileID:d,mercatorX:f,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(n,l);return this.getElevation(d,f%u.X,y%u.X,u.X)}getElevation(n,l,d,f=u.X){return this.getDEMElevation(n,l,d,f)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const f=this.painter.context,y=new u.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Ne(f,y,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ne(f,new u.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.an([])}const l=this.sourceCache.getSourceTile(n,!0);if(l&&l.dem&&(!l.demTexture||l.needsTerrainPrepare)){const f=this.painter.context;l.demTexture=this.painter.getTileTexture(l.dem.stride),l.demTexture?l.demTexture.update(l.dem.getPixels(),{premultiply:!1}):l.demTexture=new Ne(f,l.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),l.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),l.needsTerrainPrepare=!1}const d=l&&l+l.tileID.key+n.key;if(d&&!this._demMatrixCache[d]){const f=this.sourceCache.sourceCache._source.maxzoom;let y=n.canonical.z-l.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=f?y=n.canonical.z-f:u.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=n.canonical.x-(n.canonical.x>>y<<y),T=n.canonical.y-(n.canonical.y>>y<<y),k=u.bc(new Float64Array(16),[1/(u.X<<y),1/(u.X<<y),0]);u.J(k,k,[w*u.X,T*u.X,0]),this._demMatrixCache[n.key]={matrix:k,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:l&&l.dem&&l.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:l&&l.dem&&l.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(l&&l.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:l}}getFramebuffer(n){const l=this.painter,d=l.width/devicePixelRatio,f=l.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ne(l.context,{width:d,height:f,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ne(l.context,{width:d,height:f,data:null},l.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(l.context.gl.NEAREST,l.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=l.context.createFramebuffer(d,f,!0,!1),this._fbo.depthAttachment.set(l.context.createRenderbuffer(l.context.gl.DEPTH_COMPONENT16,d,f))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const l=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,w=0;y<this._coordsTextureSize;y++)for(let T=0;T<this._coordsTextureSize;T++,w+=4)l[w+0]=255&T,l[w+1]=255&y,l[w+2]=T>>8<<4|y>>8,l[w+3]=0;const d=new u.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(l.buffer)),f=new Ne(n,d,n.gl.RGBA,{premultiply:!1});return f.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);const l=new Uint8Array(4),d=this.painter.context,f=d.gl,y=Math.round(n.x*this.painter.pixelRatio/devicePixelRatio),w=Math.round(n.y*this.painter.pixelRatio/devicePixelRatio),T=Math.round(this.painter.height/devicePixelRatio);d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(y,T-w-1,1,1,f.RGBA,f.UNSIGNED_BYTE,l),d.bindFramebuffer.set(null);const k=l[0]+(l[2]>>4<<8),M=l[1]+((15&l[2])<<8),L=this.coordsIndex[255-l[3]],F=L&&this.sourceCache.getTileByID(L);if(!F)return null;const j=this._coordsTextureSize,H=(1<<F.tileID.canonical.z)*j;return new u.Z((F.tileID.canonical.x*j+k)/H+F.tileID.wrap,(F.tileID.canonical.y*j+M)/H,this.getElevation(F.tileID,k,M,j))}depthAtPoint(n){const l=new Uint8Array(4),d=this.painter.context,f=d.gl;return d.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,l),d.bindFramebuffer.set(null),(l[0]/16777216+l[1]/65536+l[2]/256+l[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const n=this.painter.context,l=new u.bd,d=new u.aY,f=this.meshSize,y=u.X/f,w=f*f;for(let F=0;F<=f;F++)for(let j=0;j<=f;j++)l.emplaceBack(j*y,F*y,0);for(let F=0;F<w;F+=f+1)for(let j=0;j<f;j++)d.emplaceBack(j+F,f+j+F+1,f+j+F+2),d.emplaceBack(j+F,f+j+F+2,j+F+1);const T=l.length,k=T+2*(f+1);for(const F of[0,1])for(let j=0;j<=f;j++)for(const H of[0,1])l.emplaceBack(j*y,F*u.X,H);for(let F=0;F<2*f;F+=2)d.emplaceBack(k+F,k+F+1,k+F+3),d.emplaceBack(k+F,k+F+3,k+F+2),d.emplaceBack(T+F,T+F+3,T+F+1),d.emplaceBack(T+F,T+F+2,T+F+3);const M=l.length,L=M+2*(f+1);for(const F of[0,1])for(let j=0;j<=f;j++)for(const H of[0,1])l.emplaceBack(F*u.X,j*y,H);for(let F=0;F<2*f;F+=2)d.emplaceBack(M+F,M+F+1,M+F+3),d.emplaceBack(M+F,M+F+3,M+F+2),d.emplaceBack(L+F,L+F+3,L+F+1),d.emplaceBack(L+F,L+F+2,L+F+3);return this._mesh=new gu(n.createVertexBuffer(l,Ah.members),n.createIndexBuffer(d),u.a0.simpleSegment(0,0,l.length,d.length)),this._mesh}getMeshFrameDelta(n){return 2*Math.PI*u.be/Math.pow(2,n)/5}getMinTileElevationForLngLatZoom(n,l){var d;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(n,l);return(d=this.getMinMaxElevation(f).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(n){const l=this.getTerrainData(n).tile,d={minElevation:null,maxElevation:null};return l&&l.dem&&(d.minElevation=l.dem.min*this.exaggeration,d.maxElevation=l.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(n,l){const d=u.Z.fromLngLat(n.wrap()),f=(1<<l)*u.X,y=d.x*f,w=d.y*f,T=Math.floor(y/u.X),k=Math.floor(w/u.X);return{tileID:new u.S(l,0,l,T,k),mercatorX:y,mercatorY:w}}}class My{constructor(n,l,d){this._context=n,this._size=l,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const l=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new Ne(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),l.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),l.colorAttachment.set(d.texture),{id:n,fbo:l,texture:d,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(l=>n.id!==l),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const l of this._recentlyUsed)if(!this._objects[l].inUse)return this._objects[l];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(n=>!n.inUse)===!1}}const ca={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class sp{constructor(n,l){this.painter=n,this.terrain=l,this.pool=new My(n.context,30,l.sourceCache.tileSize*l.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,l){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter(d=>!n._layers[d].isHidden(l)),this._coordsDescendingInv={};for(const d in n.sourceCaches){this._coordsDescendingInv[d]={};const f=n.sourceCaches[d].getVisibleCoordinates();for(const y of f){const w=this.terrain.sourceCache.getTerrainCoords(y);for(const T in w)this._coordsDescendingInv[d][T]||(this._coordsDescendingInv[d][T]=[]),this._coordsDescendingInv[d][T].push(w[T])}}this._coordsDescendingInvStr={};for(const d of n._order){const f=n._layers[d],y=f.source;if(ca[f.type]&&!this._coordsDescendingInvStr[y]){this._coordsDescendingInvStr[y]={};for(const w in this._coordsDescendingInv[y])this._coordsDescendingInvStr[y][w]=this._coordsDescendingInv[y][w].map(T=>T.key).sort().join()}}for(const d of this._renderableTiles)for(const f in this._coordsDescendingInvStr){const y=this._coordsDescendingInvStr[f][d.tileID.key];y&&y!==d.rttCoords[f]&&(d.rtt=[])}}renderLayer(n){if(n.isHidden(this.painter.transform.zoom))return!1;const l=n.type,d=this.painter,f=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(ca[l]&&(this._prevType&&ca[this._prevType]||this._stacks.push([]),this._prevType=l,this._stacks[this._stacks.length-1].push(n.id),!f))return!0;if(ca[this._prevType]||ca[l]&&f){this._prevType=l;const y=this._stacks.length-1,w=this._stacks[y]||[];for(const T of this._renderableTiles){if(this.pool.isFull()&&(Yf(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[y]){const M=this.pool.getObjectForId(T.rtt[y].id);if(M.stamp===T.rtt[y].stamp){this.pool.useObject(M);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),T.rtt[y]={id:k.id,stamp:k.stamp},d.context.bindFramebuffer.set(k.fbo.framebuffer),d.context.clear({color:u.aM.transparent,stencil:0}),d.currentStencilSource=void 0;for(let M=0;M<w.length;M++){const L=d.style._layers[w[M]],F=L.source?this._coordsDescendingInv[L.source][T.tileID.key]:[T.tileID];d.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),d._renderTileClippingMasks(L,F),d.renderLayer(d,d.style.sourceCaches[L.source],L,F),L.source&&(T.rttCoords[L.source]=this._coordsDescendingInvStr[L.source][T.tileID.key])}}return Yf(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ca[l]}return!1}}const Dh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},op=C,Ay={hash:!1,interactive:!0,bearingSnap:7,attributionControl:la,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Rh=_=>{_.touchstart=_.dragStart,_.touchmoveWindow=_.dragMove,_.touchend=_.dragEnd},zy={showCompass:!0,showZoom:!0,visualizePitch:!1};class Dy{constructor(n,l,d=!1){this.mousedown=w=>{this.startMouse(u.e({},w,{ctrlKey:!0,preventDefault:()=>w.preventDefault()}),A.mousePos(this.element,w)),A.addEventListener(window,"mousemove",this.mousemove),A.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.moveMouse(w,A.mousePos(this.element,w))},this.mouseup=w=>{this.mouseRotate.dragEnd(w),this.mousePitch&&this.mousePitch.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,w.targetTouches)[0],this.startTouch(w,this._startPos),A.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=A.touchPos(this.element,w.targetTouches)[0],this.moveTouch(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const f=n.dragRotate._mouseRotate.getClickTolerance(),y=n.dragRotate._mousePitch.getClickTolerance();this.element=l,this.mouseRotate=bh({clickTolerance:f,enable:!0}),this.touchRotate=(({enable:w,clickTolerance:T,bearingDegreesPerPixelMoved:k=.8})=>{const M=new xh;return new Ts({clickTolerance:T,move:(L,F)=>({bearingDelta:(F.x-L.x)*k}),moveStateManager:M,enable:w,assignEvents:Rh})})({clickTolerance:f,enable:!0}),this.map=n,d&&(this.mousePitch=wh({clickTolerance:y,enable:!0}),this.touchPitch=(({enable:w,clickTolerance:T,pitchDegreesPerPixelMoved:k=-.5})=>{const M=new xh;return new Ts({clickTolerance:T,move:(L,F)=>({pitchDelta:(F.y-L.y)*k}),moveStateManager:M,enable:w,assignEvents:Rh})})({clickTolerance:y,enable:!0})),A.addEventListener(l,"mousedown",this.mousedown),A.addEventListener(l,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(l,"touchcancel",this.reset)}startMouse(n,l){this.mouseRotate.dragStart(n,l),this.mousePitch&&this.mousePitch.dragStart(n,l),A.disableDrag()}startTouch(n,l){this.touchRotate.dragStart(n,l),this.touchPitch&&this.touchPitch.dragStart(n,l),A.disableDrag()}moveMouse(n,l){const d=this.map,{bearingDelta:f}=this.mouseRotate.dragMove(n,l)||{};if(f&&d.setBearing(d.getBearing()+f),this.mousePitch){const{pitchDelta:y}=this.mousePitch.dragMove(n,l)||{};y&&d.setPitch(d.getPitch()+y)}}moveTouch(n,l){const d=this.map,{bearingDelta:f}=this.touchRotate.dragMove(n,l)||{};if(f&&d.setBearing(d.getBearing()+f),this.touchPitch){const{pitchDelta:y}=this.touchPitch.dragMove(n,l)||{};y&&d.setPitch(d.getPitch()+y)}}off(){const n=this.element;A.removeEventListener(n,"mousedown",this.mousedown),A.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend),A.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){A.enableDrag(),A.removeEventListener(window,"mousemove",this.mousemove),A.removeEventListener(window,"mouseup",this.mouseup),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend)}}let Kr;function un(_,n,l){const d=new u.N(_.lng,_.lat);if(_=new u.N(_.lng,_.lat),n){const f=new u.N(_.lng-360,_.lat),y=new u.N(_.lng+360,_.lat),w=l.locationPoint(_).distSqr(n);l.locationPoint(f).distSqr(n)<w?_=f:l.locationPoint(y).distSqr(n)<w&&(_=y)}for(;Math.abs(_.lng-l.center.lng)>180;){const f=l.locationPoint(_);if(f.x>=0&&f.y>=0&&f.x<=l.width&&f.y<=l.height)break;_.lng>l.center.lng?_.lng-=360:_.lng+=360}return _.lng!==d.lng&&l.locationPoint(_).y>l.height/2-l.getHorizon()?_:d}const ha={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Pu(_,n,l){const d=_.classList;for(const f in ha)d.remove(`maplibregl-${l}-anchor-${f}`);d.add(`maplibregl-${l}-anchor-${n}`)}class Eu extends u.E{constructor(n){if(super(),this._onKeyPress=l=>{const d=l.code,f=l.charCode||l.keyCode;d!=="Space"&&d!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=l=>{const d=l.originalEvent.target,f=this._element;this._popup&&(d===f||f.contains(d))&&this.togglePopup()},this._update=l=>{var d;if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();((l==null?void 0:l.type)==="terrain"||(l==null?void 0:l.type)==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?un(this._lngLat,this._flatPos,this._map.transform):(d=this._lngLat)===null||d===void 0?void 0:d.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||l&&l.type!=="moveend"||(this._pos=this._pos.round()),A.setTransform(this._element,`${ha[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${y}`),z.frameAsync(new AbortController).then(()=>{this._updateOpacity(l&&l.type==="moveend")}).catch(()=>{})},this._onMove=l=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.k("dragstart"))),this.fire(new u.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.k("dragend")),this._state="inactive"},this._addDragHandler=l=>{this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._subpixelPositioning=n&&n.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(n==null?void 0:n.opacity,n==null?void 0:n.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=u.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div");const l=A.createNS("http://www.w3.org/2000/svg","svg"),d=41,f=27;l.setAttributeNS(null,"display","block"),l.setAttributeNS(null,"height",`${d}px`),l.setAttributeNS(null,"width",`${f}px`),l.setAttributeNS(null,"viewBox",`0 0 ${f} ${d}`);const y=A.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const w=A.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");const T=A.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ue of k){const he=A.createNS("http://www.w3.org/2000/svg","ellipse");he.setAttributeNS(null,"opacity","0.04"),he.setAttributeNS(null,"cx","10.5"),he.setAttributeNS(null,"cy","5.80029008"),he.setAttributeNS(null,"rx",ue.rx),he.setAttributeNS(null,"ry",ue.ry),T.appendChild(he)}const M=A.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"fill",this._color);const L=A.createNS("http://www.w3.org/2000/svg","path");L.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),M.appendChild(L);const F=A.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"opacity","0.25"),F.setAttributeNS(null,"fill","#000000");const j=A.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),F.appendChild(j);const H=A.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const K=A.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"transform","translate(8.0, 8.0)");const re=A.createNS("http://www.w3.org/2000/svg","circle");re.setAttributeNS(null,"fill","#000000"),re.setAttributeNS(null,"opacity","0.25"),re.setAttributeNS(null,"cx","5.5"),re.setAttributeNS(null,"cy","5.5"),re.setAttributeNS(null,"r","5.4999962");const oe=A.createNS("http://www.w3.org/2000/svg","circle");oe.setAttributeNS(null,"fill","#FFFFFF"),oe.setAttributeNS(null,"cx","5.5"),oe.setAttributeNS(null,"cy","5.5"),oe.setAttributeNS(null,"r","5.4999962"),K.appendChild(re),K.appendChild(oe),w.appendChild(T),w.appendChild(M),w.appendChild(F),w.appendChild(H),w.appendChild(K),l.appendChild(w),l.setAttributeNS(null,"height",d*this._scale+"px"),l.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(l),this._offset=u.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",l=>{l.preventDefault()}),this._element.addEventListener("mousedown",l=>{l.preventDefault()}),Pu(this._element,this._anchor,"marker"),n&&n.className)for(const l of n.className.split(" "))this._element.classList.add(l);this._popup=null}addTo(n){return this.remove(),this._map=n,this._element.setAttribute("aria-label",n._getUIString("Marker.Title")),n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=u.N.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const f=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(n){return this._subpixelPositioning=n,this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var l,d;if(!(!((l=this._map)===null||l===void 0)&&l.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const f=this._map,y=f.terrain.depthAtPoint(this._pos),w=f.terrain.getElevationForLngLatZoom(this._lngLat,f.transform.tileZoom);if(f.transform.lngLatToCameraDepth(this._lngLat,w)-y<.006)return void(this._element.style.opacity=this._opacity);const T=-this._offset.y/f.transform._pixelPerMeter,k=Math.sin(f.getPitch()*Math.PI/180)*T,M=f.terrain.depthAtPoint(new u.P(this._pos.x,this._pos.y-this._offset.y)),L=f.transform.lngLatToCameraDepth(this._lngLat,w+k)-M>.006;!((d=this._popup)===null||d===void 0)&&d.isOpen()&&L&&this._popup.remove(),this._element.style.opacity=L?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=u.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,l){return n===void 0&&l===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),l!==void 0&&(this._opacityWhenCovered=l),this._map&&this._updateOpacity(!0),this}}const ap={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let pl=0,ml=!1;const ns={maxWidth:100,unit:"metric"};function gl(_,n,l){const d=l&&l.maxWidth||100,f=_._container.clientHeight/2,y=_.unproject([0,f]),w=_.unproject([d,f]),T=y.distanceTo(w);if(l&&l.unit==="imperial"){const k=3.2808*T;k>5280?ot(n,d,k/5280,_._getUIString("ScaleControl.Miles")):ot(n,d,k,_._getUIString("ScaleControl.Feet"))}else l&&l.unit==="nautical"?ot(n,d,T/1852,_._getUIString("ScaleControl.NauticalMiles")):T>=1e3?ot(n,d,T/1e3,_._getUIString("ScaleControl.Kilometers")):ot(n,d,T,_._getUIString("ScaleControl.Meters"))}function ot(_,n,l,d){const f=function(y){const w=Math.pow(10,`${Math.floor(y)}`.length-1);let T=y/w;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(k){const M=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*M)/M}(T),w*T}(l);_.style.width=n*(f/l)+"px",_.innerHTML=`${f}&nbsp;${d}`}const yt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Iu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Mu(_){if(_){if(typeof _=="number"){const n=Math.round(Math.abs(_)/Math.SQRT2);return{center:new u.P(0,0),top:new u.P(0,_),"top-left":new u.P(n,n),"top-right":new u.P(-n,n),bottom:new u.P(0,-_),"bottom-left":new u.P(n,-n),"bottom-right":new u.P(-n,-n),left:new u.P(_,0),right:new u.P(-_,0)}}if(_ instanceof u.P||Array.isArray(_)){const n=u.P.convert(_);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:u.P.convert(_.center||[0,0]),top:u.P.convert(_.top||[0,0]),"top-left":u.P.convert(_["top-left"]||[0,0]),"top-right":u.P.convert(_["top-right"]||[0,0]),bottom:u.P.convert(_.bottom||[0,0]),"bottom-left":u.P.convert(_["bottom-left"]||[0,0]),"bottom-right":u.P.convert(_["bottom-right"]||[0,0]),left:u.P.convert(_.left||[0,0]),right:u.P.convert(_.right||[0,0])}}return Mu(new u.P(0,0))}const Lh=C;m.AJAXError=u.bh,m.Evented=u.E,m.LngLat=u.N,m.MercatorCoordinate=u.Z,m.Point=u.P,m.addProtocol=u.bi,m.config=u.a,m.removeProtocol=u.bj,m.AttributionControl=ua,m.BoxZoomHandler=Xr,m.CanvasSource=ai,m.CooperativeGesturesHandler=aa,m.DoubleClickZoomHandler=xo,m.DragPanHandler=np,m.DragRotateHandler=rp,m.EdgeInsets=ia,m.FullscreenControl=class extends u.E{constructor(_={}){super(),this._onFullscreenChange=()=>{var n;let l=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((n=l==null?void 0:l.shadowRoot)===null||n===void 0)&&n.fullscreenElement;)l=l.shadowRoot.fullscreenElement;l===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:u.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){A.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const _=this._fullscreenButton=A.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);A.create("span","maplibregl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new u.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},m.GeoJSONSource=ao,m.GeolocateControl=class extends u.E{constructor(_){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new u.k("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.k("geolocate",n)),this._finish()}},this._updateCamera=n=>{const l=new u.N(n.coords.longitude,n.coords.latitude),d=n.coords.accuracy,f=this._map.getBearing(),y=u.e({bearing:f},this.options.fitBoundsOptions),w=ke.fromLngLat(l,d);this._map.fitBounds(w,y,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const l=new u.N(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=n=>{if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&ml)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.k("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=A.create("button","maplibregl-ctrl-geolocate",this._container),A.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=n=>{if(this._map){if(n===!1){u.w("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Eu({element:this._dotElement}),this._circleElement=A.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Eu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.k("trackuserlocationend")),this.fire(new u.k("userlocationlostfocus")))})}},this.options=u.e({},ap,_)}onAdd(_){return this._map=_,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return u._(this,arguments,void 0,function*(n=!1){if(Kr!==void 0&&!n)return Kr;if(window.navigator.permissions===void 0)return Kr=!!window.navigator.geolocation,Kr;try{Kr=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Kr=!!window.navigator.geolocation}return Kr})}().then(n=>this._finishSetupUI(n)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,pl=0,ml=!1}_isOutOfMapMaxBounds(_){const n=this._map.getMaxBounds(),l=_.coords;return n&&(l.longitude<n.getWest()||l.longitude>n.getEast()||l.latitude<n.getSouth()||l.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const _=this._map.getBounds(),n=_.getSouthEast(),l=_.getNorthEast(),d=n.distanceTo(l),f=Math.ceil(this._accuracy/(d/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return u.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":pl--,ml=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.k("trackuserlocationstart")),this.fire(new u.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),pl++,pl>1?(_={maximumAge:6e5,timeout:0},ml=!0):(_=this.options.positionOptions,ml=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},m.Hash=_u,m.ImageSource=bs,m.KeyboardHandler=ci,m.LngLatBounds=ke,m.LogoControl=Mh,m.Map=class extends ip{constructor(_){u.bf.mark(u.bg.create);const n=Object.assign(Object.assign({},Ay),_);if(n.minZoom!=null&&n.maxZoom!=null&&n.minZoom>n.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(n.minPitch!=null&&n.maxPitch!=null&&n.minPitch>n.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(n.minPitch!=null&&n.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(n.maxPitch!=null&&n.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new sa(n.minZoom,n.maxZoom,n.minPitch,n.maxPitch,n.renderWorldCopies),{bearingSnap:n.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Lt,this._controls=[],this._mapId=u.a4(),this._contextLost=l=>{l.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new u.k("webglcontextlost",{originalEvent:l}))},this._contextRestored=l=>{this._setupPainter(),this.resize(),this._update(),this.fire(new u.k("webglcontextrestored",{originalEvent:l}))},this._onMapScroll=l=>{if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=n.interactive,this._maxTileCacheSize=n.maxTileCacheSize,this._maxTileCacheZoomLevels=n.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=n.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=n.preserveDrawingBuffer===!0,this._antialias=n.antialias===!0,this._trackResize=n.trackResize===!0,this._bearingSnap=n.bearingSnap,this._refreshExpiredTiles=n.refreshExpiredTiles===!0,this._fadeDuration=n.fadeDuration,this._crossSourceCollisions=n.crossSourceCollisions===!0,this._collectResourceTiming=n.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Dh),n.locale),this._clickTolerance=n.clickTolerance,this._overridePixelRatio=n.pixelRatio,this._maxCanvasSize=n.maxCanvasSize,this.transformCameraUpdate=n.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=n.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=X.addThrottleControl(()=>this.isMoving()),this._requestManager=new ae(n.transformRequest),typeof n.container=="string"){if(this._container=document.getElementById(n.container),!this._container)throw new Error(`Container '${n.container}' not found.`)}else{if(!(n.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=n.container}if(n.maxBounds&&this.setMaxBounds(n.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let l=!1;const d=ll(f=>{this._trackResize&&!this._removed&&(this.resize(f),this.redraw())},50);this._resizeObserver=new ResizeObserver(f=>{l?d(f):l=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ih(this,n),this._hash=n.hash&&new _u(typeof n.hash=="string"&&n.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),n.bounds&&(this.resize(),this.fitBounds(n.bounds,u.e({},n.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=n.localIdeographFontFamily,this._validateStyle=n.validateStyle,n.style&&this.setStyle(n.style,{localIdeographFontFamily:n.localIdeographFontFamily}),n.attributionControl&&this.addControl(new ua(typeof n.attributionControl=="boolean"?void 0:n.attributionControl)),n.maplibreLogo&&this.addControl(new Mh,n.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new u.k(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new u.k(`${l.dataType}dataloading`,l))}),this.on("dataabort",l=>{this.fire(new u.k("sourcedataabort",l))})}_getMapId(){return this._mapId}addControl(_,n){if(n===void 0&&(n=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new u.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=_.onAdd(this);this._controls.push(_);const d=this._controlPositions[n];return n.indexOf("bottom")!==-1?d.insertBefore(l,d.firstChild):d.appendChild(l),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new u.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(_);return n>-1&&this._controls.splice(n,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}calculateCameraOptionsFromTo(_,n,l,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(_,n,l,d)}resize(_){var n;const l=this._containerDimensions(),d=l[0],f=l[1],y=this._getClampedPixelRatio(d,f);if(this._resizeCanvas(d,f,y),this.painter.resize(d,f,y),this.painter.overLimit()){const T=this.painter.context.gl;this._maxCanvasSize=[T.drawingBufferWidth,T.drawingBufferHeight];const k=this._getClampedPixelRatio(d,f);this._resizeCanvas(d,f,k),this.painter.resize(d,f,k)}this.transform.resize(d,f),(n=this._requestedCameraState)===null||n===void 0||n.resize(d,f);const w=!this._moving;return w&&(this.stop(),this.fire(new u.k("movestart",_)).fire(new u.k("move",_))),this.fire(new u.k("resize",_)),w&&this.fire(new u.k("moveend",_)),this}_getClampedPixelRatio(_,n){const{0:l,1:d}=this._maxCanvasSize,f=this.getPixelRatio(),y=_*f,w=n*f;return Math.min(y>l?l/y:1,w>d?d/w:1)*f}getPixelRatio(){var _;return(_=this._overridePixelRatio)!==null&&_!==void 0?_:devicePixelRatio}setPixelRatio(_){this._overridePixelRatio=_,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(_){return this.transform.setMaxBounds(ke.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_&&this.setZoom(_),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_&&this.setZoom(_),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_&&this.setPitch(_),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_&&this.setPitch(_),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this._update()}project(_){return this.transform.locationPoint(u.N.convert(_),this.style&&this.terrain)}unproject(_){return this.transform.pointLocation(u.P.convert(_),this.terrain)}isMoving(){var _;return this._moving||((_=this.handlers)===null||_===void 0?void 0:_.isMoving())}isZooming(){var _;return this._zooming||((_=this.handlers)===null||_===void 0?void 0:_.isZooming())}isRotating(){var _;return this._rotating||((_=this.handlers)===null||_===void 0?void 0:_.isRotating())}_createDelegatedListener(_,n,l){if(_==="mouseenter"||_==="mouseover"){let d=!1;return{layers:n,listener:l,delegates:{mousemove:y=>{const w=n.filter(k=>this.getLayer(k)),T=w.length!==0?this.queryRenderedFeatures(y.point,{layers:w}):[];T.length?d||(d=!0,l.call(this,new or(_,this,y.originalEvent,{features:T}))):d=!1},mouseout:()=>{d=!1}}}}if(_==="mouseleave"||_==="mouseout"){let d=!1;return{layers:n,listener:l,delegates:{mousemove:w=>{const T=n.filter(k=>this.getLayer(k));(T.length!==0?this.queryRenderedFeatures(w.point,{layers:T}):[]).length?d=!0:d&&(d=!1,l.call(this,new or(_,this,w.originalEvent)))},mouseout:w=>{d&&(d=!1,l.call(this,new or(_,this,w.originalEvent)))}}}}{const d=f=>{const y=n.filter(T=>this.getLayer(T)),w=y.length!==0?this.queryRenderedFeatures(f.point,{layers:y}):[];w.length&&(f.features=w,l.call(this,f),delete f.features)};return{layers:n,listener:l,delegates:{[_]:d}}}}_saveDelegatedListener(_,n){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(n)}_removeDelegatedListener(_,n,l){if(!this._delegatedListeners||!this._delegatedListeners[_])return;const d=this._delegatedListeners[_];for(let f=0;f<d.length;f++){const y=d[f];if(y.listener===l&&y.layers.length===n.length&&y.layers.every(w=>n.includes(w))){for(const w in y.delegates)this.off(w,y.delegates[w]);return void d.splice(f,1)}}}on(_,n,l){if(l===void 0)return super.on(_,n);const d=this._createDelegatedListener(_,typeof n=="string"?[n]:n,l);this._saveDelegatedListener(_,d);for(const f in d.delegates)this.on(f,d.delegates[f]);return this}once(_,n,l){if(l===void 0)return super.once(_,n);const d=typeof n=="string"?[n]:n,f=this._createDelegatedListener(_,d,l);for(const y in f.delegates){const w=f.delegates[y];f.delegates[y]=(...T)=>{this._removeDelegatedListener(_,d,l),w(...T)}}this._saveDelegatedListener(_,f);for(const y in f.delegates)this.once(y,f.delegates[y]);return this}off(_,n,l){return l===void 0?super.off(_,n):(this._removeDelegatedListener(_,typeof n=="string"?[n]:n,l),this)}queryRenderedFeatures(_,n){if(!this.style)return[];let l;const d=_ instanceof u.P||Array.isArray(_),f=d?_:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(d?{}:_)||{},f instanceof u.P||typeof f[0]=="number")l=[u.P.convert(f)];else{const y=u.P.convert(f[0]),w=u.P.convert(f[1]);l=[y,new u.P(w.x,y.y),w,new u.P(y.x,w.y),y]}return this.style.queryRenderedFeatures(l,n,this.transform)}querySourceFeatures(_,n){return this.style.querySourceFeatures(_,n)}setStyle(_,n){return(n=u.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&_?(this._diffStyle(_,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(_,n))}setTransformRequest(_){return this._requestManager.setTransformRequest(_),this}_getUIString(_){const n=this._locale[_];if(n==null)throw new Error(`Missing UI string '${_}'`);return n}_updateStyle(_,n){if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(_,n));const l=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!_)),_?(this.style=new tu(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_,n,l):this.style.loadJSON(_,n,l),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new tu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,n){if(typeof _=="string"){const l=this._requestManager.transformRequest(_,"Style");u.h(l,new AbortController).then(d=>{this._updateDiff(d.data,n)}).catch(d=>{d&&this.fire(new u.j(d))})}else typeof _=="object"&&this._updateDiff(_,n)}_updateDiff(_,n){try{this.style.setState(_,n)&&this._update(!0)}catch(l){u.w(`Unable to perform style diff: ${l.message||l.error||l}.  Rebuilding the style from scratch.`),this._updateStyle(_,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.w("There is no style added to the map.")}addSource(_,n){return this._lazyInitEmptyStyle(),this.style.addSource(_,n),this._update(!0)}isSourceLoaded(_){const n=this.style&&this.style.sourceCaches[_];if(n!==void 0)return n.loaded();this.fire(new u.j(new Error(`There is no source with ID '${_}'`)))}setTerrain(_){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),_){const n=this.style.sourceCaches[_.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${_.source}`);this.terrain===null&&n.reload();for(const l in this.style._layers){const d=this.style._layers[l];d.type==="hillshade"&&d.source===_.source&&u.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new zh(this.painter,n,_),this.painter.renderToTexture=new sp(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=l=>{l.dataType==="style"?this.terrain.sourceCache.freeRtt():l.dataType==="source"&&l.tile&&(l.sourceId!==_.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(l.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new u.k("terrain",{terrain:_})),this}getTerrain(){var _,n;return(n=(_=this.terrain)===null||_===void 0?void 0:_.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const _=this.style&&this.style.sourceCaches;for(const n in _){const l=_[n]._tiles;for(const d in l){const f=l[d];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(_){return this.style.removeSource(_),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,n,l={}){const{pixelRatio:d=1,sdf:f=!1,stretchX:y,stretchY:w,content:T,textFitWidth:k,textFitHeight:M}=l;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||u.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:L,height:F,data:j}=n,H=n;return this.style.addImage(_,{data:new u.R({width:L,height:F},new Uint8Array(j)),pixelRatio:d,stretchX:y,stretchY:w,content:T,textFitWidth:k,textFitHeight:M,sdf:f,version:0,userImage:H}),H.onAdd&&H.onAdd(this,_),this}}{const{width:L,height:F,data:j}=z.getImageData(n);this.style.addImage(_,{data:new u.R({width:L,height:F},j),pixelRatio:d,stretchX:y,stretchY:w,content:T,textFitWidth:k,textFitHeight:M,sdf:f,version:0})}}updateImage(_,n){const l=this.style.getImage(_);if(!l)return this.fire(new u.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=n instanceof HTMLImageElement||u.b(n)?z.getImageData(n):n,{width:f,height:y,data:w}=d;if(f===void 0||y===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==l.data.width||y!==l.data.height)return this.fire(new u.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(n instanceof HTMLImageElement||u.b(n));return l.data.replace(w,T),this.style.updateImage(_,l),this}getImage(_){return this.style.getImage(_)}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new u.j(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_){return X.getImage(this._requestManager.transformRequest(_,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(_,n){return this._lazyInitEmptyStyle(),this.style.addLayer(_,n),this._update(!0)}moveLayer(_,n){return this.style.moveLayer(_,n),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(_,n,l){return this.style.setLayerZoomRange(_,n,l),this._update(!0)}setFilter(_,n,l={}){return this.style.setFilter(_,n,l),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,n,l,d={}){return this.style.setPaintProperty(_,n,l,d),this._update(!0)}getPaintProperty(_,n){return this.style.getPaintProperty(_,n)}setLayoutProperty(_,n,l,d={}){return this.style.setLayoutProperty(_,n,l,d),this._update(!0)}getLayoutProperty(_,n){return this.style.getLayoutProperty(_,n)}setGlyphs(_,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(_,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(_,n,l={}){return this._lazyInitEmptyStyle(),this.style.addSprite(_,n,l,d=>{d||this._update(!0)}),this}removeSprite(_){return this._lazyInitEmptyStyle(),this.style.removeSprite(_),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(_,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(_,n,l=>{l||this._update(!0)}),this}setLight(_,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,n),this._update(!0)}getLight(){return this.style.getLight()}setSky(_){return this._lazyInitEmptyStyle(),this.style.setSky(_),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(_,n){return this.style.setFeatureState(_,n),this._update()}removeFeatureState(_,n){return this.style.removeFeatureState(_,n),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let _=0,n=0;return this._container&&(_=this._container.clientWidth||400,n=this._container.clientHeight||300),[_,n]}_setupContainer(){const _=this._container;_.classList.add("maplibregl-map");const n=this._canvasContainer=A.create("div","maplibregl-canvas-container",_);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=A.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const l=this._containerDimensions(),d=this._getClampedPixelRatio(l[0],l[1]);this._resizeCanvas(l[0],l[1],d);const f=this._controlContainer=A.create("div","maplibregl-control-container",_),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{y[w]=A.create("div",`maplibregl-ctrl-${w} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,n,l){this._canvas.width=Math.floor(l*_),this._canvas.height=Math.floor(l*n),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const _={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let n=null;this._canvas.addEventListener("webglcontextcreationerror",d=>{n={requestedAttributes:_},d&&(n.statusMessage=d.statusMessage,n.type=d.type)},{once:!0});const l=this._canvas.getContext("webgl2",_)||this._canvas.getContext("webgl",_);if(!l){const d="Failed to initialize WebGL";throw n?(n.message=d,new Error(JSON.stringify(n))):new Error(d)}this.painter=new yu(l,this.transform),Z.testSupport(l)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_render(_){const n=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._removed)return;let l=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const f=this.transform.zoom,y=z.now();this.style.zoomHistory.update(f,y);const w=new u.z(f,{now:y,fadeDuration:n,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),T=w.crossFadingFactor();T===1&&T===this._crossFadingFactor||(l=!0,this._crossFadingFactor=T),this.style.update(w)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,n,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:n,showPadding:this.showPadding}),this.fire(new u.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.bf.mark(u.bg.load),this.fire(new u.k("load"))),this.style&&(this.style.hasTransitions()||l)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.k("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,u.bf.mark(u.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var _;this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),X.removeThrottleControl(this._imageQueueHandle),(_=this._resizeObserver)===null||_===void 0||_.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n!=null&&n.loseContext&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),A.remove(this._canvasContainer),A.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),u.bf.clearMetrics(),this._removed=!0,this.fire(new u.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,z.frameAsync(this._frameRequest).then(_=>{u.bf.frame(_),this._frameRequest=null,this._render(_)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get version(){return op}getCameraTargetElevation(){return this.transform.elevation}},m.MapMouseEvent=or,m.MapTouchEvent=_o,m.MapWheelEvent=Qf,m.Marker=Eu,m.NavigationControl=class{constructor(_){this._updateZoomButtons=()=>{const n=this._map.getZoom(),l=n===this._map.getMaxZoom(),d=n===this._map.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=n},this._setButtonTitle=(n,l)=>{const d=this._map._getUIString(`NavigationControl.${l}`);n.title=d,n.setAttribute("aria-label",d)},this.options=u.e({},zy,_),this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),A.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),A.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=A.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Dy(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,n){const l=A.create("button",_,this._container);return l.type="button",l.addEventListener("click",n),l}},m.Popup=class extends u.E{constructor(_){super(),this.remove=()=>(this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new u.k("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{var l;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=A.create("div","maplibregl-popup",this._map.getContainer()),this._tip=A.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const T of this.options.className.split(" "))this._container.classList.add(T);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?un(this._lngLat,this._flatPos,this._map.transform):(l=this._lngLat)===null||l===void 0?void 0:l.wrap(),this._trackPointer&&!n)return;const d=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationPoint(this._lngLat));let f=this.options.anchor;const y=Mu(this.options.offset);if(!f){const T=this._container.offsetWidth,k=this._container.offsetHeight;let M;M=d.y+y.bottom.y<k?["top"]:d.y>this._map.transform.height-k?["bottom"]:[],d.x<T/2?M.push("left"):d.x>this._map.transform.width-T/2&&M.push("right"),f=M.length===0?"bottom":M.join("-")}let w=d.add(y[f]);this.options.subpixelPositioning||(w=w.round()),A.setTransform(this._container,`${ha[f]} translate(${w.x}px,${w.y}px)`),Pu(this._container,f,"popup")},this._onClose=()=>{this.remove()},this.options=u.e(Object.create(yt),_)}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=u.N.convert(_),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const n=document.createDocumentFragment(),l=document.createElement("body");let d;for(l.innerHTML=_;d=l.firstChild,d;)n.appendChild(d);return this.setDOMContent(n)}getMaxWidth(){var _;return(_=this._container)===null||_===void 0?void 0:_.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){return this._container&&this._container.classList.add(_),this}removeClassName(_){return this._container&&this._container.classList.remove(_),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){if(this._container)return this._container.classList.toggle(_)}setSubpixelPositioning(_){this.options.subpixelPositioning=_}_createCloseButton(){this.options.closeButton&&(this._closeButton=A.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(Iu);_&&_.focus()}},m.RasterDEMTileSource=ln,m.RasterTileSource=Ot,m.ScaleControl=class{constructor(_){this._onMove=()=>{gl(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,gl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ns),_)}getDefaultPosition(){return"bottom-left"}onAdd(_){return this._map=_,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},m.ScrollZoomHandler=Ai,m.Style=tu,m.TerrainControl=class{constructor(_){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=_}onAdd(_){return this._map=_,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=A.create("button","maplibregl-ctrl-terrain",this._container),A.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){A.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},m.TwoFingersTouchPitchHandler=fl,m.TwoFingersTouchRotateHandler=kh,m.TwoFingersTouchZoomHandler=Th,m.TwoFingersTouchZoomRotateHandler=Eh,m.VectorTileSource=Ci,m.VideoSource=Go,m.addSourceType=(_,n)=>u._(void 0,void 0,void 0,function*(){if(Ya(_))throw new Error(`A source type called "${_}" already exists.`);((l,d)=>{Ka[l]=d})(_,n)}),m.clearPrewarmedResources=function(){const _=Dn;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(qn),Dn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},m.getMaxParallelImageRequests=function(){return u.a.MAX_PARALLEL_IMAGE_REQUESTS},m.getRTLTextPluginStatus=function(){return Yi().getRTLTextPluginStatus()},m.getVersion=function(){return Lh},m.getWorkerCount=function(){return ir.workerCount},m.getWorkerUrl=function(){return u.a.WORKER_URL},m.importScriptInWorkers=function(_){return oo().broadcast("IS",_)},m.prewarm=function(){vs().acquire(qn)},m.setMaxParallelImageRequests=function(_){u.a.MAX_PARALLEL_IMAGE_REQUESTS=_},m.setRTLTextPlugin=function(_,n){return Yi().setRTLTextPlugin(_,n)},m.setWorkerCount=function(_){ir.workerCount=_},m.setWorkerUrl=function(_){u.a.WORKER_URL=_}});var p=i;return p})})(VE);var Bl=VE.exports;const _F=UT(Bl),vF=$T({__proto__:null,default:_F},[Bl]),xF={width:"100%",background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:8,padding:"8px 10px",color:"#0f172a",fontSize:13,outline:"none",boxSizing:"border-box"},bF={position:"fixed",background:"#fff",border:"1px solid #e2e8f0",borderRadius:8,overflow:"hidden",zIndex:9999,boxShadow:"0 4px 16px rgba(0,0,0,0.1)"},wF={padding:"9px 12px",fontSize:12,color:"#1e293b",cursor:"pointer"};function aT({label:e,value:t,options:i,onInput:a,onSelect:h}){const[p,m]=le.useState((t==null?void 0:t.name)??""),[u,C]=le.useState(!1),[E,D]=le.useState(null),[z,A]=le.useState(null),Z=le.useRef(null),Y=le.useRef(null);le.useEffect(()=>{m((t==null?void 0:t.name)??"")},[t]),le.useEffect(()=>{const U=G=>{Z.current&&!Z.current.contains(G.target)&&C(!1)};return document.addEventListener("mousedown",U),()=>document.removeEventListener("mousedown",U)},[]);const te=()=>{Y.current&&A(Y.current.getBoundingClientRect())},pe=u&&i.length>0&&z&&xg.createPortal(De.jsx("div",{style:{...bF,top:z.bottom+4,left:z.left,width:z.width},children:i.map((U,G)=>De.jsx("div",{style:{...wF,background:E===G?"#f1f5f9":"transparent"},onMouseEnter:()=>D(G),onMouseLeave:()=>D(null),onMouseDown:()=>{h(U),m(U.name),C(!1)},children:U.name},U.id))}),document.body);return De.jsxs("div",{ref:Z,children:[De.jsx("div",{style:{fontSize:10,color:"#94a3b8",fontWeight:600,letterSpacing:"0.06em",textTransform:"uppercase",marginBottom:5},children:e}),De.jsx("input",{ref:Y,style:xF,value:p,placeholder:`Choose ${e.toLowerCase()}...`,onChange:U=>{m(U.target.value),a(U.target.value),te(),C(!0),U.target.value||h(null)},onFocus:()=>{te(),i.length>0&&C(!0)}}),pe]})}function SF(){return De.jsx("span",{style:{display:"inline-block",width:13,height:13,border:"2px solid rgba(255,255,255,0.35)",borderTopColor:"#fff",borderRadius:"50%",animation:"spin 0.7s linear infinite",verticalAlign:"middle",marginRight:6}})}function TF({onRoutes:e,targetMiles:t,polygon:i}){const{current:a}=gf(),[h,p]=le.useState(null),[m,u]=le.useState(null),[C,E]=le.useState([]),[D,z]=le.useState([]),[A,Z]=le.useState(!1),[Y,te]=le.useState(!1),[pe,U]=le.useState(null),G=le.useRef(null),X=le.useRef(null),ae=le.useRef(null),_e=le.useRef(null),ye=le.useCallback((Be,Ue,Ne)=>{Ne.current&&clearTimeout(Ne.current),Ne.current=setTimeout(async()=>{Ue(await FR(Be))},250)},[]);le.useEffect(()=>{var Ue,Ne;if(!a)return;const Be=a.getMap();if((Ue=ae.current)==null||Ue.remove(),(Ne=_e.current)==null||Ne.remove(),ae.current=null,_e.current=null,A)h!=null&&h.coordinates&&(ae.current=new Bl.Marker({color:"#2563eb"}).setLngLat(h.coordinates).addTo(Be),a.flyTo({center:h.coordinates,zoom:13}));else if(h!=null&&h.coordinates&&(ae.current=new Bl.Marker({color:"#2563eb"}).setLngLat(h.coordinates).addTo(Be)),m!=null&&m.coordinates&&(_e.current=new Bl.Marker({color:"#1e40af"}).setLngLat(m.coordinates).addTo(Be)),h!=null&&h.coordinates&&(m!=null&&m.coordinates)&&(h.coordinates[0]!==m.coordinates[0]||h.coordinates[1]!==m.coordinates[1])){const J=new Bl.LngLatBounds(h.coordinates,h.coordinates);J.extend(m.coordinates),a.fitBounds(J,{padding:80,duration:800})}else h!=null&&h.coordinates?a.flyTo({center:h.coordinates,zoom:13}):m!=null&&m.coordinates&&a.flyTo({center:m.coordinates,zoom:13})},[h,m,A,a]),le.useEffect(()=>()=>{var Be,Ue;(Be=ae.current)==null||Be.remove(),(Ue=_e.current)==null||Ue.remove()},[]);const Se=A?!!h:!!(h&&m),Ie=async()=>{if(!h)return;te(!0),U(null),e([]);let Be=[];A?Be=await DR(h.coordinates,t,i):m&&(Be=await RR(h.coordinates,m.coordinates)),Be.length>0?e(Be):U("No route found. Try different locations."),te(!1)};return De.jsxs(De.Fragment,{children:[De.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),De.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[De.jsx(aT,{label:"Start",value:h,options:C,onInput:Be=>ye(Be,E,G),onSelect:Be=>{p(Be),e([]),U(null)}}),De.jsx(JP,{children:!A&&De.jsx(z0.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.18},children:De.jsx(aT,{label:"End",value:m,options:D,onInput:Be=>ye(Be,z,X),onSelect:Be=>{u(Be),e([]),U(null)}})},"end")}),De.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:2},children:[De.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer",userSelect:"none",flex:1},children:[De.jsx("div",{onClick:()=>{Z(Be=>!Be),e([]),U(null)},style:{width:32,height:18,borderRadius:9,background:A?"#3b82f6":"#e2e8f0",position:"relative",transition:"background 0.2s",flexShrink:0},children:De.jsx("div",{style:{position:"absolute",top:2,left:A?16:2,width:14,height:14,borderRadius:"50%",background:"#fff",transition:"left 0.2s",boxShadow:"0 1px 3px rgba(0,0,0,0.2)"}})}),De.jsx("span",{style:{fontSize:12,color:"#64748b"},children:"Loop"})]}),De.jsxs("button",{onClick:Ie,disabled:!Se||Y,style:{flex:2,display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 0",borderRadius:8,border:"none",background:Se&&!Y||Y?"#3b82f6":"#f1f5f9",color:Se||Y?"#fff":"#94a3b8",fontSize:13,fontWeight:600,cursor:Se&&!Y?"pointer":"default",transition:"background 0.2s, color 0.2s"},children:[Y&&De.jsx(SF,{}),Y?"Finding routes":"Get Route"]})]}),pe&&De.jsx("div",{style:{fontSize:11,color:"#dc2626",marginTop:-4},children:pe})]})]})}const Pl="route-line",lT="route-line-casing",uT="route-line-layer",cT="route-line-arrows",hv="route-arrow";function CF(e){const t=document.createElement("canvas");t.width=e,t.height=e;const i=t.getContext("2d");i.clearRect(0,0,e,e);const a=e/2,h=e*.82,p=e*.28;return i.beginPath(),i.moveTo(h,a),i.lineTo(a-e*.05,a-p),i.lineTo(a-e*.05,a+p),i.closePath(),i.fillStyle="rgba(255,255,255,0.92)",i.fill(),i.getImageData(0,0,e,e)}function kF({route:e}){var h;const t=gf(),i=(h=t==null?void 0:t.current)==null?void 0:h.getMap(),a=le.useRef(!1);return le.useEffect(()=>{if(!i)return;const p={type:"Feature",properties:{},geometry:{type:"LineString",coordinates:e?e.coordinates:[]}},m=()=>{i.hasImage(hv)||i.addImage(hv,CF(32),{pixelRatio:2}),i.getSource(Pl)?i.getSource(Pl).setData(p):a.current=!1,a.current||(i.getSource(Pl)||i.addSource(Pl,{type:"geojson",data:p,lineMetrics:!0}),i.getLayer(lT)||i.addLayer({id:lT,type:"line",source:Pl,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#1e40af","line-width":7,"line-opacity":.25}}),i.getLayer(uT)||i.addLayer({id:uT,type:"line",source:Pl,layout:{"line-join":"round","line-cap":"round"},paint:{"line-gradient":["interpolate",["linear"],["line-progress"],0,"#93c5fd",.5,"#3b82f6",1,"#1e3a8a"],"line-width":4}}),i.getLayer(cT)||i.addLayer({id:cT,type:"symbol",source:Pl,layout:{"symbol-placement":"line","symbol-spacing":100,"icon-image":hv,"icon-size":.55,"icon-allow-overlap":!0,"icon-ignore-placement":!0}}),a.current=!0)};if(i.isStyleLoaded())m();else{const u=()=>{m(),i.off("styledata",u)};i.on("styledata",u)}},[i,e]),null}function PF(e){const t=[0];for(let i=1;i<e.length;i++){const[a,h]=e[i-1],[p,m]=e[i],u=(p-a)*Math.cos((h+m)*.5*(Math.PI/180))*111320,C=(m-h)*111320;t.push(t[i-1]+Math.sqrt(u*u+C*C))}return{cumulative:t,total:t[t.length-1]}}function EF(e,t,i,a){if(e.length===0)return[0,0];if(a<=0)return e[0];if(a>=1)return e[e.length-1];const h=a*i;let p=0,m=t.length-1;for(;p<m-1;){const Z=p+m>>1;t[Z]<=h?p=Z:m=Z}const u=t[m]-t[p],C=u===0?0:(h-t[p])/u,[E,D]=e[p],[z,A]=e[m];return[E+(z-E)*C,D+(A-D)*C]}function IF(){const e=document.createElement("div");return e.style.cssText=`
    width: 14px; height: 14px; border-radius: 50%;
    background: #2563eb; border: 2.5px solid #fff;
    box-shadow: 0 2px 8px rgba(0,0,0,0.5);
    pointer-events: none;
  `,e}function MF({route:e}){const{current:t}=gf(),[i,a]=le.useState(0),h=le.useRef(null),p=le.useRef(null);le.useEffect(()=>{p.current=PF(e.coordinates),a(0)},[e]),le.useEffect(()=>{if(!t)return;const A=t.getMap(),Z=IF(),Y=new Bl.Marker({element:Z,anchor:"center"});return e.coordinates.length>0&&Y.setLngLat(e.coordinates[0]).addTo(A),h.current=Y,()=>{Y.remove(),h.current=null}},[t,e]),le.useEffect(()=>{if(!h.current||!p.current||e.coordinates.length===0)return;const{cumulative:A,total:Z}=p.current,Y=EF(e.coordinates,A,Z,i);h.current.setLngLat(Y)},[i,e]);const m=i*e.distanceMiles,u=i*e.durationMinutes,C=Math.round(u),E=Math.floor(C/60),D=C%60,z=E>0?`${E}h ${D}m`:`${C}m`;return De.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[De.jsxs("div",{style:{position:"relative",height:20,display:"flex",alignItems:"center"},children:[De.jsx("div",{style:{position:"absolute",left:0,right:0,height:3,borderRadius:2,background:"#e2e8f0"}}),De.jsx("div",{style:{position:"absolute",left:0,height:3,borderRadius:2,background:"#3b82f6",width:`${i*100}%`,transition:"width 0.05s"}}),De.jsx("input",{type:"range",min:0,max:1e3,value:Math.round(i*1e3),onChange:A=>a(Number(A.target.value)/1e3),style:{position:"absolute",left:0,right:0,width:"100%",opacity:0,cursor:"pointer",margin:0,height:20}}),De.jsx("div",{style:{position:"absolute",left:`calc(${i*100}% - 6px)`,width:12,height:12,borderRadius:"50%",background:"#3b82f6",border:"2px solid #fff",boxShadow:"0 1px 4px rgba(0,0,0,0.4)",pointerEvents:"none",transition:"left 0.05s"}})]}),De.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[De.jsxs("span",{style:{fontSize:11,color:"#64748b"},children:[m.toFixed(2)," ",De.jsxs("span",{style:{color:"#94a3b8"},children:["/ ",e.distanceMiles.toFixed(2)," mi"]})]}),De.jsxs("span",{style:{fontSize:11,color:"#64748b"},children:[z," ",De.jsx("span",{style:{color:"#94a3b8"},children:"elapsed"})]})]})]})}const hT=e=>e,AF=()=>{let e=hT;return{configure(t){e=t},generate(t){return e(t)},reset(){e=hT}}},zF=AF();function Kl(e,...t){const i=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach(a=>i.searchParams.append("args[]",a)),`Minified MUI error #${e}; visit ${i} for the full message.`}function $r(e){if(typeof e!="string")throw new Error(Kl(7));return e.charAt(0).toUpperCase()+e.slice(1)}function jE(e){var t,i,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var h=e.length;for(t=0;t<h;t++)e[t]&&(i=jE(e[t]))&&(a&&(a+=" "),a+=i)}else for(i in e)e[i]&&(a&&(a+=" "),a+=i);return a}function gi(){for(var e,t,i=0,a="",h=arguments.length;i<h;i++)(e=arguments[i])&&(t=jE(e))&&(a&&(a+=" "),a+=t);return a}function Cg(e,t,i=void 0){const a={};for(const h in e){const p=e[h];let m="",u=!0;for(let C=0;C<p.length;C+=1){const E=p[C];E&&(m+=(u===!0?"":" ")+t(E),u=!1,i&&i[E]&&(m+=" "+i[E]))}a[h]=m}return a}var $E={exports:{}},mn={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x1=Symbol.for("react.transitional.element"),b1=Symbol.for("react.portal"),kg=Symbol.for("react.fragment"),Pg=Symbol.for("react.strict_mode"),Eg=Symbol.for("react.profiler"),Ig=Symbol.for("react.consumer"),Mg=Symbol.for("react.context"),Ag=Symbol.for("react.forward_ref"),zg=Symbol.for("react.suspense"),Dg=Symbol.for("react.suspense_list"),Rg=Symbol.for("react.memo"),Lg=Symbol.for("react.lazy"),DF=Symbol.for("react.view_transition"),RF=Symbol.for("react.client.reference");function ys(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case x1:switch(e=e.type,e){case kg:case Eg:case Pg:case zg:case Dg:case DF:return e;default:switch(e=e&&e.$$typeof,e){case Mg:case Ag:case Lg:case Rg:return e;case Ig:return e;default:return t}}case b1:return t}}}mn.ContextConsumer=Ig;mn.ContextProvider=Mg;mn.Element=x1;mn.ForwardRef=Ag;mn.Fragment=kg;mn.Lazy=Lg;mn.Memo=Rg;mn.Portal=b1;mn.Profiler=Eg;mn.StrictMode=Pg;mn.Suspense=zg;mn.SuspenseList=Dg;mn.isContextConsumer=function(e){return ys(e)===Ig};mn.isContextProvider=function(e){return ys(e)===Mg};mn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===x1};mn.isForwardRef=function(e){return ys(e)===Ag};mn.isFragment=function(e){return ys(e)===kg};mn.isLazy=function(e){return ys(e)===Lg};mn.isMemo=function(e){return ys(e)===Rg};mn.isPortal=function(e){return ys(e)===b1};mn.isProfiler=function(e){return ys(e)===Eg};mn.isStrictMode=function(e){return ys(e)===Pg};mn.isSuspense=function(e){return ys(e)===zg};mn.isSuspenseList=function(e){return ys(e)===Dg};mn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===kg||e===Eg||e===Pg||e===zg||e===Dg||typeof e=="object"&&e!==null&&(e.$$typeof===Lg||e.$$typeof===Rg||e.$$typeof===Mg||e.$$typeof===Ig||e.$$typeof===Ag||e.$$typeof===RF||e.getModuleId!==void 0)};mn.typeOf=ys;$E.exports=mn;var UE=$E.exports;function Mo(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function GE(e){if(le.isValidElement(e)||UE.isValidElementType(e)||!Mo(e))return e;const t={};return Object.keys(e).forEach(i=>{t[i]=GE(e[i])}),t}function Ui(e,t,i={clone:!0}){const a=i.clone?{...e}:e;return Mo(e)&&Mo(t)&&Object.keys(t).forEach(h=>{le.isValidElement(t[h])||UE.isValidElementType(t[h])?a[h]=t[h]:Mo(t[h])&&Object.prototype.hasOwnProperty.call(e,h)&&Mo(e[h])?a[h]=Ui(e[h],t[h],i):i.clone?a[h]=Mo(t[h])?GE(t[h]):t[h]:a[h]=t[h]}),a}function Ld(e,t){return t?Ui(e,t,{clone:!1}):e}function dT(e,t){if(!e.containerQueries)return t;const i=Object.keys(t).filter(a=>a.startsWith("@container")).sort((a,h)=>{var m,u;const p=/min-width:\s*([0-9.]+)/;return+(((m=a.match(p))==null?void 0:m[1])||0)-+(((u=h.match(p))==null?void 0:u[1])||0)});return i.length?i.reduce((a,h)=>{const p=t[h];return delete a[h],a[h]=p,a},{...t}):t}function LF(e,t){return t==="@"||t.startsWith("@")&&(e.some(i=>t.startsWith(`@${i}`))||!!t.match(/^@\d/))}function FF(e,t){const i=t.match(/^@([^/]+)?\/?(.+)?$/);if(!i)return null;const[,a,h]=i,p=Number.isNaN(+a)?a||0:+a;return e.containerQueries(h).up(p)}function BF(e){const t=(p,m)=>p.replace("@media",m?`@container ${m}`:"@container");function i(p,m){p.up=(...u)=>t(e.breakpoints.up(...u),m),p.down=(...u)=>t(e.breakpoints.down(...u),m),p.between=(...u)=>t(e.breakpoints.between(...u),m),p.only=(...u)=>t(e.breakpoints.only(...u),m),p.not=(...u)=>{const C=t(e.breakpoints.not(...u),m);return C.includes("not all and")?C.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):C}}const a={},h=p=>(i(a,p),a);return i(h),{...e,containerQueries:h}}const Fg={xs:0,sm:600,md:900,lg:1200,xl:1536},fT={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${Fg[e]}px)`},OF={containerQueries:e=>({up:t=>{let i=typeof t=="number"?t:Fg[t]||t;return typeof i=="number"&&(i=`${i}px`),e?`@container ${e} (min-width:${i})`:`@container (min-width:${i})`}})};function No(e,t,i){const a=e.theme||{};if(Array.isArray(t)){const p=a.breakpoints||fT;return t.reduce((m,u,C)=>(m[p.up(p.keys[C])]=i(t[C]),m),{})}if(typeof t=="object"){const p=a.breakpoints||fT;return Object.keys(t).reduce((m,u)=>{if(LF(p.keys,u)){const C=FF(a.containerQueries?a:OF,u);C&&(m[C]=i(t[u],u))}else if(Object.keys(p.values||Fg).includes(u)){const C=p.up(u);m[C]=i(t[u],u)}else{const C=u;m[C]=t[C]}return m},{})}return i(t)}function VF(e={}){var i;return((i=e.keys)==null?void 0:i.reduce((a,h)=>{const p=e.up(h);return a[p]={},a},{}))||{}}function pT(e,t){return e.reduce((i,a)=>{const h=i[a];return(!h||Object.keys(h).length===0)&&delete i[a],i},t)}function Bg(e,t,i=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&i){const a=`vars.${t}`.split(".").reduce((h,p)=>h&&h[p]?h[p]:null,e);if(a!=null)return a}return t.split(".").reduce((a,h)=>a&&a[h]!=null?a[h]:null,e)}function Qm(e,t,i,a=i){let h;return typeof e=="function"?h=e(i):Array.isArray(e)?h=e[i]||a:h=Bg(e,i)||a,t&&(h=t(h,a,e)),h}function Gn(e){const{prop:t,cssProperty:i=e.prop,themeKey:a,transform:h}=e,p=m=>{if(m[t]==null)return null;const u=m[t],C=m.theme,E=Bg(C,a)||{};return No(m,u,z=>{let A=Qm(E,h,z);return z===A&&typeof z=="string"&&(A=Qm(E,h,`${t}${z==="default"?"":$r(z)}`,z)),i===!1?A:{[i]:A}})};return p.propTypes={},p.filterProps=[t],p}function NF(e){const t={};return i=>(t[i]===void 0&&(t[i]=e(i)),t[i])}const jF={m:"margin",p:"padding"},$F={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},mT={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},UF=NF(e=>{if(e.length>2)if(mT[e])e=mT[e];else return[e];const[t,i]=e.split(""),a=jF[t],h=$F[i]||"";return Array.isArray(h)?h.map(p=>a+p):[a+h]}),w1=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],S1=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...w1,...S1];function wf(e,t,i,a){const h=Bg(e,t,!0)??i;return typeof h=="number"||typeof h=="string"?p=>typeof p=="string"?p:typeof h=="string"?h.startsWith("var(")&&p===0?0:h.startsWith("var(")&&p===1?h:`calc(${p} * ${h})`:h*p:Array.isArray(h)?p=>{if(typeof p=="string")return p;const m=Math.abs(p),u=h[m];return p>=0?u:typeof u=="number"?-u:typeof u=="string"&&u.startsWith("var(")?`calc(-1 * ${u})`:`-${u}`}:typeof h=="function"?h:()=>{}}function T1(e){return wf(e,"spacing",8)}function Sf(e,t){return typeof t=="string"||t==null?t:e(t)}function GF(e,t){return i=>e.reduce((a,h)=>(a[h]=Sf(t,i),a),{})}function qF(e,t,i,a){if(!t.includes(i))return null;const h=UF(i),p=GF(h,a),m=e[i];return No(e,m,p)}function qE(e,t){const i=T1(e.theme);return Object.keys(e).map(a=>qF(e,t,a,i)).reduce(Ld,{})}function Bn(e){return qE(e,w1)}Bn.propTypes={};Bn.filterProps=w1;function On(e){return qE(e,S1)}On.propTypes={};On.filterProps=S1;function Og(...e){const t=e.reduce((a,h)=>(h.filterProps.forEach(p=>{a[p]=h}),a),{}),i=a=>Object.keys(a).reduce((h,p)=>t[p]?Ld(h,t[p](a)):h,{});return i.propTypes={},i.filterProps=e.reduce((a,h)=>a.concat(h.filterProps),[]),i}function hs(e){return typeof e!="number"?e:`${e}px solid`}function _s(e,t){return Gn({prop:e,themeKey:"borders",transform:t})}const ZF=_s("border",hs),WF=_s("borderTop",hs),HF=_s("borderRight",hs),XF=_s("borderBottom",hs),KF=_s("borderLeft",hs),YF=_s("borderColor"),JF=_s("borderTopColor"),QF=_s("borderRightColor"),eB=_s("borderBottomColor"),tB=_s("borderLeftColor"),nB=_s("outline",hs),rB=_s("outlineColor"),Vg=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=wf(e.theme,"shape.borderRadius",4),i=a=>({borderRadius:Sf(t,a)});return No(e,e.borderRadius,i)}return null};Vg.propTypes={};Vg.filterProps=["borderRadius"];Og(ZF,WF,HF,XF,KF,YF,JF,QF,eB,tB,Vg,nB,rB);const Ng=e=>{if(e.gap!==void 0&&e.gap!==null){const t=wf(e.theme,"spacing",8),i=a=>({gap:Sf(t,a)});return No(e,e.gap,i)}return null};Ng.propTypes={};Ng.filterProps=["gap"];const jg=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=wf(e.theme,"spacing",8),i=a=>({columnGap:Sf(t,a)});return No(e,e.columnGap,i)}return null};jg.propTypes={};jg.filterProps=["columnGap"];const $g=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=wf(e.theme,"spacing",8),i=a=>({rowGap:Sf(t,a)});return No(e,e.rowGap,i)}return null};$g.propTypes={};$g.filterProps=["rowGap"];const iB=Gn({prop:"gridColumn"}),sB=Gn({prop:"gridRow"}),oB=Gn({prop:"gridAutoFlow"}),aB=Gn({prop:"gridAutoColumns"}),lB=Gn({prop:"gridAutoRows"}),uB=Gn({prop:"gridTemplateColumns"}),cB=Gn({prop:"gridTemplateRows"}),hB=Gn({prop:"gridTemplateAreas"}),dB=Gn({prop:"gridArea"});Og(Ng,jg,$g,iB,sB,oB,aB,lB,uB,cB,hB,dB);function kc(e,t){return t==="grey"?t:e}const fB=Gn({prop:"color",themeKey:"palette",transform:kc}),pB=Gn({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:kc}),mB=Gn({prop:"backgroundColor",themeKey:"palette",transform:kc});Og(fB,pB,mB);function Ni(e){return e<=1&&e!==0?`${e*100}%`:e}const gB=Gn({prop:"width",transform:Ni}),C1=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=i=>{var h,p,m,u,C;const a=((m=(p=(h=e.theme)==null?void 0:h.breakpoints)==null?void 0:p.values)==null?void 0:m[i])||Fg[i];return a?((C=(u=e.theme)==null?void 0:u.breakpoints)==null?void 0:C.unit)!=="px"?{maxWidth:`${a}${e.theme.breakpoints.unit}`}:{maxWidth:a}:{maxWidth:Ni(i)}};return No(e,e.maxWidth,t)}return null};C1.filterProps=["maxWidth"];const yB=Gn({prop:"minWidth",transform:Ni}),_B=Gn({prop:"height",transform:Ni}),vB=Gn({prop:"maxHeight",transform:Ni}),xB=Gn({prop:"minHeight",transform:Ni});Gn({prop:"size",cssProperty:"width",transform:Ni});Gn({prop:"size",cssProperty:"height",transform:Ni});const bB=Gn({prop:"boxSizing"});Og(gB,C1,yB,_B,vB,xB,bB);const Ug={border:{themeKey:"borders",transform:hs},borderTop:{themeKey:"borders",transform:hs},borderRight:{themeKey:"borders",transform:hs},borderBottom:{themeKey:"borders",transform:hs},borderLeft:{themeKey:"borders",transform:hs},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:hs},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Vg},color:{themeKey:"palette",transform:kc},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:kc},backgroundColor:{themeKey:"palette",transform:kc},p:{style:On},pt:{style:On},pr:{style:On},pb:{style:On},pl:{style:On},px:{style:On},py:{style:On},padding:{style:On},paddingTop:{style:On},paddingRight:{style:On},paddingBottom:{style:On},paddingLeft:{style:On},paddingX:{style:On},paddingY:{style:On},paddingInline:{style:On},paddingInlineStart:{style:On},paddingInlineEnd:{style:On},paddingBlock:{style:On},paddingBlockStart:{style:On},paddingBlockEnd:{style:On},m:{style:Bn},mt:{style:Bn},mr:{style:Bn},mb:{style:Bn},ml:{style:Bn},mx:{style:Bn},my:{style:Bn},margin:{style:Bn},marginTop:{style:Bn},marginRight:{style:Bn},marginBottom:{style:Bn},marginLeft:{style:Bn},marginX:{style:Bn},marginY:{style:Bn},marginInline:{style:Bn},marginInlineStart:{style:Bn},marginInlineEnd:{style:Bn},marginBlock:{style:Bn},marginBlockStart:{style:Bn},marginBlockEnd:{style:Bn},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Ng},rowGap:{style:$g},columnGap:{style:jg},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Ni},maxWidth:{style:C1},minWidth:{transform:Ni},height:{transform:Ni},maxHeight:{transform:Ni},minHeight:{transform:Ni},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function wB(...e){const t=e.reduce((a,h)=>a.concat(Object.keys(h)),[]),i=new Set(t);return e.every(a=>i.size===Object.keys(a).length)}function SB(e,t){return typeof e=="function"?e(t):e}function TB(){function e(i,a,h,p){const m={[i]:a,theme:h},u=p[i];if(!u)return{[i]:a};const{cssProperty:C=i,themeKey:E,transform:D,style:z}=u;if(a==null)return null;if(E==="typography"&&a==="inherit")return{[i]:a};const A=Bg(h,E)||{};return z?z(m):No(m,a,Y=>{let te=Qm(A,D,Y);return Y===te&&typeof Y=="string"&&(te=Qm(A,D,`${i}${Y==="default"?"":$r(Y)}`,Y)),C===!1?te:{[C]:te}})}function t(i){const{sx:a,theme:h={},nested:p}=i||{};if(!a)return null;const m=h.unstable_sxConfig??Ug;function u(C){let E=C;if(typeof C=="function")E=C(h);else if(typeof C!="object")return C;if(!E)return null;const D=VF(h.breakpoints),z=Object.keys(D);let A=D;return Object.keys(E).forEach(Z=>{const Y=SB(E[Z],h);if(Y!=null)if(typeof Y=="object")if(m[Z])A=Ld(A,e(Z,Y,h,m));else{const te=No({theme:h},Y,pe=>({[Z]:pe}));wB(te,Y)?A[Z]=t({sx:Y,theme:h,nested:!0}):A=Ld(A,te)}else A=Ld(A,e(Z,Y,h,m))}),!p&&h.modularCssLayers?{"@layer sx":dT(h,pT(z,A))}:dT(h,pT(z,A))}return Array.isArray(a)?a.map(u):u(a)}return t}const Oc=TB();Oc.filterProps=["sx"];function eg(){return eg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)({}).hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},eg.apply(null,arguments)}function CB(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function kB(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var PB=function(){function e(i){var a=this;this._insertTag=function(h){var p;a.tags.length===0?a.insertionPoint?p=a.insertionPoint.nextSibling:a.prepend?p=a.container.firstChild:p=a.before:p=a.tags[a.tags.length-1].nextSibling,a.container.insertBefore(h,p),a.tags.push(h)},this.isSpeedy=i.speedy===void 0?!0:i.speedy,this.tags=[],this.ctr=0,this.nonce=i.nonce,this.key=i.key,this.container=i.container,this.prepend=i.prepend,this.insertionPoint=i.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(a){a.forEach(this._insertTag)},t.insert=function(a){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(kB(this));var h=this.tags[this.tags.length-1];if(this.isSpeedy){var p=CB(h);try{p.insertRule(a,p.cssRules.length)}catch{}}else h.appendChild(document.createTextNode(a));this.ctr++},t.flush=function(){this.tags.forEach(function(a){var h;return(h=a.parentNode)==null?void 0:h.removeChild(a)}),this.tags=[],this.ctr=0},e}(),Vr="-ms-",tg="-moz-",Jt="-webkit-",ZE="comm",k1="rule",P1="decl",EB="@import",WE="@keyframes",IB="@layer",MB=Math.abs,Gg=String.fromCharCode,AB=Object.assign;function zB(e,t){return Cr(e,0)^45?(((t<<2^Cr(e,0))<<2^Cr(e,1))<<2^Cr(e,2))<<2^Cr(e,3):0}function HE(e){return e.trim()}function DB(e,t){return(e=t.exec(e))?e[0]:e}function Qt(e,t,i){return e.replace(t,i)}function D0(e,t){return e.indexOf(t)}function Cr(e,t){return e.charCodeAt(t)|0}function of(e,t,i){return e.slice(t,i)}function Ys(e){return e.length}function E1(e){return e.length}function Jp(e,t){return t.push(e),e}function RB(e,t){return e.map(t).join("")}var qg=1,Vc=1,XE=0,Si=0,Yn=0,Zc="";function Zg(e,t,i,a,h,p,m){return{value:e,root:t,parent:i,type:a,props:h,children:p,line:qg,column:Vc,length:m,return:""}}function dd(e,t){return AB(Zg("",null,null,"",null,null,0),e,{length:-e.length},t)}function LB(){return Yn}function FB(){return Yn=Si>0?Cr(Zc,--Si):0,Vc--,Yn===10&&(Vc=1,qg--),Yn}function Gi(){return Yn=Si<XE?Cr(Zc,Si++):0,Vc++,Yn===10&&(Vc=1,qg++),Yn}function so(){return Cr(Zc,Si)}function ym(){return Si}function Tf(e,t){return of(Zc,e,t)}function af(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function KE(e){return qg=Vc=1,XE=Ys(Zc=e),Si=0,[]}function YE(e){return Zc="",e}function _m(e){return HE(Tf(Si-1,R0(e===91?e+2:e===40?e+1:e)))}function BB(e){for(;(Yn=so())&&Yn<33;)Gi();return af(e)>2||af(Yn)>3?"":" "}function OB(e,t){for(;--t&&Gi()&&!(Yn<48||Yn>102||Yn>57&&Yn<65||Yn>70&&Yn<97););return Tf(e,ym()+(t<6&&so()==32&&Gi()==32))}function R0(e){for(;Gi();)switch(Yn){case e:return Si;case 34:case 39:e!==34&&e!==39&&R0(Yn);break;case 40:e===41&&R0(e);break;case 92:Gi();break}return Si}function VB(e,t){for(;Gi()&&e+Yn!==57;)if(e+Yn===84&&so()===47)break;return"/*"+Tf(t,Si-1)+"*"+Gg(e===47?e:Gi())}function NB(e){for(;!af(so());)Gi();return Tf(e,Si)}function jB(e){return YE(vm("",null,null,null,[""],e=KE(e),0,[0],e))}function vm(e,t,i,a,h,p,m,u,C){for(var E=0,D=0,z=m,A=0,Z=0,Y=0,te=1,pe=1,U=1,G=0,X="",ae=h,_e=p,ye=a,Se=X;pe;)switch(Y=G,G=Gi()){case 40:if(Y!=108&&Cr(Se,z-1)==58){D0(Se+=Qt(_m(G),"&","&\f"),"&\f")!=-1&&(U=-1);break}case 34:case 39:case 91:Se+=_m(G);break;case 9:case 10:case 13:case 32:Se+=BB(Y);break;case 92:Se+=OB(ym()-1,7);continue;case 47:switch(so()){case 42:case 47:Jp($B(VB(Gi(),ym()),t,i),C);break;default:Se+="/"}break;case 123*te:u[E++]=Ys(Se)*U;case 125*te:case 59:case 0:switch(G){case 0:case 125:pe=0;case 59+D:U==-1&&(Se=Qt(Se,/\f/g,"")),Z>0&&Ys(Se)-z&&Jp(Z>32?yT(Se+";",a,i,z-1):yT(Qt(Se," ","")+";",a,i,z-2),C);break;case 59:Se+=";";default:if(Jp(ye=gT(Se,t,i,E,D,h,u,X,ae=[],_e=[],z),p),G===123)if(D===0)vm(Se,t,ye,ye,ae,p,z,u,_e);else switch(A===99&&Cr(Se,3)===110?100:A){case 100:case 108:case 109:case 115:vm(e,ye,ye,a&&Jp(gT(e,ye,ye,0,0,h,u,X,h,ae=[],z),_e),h,_e,z,u,a?ae:_e);break;default:vm(Se,ye,ye,ye,[""],_e,0,u,_e)}}E=D=Z=0,te=U=1,X=Se="",z=m;break;case 58:z=1+Ys(Se),Z=Y;default:if(te<1){if(G==123)--te;else if(G==125&&te++==0&&FB()==125)continue}switch(Se+=Gg(G),G*te){case 38:U=D>0?1:(Se+="\f",-1);break;case 44:u[E++]=(Ys(Se)-1)*U,U=1;break;case 64:so()===45&&(Se+=_m(Gi())),A=so(),D=z=Ys(X=Se+=NB(ym())),G++;break;case 45:Y===45&&Ys(Se)==2&&(te=0)}}return p}function gT(e,t,i,a,h,p,m,u,C,E,D){for(var z=h-1,A=h===0?p:[""],Z=E1(A),Y=0,te=0,pe=0;Y<a;++Y)for(var U=0,G=of(e,z+1,z=MB(te=m[Y])),X=e;U<Z;++U)(X=HE(te>0?A[U]+" "+G:Qt(G,/&\f/g,A[U])))&&(C[pe++]=X);return Zg(e,t,i,h===0?k1:u,C,E,D)}function $B(e,t,i){return Zg(e,t,i,ZE,Gg(LB()),of(e,2,-2),0)}function yT(e,t,i,a){return Zg(e,t,i,P1,of(e,0,a),of(e,a+1,-1),a)}function Pc(e,t){for(var i="",a=E1(e),h=0;h<a;h++)i+=t(e[h],h,e,t)||"";return i}function UB(e,t,i,a){switch(e.type){case IB:if(e.children.length)break;case EB:case P1:return e.return=e.return||e.value;case ZE:return"";case WE:return e.return=e.value+"{"+Pc(e.children,a)+"}";case k1:e.value=e.props.join(",")}return Ys(i=Pc(e.children,a))?e.return=e.value+"{"+i+"}":""}function GB(e){var t=E1(e);return function(i,a,h,p){for(var m="",u=0;u<t;u++)m+=e[u](i,a,h,p)||"";return m}}function qB(e){return function(t){t.root||(t=t.return)&&e(t)}}function JE(e){var t=Object.create(null);return function(i){return t[i]===void 0&&(t[i]=e(i)),t[i]}}var ZB=function(t,i,a){for(var h=0,p=0;h=p,p=so(),h===38&&p===12&&(i[a]=1),!af(p);)Gi();return Tf(t,Si)},WB=function(t,i){var a=-1,h=44;do switch(af(h)){case 0:h===38&&so()===12&&(i[a]=1),t[a]+=ZB(Si-1,i,a);break;case 2:t[a]+=_m(h);break;case 4:if(h===44){t[++a]=so()===58?"&\f":"",i[a]=t[a].length;break}default:t[a]+=Gg(h)}while(h=Gi());return t},HB=function(t,i){return YE(WB(KE(t),i))},_T=new WeakMap,XB=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var i=t.value,a=t.parent,h=t.column===a.column&&t.line===a.line;a.type!=="rule";)if(a=a.parent,!a)return;if(!(t.props.length===1&&i.charCodeAt(0)!==58&&!_T.get(a))&&!h){_T.set(t,!0);for(var p=[],m=HB(i,p),u=a.props,C=0,E=0;C<m.length;C++)for(var D=0;D<u.length;D++,E++)t.props[E]=p[C]?m[C].replace(/&\f/g,u[D]):u[D]+" "+m[C]}}},KB=function(t){if(t.type==="decl"){var i=t.value;i.charCodeAt(0)===108&&i.charCodeAt(2)===98&&(t.return="",t.value="")}};function QE(e,t){switch(zB(e,t)){case 5103:return Jt+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Jt+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Jt+e+tg+e+Vr+e+e;case 6828:case 4268:return Jt+e+Vr+e+e;case 6165:return Jt+e+Vr+"flex-"+e+e;case 5187:return Jt+e+Qt(e,/(\w+).+(:[^]+)/,Jt+"box-$1$2"+Vr+"flex-$1$2")+e;case 5443:return Jt+e+Vr+"flex-item-"+Qt(e,/flex-|-self/,"")+e;case 4675:return Jt+e+Vr+"flex-line-pack"+Qt(e,/align-content|flex-|-self/,"")+e;case 5548:return Jt+e+Vr+Qt(e,"shrink","negative")+e;case 5292:return Jt+e+Vr+Qt(e,"basis","preferred-size")+e;case 6060:return Jt+"box-"+Qt(e,"-grow","")+Jt+e+Vr+Qt(e,"grow","positive")+e;case 4554:return Jt+Qt(e,/([^-])(transform)/g,"$1"+Jt+"$2")+e;case 6187:return Qt(Qt(Qt(e,/(zoom-|grab)/,Jt+"$1"),/(image-set)/,Jt+"$1"),e,"")+e;case 5495:case 3959:return Qt(e,/(image-set\([^]*)/,Jt+"$1$`$1");case 4968:return Qt(Qt(e,/(.+:)(flex-)?(.*)/,Jt+"box-pack:$3"+Vr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Jt+e+e;case 4095:case 3583:case 4068:case 2532:return Qt(e,/(.+)-inline(.+)/,Jt+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ys(e)-1-t>6)switch(Cr(e,t+1)){case 109:if(Cr(e,t+4)!==45)break;case 102:return Qt(e,/(.+:)(.+)-([^]+)/,"$1"+Jt+"$2-$3$1"+tg+(Cr(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~D0(e,"stretch")?QE(Qt(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Cr(e,t+1)!==115)break;case 6444:switch(Cr(e,Ys(e)-3-(~D0(e,"!important")&&10))){case 107:return Qt(e,":",":"+Jt)+e;case 101:return Qt(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Jt+(Cr(e,14)===45?"inline-":"")+"box$3$1"+Jt+"$2$3$1"+Vr+"$2box$3")+e}break;case 5936:switch(Cr(e,t+11)){case 114:return Jt+e+Vr+Qt(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Jt+e+Vr+Qt(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Jt+e+Vr+Qt(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Jt+e+Vr+e+e}return e}var YB=function(t,i,a,h){if(t.length>-1&&!t.return)switch(t.type){case P1:t.return=QE(t.value,t.length);break;case WE:return Pc([dd(t,{value:Qt(t.value,"@","@"+Jt)})],h);case k1:if(t.length)return RB(t.props,function(p){switch(DB(p,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Pc([dd(t,{props:[Qt(p,/:(read-\w+)/,":"+tg+"$1")]})],h);case"::placeholder":return Pc([dd(t,{props:[Qt(p,/:(plac\w+)/,":"+Jt+"input-$1")]}),dd(t,{props:[Qt(p,/:(plac\w+)/,":"+tg+"$1")]}),dd(t,{props:[Qt(p,/:(plac\w+)/,Vr+"input-$1")]})],h)}return""})}},JB=[YB],QB=function(t){var i=t.key;if(i==="css"){var a=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(a,function(te){var pe=te.getAttribute("data-emotion");pe.indexOf(" ")!==-1&&(document.head.appendChild(te),te.setAttribute("data-s",""))})}var h=t.stylisPlugins||JB,p={},m,u=[];m=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+i+' "]'),function(te){for(var pe=te.getAttribute("data-emotion").split(" "),U=1;U<pe.length;U++)p[pe[U]]=!0;u.push(te)});var C,E=[XB,KB];{var D,z=[UB,qB(function(te){D.insert(te)})],A=GB(E.concat(h,z)),Z=function(pe){return Pc(jB(pe),A)};C=function(pe,U,G,X){D=G,Z(pe?pe+"{"+U.styles+"}":U.styles),X&&(Y.inserted[U.name]=!0)}}var Y={key:i,sheet:new PB({key:i,container:m,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:p,registered:{},insert:C};return Y.sheet.hydrate(u),Y},eI={exports:{}},an={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gr=typeof Symbol=="function"&&Symbol.for,I1=gr?Symbol.for("react.element"):60103,M1=gr?Symbol.for("react.portal"):60106,Wg=gr?Symbol.for("react.fragment"):60107,Hg=gr?Symbol.for("react.strict_mode"):60108,Xg=gr?Symbol.for("react.profiler"):60114,Kg=gr?Symbol.for("react.provider"):60109,Yg=gr?Symbol.for("react.context"):60110,A1=gr?Symbol.for("react.async_mode"):60111,Jg=gr?Symbol.for("react.concurrent_mode"):60111,Qg=gr?Symbol.for("react.forward_ref"):60112,ey=gr?Symbol.for("react.suspense"):60113,eO=gr?Symbol.for("react.suspense_list"):60120,ty=gr?Symbol.for("react.memo"):60115,ny=gr?Symbol.for("react.lazy"):60116,tO=gr?Symbol.for("react.block"):60121,nO=gr?Symbol.for("react.fundamental"):60117,rO=gr?Symbol.for("react.responder"):60118,iO=gr?Symbol.for("react.scope"):60119;function Hi(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case I1:switch(e=e.type,e){case A1:case Jg:case Wg:case Xg:case Hg:case ey:return e;default:switch(e=e&&e.$$typeof,e){case Yg:case Qg:case ny:case ty:case Kg:return e;default:return t}}case M1:return t}}}function tI(e){return Hi(e)===Jg}an.AsyncMode=A1;an.ConcurrentMode=Jg;an.ContextConsumer=Yg;an.ContextProvider=Kg;an.Element=I1;an.ForwardRef=Qg;an.Fragment=Wg;an.Lazy=ny;an.Memo=ty;an.Portal=M1;an.Profiler=Xg;an.StrictMode=Hg;an.Suspense=ey;an.isAsyncMode=function(e){return tI(e)||Hi(e)===A1};an.isConcurrentMode=tI;an.isContextConsumer=function(e){return Hi(e)===Yg};an.isContextProvider=function(e){return Hi(e)===Kg};an.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===I1};an.isForwardRef=function(e){return Hi(e)===Qg};an.isFragment=function(e){return Hi(e)===Wg};an.isLazy=function(e){return Hi(e)===ny};an.isMemo=function(e){return Hi(e)===ty};an.isPortal=function(e){return Hi(e)===M1};an.isProfiler=function(e){return Hi(e)===Xg};an.isStrictMode=function(e){return Hi(e)===Hg};an.isSuspense=function(e){return Hi(e)===ey};an.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Wg||e===Jg||e===Xg||e===Hg||e===ey||e===eO||typeof e=="object"&&e!==null&&(e.$$typeof===ny||e.$$typeof===ty||e.$$typeof===Kg||e.$$typeof===Yg||e.$$typeof===Qg||e.$$typeof===nO||e.$$typeof===rO||e.$$typeof===iO||e.$$typeof===tO)};an.typeOf=Hi;eI.exports=an;var sO=eI.exports,nI=sO,oO={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},aO={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},rI={};rI[nI.ForwardRef]=oO;rI[nI.Memo]=aO;var lO=!0;function iI(e,t,i){var a="";return i.split(" ").forEach(function(h){e[h]!==void 0?t.push(e[h]+";"):h&&(a+=h+" ")}),a}var z1=function(t,i,a){var h=t.key+"-"+i.name;(a===!1||lO===!1)&&t.registered[h]===void 0&&(t.registered[h]=i.styles)},sI=function(t,i,a){z1(t,i,a);var h=t.key+"-"+i.name;if(t.inserted[i.name]===void 0){var p=i;do t.insert(i===p?"."+h:"",p,t.sheet,!0),p=p.next;while(p!==void 0)}};function uO(e){for(var t=0,i,a=0,h=e.length;h>=4;++a,h-=4)i=e.charCodeAt(a)&255|(e.charCodeAt(++a)&255)<<8|(e.charCodeAt(++a)&255)<<16|(e.charCodeAt(++a)&255)<<24,i=(i&65535)*1540483477+((i>>>16)*59797<<16),i^=i>>>24,t=(i&65535)*1540483477+((i>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(h){case 3:t^=(e.charCodeAt(a+2)&255)<<16;case 2:t^=(e.charCodeAt(a+1)&255)<<8;case 1:t^=e.charCodeAt(a)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var cO={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},hO=/[A-Z]|^ms/g,dO=/_EMO_([^_]+?)_([^]*?)_EMO_/g,oI=function(t){return t.charCodeAt(1)===45},vT=function(t){return t!=null&&typeof t!="boolean"},dv=JE(function(e){return oI(e)?e:e.replace(hO,"-$&").toLowerCase()}),xT=function(t,i){switch(t){case"animation":case"animationName":if(typeof i=="string")return i.replace(dO,function(a,h,p){return Js={name:h,styles:p,next:Js},h})}return cO[t]!==1&&!oI(t)&&typeof i=="number"&&i!==0?i+"px":i};function lf(e,t,i){if(i==null)return"";var a=i;if(a.__emotion_styles!==void 0)return a;switch(typeof i){case"boolean":return"";case"object":{var h=i;if(h.anim===1)return Js={name:h.name,styles:h.styles,next:Js},h.name;var p=i;if(p.styles!==void 0){var m=p.next;if(m!==void 0)for(;m!==void 0;)Js={name:m.name,styles:m.styles,next:Js},m=m.next;var u=p.styles+";";return u}return fO(e,t,i)}case"function":{if(e!==void 0){var C=Js,E=i(e);return Js=C,lf(e,t,E)}break}}var D=i;if(t==null)return D;var z=t[D];return z!==void 0?z:D}function fO(e,t,i){var a="";if(Array.isArray(i))for(var h=0;h<i.length;h++)a+=lf(e,t,i[h])+";";else for(var p in i){var m=i[p];if(typeof m!="object"){var u=m;t!=null&&t[u]!==void 0?a+=p+"{"+t[u]+"}":vT(u)&&(a+=dv(p)+":"+xT(p,u)+";")}else if(Array.isArray(m)&&typeof m[0]=="string"&&(t==null||t[m[0]]===void 0))for(var C=0;C<m.length;C++)vT(m[C])&&(a+=dv(p)+":"+xT(p,m[C])+";");else{var E=lf(e,t,m);switch(p){case"animation":case"animationName":{a+=dv(p)+":"+E+";";break}default:a+=p+"{"+E+"}"}}}return a}var bT=/label:\s*([^\s;{]+)\s*(;|$)/g,Js;function ry(e,t,i){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var a=!0,h="";Js=void 0;var p=e[0];if(p==null||p.raw===void 0)a=!1,h+=lf(i,t,p);else{var m=p;h+=m[0]}for(var u=1;u<e.length;u++)if(h+=lf(i,t,e[u]),a){var C=p;h+=C[u]}bT.lastIndex=0;for(var E="",D;(D=bT.exec(h))!==null;)E+="-"+D[1];var z=uO(h)+E;return{name:z,styles:h,next:Js}}var pO=function(t){return t()},mO=wm.useInsertionEffect?wm.useInsertionEffect:!1,aI=mO||pO,lI=le.createContext(typeof HTMLElement<"u"?QB({key:"css"}):null);lI.Provider;var uI=function(t){return le.forwardRef(function(i,a){var h=le.useContext(lI);return t(i,h,a)})},D1=le.createContext({}),R1={}.hasOwnProperty,L0="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",gO=function(t,i){var a={};for(var h in i)R1.call(i,h)&&(a[h]=i[h]);return a[L0]=t,a},yO=function(t){var i=t.cache,a=t.serialized,h=t.isStringTag;return z1(i,a,h),aI(function(){return sI(i,a,h)}),null},_O=uI(function(e,t,i){var a=e.css;typeof a=="string"&&t.registered[a]!==void 0&&(a=t.registered[a]);var h=e[L0],p=[a],m="";typeof e.className=="string"?m=iI(t.registered,p,e.className):e.className!=null&&(m=e.className+" ");var u=ry(p,void 0,le.useContext(D1));m+=t.key+"-"+u.name;var C={};for(var E in e)R1.call(e,E)&&E!=="css"&&E!==L0&&(C[E]=e[E]);return C.className=m,i&&(C.ref=i),le.createElement(le.Fragment,null,le.createElement(yO,{cache:t,serialized:u,isStringTag:typeof h=="string"}),le.createElement(h,C))}),vO=_O,wT=function(t,i){var a=arguments;if(i==null||!R1.call(i,"css"))return le.createElement.apply(void 0,a);var h=a.length,p=new Array(h);p[0]=vO,p[1]=gO(t,i);for(var m=2;m<h;m++)p[m]=a[m];return le.createElement.apply(null,p)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(wT||(wT={}));function L1(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return ry(t)}function Cf(){var e=L1.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var xO=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,bO=JE(function(e){return xO.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),wO=bO,SO=function(t){return t!=="theme"},ST=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?wO:SO},TT=function(t,i,a){var h;if(i){var p=i.shouldForwardProp;h=t.__emotion_forwardProp&&p?function(m){return t.__emotion_forwardProp(m)&&p(m)}:p}return typeof h!="function"&&a&&(h=t.__emotion_forwardProp),h},TO=function(t){var i=t.cache,a=t.serialized,h=t.isStringTag;return z1(i,a,h),aI(function(){return sI(i,a,h)}),null},CO=function e(t,i){var a=t.__emotion_real===t,h=a&&t.__emotion_base||t,p,m;i!==void 0&&(p=i.label,m=i.target);var u=TT(t,i,a),C=u||ST(h),E=!C("as");return function(){var D=arguments,z=a&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(p!==void 0&&z.push("label:"+p+";"),D[0]==null||D[0].raw===void 0)z.push.apply(z,D);else{var A=D[0];z.push(A[0]);for(var Z=D.length,Y=1;Y<Z;Y++)z.push(D[Y],A[Y])}var te=uI(function(pe,U,G){var X=E&&pe.as||h,ae="",_e=[],ye=pe;if(pe.theme==null){ye={};for(var Se in pe)ye[Se]=pe[Se];ye.theme=le.useContext(D1)}typeof pe.className=="string"?ae=iI(U.registered,_e,pe.className):pe.className!=null&&(ae=pe.className+" ");var Ie=ry(z.concat(_e),U.registered,ye);ae+=U.key+"-"+Ie.name,m!==void 0&&(ae+=" "+m);var Be=E&&u===void 0?ST(X):C,Ue={};for(var Ne in pe)E&&Ne==="as"||Be(Ne)&&(Ue[Ne]=pe[Ne]);return Ue.className=ae,G&&(Ue.ref=G),le.createElement(le.Fragment,null,le.createElement(TO,{cache:U,serialized:Ie,isStringTag:typeof X=="string"}),le.createElement(X,Ue))});return te.displayName=p!==void 0?p:"Styled("+(typeof h=="string"?h:h.displayName||h.name||"Component")+")",te.defaultProps=t.defaultProps,te.__emotion_real=te,te.__emotion_base=h,te.__emotion_styles=z,te.__emotion_forwardProp=u,Object.defineProperty(te,"toString",{value:function(){return"."+m}}),te.withComponent=function(pe,U){var G=e(pe,eg({},i,U,{shouldForwardProp:TT(te,U,!0)}));return G.apply(void 0,z)},te}},kO=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],F0=CO.bind(null);kO.forEach(function(e){F0[e]=F0(e)});function PO(e,t){return F0(e,t)}function EO(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}const CT=[];function Gl(e){return CT[0]=e,ry(CT)}const IO=e=>{const t=Object.keys(e).map(i=>({key:i,val:e[i]}))||[];return t.sort((i,a)=>i.val-a.val),t.reduce((i,a)=>({...i,[a.key]:a.val}),{})};function MO(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:i="px",step:a=5,...h}=e,p=IO(t),m=Object.keys(p);function u(A){return`@media (min-width:${typeof t[A]=="number"?t[A]:A}${i})`}function C(A){return`@media (max-width:${(typeof t[A]=="number"?t[A]:A)-a/100}${i})`}function E(A,Z){const Y=m.indexOf(Z);return`@media (min-width:${typeof t[A]=="number"?t[A]:A}${i}) and (max-width:${(Y!==-1&&typeof t[m[Y]]=="number"?t[m[Y]]:Z)-a/100}${i})`}function D(A){return m.indexOf(A)+1<m.length?E(A,m[m.indexOf(A)+1]):u(A)}function z(A){const Z=m.indexOf(A);return Z===0?u(m[1]):Z===m.length-1?C(m[Z]):E(A,m[m.indexOf(A)+1]).replace("@media","@media not all and")}return{keys:m,values:p,up:u,down:C,between:E,only:D,not:z,unit:i,...h}}const AO={borderRadius:4};function cI(e=8,t=T1({spacing:e})){if(e.mui)return e;const i=(...a)=>(a.length===0?[1]:a).map(p=>{const m=t(p);return typeof m=="number"?`${m}px`:m}).join(" ");return i.mui=!0,i}function zO(e,t){var a;const i=this;if(i.vars){if(!((a=i.colorSchemes)!=null&&a[e])||typeof i.getColorSchemeSelector!="function")return{};let h=i.getColorSchemeSelector(e);return h==="&"?t:((h.includes("data-")||h.includes("."))&&(h=`*:where(${h.replace(/\s*&$/,"")}) &`),{[h]:t})}return i.palette.mode===e?t:{}}function hI(e={},...t){const{breakpoints:i={},palette:a={},spacing:h,shape:p={},...m}=e,u=MO(i),C=cI(h);let E=Ui({breakpoints:u,direction:"ltr",components:{},palette:{mode:"light",...a},spacing:C,shape:{...AO,...p}},m);return E=BF(E),E.applyStyles=zO,E=t.reduce((D,z)=>Ui(D,z),E),E.unstable_sxConfig={...Ug,...m==null?void 0:m.unstable_sxConfig},E.unstable_sx=function(z){return Oc({sx:z,theme:this})},E}function DO(e){return Object.keys(e).length===0}function RO(e=null){const t=le.useContext(D1);return!t||DO(t)?e:t}const LO={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function kf(e,t,i="Mui"){const a=LO[t];return a?`${i}-${a}`:`${zF.generate(e)}-${t}`}function Pf(e,t,i="Mui"){const a={};return t.forEach(h=>{a[h]=kf(e,h,i)}),a}function dI(e){const{variants:t,...i}=e,a={variants:t,style:Gl(i),isProcessed:!0};return a.style===i||t&&t.forEach(h=>{typeof h.style!="function"&&(h.style=Gl(h.style))}),a}const FO=hI();function fv(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function Ol(e,t){return t&&e&&typeof e=="object"&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${t}{${String(e.styles)}}`),e}function BO(e){return e?(t,i)=>i[e]:null}function OO(e,t,i){e.theme=jO(e.theme)?i:e.theme[t]||e.theme}function xm(e,t,i){const a=typeof t=="function"?t(e):t;if(Array.isArray(a))return a.flatMap(h=>xm(e,h,i));if(Array.isArray(a==null?void 0:a.variants)){let h;if(a.isProcessed)h=i?Ol(a.style,i):a.style;else{const{variants:p,...m}=a;h=i?Ol(Gl(m),i):m}return fI(e,a.variants,[h],i)}return a!=null&&a.isProcessed?i?Ol(Gl(a.style),i):a.style:i?Ol(Gl(a),i):a}function fI(e,t,i=[],a=void 0){var p;let h;e:for(let m=0;m<t.length;m+=1){const u=t[m];if(typeof u.props=="function"){if(h??(h={...e,...e.ownerState,ownerState:e.ownerState}),!u.props(h))continue}else for(const C in u.props)if(e[C]!==u.props[C]&&((p=e.ownerState)==null?void 0:p[C])!==u.props[C])continue e;typeof u.style=="function"?(h??(h={...e,...e.ownerState,ownerState:e.ownerState}),i.push(a?Ol(Gl(u.style(h)),a):u.style(h))):i.push(a?Ol(Gl(u.style),a):u.style)}return i}function VO(e={}){const{themeId:t,defaultTheme:i=FO,rootShouldForwardProp:a=fv,slotShouldForwardProp:h=fv}=e;function p(u){OO(u,t,i)}return(u,C={})=>{EO(u,ye=>ye.filter(Se=>Se!==Oc));const{name:E,slot:D,skipVariantsResolver:z,skipSx:A,overridesResolver:Z=BO(UO(D)),...Y}=C,te=E&&E.startsWith("Mui")||D?"components":"custom",pe=z!==void 0?z:D&&D!=="Root"&&D!=="root"||!1,U=A||!1;let G=fv;D==="Root"||D==="root"?G=a:D?G=h:$O(u)&&(G=void 0);const X=PO(u,{shouldForwardProp:G,label:NO(),...Y}),ae=ye=>{if(ye.__emotion_real===ye)return ye;if(typeof ye=="function")return function(Ie){return xm(Ie,ye,Ie.theme.modularCssLayers?te:void 0)};if(Mo(ye)){const Se=dI(ye);return function(Be){return Se.variants?xm(Be,Se,Be.theme.modularCssLayers?te:void 0):Be.theme.modularCssLayers?Ol(Se.style,te):Se.style}}return ye},_e=(...ye)=>{const Se=[],Ie=ye.map(ae),Be=[];if(Se.push(p),E&&Z&&Be.push(function(je){var bt,Oe;const ft=(Oe=(bt=je.theme.components)==null?void 0:bt[E])==null?void 0:Oe.styleOverrides;if(!ft)return null;const Ct={};for(const tt in ft)Ct[tt]=xm(je,ft[tt],je.theme.modularCssLayers?"theme":void 0);return Z(je,Ct)}),E&&!pe&&Be.push(function(je){var Ct,bt;const Fe=je.theme,ft=(bt=(Ct=Fe==null?void 0:Fe.components)==null?void 0:Ct[E])==null?void 0:bt.variants;return ft?fI(je,ft,[],je.theme.modularCssLayers?"theme":void 0):null}),U||Be.push(Oc),Array.isArray(Ie[0])){const J=Ie.shift(),je=new Array(Se.length).fill(""),Fe=new Array(Be.length).fill("");let ft;ft=[...je,...J,...Fe],ft.raw=[...je,...J.raw,...Fe],Se.unshift(ft)}const Ue=[...Se,...Ie,...Be],Ne=X(...Ue);return u.muiName&&(Ne.muiName=u.muiName),Ne};return X.withConfig&&(_e.withConfig=X.withConfig),_e}}function NO(e,t){return void 0}function jO(e){for(const t in e)return!1;return!0}function $O(e){return typeof e=="string"&&e.charCodeAt(0)>96}function UO(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}function ng(e,t,i=!1){const a={...t};for(const h in e)if(Object.prototype.hasOwnProperty.call(e,h)){const p=h;if(p==="components"||p==="slots")a[p]={...e[p],...a[p]};else if(p==="componentsProps"||p==="slotProps"){const m=e[p],u=t[p];if(!u)a[p]=m||{};else if(!m)a[p]=u;else{a[p]={...u};for(const C in m)if(Object.prototype.hasOwnProperty.call(m,C)){const E=C;a[p][E]=ng(m[E],u[E],i)}}}else p==="className"&&i&&t.className?a.className=gi(e==null?void 0:e.className,t==null?void 0:t.className):p==="style"&&i&&t.style?a.style={...e==null?void 0:e.style,...t==null?void 0:t.style}:a[p]===void 0&&(a[p]=e[p])}return a}function GO(e){const{theme:t,name:i,props:a}=e;return!t||!t.components||!t.components[i]||!t.components[i].defaultProps?a:ng(t.components[i].defaultProps,a)}const pI=typeof window<"u"?le.useLayoutEffect:le.useEffect;function qO(e,t,i,a,h){const[p,m]=le.useState(()=>h&&i?i(e).matches:a?a(e).matches:t);return pI(()=>{if(!i)return;const u=i(e),C=()=>{m(u.matches)};return C(),u.addEventListener("change",C),()=>{u.removeEventListener("change",C)}},[e,i]),p}const ZO={...wm},mI=ZO.useSyncExternalStore;function WO(e,t,i,a,h){const p=le.useCallback(()=>t,[t]),m=le.useMemo(()=>{if(h&&i)return()=>i(e).matches;if(a!==null){const{matches:D}=a(e);return()=>D}return p},[p,e,a,h,i]),[u,C]=le.useMemo(()=>{if(i===null)return[p,()=>()=>{}];const D=i(e);return[()=>D.matches,z=>(D.addEventListener("change",z),()=>{D.removeEventListener("change",z)})]},[p,i,e]);return mI(C,u,m)}function gI(e={}){const{themeId:t}=e;return function(a,h={}){let p=RO();p&&t&&(p=p[t]||p);const m=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:u=!1,matchMedia:C=m?window.matchMedia:null,ssrMatchMedia:E=null,noSsr:D=!1}=GO({name:"MuiUseMediaQuery",props:h,theme:p});let z=typeof a=="function"?a(p):a;return z=z.replace(/^@media( ?)/m,""),z.includes("print")&&console.warn(["MUI: You have provided a `print` query to the `useMediaQuery` hook.","Using the print media query to modify print styles can lead to unexpected results.","Consider using the `displayPrint` field in the `sx` prop instead.","More information about `displayPrint` on our docs: https://mui.com/system/display/#display-in-print."].join(`
`)),(mI!==void 0?WO:qO)(z,u,C,E,D)}}gI();function HO(e,t=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,i))}function F1(e,t=0,i=1){return HO(e,t,i)}function XO(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let i=e.match(t);return i&&i[0].length===1&&(i=i.map(a=>a+a)),i?`rgb${i.length===4?"a":""}(${i.map((a,h)=>h<3?parseInt(a,16):Math.round(parseInt(a,16)/255*1e3)/1e3).join(", ")})`:""}function qa(e){if(e.type)return e;if(e.charAt(0)==="#")return qa(XO(e));const t=e.indexOf("("),i=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(i))throw new Error(Kl(9,e));let a=e.substring(t+1,e.length-1),h;if(i==="color"){if(a=a.split(" "),h=a.shift(),a.length===4&&a[3].charAt(0)==="/"&&(a[3]=a[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(h))throw new Error(Kl(10,h))}else a=a.split(",");return a=a.map(p=>parseFloat(p)),{type:i,values:a,colorSpace:h}}const KO=e=>{const t=qa(e);return t.values.slice(0,3).map((i,a)=>t.type.includes("hsl")&&a!==0?`${i}%`:i).join(" ")},vd=(e,t)=>{try{return KO(e)}catch{return e}};function iy(e){const{type:t,colorSpace:i}=e;let{values:a}=e;return t.includes("rgb")?a=a.map((h,p)=>p<3?parseInt(h,10):h):t.includes("hsl")&&(a[1]=`${a[1]}%`,a[2]=`${a[2]}%`),t.includes("color")?a=`${i} ${a.join(" ")}`:a=`${a.join(", ")}`,`${t}(${a})`}function yI(e){e=qa(e);const{values:t}=e,i=t[0],a=t[1]/100,h=t[2]/100,p=a*Math.min(h,1-h),m=(E,D=(E+i/30)%12)=>h-p*Math.max(Math.min(D-3,9-D,1),-1);let u="rgb";const C=[Math.round(m(0)*255),Math.round(m(8)*255),Math.round(m(4)*255)];return e.type==="hsla"&&(u+="a",C.push(t[3])),iy({type:u,values:C})}function B0(e){e=qa(e);let t=e.type==="hsl"||e.type==="hsla"?qa(yI(e)).values:e.values;return t=t.map(i=>(e.type!=="color"&&(i/=255),i<=.03928?i/12.92:((i+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function YO(e,t){const i=B0(e),a=B0(t);return(Math.max(i,a)+.05)/(Math.min(i,a)+.05)}function _I(e,t){return e=qa(e),t=F1(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,iy(e)}function El(e,t,i){try{return _I(e,t)}catch{return e}}function sy(e,t){if(e=qa(e),t=F1(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let i=0;i<3;i+=1)e.values[i]*=1-t;return iy(e)}function rn(e,t,i){try{return sy(e,t)}catch{return e}}function oy(e,t){if(e=qa(e),t=F1(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let i=0;i<3;i+=1)e.values[i]+=(255-e.values[i])*t;else if(e.type.includes("color"))for(let i=0;i<3;i+=1)e.values[i]+=(1-e.values[i])*t;return iy(e)}function sn(e,t,i){try{return oy(e,t)}catch{return e}}function JO(e,t=.15){return B0(e)>.5?sy(e,t):oy(e,t)}function Qp(e,t,i){try{return JO(e,t)}catch{return e}}const QO=le.createContext(void 0);function e6(e){const{theme:t,name:i,props:a}=e;if(!t||!t.components||!t.components[i])return a;const h=t.components[i];return h.defaultProps?ng(h.defaultProps,a,t.components.mergeClassNameAndStyle):!h.styleOverrides&&!h.variants?ng(h,a,t.components.mergeClassNameAndStyle):a}function t6({props:e,name:t}){const i=le.useContext(QO);return e6({props:e,name:t,theme:{components:i}})}let kT=0;function n6(e){const[t,i]=le.useState(e),a=e||t;return le.useEffect(()=>{t==null&&(kT+=1,i(`mui-${kT}`))},[t]),a}const r6={...wm},PT=r6.useId;function i6(e){if(PT!==void 0){const t=PT();return e??t}return n6(e)}const ET={theme:void 0};function s6(e){let t,i;return function(h){let p=t;return(p===void 0||h.theme!==i)&&(ET.theme=h.theme,p=dI(e(ET)),t=p,i=h.theme),p}}function o6(e=""){function t(...a){if(!a.length)return"";const h=a[0];return typeof h=="string"&&!h.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${h}${t(...a.slice(1))})`:`, ${h}`}return(a,...h)=>`var(--${e?`${e}-`:""}${a}${t(...h)})`}const IT=(e,t,i,a=[])=>{let h=e;t.forEach((p,m)=>{m===t.length-1?Array.isArray(h)?h[Number(p)]=i:h&&typeof h=="object"&&(h[p]=i):h&&typeof h=="object"&&(h[p]||(h[p]=a.includes(p)?[]:{}),h=h[p])})},a6=(e,t,i)=>{function a(h,p=[],m=[]){Object.entries(h).forEach(([u,C])=>{(!i||i&&!i([...p,u]))&&C!=null&&(typeof C=="object"&&Object.keys(C).length>0?a(C,[...p,u],Array.isArray(C)?[...m,u]:m):t([...p,u],C,m))})}a(e)},l6=(e,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(a=>e.includes(a))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t;function pv(e,t){const{prefix:i,shouldSkipGeneratingVar:a}=t||{},h={},p={},m={};return a6(e,(u,C,E)=>{if((typeof C=="string"||typeof C=="number")&&(!a||!a(u,C))){const D=`--${i?`${i}-`:""}${u.join("-")}`,z=l6(u,C);Object.assign(h,{[D]:z}),IT(p,u,`var(${D})`,E),IT(m,u,`var(${D}, ${z})`,E)}},u=>u[0]==="vars"),{css:h,vars:p,varsWithDefaults:m}}function u6(e,t={}){const{getSelector:i=U,disableCssColorScheme:a,colorSchemeSelector:h,enableContrastVars:p}=t,{colorSchemes:m={},components:u,defaultColorScheme:C="light",...E}=e,{vars:D,css:z,varsWithDefaults:A}=pv(E,t);let Z=A;const Y={},{[C]:te,...pe}=m;if(Object.entries(pe||{}).forEach(([ae,_e])=>{const{vars:ye,css:Se,varsWithDefaults:Ie}=pv(_e,t);Z=Ui(Z,Ie),Y[ae]={css:Se,vars:ye}}),te){const{css:ae,vars:_e,varsWithDefaults:ye}=pv(te,t);Z=Ui(Z,ye),Y[C]={css:ae,vars:_e}}function U(ae,_e){var Se,Ie;let ye=h;if(h==="class"&&(ye=".%s"),h==="data"&&(ye="[data-%s]"),h!=null&&h.startsWith("data-")&&!h.includes("%s")&&(ye=`[${h}="%s"]`),ae){if(ye==="media")return e.defaultColorScheme===ae?":root":{[`@media (prefers-color-scheme: ${((Ie=(Se=m[ae])==null?void 0:Se.palette)==null?void 0:Ie.mode)||ae})`]:{":root":_e}};if(ye)return e.defaultColorScheme===ae?`:root, ${ye.replace("%s",String(ae))}`:ye.replace("%s",String(ae))}return":root"}return{vars:Z,generateThemeVars:()=>{let ae={...D};return Object.entries(Y).forEach(([,{vars:_e}])=>{ae=Ui(ae,_e)}),ae},generateStyleSheets:()=>{var Be,Ue;const ae=[],_e=e.defaultColorScheme||"light";function ye(Ne,J){Object.keys(J).length&&ae.push(typeof Ne=="string"?{[Ne]:{...J}}:Ne)}ye(i(void 0,{...z}),z);const{[_e]:Se,...Ie}=Y;if(Se){const{css:Ne}=Se,J=(Ue=(Be=m[_e])==null?void 0:Be.palette)==null?void 0:Ue.mode,je=!a&&J?{colorScheme:J,...Ne}:{...Ne};ye(i(_e,{...je}),je)}return Object.entries(Ie).forEach(([Ne,{css:J}])=>{var ft,Ct;const je=(Ct=(ft=m[Ne])==null?void 0:ft.palette)==null?void 0:Ct.mode,Fe=!a&&je?{colorScheme:je,...J}:{...J};ye(i(Ne,{...Fe}),Fe)}),p&&ae.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),ae}}}function c6(e){return function(i){return e==="media"?`@media (prefers-color-scheme: ${i})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${i}"] &`:e==="class"?`.${i} &`:e==="data"?`[data-${i}] &`:`${e.replace("%s",i)} &`:"&"}}const uf={black:"#000",white:"#fff"},h6={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Ku={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Yu={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},fd={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},Ju={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},Qu={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},ec={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function vI(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:uf.white,default:uf.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const xI=vI();function bI(){return{text:{primary:uf.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:uf.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const O0=bI();function MT(e,t,i,a){const h=a.light||a,p=a.dark||a*1.5;e[t]||(e.hasOwnProperty(i)?e[t]=e[i]:t==="light"?e.light=oy(e.main,h):t==="dark"&&(e.dark=sy(e.main,p)))}function AT(e,t,i,a,h){const p=h.light||h,m=h.dark||h*1.5;t[i]||(t.hasOwnProperty(a)?t[i]=t[a]:i==="light"?t.light=`color-mix(in ${e}, ${t.main}, #fff ${(p*100).toFixed(0)}%)`:i==="dark"&&(t.dark=`color-mix(in ${e}, ${t.main}, #000 ${(m*100).toFixed(0)}%)`))}function d6(e="light"){return e==="dark"?{main:Ju[200],light:Ju[50],dark:Ju[400]}:{main:Ju[700],light:Ju[400],dark:Ju[800]}}function f6(e="light"){return e==="dark"?{main:Ku[200],light:Ku[50],dark:Ku[400]}:{main:Ku[500],light:Ku[300],dark:Ku[700]}}function p6(e="light"){return e==="dark"?{main:Yu[500],light:Yu[300],dark:Yu[700]}:{main:Yu[700],light:Yu[400],dark:Yu[800]}}function m6(e="light"){return e==="dark"?{main:Qu[400],light:Qu[300],dark:Qu[700]}:{main:Qu[700],light:Qu[500],dark:Qu[900]}}function g6(e="light"){return e==="dark"?{main:ec[400],light:ec[300],dark:ec[700]}:{main:ec[800],light:ec[500],dark:ec[900]}}function y6(e="light"){return e==="dark"?{main:fd[400],light:fd[300],dark:fd[700]}:{main:"#ed6c02",light:fd[500],dark:fd[900]}}function _6(e){return`oklch(from ${e} var(--__l) 0 h / var(--__a))`}function B1(e){const{mode:t="light",contrastThreshold:i=3,tonalOffset:a=.2,colorSpace:h,...p}=e,m=e.primary||d6(t),u=e.secondary||f6(t),C=e.error||p6(t),E=e.info||m6(t),D=e.success||g6(t),z=e.warning||y6(t);function A(pe){return h?_6(pe):YO(pe,O0.text.primary)>=i?O0.text.primary:xI.text.primary}const Z=({color:pe,name:U,mainShade:G=500,lightShade:X=300,darkShade:ae=700})=>{if(pe={...pe},!pe.main&&pe[G]&&(pe.main=pe[G]),!pe.hasOwnProperty("main"))throw new Error(Kl(11,U?` (${U})`:"",G));if(typeof pe.main!="string")throw new Error(Kl(12,U?` (${U})`:"",JSON.stringify(pe.main)));return h?(AT(h,pe,"light",X,a),AT(h,pe,"dark",ae,a)):(MT(pe,"light",X,a),MT(pe,"dark",ae,a)),pe.contrastText||(pe.contrastText=A(pe.main)),pe};let Y;return t==="light"?Y=vI():t==="dark"&&(Y=bI()),Ui({common:{...uf},mode:t,primary:Z({color:m,name:"primary"}),secondary:Z({color:u,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:Z({color:C,name:"error"}),warning:Z({color:z,name:"warning"}),info:Z({color:E,name:"info"}),success:Z({color:D,name:"success"}),grey:h6,contrastThreshold:i,getContrastText:A,augmentColor:Z,tonalOffset:a,...Y},p)}function v6(e){const t={};return Object.entries(e).forEach(a=>{const[h,p]=a;typeof p=="object"&&(t[h]=`${p.fontStyle?`${p.fontStyle} `:""}${p.fontVariant?`${p.fontVariant} `:""}${p.fontWeight?`${p.fontWeight} `:""}${p.fontStretch?`${p.fontStretch} `:""}${p.fontSize||""}${p.lineHeight?`/${p.lineHeight} `:""}${p.fontFamily||""}`)}),t}function x6(e,t){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...t}}function b6(e){return Math.round(e*1e5)/1e5}const zT={textTransform:"uppercase"},DT='"Roboto", "Helvetica", "Arial", sans-serif';function w6(e,t){const{fontFamily:i=DT,fontSize:a=14,fontWeightLight:h=300,fontWeightRegular:p=400,fontWeightMedium:m=500,fontWeightBold:u=700,htmlFontSize:C=16,allVariants:E,pxToRem:D,...z}=typeof t=="function"?t(e):t,A=a/14,Z=D||(pe=>`${pe/C*A}rem`),Y=(pe,U,G,X,ae)=>({fontFamily:i,fontWeight:pe,fontSize:Z(U),lineHeight:G,...i===DT?{letterSpacing:`${b6(X/U)}em`}:{},...ae,...E}),te={h1:Y(h,96,1.167,-1.5),h2:Y(h,60,1.2,-.5),h3:Y(p,48,1.167,0),h4:Y(p,34,1.235,.25),h5:Y(p,24,1.334,0),h6:Y(m,20,1.6,.15),subtitle1:Y(p,16,1.75,.15),subtitle2:Y(m,14,1.57,.1),body1:Y(p,16,1.5,.15),body2:Y(p,14,1.43,.15),button:Y(m,14,1.75,.4,zT),caption:Y(p,12,1.66,.4),overline:Y(p,12,2.66,1,zT),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Ui({htmlFontSize:C,pxToRem:Z,fontFamily:i,fontSize:a,fontWeightLight:h,fontWeightRegular:p,fontWeightMedium:m,fontWeightBold:u,...te},z,{clone:!1})}const S6=.2,T6=.14,C6=.12;function Tn(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${S6})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${T6})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${C6})`].join(",")}const k6=["none",Tn(0,2,1,-1,0,1,1,0,0,1,3,0),Tn(0,3,1,-2,0,2,2,0,0,1,5,0),Tn(0,3,3,-2,0,3,4,0,0,1,8,0),Tn(0,2,4,-1,0,4,5,0,0,1,10,0),Tn(0,3,5,-1,0,5,8,0,0,1,14,0),Tn(0,3,5,-1,0,6,10,0,0,1,18,0),Tn(0,4,5,-2,0,7,10,1,0,2,16,1),Tn(0,5,5,-3,0,8,10,1,0,3,14,2),Tn(0,5,6,-3,0,9,12,1,0,3,16,2),Tn(0,6,6,-3,0,10,14,1,0,4,18,3),Tn(0,6,7,-4,0,11,15,1,0,4,20,3),Tn(0,7,8,-4,0,12,17,2,0,5,22,4),Tn(0,7,8,-4,0,13,19,2,0,5,24,4),Tn(0,7,9,-4,0,14,21,2,0,5,26,4),Tn(0,8,9,-5,0,15,22,2,0,6,28,5),Tn(0,8,10,-5,0,16,24,2,0,6,30,5),Tn(0,8,11,-5,0,17,26,2,0,6,32,5),Tn(0,9,11,-5,0,18,28,2,0,7,34,6),Tn(0,9,12,-6,0,19,29,2,0,7,36,6),Tn(0,10,13,-6,0,20,31,3,0,8,38,7),Tn(0,10,13,-6,0,21,33,3,0,8,40,7),Tn(0,10,14,-6,0,22,35,3,0,8,42,7),Tn(0,11,14,-7,0,23,36,3,0,9,44,8),Tn(0,11,15,-7,0,24,38,3,0,9,46,8)],P6={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},E6={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function RT(e){return`${Math.round(e)}ms`}function I6(e){if(!e)return 0;const t=e/36;return Math.min(Math.round((4+15*t**.25+t/5)*10),3e3)}function M6(e){const t={...P6,...e.easing},i={...E6,...e.duration};return{getAutoHeightDuration:I6,create:(h=["all"],p={})=>{const{duration:m=i.standard,easing:u=t.easeInOut,delay:C=0,...E}=p;return(Array.isArray(h)?h:[h]).map(D=>`${D} ${typeof m=="string"?m:RT(m)} ${u} ${typeof C=="string"?C:RT(C)}`).join(",")},...e,easing:t,duration:i}}const A6={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function z6(e){return Mo(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function wI(e={}){const t={...e};function i(a){const h=Object.entries(a);for(let p=0;p<h.length;p++){const[m,u]=h[p];!z6(u)||m.startsWith("unstable_")?delete a[m]:Mo(u)&&(a[m]={...u},i(a[m]))}}return i(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(t,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function LT(e){return typeof e=="number"?`${(e*100).toFixed(0)}%`:`calc((${e}) * 100%)`}const D6=e=>{if(!Number.isNaN(+e))return+e;const t=e.match(/\d*\.?\d+/g);if(!t)return 0;let i=0;for(let a=0;a<t.length;a+=1)i+=+t[a];return i};function R6(e){Object.assign(e,{alpha(t,i){const a=this||e;return a.colorSpace?`oklch(from ${t} l c h / ${typeof i=="string"?`calc(${i})`:i})`:a.vars?`rgba(${t.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof i=="string"?`calc(${i})`:i})`:_I(t,D6(i))},lighten(t,i){const a=this||e;return a.colorSpace?`color-mix(in ${a.colorSpace}, ${t}, #fff ${LT(i)})`:oy(t,i)},darken(t,i){const a=this||e;return a.colorSpace?`color-mix(in ${a.colorSpace}, ${t}, #000 ${LT(i)})`:sy(t,i)}})}function V0(e={},...t){const{breakpoints:i,mixins:a={},spacing:h,palette:p={},transitions:m={},typography:u={},shape:C,colorSpace:E,...D}=e;if(e.vars&&e.generateThemeVars===void 0)throw new Error(Kl(20));const z=B1({...p,colorSpace:E}),A=hI(e);let Z=Ui(A,{mixins:x6(A.breakpoints,a),palette:z,shadows:k6.slice(),typography:w6(z,u),transitions:M6(m),zIndex:{...A6}});return Z=Ui(Z,D),Z=t.reduce((Y,te)=>Ui(Y,te),Z),Z.unstable_sxConfig={...Ug,...D==null?void 0:D.unstable_sxConfig},Z.unstable_sx=function(te){return Oc({sx:te,theme:this})},Z.toRuntimeSource=wI,R6(Z),Z}function L6(e){let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,Math.round(t*10)/1e3}const F6=[...Array(25)].map((e,t)=>{if(t===0)return"none";const i=L6(t);return`linear-gradient(rgba(255 255 255 / ${i}), rgba(255 255 255 / ${i}))`});function SI(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function TI(e){return e==="dark"?F6:[]}function B6(e){const{palette:t={mode:"light"},opacity:i,overlays:a,colorSpace:h,...p}=e,m=B1({...t,colorSpace:h});return{palette:m,opacity:{...SI(m.mode),...i},overlays:a||TI(m.mode),...p}}function O6(e){var t;return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!((t=e[1])!=null&&t.match(/(mode|contrastThreshold|tonalOffset)/))}const V6=e=>[...[...Array(25)].map((t,i)=>`--${e?`${e}-`:""}overlays-${i}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],N6=e=>(t,i)=>{const a=e.rootSelector||":root",h=e.colorSchemeSelector;let p=h;if(h==="class"&&(p=".%s"),h==="data"&&(p="[data-%s]"),h!=null&&h.startsWith("data-")&&!h.includes("%s")&&(p=`[${h}="%s"]`),e.defaultColorScheme===t){if(t==="dark"){const m={};return V6(e.cssVarPrefix).forEach(u=>{m[u]=i[u],delete i[u]}),p==="media"?{[a]:i,"@media (prefers-color-scheme: dark)":{[a]:m}}:p?{[p.replace("%s",t)]:m,[`${a}, ${p.replace("%s",t)}`]:i}:{[a]:{...i,...m}}}if(p&&p!=="media")return`${a}, ${p.replace("%s",String(t))}`}else if(t){if(p==="media")return{[`@media (prefers-color-scheme: ${String(t)})`]:{[a]:i}};if(p)return p.replace("%s",String(t))}return a};function j6(e,t){t.forEach(i=>{e[i]||(e[i]={})})}function Ae(e,t,i){!e[t]&&i&&(e[t]=i)}function xd(e){return typeof e!="string"||!e.startsWith("hsl")?e:yI(e)}function ko(e,t){`${t}Channel`in e||(e[`${t}Channel`]=vd(xd(e[t])))}function $6(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const Hs=e=>{try{return e()}catch{}},U6=(e="mui")=>o6(e);function mv(e,t,i,a,h){if(!i)return;i=i===!0?{}:i;const p=h==="dark"?"dark":"light";if(!a){t[h]=B6({...i,palette:{mode:p,...i==null?void 0:i.palette},colorSpace:e});return}const{palette:m,...u}=V0({...a,palette:{mode:p,...i==null?void 0:i.palette},colorSpace:e});return t[h]={...i,palette:m,opacity:{...SI(p),...i==null?void 0:i.opacity},overlays:(i==null?void 0:i.overlays)||TI(p)},u}function G6(e={},...t){const{colorSchemes:i={light:!0},defaultColorScheme:a,disableCssColorScheme:h=!1,cssVarPrefix:p="mui",nativeColor:m=!1,shouldSkipGeneratingVar:u=O6,colorSchemeSelector:C=i.light&&i.dark?"media":void 0,rootSelector:E=":root",...D}=e,z=Object.keys(i)[0],A=a||(i.light&&z!=="light"?"light":z),Z=U6(p),{[A]:Y,light:te,dark:pe,...U}=i,G={...U};let X=Y;if((A==="dark"&&!("dark"in i)||A==="light"&&!("light"in i))&&(X=!0),!X)throw new Error(Kl(21,A));let ae;m&&(ae="oklch");const _e=mv(ae,G,X,D,A);te&&!G.light&&mv(ae,G,te,void 0,"light"),pe&&!G.dark&&mv(ae,G,pe,void 0,"dark");let ye={defaultColorScheme:A,..._e,cssVarPrefix:p,colorSchemeSelector:C,rootSelector:E,getCssVar:Z,colorSchemes:G,font:{...v6(_e.typography),..._e.font},spacing:$6(D.spacing)};Object.keys(ye.colorSchemes).forEach(Ne=>{const J=ye.colorSchemes[Ne].palette,je=ft=>{const Ct=ft.split("-"),bt=Ct[1],Oe=Ct[2];return Z(ft,J[bt][Oe])};J.mode==="light"&&(Ae(J.common,"background","#fff"),Ae(J.common,"onBackground","#000")),J.mode==="dark"&&(Ae(J.common,"background","#000"),Ae(J.common,"onBackground","#fff"));function Fe(ft,Ct,bt){if(ae){let Oe;return ft===El&&(Oe=`transparent ${((1-bt)*100).toFixed(0)}%`),ft===rn&&(Oe=`#000 ${(bt*100).toFixed(0)}%`),ft===sn&&(Oe=`#fff ${(bt*100).toFixed(0)}%`),`color-mix(in ${ae}, ${Ct}, ${Oe})`}return ft(Ct,bt)}if(j6(J,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),J.mode==="light"){Ae(J.Alert,"errorColor",Fe(rn,J.error.light,.6)),Ae(J.Alert,"infoColor",Fe(rn,J.info.light,.6)),Ae(J.Alert,"successColor",Fe(rn,J.success.light,.6)),Ae(J.Alert,"warningColor",Fe(rn,J.warning.light,.6)),Ae(J.Alert,"errorFilledBg",je("palette-error-main")),Ae(J.Alert,"infoFilledBg",je("palette-info-main")),Ae(J.Alert,"successFilledBg",je("palette-success-main")),Ae(J.Alert,"warningFilledBg",je("palette-warning-main")),Ae(J.Alert,"errorFilledColor",Hs(()=>J.getContrastText(J.error.main))),Ae(J.Alert,"infoFilledColor",Hs(()=>J.getContrastText(J.info.main))),Ae(J.Alert,"successFilledColor",Hs(()=>J.getContrastText(J.success.main))),Ae(J.Alert,"warningFilledColor",Hs(()=>J.getContrastText(J.warning.main))),Ae(J.Alert,"errorStandardBg",Fe(sn,J.error.light,.9)),Ae(J.Alert,"infoStandardBg",Fe(sn,J.info.light,.9)),Ae(J.Alert,"successStandardBg",Fe(sn,J.success.light,.9)),Ae(J.Alert,"warningStandardBg",Fe(sn,J.warning.light,.9)),Ae(J.Alert,"errorIconColor",je("palette-error-main")),Ae(J.Alert,"infoIconColor",je("palette-info-main")),Ae(J.Alert,"successIconColor",je("palette-success-main")),Ae(J.Alert,"warningIconColor",je("palette-warning-main")),Ae(J.AppBar,"defaultBg",je("palette-grey-100")),Ae(J.Avatar,"defaultBg",je("palette-grey-400")),Ae(J.Button,"inheritContainedBg",je("palette-grey-300")),Ae(J.Button,"inheritContainedHoverBg",je("palette-grey-A100")),Ae(J.Chip,"defaultBorder",je("palette-grey-400")),Ae(J.Chip,"defaultAvatarColor",je("palette-grey-700")),Ae(J.Chip,"defaultIconColor",je("palette-grey-700")),Ae(J.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Ae(J.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Ae(J.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Ae(J.LinearProgress,"primaryBg",Fe(sn,J.primary.main,.62)),Ae(J.LinearProgress,"secondaryBg",Fe(sn,J.secondary.main,.62)),Ae(J.LinearProgress,"errorBg",Fe(sn,J.error.main,.62)),Ae(J.LinearProgress,"infoBg",Fe(sn,J.info.main,.62)),Ae(J.LinearProgress,"successBg",Fe(sn,J.success.main,.62)),Ae(J.LinearProgress,"warningBg",Fe(sn,J.warning.main,.62)),Ae(J.Skeleton,"bg",ae?Fe(El,J.text.primary,.11):`rgba(${je("palette-text-primaryChannel")} / 0.11)`),Ae(J.Slider,"primaryTrack",Fe(sn,J.primary.main,.62)),Ae(J.Slider,"secondaryTrack",Fe(sn,J.secondary.main,.62)),Ae(J.Slider,"errorTrack",Fe(sn,J.error.main,.62)),Ae(J.Slider,"infoTrack",Fe(sn,J.info.main,.62)),Ae(J.Slider,"successTrack",Fe(sn,J.success.main,.62)),Ae(J.Slider,"warningTrack",Fe(sn,J.warning.main,.62));const ft=ae?Fe(rn,J.background.default,.6825):Qp(J.background.default,.8);Ae(J.SnackbarContent,"bg",ft),Ae(J.SnackbarContent,"color",Hs(()=>ae?O0.text.primary:J.getContrastText(ft))),Ae(J.SpeedDialAction,"fabHoverBg",Qp(J.background.paper,.15)),Ae(J.StepConnector,"border",je("palette-grey-400")),Ae(J.StepContent,"border",je("palette-grey-400")),Ae(J.Switch,"defaultColor",je("palette-common-white")),Ae(J.Switch,"defaultDisabledColor",je("palette-grey-100")),Ae(J.Switch,"primaryDisabledColor",Fe(sn,J.primary.main,.62)),Ae(J.Switch,"secondaryDisabledColor",Fe(sn,J.secondary.main,.62)),Ae(J.Switch,"errorDisabledColor",Fe(sn,J.error.main,.62)),Ae(J.Switch,"infoDisabledColor",Fe(sn,J.info.main,.62)),Ae(J.Switch,"successDisabledColor",Fe(sn,J.success.main,.62)),Ae(J.Switch,"warningDisabledColor",Fe(sn,J.warning.main,.62)),Ae(J.TableCell,"border",Fe(sn,Fe(El,J.divider,1),.88)),Ae(J.Tooltip,"bg",Fe(El,J.grey[700],.92))}if(J.mode==="dark"){Ae(J.Alert,"errorColor",Fe(sn,J.error.light,.6)),Ae(J.Alert,"infoColor",Fe(sn,J.info.light,.6)),Ae(J.Alert,"successColor",Fe(sn,J.success.light,.6)),Ae(J.Alert,"warningColor",Fe(sn,J.warning.light,.6)),Ae(J.Alert,"errorFilledBg",je("palette-error-dark")),Ae(J.Alert,"infoFilledBg",je("palette-info-dark")),Ae(J.Alert,"successFilledBg",je("palette-success-dark")),Ae(J.Alert,"warningFilledBg",je("palette-warning-dark")),Ae(J.Alert,"errorFilledColor",Hs(()=>J.getContrastText(J.error.dark))),Ae(J.Alert,"infoFilledColor",Hs(()=>J.getContrastText(J.info.dark))),Ae(J.Alert,"successFilledColor",Hs(()=>J.getContrastText(J.success.dark))),Ae(J.Alert,"warningFilledColor",Hs(()=>J.getContrastText(J.warning.dark))),Ae(J.Alert,"errorStandardBg",Fe(rn,J.error.light,.9)),Ae(J.Alert,"infoStandardBg",Fe(rn,J.info.light,.9)),Ae(J.Alert,"successStandardBg",Fe(rn,J.success.light,.9)),Ae(J.Alert,"warningStandardBg",Fe(rn,J.warning.light,.9)),Ae(J.Alert,"errorIconColor",je("palette-error-main")),Ae(J.Alert,"infoIconColor",je("palette-info-main")),Ae(J.Alert,"successIconColor",je("palette-success-main")),Ae(J.Alert,"warningIconColor",je("palette-warning-main")),Ae(J.AppBar,"defaultBg",je("palette-grey-900")),Ae(J.AppBar,"darkBg",je("palette-background-paper")),Ae(J.AppBar,"darkColor",je("palette-text-primary")),Ae(J.Avatar,"defaultBg",je("palette-grey-600")),Ae(J.Button,"inheritContainedBg",je("palette-grey-800")),Ae(J.Button,"inheritContainedHoverBg",je("palette-grey-700")),Ae(J.Chip,"defaultBorder",je("palette-grey-700")),Ae(J.Chip,"defaultAvatarColor",je("palette-grey-300")),Ae(J.Chip,"defaultIconColor",je("palette-grey-300")),Ae(J.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Ae(J.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Ae(J.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Ae(J.LinearProgress,"primaryBg",Fe(rn,J.primary.main,.5)),Ae(J.LinearProgress,"secondaryBg",Fe(rn,J.secondary.main,.5)),Ae(J.LinearProgress,"errorBg",Fe(rn,J.error.main,.5)),Ae(J.LinearProgress,"infoBg",Fe(rn,J.info.main,.5)),Ae(J.LinearProgress,"successBg",Fe(rn,J.success.main,.5)),Ae(J.LinearProgress,"warningBg",Fe(rn,J.warning.main,.5)),Ae(J.Skeleton,"bg",ae?Fe(El,J.text.primary,.13):`rgba(${je("palette-text-primaryChannel")} / 0.13)`),Ae(J.Slider,"primaryTrack",Fe(rn,J.primary.main,.5)),Ae(J.Slider,"secondaryTrack",Fe(rn,J.secondary.main,.5)),Ae(J.Slider,"errorTrack",Fe(rn,J.error.main,.5)),Ae(J.Slider,"infoTrack",Fe(rn,J.info.main,.5)),Ae(J.Slider,"successTrack",Fe(rn,J.success.main,.5)),Ae(J.Slider,"warningTrack",Fe(rn,J.warning.main,.5));const ft=ae?Fe(sn,J.background.default,.985):Qp(J.background.default,.98);Ae(J.SnackbarContent,"bg",ft),Ae(J.SnackbarContent,"color",Hs(()=>ae?xI.text.primary:J.getContrastText(ft))),Ae(J.SpeedDialAction,"fabHoverBg",Qp(J.background.paper,.15)),Ae(J.StepConnector,"border",je("palette-grey-600")),Ae(J.StepContent,"border",je("palette-grey-600")),Ae(J.Switch,"defaultColor",je("palette-grey-300")),Ae(J.Switch,"defaultDisabledColor",je("palette-grey-600")),Ae(J.Switch,"primaryDisabledColor",Fe(rn,J.primary.main,.55)),Ae(J.Switch,"secondaryDisabledColor",Fe(rn,J.secondary.main,.55)),Ae(J.Switch,"errorDisabledColor",Fe(rn,J.error.main,.55)),Ae(J.Switch,"infoDisabledColor",Fe(rn,J.info.main,.55)),Ae(J.Switch,"successDisabledColor",Fe(rn,J.success.main,.55)),Ae(J.Switch,"warningDisabledColor",Fe(rn,J.warning.main,.55)),Ae(J.TableCell,"border",Fe(rn,Fe(El,J.divider,1),.68)),Ae(J.Tooltip,"bg",Fe(El,J.grey[700],.92))}ko(J.background,"default"),ko(J.background,"paper"),ko(J.common,"background"),ko(J.common,"onBackground"),ko(J,"divider"),Object.keys(J).forEach(ft=>{const Ct=J[ft];ft!=="tonalOffset"&&Ct&&typeof Ct=="object"&&(Ct.main&&Ae(J[ft],"mainChannel",vd(xd(Ct.main))),Ct.light&&Ae(J[ft],"lightChannel",vd(xd(Ct.light))),Ct.dark&&Ae(J[ft],"darkChannel",vd(xd(Ct.dark))),Ct.contrastText&&Ae(J[ft],"contrastTextChannel",vd(xd(Ct.contrastText))),ft==="text"&&(ko(J[ft],"primary"),ko(J[ft],"secondary")),ft==="action"&&(Ct.active&&ko(J[ft],"active"),Ct.selected&&ko(J[ft],"selected")))})}),ye=t.reduce((Ne,J)=>Ui(Ne,J),ye);const Se={prefix:p,disableCssColorScheme:h,shouldSkipGeneratingVar:u,getSelector:N6(ye),enableContrastVars:m},{vars:Ie,generateThemeVars:Be,generateStyleSheets:Ue}=u6(ye,Se);return ye.vars=Ie,Object.entries(ye.colorSchemes[ye.defaultColorScheme]).forEach(([Ne,J])=>{ye[Ne]=J}),ye.generateThemeVars=Be,ye.generateStyleSheets=Ue,ye.generateSpacing=function(){return cI(D.spacing,T1(this))},ye.getColorSchemeSelector=c6(C),ye.spacing=ye.generateSpacing(),ye.shouldSkipGeneratingVar=u,ye.unstable_sxConfig={...Ug,...D==null?void 0:D.unstable_sxConfig},ye.unstable_sx=function(J){return Oc({sx:J,theme:this})},ye.toRuntimeSource=wI,ye}function FT(e,t,i){e.colorSchemes&&i&&(e.colorSchemes[t]={...i!==!0&&i,palette:B1({...i===!0?{}:i.palette,mode:t})})}function q6(e={},...t){const{palette:i,cssVariables:a=!1,colorSchemes:h=i?void 0:{light:!0},defaultColorScheme:p=i==null?void 0:i.mode,...m}=e,u=p||"light",C=h==null?void 0:h[u],E={...h,...i?{[u]:{...typeof C!="boolean"&&C,palette:i}}:void 0};if(a===!1){if(!("colorSchemes"in e))return V0(e,...t);let D=i;"palette"in e||E[u]&&(E[u]!==!0?D=E[u].palette:u==="dark"&&(D={mode:"dark"}));const z=V0({...e,palette:D},...t);return z.defaultColorScheme=u,z.colorSchemes=E,z.palette.mode==="light"&&(z.colorSchemes.light={...E.light!==!0&&E.light,palette:z.palette},FT(z,"dark",E.dark)),z.palette.mode==="dark"&&(z.colorSchemes.dark={...E.dark!==!0&&E.dark,palette:z.palette},FT(z,"light",E.light)),z}return!i&&!("light"in E)&&u==="light"&&(E.light=!0),G6({...m,colorSchemes:E,defaultColorScheme:u,...typeof a!="boolean"&&a},...t)}const Z6=q6(),CI="$$material";function W6(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const H6=e=>W6(e)&&e!=="classes",Uo=VO({themeId:CI,defaultTheme:Z6,rootShouldForwardProp:H6}),cf=s6;function Ef(e){return t6(e)}function X6(e){return kf("MuiSvgIcon",e)}Pf("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const K6=e=>{const{color:t,fontSize:i,classes:a}=e,h={root:["root",t!=="inherit"&&`color${$r(t)}`,`fontSize${$r(i)}`]};return Cg(h,X6,a)},Y6=Uo("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.color!=="inherit"&&t[`color${$r(i.color)}`],t[`fontSize${$r(i.fontSize)}`]]}})(cf(({theme:e})=>{var t,i,a,h,p,m,u,C,E,D,z,A,Z,Y;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(h=(t=e.transitions)==null?void 0:t.create)==null?void 0:h.call(t,"fill",{duration:(a=(i=(e.vars??e).transitions)==null?void 0:i.duration)==null?void 0:a.shorter}),variants:[{props:te=>!te.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((m=(p=e.typography)==null?void 0:p.pxToRem)==null?void 0:m.call(p,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((C=(u=e.typography)==null?void 0:u.pxToRem)==null?void 0:C.call(u,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((D=(E=e.typography)==null?void 0:E.pxToRem)==null?void 0:D.call(E,35))||"2.1875rem"}},...Object.entries((e.vars??e).palette).filter(([,te])=>te&&te.main).map(([te])=>{var pe,U;return{props:{color:te},style:{color:(U=(pe=(e.vars??e).palette)==null?void 0:pe[te])==null?void 0:U.main}}}),{props:{color:"action"},style:{color:(A=(z=(e.vars??e).palette)==null?void 0:z.action)==null?void 0:A.active}},{props:{color:"disabled"},style:{color:(Y=(Z=(e.vars??e).palette)==null?void 0:Z.action)==null?void 0:Y.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),N0=le.forwardRef(function(t,i){const a=Ef({props:t,name:"MuiSvgIcon"}),{children:h,className:p,color:m="inherit",component:u="svg",fontSize:C="medium",htmlColor:E,inheritViewBox:D=!1,titleAccess:z,viewBox:A="0 0 24 24",...Z}=a,Y=le.isValidElement(h)&&h.type==="svg",te={...a,color:m,component:u,fontSize:C,instanceFontSize:t.fontSize,inheritViewBox:D,viewBox:A,hasSvgAsChild:Y},pe={};D||(pe.viewBox=A);const U=K6(te);return De.jsxs(Y6,{as:u,className:gi(U.root,p),focusable:"false",color:E,"aria-hidden":z?void 0:!0,role:z?"img":void 0,ref:i,...pe,...Z,...Y&&h.props,ownerState:te,children:[Y?h.props.children:h,z?De.jsx("title",{children:z}):null]})});N0.muiName="SvgIcon";function ay(e,t){function i(a,h){return De.jsx(N0,{"data-testid":void 0,ref:h,...a,children:e})}return i.muiName=N0.muiName,le.memo(le.forwardRef(i))}function bm(e){const t=le.useRef(e);return pI(()=>{t.current=e}),le.useRef((...i)=>(0,t.current)(...i)).current}function BT(...e){const t=le.useRef(void 0),i=le.useCallback(a=>{const h=e.map(p=>{if(p==null)return null;if(typeof p=="function"){const m=p,u=m(a);return typeof u=="function"?u:()=>{m(null)}}return p.current=a,()=>{p.current=null}});return()=>{h.forEach(p=>p==null?void 0:p())}},e);return le.useMemo(()=>e.every(a=>a==null)?null:a=>{t.current&&(t.current(),t.current=void 0),a!=null&&(t.current=i(a))},e)}const J6=ay(De.jsx("path",{d:"M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"})),Q6=ay(De.jsx("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"})),eV=ay(De.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),tV=ay(De.jsx("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}));function nV(e,t){if(e==null)return{};var i={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;i[a]=e[a]}return i}function j0(e,t){return j0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},j0(e,t)}function rV(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,j0(e,t)}const OT=tc.createContext(null);function iV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O1(e,t){var i=function(p){return t&&le.isValidElement(p)?t(p):p},a=Object.create(null);return e&&le.Children.map(e,function(h){return h}).forEach(function(h){a[h.key]=i(h)}),a}function sV(e,t){e=e||{},t=t||{};function i(D){return D in t?t[D]:e[D]}var a=Object.create(null),h=[];for(var p in e)p in t?h.length&&(a[p]=h,h=[]):h.push(p);var m,u={};for(var C in t){if(a[C])for(m=0;m<a[C].length;m++){var E=a[C][m];u[a[C][m]]=i(E)}u[C]=i(C)}for(m=0;m<h.length;m++)u[h[m]]=i(h[m]);return u}function Vl(e,t,i){return i[t]!=null?i[t]:e.props[t]}function oV(e,t){return O1(e.children,function(i){return le.cloneElement(i,{onExited:t.bind(null,i),in:!0,appear:Vl(i,"appear",e),enter:Vl(i,"enter",e),exit:Vl(i,"exit",e)})})}function aV(e,t,i){var a=O1(e.children),h=sV(t,a);return Object.keys(h).forEach(function(p){var m=h[p];if(le.isValidElement(m)){var u=p in t,C=p in a,E=t[p],D=le.isValidElement(E)&&!E.props.in;C&&(!u||D)?h[p]=le.cloneElement(m,{onExited:i.bind(null,m),in:!0,exit:Vl(m,"exit",e),enter:Vl(m,"enter",e)}):!C&&u&&!D?h[p]=le.cloneElement(m,{in:!1}):C&&u&&le.isValidElement(E)&&(h[p]=le.cloneElement(m,{onExited:i.bind(null,m),in:E.props.in,exit:Vl(m,"exit",e),enter:Vl(m,"enter",e)}))}}),h}var lV=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},uV={component:"div",childFactory:function(t){return t}},V1=function(e){rV(t,e);function t(a,h){var p;p=e.call(this,a,h)||this;var m=p.handleExited.bind(iV(p));return p.state={contextValue:{isMounting:!0},handleExited:m,firstRender:!0},p}var i=t.prototype;return i.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},i.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(h,p){var m=p.children,u=p.handleExited,C=p.firstRender;return{children:C?oV(h,u):aV(h,m,u),firstRender:!1}},i.handleExited=function(h,p){var m=O1(this.props.children);h.key in m||(h.props.onExited&&h.props.onExited(p),this.mounted&&this.setState(function(u){var C=eg({},u.children);return delete C[h.key],{children:C}}))},i.render=function(){var h=this.props,p=h.component,m=h.childFactory,u=nV(h,["component","childFactory"]),C=this.state.contextValue,E=lV(this.state.children).map(m);return delete u.appear,delete u.enter,delete u.exit,p===null?tc.createElement(OT.Provider,{value:C},E):tc.createElement(OT.Provider,{value:C},tc.createElement(p,u,E))},t}(tc.Component);V1.propTypes={};V1.defaultProps=uV;const VT={};function kI(e,t){const i=le.useRef(VT);return i.current===VT&&(i.current=e(t)),i}const cV=[];function hV(e){le.useEffect(e,cV)}class N1{constructor(){td(this,"currentId",null);td(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});td(this,"disposeEffect",()=>this.clear)}static create(){return new N1}start(t,i){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,i()},t)}}function dV(){const e=kI(N1.create).current;return hV(e.disposeEffect),e}function NT(e){try{return e.matches(":focus-visible")}catch{}return!1}class rg{constructor(){td(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new rg}static use(){const t=kI(rg.create).current,[i,a]=le.useState(!1);return t.shouldMount=i,t.setShouldMount=a,le.useEffect(t.mountEffect,[i]),t}mount(){return this.mounted||(this.mounted=pV(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...t){this.mount().then(()=>{var i;return(i=this.ref.current)==null?void 0:i.start(...t)})}stop(...t){this.mount().then(()=>{var i;return(i=this.ref.current)==null?void 0:i.stop(...t)})}pulsate(...t){this.mount().then(()=>{var i;return(i=this.ref.current)==null?void 0:i.pulsate(...t)})}}function fV(){return rg.use()}function pV(){let e,t;const i=new Promise((a,h)=>{e=a,t=h});return i.resolve=e,i.reject=t,i}function mV(e){const{className:t,classes:i,pulsate:a=!1,rippleX:h,rippleY:p,rippleSize:m,in:u,onExited:C,timeout:E}=e,[D,z]=le.useState(!1),A=gi(t,i.ripple,i.rippleVisible,a&&i.ripplePulsate),Z={width:m,height:m,top:-(m/2)+p,left:-(m/2)+h},Y=gi(i.child,D&&i.childLeaving,a&&i.childPulsate);return!u&&!D&&z(!0),le.useEffect(()=>{if(!u&&C!=null){const te=setTimeout(C,E);return()=>{clearTimeout(te)}}},[C,u,E]),De.jsx("span",{className:A,style:Z,children:De.jsx("span",{className:Y})})}const ls=Pf("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),$0=550,gV=80,yV=Cf`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,_V=Cf`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,vV=Cf`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,xV=Uo("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),bV=Uo(mV,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${ls.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${yV};
    animation-duration: ${$0}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  &.${ls.ripplePulsate} {
    animation-duration: ${({theme:e})=>e.transitions.duration.shorter}ms;
  }

  & .${ls.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${ls.childLeaving} {
    opacity: 0;
    animation-name: ${_V};
    animation-duration: ${$0}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  & .${ls.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${vV};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,wV=le.forwardRef(function(t,i){const a=Ef({props:t,name:"MuiTouchRipple"}),{center:h=!1,classes:p={},className:m,...u}=a,[C,E]=le.useState([]),D=le.useRef(0),z=le.useRef(null);le.useEffect(()=>{z.current&&(z.current(),z.current=null)},[C]);const A=le.useRef(!1),Z=dV(),Y=le.useRef(null),te=le.useRef(null),pe=le.useCallback(ae=>{const{pulsate:_e,rippleX:ye,rippleY:Se,rippleSize:Ie,cb:Be}=ae;E(Ue=>[...Ue,De.jsx(bV,{classes:{ripple:gi(p.ripple,ls.ripple),rippleVisible:gi(p.rippleVisible,ls.rippleVisible),ripplePulsate:gi(p.ripplePulsate,ls.ripplePulsate),child:gi(p.child,ls.child),childLeaving:gi(p.childLeaving,ls.childLeaving),childPulsate:gi(p.childPulsate,ls.childPulsate)},timeout:$0,pulsate:_e,rippleX:ye,rippleY:Se,rippleSize:Ie},D.current)]),D.current+=1,z.current=Be},[p]),U=le.useCallback((ae={},_e={},ye=()=>{})=>{const{pulsate:Se=!1,center:Ie=h||_e.pulsate,fakeElement:Be=!1}=_e;if((ae==null?void 0:ae.type)==="mousedown"&&A.current){A.current=!1;return}(ae==null?void 0:ae.type)==="touchstart"&&(A.current=!0);const Ue=Be?null:te.current,Ne=Ue?Ue.getBoundingClientRect():{width:0,height:0,left:0,top:0};let J,je,Fe;if(Ie||ae===void 0||ae.clientX===0&&ae.clientY===0||!ae.clientX&&!ae.touches)J=Math.round(Ne.width/2),je=Math.round(Ne.height/2);else{const{clientX:ft,clientY:Ct}=ae.touches&&ae.touches.length>0?ae.touches[0]:ae;J=Math.round(ft-Ne.left),je=Math.round(Ct-Ne.top)}if(Ie)Fe=Math.sqrt((2*Ne.width**2+Ne.height**2)/3),Fe%2===0&&(Fe+=1);else{const ft=Math.max(Math.abs((Ue?Ue.clientWidth:0)-J),J)*2+2,Ct=Math.max(Math.abs((Ue?Ue.clientHeight:0)-je),je)*2+2;Fe=Math.sqrt(ft**2+Ct**2)}ae!=null&&ae.touches?Y.current===null&&(Y.current=()=>{pe({pulsate:Se,rippleX:J,rippleY:je,rippleSize:Fe,cb:ye})},Z.start(gV,()=>{Y.current&&(Y.current(),Y.current=null)})):pe({pulsate:Se,rippleX:J,rippleY:je,rippleSize:Fe,cb:ye})},[h,pe,Z]),G=le.useCallback(()=>{U({},{pulsate:!0})},[U]),X=le.useCallback((ae,_e)=>{if(Z.clear(),(ae==null?void 0:ae.type)==="touchend"&&Y.current){Y.current(),Y.current=null,Z.start(0,()=>{X(ae,_e)});return}Y.current=null,E(ye=>ye.length>0?ye.slice(1):ye),z.current=_e},[Z]);return le.useImperativeHandle(i,()=>({pulsate:G,start:U,stop:X}),[G,U,X]),De.jsx(xV,{className:gi(ls.root,p.root,m),ref:te,...u,children:De.jsx(V1,{component:null,exit:!0,children:C})})});function SV(e){return kf("MuiButtonBase",e)}const TV=Pf("MuiButtonBase",["root","disabled","focusVisible"]),CV=e=>{const{disabled:t,focusVisible:i,focusVisibleClassName:a,classes:h}=e,m=Cg({root:["root",t&&"disabled",i&&"focusVisible"]},SV,h);return i&&a&&(m.root+=` ${a}`),m},kV=Uo("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${TV.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),PV=le.forwardRef(function(t,i){const a=Ef({props:t,name:"MuiButtonBase"}),{action:h,centerRipple:p=!1,children:m,className:u,component:C="button",disabled:E=!1,disableRipple:D=!1,disableTouchRipple:z=!1,focusRipple:A=!1,focusVisibleClassName:Z,LinkComponent:Y="a",onBlur:te,onClick:pe,onContextMenu:U,onDragLeave:G,onFocus:X,onFocusVisible:ae,onKeyDown:_e,onKeyUp:ye,onMouseDown:Se,onMouseLeave:Ie,onMouseUp:Be,onTouchEnd:Ue,onTouchMove:Ne,onTouchStart:J,tabIndex:je=0,TouchRippleProps:Fe,touchRippleRef:ft,type:Ct,...bt}=a,Oe=le.useRef(null),tt=fV(),gt=BT(tt.ref,ft),[Pt,Bt]=le.useState(!1);E&&Pt&&Bt(!1),le.useImperativeHandle(h,()=>({focusVisible:()=>{Bt(!0),Oe.current.focus()}}),[]);const Gr=tt.shouldMount&&!D&&!E;le.useEffect(()=>{Pt&&A&&!D&&tt.pulsate()},[D,A,Pt,tt]);const qn=Po(tt,"start",Se,z),ir=Po(tt,"stop",U,z),sr=Po(tt,"stop",G,z),Dn=Po(tt,"stop",Be,z),qr=Po(tt,"stop",St=>{Pt&&St.preventDefault(),Ie&&Ie(St)},z),vs=Po(tt,"start",J,z),xs=Po(tt,"stop",Ue,z),oo=Po(tt,"stop",Ne,z),Ti=Po(tt,"stop",St=>{NT(St.target)||Bt(!1),te&&te(St)},!1),Xi=bm(St=>{Oe.current||(Oe.current=St.currentTarget),NT(St.target)&&(Bt(!0),ae&&ae(St)),X&&X(St)}),si=()=>{const St=Oe.current;return C&&C!=="button"&&!(St.tagName==="A"&&St.href)},Fs=bm(St=>{A&&!St.repeat&&Pt&&St.key===" "&&tt.stop(St,()=>{tt.start(St)}),St.target===St.currentTarget&&si()&&St.key===" "&&St.preventDefault(),_e&&_e(St),St.target===St.currentTarget&&si()&&St.key==="Enter"&&!E&&(St.preventDefault(),pe&&pe(St))}),ke=bm(St=>{A&&St.key===" "&&Pt&&!St.defaultPrevented&&tt.stop(St,()=>{tt.pulsate(St)}),ye&&ye(St),pe&&St.target===St.currentTarget&&si()&&St.key===" "&&!St.defaultPrevented&&pe(St)});let oi=C;oi==="button"&&(bt.href||bt.to)&&(oi=Y);const Ci={};oi==="button"?(Ci.type=Ct===void 0?"button":Ct,Ci.disabled=E):(!bt.href&&!bt.to&&(Ci.role="button"),E&&(Ci["aria-disabled"]=E));const Ot=BT(i,Oe),ln={...a,centerRipple:p,component:C,disabled:E,disableRipple:D,disableTouchRipple:z,focusRipple:A,tabIndex:je,focusVisible:Pt},ao=CV(ln);return De.jsxs(kV,{as:oi,className:gi(ao.root,u),ownerState:ln,onBlur:Ti,onClick:pe,onContextMenu:ir,onFocus:Xi,onKeyDown:Fs,onKeyUp:ke,onMouseDown:qn,onMouseLeave:qr,onMouseUp:Dn,onDragLeave:sr,onTouchEnd:xs,onTouchMove:oo,onTouchStart:vs,ref:Ot,tabIndex:E?-1:je,type:Ct,...Ci,...bt,children:[m,Gr?De.jsx(wV,{ref:gt,center:p,...Fe}):null]})});function Po(e,t,i,a=!1){return bm(h=>(i&&i(h),a||e[t](h),!0))}function EV(e){return typeof e.main=="string"}function IV(e,t=[]){if(!EV(e))return!1;for(const i of t)if(!e.hasOwnProperty(i)||typeof e[i]!="string")return!1;return!0}function U0(e=[]){return([,t])=>t&&IV(t,e)}function MV(e){return kf("MuiCircularProgress",e)}Pf("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Ca=44,G0=Cf`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,q0=Cf`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,AV=typeof G0!="string"?L1`
        animation: ${G0} 1.4s linear infinite;
      `:null,zV=typeof q0!="string"?L1`
        animation: ${q0} 1.4s ease-in-out infinite;
      `:null,DV=e=>{const{classes:t,variant:i,color:a,disableShrink:h}=e,p={root:["root",i,`color${$r(a)}`],svg:["svg"],circle:["circle",`circle${$r(i)}`,h&&"circleDisableShrink"]};return Cg(p,MV,t)},RV=Uo("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t[i.variant],t[`color${$r(i.color)}`]]}})(cf(({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:AV||{animation:`${G0} 1.4s linear infinite`}},...Object.entries(e.palette).filter(U0()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}}))]}))),LV=Uo("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),FV=Uo("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.circle,t[`circle${$r(i.variant)}`],i.disableShrink&&t.circleDisableShrink]}})(cf(({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink,style:zV||{animation:`${q0} 1.4s ease-in-out infinite`}}]}))),BV=le.forwardRef(function(t,i){const a=Ef({props:t,name:"MuiCircularProgress"}),{className:h,color:p="primary",disableShrink:m=!1,size:u=40,style:C,thickness:E=3.6,value:D=0,variant:z="indeterminate",...A}=a,Z={...a,color:p,disableShrink:m,size:u,thickness:E,value:D,variant:z},Y=DV(Z),te={},pe={},U={};if(z==="determinate"){const G=2*Math.PI*((Ca-E)/2);te.strokeDasharray=G.toFixed(3),U["aria-valuenow"]=Math.round(D),te.strokeDashoffset=`${((100-D)/100*G).toFixed(3)}px`,pe.transform="rotate(-90deg)"}return De.jsx(RV,{className:gi(Y.root,h),style:{width:u,height:u,...pe,...C},ownerState:Z,ref:i,role:"progressbar",...U,...A,children:De.jsx(LV,{className:Y.svg,ownerState:Z,viewBox:`${Ca/2} ${Ca/2} ${Ca} ${Ca}`,children:De.jsx(FV,{className:Y.circle,style:te,ownerState:Z,cx:Ca,cy:Ca,r:(Ca-E)/2,fill:"none",strokeWidth:E})})})});function OV(e){return kf("MuiIconButton",e)}const jT=Pf("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),VV=e=>{const{classes:t,disabled:i,color:a,edge:h,size:p,loading:m}=e,u={root:["root",m&&"loading",i&&"disabled",a!=="default"&&`color${$r(a)}`,h&&`edge${$r(h)}`,`size${$r(p)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return Cg(u,OV,t)},NV=Uo(PV,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,i.loading&&t.loading,i.color!=="default"&&t[`color${$r(i.color)}`],i.edge&&t[`edge${$r(i.edge)}`],t[`size${$r(i.size)}`]]}})(cf(({theme:e})=>({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),variants:[{props:t=>!t.disableRipple,style:{"--IconButton-hoverBg":e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),cf(({theme:e})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(e.palette).filter(U0()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})),...Object.entries(e.palette).filter(U0()).map(([t])=>({props:{color:t},style:{"--IconButton-hoverBg":e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:e.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:e.typography.pxToRem(28)}}],[`&.${jT.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled},[`&.${jT.loading}`]:{color:"transparent"}}))),jV=Uo("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:e})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(e.vars||e).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),gv=le.forwardRef(function(t,i){const a=Ef({props:t,name:"MuiIconButton"}),{edge:h=!1,children:p,className:m,color:u="default",disabled:C=!1,disableFocusRipple:E=!1,size:D="medium",id:z,loading:A=null,loadingIndicator:Z,...Y}=a,te=i6(z),pe=Z??De.jsx(BV,{"aria-labelledby":te,color:"inherit",size:16}),U={...a,edge:h,color:u,disabled:C,disableFocusRipple:E,loading:A,loadingIndicator:pe,size:D},G=VV(U);return De.jsxs(NV,{id:A?te:z,className:gi(G.root,m),centerRipple:!0,focusRipple:!E,disabled:C||A,ref:i,...Y,ownerState:U,children:[typeof A=="boolean"&&De.jsx("span",{className:G.loadingWrapper,style:{display:"contents"},children:De.jsx(jV,{className:G.loadingIndicator,ownerState:U,children:A&&pe})}),p]})}),$V=gI({themeId:CI}),UV=40,GV={width:"min(320px, calc(100vw - 32px))",display:"flex",flexDirection:"column",gap:0,borderRadius:16,overflow:"hidden",background:"rgba(255,255,255,0.92)",backdropFilter:"blur(18px)",WebkitBackdropFilter:"blur(18px)",border:"1px solid rgba(0,0,0,0.08)",boxShadow:"0 4px 24px rgba(0,0,0,0.12)",color:"#0f172a"},qV={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 12px",borderBottom:"1px solid rgba(0,0,0,0.06)"},em={padding:"14px 16px"},yv={height:1,background:"rgba(0,0,0,0.07)",margin:"0 16px"};function ZV(){const e=$V("(max-width:640px)"),[t,i]=le.useState(5),[a,h]=le.useState(!0),[p,m]=le.useState([]),[u,C]=le.useState(0),[E,D]=le.useState([]),[z,A]=le.useState(!1),Z=p[u]??null,Y=le.useMemo(()=>({position:"absolute",top:e?8:16,left:e?8:16,right:e?8:void 0,pointerEvents:"auto",zIndex:10}),[e]);return De.jsxs(De.Fragment,{children:[De.jsx(kF,{route:Z}),De.jsx(z0.div,{initial:!1,animate:{x:a?0:`calc(-100% + ${UV}px)`,opacity:1},transition:{type:"spring",stiffness:260,damping:30},style:Y,children:De.jsxs("div",{style:GV,children:[De.jsxs("div",{style:qV,children:[De.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#0f172a"},children:"Routes"}),De.jsx(gv,{size:"small",onClick:()=>h(te=>!te),sx:{color:"#64748b"},children:a?De.jsx(eV,{fontSize:"small"}):De.jsx(tV,{fontSize:"small"})})]}),De.jsxs("div",{style:{pointerEvents:a?"auto":"none",opacity:a?1:.6,transition:"opacity 0.2s ease"},children:[De.jsx("div",{style:em,children:De.jsx(TF,{onRoutes:te=>{m(te),C(0)},targetMiles:t,polygon:z?E:void 0})}),De.jsx(JP,{children:p.length>0&&De.jsxs(z0.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:[De.jsx("div",{style:yv}),De.jsxs("div",{style:{...em,paddingTop:10,paddingBottom:10},children:[De.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[De.jsx(gv,{size:"small",onClick:()=>C(te=>Math.max(0,te-1)),disabled:u===0,sx:{color:"#cbd5e1","&:not(:disabled)":{color:"#0f172a"},p:.5},children:De.jsx(J6,{sx:{fontSize:14}})}),De.jsxs("div",{style:{textAlign:"center"},children:[De.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#0f172a",letterSpacing:"0.02em"},children:["Route ",u+1," ",De.jsxs("span",{style:{color:"#94a3b8"},children:["/ ",p.length]})]}),De.jsxs("div",{style:{fontSize:11,color:"#64748b",marginTop:1},children:[Z==null?void 0:Z.distanceMiles.toFixed(2)," mi "," ",(()=>{const te=Math.round((Z==null?void 0:Z.durationMinutes)??0),pe=Math.floor(te/60),U=te%60;return pe>0?`${pe}h ${U}m`:`${te}m`})()]})]}),De.jsx(gv,{size:"small",onClick:()=>C(te=>Math.min(p.length-1,te+1)),disabled:u===p.length-1,sx:{color:"#cbd5e1","&:not(:disabled)":{color:"#0f172a"},p:.5},children:De.jsx(Q6,{sx:{fontSize:14}})})]}),Z&&De.jsx(MF,{route:Z})]})]},"route-section")}),De.jsx("div",{style:yv}),De.jsx("div",{style:em,children:De.jsx(yF,{value:t,onChange:i})}),De.jsx("div",{style:yv}),De.jsxs("div",{style:{...em,paddingTop:10,paddingBottom:10},children:[De.jsx("div",{style:{fontSize:11,color:"#94a3b8",fontWeight:600,letterSpacing:"0.06em",textTransform:"uppercase",marginBottom:8},children:"Region"}),De.jsx(gF,{polygonCoords:E,polygonClosed:z,setPolygonCoords:D,setPolygonClosed:A})]})]})]})})]})}function WV(){return De.jsx(De.Fragment,{children:De.jsxs(oR,{initialViewState:{longitude:Wm[0],latitude:Wm[1],zoom:2},mapStyle:"https://tiles.openfreemap.org/styles/liberty",children:[De.jsx(BR,{}),De.jsx(ZV,{})]})})}nP(document.getElementById("root")).render(De.jsx(WV,{}));
